{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"source/images/avatar.png","path":"images/avatar.png","modified":0,"renderable":0},{"_id":"source/images/icon.png","path":"images/icon.png","modified":0,"renderable":0},{"_id":"themes/icarus/source/css/style.styl","path":"css/style.styl","modified":0,"renderable":1},{"_id":"themes/icarus/source/js/insight.js","path":"js/insight.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/images/avatar.png","path":"images/avatar.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/images/favicon.ico","path":"images/favicon.ico","modified":0,"renderable":1},{"_id":"themes/icarus/source/js/particle.js","path":"js/particle.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/js/main.js","path":"js/main.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/bootstrap.min.css","path":"css/bootstrap.min.css","modified":0,"renderable":1},{"_id":"source/images/blogimages/2016/ThreadLocal.png","path":"images/blogimages/2016/ThreadLocal.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2016/androidart_broadcastreceiver1.png","path":"images/blogimages/2016/androidart_broadcastreceiver1.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2016/avg_warning.PNG","path":"images/blogimages/2016/avg_warning.PNG","modified":0,"renderable":0},{"_id":"source/images/blogimages/2016/google_servcie_ads.PNG","path":"images/blogimages/2016/google_servcie_ads.PNG","modified":0,"renderable":0},{"_id":"source/images/blogimages/2016/gradle_structure1.png","path":"images/blogimages/2016/gradle_structure1.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2016/gradle_structure2.png","path":"images/blogimages/2016/gradle_structure2.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2016/jni_structure.png","path":"images/blogimages/2016/jni_structure.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2016/gradle_task.png","path":"images/blogimages/2016/gradle_task.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/PackageManagerService.png","path":"images/blogimages/2017/PackageManagerService.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/apt_processor.png","path":"images/blogimages/2017/apt_processor.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/binder-02.png","path":"images/blogimages/2017/binder-02.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/binder-01.png","path":"images/blogimages/2017/binder-01.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/binder-open-drive.png","path":"images/blogimages/2017/binder-open-drive.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/binder-service-manager.png","path":"images/blogimages/2017/binder-service-manager.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/binder-system-service.png","path":"images/blogimages/2017/binder-system-service.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/device-number.png","path":"images/blogimages/2017/device-number.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/clipboard-ipc-process.png","path":"images/blogimages/2017/clipboard-ipc-process.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/funny_pic.jpg","path":"images/blogimages/2017/funny_pic.jpg","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/getStrongProxyForHandle.png","path":"images/blogimages/2017/getStrongProxyForHandle.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/ibinder-binder.png","path":"images/blogimages/2017/ibinder-binder.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/processor_jar.png","path":"images/blogimages/2017/processor_jar.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/servicemanager-find-service.png","path":"images/blogimages/2017/servicemanager-find-service.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/transact-binder.png","path":"images/blogimages/2017/transact-binder.png","modified":0,"renderable":0},{"_id":"themes/icarus/source/css/images/avatar.png","path":"css/images/avatar.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/avatar0.png","path":"css/images/avatar0.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/avatar1.png","path":"css/images/avatar1.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/thumb-default-small.png","path":"css/images/thumb-default-small.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/css/images/logo.png","path":"css/images/logo.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/justified-gallery/justifiedGallery.min.css","path":"libs/justified-gallery/justifiedGallery.min.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/justified-gallery/jquery.justifiedGallery.min.js","path":"libs/justified-gallery/jquery.justifiedGallery.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/source-code-pro/styles.css","path":"libs/source-code-pro/styles.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/styles.css","path":"libs/open-sans/styles.css","modified":0,"renderable":1},{"_id":"source/images/blogimages/2016/androidart_service1.png","path":"images/blogimages/2016/androidart_service1.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2016/androidart_broadcastreceiver2.png","path":"images/blogimages/2016/androidart_broadcastreceiver2.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/Initialize_for_purchase_data.png","path":"images/blogimages/2017/Initialize_for_purchase_data.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/Initialize_for_purchase.png","path":"images/blogimages/2017/Initialize_for_purchase.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/activity-start-process.png","path":"images/blogimages/2017/activity-start-process.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/Initialize_for_purchase_responce.png","path":"images/blogimages/2017/Initialize_for_purchase_responce.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/android_build_process.png","path":"images/blogimages/2017/android_build_process.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/ams_binder_process.png","path":"images/blogimages/2017/ams_binder_process.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/binder-drive-principle.png","path":"images/blogimages/2017/binder-drive-principle.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/binder-principle.png","path":"images/blogimages/2017/binder-principle.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/hook-clipboard-process.png","path":"images/blogimages/2017/hook-clipboard-process.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/listview_recyclebin.png","path":"images/blogimages/2017/listview_recyclebin.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/multi-Application-flow-chart.png","path":"images/blogimages/2017/multi-Application-flow-chart.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/process-ipc-structure.png","path":"images/blogimages/2017/process-ipc-structure.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/servicemanager-add-service.png","path":"images/blogimages/2017/servicemanager-add-service.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/service-proxy-common.png","path":"images/blogimages/2017/service-proxy-common.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/servicemanager-init.png","path":"images/blogimages/2017/servicemanager-init.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2016/androidart_activity.png","path":"images/blogimages/2016/androidart_activity.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2016/androidart_contentprovider.png","path":"images/blogimages/2016/androidart_contentprovider.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/EIT-form.png","path":"images/blogimages/2017/EIT-form.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/IPC-data-format.png","path":"images/blogimages/2017/IPC-data-format.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/android_lint.png","path":"images/blogimages/2017/android_lint.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/aosp_make_single_module.png","path":"images/blogimages/2017/aosp_make_single_module.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/binder-EIT-onTransact.png","path":"images/blogimages/2017/binder-EIT-onTransact.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/binder-EIT.png","path":"images/blogimages/2017/binder-EIT.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/binder-example-media.png","path":"images/blogimages/2017/binder-example-media.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/im_company_abroad/im_layer.png","path":"images/blogimages/2017/im_company_abroad/im_layer.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/js/js_function_construction.png","path":"images/blogimages/2017/js/js_function_construction.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/js/js_function_construction_1.png","path":"images/blogimages/2017/js/js_function_construction_1.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/js/js_function_construction_2.png","path":"images/blogimages/2017/js/js_function_construction_2.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/pin_verify.png","path":"images/blogimages/2017/pin_verify.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/cisco/Adobe_Connect_Online_Store.png","path":"images/blogimages/cisco/Adobe_Connect_Online_Store.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/cisco/Cisco_WebEx_Meetings_Pricing.png","path":"images/blogimages/cisco/Cisco_WebEx_Meetings_Pricing.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/cisco/VC5_5_1.png","path":"images/blogimages/cisco/VC5_5_1.png","modified":0,"renderable":0},{"_id":"themes/icarus/source/libs/font-awesome/css/font-awesome.min.css","path":"libs/font-awesome/css/font-awesome.min.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/font-awesome/css/font-awesome.css","path":"libs/font-awesome/css/font-awesome.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-fb-comment-box.css","path":"libs/lightgallery/css/lg-fb-comment-box.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-fb-comment-box.min.css","path":"libs/lightgallery/css/lg-fb-comment-box.min.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-fb-comment-box.css.map","path":"libs/lightgallery/css/lg-fb-comment-box.css.map","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-transitions.css","path":"libs/lightgallery/css/lg-transitions.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/css/lightgallery.css","path":"libs/lightgallery/css/lightgallery.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-transitions.min.css","path":"libs/lightgallery/css/lg-transitions.min.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-transitions.css.map","path":"libs/lightgallery/css/lg-transitions.css.map","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/css/lightgallery.css.map","path":"libs/lightgallery/css/lightgallery.css.map","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/css/lightgallery.min.css","path":"libs/lightgallery/css/lightgallery.min.css","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/fonts/lg.eot","path":"libs/lightgallery/fonts/lg.eot","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/fonts/lg.svg","path":"libs/lightgallery/fonts/lg.svg","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/fonts/lg.ttf","path":"libs/lightgallery/fonts/lg.ttf","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/img/video-play.png","path":"libs/lightgallery/img/video-play.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/fonts/lg.woff","path":"libs/lightgallery/fonts/lg.woff","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/img/loading.gif","path":"libs/lightgallery/img/loading.gif","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/img/youtube-play.png","path":"libs/lightgallery/img/youtube-play.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/img/vimeo-play.png","path":"libs/lightgallery/img/vimeo-play.png","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-fullscreen.js","path":"libs/lightgallery/js/lg-fullscreen.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-autoplay.js","path":"libs/lightgallery/js/lg-autoplay.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-fullscreen.min.js","path":"libs/lightgallery/js/lg-fullscreen.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-autoplay.min.js","path":"libs/lightgallery/js/lg-autoplay.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-hash.min.js","path":"libs/lightgallery/js/lg-hash.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-hash.js","path":"libs/lightgallery/js/lg-hash.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-pager.min.js","path":"libs/lightgallery/js/lg-pager.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-pager.js","path":"libs/lightgallery/js/lg-pager.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-share.min.js","path":"libs/lightgallery/js/lg-share.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-share.js","path":"libs/lightgallery/js/lg-share.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-thumbnail.min.js","path":"libs/lightgallery/js/lg-thumbnail.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-thumbnail.js","path":"libs/lightgallery/js/lg-thumbnail.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-zoom.min.js","path":"libs/lightgallery/js/lg-zoom.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-video.js","path":"libs/lightgallery/js/lg-video.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-video.min.js","path":"libs/lightgallery/js/lg-video.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-zoom.js","path":"libs/lightgallery/js/lg-zoom.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lightgallery.js","path":"libs/lightgallery/js/lightgallery.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/LWCjsQkB6EMdfHrEVqA1KRJtnKITppOI_IvcXXDNrsc.woff2","path":"libs/open-sans/fonts/LWCjsQkB6EMdfHrEVqA1KRJtnKITppOI_IvcXXDNrsc.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/lightgallery/js/lightgallery.min.js","path":"libs/lightgallery/js/lightgallery.min.js","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNShWV49_lSm1NYrwo-zkhivY.woff2","path":"libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNShWV49_lSm1NYrwo-zkhivY.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSj0LW-43aMEzIO6XUTLjad8.woff2","path":"libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSj0LW-43aMEzIO6XUTLjad8.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/59ZRklaO5bWGqF5A9baEERJtnKITppOI_IvcXXDNrsc.woff2","path":"libs/open-sans/fonts/59ZRklaO5bWGqF5A9baEERJtnKITppOI_IvcXXDNrsc.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/K88pR3goAWT7BTt32Z01mxJtnKITppOI_IvcXXDNrsc.woff2","path":"libs/open-sans/fonts/K88pR3goAWT7BTt32Z01mxJtnKITppOI_IvcXXDNrsc.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSq-j2U0lmluP9RWlSytm3ho.woff2","path":"libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSq-j2U0lmluP9RWlSytm3ho.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSqaRobkAwv3vxw3jMhVENGA.woff2","path":"libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSqaRobkAwv3vxw3jMhVENGA.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSpX5f-9o1vgP2EXwfjgl7AY.woff2","path":"libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSpX5f-9o1vgP2EXwfjgl7AY.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSv8zf_FOSsgRmwsS7Aa9k2w.woff2","path":"libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSv8zf_FOSsgRmwsS7Aa9k2w.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/cJZKeOuBrn4kERxqtaUH3VtXRa8TVwTICgirnJhmVJw.woff2","path":"libs/open-sans/fonts/cJZKeOuBrn4kERxqtaUH3VtXRa8TVwTICgirnJhmVJw.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSugdm0LZdjqr5-oayXSOefg.woff2","path":"libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSugdm0LZdjqr5-oayXSOefg.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/RjgO7rYTmqiVp7vzi-Q5URJtnKITppOI_IvcXXDNrsc.woff2","path":"libs/open-sans/fonts/RjgO7rYTmqiVp7vzi-Q5URJtnKITppOI_IvcXXDNrsc.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/u-WUoqrET9fUeobQW7jkRRJtnKITppOI_IvcXXDNrsc.woff2","path":"libs/open-sans/fonts/u-WUoqrET9fUeobQW7jkRRJtnKITppOI_IvcXXDNrsc.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBjTOQ_MqJVwkKsUn0wKzc2I.woff2","path":"libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBjTOQ_MqJVwkKsUn0wKzc2I.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBiYE0-AqJ3nfInTTiDXDjU4.woff2","path":"libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBiYE0-AqJ3nfInTTiDXDjU4.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBjUj_cnvWIuuBMVgbX098Mw.woff2","path":"libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBjUj_cnvWIuuBMVgbX098Mw.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBo4P5ICox8Kq3LLUNMylGO4.woff2","path":"libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBo4P5ICox8Kq3LLUNMylGO4.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBr6up8jxqWt8HVA3mDhkV_0.woff2","path":"libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBr6up8jxqWt8HVA3mDhkV_0.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBkbcKLIaa1LC45dFaAfauRA.woff2","path":"libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBkbcKLIaa1LC45dFaAfauRA.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBmo_sUJ8uO4YLWRInS22T3Y.woff2","path":"libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBmo_sUJ8uO4YLWRInS22T3Y.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/open-sans/fonts/xozscpT2726on7jbcb_pAhJtnKITppOI_IvcXXDNrsc.woff2","path":"libs/open-sans/fonts/xozscpT2726on7jbcb_pAhJtnKITppOI_IvcXXDNrsc.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasDy2Q8seG17bfDXYR_jUsrzg.woff2","path":"libs/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasDy2Q8seG17bfDXYR_jUsrzg.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasD9V_2ngZ8dMf8fLgjYEouxg.woff2","path":"libs/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasD9V_2ngZ8dMf8fLgjYEouxg.woff2","modified":0,"renderable":1},{"_id":"source/images/blogimages/2016/androidart_ipc.png","path":"images/blogimages/2016/androidart_ipc.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2016/androidart_service2.png","path":"images/blogimages/2016/androidart_service2.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/communication-timing.png","path":"images/blogimages/2017/communication-timing.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/im_company_abroad/im_layer_email.png","path":"images/blogimages/2017/im_company_abroad/im_layer_email.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/im_company_abroad/im_quickblox.png","path":"images/blogimages/2017/im_company_abroad/im_quickblox.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/im_company_abroad/im_snich.png","path":"images/blogimages/2017/im_company_abroad/im_snich.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/media-server-process.png","path":"images/blogimages/2017/media-server-process.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/system-service-register-process.png","path":"images/blogimages/2017/system-service-register-process.png","modified":0,"renderable":0},{"_id":"themes/icarus/source/libs/font-awesome/fonts/fontawesome-webfont.eot","path":"libs/font-awesome/fonts/fontawesome-webfont.eot","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/font-awesome/fonts/FontAwesome.otf","path":"libs/font-awesome/fonts/FontAwesome.otf","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/font-awesome/fonts/fontawesome-webfont.woff","path":"libs/font-awesome/fonts/fontawesome-webfont.woff","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/font-awesome/fonts/fontawesome-webfont.woff2","path":"libs/font-awesome/fonts/fontawesome-webfont.woff2","modified":0,"renderable":1},{"_id":"themes/icarus/source/libs/jquery/2.1.3/jquery.min.js","path":"libs/jquery/2.1.3/jquery.min.js","modified":0,"renderable":1},{"_id":"source/images/blogimages/2017/binder-example-media-detail.png","path":"images/blogimages/2017/binder-example-media-detail.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/im_company_abroad/im_applozic.png","path":"images/blogimages/2017/im_company_abroad/im_applozic.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/im_company_abroad/im_sendbird.png","path":"images/blogimages/2017/im_company_abroad/im_sendbird.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/cisco/Cisco_Collaboration_Meeting_Rooms_Hybrid_-_Cisco.png","path":"images/blogimages/cisco/Cisco_Collaboration_Meeting_Rooms_Hybrid_-_Cisco.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/cisco/Adobe_web_conferencing_software.png","path":"images/blogimages/cisco/Adobe_web_conferencing_software.png","modified":0,"renderable":0},{"_id":"themes/icarus/source/libs/font-awesome/fonts/fontawesome-webfont.ttf","path":"libs/font-awesome/fonts/fontawesome-webfont.ttf","modified":0,"renderable":1},{"_id":"source/images/blogimages/2017/aosp_monitor_position.png","path":"images/blogimages/2017/aosp_monitor_position.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/cisco/Cisco_Collaboration_Meeting_Rooms_Premises_-_Cisco.png","path":"images/blogimages/cisco/Cisco_Collaboration_Meeting_Rooms_Premises_-_Cisco.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/cisco/VC5_5_3.png","path":"images/blogimages/cisco/VC5_5_3.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/cisco/zoom_cloud_hybrid.png","path":"images/blogimages/cisco/zoom_cloud_hybrid.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/binder-summary.png","path":"images/blogimages/2017/binder-summary.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/service-manager-activity.png","path":"images/blogimages/2017/service-manager-activity.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/cisco/Collaboration_Products_and_Solutions.png","path":"images/blogimages/cisco/Collaboration_Products_and_Solutions.png","modified":0,"renderable":0},{"_id":"themes/icarus/source/libs/font-awesome/fonts/fontawesome-webfont.svg","path":"libs/font-awesome/fonts/fontawesome-webfont.svg","modified":0,"renderable":1},{"_id":"source/images/blogimages/cisco/VC5_5_4.png","path":"images/blogimages/cisco/VC5_5_4.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/cisco/cmr_introduction.png","path":"images/blogimages/cisco/cmr_introduction.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/cisco/Adobe-Connect-Store.png","path":"images/blogimages/cisco/Adobe-Connect-Store.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/cisco/mx-700.png","path":"images/blogimages/cisco/mx-700.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/cisco/Web_Conferencing__Video_Conferencing_Fuze.png","path":"images/blogimages/cisco/Web_Conferencing__Video_Conferencing_Fuze.png","modified":0,"renderable":0},{"_id":"source/images/blogimages/2017/im_company_abroad/im_comparation.png","path":"images/blogimages/2017/im_company_abroad/im_comparation.png","modified":0,"renderable":0}],"Cache":[{"_id":"source/.DS_Store","hash":"c4df42ac1b4d900e085609523fdcb82bcbd5c194","modified":1511491524000},{"_id":"themes/icarus/.DS_Store","hash":"74c354f5bf3e340b4878e552486208a29c6659de","modified":1511427035000},{"_id":"themes/icarus/LICENSE","hash":"df00918fa95de563927fd92b26f14c7affdc3052","modified":1480496898000},{"_id":"themes/icarus/README.md","hash":"1501a086a770310f7ac75c4a1dd511baee73912b","modified":1511429639000},{"_id":"themes/icarus/_config.yml","hash":"65a3eb16f412a9d2fcd4134122aaaaa16b468213","modified":1512628352000},{"_id":"themes/icarus/package.json","hash":"1bc52ef10a33df23e56bd73c927f605019c87d41","modified":1480496898000},{"_id":"source/_posts/2014-12-23-hello-world.md","hash":"e1eb3094eba0f04d413117d7e417cae8e5708023","modified":1511166985000},{"_id":"source/_posts/2015-01-27-android-open-sources.md","hash":"3b92ce38349dd8088fbd996e0d8f7a7d625eb387","modified":1511421825000},{"_id":"source/_posts/2015-03-16-java-multithreading-concurrent.md","hash":"5972b69d61a4df94aee93d09fd3e393d816e072c","modified":1511420322000},{"_id":"source/_posts/2015-11-06-book-list-of-2015.md","hash":"8197f40fe16803ebd29ce8213f63b58103256706","modified":1482748875000},{"_id":"source/_posts/2016-03-01-android-googlemap-summary.md","hash":"2c119bbc28223c99ec77d54061cdfa7f27f60637","modified":1511421836000},{"_id":"source/_posts/2016-03-15-facebook-google+signin.md","hash":"91af959e69f3402137458d3b0ad8b2789902e1fc","modified":1511421839000},{"_id":"source/_posts/2016-03-20-android-new-knowledge-summary.md","hash":"7cfa066a5219fcc3cae3aedff114f3941f253224","modified":1512455631000},{"_id":"source/_posts/2016-03-20-android-books-reading-.md","hash":"5cb78852de1031a0a96011318d2cc1a039a71605","modified":1511421843000},{"_id":"source/_posts/2016-05-12-GCM-Azure_summary.md","hash":"710656060c843b64690188d154960f2e835f173d","modified":1511421850000},{"_id":"source/_posts/2016-05-18-javaString-and-bytes.md","hash":"7e74d49a00c83d1a3623e488c2b5b31dacfce7a7","modified":1511420659000},{"_id":"source/_posts/2016-05-24-JNI-Learning.md","hash":"dbb1e27c6be08b36b8ee0444500c490c3c456cf3","modified":1511420674000},{"_id":"source/_posts/2016-05-24-JNI-Learning0.md","hash":"0bdcd2891d5d6d949be57c8f0d6ebdb997bcf823","modified":1511420709000},{"_id":"source/_posts/2016-06-08-gson-summary.md","hash":"6cd7ac6dddf71e3fdf7cbc6673d8636dcd17462f","modified":1511420738000},{"_id":"source/_posts/2016-05-28-qiniu-android-summary.md","hash":"d56b562fdbeeffa19316fa2651fdb1f17f320085","modified":1511421859000},{"_id":"source/_posts/2016-07-25-android-webview-summary.md","hash":"5dfc557c32325d20523e79950a6eceadf91772e4","modified":1511421864000},{"_id":"source/_posts/2016-08-03-android-LocationListener.md","hash":"8c468ca1fc63250d5bfec12ba032ba1c7a4951b4","modified":1511421867000},{"_id":"source/_posts/2016-08-16-RxAndroid-Learning.md","hash":"2a4c3a895205d7987f072907a7394bab646f8197","modified":1511420784000},{"_id":"source/_posts/2016-09-05-ThreadLocal-HandlerThread-Looper.md","hash":"7a1932dd14875c7578983577390ebbfaf9bbf762","modified":1511420802000},{"_id":"source/_posts/2016-09-20-AVG-unwanted-software.md","hash":"f90da273632d7a46b7968e006fe94f075564cf75","modified":1511421886000},{"_id":"source/_posts/2016-09-20-android-design-pattern-singleton.md","hash":"6e3fe27628e2fcc2e9332ffe0ad5709360454d28","modified":1511421882000},{"_id":"source/_posts/2016-09-22-JNI-get-publickey.md","hash":"54abc064a92d87e5e8e086e3435562fd16c9a532","modified":1511420898000},{"_id":"source/_posts/2016-10-12-gradle-learning.md","hash":"48078e8e15883a46ecc1f4c68ef1df83ffb799e1","modified":1511420966000},{"_id":"source/_posts/2016-09-22-quit-whole-application.md","hash":"1727b4e0ccfa8926cc6b41f90aa4806b35629b2b","modified":1511421892000},{"_id":"source/_posts/2016-09-28-Android-interview-questions.md","hash":"96327f4d9e7f0af33edcffbf1834340816cf2386","modified":1511421895000},{"_id":"source/_posts/2016-11-03-hexo-mac-module-not-found.md","hash":"531997acd6408c06d6c50b9e4e113b179fd86410","modified":1511420986000},{"_id":"source/_posts/2016-10-13-gradle-learning2.md","hash":"164ab15eb78cb7248efb09e4eea9e1cf5bfb3d9f","modified":1511420973000},{"_id":"source/_posts/2016-11-21-Difference_between-T-E-K-V.md","hash":"45ae07766ede0435b1e9ac458789e369f6b0bd28","modified":1511421079000},{"_id":"source/_posts/2016-12-06-hexo-learning1.md","hash":"a099c19126aef6f8880bc57b556669fdac730da5","modified":1511421107000},{"_id":"source/_posts/2016-12-04-hexo-learning0.md","hash":"ed12ca2781d145b43300cf160a193b0393785f8f","modified":1511421093000},{"_id":"source/_posts/2016-12-11-ThreadLocal-usage.md","hash":"44aef0847becbd58254e010a1648bbe07defa9e4","modified":1511421122000},{"_id":"source/_posts/2017-01-13-abroad-IM-service-company.md","hash":"764ff04003cb0a424df1d40dc05b915e27ca273d","modified":1511421167000},{"_id":"source/_posts/2016-12-20-Android-patch-update.md","hash":"8fbad0e5edcbefa74f1b7812ede13f1a5f7c5261","modified":1511421912000},{"_id":"source/_posts/2017-02-12-iterm2-to-linux.md","hash":"d94326c2ba75ddeb588a367daf4a9fa7dee79bbf","modified":1511421189000},{"_id":"source/_posts/2017-02-21-Multi-Process-Dispatch.md","hash":"9d08b4a2ebc6ca53aaece2aff6099e6511510ef9","modified":1511421919000},{"_id":"source/_posts/2017-03-20-SVN-server-linux.md","hash":"5f912aaca2232a6960305c64a69aec3ac7e503a1","modified":1511421245000},{"_id":"source/_posts/2017-03-09-Https-Questions.md","hash":"73cc1a816351366e1584a943e20e47997aa73e40","modified":1511421209000},{"_id":"source/_posts/2017-03-14-JAVA-CDI-Assertion.md","hash":"ccd6b413d9bf4c76b35853579e1236df0e605687","modified":1511421235000},{"_id":"source/_posts/2017-04-10-Annotation-Android-usage.md","hash":"a19f2859d7af1fcb2563d058b31df58080af40fd","modified":1511421929000},{"_id":"source/_posts/2017-05-11-Object-Oriented.md","hash":"141b8824f45086f68c0ff94f718b9cffd17e9c56","modified":1511421317000},{"_id":"source/_posts/2017-07-12-android-noroot-hook.md","hash":"e9643d071d870580925136bc8241770d5ab9fd51","modified":1511421944000},{"_id":"source/_posts/2017-05-18-handler-replace-timertask.md","hash":"139e9e8baba52b979e609adfd8c34919fcf6d248","modified":1511421328000},{"_id":"source/_posts/2017-07-08-android-binder-principle.md","hash":"ebe05051768e1cc19ba52663b7e65d9187b0324f","modified":1511421337000},{"_id":"source/_posts/2017-08-01-aosp-compile.md","hash":"e0e1895ce24316eb6be13b268e7b95c9b79f8f0f","modified":1512454879000},{"_id":"source/_posts/2017-07-10-android-binder-principle2.md","hash":"dbb804b4606715bb259477e2b2fadc4bd53702ef","modified":1511421348000},{"_id":"source/_posts/2017-08-02-activity-start-process.md","hash":"d8f8ff509d579343d7730d17692aec51cd915c57","modified":1511421601000},{"_id":"source/_posts/2017-08-17-IntervieweeQuestions.md","hash":"907bd0fc9d7a22f591c26b664180e3ac29944171","modified":1511492515000},{"_id":"source/_posts/2017-09-21-PBOCKonwledgeCode.md","hash":"4a64eb34b2161c264c007c4a6e133ea8bd7f4923","modified":1512628483000},{"_id":"source/_posts/2017-09-12-PBOCKonwledge.md","hash":"e66b7bcda4f72494f08142fe3c2ba21ee0983017","modified":1512628503000},{"_id":"source/_posts/2017-10-22-Buildcross-platform-desktop-apps.md","hash":"bba80b238050276d1b664ea162fd5a0c92c127e5","modified":1512629179000},{"_id":"source/about/index.md","hash":"a20e731a33e6ce7ad90c801b136e6fb42f5b3ee9","modified":1489389942000},{"_id":"source/categories/index.md","hash":"55bee2cb88da438a2e8b1f29b1d7e954c07a9e60","modified":1482748875000},{"_id":"source/_posts/2017-10-22-JavaScript-knowledge.md","hash":"69e36664e2f51c5b7e3d8d030f0445ce66647060","modified":1512630360000},{"_id":"source/images/.DS_Store","hash":"1f8fdf96d0f618f08d32cb78b496dd949f51c65d","modified":1510121179000},{"_id":"source/images/avatar.png","hash":"2daa0d02ee54bee9a6968e098013fb37a7fab7bc","modified":1482748875000},{"_id":"source/tags/index.md","hash":"e999413d6392c34156b5c6e9273f9069f9e6d92d","modified":1500363327000},{"_id":"themes/icarus/.git/HEAD","hash":"acbaef275e46a7f14c1ef456fff2c8bbe8c84724","modified":1511423656000},{"_id":"themes/icarus/.git/COMMIT_EDITMSG","hash":"6d12db47b17cafb6861f99403a7769cba0407991","modified":1511430074000},{"_id":"themes/icarus/.git/ORIG_HEAD","hash":"435fde90cb49bdded78a567c87068633f1888ab6","modified":1511429639000},{"_id":"themes/icarus/.git/FETCH_HEAD","hash":"bd8b43d5492bbee4f7435ccb4248958d10cbf8af","modified":1511429639000},{"_id":"themes/icarus/.git/config","hash":"2788131ffcd313983161072e7540e5be4ceb9926","modified":1511424914000},{"_id":"themes/icarus/.git/description","hash":"9635f1b7e12c045212819dd934d809ef07efa2f4","modified":1511423656000},{"_id":"themes/icarus/.git/index","hash":"265910861e586e8e630a3bd71d9cd692b2ed1ec4","modified":1512628382000},{"_id":"themes/icarus/_source/.DS_Store","hash":"2b56d4cc3f23c20ad6ec6722b6232c801c1248f3","modified":1511424136000},{"_id":"themes/icarus/gallery/.DS_Store","hash":"df2fbeb1400acda0909a32c1cf6bf492f1121e07","modified":1480595851000},{"_id":"themes/icarus/languages/en.yml","hash":"ade241498b85503a8953a1deca963222f47067a7","modified":1480496898000},{"_id":"themes/icarus/languages/es.yml","hash":"d7432219be5bee4cb569331378ade61b749688e0","modified":1480496898000},{"_id":"themes/icarus/languages/fr.yml","hash":"cb3e597cbec7e8f458858c457bafd1f3a225083d","modified":1480496898000},{"_id":"themes/icarus/languages/ko.yml","hash":"7c4ad4577dc0577ad2ca1c0410507f5e5fadf530","modified":1480496898000},{"_id":"themes/icarus/languages/ja.yml","hash":"ff972961e5f468a695d80d21b62c3e9032cdf561","modified":1480496898000},{"_id":"themes/icarus/languages/id.yml","hash":"70ec9ab2ac04cf882e81377ca5ad15bf8adceca8","modified":1480496898000},{"_id":"themes/icarus/languages/ru.yml","hash":"d1aab2b0c939d0c6020f881d664b660a01ee7327","modified":1480496898000},{"_id":"themes/icarus/languages/tr.yml","hash":"8b7eb6aec264db50dbabea89f680acca256f4cd1","modified":1480496898000},{"_id":"themes/icarus/languages/pt-BR.yml","hash":"3c5d5293575593705b9a2dfa9d97b017eb4bc8c3","modified":1480496898000},{"_id":"themes/icarus/languages/zh-CN.yml","hash":"3dc8ec524805afd090438be717908750da439204","modified":1480496898000},{"_id":"themes/icarus/languages/zh-TW.yml","hash":"d8d96a0a17c20af11919ce036e87379a6b163db9","modified":1480496898000},{"_id":"themes/icarus/layout/.DS_Store","hash":"aec64551d1069c963cc8379910a24dc9a8d228e7","modified":1495509051000},{"_id":"themes/icarus/layout/categories.ejs","hash":"aa95629b770cff8cca9d663aeb6b17928f070de5","modified":1480496898000},{"_id":"themes/icarus/layout/about.ejs","hash":"96f4047eaafef54708dc3581c32542620f157251","modified":1489389901000},{"_id":"themes/icarus/layout/archive.ejs","hash":"838b964491b580b2243f54782f4899ade56cc822","modified":1500363065000},{"_id":"themes/icarus/layout/category.ejs","hash":"1d407f9176db84e83062c52ad4755aaea9e74401","modified":1480496898000},{"_id":"themes/icarus/layout/index.ejs","hash":"b5a0144d28aade461773376d987fd0e51bedf87a","modified":1489388794000},{"_id":"themes/icarus/layout/layout.ejs","hash":"b24c3cdc1b82e21c086847324680e12293c57fa3","modified":1511418897000},{"_id":"themes/icarus/layout/page.ejs","hash":"50170783bac99946ae8af483920568de9b2d9801","modified":1480496898000},{"_id":"themes/icarus/layout/post.ejs","hash":"50170783bac99946ae8af483920568de9b2d9801","modified":1480496898000},{"_id":"themes/icarus/scripts/meta.js","hash":"1993754a2f3dffa283fa0538eb8f056385b69ad4","modified":1480496898000},{"_id":"themes/icarus/scripts/thumbnail.js","hash":"e667a611f9baac270281b765832020d50bf8fb7f","modified":1480496898000},{"_id":"themes/icarus/layout/tag.ejs","hash":"f6c220d4e5c231028bc71ddc11aec97d7b5a9943","modified":1480496898000},{"_id":"themes/icarus/layout/tags.ejs","hash":"d9f4ad20ce3e80de0898c8e3747c3e21cda80fa9","modified":1500360418000},{"_id":"themes/icarus/source/.DS_Store","hash":"39d1d308dd6d7887019d88cb625c5ba4f52fb469","modified":1511423285000},{"_id":"source/_posts/2016-12-03-nodejs-learning-getting-started.md","hash":"358ea9a0168841377dd11f46092689e2f046b06f","modified":1511421012000},{"_id":"source/images/icon.png","hash":"342e89a86946e3178b4ff79b6cbb64b33d787814","modified":1500356731000},{"_id":"source/images/blogimages/.DS_Store","hash":"d89267ec052c123dc0dfa82ac46467722fbfdbc2","modified":1512633870000},{"_id":"themes/icarus/.git/hooks/applypatch-msg.sample","hash":"4de88eb95a5e93fd27e78b5fb3b5231a8d8917dd","modified":1511423656000},{"_id":"themes/icarus/.git/hooks/commit-msg.sample","hash":"ee1ed5aad98a435f2020b6de35c173b75d9affac","modified":1511423656000},{"_id":"themes/icarus/.git/hooks/pre-applypatch.sample","hash":"f208287c1a92525de9f5462e905a9d31de1e2d75","modified":1511423656000},{"_id":"themes/icarus/.git/hooks/pre-push.sample","hash":"5c8518bfd1d1d3d2c1a7194994c0a16d8a313a41","modified":1511423656000},{"_id":"themes/icarus/.git/hooks/post-update.sample","hash":"b614c2f63da7dca9f1db2e7ade61ef30448fc96c","modified":1511423656000},{"_id":"themes/icarus/.git/hooks/pre-rebase.sample","hash":"30d535af785d92858ce32401b4a3e4112a43333f","modified":1511423656000},{"_id":"themes/icarus/.git/hooks/pre-commit.sample","hash":"36aed8976dcc08b5076844f0ec645b18bc37758f","modified":1511423656000},{"_id":"themes/icarus/.git/hooks/prepare-commit-msg.sample","hash":"5cec52bb8a03dbc279920c46261751252e0ac96d","modified":1511423656000},{"_id":"themes/icarus/.git/info/exclude","hash":"c879df015d97615050afa7b9641e3352a1e701ac","modified":1511423656000},{"_id":"themes/icarus/.git/hooks/pre-receive.sample","hash":"705a17d259e7896f0082fe2e9f2c0c3b127be5ac","modified":1511423656000},{"_id":"themes/icarus/.git/hooks/update.sample","hash":"e729cd61b27c128951d139de8e7c63d1a3758dde","modified":1511423656000},{"_id":"themes/icarus/.git/logs/HEAD","hash":"69675ef6c9c6231bb428df0d2a8ae45c8e35971c","modified":1511430074000},{"_id":"themes/icarus/_source/about/index.md","hash":"2847759c65295fdc47685cc32e10ae30b2f022ae","modified":1480496898000},{"_id":"themes/icarus/_source/tags/index.md","hash":"e999413d6392c34156b5c6e9273f9069f9e6d92d","modified":1480496898000},{"_id":"themes/icarus/_source/categories/index.md","hash":"55bee2cb88da438a2e8b1f29b1d7e954c07a9e60","modified":1480496898000},{"_id":"themes/icarus/layout/comment/disqus.ejs","hash":"1b32a90f400dc580f4b8298de75b94429ca6de68","modified":1480496898000},{"_id":"themes/icarus/layout/comment/counter.ejs","hash":"5033b804adeb15f5a2db06cae73f2ac96b436d69","modified":1495523649000},{"_id":"themes/icarus/layout/comment/commentit.ejs","hash":"102e61482aa89c85478d090b96c26ce3457d4a4d","modified":1494488354000},{"_id":"themes/icarus/layout/comment/changyan.ejs","hash":"b4bd2e641af59e06becaa8f2dc97867f023b8dcf","modified":1491956064000},{"_id":"themes/icarus/layout/comment/duoshuo.ejs","hash":"ce46d7410a99b57704da32e9d09071cef6c9fa93","modified":1480496898000},{"_id":"themes/icarus/layout/comment/gitment.ejs","hash":"8e7686b5d9671cf20b22b7747b3a1b73548e2255","modified":1495526900000},{"_id":"themes/icarus/layout/comment/facebook.ejs","hash":"5ee16430a4435c2fead0275ff83fc98092d73d4c","modified":1491956064000},{"_id":"themes/icarus/layout/comment/index.ejs","hash":"2edc671fe6712cefca3a56e769cb508cc79a3fc5","modified":1495523361000},{"_id":"themes/icarus/layout/comment/isso.ejs","hash":"4f8b81ff5bb418ec11ce080d515f247bfe436014","modified":1491956064000},{"_id":"themes/icarus/layout/comment/youyan.ejs","hash":"266b58604af33a64e5d61b4f11909aa05a0cc7b9","modified":1495508758000},{"_id":"themes/icarus/layout/comment/scripts.ejs","hash":"91c34df596a77b09e999d20112eddde814552b2d","modified":1495520128000},{"_id":"themes/icarus/layout/common/.DS_Store","hash":"fe3a1b2077d038bf1c41e6251a1ecc40f9440fd1","modified":1482902599000},{"_id":"themes/icarus/layout/common/category1.ejs","hash":"60c571b602dd84e2ea4b040a35f8a3a33fe969be","modified":1487128351000},{"_id":"themes/icarus/layout/common/article.ejs","hash":"f7fc813a1835baecd5c7596c393c5a05b415ad34","modified":1511419408000},{"_id":"themes/icarus/layout/common/footer.ejs","hash":"cbfe560fcab445d42ceeb5d1beba5957d5be5eaa","modified":1480496898000},{"_id":"themes/icarus/layout/common/head.ejs","hash":"cc7b168c338181dca06e8aa4582dd786c3168a96","modified":1511344650000},{"_id":"themes/icarus/layout/common/header.ejs","hash":"c4d986352522524860908cc5887bca08cf1f2b12","modified":1511254889000},{"_id":"themes/icarus/layout/common/scripts.ejs","hash":"c0a1a9e53f89440c42c325d5bd8c7234652c8937","modified":1480496898000},{"_id":"themes/icarus/layout/common/profile.ejs","hash":"0bdf655752c28fbc9b66bd5ca3e27ba7f9158b9d","modified":1511429891000},{"_id":"themes/icarus/layout/common/timeline.ejs","hash":"6420e34e0332c9b6670011519f341340db989343","modified":1480496898000},{"_id":"themes/icarus/layout/common/thumbnail.ejs","hash":"1b70f8a98cd8650b159bda858dbee38dbdb7f0c5","modified":1480496898000},{"_id":"themes/icarus/layout/common/sidebar.ejs","hash":"300a2d5b3dd2524739aedef5b8fe127e423bdda2","modified":1512628120000},{"_id":"themes/icarus/layout/plugin/scripts.ejs","hash":"4fdb85e6730530f2d262041b41d1ead1b87dfd88","modified":1480496898000},{"_id":"themes/icarus/layout/search/index-mobile.ejs","hash":"50a727ac1dfe3073eb6fa6699ba01e66f4ac41c0","modified":1480496898000},{"_id":"themes/icarus/layout/plugin/baidu-analytics.ejs","hash":"6a7bee18e666e627e62541a5e30906f87ba1bfe8","modified":1480496898000},{"_id":"themes/icarus/layout/search/insight.ejs","hash":"130fe3d33ac71da0b50f7fee6a87979f30938a1b","modified":1480496898000},{"_id":"themes/icarus/layout/plugin/google-analytics.ejs","hash":"349f08b6521a16e79046b1f94f04317ac74f556e","modified":1480496898000},{"_id":"themes/icarus/layout/search/swiftype.ejs","hash":"379e66d2c13526e72e4120c443f95fccf4edef71","modified":1480496898000},{"_id":"themes/icarus/layout/share/addtoany.ejs","hash":"ac180c4c84b73a04d61b17e7dc18c257e20bf59f","modified":1480496898000},{"_id":"themes/icarus/layout/search/baidu.ejs","hash":"3e603a702d20c53fd3bcbeb570a16a86d54781ce","modified":1480496898000},{"_id":"themes/icarus/layout/search/index.ejs","hash":"24935e32e61d4706454b174ea3bed0726ae7fb34","modified":1480496898000},{"_id":"themes/icarus/layout/share/default.ejs","hash":"ebfb919dc525b3ed61a6a5ee05ee71410eedc541","modified":1480496898000},{"_id":"themes/icarus/layout/share/index.ejs","hash":"2a2c0095b95b11e5692bd8ad6a2337aa644189a2","modified":1480496898000},{"_id":"themes/icarus/layout/share/bdshare.ejs","hash":"a1e772c5a6f174d585b0c1e574058f75dc8e2898","modified":1480496898000},{"_id":"themes/icarus/layout/share/jiathis.ejs","hash":"21ebaa51e828cba2cefbeeaccb01514643565755","modified":1480496898000},{"_id":"themes/icarus/layout/widget/.DS_Store","hash":"df2fbeb1400acda0909a32c1cf6bf492f1121e07","modified":1486362350000},{"_id":"themes/icarus/layout/widget/archive.ejs","hash":"d9ebbb7f6ce2f25df5ae25e4a1fef3c08f7054b9","modified":1480496898000},{"_id":"themes/icarus/layout/widget/category.ejs","hash":"9034e27649a433dcc4ba1c3edf88a1e894bde643","modified":1486362836000},{"_id":"themes/icarus/layout/widget/links.ejs","hash":"aad118699718b62c0d3f3cfd6f17a181139a76af","modified":1480496898000},{"_id":"themes/icarus/layout/widget/recent_posts.ejs","hash":"2ca923465275fb38a7ac7d67211d6e94a977e957","modified":1480496898000},{"_id":"themes/icarus/layout/widget/tagcloud.ejs","hash":"ca8c7bf555fb6ce4904f2c59160548405c2c8a82","modified":1480496898000},{"_id":"themes/icarus/layout/widget/tag.ejs","hash":"3b8ae5953990436893da9d68f910ebe592005659","modified":1512628381000},{"_id":"themes/icarus/layout/widget/toc.ejs","hash":"afe15f602d6b9d789791fe9060f32e8288845f54","modified":1512628347000},{"_id":"themes/icarus/source/css/_extend.styl","hash":"9a5c72663c0da1b32ecb6a75773a5ccfb8c467ca","modified":1480496898000},{"_id":"themes/icarus/source/css/.DS_Store","hash":"3399f1cc05511d38c954f9357ab3d0a99ece2147","modified":1511239251000},{"_id":"themes/icarus/source/css/_variables.styl","hash":"54cd0e2d8708350517b4be5982244c32395e6959","modified":1511257955000},{"_id":"themes/icarus/source/css/style.styl","hash":"82aa42f9826dc14e9e0d6443af6e253029e7fee6","modified":1480496898000},{"_id":"themes/icarus/source/images/.DS_Store","hash":"df2fbeb1400acda0909a32c1cf6bf492f1121e07","modified":1482718102000},{"_id":"themes/icarus/source/js/insight.js","hash":"6ee84c42c2b230ff9e9bf605a444bd671d44f9e3","modified":1480496898000},{"_id":"themes/icarus/source/images/avatar.png","hash":"2daa0d02ee54bee9a6968e098013fb37a7fab7bc","modified":1480497902000},{"_id":"themes/icarus/source/images/favicon.ico","hash":"e64542caa1b7a07484925304cd99c93129dfce8e","modified":1482718701000},{"_id":"themes/icarus/source/js/particle.js","hash":"4ec4c6586584c7533e8e2f745b4cb6b9241f4179","modified":1486207168000},{"_id":"themes/icarus/source/js/main.js","hash":"80cde22d84fad8be4d7dc77c0cdf8eb8f01f8903","modified":1511342235000},{"_id":"themes/icarus/source/libs/.DS_Store","hash":"3878ce27bacf56c19657c95e20a7658642bd1ed2","modified":1511423285000},{"_id":"themes/icarus/source/css/bootstrap.min.css","hash":"c200606a34a69549ed093b29ec81b9008d8658f2","modified":1511244198000},{"_id":"source/images/blogimages/2016/ThreadLocal.png","hash":"29a37aefd8f9aa455e5f5e41d56d374184c8694b","modified":1482977555000},{"_id":"source/images/blogimages/2016/androidart_broadcastreceiver1.png","hash":"dc4a97d2b8ef1f6592717204788d9f716117fdee","modified":1482748875000},{"_id":"source/images/blogimages/2016/avg_warning.PNG","hash":"1b8817b076f48cf8217439e0265cb4216abb3d17","modified":1482748875000},{"_id":"source/images/blogimages/2016/google_servcie_ads.PNG","hash":"10c107e578bcfb28ee9f38c247f62cb99f14ea1a","modified":1482748875000},{"_id":"source/images/blogimages/2016/gradle_structure1.png","hash":"0b8c1f213bb88852ecb0fd8a50b60f310d6a23e8","modified":1482748875000},{"_id":"source/images/blogimages/2016/gradle_structure2.png","hash":"6a8aefb3577950beeba2900f507e749dd518345e","modified":1482748875000},{"_id":"source/images/blogimages/2016/jni_structure.png","hash":"312696c9a056a734ff63d9457ff0bb83f356f057","modified":1482748875000},{"_id":"source/images/blogimages/2016/gradle_task.png","hash":"6890da207d5772a6f141024267547db56e9bec38","modified":1482748875000},{"_id":"source/images/blogimages/2017/.DS_Store","hash":"27ba3c2b25d479eab8a67e68616116f714272c65","modified":1510121216000},{"_id":"source/images/blogimages/2017/PackageManagerService.png","hash":"c796723407d80b2252667add5e2734f7f80f5cd0","modified":1499665537000},{"_id":"source/images/blogimages/2017/apt_processor.png","hash":"9b75b07d395db890bef153daf95f0f4a365e4576","modified":1491809767000},{"_id":"source/images/blogimages/2017/binder-02.png","hash":"014d8a4c1061ae8186a59095694eafbc96aad029","modified":1503649151000},{"_id":"source/images/blogimages/2017/binder-01.png","hash":"cdedd11dc6e75fe0a5cef7d313624ae31be881d3","modified":1503648592000},{"_id":"source/images/blogimages/2017/binder-open-drive.png","hash":"0ef23b58ba4f06233d0f3cfef4fbccf27e2dbdf3","modified":1499739342000},{"_id":"source/images/blogimages/2017/binder-service-manager.png","hash":"b99d44d9bf79a26bff169c7ece70abf7dc6fb3de","modified":1499736581000},{"_id":"source/images/blogimages/2017/binder-system-service.png","hash":"d388f2e4cdd90e1e7ebcf4ad85c0af6c98427c74","modified":1499667374000},{"_id":"source/images/blogimages/2017/device-number.png","hash":"50005dc453a70edab64d828508b2ba139c0df338","modified":1499739087000},{"_id":"source/images/blogimages/2017/clipboard-ipc-process.png","hash":"2419837d48fca339b19e6a3a6d053301699e20c4","modified":1499760915000},{"_id":"source/images/blogimages/2017/funny_pic.jpg","hash":"fd45920ce6bdb70e1af2a56998700b8ce717d06f","modified":1487742804000},{"_id":"source/images/blogimages/2017/getStrongProxyForHandle.png","hash":"e3f3167645262e911feabc39e8fc4431c1fb5027","modified":1499738051000},{"_id":"source/images/blogimages/2017/ibinder-binder.png","hash":"844df893c87e22eae853536204010d88a9df745f","modified":1498808414000},{"_id":"source/images/blogimages/2017/processor_jar.png","hash":"f1b9bb1ab096157303f4cb9c50904f485add7782","modified":1491792208000},{"_id":"source/images/blogimages/2017/servicemanager-find-service.png","hash":"ea408c25c09bc94103d68ed23941a3cebd8c18f9","modified":1499736754000},{"_id":"source/images/blogimages/2017/transact-binder.png","hash":"49129266297f97d7883900dda0304c3a2f5cc3a7","modified":1499739421000},{"_id":"themes/icarus/.git/refs/heads/master","hash":"b1147ee86a529ed7adf2e25ca93d0ba7b2ffc15c","modified":1511430074000},{"_id":"themes/icarus/.git/objects/00/2c5777e2314e5f1893034868b9e5dc81a87c70","hash":"2e226d3d995ba56aedc6587afa705b8102338f7a","modified":1511424067000},{"_id":"themes/icarus/.git/objects/03/0636ccc4c9056d0332006ba69266d1a8dd2ff1","hash":"6b93db8fb1d8277083e7f747c57f92fc1f46f164","modified":1511424067000},{"_id":"themes/icarus/.git/objects/01/571d0a938d80178868b266063246b0fca2c1d8","hash":"4f9ee4b6ca0ea1f5038114fcc26b097bdd357271","modified":1511424067000},{"_id":"themes/icarus/.git/objects/03/b166f8bf40ccfd6056b004f5ba0289188d4648","hash":"31851f0894b13d44bf722268813f5841748581be","modified":1511424067000},{"_id":"themes/icarus/.git/objects/00/c99364e50d82189b7894fed6c6dda039cb1930","hash":"83215bd18b782b959629fda28a9db12bb7a3ad62","modified":1511424067000},{"_id":"themes/icarus/.git/objects/06/8fdb3cbb032d5cb0f10359bf02590ad99b275d","hash":"0c20f8c308286463474d3c64b302cab08e805f95","modified":1511424067000},{"_id":"themes/icarus/.git/objects/05/d77b13ea022fb04edd3f786633ceb40cc7722f","hash":"e807bcdc8179067d5410dd47b62686fc968fb53a","modified":1511424067000},{"_id":"themes/icarus/.git/objects/0a/d84077e73345a9f7ca0bda4fd23985ec58b3f6","hash":"215e0d5e216e7e17dcdfc9f1bab96f0d83891528","modified":1511424067000},{"_id":"themes/icarus/.git/objects/06/00e9c0ddf3203e64506822dff38fc8afd34a07","hash":"917f0dfb801d8644f16ae84baa34db350eb329ac","modified":1511425581000},{"_id":"themes/icarus/.git/objects/09/ae4e1f0c28b933cbe80945c2eecec7358eed66","hash":"0f132967643d17a5bca0d1ee240ec57e5a44807a","modified":1511424067000},{"_id":"themes/icarus/.git/objects/0c/00b9ba1edda04312265f1c62323483230fe74c","hash":"826f0fce7e7a0f0c3ed403ac973d9f624535e533","modified":1511424067000},{"_id":"themes/icarus/.git/objects/0b/5a66eb4ca09f9562bbec0f01a11c271eb1ede3","hash":"10755d1701861c7771f998f8687766b6d0322512","modified":1511424067000},{"_id":"themes/icarus/.git/objects/0c/633e06023b6223d4c2e5b4816e1b45727e64ca","hash":"6deedf1b06a40974b79726ed4e253e553b892009","modified":1511424067000},{"_id":"themes/icarus/.git/objects/0b/24ef63b75049df31ba6f7aa2d585af399c2e8e","hash":"392950829c351987ec5727ce8bf631239d34e069","modified":1511424067000},{"_id":"themes/icarus/.git/objects/0c/e57137902d91d27e6db61ff19ac9cf2e130d5d","hash":"1519e89be7ec729ff951f1fa2caf9305521d9289","modified":1511424067000},{"_id":"themes/icarus/.git/objects/0d/3373bb5c995f3a810f9275351bb7de2a56d6ca","hash":"4fb36ab87fe55e4be8da340a6ad9681fc5a498ed","modified":1511424067000},{"_id":"themes/icarus/.git/objects/10/6d16dba2711c3408ae8ebcc78e7b9b1868afdf","hash":"1eec1784ba4db6e87252e1a8dcd8ef2a68f59c3d","modified":1511424067000},{"_id":"themes/icarus/.git/objects/10/84d52c2e11c679ca81ef3628266b203f905cf1","hash":"e43913ab091e25b825561a55e19ededde4cff7d0","modified":1511424067000},{"_id":"themes/icarus/.git/objects/12/ed67c1f63d095899faa81ee4ab1a4ae641736d","hash":"9ac07e80e3979a58813e99f0ffffa35b84e8fcc6","modified":1511424067000},{"_id":"themes/icarus/.git/objects/10/a76f047fe6d3bfa302f2be9a8bff143bcb4a5f","hash":"10d8fff71ed0c04a15805c3f072b59ca105ce270","modified":1511424010000},{"_id":"themes/icarus/.git/objects/0e/ab8a89c770d46b9f1e8f837ec8be3d03f4e54c","hash":"cd8d3dbd8e01eb1000a25505edeb2db93061ff6a","modified":1511429639000},{"_id":"themes/icarus/.git/objects/1c/1b0669f22604858fd5d116455b109dc03782c6","hash":"4eddfd7e25365cad73aceb7c5e69c15804d7b8db","modified":1511429547000},{"_id":"themes/icarus/.git/objects/1c/fd9363aafc9ff0126e2966e647d689a170ea40","hash":"477e4a94d7a3ecf0f91bd0d10865bc5aac289add","modified":1511429639000},{"_id":"themes/icarus/.git/objects/0f/e620040a7c99ef3013968943b53032226a2dd8","hash":"e45c05e6aba825d70da78229a86064373c1ac554","modified":1511424088000},{"_id":"themes/icarus/.git/objects/0f/1eeae6cc213d641514885c2efd0438f8b88724","hash":"b4e07b54afb676f5697f04ae8668f773b130cdab","modified":1511424067000},{"_id":"themes/icarus/.git/objects/16/636e4ebbcea913a219450fa6ff7b641efe636d","hash":"df8169955599a35dcf2b078b788210338190d0de","modified":1511424067000},{"_id":"themes/icarus/.git/objects/19/d364ea1c0dc751ac14f6955d223ee97eca024e","hash":"38abfe2735f1f984a08ce8a82674c704c509557c","modified":1511429639000},{"_id":"themes/icarus/.git/objects/1f/6141d5e4be7bd7708193b3c332da9e83433973","hash":"02391be456a8e5a9236374b04c2f19f550de9a94","modified":1511429639000},{"_id":"themes/icarus/.git/objects/1f/d235c2d3d30c5a545048785f9db2ea1eb6adbb","hash":"9e9459eab14d30b7e28709153bcdb7abc6735dc4","modified":1511424067000},{"_id":"themes/icarus/.git/objects/19/df2cb185b28796f812764a55c2db4168ed0c58","hash":"b1add0c734c1edb9b9cee2f31245bf40111ff0c3","modified":1511425967000},{"_id":"themes/icarus/.git/objects/1e/96c0b5efc5bc7550c508f088c443b29180dd42","hash":"f33ae328db89367053f9b81dd1afbae61d48680a","modified":1511424067000},{"_id":"themes/icarus/.git/objects/24/9b3467d7ddd8fc8a709bf80f7d1c351b383674","hash":"c25f3a2046592e660b641594612750341ab6bdce","modified":1511426171000},{"_id":"themes/icarus/.git/objects/26/23fdbccd4a5a3515d3a736c7143ba3a6576616","hash":"89720a8da6db904859fb65398e625ef6c434253e","modified":1511424067000},{"_id":"themes/icarus/.git/objects/24/fd8a6a200cf15d224c2aa2348fe21f3c36e869","hash":"ba627beaaeaf99526a40e4724b443bbeb7a08882","modified":1511429639000},{"_id":"themes/icarus/.git/objects/26/a4df1f0a8e574b14d72cd53ada21a1edf408fa","hash":"08468bb54076a68779d898b76df14a28973fd6df","modified":1511429606000},{"_id":"themes/icarus/.git/objects/22/3b6a9318e95a427c244c4e51aa69dd06e4ff13","hash":"32906097ba02975f30324903abd872770d22d7b6","modified":1511424067000},{"_id":"themes/icarus/.git/objects/29/2a45b780e07d52bc0489594ed38cac762bc091","hash":"6b1013ec0ead94dcb0694ca5ace935dd947c4638","modified":1511424067000},{"_id":"themes/icarus/.git/objects/22/b1a1ff7046c565f2bc81350f00d64205919dc2","hash":"b01e1968f567b084b8410a64da5e8b285b4f891b","modified":1511424067000},{"_id":"themes/icarus/.git/objects/25/714ed29ab6fcf0355da4b45ac602fac0154efb","hash":"333809419ce99e47ee80ea6c61bd6361b2dd4f6a","modified":1511424067000},{"_id":"themes/icarus/.git/objects/27/b30b9e473877be6e5584618d2fe755ef4089f7","hash":"289439ebb374d627548815fa3995722463663be7","modified":1511424067000},{"_id":"themes/icarus/.git/objects/28/018e97628224a6f3ac18b6d2a21a5f5918ac88","hash":"894eee8674a99c109efcd31aa0714a89b8df4b15","modified":1511424067000},{"_id":"themes/icarus/.git/objects/2a/6cedc8af07e7c613ccb34bfa803726e6d8d7f1","hash":"12858b15f5ddaafa56a1a6f2fbd367c6b413d9db","modified":1511424067000},{"_id":"themes/icarus/.git/objects/2b/0c58a48d486c4172dee02720c0b005693f9fff","hash":"8f09eae3ce543468b0979992900efbd7c3545d4a","modified":1511429547000},{"_id":"themes/icarus/.git/objects/2b/9bfb8171ef34274aabae99db518a2cf5510932","hash":"6a4c47f5d13cc6d7b548df204d76a5ba148f3fa5","modified":1511424067000},{"_id":"themes/icarus/.git/objects/2c/84b0865d2b764c202811aa0c3428e9a40912de","hash":"f20c2c422f45472de1901398e1efa894ddf7f7ce","modified":1511424067000},{"_id":"themes/icarus/.git/objects/2c/5810d5c4b166eb635cd31bf3b637cd281bcbcb","hash":"b0f4f89e337644a351ac39f885f67e2c49a69796","modified":1511424067000},{"_id":"themes/icarus/.git/objects/1d/718e03854f61b23b60635e80066d883fc214fb","hash":"7e1eb955892ca3b49023d0143ed1b129ed4ac523","modified":1511424067000},{"_id":"themes/icarus/.git/objects/2b/8aa922581378d4b37b84bdf73b6b0779e1ec4a","hash":"7c54cab56cd1d0dafc6b31c88efc164e20d15744","modified":1511429639000},{"_id":"themes/icarus/.git/objects/2e/c09b8af9d908548ca8aecb735e7758c264022c","hash":"90f4951d102cbb444405d2f2f276f0a18e091256","modified":1511424067000},{"_id":"themes/icarus/.git/objects/2e/8094d3f21eb7e607d83cb3f89bba8833b48f28","hash":"06a3db28c80aa621a4ffbb4c23a111e048fc1a9d","modified":1511429639000},{"_id":"themes/icarus/.git/objects/2d/fa2f2a4a7de5719220e59cf1cfc92321aa3670","hash":"aa22656bd8a795193787da4746a53837307b95d9","modified":1511424067000},{"_id":"themes/icarus/.git/objects/30/8755bbe32d0f460d0b6d8e098696f2269f6ee2","hash":"7b5c95597bbe22ebd94dfc1d57138d3d9e84a503","modified":1511430044000},{"_id":"themes/icarus/.git/objects/2d/ed6583c40d155cbd7c8186887c0eacd421b5ae","hash":"67cca088fac5d560d8e6326a47094f3bd5bea90e","modified":1511429639000},{"_id":"themes/icarus/.git/objects/34/ef86946527afad9a16e59c9521ad155ab7680d","hash":"3c5831916376083145d28967c9761bc929ac1a33","modified":1511424067000},{"_id":"themes/icarus/.git/objects/32/47ac515ba8e9a82e2d63ce3c47321c79058909","hash":"bffe38ab06e4dc8a7e3da3aae276e9ef469f67ef","modified":1511424067000},{"_id":"themes/icarus/.git/objects/32/e6455538e980eaf05d93ca3b47fe96585e8bb7","hash":"db8e0117d7c393a09dfb79a0d006a90e66b19758","modified":1511424067000},{"_id":"themes/icarus/.git/objects/33/1b4007e171e7b664e0da8a22c9b694d60a3383","hash":"74ef9eecc2f8a9e04eeb45ef7d49a5c507ab5646","modified":1511423747000},{"_id":"themes/icarus/.git/objects/32/f24138a83bc7b154b22322d12ca961cb5432f9","hash":"96e72c28f68bc3c1af1be1a443d19777d5557b58","modified":1511424088000},{"_id":"themes/icarus/.git/objects/33/12f5c354f6f87e3b7dead838e2f1bed38760df","hash":"1458c3ea2322c6c0e28853bc7beb93aac2f632a6","modified":1511429639000},{"_id":"themes/icarus/.git/objects/31/7ff5a1ada5987be7a94de0e638f488d48f142d","hash":"34d5f80d05192eee1ec2347b16a5b4adf235980b","modified":1511429639000},{"_id":"themes/icarus/.git/objects/36/3eedbf59dd05d511f6e5adbae9f74d12dc1028","hash":"361c23d57bbebbec96e322d154dc10af6fdd30d0","modified":1511424067000},{"_id":"themes/icarus/.git/objects/36/1d6d35cd91e5cce616de342aa0f2cbb22715ae","hash":"39f9b41491826402dfbad2b4dc4e51b4ab2367e4","modified":1511424067000},{"_id":"themes/icarus/.git/objects/38/13903dbf9fa7b1fb5bd11d9534c06667d9056f","hash":"5ac60f42d253df324a5a06aacc6c0a07ef9eb0f9","modified":1511424067000},{"_id":"themes/icarus/.git/objects/38/5e3e557033f796093d7e3c6e95d3d8794de0e4","hash":"45a9a05a17bcc30e25ca6b96da07de802247a976","modified":1511429639000},{"_id":"themes/icarus/.git/objects/3a/2d930af88243ae09c94831542762b82590a277","hash":"f10a295810033c1046cea255d574f2b5a414003c","modified":1511425701000},{"_id":"themes/icarus/.git/objects/3a/3dd3cf2e920df91b604ec2f37d2af4e030148b","hash":"02a0872a0d24b02c5777c843932c59e30037b7d9","modified":1511424067000},{"_id":"themes/icarus/.git/objects/3a/85457142ce871e51473b784661b9cf78b859b3","hash":"b10c1ee3643806016d5d699d4337b3551505d383","modified":1511424067000},{"_id":"themes/icarus/.git/objects/3a/82b4b3e0cb8eea59f58ea6e8971dd09749a6ac","hash":"995dd086ed7e87a300e4e5453f7c39a21a99093c","modified":1511429639000},{"_id":"themes/icarus/.git/objects/37/31614923e8577417079ec583767d0a37376992","hash":"af3a2d79517a9519236474bdc9c9c4f087e25b57","modified":1511429639000},{"_id":"themes/icarus/.git/objects/3b/966012ecdfb6651f1c67d4a6e7542c92da760d","hash":"81b67c21446e898dd14897fe097d2c1ab5b31dce","modified":1511424067000},{"_id":"themes/icarus/.git/objects/3f/a874a6a704694a9864e05ce16efd1a7e858cf1","hash":"45cde044cfc18629490a1e20bef03b7554321543","modified":1511424067000},{"_id":"themes/icarus/.git/objects/41/11b36671a856ae9c79c24e0b9c1250604c1064","hash":"62e8d1939cd2bc5f43c126d2e2e696d94e5e3152","modified":1511424067000},{"_id":"themes/icarus/.git/objects/44/d3bd81c8f9659c6757bf471f8a7bce93cfcbd0","hash":"f72bfc08741a7f7b647f668cb4891c171dd54c08","modified":1511424067000},{"_id":"themes/icarus/.git/objects/44/fd827fac26f47d554a754068e4b722659e68e3","hash":"d1218441be6ae8009a9952f35c8c699150bca9ce","modified":1511424067000},{"_id":"themes/icarus/.git/objects/40/1b941bde01cb40b6d82778c706098321846dec","hash":"152958bd4d40133324b519fca988364392270607","modified":1511423828000},{"_id":"themes/icarus/.git/objects/3d/cfbc606f7eadb4791b407a18963cd396eeb9cc","hash":"551bf61b66232808ff4abf020a304bde1b1615b5","modified":1511429639000},{"_id":"themes/icarus/.git/objects/45/614921c67f1e2dee0f3434c6e0343d441323e8","hash":"ef027458201e25b7f9d1684cf8d89bd95e4d9df1","modified":1511424067000},{"_id":"themes/icarus/.git/objects/46/86dba02b31f47bbb8a826e3c75cd06fdb98da2","hash":"8b353031b46f44f4bee38c1ba6b2255d81d6d425","modified":1511429639000},{"_id":"themes/icarus/.git/objects/4b/825dc642cb6eb9a060e54bf8d69288fbee4904","hash":"f9acaead3e977c3d0fb7ad604631d5d838950772","modified":1511424010000},{"_id":"themes/icarus/.git/objects/47/e6c62570ed5edabea5810c31925076307fce1b","hash":"fad9adc5022a0b8d4942392e384103aa9298605e","modified":1511424067000},{"_id":"themes/icarus/.git/objects/48/93540369aae6874662e910323239852ecd3fa5","hash":"ecc0a6559c4564294a59e6ecc0d2e89e34b6dad7","modified":1511424067000},{"_id":"themes/icarus/.git/objects/4b/f876ebd0a3e8a7eb62aefa30100c3024eaf471","hash":"3ae0d36d650b70d8b989a2f0f3e5037055c52417","modified":1511429639000},{"_id":"themes/icarus/.git/objects/48/306000440b5fb93cd847bdf20a5b5edd059335","hash":"c88f74ef258eb5a6cab9d75804ebf8d722eaa7d6","modified":1511429639000},{"_id":"themes/icarus/.git/objects/4d/00ca22e4792f896fac742ae67480de1846f8e2","hash":"805399e61b4260f7031ad3066e8b462b8b4ea1f3","modified":1511424067000},{"_id":"themes/icarus/.git/objects/4c/af5a96ce3a770e460fc268b80f0ed7e212839a","hash":"f39fcfde3ef912ccf4a60faf0ca2401613402eda","modified":1511424067000},{"_id":"themes/icarus/.git/objects/4c/4d9b2b604dec46576dfaf25fe065bf9c9d9b12","hash":"553d813ebb312ae3c33a304349cdb437dd9caaba","modified":1511429639000},{"_id":"themes/icarus/.git/objects/4e/0bd5dcc9065505a762e414558f95d3a812b88a","hash":"26961872dc1c61b2f2c2ef9d24682da85c25f075","modified":1511424067000},{"_id":"themes/icarus/.git/objects/4e/49c7e3cc50632a4405769b7dc3d0a70e3d72f9","hash":"66dd1e40189ffdc04ea0779d522ceaf83a3d7f88","modified":1511424067000},{"_id":"themes/icarus/.git/objects/4e/c922351c57dac2c1dc879d42971eafe938c6e8","hash":"4a445700d7f46dfd8c46511ecb8044e977613cb6","modified":1511424067000},{"_id":"themes/icarus/.git/objects/53/45d1a8068c0324a154f518f027230e60133be0","hash":"a0ff2c7a962a668b609dec2c757d8aaa410a3ff4","modified":1511424067000},{"_id":"themes/icarus/.git/objects/50/d09904d2242f6aa40e51fc4d1b5835cd3e2e98","hash":"8bfba079be5d2f1fe8223748b7df5bf50b33414d","modified":1511430074000},{"_id":"themes/icarus/.git/objects/4f/889139b7dec7b68770c22798a892288a918a09","hash":"fc29a1382857bcc6796fdcde6769d397e7bc6124","modified":1511424067000},{"_id":"themes/icarus/.git/objects/52/87058cf90dd427ca8ad6e330cd339bd257dd9c","hash":"b6549696666ec79c40bf2beb9610673b94b84b0d","modified":1511424067000},{"_id":"themes/icarus/.git/objects/51/16ee65119a9d9d88059d39b62884b19286345b","hash":"ee9b3964ee7aabad1d5ec5a606aad92b53e55f7b","modified":1511424067000},{"_id":"themes/icarus/.git/objects/54/0d0063784d2bd0b49a5c34923270dc3b91d532","hash":"8567b8d35818fc19fc9e4948be8af92e267faa04","modified":1511424067000},{"_id":"themes/icarus/.git/objects/51/264c4fda25feadb007e30ab69bf9b0ddfc1cee","hash":"89ea3e04f852a41832f39300784851dd932b36ca","modified":1511424067000},{"_id":"themes/icarus/.git/objects/54/3f1ba590010c22f642042feb1fc23727ecbe7f","hash":"900ada34da7917d6e5f45f8409366cfedcf652d3","modified":1511424088000},{"_id":"themes/icarus/.git/objects/51/9b4bd6e9c0e6b9aa72438fc70d6a6890b9912f","hash":"1a0b33bbd3186d2010a52dc2730835f431bcb18f","modified":1511429639000},{"_id":"themes/icarus/.git/objects/55/b535060668fd35604a0d88d4afac2e290d050e","hash":"4d3db26f92e2079e59714177382fd66b1f167015","modified":1511424067000},{"_id":"themes/icarus/.git/objects/55/cab16caa03a43643b53566e6304b85691479e2","hash":"2d546390d218efdf3899bf7c60825bab90a18a52","modified":1511424067000},{"_id":"themes/icarus/.git/objects/54/5bf27f36a5d0234d357155bd03ccbdcb831a20","hash":"afaf9a4aa1c8e45fe16d8e7ca1f50d5b16d1f976","modified":1511430074000},{"_id":"themes/icarus/.git/objects/57/8d4627a85f791ee19c8b84c61601ca12efe1ea","hash":"1331ed792a9d74c96c361264f41dc78a9ea8bab9","modified":1511423828000},{"_id":"themes/icarus/.git/objects/56/fa8fb03db67ce54588b8332d132d0fa544b2b6","hash":"2bc92c0986c2c2e462d0cd453bea06a1ec6abe19","modified":1511424067000},{"_id":"themes/icarus/.git/objects/55/fc7709c8c1a3967f5e76c1e766b97e2ea780f7","hash":"b8478744491f60432c9098c908611726db2de34e","modified":1511424067000},{"_id":"themes/icarus/.git/objects/58/77f98bd182c58be248373267ffd24eb5f035f7","hash":"604cfe8da7c8a52764736094e0f91de944d6daa6","modified":1511424067000},{"_id":"themes/icarus/.git/objects/58/adf1f523e1c2bbbb37122cdcaeb8fe58536519","hash":"9b42d7bf346d64a877d92708d5d0be446e1e2cfc","modified":1511425699000},{"_id":"themes/icarus/.git/objects/5c/95357ce239706b6b7598f677e6051ec8eba971","hash":"3db19efaa600fcbe0e2237119094a2a3dd37d655","modified":1511429639000},{"_id":"themes/icarus/.git/objects/58/95b54c15d50620f2e4a730afc7cae2ea80d05a","hash":"67428ee981e86e9c2a0a64270c8619ea2410a0e2","modified":1511424067000},{"_id":"themes/icarus/.git/objects/5c/5ee5c82df07de8c96fe1eea7f90b911f26ce91","hash":"b53726690ce615aa4e7329ff3a02afc192b3c05c","modified":1511424067000},{"_id":"themes/icarus/.git/objects/5a/536ec45f62798f8a5e25340bb3e6502a43cc55","hash":"9eba76652cd9b22da2812df27b8c1a97f6e72ef7","modified":1511424067000},{"_id":"themes/icarus/.git/objects/5a/9d6b12f7480cc153c851aa75ccd26a056922b1","hash":"10f1824fcc787477fdeea7d8de0817112d3712e4","modified":1511424067000},{"_id":"themes/icarus/.git/objects/59/c930f98667c73a42ccb46045d9878b1cd5cdc3","hash":"9cd85ce5e296ba7a4b8d55f766b3508961c6e21b","modified":1511424067000},{"_id":"themes/icarus/.git/objects/5d/83113afa029f3e8055785decc96b82fff45e7b","hash":"d84be0538df865a2372c254b18c1e7630c8777c7","modified":1511424067000},{"_id":"themes/icarus/.git/objects/5d/d5b5eba2ce389d384da0dddcf951792614bd88","hash":"81a259fa37d9266387b86a64e988a9751af58cbc","modified":1511424067000},{"_id":"themes/icarus/.git/objects/61/d2a4e54958dd3371ef7d3019f283381927b663","hash":"55b565bbee045e96e1348b8f9b7db20a985e25d7","modified":1511424067000},{"_id":"themes/icarus/.git/objects/5f/a6f2ecdf8aa3526d7fb42d8b2ea5cb6c7bf7b7","hash":"9eb2a27a77593a4e5d5247242dc20f0208b4b6eb","modified":1511425701000},{"_id":"themes/icarus/.git/objects/61/15cd0934a3c711140afd051f199d1fcf48fa65","hash":"3a7b297c5f62fdafb3a43165d2dfea530e2c437e","modified":1511424067000},{"_id":"themes/icarus/.git/objects/5f/bea1306a6c883bd1cbdf52700ee39607023e04","hash":"52ff4191d011bcd40b669326f3e96be7b33ddc22","modified":1511424088000},{"_id":"themes/icarus/.git/objects/5e/9b5528dc19a7f3fbd46c6570fda2b8ba2a25fc","hash":"399d8b5bc1f8633f84257e68e689a855a5fc0418","modified":1511424067000},{"_id":"themes/icarus/.git/objects/5e/0e1bc127397c6d5427201137acc1a7aca758b0","hash":"537ba2799079b25d13d1e0c4f30bd68b46f7112c","modified":1511424067000},{"_id":"themes/icarus/.git/objects/5e/4754e95a91d800e06caface6c154e86b9d7723","hash":"05a783e9439572f13fd007dd93b3c92db794f9f4","modified":1511425967000},{"_id":"themes/icarus/.git/objects/5e/9cdab8bfc6ac10e2ba3bda7b5577ee7166d98b","hash":"f75a1eda6cae0892a921982ec5a4e461ca1eeb32","modified":1511424088000},{"_id":"themes/icarus/.git/objects/63/53cb84e0fafaed3a5b5710faf27821cd880825","hash":"2dc74aa47ff4847f1ac9ebc0141edd1f21e87f94","modified":1511424067000},{"_id":"themes/icarus/.git/objects/5e/9e8bf5ce10f13e5f90b5ebea86845df221e3ea","hash":"ed3d1826b3c6b64c253d910cdd069dd72d776a2c","modified":1511424067000},{"_id":"themes/icarus/.git/objects/63/f4c613a57fa683b6168b10b9b3056c203b54cf","hash":"279638b31e654b83054a721c58405b40380fc6ed","modified":1511424067000},{"_id":"themes/icarus/.git/objects/66/071c97dbc6f7e9cbae5ee3d5175bc042bb7670","hash":"c91debd07e7a3778c4d5aca6839c7c8d4428c255","modified":1511424067000},{"_id":"themes/icarus/.git/objects/69/091a79aba19f018d3c3913b010f9cdfd10322c","hash":"556162407861291cbee82857324b9bd000cd4c05","modified":1511430074000},{"_id":"themes/icarus/.git/objects/67/af155bb8eb9d4a090068aca56ccd45cab91735","hash":"201f7700b6c15ce7b55e8fbd2a32b49d8633242a","modified":1511424067000},{"_id":"themes/icarus/.git/objects/64/bae5ccb338ce197f52c9377f0560eb1a55c0da","hash":"f47a248fe6570259b1200281fa5a53126d065a05","modified":1511424067000},{"_id":"themes/icarus/.git/objects/6b/18d55dce10306fddb5e8c360781d4ab3c20431","hash":"559e7228a7eb39423f68f94a267f20926124239d","modified":1511424067000},{"_id":"themes/icarus/.git/objects/68/0b944f84597be9360c5c946b38e6ae838ed88c","hash":"ef18193ccbad228262316912d75256bf24cfaf85","modified":1511424067000},{"_id":"themes/icarus/.git/objects/6b/dc98ef8d892fd1b49a90ac3461e46e56779f08","hash":"d49a3eb1de1bd83547b595e72e294b3846e368f8","modified":1511424067000},{"_id":"themes/icarus/.git/objects/68/ed0d4368ccb18a377e954a3630bbca76bff33f","hash":"429cb0807725dac057ff258a9f32993f1aef02c2","modified":1511429639000},{"_id":"themes/icarus/.git/objects/6b/33ce25bc4d91a324d9843f42eb7bd7cc5a2917","hash":"1cac4eec510568304337f3ade8fd5342cb1f5ad8","modified":1511424067000},{"_id":"themes/icarus/.git/objects/6a/0bdc3ad7200fd5e7e6192cd612ed4853020f93","hash":"8dc9059cbfa929fc51c152ef4ee017e6c237c1d7","modified":1511424067000},{"_id":"themes/icarus/.git/objects/6d/e33a57d1d8987a313e42cd79314e95393cb593","hash":"227d2e7c86c0940abfd756165379c37e39d3b266","modified":1511429639000},{"_id":"themes/icarus/.git/objects/6f/c4b15f8ddee773129cfce170a84f653045cd50","hash":"a7f2a6a1b4bfe6c73e1c460b2e9ca4a994363e28","modified":1511424067000},{"_id":"themes/icarus/.git/objects/6f/6a4f5604f35e5f87987fa0a5e7e0229b28226d","hash":"c1cb92bbc86f2cdbe44638046d9b5e715cb51f30","modified":1511429639000},{"_id":"themes/icarus/.git/objects/71/a84167b4e7ac7a347d584a59374d3966ee2d17","hash":"17ecc13a92d4d276b0c46f4183edd89ac6fc38bd","modified":1511424067000},{"_id":"themes/icarus/.git/objects/71/0cc96b70959edd8c27584b45d8c7140c02b7ca","hash":"26d79c89dc7b49da4cfe95573b0bce3f97d1f6b6","modified":1511429639000},{"_id":"themes/icarus/.git/objects/70/19bcecdeca35bd60e7acad1f50b4255d3be5b7","hash":"83155532fd3b64a8d67794d31c29917e0bb1b21b","modified":1511424067000},{"_id":"themes/icarus/.git/objects/70/b187f799dba4a8def4e1025befaabf2159e12e","hash":"c434a08931c0849f33d4d1ead017a8fd725d97fd","modified":1511424067000},{"_id":"themes/icarus/.git/objects/70/b7dd42e120524e2dc7d85f7e0e720f5784c3e3","hash":"489f18757d2f585310b083d83bf22724a7855d12","modified":1511424067000},{"_id":"themes/icarus/.git/objects/70/f301a60747b1a86e19c1dc35ac34b5b80e0b11","hash":"053c22c9dd0353eb692a41f7eb3d9bd12e5fc117","modified":1511423747000},{"_id":"themes/icarus/.git/objects/72/208f35fbd5bd86d461e5ca4aa98e2b67c3c37b","hash":"430af2a4c921ff46cc980404786494ecca7c4b12","modified":1511424067000},{"_id":"themes/icarus/.git/objects/72/18dbaec3ecae218faa71b869f575b1c6a17b0f","hash":"367f24dd8f9346548789138961e73792e2b017be","modified":1511424067000},{"_id":"themes/icarus/.git/objects/74/97b1af71a26d242e3caff599dd750b6b81fb2c","hash":"fe08571eeaaf5046889cf058332e343d9a8c9326","modified":1511424067000},{"_id":"themes/icarus/.git/objects/72/2bd7339a1842ca272ddcccd00dcdbfa492902e","hash":"914675785b12cd70624b7d9e1750c231b2b6f044","modified":1511424067000},{"_id":"themes/icarus/.git/objects/75/11d36cbbaaf07a733d2d7276cfb8c8c04cde7a","hash":"67b5eb2d446bf09607f5a4bc8809d9fef9b2837b","modified":1511424067000},{"_id":"themes/icarus/.git/objects/74/09c3cffac596e05e1acbb1772e0f62a97d18fa","hash":"a8e1c353059de01d65163abc0da42a5efc7d6445","modified":1511429639000},{"_id":"themes/icarus/.git/objects/74/e77d0ebc3efc364c8fb0e4bf651f0866ce4b15","hash":"8b3aad46763af45a7869ec5fb239201d51b67f61","modified":1511424067000},{"_id":"themes/icarus/.git/objects/74/04fba0f15a13cee7efe2237b6221e1b438dfee","hash":"1020156d8b7208ab9a02bc3b2efc8794aa39c6a6","modified":1511424067000},{"_id":"themes/icarus/.git/objects/77/5d4dea89be8d6fb257b14f8c3cf4dd785a07c0","hash":"c157889b7faea918ffca52f33db809e893cf0e8a","modified":1511424067000},{"_id":"themes/icarus/.git/objects/78/f1ea638ca7a0a0e1d63cfa12a39e6eff29c61f","hash":"32b4df93e8d0989cf516c47c629f9f37f51ccec1","modified":1511424067000},{"_id":"themes/icarus/.git/objects/75/1cd8d6be70b9c82f68e2d88b1da755a80ad05f","hash":"66c2e96122c0aa9282fdc915480ccb950beff21e","modified":1511424067000},{"_id":"themes/icarus/.git/objects/79/71f534272003bfb4031ad881aab0b2158f28d6","hash":"ccdc41fc52b9eb4fe0807f1976125f59f4dabcda","modified":1511424067000},{"_id":"themes/icarus/.git/objects/7b/60af411dd4a5a500ad63e2d41278c0cdef26ae","hash":"2608b250d4977bf72c323d5690540b72642d216c","modified":1511424067000},{"_id":"themes/icarus/.git/objects/7a/847bc8c539d2b9ba8cadc122672e4362986664","hash":"29acf124593c9fee054efcaf8562fcee17e846de","modified":1511424067000},{"_id":"themes/icarus/.git/objects/75/a408231ed9da30cb86f3a64bc6a8f2ce2d0136","hash":"35a461fe7607f4d91de3adf7b641c2c6380908f1","modified":1511424067000},{"_id":"themes/icarus/.git/objects/7d/ac38b6f943f9e6d85dd341f88c5849eac90695","hash":"d927efb108c6fb0eeddb64003ed68bd8cf30ea8b","modified":1511424067000},{"_id":"themes/icarus/.git/objects/7d/7766c2eb617b83e68c5db8e7b3d2b646d9716c","hash":"bb107be89037d19862bdbf6d70a681fc7b256b97","modified":1511429639000},{"_id":"themes/icarus/.git/objects/7d/c5a9c4cb7b5b07859c8b067ce40d0ad6e2285c","hash":"ecba8ff34fa48824f7d537e596352f504ed879d9","modified":1511424067000},{"_id":"themes/icarus/.git/objects/84/3b3440ee33166ea24582cc21bf943d5bf50880","hash":"1494f7dc7157e8d116b5ec066cb505e8ca306ae3","modified":1511424067000},{"_id":"themes/icarus/.git/objects/7e/013919c538dc2fc08f1bf0c1ee0189aa9dcde9","hash":"c7807de55b9d71398cc3b2323444375d50240b07","modified":1511424067000},{"_id":"themes/icarus/.git/objects/84/dae84196b0f958bad8e6a144c58e454a9a0ef9","hash":"772baf3d073035b52383b0cf79f880e28ac34b6d","modified":1511424067000},{"_id":"themes/icarus/.git/objects/85/1996a2378b7a0b06d35dbb1d72a95c3b3c9e7c","hash":"23d639cfaec83f7102102ecc9c4736ce7a5208b3","modified":1511424067000},{"_id":"themes/icarus/.git/objects/84/4447b1883af52c02b9a8ddf8d8c705734a8a36","hash":"43d5be2fd91d7c33874c0683a5ae445179866000","modified":1511424067000},{"_id":"themes/icarus/.git/objects/80/33afb89d366471357344a65d183a5e11b96752","hash":"af3886bb11a15bc144531254a26d748a7937b99f","modified":1511424067000},{"_id":"themes/icarus/.git/objects/80/e54920dfe42db5036e47beda32986e2922a403","hash":"f21726411331e2a43108f16e7758d88a7ba540cd","modified":1511424067000},{"_id":"themes/icarus/.git/objects/80/646cd59921064b1bfe75aa48c962ebfcc6cb5e","hash":"9d5b6e46bf6bf5cfe72e814be763faf9f1e32613","modified":1511425967000},{"_id":"themes/icarus/.git/objects/86/3e437985e25f6ffd01c89a6980b920467ab80e","hash":"b901ae2f33f41077842847b213bea66079df528d","modified":1511423747000},{"_id":"themes/icarus/.git/objects/86/e8e47adb39a0569d254f03fb8070c727251697","hash":"1d7f28d8377916906c016952aa7f0bd8e0c73abd","modified":1511424067000},{"_id":"themes/icarus/.git/objects/88/a5b05204a37c40b1f6af7e3c5f9c23aece7dd3","hash":"2a4d2e340905996767a1bc72f1c1a4a5af151d68","modified":1511424067000},{"_id":"themes/icarus/.git/objects/88/31f5c4977fe5d74cc9b903bfce567d2c344cc1","hash":"f7e4269e026f6091f1b869ec2891cb3f4627af79","modified":1511424067000},{"_id":"themes/icarus/.git/objects/80/dd7ca9d9b769bb6040bd9378e6ae4f10d0313b","hash":"5b229a90fee800be19d8799a273561f50856f6ef","modified":1511429639000},{"_id":"themes/icarus/.git/objects/87/2660f76d939f4fb03b44c47e297622cab0f765","hash":"4a2298b61344b16911e5ff6e935ad26bf607e1b1","modified":1511424067000},{"_id":"themes/icarus/.git/objects/89/6117f91b3303735e8b485efba406266e2417fb","hash":"2ff65454ec94d7ad84d5aeaf5fbb4f39a1a86514","modified":1511424067000},{"_id":"themes/icarus/.git/objects/8a/d81996ef9e77235081cad58d7c138c320b4487","hash":"922bebe0214d3c8dcb73c2e23c97d3a4f23ef4ea","modified":1511424067000},{"_id":"themes/icarus/.git/objects/8b/38631e9e3a8ba579e359f0f96195a2c7bf1cf6","hash":"968f66a1e28bbcfea291bb44c95e1b549b043b5c","modified":1511424067000},{"_id":"themes/icarus/.git/objects/8a/47bb60123e166f7fbd711d79f3d2e230f805e8","hash":"dc731561ddfebb6c83f9394d76646fbd2d87da8b","modified":1511425581000},{"_id":"themes/icarus/.git/objects/89/e158f092b46aaa088d512e8c32ece66649a8c8","hash":"dde3ebd1c4dd17e9ecbbc5fbdcc44187e074c61b","modified":1511429639000},{"_id":"themes/icarus/.git/objects/8b/4a6bf9324a0a800ee44f7b15ebb8afbab69111","hash":"ec1970c426ace881b1c3d8f328bfaa26d31aab54","modified":1511424067000},{"_id":"themes/icarus/.git/objects/89/93a4de6b39e4c3aa3ca12546700362fd25764d","hash":"f8c83c87afa585efc0286569c03aaf814cb6cf84","modified":1511424067000},{"_id":"themes/icarus/.git/objects/8b/4688132aa032c0cbb306843c06364c8a68ba6a","hash":"84f53634f20ea6b6e0ddd3bb124082e27855eb2e","modified":1511424067000},{"_id":"themes/icarus/.git/objects/83/850ff4e2d5ef00807c768a7d7a47036eed8561","hash":"2364096019fe6ce88ba1b2ace802fefd96a07e73","modified":1511424067000},{"_id":"themes/icarus/.git/objects/8d/150cee1adec926f819aa44a0448225cf0a81b5","hash":"8dbd1d0daaf42af0976e0b9a00a8ca4002cf9509","modified":1511424067000},{"_id":"themes/icarus/.git/objects/83/6be3e2bab9dece81a9c79f7284b4eb28e7c457","hash":"2f7c182014c860003587e67208dc032cc6c9e5a2","modified":1511429639000},{"_id":"themes/icarus/.git/objects/8e/87fbcb0d7154a68c7de4b71ba0b1f50c9213ec","hash":"35d5383d7ac94c98c3595ef94d9d6d2af7bfb1e9","modified":1511424067000},{"_id":"themes/icarus/.git/objects/8d/d0129a162a980d285615bcb4e7b017e3881b5c","hash":"d930a3c8578c426bd9c32fe9db9619aaa87ce7f6","modified":1511424088000},{"_id":"themes/icarus/.git/objects/8e/220c2f5307f7250e32ddce8f18c57f900ad80c","hash":"b5bdf520039aade1c4cfc1c642dd5d90cdedf117","modified":1511424067000},{"_id":"themes/icarus/.git/objects/93/73e6ac7d893c3900c13ea1285452e202bde5f8","hash":"9c54885c60feecc9c352b231643d51071e989cbe","modified":1511424067000},{"_id":"themes/icarus/.git/objects/8f/d5e05a8db1243d7766fdee73a8f3e2e268cf88","hash":"037bdf44edf6d50d64382dd7f1e8adfa313f8168","modified":1511429639000},{"_id":"themes/icarus/.git/objects/94/13d8acfe1d5c86603ca6a953516c8ef7c8c1aa","hash":"92e8f6bd6eacd55a7aaa8e84c02feb5ef362bc49","modified":1511424067000},{"_id":"themes/icarus/.git/objects/95/6e9790a0e2c079b3d568348ff3accd1d9cac30","hash":"dec7555f7553d486f9d5f53d34d5b9491cc0ec10","modified":1511424067000},{"_id":"themes/icarus/.git/objects/8e/b990b9d623da355bc0b2dc49c0bceca69771f4","hash":"51fed9af493f32f9e03122346fb0824b4a29fa18","modified":1511424067000},{"_id":"themes/icarus/.git/objects/94/be181d08c557bc7cb6586b361ff6ddf89a29fc","hash":"fcce223b8e0e57e92e7fc4cf8e2c3370a959bd00","modified":1511429639000},{"_id":"themes/icarus/.git/objects/96/9529b150783f0c50830c3a9bd06841b404e06d","hash":"b29dc9de48b7e827f80a9252b9a11ab6179e4826","modified":1511424067000},{"_id":"themes/icarus/.git/objects/9a/8fa11ebfa883a26b71a60c76306de4970a71c9","hash":"e66f45bdf9838d82f1c20f20e64fcda35ff74642","modified":1511424067000},{"_id":"themes/icarus/.git/objects/9b/76b5f57e7ae01a2b9b3efbee4ca88bc3fc041f","hash":"7dac52d942273ca5b76834788bccbfb955214ba8","modified":1511424067000},{"_id":"themes/icarus/.git/objects/97/af2592f2181ec1c18d1cb7aed4aa5c096f0238","hash":"6bcd33ab3d7c88efed8d8884e181b710408fc758","modified":1511424067000},{"_id":"themes/icarus/.git/objects/99/a89f965fa214ae69c819dc933442c5f5a588b3","hash":"84145ccde6b8287aa6b1e4316d999b1f19913315","modified":1511424067000},{"_id":"themes/icarus/.git/objects/9b/61177fb4824ca5051aa5441d2fbf92134a7f56","hash":"0d76e619076cb7151c64b8f448392e7b44f62960","modified":1511424067000},{"_id":"themes/icarus/.git/objects/a1/0e53e7fbd4fd000c71b6f779a2b16a4638e602","hash":"33dbca20193a2994db7d93195b4bfe7f5f7bb29f","modified":1511424067000},{"_id":"themes/icarus/.git/objects/a1/059ab10a22c7e4a4cb4512025d0d2ed0d9eeea","hash":"202ea497a11a2064874e836b1062255136345d30","modified":1511429639000},{"_id":"themes/icarus/.git/objects/9c/07d4ab40b6d77e90ff69f0012bcd33b21d31c3","hash":"9c449cf271535ef1c97ee5e1e2d8558a041a5516","modified":1511424067000},{"_id":"themes/icarus/.git/objects/99/410093b4adef562416e79310fc844c507e36d6","hash":"78d978a6ec669eb6125c17bd2462b183570fd6a9","modified":1511429639000},{"_id":"themes/icarus/.git/objects/a2/1b01bd922a86152d49fee1d9a76b77e2bb71ef","hash":"9c07b764f0b40609cb1bec2c17776008af73b96b","modified":1511425581000},{"_id":"themes/icarus/.git/objects/a3/5ef8bfd5793e5c967dd3f7fc791fee271e0366","hash":"4e26829288d489c3dabb44abaf8cd714e29721cc","modified":1511424067000},{"_id":"themes/icarus/.git/objects/a3/634585d7955b9683ec18d9a262db09f86f3ed1","hash":"029b73d119b174311f670db754aaf58bfc1e3965","modified":1511424067000},{"_id":"themes/icarus/.git/objects/a5/7e99c7e2389f094f39255a18ce2c4b8539e314","hash":"604410300f8b5fb0395c50256deb682f47c90852","modified":1511424067000},{"_id":"themes/icarus/.git/objects/a5/3fba6713a4dd3899228c5691b57236e0ab20f0","hash":"9c5a297d3dd1dc30a72f00b9828e59a255bafb4b","modified":1511424067000},{"_id":"themes/icarus/.git/objects/a3/e11312beeb3dae515c3cdc1716731b044f1ade","hash":"2a1a1490ee0eed8cc715f2a7ef515d2e514e70fd","modified":1511424067000},{"_id":"themes/icarus/.git/objects/a8/0062ff8d7b29cf636533d36153b629e5b61090","hash":"18b45c19f7f407cef0f0165946effd7e8f1957ce","modified":1511424067000},{"_id":"themes/icarus/.git/objects/a8/fab5258be87a31d7e79898ca34f7de859aa5b4","hash":"a530bf5aadaff22eab1542ed3d781ee70786e50d","modified":1511424088000},{"_id":"themes/icarus/.git/objects/a9/6abfcd3490523387b037eabd865f820ac537c3","hash":"7bdb308ad88639c7dac217177fa8acbf6810273a","modified":1511424067000},{"_id":"themes/icarus/.git/objects/a9/c1a866052614a2a764554833a53d7db36b7dfa","hash":"d3a433014da3fb9fcc245017a66b74b0d0961e3e","modified":1511424067000},{"_id":"themes/icarus/.git/objects/a6/a1fecb8f011b20ab08bd8684d78fb4d2a056f9","hash":"c160f3469b84254f766d3eb854cd5195e8b4753e","modified":1511424067000},{"_id":"themes/icarus/.git/objects/a7/39e6ab026cd8995672413966200e07bebd2d14","hash":"c97dccd6388041ba29994e3644194aed4f67880e","modified":1511424067000},{"_id":"themes/icarus/.git/objects/ad/4e4eac53cee8941d3a76d04fabfe8b5abb8c86","hash":"c9481ed2b497d10afa2186977443eb14d1c43cc9","modified":1511424067000},{"_id":"themes/icarus/.git/objects/ab/14ccb036a531897697ef0ed70ecd8392c97f49","hash":"63a44bf4c193efc1d914cec47975787ac9cc7061","modified":1511424067000},{"_id":"themes/icarus/.git/objects/aa/456ac4ca98f79c8c92d251cf0cd1fbe537f3a3","hash":"ce19425e508f197e8aa8f428bebe87bb971dfa9a","modified":1511429662000},{"_id":"themes/icarus/.git/objects/aa/4bb52adc619444ef62f35cabf8fc03437879e0","hash":"e9ac33de6373a8f30a17f09179e21a4cfa0b2cb0","modified":1511424067000},{"_id":"themes/icarus/.git/objects/b1/12ea0a0e8aeeca40711eb600c92ab520941676","hash":"5d9c74a55b37ff46cb24d960af534c799ddfb479","modified":1511424067000},{"_id":"themes/icarus/.git/objects/ac/423326b3e4e5a1c3dfbdfbc85bbd4e09574aae","hash":"19ff7fa11c937f8f4c3097700c99656db9f2c0c9","modified":1511424689000},{"_id":"themes/icarus/.git/objects/b2/4d502b5cceb47b4ab7d16d20c31a7bcb599087","hash":"d0d20ec537bdc1196e091d47d60d5799f2da32d7","modified":1511424067000},{"_id":"themes/icarus/.git/objects/b2/17008cd564e5b84da8d90f8617075ba8859d74","hash":"cbfce800cdac5f4dd96ef771925491d09291e064","modified":1511429639000},{"_id":"themes/icarus/.git/objects/b6/f0faffb9e6e377f07d39b956ec7fba62499e94","hash":"3abdc7429694df71bd8b13783909d042b6b92a75","modified":1511424067000},{"_id":"themes/icarus/.git/objects/b1/644ca0b30d2e921fbcaf07da4c9fae845211da","hash":"cafc4f5b89cb9143c3482d78d8ede85bcc44b776","modified":1511429639000},{"_id":"themes/icarus/.git/objects/b7/d58f5b39ee984348929aae215f163efac18e41","hash":"36d904804eb93c2d3dfd709a1509ababe7ad46cf","modified":1511424067000},{"_id":"themes/icarus/.git/objects/b7/d64a9ed3a220702364cc7eb4ec4258cbf8080f","hash":"361fe695c49ece18a9fbeeeaf212361121692c19","modified":1511424067000},{"_id":"themes/icarus/.git/objects/b8/c50d9ac06011faaa0be107ce86e721319d153f","hash":"337c3a9559a5d83161c2217cf8c545d9b46b7a5f","modified":1511424067000},{"_id":"themes/icarus/.git/objects/b6/24a90e916260ce3a6e15c20fc64419479c8c7c","hash":"d67834292bab327baa12499fd879d0eacf2cf9dd","modified":1511424067000},{"_id":"themes/icarus/.git/objects/af/3fbe603d3c92342e32579a4e977d86bd65a8a7","hash":"4c260bb274006860e9ba09e5bfd702f348580bc3","modified":1511424067000},{"_id":"themes/icarus/.git/objects/af/a214afaeea6b49fee62492833cfb1db90d49e0","hash":"3870eb4a5198f2199b96c338dce63ec46ef3b8ae","modified":1511424067000},{"_id":"themes/icarus/.git/objects/ba/38c79a6bf1465a5585724c440a634f4a0fc5c0","hash":"d80f9a98150bb2568a581f52bd439ad2bce7814d","modified":1511424067000},{"_id":"themes/icarus/.git/objects/b9/cecfe47d40f0551510fba7fd8d886f0d168d31","hash":"bd809b9535695e13e82264557ca3bc40da2852e8","modified":1511429639000},{"_id":"themes/icarus/.git/objects/ba/4a56616baa1b1acaa15ebd138647ca7c7c615f","hash":"fdb7cc7d54443b8be1c9bbd7207eb6a88f4f32bf","modified":1511424067000},{"_id":"themes/icarus/.git/objects/ba/8d20ef371c3851063e3455b4738c89212da5e6","hash":"c4604e6b32ea2aec7734967e308fe40d518a56b8","modified":1511424067000},{"_id":"themes/icarus/.git/objects/ba/94920acbf0f3c4cfc7f36306dfd5e46dfbda97","hash":"0d038b8e9b5eacfa971d3bd44082708ddcfa180f","modified":1511429639000},{"_id":"themes/icarus/.git/objects/bd/5181f104c9f6cc92498ce9355889ad85a66086","hash":"fb34c3108eb75cfb1532076eddd9d9272c52b831","modified":1511424067000},{"_id":"themes/icarus/.git/objects/ba/fcabe12b8d7d19ff50a3b8172cec403247c428","hash":"6b4c1c7060ffe1afafbddd3f1e9e77730ad09c9f","modified":1511424067000},{"_id":"themes/icarus/.git/objects/ba/8db2d6f294f9a8fcfeacb21daa8f2e23e16cb8","hash":"444fbaebadbe113357ccf66acd1cc16d64ab550c","modified":1511424067000},{"_id":"themes/icarus/.git/objects/bb/839640b3100c6ced6813030794877a2671cd99","hash":"8bfeaf7461108b577a3713b2c1f197466a865ef8","modified":1511424067000},{"_id":"themes/icarus/.git/objects/bb/845920dd11a428e038a3805513890f7d00a94e","hash":"e2c0287c9527ce71a6b42662dbefec225b1f9144","modified":1511424067000},{"_id":"themes/icarus/.git/objects/bb/98ecd5169efcd64763c67d74f3d585e947d8d3","hash":"901dd83664d86e5a24f5e2ff8babc04df90ad1d8","modified":1511424067000},{"_id":"themes/icarus/.git/objects/bf/53ca3861c085ec5d7215df3c87c802f6e2a55e","hash":"9778a1ab04f9bf3d8500c2f0a8b5323e89217518","modified":1511424067000},{"_id":"themes/icarus/.git/objects/c0/51f4f3ef1da1ada78521ff0df00bc31fb0c8e6","hash":"10fec77e19cab44564b60f490f045de27c95cbaa","modified":1511424067000},{"_id":"themes/icarus/.git/objects/be/4c667790a23a81e96df663e59827b30d399923","hash":"024db9298834166e9cc8f53690a2800cbae34e0f","modified":1511424067000},{"_id":"themes/icarus/.git/objects/c0/cfaf4f4b624c2e80982858d4349f211f32dbe2","hash":"04b56be368b650b409c0734f8c67592afa2eed6d","modified":1511424067000},{"_id":"themes/icarus/.git/objects/bc/ca277a7e3e733e16e505fd69a26749d127bf15","hash":"108664a700ee7163ebdcbb9040ebd55542290640","modified":1511424067000},{"_id":"themes/icarus/.git/objects/c9/267854c96dd8c3e0cf399beefbdce9333bfc60","hash":"d2ef7df96675a64ada2763bdbd9cad4df2e7fd01","modified":1511424067000},{"_id":"themes/icarus/.git/objects/c9/9d896bb30bd5d7530b6db3e92927534f8cdec3","hash":"543a02031cacb61802ff77e1a1d8bbbf9e21db6d","modified":1511429639000},{"_id":"themes/icarus/.git/objects/ca/04dcbdcc5f3b08d7dfae34e14e3b82301f844c","hash":"ecb96b923f47f7150cabccf081b02f1dd8340391","modified":1511424067000},{"_id":"themes/icarus/.git/objects/cd/d6013b31a494ecb30e164686766251689e0df4","hash":"6685bf077c79ff7168cc48a5012d2b95f1524685","modified":1511424067000},{"_id":"themes/icarus/.git/objects/ce/17576a1380cd239e3df773eb3baa3d1feba996","hash":"37151cd11bb067135734f0257fe3d24eccce03ed","modified":1511424067000},{"_id":"themes/icarus/.git/objects/ce/f9c82b4b6a52f7661d0d0bcee2c5d609f1dcf8","hash":"6d09ae163bffc1c9bd6031b0df0fefda2302184a","modified":1511424067000},{"_id":"themes/icarus/.git/objects/cf/8031d11496cf164ccb2bc9c988adc6772d6762","hash":"fb78b33120586af270efcfc73c92fdd35d4cf2b8","modified":1511424067000},{"_id":"themes/icarus/.git/objects/b4/5ab6e3c5bdf4fb2582f26e7464a479e4883d52","hash":"182222cf2a4b04f54c7b2cd6d6ae030b4443eff4","modified":1511424067000},{"_id":"themes/icarus/.git/objects/d1/49c116f8a72ef0e8486ff663485e2effcd33f6","hash":"17de6889069b3dc327e5b870720dd85a0ee1e62d","modified":1511424067000},{"_id":"themes/icarus/.git/objects/d4/6cef123f4ff3c0ba8f092ff6b8c313708c1f28","hash":"dd22df832a2e9398fe7698ca40f7c620c345205f","modified":1511424067000},{"_id":"themes/icarus/.git/objects/d3/bbc80623da993b708d7a8b313fcd674453c53f","hash":"6fa2e40a93072df6655a92e84da74068560440ea","modified":1511424067000},{"_id":"themes/icarus/.git/objects/c2/287eb30a16e86ec6a69c1558094f8f36163f29","hash":"64ac71cbf9bbd1168768dced4c60ecf189d2c20d","modified":1511424067000},{"_id":"themes/icarus/.git/objects/cd/471286244ed636f4fab73efc03187934dd6f86","hash":"984365cb58ba8f06573637c7f2ea56bb53c6c8f5","modified":1511424067000},{"_id":"themes/icarus/.git/objects/d0/bd5c4a191d981ed044670896615b1c32bbfb60","hash":"91411d88b9f9508ee54bf8bb17a5d25750dd520b","modified":1511424067000},{"_id":"themes/icarus/.git/objects/d6/9f6ee40a490e3eefb0dc0189b10f3a5e635971","hash":"bbd450a0f8a83b80c20fa16739b34ae91af51db9","modified":1511424067000},{"_id":"themes/icarus/.git/objects/d5/8386990fc81166d64ccb14e9376e3fdbc8b0c5","hash":"37129e8197e17d11b0e46fa66efed6fe890e0247","modified":1511424067000},{"_id":"themes/icarus/.git/objects/d6/e8dbcfa24f23d481d9eca933acc2d670538e88","hash":"b0f20d1d28d5517b028530a62379ba10532e3718","modified":1511424067000},{"_id":"themes/icarus/.git/objects/d5/39aeb5ea8bdf502aa3181296b57ec7e6749b3f","hash":"02d280f0dc1eaf8233121c0e72c6a1c0ddd08c1c","modified":1511424067000},{"_id":"themes/icarus/.git/objects/d7/77b7ec1b3ee3a8cf6d0e226315351d3315bf94","hash":"e5df6f5aef5d0436aaa9a801f1b2507cd4b37081","modified":1511424067000},{"_id":"themes/icarus/.git/objects/d9/2169061b715003da1960423080aca058ea151d","hash":"a5ce3457b6349b728c2e55ca2c671d37b865b02a","modified":1511424067000},{"_id":"themes/icarus/.git/objects/21/89334c78cbd8a60f591c8d97cc5056793e899f","hash":"eb53badac2234332026957856f6e154b2f76f17d","modified":1511424067000},{"_id":"themes/icarus/.git/objects/20/6ba6ae5d073fdae637d489cb785264fea482d1","hash":"fc8a032d2faf2c75b2e3ee188263735bd80a443c","modified":1511426171000},{"_id":"themes/icarus/.git/objects/d9/bfe1695b98c24b7788b575878acfa770c2efa7","hash":"3c875c7617f089a8a97d025bace60ae0648e5d80","modified":1511424067000},{"_id":"themes/icarus/.git/objects/d9/8ff6054dee550d713288ed87dc95c9532d0a7f","hash":"ce20d3e6e9294fe8d7b00e93a78d99ceab1f0ba3","modified":1511424067000},{"_id":"themes/icarus/.git/objects/d9/92f1aeb727be76939e9d93a02f43f366b9695d","hash":"fa7b2512de6908a0e2ce43de6ab87af47f5fd516","modified":1511429639000},{"_id":"themes/icarus/.git/objects/dc/6323025c4ee842d6c6127ea0342d507b1bc9ce","hash":"522fe861a583b994a7bd06cb93d68cd74daa9fe7","modified":1511424067000},{"_id":"themes/icarus/.git/objects/db/3e258a9b5fe8602b3c004ba12828399644bb5e","hash":"d87867d5389ccd7f062dcbbf3ee075cacb6acf1f","modified":1511429639000},{"_id":"themes/icarus/.git/objects/de/717bb45ccda5abea506f1a58beeb17f33223c9","hash":"7ca64bda9f69caf4cebbe662471057e76cc89fc7","modified":1511424067000},{"_id":"themes/icarus/.git/objects/dd/30d9b810706bbf2adb48487b30e26de7ecdd16","hash":"2d1c8a6b93cccddad548838c74c76490614b7d61","modified":1511424067000},{"_id":"themes/icarus/.git/objects/dc/fd0071efdf6d94c17bebc8a9de58417ec75995","hash":"ec03d80ee99fc0d390c591be0c106deb58b92ff1","modified":1511424067000},{"_id":"themes/icarus/.git/objects/de/da323eb4b4bd74b8ecf5e532607076590d41ea","hash":"011eee48d8bc0c7c2bc427af6da306ec8fdf94cf","modified":1511430044000},{"_id":"themes/icarus/.git/objects/dd/14f33225e29d7983bf1f1cd24af3e04980d5ea","hash":"c7606bfc76c35833fa7e0c9b0d784484b0c4ef90","modified":1511424067000},{"_id":"themes/icarus/.git/objects/e1/ec3b436ba89cb1becb60f6ff976fd1e9e9deab","hash":"de58823cb6871025260478d5fbffaf7c5445dba0","modified":1511424067000},{"_id":"themes/icarus/.git/objects/df/ebb91fd6bc08644c7f576c6ac295c0cd8d1cd6","hash":"62bb6a72916b8072fccb7e7b4ff69cb3e4bb388a","modified":1511424067000},{"_id":"themes/icarus/.git/objects/e2/059b051712a0ef786c2333c5da17f43ef3db18","hash":"eddd02e0f66d4949c1d0d5fb482e1ee407fdc7a0","modified":1511424088000},{"_id":"themes/icarus/.git/objects/e4/0b785aca5f04fad160dddb3636f8521a808f99","hash":"6d5cbcfc0ebc2d6c2b1116bbde1af0cb8b6b0187","modified":1511424067000},{"_id":"themes/icarus/.git/objects/e7/cab5b2a79ade57aeffc7b72d6ade557afe3234","hash":"76d93be41bfafe4a3c767a4f183732d88270388a","modified":1511430074000},{"_id":"themes/icarus/.git/objects/e3/a81ce356667cf27eb7b39d6f0440aa932ea7e5","hash":"33fb125a2403afd7badc49f67e4865635e6a0218","modified":1511424067000},{"_id":"themes/icarus/.git/objects/e9/c90674a67b21e3c2216bc2d1ead7753131303f","hash":"fe8349334686f4bbfc2a10c1915334adbc6f432f","modified":1511424067000},{"_id":"themes/icarus/.git/objects/ea/28ed1c95302cdc42f8dc97af9db6b1f8b1e7fb","hash":"4a116096378efbd353e99e7a45d5116f4abfc4f9","modified":1511424067000},{"_id":"themes/icarus/.git/objects/e7/5be928d7a6efb3c19a8df027e720dfce492e50","hash":"6995004cccaba72d5505228d5bfd17111bbc5548","modified":1511429639000},{"_id":"themes/icarus/.git/objects/e9/b77ee23c8f50564a77fd0dd4de8f52a9703ace","hash":"52ed53cbe829552dbd765215fb806909bd6b8a44","modified":1511424067000},{"_id":"themes/icarus/.git/objects/e6/5e335248dd4831a90c778272c8699c28bae82d","hash":"cbfd31a1d960a333475a502b9be5fa288d348698","modified":1511429639000},{"_id":"themes/icarus/.git/objects/eb/8069adcad29710fae6b17b04f8efee1ec2b6b6","hash":"b1b498040f93b0a8dc217fc530d2321a518d6f0d","modified":1511424067000},{"_id":"themes/icarus/.git/objects/ed/6706f67993803b4031dd7ffa6328b95c0e5167","hash":"a1560973861063869b6e0d929586a8a879c7c8cb","modified":1511424067000},{"_id":"themes/icarus/.git/objects/ec/1cac6f1f00916c5543cb6aaa4805628dca574e","hash":"c51f87cf5601beb25d4eff2b55e4fcba0ed394cc","modified":1511424067000},{"_id":"themes/icarus/.git/objects/ec/25fc417c37cfc8c039d04c6954b93caed5365a","hash":"8e246264577f489b680f5cacc45b9f3290c12d0a","modified":1511425569000},{"_id":"themes/icarus/.git/objects/ed/153db9fe998ba58b6e5062f0c057d7c690b066","hash":"0b40e7703746d46b83dee48ecbc31fc37f0b16f1","modified":1511423828000},{"_id":"themes/icarus/.git/objects/ed/c383b85ee8da903c2e7104646dcab8e09b7499","hash":"9eaa245b118b0de9d5e1b30a8b49c12a4a973c1e","modified":1511429639000},{"_id":"themes/icarus/.git/objects/ef/bd43761f0157cabdb7d1a56dfbf10de8776179","hash":"f1789fd9d1f3041487ec7d67fa0f0edcf5c1f632","modified":1511429639000},{"_id":"themes/icarus/.git/objects/ef/c37741efe3af1b2d29458a7631d00f592c5964","hash":"6b64e84e935c4306095c761c8ed1de6e4ab2dfd2","modified":1511424067000},{"_id":"themes/icarus/.git/objects/ef/e2359544f3d13d9f9b6cdaf2eddfc44e3915dd","hash":"99e9efecdeca284dac75601bfed4b407bbc06f54","modified":1511424067000},{"_id":"themes/icarus/.git/objects/f1/b154ef473ef5ccc91cc61bc36e9fd05656e78b","hash":"49c776dcefeffbe83890f27ad6921247e5b316f6","modified":1511424067000},{"_id":"themes/icarus/.git/objects/ed/d5135277320fc605717c4a68785a9c3591d792","hash":"b4f058e3299b6af2ab5ce509564a77389ec1d22f","modified":1511429639000},{"_id":"themes/icarus/.git/objects/ef/7d245724640e1596fa23504c4e0988de32b2f2","hash":"8a90781e2a0c6354c9fc58c5c55d93c08eff8c27","modified":1511424067000},{"_id":"themes/icarus/.git/objects/f2/b7294b602a574a46e3b602e0e4d2dc39a7d9ae","hash":"b4017680bb64a1afa498962feee5299e080e077b","modified":1511424067000},{"_id":"themes/icarus/.git/objects/f4/c231081967b5528a31b3d03837d74360a0c4ba","hash":"5d9e5a50fb2b348f7236e25e9475e52be1e5289a","modified":1511424067000},{"_id":"themes/icarus/.git/objects/f6/1471fd5dea6966f2555e8b686f44b6d4968a24","hash":"d012e3fc8b3fc723284c804294838174238bd840","modified":1511424067000},{"_id":"themes/icarus/.git/objects/ee/1a42cb6ee89af135ac4d8875404364b1e9b5ce","hash":"8f33a9da8eca7c08ba5fcfa1620b9b7fe5436897","modified":1511424067000},{"_id":"themes/icarus/.git/objects/fa/b4218aeff36f97f0fe6c699b0b553ce31a7f06","hash":"370ccb811dc260ff361e46fe22d0b701ef7fd7a1","modified":1511424067000},{"_id":"themes/icarus/.git/objects/fb/eeedae747df31b3085a7aeb0349dead48e8c66","hash":"257264fbf6c22206e79ffb3038fa39923b5aac91","modified":1511424067000},{"_id":"themes/icarus/.git/objects/f8/51b04722cc63c0913fbc2f15ab71c796fd2d18","hash":"cea61c070947ab1b754036a8e6af9ed315d8395b","modified":1511429606000},{"_id":"themes/icarus/.git/objects/fa/f9ded7fa68e9020b9feef6cc76f0ee35680756","hash":"84119d7053c0bfda70038cc7b85af384a10a9f3c","modified":1511424067000},{"_id":"themes/icarus/.git/objects/fa/eb252089c982fa5c5230750c55cbfbcda8df31","hash":"66b7b489b7539c102dc45d2248fad79938cefac1","modified":1511424067000},{"_id":"themes/icarus/.git/objects/fd/15ab6365d4f1f4ed4ae57030f53a2d8e5de73a","hash":"0f91600eb3a5be7e1e01babd89afc5f035f2ef48","modified":1511424067000},{"_id":"themes/icarus/.git/objects/f2/e38b81bc7222e10523bae6b39158374b0b13ff","hash":"275e66fadb89d23eb17784731a91fc7761e0fb05","modified":1511424067000},{"_id":"themes/icarus/.git/objects/fd/9e0c7ee6d5a7fee29e6940ef639decc9238d5b","hash":"1fd55afe1369cf87dc807e5b934a452fc45953dd","modified":1511424067000},{"_id":"themes/icarus/.git/objects/fc/8efef1395d0c26a3727868bf5b8986b4b54151","hash":"77cfb63e173da412e952f8a63e47ca3d59082477","modified":1511424067000},{"_id":"themes/icarus/.git/objects/fe/a2f5ab3fa329d626557bcd9651e3d80f78304d","hash":"58981438ab7f39219a1cf5e8b43d1d295288dee0","modified":1511424067000},{"_id":"themes/icarus/gallery/WechatIMG79.png","hash":"a30bb3112ab05f31ac049dd6e11dea0bad7f3e5d","modified":1511426162000},{"_id":"themes/icarus/layout/common/post/banner.ejs","hash":"47ced3f03525698c79c6b1c07b48383fb6c496b2","modified":1480496898000},{"_id":"themes/icarus/layout/common/post/category.ejs","hash":"75c9dda2e7ec041943855ca163a6b1c4c8b4f260","modified":1480496898000},{"_id":"themes/icarus/layout/common/post/date.ejs","hash":"45cb0bcad461036cdd1fe2e3fbb5f2f19940025c","modified":1480496898000},{"_id":"themes/icarus/layout/common/post/gallery.ejs","hash":"659f019761116313169148ec61773e7b84abb739","modified":1480496898000},{"_id":"themes/icarus/layout/common/post/nav.ejs","hash":"d7cd611e642327f33dff3963ef869c2b46824a11","modified":1480496898000},{"_id":"themes/icarus/.git/objects/f9/1f0a6c1db7a60f99e2461331e5c953a9f05e2f","hash":"ec425883bbf1598f9537c73cdf4167449c48311c","modified":1511424067000},{"_id":"themes/icarus/layout/common/post/toc.ejs","hash":"a74774e114875c10b2060b103e45a294d68cad0f","modified":1511168675000},{"_id":"themes/icarus/layout/common/post/title.ejs","hash":"669ddb46fefa100856588351a7a2d30ad996b755","modified":1480496898000},{"_id":"themes/icarus/layout/common/post/tag.ejs","hash":"bc35983c35ed62106a06889454506770f5525f81","modified":1511166721000},{"_id":"themes/icarus/source/css/_partial/archive.styl","hash":"d35088c83ddd7a197d6d94e16a2ce3a7e29fa1dc","modified":1480496898000},{"_id":"themes/icarus/source/css/_partial/article.styl","hash":"f7fc39f88173804ef6092698171b2d756135b8c9","modified":1511341715000},{"_id":"themes/icarus/source/css/_partial/comment.styl","hash":"784646796184d4f27918c22395288a2fafbf9554","modified":1480496898000},{"_id":"themes/icarus/source/css/_partial/footer.styl","hash":"484776654e4c1691dc844e6e93786a08855c1c99","modified":1480496898000},{"_id":"themes/icarus/source/css/_partial/insight.styl","hash":"19833cd127f26ad90b06c115f8a96a30e0c0e53b","modified":1480496898000},{"_id":"themes/icarus/source/css/_partial/profile.styl","hash":"fbdb4b243edef65dfe52f91c9ede1eb76cdcb72f","modified":1511428796000},{"_id":"themes/icarus/source/css/_partial/sidebar.styl","hash":"f528ca7064d9fcecd737b9b71c9c54601365d7d3","modified":1480496898000},{"_id":"themes/icarus/source/css/_partial/header.styl","hash":"1e351f741144135871a3373fe7e969dc961b65e7","modified":1480496898000},{"_id":"themes/icarus/source/css/_partial/timeline.styl","hash":"c813b98f4fc45b64d2e07e5d944745a654c8c943","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/agate.styl","hash":"601eb70448a16b918df132f6fc41e891ae053653","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/androidstudio.styl","hash":"65d09f1b0e81c6a182f549fd3de51e59823c97ae","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/arduino-light.styl","hash":"15e8572585cd708221c513dea4bdd89d8fe56c10","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/arta.styl","hash":"1a5accc115f41d1b669ed708ac6a29abac876599","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/atelier-cave-light.styl","hash":"a5be0744a7ecf4a08f600ade4cfd555afc67bc15","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/atelier-dune-dark.styl","hash":"df50a85a4b14c7ca6e825d665594b91229d0e460","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/atelier-dune-light.styl","hash":"931435fbc6f974e8ce9e32722680035d248a9dc1","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/atelier-estuary-dark.styl","hash":"d84382bc8298f96730757391d3e761b7e640f406","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/atelier-estuary-light.styl","hash":"344276ca9b27e51d4c907f76afe5d13cf8e60bdf","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/ascetic.styl","hash":"32cff3bef6fac3760fe78f203096477052a90552","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/atelier-forest-dark.styl","hash":"57c154c6045a038dc7df0a25927853e10bf48c4a","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/atelier-heath-light.styl","hash":"8c8c2e445abef85273be966d59770e9ced6aac21","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/atelier-lakeside-dark.styl","hash":"bb0a8c4ad0dd8e3e7de7122ddf268fc42aa94acb","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/atelier-cave-dark.styl","hash":"bc647b2c1d971d7cc947aa1ed66e9fd115261921","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/atelier-lakeside-light.styl","hash":"2c54cb9bdb259ae3b5b29f63ac2469ed34b08578","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/atelier-heath-dark.styl","hash":"b0cf13b2233e7bc38342032d2d7296591a4c2bcf","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/atelier-forest-light.styl","hash":"95228d9f2102fad425536aac44b80b2cba1f5950","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/atelier-savanna-dark.styl","hash":"a16c919a1ccf2f845488078fb341381bec46b1f3","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/atelier-savanna-light.styl","hash":"f8244c93711c7cb59dd79d2df966806b30d171ea","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/atelier-seaside-dark.styl","hash":"ce233a101daea7124cbfcd34add43ccfe2e1e1c7","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/atelier-plateau-light.styl","hash":"d1a05fdd1ededc9063d181ab25bad55a164aeb4a","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/atelier-sulphurpool-light.styl","hash":"efa52713efc468abeeb2b9299704371583b857de","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/atelier-plateau-dark.styl","hash":"09c64f1a7052aec9070c36c0431df25216afaea1","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/atelier-seaside-light.styl","hash":"0597342da6e2d0c5bdcc7d42dabb07322b1a4177","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/brown-papersq.png","hash":"3a1332ede3a75a3d24f60b6ed69035b72da5e182","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/codepen-embed.styl","hash":"f4dcc84d8e39f9831a5efe80e51923fc3054feb0","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/atelier-sulphurpool-dark.styl","hash":"414b0cfc142f70afe359c16450b651e28bf7325a","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/brown-paper.styl","hash":"c2326ba20a5020a66ca7895258d18833327d4334","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/docco.styl","hash":"b1c176378bb275f2e8caa759f36294e42d614bf1","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/far.styl","hash":"d9928010ffe71e80b97a5afcba1a4975efdd7372","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/dark.styl","hash":"71ce56d311cc2f3a605f6e2c495ccd7236878404","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/foundation.styl","hash":"bf8ddc94b4ad995b8b8805b5a4cf95004553fdac","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/github-gist.styl","hash":"48211a03d33e7f7ada0b261162bea06676155a71","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/darkula.styl","hash":"ad0d5728d21645039c9f199e7a56814170ed3bab","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/github.styl","hash":"3336aeba324c6d34a6fd41fef9b47bc598f7064c","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/googlecode.styl","hash":"bda816beee7b439814b514e6869dc678822be1bc","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/color-brewer.styl","hash":"2a439d6214430e2f45dd4939b4dfe1fe1a20aa0f","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/grayscale.styl","hash":"bf37d8b8d1e602126c51526f0cc28807440228ed","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/highlightjs.styl","hash":"0e198b7a59191c7a39b641a4ddd22c948edb9358","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/hopscotch.styl","hash":"b374c6550b89b4751aedc8fbc3cf98d95bd70ead","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/index.styl","hash":"002d5596f6379cc87dbd43d9145bc764aa666be1","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/hybrid.styl","hash":"ea8d7ddc258b073308746385f5cb85aabb8bfb83","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/ir-black.styl","hash":"693078bbd72a2091ed30f506cc55949600b717af","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/magula.styl","hash":"16d323f989b1420a0f72ef989242ece9bf17a456","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/kimbie.dark.styl","hash":"45dbb168f22d739d0109745d2decd66b5f94e786","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/idea.styl","hash":"a02967cb51c16a34e0ee895d33ded2b823d35b21","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/kimbie.light.styl","hash":"61f8baed25be05288c8604d5070afbcd9f183f49","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/mono-blue.styl","hash":"4c89a6ae29de67c0700585af82a60607e85df928","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/paraiso-dark.styl","hash":"f1537bd868579fa018ecdbfd2eb922dcf3ba2cac","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/obsidian.styl","hash":"55572bbcfee1de6c31ac54681bb00336f5ae826d","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/paraiso-light.styl","hash":"d224d1df0eb3395d9eea1344cee945c228af2911","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/pojoaque.jpg","hash":"c5fe6533b88b21f8d90d3d03954c6b29baa67791","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/pojoaque.styl","hash":"77dae9dc41945359d17fe84dbd317f1b40b2ee33","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/monokai.styl","hash":"5a4fe9f957fd7a368c21b62a818403db4270452f","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/monokai-sublime.styl","hash":"25aa2fc1dbe38593e7c7ebe525438a39574d9935","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/rainbow.styl","hash":"ce73b858fc0aba0e57ef9fb136c083082746bc1d","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/school-book.styl","hash":"d43560fe519a931ce6da7d57416d7aa148441b83","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/solarized-dark.styl","hash":"702b9299a48c90124e3ac1d45f1591042f2beccc","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/solarized-light.styl","hash":"aa0dd3fd25c464183b59c5575c9bee8756b397f2","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/sunburst.styl","hash":"a0b5b5129547a23865d400cfa562ea0ac1ee3958","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/tomorrow-night-blue.styl","hash":"8b3087d4422be6eb800935a22eb11e035341c4ba","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/tomorrow-night-bright.styl","hash":"0ac6af6ecb446b5b60d6226748e4a6532db34f57","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/railscasts.styl","hash":"acd620f8bb7ff0e3fe5f9a22b4433ceef93a05e6","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/tomorrow-night.styl","hash":"19b3080d4b066b40d50d7e7f297472482b5801fd","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/school-book.png","hash":"711ec983c874e093bb89eb77afcbdf6741fa61ee","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/xcode.styl","hash":"5e8532ae8366dcf6a4ef5e4813dc3d42ab3d0a50","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/tomorrow-night-eighties.styl","hash":"fa57b3bb7857a160fc856dbe319b31e30cc5d771","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/zenburn.styl","hash":"fc5ec840435dad80964d04519d3f882ddc03746a","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/tomorrow.styl","hash":"15779cf6846725c7c35fc56cac39047d7e0aec1c","modified":1480496898000},{"_id":"themes/icarus/source/css/_util/mixin.styl","hash":"c8e1ddfc0fe9108bab592c7a73b73ce9344991fd","modified":1480496898000},{"_id":"themes/icarus/source/css/_highlight/vs.styl","hash":"959a746f4b37aacb5d1d6ff1d57e0c045289d75d","modified":1480496898000},{"_id":"themes/icarus/source/css/_util/grid.styl","hash":"941000e3f2114d01cbb956939f1230b301ded5e6","modified":1511331403000},{"_id":"themes/icarus/source/css/images/avatar.png","hash":"2daa0d02ee54bee9a6968e098013fb37a7fab7bc","modified":1480497902000},{"_id":"themes/icarus/source/css/images/avatar0.png","hash":"2daa0d02ee54bee9a6968e098013fb37a7fab7bc","modified":1480504864000},{"_id":"themes/icarus/source/css/images/avatar1.png","hash":"2daa0d02ee54bee9a6968e098013fb37a7fab7bc","modified":1480504872000},{"_id":"themes/icarus/source/css/images/thumb-default-small.png","hash":"e8403b97ed9251f9f5207765b0ce796c5000b4ba","modified":1480496898000},{"_id":"themes/icarus/source/css/images/logo.png","hash":"e606a0584f98268b2fe92303f3254520862ef659","modified":1480496898000},{"_id":"themes/icarus/source/libs/font-awesome/.DS_Store","hash":"71de49345b332e02516e8cd5f553d3a97c7c0bf7","modified":1482902630000},{"_id":"themes/icarus/source/libs/justified-gallery/justifiedGallery.min.css","hash":"13fbcba5e97aa88b748d94d3efc4718475279907","modified":1480496898000},{"_id":"themes/icarus/source/libs/justified-gallery/jquery.justifiedGallery.min.js","hash":"b2683e7a872bc109b1756a65188a37cef7d0bd5c","modified":1480496898000},{"_id":"themes/icarus/source/libs/source-code-pro/styles.css","hash":"93c308012738728f906cd4c5cfdb34189e0c712b","modified":1480496898000},{"_id":"themes/icarus/source/libs/open-sans/styles.css","hash":"5ca6e111046232bde112d33201a60532aee7d3c4","modified":1480496898000},{"_id":"source/images/blogimages/2016/androidart_service1.png","hash":"30b35c17a3e468fcbbaab25990439bad304acfa1","modified":1482748875000},{"_id":"source/images/blogimages/2016/androidart_broadcastreceiver2.png","hash":"173269356b75bfe4213c28374a19e3a4938fd36b","modified":1482748875000},{"_id":"source/images/blogimages/2017/Initialize_for_purchase_data.png","hash":"2676a64fa51614baa48f40cede53b9a38d2680ec","modified":1510121346000},{"_id":"source/images/blogimages/2017/Initialize_for_purchase.png","hash":"c72e1a7b86d6ef66846d3bfcd92f7bbf30d1a324","modified":1510121154000},{"_id":"source/images/blogimages/2017/activity-start-process.png","hash":"7fbf542e56930c7eae863a729c9b127400b13a41","modified":1500537740000},{"_id":"source/images/blogimages/2017/Initialize_for_purchase_responce.png","hash":"a1d12d2d387552617b945c40158b53a63d3e1bd2","modified":1510122206000},{"_id":"source/images/blogimages/2017/android_build_process.png","hash":"14d311115864fa5a4606bb7cb8b592460ad46480","modified":1503650098000},{"_id":"source/images/blogimages/2017/ams_binder_process.png","hash":"5c9581165c33f271fa7e4d49e29b1b5ed4b90f3d","modified":1502076236000},{"_id":"source/images/blogimages/2017/binder-drive-principle.png","hash":"b6ef539c56f52e63b0b587916efbf363aebd7551","modified":1499739191000},{"_id":"source/images/blogimages/2017/binder-principle.png","hash":"e380ac2add90a07fbe5168f20e165f224d76d099","modified":1499655678000},{"_id":"source/images/blogimages/2017/hook-clipboard-process.png","hash":"320b490fd9d38bcc5bf1615d5d2bff20d766d51a","modified":1499907912000},{"_id":"source/images/blogimages/2017/listview_recyclebin.png","hash":"b90022a471f8339162107f2d57a744d1d0c9654c","modified":1503649962000},{"_id":"source/images/blogimages/2017/multi-Application-flow-chart.png","hash":"c319d32184bc3fdaf97faa83f6568723b29f193a","modified":1489373941000},{"_id":"source/images/blogimages/2017/process-ipc-structure.png","hash":"4488ffef5b4655dd72d1ad77c765b57ce1f83341","modified":1498807277000},{"_id":"source/images/blogimages/2017/servicemanager-add-service.png","hash":"338c7fb1a3208538ebbc1e9fd00b5387a2a688d0","modified":1499736690000},{"_id":"source/images/blogimages/2017/service-proxy-common.png","hash":"49eea6c0ea05522d586dffe8e29da9448708fa08","modified":1499761747000},{"_id":"source/images/blogimages/2017/servicemanager-init.png","hash":"e6acdb9b04ae085a6d6d0f45bc089447758a0082","modified":1499736274000},{"_id":"themes/icarus/.git/objects/6e/7483cf61b490c08ed644d6ef802c69472eb247","hash":"ae17bd66c3acbaf92a512cbbe5c6ef4c71dba949","modified":1511424067000},{"_id":"themes/icarus/.git/objects/7e/b74fd127ee5eddf3b95fee6a20dc1684b0963b","hash":"901183e4b1fbea66f7ced4e2a357818e18d81a5c","modified":1511424067000},{"_id":"themes/icarus/.git/objects/c7/b00d2ba8896fd29de846b19f89fcf0d56ad152","hash":"308942f59b85636f0112af02176ff46bd134e8ff","modified":1511424067000},{"_id":"themes/icarus/.git/objects/d4/de13e832d567ff29c5b4e9561b8c370348cc9c","hash":"234e443d96b470841f79a3cfffa7eb2c8091e5c7","modified":1511424067000},{"_id":"themes/icarus/.git/objects/f2/21e50a2ef60738ba30932d834530cdfe55cb3e","hash":"40f763ec1633722c931913ef755fce7c2826ce5d","modified":1511424067000},{"_id":"themes/icarus/gallery/blog_hexo_screenshot_Agehua.png","hash":"7a729cd2d48c69e20121dd43ebc5affd5e563d72","modified":1511425938000},{"_id":"themes/icarus/source/css/_highlight/bootstrap.min.css","hash":"b67828261df0a6bd411c8452ad4d3291c90a466b","modified":1511234675000},{"_id":"source/images/blogimages/2016/androidart_activity.png","hash":"9d8bda879c62adc0b71cd26262603850ca16ab05","modified":1482748875000},{"_id":"source/images/blogimages/2016/androidart_contentprovider.png","hash":"9dbe7f17e629d0f36218b5dd3c3941cd8aa320f0","modified":1482748875000},{"_id":"source/images/blogimages/2017/EIT-form.png","hash":"edb86938e964f0602d2fcaa5676dc67bcbce5b26","modified":1498616237000},{"_id":"source/images/blogimages/2017/IPC-data-format.png","hash":"6bda10ce15610da9102e67cbf763ecfb8a088e83","modified":1499739265000},{"_id":"source/images/blogimages/2017/android_lint.png","hash":"fdf172859ab1ce584d06c6a5ff040d85d578b3f5","modified":1503650997000},{"_id":"source/images/blogimages/2017/aosp_make_single_module.png","hash":"e18bcd65212b1f74330a4154671a40d2f3923f1b","modified":1501663727000},{"_id":"source/images/blogimages/2017/binder-EIT-onTransact.png","hash":"3c10e03250b8f501385e44785ebd470a54bc63b5","modified":1498809293000},{"_id":"source/images/blogimages/2017/binder-EIT.png","hash":"1193bf7dbc3228cd60447548c412dce6644fff09","modified":1498809023000},{"_id":"source/images/blogimages/2017/binder-example-media.png","hash":"ca53f947f638cc270027476b1476f1546c463855","modified":1498811313000},{"_id":"source/images/blogimages/2017/im_company_abroad/im_layer.png","hash":"e69ec76db290bbd351ec49389d0a44df18726b17","modified":1487039161000},{"_id":"source/images/blogimages/2017/js/js_function_construction.png","hash":"72ec55ea431e8c476d2d869d3ffc1b4baec759c7","modified":1512354230000},{"_id":"source/images/blogimages/2017/js/js_function_construction_1.png","hash":"44ff70eb69c068ab96cee3491c4851af5a5b3d75","modified":1512354230000},{"_id":"source/images/blogimages/2017/js/js_function_construction_2.png","hash":"725ded11bd192c5c3887e66d4773026105d479ac","modified":1512355143000},{"_id":"source/images/blogimages/2017/pin_verify.png","hash":"a18ac663b5ad7d78659a7998b3a56bc6fc05a0a7","modified":1510125743000},{"_id":"source/images/blogimages/cisco/Adobe_Connect_Online_Store.png","hash":"e915a2be8e8e3bf922f4256be6e3264b2a564e11","modified":1512095672000},{"_id":"source/images/blogimages/cisco/Cisco_WebEx_Meetings_Pricing.png","hash":"807bc9239bff4322f98c6f5610be7c7a168ac45d","modified":1510714677000},{"_id":"source/images/blogimages/cisco/VC5_5_1.png","hash":"c67ade2c767fea92ffedf66e04dd4cbe6683f3c6","modified":1510723607000},{"_id":"themes/icarus/.git/refs/remotes/origin/master","hash":"b1147ee86a529ed7adf2e25ca93d0ba7b2ffc15c","modified":1511430089000},{"_id":"themes/icarus/.git/logs/refs/heads/master","hash":"8cf77ce91108e4d261cb91e55849437770f02a66","modified":1511430074000},{"_id":"themes/icarus/.git/objects/8b/66187fe067c3aa389ce8c98108f349ceae159c","hash":"12cd5f248df0246e058ccbf184f5eeb8f6456b09","modified":1511424067000},{"_id":"themes/icarus/source/libs/font-awesome/css/font-awesome.min.css","hash":"7cd5a3384333f95c3d37d9488ad82cd6c4b03761","modified":1480496898000},{"_id":"themes/icarus/source/libs/font-awesome/css/font-awesome.css","hash":"b5020c3860669185ba3f316fa7332cdf5c06f393","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-fb-comment-box.css","hash":"844ce27b8488968bccb3e50bb49184ba2aae0625","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-fb-comment-box.min.css","hash":"05830fadb8454f39dcc98c8686eb4d5c24b71fc0","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-fb-comment-box.css.map","hash":"51e9df39edf0faa3f38c1bab0c1fa6c922b9edcb","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-transitions.css","hash":"7871c28498d74451d6aa438c8d3a1817810a1e19","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/css/lightgallery.css","hash":"bef55316a32e512d5a8940e5d0bfe8bf7a9c5c61","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-transitions.min.css","hash":"5c22e2073a4c96d6212c72135391b599e8d1359f","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/css/lg-transitions.css.map","hash":"50c3348638b4d82fa08a449c690e8d2bb593005d","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/css/lightgallery.css.map","hash":"3175b4107078674d25798979f7666f4daf31e624","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/css/lightgallery.min.css","hash":"c9a2e19c932b56f4a2ce30c98910d10b74edb38a","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/fonts/lg.eot","hash":"54caf05a81e33d7bf04f2e420736ce6f1de5f936","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/fonts/lg.svg","hash":"9a732790adc004b22022cc60fd5f77ec4c8e3e5a","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/fonts/lg.ttf","hash":"f6421c0c397311ae09f9257aa58bcd5e9720f493","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/img/video-play.png","hash":"3ea484cdc04d2e4547f80cbf80001dcf248c94ef","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/fonts/lg.woff","hash":"3048de344dd5cad4624e0127e58eaae4b576f574","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/img/loading.gif","hash":"607810444094b8619fa4efa6273bc2a7e38dd4b4","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/img/youtube-play.png","hash":"fea6df9d9d43151f9c9d15f000adb30eb3e26fc4","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/img/vimeo-play.png","hash":"6190254f2804904a4a1fa1eb390dfd334e416992","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-fullscreen.js","hash":"65c47ac65362854ba44b00a010bb01e3630209d8","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-autoplay.js","hash":"426bb78b93acfc39d533ea2bab1cec8dc289cf24","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-fullscreen.min.js","hash":"b6b9e4022700b7faf2a5a175ba44a3bd938fdd20","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-autoplay.min.js","hash":"d845741bcaf961579622880eb2a445257efad1ac","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-hash.min.js","hash":"43f1e1e720ab0e241c19b83aa26bd6848eab8edc","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-hash.js","hash":"15d16516c5642d3de1566ff8fc9160136ccaa405","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-pager.min.js","hash":"25caa6ff65b1c6dee09941e795ae2633bdbab211","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-pager.js","hash":"8092c692b244bb26343eb03b91bd97deb9dafc9c","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-share.min.js","hash":"39c615f07c5d3aaa65a2c3068a30fdd6dd5c372d","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-share.js","hash":"b7fb5f6474911060a351b0a6fe9dbb9ac3fb22aa","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-thumbnail.min.js","hash":"18dd7d2909d1bfd6852f031d03e774b4428c512b","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-thumbnail.js","hash":"3a6476b6df1d2bef4a21861a78776282a7a11ef1","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-zoom.min.js","hash":"15b49f9728439819ece15e4295cce254c87a4f45","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-video.js","hash":"4f99b598f6bb18de9eca8c45c5b4373a03962367","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-video.min.js","hash":"032c001ab045a69856f9c3ed4a2a3bf12a8e310f","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/js/lg-zoom.js","hash":"a758e2c8fcf710f9ff761da0eea0ab9321f3484d","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/js/lightgallery.js","hash":"3cd19b33ba99efd5ba1d167da91720566d274b2c","modified":1480496898000},{"_id":"themes/icarus/source/libs/open-sans/fonts/LWCjsQkB6EMdfHrEVqA1KRJtnKITppOI_IvcXXDNrsc.woff2","hash":"2c5b039b57f62625e88226a938679ec937431ad1","modified":1480496898000},{"_id":"themes/icarus/source/libs/lightgallery/js/lightgallery.min.js","hash":"956ef9b706755318da69ad0b5d7786339d831251","modified":1480496898000},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNShWV49_lSm1NYrwo-zkhivY.woff2","hash":"22413bb8bfb78608c1e25aa1ed5c1f38557df79f","modified":1480496898000},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSj0LW-43aMEzIO6XUTLjad8.woff2","hash":"63eb74ef040aade256f2274a7f31a914edddb0ea","modified":1480496898000},{"_id":"themes/icarus/source/libs/open-sans/fonts/59ZRklaO5bWGqF5A9baEERJtnKITppOI_IvcXXDNrsc.woff2","hash":"c4248ea800bd5608344ce163f5658b57e7ef9410","modified":1480496898000},{"_id":"themes/icarus/source/libs/open-sans/fonts/K88pR3goAWT7BTt32Z01mxJtnKITppOI_IvcXXDNrsc.woff2","hash":"e0350190d720a8fec0557ab47b318ec4e4486448","modified":1480496898000},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSq-j2U0lmluP9RWlSytm3ho.woff2","hash":"4dc6d7174ea6d89f4c45e43e1bfc3e03d8ffebaf","modified":1480496898000},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSqaRobkAwv3vxw3jMhVENGA.woff2","hash":"415eee05976ab8b2471602a5ddb78a6c58fc21aa","modified":1480496898000},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSpX5f-9o1vgP2EXwfjgl7AY.woff2","hash":"328a22fe3eec71ad9e5ece4d67dd62e79dab6b7f","modified":1480496898000},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSv8zf_FOSsgRmwsS7Aa9k2w.woff2","hash":"c5f29fed6632efe0aa83318369f0d8c4061b775b","modified":1480496898000},{"_id":"themes/icarus/source/libs/open-sans/fonts/cJZKeOuBrn4kERxqtaUH3VtXRa8TVwTICgirnJhmVJw.woff2","hash":"afc44700053c9a28f9ab26f6aec4862ac1d0795d","modified":1480496898000},{"_id":"themes/icarus/source/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSugdm0LZdjqr5-oayXSOefg.woff2","hash":"a0b0c389cf46d63c850e61fed572485ff0b68183","modified":1480496898000},{"_id":"themes/icarus/source/libs/open-sans/fonts/RjgO7rYTmqiVp7vzi-Q5URJtnKITppOI_IvcXXDNrsc.woff2","hash":"be201d32a9aa5d186723ebb3c538be691aa8c53a","modified":1480496898000},{"_id":"themes/icarus/source/libs/open-sans/fonts/u-WUoqrET9fUeobQW7jkRRJtnKITppOI_IvcXXDNrsc.woff2","hash":"113978181dcac77baecef6115a9121d8f6e4fc3a","modified":1480496898000},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBjTOQ_MqJVwkKsUn0wKzc2I.woff2","hash":"b366f2fda2e524eb5ef50058eefff249a3b96e6c","modified":1480496898000},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBiYE0-AqJ3nfInTTiDXDjU4.woff2","hash":"5067c81462c15422853c94d21a1726865a61634f","modified":1480496898000},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBjUj_cnvWIuuBMVgbX098Mw.woff2","hash":"d22904914469be735490e3c8cb093c7862896dd5","modified":1480496898000},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBo4P5ICox8Kq3LLUNMylGO4.woff2","hash":"e75607ba1417181397c700775b84303d5a2957b9","modified":1480496898000},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBr6up8jxqWt8HVA3mDhkV_0.woff2","hash":"d0b40a7848703556c6631f24e961a98ca5829255","modified":1480496898000},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBkbcKLIaa1LC45dFaAfauRA.woff2","hash":"ae80fb3cd16339aa7b5da280ab53975523dcaac2","modified":1480496898000},{"_id":"themes/icarus/source/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBmo_sUJ8uO4YLWRInS22T3Y.woff2","hash":"b85efde42fa3a03c32b1d31c6cd74c622fc7916c","modified":1480496898000},{"_id":"themes/icarus/source/libs/open-sans/fonts/xozscpT2726on7jbcb_pAhJtnKITppOI_IvcXXDNrsc.woff2","hash":"be365eca44760ce3fc9b377c43d4634958479c69","modified":1480496898000},{"_id":"themes/icarus/source/libs/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasDy2Q8seG17bfDXYR_jUsrzg.woff2","hash":"b0e0bb5ef78db8b15d430d0b9be9d4329289a310","modified":1480496898000},{"_id":"themes/icarus/source/libs/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasD9V_2ngZ8dMf8fLgjYEouxg.woff2","hash":"942addaec4d3a60af33947a84a3d85f926015947","modified":1480496898000},{"_id":"source/images/blogimages/2016/androidart_ipc.png","hash":"3f3a0ead6d747386983ab5618f46a2f0c33bd84e","modified":1482748875000},{"_id":"source/images/blogimages/2016/androidart_service2.png","hash":"afdf0ded0d671ec79a03fddbd253de15eb5248ea","modified":1482748875000},{"_id":"source/images/blogimages/2017/communication-timing.png","hash":"d1eeb3d916b557902714e42604eb428e8820e1d8","modified":1499739494000},{"_id":"source/images/blogimages/2017/im_company_abroad/im_layer_email.png","hash":"1ba76d94651319eca5c6b701403c627c50c4e85b","modified":1487127003000},{"_id":"source/images/blogimages/2017/im_company_abroad/im_quickblox.png","hash":"d52b5c41e3771e0bba78fad79d26153da63b3d61","modified":1487038960000},{"_id":"source/images/blogimages/2017/im_company_abroad/im_snich.png","hash":"45a22cb7867faf9c223ffa52cad7f74171f79fe1","modified":1487038831000},{"_id":"source/images/blogimages/2017/media-server-process.png","hash":"43c087cbbcde726dca7c9db58f46f7fb33153a55","modified":1499738220000},{"_id":"source/images/blogimages/2017/system-service-register-process.png","hash":"a0f5a638c157a8cad7be85e1e232d15ecb8ac5de","modified":1499738409000},{"_id":"themes/icarus/.git/objects/ff/1d63b50ca0024630f66e13ef49002d30d858ba","hash":"7136445309f8c622b4fd69a7efd53f3bb90d5b71","modified":1511426169000},{"_id":"themes/icarus/source/libs/font-awesome/fonts/fontawesome-webfont.eot","hash":"965ce8f688fedbeed504efd498bc9c1622d12362","modified":1480496898000},{"_id":"themes/icarus/source/libs/font-awesome/fonts/FontAwesome.otf","hash":"1b22f17fdc38070de50e6d1ab3a32da71aa2d819","modified":1480496898000},{"_id":"themes/icarus/source/libs/font-awesome/fonts/fontawesome-webfont.woff","hash":"6d7e6a5fc802b13694d8820fc0138037c0977d2e","modified":1480496898000},{"_id":"themes/icarus/source/libs/font-awesome/fonts/fontawesome-webfont.woff2","hash":"97e438cc545714309882fbceadbf344fcaddcec5","modified":1480496898000},{"_id":"themes/icarus/source/libs/jquery/2.1.3/jquery.min.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1480496898000},{"_id":"source/images/blogimages/2017/binder-example-media-detail.png","hash":"1b250dc477539c98519b7f752f5816edf6cecf98","modified":1498811362000},{"_id":"source/images/blogimages/2017/im_company_abroad/im_applozic.png","hash":"fc0a0a0145e92182e93048d2f48cfd0b2886af88","modified":1487039222000},{"_id":"source/images/blogimages/2017/im_company_abroad/im_sendbird.png","hash":"541226b66fbf291d61d3d52c5c030b2f41ec8f94","modified":1487039177000},{"_id":"source/images/blogimages/cisco/Cisco_Collaboration_Meeting_Rooms_Hybrid_-_Cisco.png","hash":"cb3f157655946b3b3609804e39a4596470d99f0d","modified":1510729433000},{"_id":"source/images/blogimages/cisco/Adobe_web_conferencing_software.png","hash":"adcf5f49b46dce8457f5b32acad726995c750b2e","modified":1510885610000},{"_id":"themes/icarus/.git/logs/refs/remotes/origin/master","hash":"5460d1cd90d28bca4cf2e722d0da017f267910a5","modified":1511430089000},{"_id":"themes/icarus/source/libs/font-awesome/fonts/fontawesome-webfont.ttf","hash":"61d8d967807ef12598d81582fa95b9f600c3ee01","modified":1480496898000},{"_id":"source/images/blogimages/2017/aosp_monitor_position.png","hash":"ac98da872053c9a6e5637304b33077727c7f29f2","modified":1501734152000},{"_id":"source/images/blogimages/cisco/Cisco_Collaboration_Meeting_Rooms_Premises_-_Cisco.png","hash":"3d2108f0c5cb9020d58e19fe77c47e594e07eb82","modified":1510728774000},{"_id":"source/images/blogimages/cisco/VC5_5_3.png","hash":"25f7bbc61cec17c1c0b701f82fd18c0a9c070b89","modified":1510723650000},{"_id":"source/images/blogimages/cisco/zoom_cloud_hybrid.png","hash":"006d3089661e40e800bd8b24f960412a81875181","modified":1511142080000},{"_id":"themes/icarus/.git/objects/3a/df8661057de311bea7f0942339e2916c8896ae","hash":"e78a9d076ea055b9e6c13af9299b2296155afdcb","modified":1511425965000},{"_id":"source/images/blogimages/2017/binder-summary.png","hash":"0cc9038284ccce38e566e75459aa512fa2eccb75","modified":1499739747000},{"_id":"source/images/blogimages/2017/service-manager-activity.png","hash":"1e98a4ac00ef83968c28d1df7c84b0fa9fbdd100","modified":1499738275000},{"_id":"source/images/blogimages/cisco/Collaboration_Products_and_Solutions.png","hash":"85a88cd7196fd068952dfbe1eba2e7743b4b3fd8","modified":1510725408000},{"_id":"themes/icarus/.git/objects/bd/5236ab0d5c0f617c9e72be795c66ed8c6a108d","hash":"67cbe1d483bf53746178ac39a55586edf95df499","modified":1511425965000},{"_id":"themes/icarus/source/libs/font-awesome/fonts/fontawesome-webfont.svg","hash":"c0522272bbaef2acb3d341912754d6ea2d0ecfc0","modified":1480496898000},{"_id":"source/images/blogimages/cisco/VC5_5_4.png","hash":"9ce30296a85f313e2eecd16f876a48003c3fbb41","modified":1510723697000},{"_id":"source/images/blogimages/cisco/cmr_introduction.png","hash":"53bc162a868da6dc1f432caf5f58c302acd5693d","modified":1510192288000},{"_id":"source/images/blogimages/cisco/Adobe-Connect-Store.png","hash":"903d8df197da17ff185d835d7f5c61f1a021bad1","modified":1512095032000},{"_id":"source/images/blogimages/cisco/mx-700.png","hash":"8a6d2096c6e1c559558bfb65b7f27bfdcd293f88","modified":1510304336000},{"_id":"source/images/blogimages/cisco/Web_Conferencing__Video_Conferencing_Fuze.png","hash":"9d9e57804f57786b62aae008af1978d98a362bae","modified":1511144979000},{"_id":"themes/icarus/gallery/two_children_2.jpg","hash":"8044dafd28feb4c6aca2f5d48719385684ae9270","modified":1389073946000},{"_id":"themes/icarus/.git/objects/70/1ab9b31b9cd802c963f4c0ab87799b32e4fdf5","hash":"21b4ca56eb4660fb85d2834f14d3ad170197bfaa","modified":1511424067000},{"_id":"source/images/blogimages/2017/im_company_abroad/im_comparation.png","hash":"7251d4e152770b0ce93f9000e44a71d5b5ccf9e5","modified":1487040178000},{"_id":"themes/icarus/.git/objects/42/87278be119ecdd9d7256c0876ac99193f7d477","hash":"687a894c81527792bfd458d74ad4dcd482eac7d1","modified":1511425569000},{"_id":"themes/icarus/.git/objects/00/c9a22f0d5871f98a5be409ebe16278429bd8a2","hash":"b53a93fc1651659f190cc774b68d5b30368c5fc4","modified":1511425569000},{"_id":"public/baidusitemap.xml","hash":"43fdf16482e002dcb90e23b99f5eb259573d9461","modified":1512634290839},{"_id":"public/content.json","hash":"c6b4fdb10d9fe3c5782c0dee033840f626f65bbe","modified":1512634292804},{"_id":"public/sitemap.xml","hash":"45157fd7b04fa54750ee8a6d4dd439c123d1108b","modified":1512634293138},{"_id":"public/about/index.html","hash":"e73d9eb01e7a62057f4ff17fc659b5a9bf22bcdd","modified":1512634293321},{"_id":"public/categories/index.html","hash":"5fa80b86ad706d80ae102af7969cdc28eb35ce6f","modified":1512634293321},{"_id":"public/tags/index.html","hash":"6d2298fa20d8093c8f31dfbc5c0d3dd30caf9e60","modified":1512634293321},{"_id":"public/2017/10/22/JavaScript-knowledge/index.html","hash":"f9f111dbba633fa30e03203619a0bb41476bd4b3","modified":1512634293321},{"_id":"public/2017/10/22/Buildcross-platform-desktop-apps/index.html","hash":"4797e7202f345540e91a8da9da3e408e9ea75ad0","modified":1512634293321},{"_id":"public/2017/09/21/PBOCKonwledgeCode/index.html","hash":"107132dfb6313a1ee7938a11902626d8733a4b4b","modified":1512634293321},{"_id":"public/2017/09/12/PBOCKonwledge/index.html","hash":"85870935b4984ea2e1dc1865b1c630fe627bae35","modified":1512634293321},{"_id":"public/2017/08/17/IntervieweeQuestions/index.html","hash":"0b6846e0a33b145cc447ca2691c5cb446de1f5f9","modified":1512634293321},{"_id":"public/2017/08/02/activity-start-process/index.html","hash":"12b63a07095566a35e0b7241e4046e21a52f0ddc","modified":1512634293322},{"_id":"public/2017/08/01/aosp-compile/index.html","hash":"4c6d9126b594502457dd49189e039f9f58b9f8b4","modified":1512634293322},{"_id":"public/2017/07/12/android-noroot-hook/index.html","hash":"41a45674dc7ee7134f2286d0c59fee683e7d9c77","modified":1512634293322},{"_id":"public/2017/07/10/android-binder-principle2/index.html","hash":"c94bd0b2a56ee34f811e0e32aad852db7f81ba8e","modified":1512634293322},{"_id":"public/2017/07/08/android-binder-principle/index.html","hash":"a7814678c022fec897ab85cbb1dbb0c24c0bea4f","modified":1512634293322},{"_id":"public/2017/05/18/handler-replace-timertask/index.html","hash":"44c096e4c63920dbf8e07f58f68f543c3de64df8","modified":1512634293322},{"_id":"public/2017/05/11/Object-Oriented/index.html","hash":"77c8f23a495c50b26b18d0ace79e4a9e1e3734a5","modified":1512634293322},{"_id":"public/2017/04/10/Annotation-Android-usage/index.html","hash":"3c745ece4e8a73e012264d090785f8f063008f8c","modified":1512634293322},{"_id":"public/2017/03/20/SVN-server-linux/index.html","hash":"a97414a64c2569cbc46f6c19eccb310d10eb9506","modified":1512634293322},{"_id":"public/2017/03/14/JAVA-CDI-Assertion/index.html","hash":"5b89713bc88cc4b2fe60b1c418f1697617b92214","modified":1512634293322},{"_id":"public/2017/03/09/Https-Questions/index.html","hash":"8028fef69d8a2067686e4b9d93fc523bb70d3caf","modified":1512634293322},{"_id":"public/2017/02/21/Multi-Process-Dispatch/index.html","hash":"e714d04ff17bcfdabce76bf2f43caa389dc2b7a6","modified":1512634293322},{"_id":"public/2017/02/12/iterm2-to-linux/index.html","hash":"163667c884a6db4dab1b70c4ade3bb9d4bba3199","modified":1512634293323},{"_id":"public/2017/01/13/abroad-IM-service-company/index.html","hash":"2d4cf777002f1cc080c8ce7afaa191924fd4d39c","modified":1512634293323},{"_id":"public/2016/12/20/Android-patch-update/index.html","hash":"c9ef2bf4e42ad92aa896a6643a3a76d592e9ac13","modified":1512634293323},{"_id":"public/2016/12/11/ThreadLocal-usage/index.html","hash":"007e58f8aa9ecb9098914731aa87c6262c6aab0d","modified":1512634293323},{"_id":"public/2016/12/06/hexo-learning1/index.html","hash":"1f0cf3a961c6afa23d19c96e6451e29d6dab0e11","modified":1512634293323},{"_id":"public/2016/12/04/hexo-learning0/index.html","hash":"df1faac290a717b59c51d99d434446e02ed5ed00","modified":1512634293323},{"_id":"public/2016/12/03/nodejs-learning-getting-started/index.html","hash":"eaaf027db6d330ee267476cbdded7724af898a98","modified":1512634293323},{"_id":"public/2016/11/21/Difference_between-T-E-K-V/index.html","hash":"d4db66e635657c2f2d54169ff657755470b79fb1","modified":1512634293323},{"_id":"public/2016/11/03/hexo-mac-module-not-found/index.html","hash":"4d760f281a3e2ca7dcfdff344d9a02f6acbabe27","modified":1512634293323},{"_id":"public/2016/10/13/gradle-learning2/index.html","hash":"86f95419f31b517253b2490aafeeb50606301959","modified":1512634293323},{"_id":"public/2016/10/12/gradle-learning/index.html","hash":"21f0f6b63c8d0563c156d7e87b642ec589b283df","modified":1512634293323},{"_id":"public/2016/09/28/Android-interview-questions/index.html","hash":"f7eb3e7bddaa37e2295828d5332e4528fdf11f1b","modified":1512634293323},{"_id":"public/2016/09/22/JNI-get-publickey/index.html","hash":"0adaabb309e5e6b0d11ff5088f5114d744aa50cd","modified":1512634293323},{"_id":"public/2016/09/22/quit-whole-application/index.html","hash":"4e16a3f2d41ba9b7f342557a1ff24a3db8be2992","modified":1512634293323},{"_id":"public/2016/09/20/android-design-pattern-singleton/index.html","hash":"d33f451b20784c03e3df39e93de909d04f98e5d0","modified":1512634293323},{"_id":"public/2016/09/20/AVG-unwanted-software/index.html","hash":"1b23c4784d97d2ad2544b9280d626d45d5e95467","modified":1512634293324},{"_id":"public/2016/09/05/ThreadLocal-HandlerThread-Looper/index.html","hash":"e4ae83255546e3a25976c568e0e2b01865ea7796","modified":1512634293324},{"_id":"public/2016/08/16/RxAndroid-Learning/index.html","hash":"d510421a972fd2561768c49eeb6ef05391c660be","modified":1512634293324},{"_id":"public/2016/08/03/android-LocationListener/index.html","hash":"a3848bf0f2b4f41058ff1e8205f273026c04b7f4","modified":1512634293325},{"_id":"public/2016/07/25/android-webview-summary/index.html","hash":"086d618442a6dc0739ee042afd0003c5ddf7745f","modified":1512634293325},{"_id":"public/2016/06/08/gson-summary/index.html","hash":"f2fbce9256713161882e08e570aeb5a3fbd6516d","modified":1512634293326},{"_id":"public/2016/05/28/qiniu-android-summary/index.html","hash":"4acf8886b0c824368c65e3659d9b603f1c77d675","modified":1512634293326},{"_id":"public/2016/05/24/JNI-Learning/index.html","hash":"b33bd8380592051870b6e032922d6618ab6d3e0c","modified":1512634293327},{"_id":"public/2016/05/24/JNI-Learning0/index.html","hash":"13cc8936167b8f8a1e36f76ed0c48bad8e30fe81","modified":1512634293327},{"_id":"public/2016/05/18/javaString-and-bytes/index.html","hash":"bb63dfb2018946ca2d882e4e10181c59c44323de","modified":1512634293329},{"_id":"public/2016/05/12/GCM-Azure_summary/index.html","hash":"e9b9d57b706f341d3daaa1ee98d193214c8e7ced","modified":1512634293329},{"_id":"public/2016/03/20/android-books-reading-/index.html","hash":"5001f6255cd5c979551d604e3f73ab3a2539763d","modified":1512634293329},{"_id":"public/2016/03/20/android-new-knowledge-summary/index.html","hash":"2f5413cca133cc73168d23c731f08fdc128cfd00","modified":1512634293330},{"_id":"public/2016/03/15/facebook-google+signin/index.html","hash":"8c5fe49851b599b801c1dc34caa1922eb2572225","modified":1512634293331},{"_id":"public/2016/03/01/android-googlemap-summary/index.html","hash":"6ef0983553e2e7179216672e732a831142a1c573","modified":1512634293331},{"_id":"public/2015/11/06/book-list-of-2015/index.html","hash":"0f365cb3161af4d1d72698ea955df94aa32dbba7","modified":1512634293331},{"_id":"public/2015/03/16/java-multithreading-concurrent/index.html","hash":"9724305bd3b9331a47124e8b105fb49799f78d33","modified":1512634293331},{"_id":"public/2015/01/27/android-open-sources/index.html","hash":"626cc05754f3d6ed3c82a1176030b02760e81664","modified":1512634293331},{"_id":"public/2014/12/23/hello-world/index.html","hash":"fb599e126418a845ae8ba54aad7d73940c66ffa3","modified":1512634293331},{"_id":"public/archives/index.html","hash":"aca3d085d4172bc93c7af97a65874a889194657b","modified":1512634293331},{"_id":"public/archives/page/2/index.html","hash":"b71c6b75cd694bfc0413682eb6f448f593e286d7","modified":1512634293331},{"_id":"public/archives/page/3/index.html","hash":"d297f305c5df8d45992a97586f6c6a7dfb681463","modified":1512634293331},{"_id":"public/archives/page/4/index.html","hash":"87320ec58b5560b069945d4e7dd48a2d1da6ee8e","modified":1512634293332},{"_id":"public/archives/page/5/index.html","hash":"5c633956c5e32ba18bef95aeb44ec50e768b5eb1","modified":1512634293332},{"_id":"public/archives/page/6/index.html","hash":"b5237df9947e9845f08541702536f12ace628b5d","modified":1512634293332},{"_id":"public/archives/page/7/index.html","hash":"e28b1708edae6a8de093943f8e65c492283282f4","modified":1512634293332},{"_id":"public/archives/2014/index.html","hash":"da4f070ef0d903de635e9baaaf3e68b4bd5d55c6","modified":1512634293332},{"_id":"public/archives/2014/12/index.html","hash":"5a15f4726e9f725f1bebf33a92fd9f3262031f10","modified":1512634293332},{"_id":"public/archives/2015/index.html","hash":"62513ef0848fc95693b3fd58402bd87784717f15","modified":1512634293332},{"_id":"public/archives/2015/01/index.html","hash":"ca0bc0a656780a41573ec31ce7c6647ea0b4309d","modified":1512634293332},{"_id":"public/archives/2015/03/index.html","hash":"6befcac75cffed992859489ac228f52a82e1d0fc","modified":1512634293332},{"_id":"public/archives/2015/11/index.html","hash":"8c516a6d1e14ab6c85e521ea8c9d812deea798ae","modified":1512634293332},{"_id":"public/archives/2016/index.html","hash":"b21bf4016d2018e5035c32fb5e9b5b89068f4dee","modified":1512634293332},{"_id":"public/archives/2016/page/2/index.html","hash":"aaeee43aba8b5fbd1bf26e6bb48d05faf49541c2","modified":1512634293332},{"_id":"public/archives/2016/page/3/index.html","hash":"ae171d16b264882603e88de9192f9b2252a8d787","modified":1512634293332},{"_id":"public/archives/2016/page/4/index.html","hash":"f7933c83a98d8e84cda38665ede5b7d3aeaf4372","modified":1512634293333},{"_id":"public/archives/2016/03/index.html","hash":"25a69112d714719021bb509091c4e7782ea38183","modified":1512634293333},{"_id":"public/archives/2016/05/index.html","hash":"cc028eb5803023275388b08da2e904924d03b9ea","modified":1512634293333},{"_id":"public/archives/2016/06/index.html","hash":"b78e50a24299771ffb706860ba83e803e133f9e6","modified":1512634293333},{"_id":"public/archives/2016/07/index.html","hash":"5ba7cd20fdc614cf6f221e8c44e409480e5a99ec","modified":1512634293333},{"_id":"public/archives/2016/08/index.html","hash":"542d0c43b3ad5c4d0fec3bbdbab61228e2d9b511","modified":1512634293333},{"_id":"public/archives/2016/09/index.html","hash":"e22c83cd7597272a2d537cc60efd7eddee6625c1","modified":1512634293333},{"_id":"public/archives/2016/10/index.html","hash":"48417c489c3a7a1d19d643d2c1df5cfa8d67adad","modified":1512634293333},{"_id":"public/archives/2016/11/index.html","hash":"b36a10f2f519daeed98899c218437c8448ad911c","modified":1512634293333},{"_id":"public/archives/2016/12/index.html","hash":"241e46c57d6f70ccfacbae17eb3caa20728460d9","modified":1512634293333},{"_id":"public/archives/2017/index.html","hash":"a3b84d6523480e1f536a2b08cccb6f303c879361","modified":1512634293333},{"_id":"public/archives/2017/page/2/index.html","hash":"8bcaa44564def07a91a5a80f04500c53e008921e","modified":1512634293333},{"_id":"public/archives/2017/page/3/index.html","hash":"16e6975325e60bb507a49135fcce14daeb6e64c8","modified":1512634293333},{"_id":"public/archives/2017/01/index.html","hash":"ebbdef96c778ffcfeaff94cc00b7c83da7c45e69","modified":1512634293333},{"_id":"public/archives/2017/02/index.html","hash":"053311be17c001abb2fbc49326cf96f861afff92","modified":1512634293334},{"_id":"public/archives/2017/03/index.html","hash":"6204b46164dd3bc784763822232074ecf8fdda02","modified":1512634293334},{"_id":"public/archives/2017/04/index.html","hash":"64c986536ecb111d6327620989055d8d23611354","modified":1512634293334},{"_id":"public/archives/2017/05/index.html","hash":"2f6b614a7d724cfe97ae7d8cdca3535c2066297f","modified":1512634293334},{"_id":"public/archives/2017/07/index.html","hash":"a1b52ea6b01fb4f91f2b83cc3de1008049af7577","modified":1512634293334},{"_id":"public/archives/2017/08/index.html","hash":"50d0bc9a44c8304eb242daf6eaa4bf3a888e33a4","modified":1512634293334},{"_id":"public/archives/2017/09/index.html","hash":"cbe803f1cf0bd778caf816d0188772e7f4ce55cb","modified":1512634293334},{"_id":"public/archives/2017/10/index.html","hash":"ddce4f030ef3f42cd2e1d25db10a30deca672c6a","modified":1512634293334},{"_id":"public/categories/accumulation/index.html","hash":"e706310117205cdce5d404f056389a920e5bf519","modified":1512634293334},{"_id":"public/categories/accumulation/page/2/index.html","hash":"eee6a7a46357de5c1102461ca7b6dbc6e9b6585f","modified":1512634293334},{"_id":"public/categories/accumulation/page/3/index.html","hash":"226d9340049e278a4d4d5af1e335414f2416b94e","modified":1512634293334},{"_id":"public/categories/accumulation/page/4/index.html","hash":"d5f740f23255704a1b380ba1023fcfe379f12ed8","modified":1512634293334},{"_id":"public/categories/accumulation/page/5/index.html","hash":"bf4ff669f0f7a252bf413ba804af4efba3ac5665","modified":1512634293334},{"_id":"public/categories/accumulation/page/6/index.html","hash":"e4295c0057a4815754524f62135d3547d9aefbda","modified":1512634293335},{"_id":"public/categories/read/index.html","hash":"005ed52c96eedb09b470540de9b40089b0c06253","modified":1512634293335},{"_id":"public/categories/technology/index.html","hash":"230e5983d6148a5cbe49b0e6680c9b2d267439f1","modified":1512634293335},{"_id":"public/categories/investigation/index.html","hash":"cc7cd8f7ff90308aafcd3825e08ae4aab894ef6a","modified":1512634293335},{"_id":"public/index.html","hash":"97b2bd080d8717709ffb8aec2a259c966c7d03d7","modified":1512634293335},{"_id":"public/page/2/index.html","hash":"70b9cc55b33887c26a50584315c817219b5ba2e0","modified":1512634293335},{"_id":"public/page/3/index.html","hash":"d1f12f54e34cbc1823ec71c2a0bf4b807624efe2","modified":1512634293335},{"_id":"public/page/4/index.html","hash":"26a61f94f33cb07d3fd36f342625b57a8e9b50ab","modified":1512634293335},{"_id":"public/page/5/index.html","hash":"c15b742ac7128c434bc633ebfdcfabfd04efa1a8","modified":1512634293335},{"_id":"public/page/6/index.html","hash":"362e1c75b1f1cee1b7a727865e52fdcfc71f14cb","modified":1512634293335},{"_id":"public/page/7/index.html","hash":"c4c5351343ca4be56c24dcf65785da7d2e3b2ba0","modified":1512634293335},{"_id":"public/tags/android/index.html","hash":"f1de10236f7f013816467120b5bf09a9a5391fa9","modified":1512634293335},{"_id":"public/tags/android/page/2/index.html","hash":"03524ecce626d2c390aeedf6ddd89eca38e164ae","modified":1512634293335},{"_id":"public/tags/android/page/3/index.html","hash":"4e2a5054f9416f24d02a209b58a741b1f3673b69","modified":1512634293335},{"_id":"public/tags/open-souces/index.html","hash":"e8ea3c76ebbcc82f11dbbe30223a3015461c9055","modified":1512634293335},{"_id":"public/tags/java/index.html","hash":"c5a04973c4a90b29d9b54451b6c9483511aba695","modified":1512634293335},{"_id":"public/tags/multi-thread/index.html","hash":"c101612994fd2bda8b3dd76d5bf4b6760e3189ee","modified":1512634293335},{"_id":"public/tags/interview-knowledge/index.html","hash":"a3be8f4b8befbf31e19d5ce1f48c982045f111f7","modified":1512634293336},{"_id":"public/tags/read/index.html","hash":"61f6c2a322a0a007132b94dbf861972abd7bfa92","modified":1512634293336},{"_id":"public/tags/google-map/index.html","hash":"577cfa0b88990cafdc905adf0b0bee71f4173f12","modified":1512634293336},{"_id":"public/tags/third-party-signin/index.html","hash":"efab8f3d5389c3f3774f572c86990683b86176b2","modified":1512634293336},{"_id":"public/tags/new-features/index.html","hash":"7237abc946f61f4c1c590dd6134624033f1440e3","modified":1512634293336},{"_id":"public/tags/basic-knowledge/index.html","hash":"54f24d2ec632a39663926dde886b7a94a55eb439","modified":1512634293336},{"_id":"public/tags/reading/index.html","hash":"4f1714bb0fa0eafe5ee404901a1ae55541807d96","modified":1512634293336},{"_id":"public/tags/gcm/index.html","hash":"bb15730cb58808e15a3d5ab2dd68556e518be501","modified":1512634293336},{"_id":"public/tags/azure/index.html","hash":"90474d4f60d4677c1e6d39a78a126f477a848894","modified":1512634293336},{"_id":"public/tags/notification/index.html","hash":"c08d752c4d2411fe840197616002161d51a80c84","modified":1512634293336},{"_id":"public/tags/byte/index.html","hash":"519871bbf70e4bab98eae5ac1509136dca584e85","modified":1512634293336},{"_id":"public/tags/jni/index.html","hash":"b1b5304443abcebde93a0c02908bf867a5c507e4","modified":1512634293336},{"_id":"public/tags/aes/index.html","hash":"51db347a7e5867ca465b6234e1a1620652043c77","modified":1512634293336},{"_id":"public/tags/android-source-code/index.html","hash":"e17a409b1f54073c61914923c695521f05bcd648","modified":1512634293336},{"_id":"public/tags/gson/index.html","hash":"180e94eeca2989e29c33a742fca6ba22fd866ed3","modified":1512634293336},{"_id":"public/tags/qiniu/index.html","hash":"2f4fd64843114f0d9f9a49169dc22078f1a34c86","modified":1512634293336},{"_id":"public/tags/webview/index.html","hash":"caa488e52a0cb494c43f09ce4daf3da6cbad2578","modified":1512634293338},{"_id":"public/tags/locationlistener/index.html","hash":"4965d56cbd7a09f15421404f32a74eae1b239447","modified":1512634293338},{"_id":"public/tags/rxjava/index.html","hash":"09acfbc7523a4a0174ae484bd23cecbf195c9260","modified":1512634293338},{"_id":"public/tags/rxandroid/index.html","hash":"692adaad63d7e85fd0445de08e148821021b264d","modified":1512634293338},{"_id":"public/tags/threadlocal/index.html","hash":"5f0d27e4c9f2525891753ecc0f72a618d2d563d6","modified":1512634293338},{"_id":"public/tags/handlerthread/index.html","hash":"b12e7a878783a2b539c0f3baa6e1712c196af50f","modified":1512634293338},{"_id":"public/tags/looper/index.html","hash":"2950bc9898545584ff20ddbbabd098595edaac12","modified":1512634293339},{"_id":"public/tags/remove-admob/index.html","hash":"e9909d3720a858905119a13ccbe802421d3092e5","modified":1512634293339},{"_id":"public/tags/singleton/index.html","hash":"44421acab9c452063a0e49d6663326cbda0dd7bb","modified":1512634293339},{"_id":"public/tags/publickey/index.html","hash":"c7ae2b5b3a4e5726a4145ddfbc31ff3d7434689b","modified":1512634293339},{"_id":"public/tags/gradle/index.html","hash":"af7b7ebf7bb89daf7216e82943e5cb951e0e33cc","modified":1512634293339},{"_id":"public/tags/exitapplication/index.html","hash":"5a6e8bb54d1d4c13d8a4f6768e73b2d9e3305e5c","modified":1512634293339},{"_id":"public/tags/hexo/index.html","hash":"fb9be6b41ad5e03a31a7b63a70e5e10a4b1373e5","modified":1512634293339},{"_id":"public/tags/genericity/index.html","hash":"aeaa8a35d16534dd368fcbe844ce39032c213934","modified":1512634293339},{"_id":"public/tags/hexo-structure/index.html","hash":"365fca839b8fbe7713ef114a888cb34cbc66ff23","modified":1512634293339},{"_id":"public/tags/ejs/index.html","hash":"a0ad2826611c468cfa2fb08c9795fe4e255a9e73","modified":1512634293339},{"_id":"public/tags/im-company/index.html","hash":"b61ef08adf08a88673fd67948f181442fa9e7fbd","modified":1512634293339},{"_id":"public/tags/patch-update/index.html","hash":"e5088d2cfbb51aedb34bf61f04e9f10673cfb94d","modified":1512634293339},{"_id":"public/tags/linux/index.html","hash":"d261ecfc367a20421b2a6e536258527927a66bcc","modified":1512634293339},{"_id":"public/tags/iterm/index.html","hash":"89c30da138e50af4632f9f3c3e336a46307abf87","modified":1512634293339},{"_id":"public/tags/scp/index.html","hash":"575681e245cacd48b5c8466d0490514c67314b84","modified":1512634293340},{"_id":"public/tags/multi-process/index.html","hash":"166dbc0e998f771490ae4fb40c56e37efb03469e","modified":1512634293340},{"_id":"public/tags/svn-server/index.html","hash":"aeb2c50cb0be8dec3726fb0cdae2d820f91bd2c9","modified":1512634293340},{"_id":"public/tags/https/index.html","hash":"c26e9fef0c1cd42d66d2adaeee7550793b908df3","modified":1512634293340},{"_id":"public/tags/injection/index.html","hash":"178a50dfc7012aeee65e65be65e914040a4d6d63","modified":1512634293340},{"_id":"public/tags/assertion/index.html","hash":"a8f522ab759f1f51d3851bec60e6c18f84bab58f","modified":1512634293340},{"_id":"public/tags/annotation/index.html","hash":"a858cabae91717a0f4b6f31eda4dd0db526c8ddf","modified":1512634293340},{"_id":"public/tags/android-framework/index.html","hash":"5c0652d72bfa25b12a3efbbf46cbf3748d32cb11","modified":1512634293340},{"_id":"public/tags/eit/index.html","hash":"7da270e6447786da94a6f4e24f1ed0acd84016c4","modified":1512634293340},{"_id":"public/tags/object-oriented/index.html","hash":"dbcfe5e820a82081539039313536f1e6ec0d0cce","modified":1512634293340},{"_id":"public/tags/hook/index.html","hash":"712881c5c34885748caa34630807ab8afcd4309a","modified":1512634293340},{"_id":"public/tags/android-system-service/index.html","hash":"54f1bffdf41bf25eb541976985565b20c73173d1","modified":1512634293340},{"_id":"public/tags/binder/index.html","hash":"760b055c74acfe0ade5a1999780ecb8c0538994f","modified":1512634293340},{"_id":"public/tags/timertask/index.html","hash":"96f7b62c1b51307c032debabbee65750117a5bad","modified":1512634293341},{"_id":"public/tags/handler/index.html","hash":"0ff269f93ee7aadc291b7a42328be1c1d36d3f1d","modified":1512634293341},{"_id":"public/tags/aidl/index.html","hash":"1d4ed6fdb91a0a2a0392c55cf240da1b57568b87","modified":1512634293341},{"_id":"public/tags/aosp/index.html","hash":"8ef07e91c2409eed1ed2433d9b3a31780f9d660c","modified":1512634293341},{"_id":"public/tags/sdk-compile/index.html","hash":"4297247ed10a26078f8df6175e2127a49082ddb6","modified":1512634293341},{"_id":"public/tags/ams/index.html","hash":"d8e29e2f56696d9148404cb39b51c28851ec1744","modified":1512634293341},{"_id":"public/tags/pboc/index.html","hash":"20200567b4747028b9f20ce99337b55c6aaf6304","modified":1512634293342},{"_id":"public/tags/pboc-2-0/index.html","hash":"7be26194745dd11f4f3c0eaa9e7d3a412ddff411","modified":1512634293342},{"_id":"public/tags/alfred-workflow/index.html","hash":"12e0d0537121100b8c5c0fcf0ad52a2843f0dcd3","modified":1512634293342},{"_id":"public/tags/electron/index.html","hash":"8144a415d59545377b824dd963abe2dfce4c48a0","modified":1512634293342},{"_id":"public/tags/javascript/index.html","hash":"9907a40089f81ffff3d4ba41172460d8cf09ab21","modified":1512634293342},{"_id":"public/tags/nodejs/index.html","hash":"4b097bc9d1d28382ff8e516929b40fa08325825c","modified":1512634293342},{"_id":"public/images/avatar.png","hash":"2daa0d02ee54bee9a6968e098013fb37a7fab7bc","modified":1512634293385},{"_id":"public/images/favicon.ico","hash":"e64542caa1b7a07484925304cd99c93129dfce8e","modified":1512634293385},{"_id":"public/images/blogimages/2016/ThreadLocal.png","hash":"29a37aefd8f9aa455e5f5e41d56d374184c8694b","modified":1512634293385},{"_id":"public/images/blogimages/2016/androidart_broadcastreceiver1.png","hash":"dc4a97d2b8ef1f6592717204788d9f716117fdee","modified":1512634293385},{"_id":"public/images/blogimages/2016/avg_warning.PNG","hash":"1b8817b076f48cf8217439e0265cb4216abb3d17","modified":1512634293385},{"_id":"public/images/blogimages/2016/google_servcie_ads.PNG","hash":"10c107e578bcfb28ee9f38c247f62cb99f14ea1a","modified":1512634293385},{"_id":"public/images/blogimages/2016/gradle_structure1.png","hash":"0b8c1f213bb88852ecb0fd8a50b60f310d6a23e8","modified":1512634293385},{"_id":"public/images/blogimages/2016/gradle_structure2.png","hash":"6a8aefb3577950beeba2900f507e749dd518345e","modified":1512634293385},{"_id":"public/images/blogimages/2016/jni_structure.png","hash":"312696c9a056a734ff63d9457ff0bb83f356f057","modified":1512634293385},{"_id":"public/images/blogimages/2016/gradle_task.png","hash":"6890da207d5772a6f141024267547db56e9bec38","modified":1512634293385},{"_id":"public/images/blogimages/2017/PackageManagerService.png","hash":"c796723407d80b2252667add5e2734f7f80f5cd0","modified":1512634293385},{"_id":"public/images/blogimages/2017/apt_processor.png","hash":"9b75b07d395db890bef153daf95f0f4a365e4576","modified":1512634293385},{"_id":"public/images/blogimages/2017/binder-02.png","hash":"014d8a4c1061ae8186a59095694eafbc96aad029","modified":1512634293385},{"_id":"public/images/blogimages/2017/binder-01.png","hash":"cdedd11dc6e75fe0a5cef7d313624ae31be881d3","modified":1512634293385},{"_id":"public/images/blogimages/2017/binder-open-drive.png","hash":"0ef23b58ba4f06233d0f3cfef4fbccf27e2dbdf3","modified":1512634293385},{"_id":"public/images/blogimages/2017/binder-service-manager.png","hash":"b99d44d9bf79a26bff169c7ece70abf7dc6fb3de","modified":1512634293385},{"_id":"public/images/blogimages/2017/device-number.png","hash":"50005dc453a70edab64d828508b2ba139c0df338","modified":1512634293385},{"_id":"public/images/blogimages/2017/binder-system-service.png","hash":"d388f2e4cdd90e1e7ebcf4ad85c0af6c98427c74","modified":1512634293386},{"_id":"public/images/blogimages/2017/clipboard-ipc-process.png","hash":"2419837d48fca339b19e6a3a6d053301699e20c4","modified":1512634293386},{"_id":"public/images/blogimages/2017/funny_pic.jpg","hash":"fd45920ce6bdb70e1af2a56998700b8ce717d06f","modified":1512634293386},{"_id":"public/images/blogimages/2017/getStrongProxyForHandle.png","hash":"e3f3167645262e911feabc39e8fc4431c1fb5027","modified":1512634293386},{"_id":"public/images/blogimages/2017/ibinder-binder.png","hash":"844df893c87e22eae853536204010d88a9df745f","modified":1512634293386},{"_id":"public/images/blogimages/2017/processor_jar.png","hash":"f1b9bb1ab096157303f4cb9c50904f485add7782","modified":1512634293386},{"_id":"public/images/blogimages/2017/transact-binder.png","hash":"49129266297f97d7883900dda0304c3a2f5cc3a7","modified":1512634293387},{"_id":"public/images/blogimages/2017/servicemanager-find-service.png","hash":"ea408c25c09bc94103d68ed23941a3cebd8c18f9","modified":1512634293387},{"_id":"public/css/images/avatar.png","hash":"2daa0d02ee54bee9a6968e098013fb37a7fab7bc","modified":1512634293387},{"_id":"public/css/images/avatar0.png","hash":"2daa0d02ee54bee9a6968e098013fb37a7fab7bc","modified":1512634293387},{"_id":"public/css/images/avatar1.png","hash":"2daa0d02ee54bee9a6968e098013fb37a7fab7bc","modified":1512634293387},{"_id":"public/css/images/thumb-default-small.png","hash":"e8403b97ed9251f9f5207765b0ce796c5000b4ba","modified":1512634293387},{"_id":"public/css/images/logo.png","hash":"e606a0584f98268b2fe92303f3254520862ef659","modified":1512634293387},{"_id":"public/images/blogimages/2017/im_company_abroad/im_layer.png","hash":"e69ec76db290bbd351ec49389d0a44df18726b17","modified":1512634293387},{"_id":"public/images/blogimages/2017/js/js_function_construction.png","hash":"72ec55ea431e8c476d2d869d3ffc1b4baec759c7","modified":1512634293387},{"_id":"public/images/blogimages/2017/js/js_function_construction_1.png","hash":"44ff70eb69c068ab96cee3491c4851af5a5b3d75","modified":1512634293387},{"_id":"public/images/blogimages/2017/js/js_function_construction_2.png","hash":"725ded11bd192c5c3887e66d4773026105d479ac","modified":1512634293387},{"_id":"public/libs/lightgallery/css/lg-fb-comment-box.css.map","hash":"51e9df39edf0faa3f38c1bab0c1fa6c922b9edcb","modified":1512634293387},{"_id":"public/libs/lightgallery/css/lg-transitions.css.map","hash":"50c3348638b4d82fa08a449c690e8d2bb593005d","modified":1512634293387},{"_id":"public/libs/lightgallery/css/lightgallery.css.map","hash":"3175b4107078674d25798979f7666f4daf31e624","modified":1512634293387},{"_id":"public/libs/lightgallery/fonts/lg.eot","hash":"54caf05a81e33d7bf04f2e420736ce6f1de5f936","modified":1512634293387},{"_id":"public/libs/lightgallery/fonts/lg.svg","hash":"9a732790adc004b22022cc60fd5f77ec4c8e3e5a","modified":1512634293387},{"_id":"public/libs/lightgallery/fonts/lg.ttf","hash":"f6421c0c397311ae09f9257aa58bcd5e9720f493","modified":1512634293387},{"_id":"public/libs/lightgallery/img/video-play.png","hash":"3ea484cdc04d2e4547f80cbf80001dcf248c94ef","modified":1512634293388},{"_id":"public/libs/lightgallery/fonts/lg.woff","hash":"3048de344dd5cad4624e0127e58eaae4b576f574","modified":1512634293388},{"_id":"public/libs/lightgallery/img/loading.gif","hash":"607810444094b8619fa4efa6273bc2a7e38dd4b4","modified":1512634293388},{"_id":"public/libs/lightgallery/img/youtube-play.png","hash":"fea6df9d9d43151f9c9d15f000adb30eb3e26fc4","modified":1512634293388},{"_id":"public/libs/lightgallery/img/vimeo-play.png","hash":"6190254f2804904a4a1fa1eb390dfd334e416992","modified":1512634293388},{"_id":"public/libs/open-sans/fonts/LWCjsQkB6EMdfHrEVqA1KRJtnKITppOI_IvcXXDNrsc.woff2","hash":"2c5b039b57f62625e88226a938679ec937431ad1","modified":1512634293388},{"_id":"public/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNShWV49_lSm1NYrwo-zkhivY.woff2","hash":"22413bb8bfb78608c1e25aa1ed5c1f38557df79f","modified":1512634293388},{"_id":"public/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSj0LW-43aMEzIO6XUTLjad8.woff2","hash":"63eb74ef040aade256f2274a7f31a914edddb0ea","modified":1512634293388},{"_id":"public/libs/open-sans/fonts/59ZRklaO5bWGqF5A9baEERJtnKITppOI_IvcXXDNrsc.woff2","hash":"c4248ea800bd5608344ce163f5658b57e7ef9410","modified":1512634293388},{"_id":"public/libs/open-sans/fonts/K88pR3goAWT7BTt32Z01mxJtnKITppOI_IvcXXDNrsc.woff2","hash":"e0350190d720a8fec0557ab47b318ec4e4486448","modified":1512634293388},{"_id":"public/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSq-j2U0lmluP9RWlSytm3ho.woff2","hash":"4dc6d7174ea6d89f4c45e43e1bfc3e03d8ffebaf","modified":1512634293388},{"_id":"public/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSqaRobkAwv3vxw3jMhVENGA.woff2","hash":"415eee05976ab8b2471602a5ddb78a6c58fc21aa","modified":1512634293388},{"_id":"public/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSpX5f-9o1vgP2EXwfjgl7AY.woff2","hash":"328a22fe3eec71ad9e5ece4d67dd62e79dab6b7f","modified":1512634293388},{"_id":"public/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSv8zf_FOSsgRmwsS7Aa9k2w.woff2","hash":"c5f29fed6632efe0aa83318369f0d8c4061b775b","modified":1512634293388},{"_id":"public/libs/open-sans/fonts/cJZKeOuBrn4kERxqtaUH3VtXRa8TVwTICgirnJhmVJw.woff2","hash":"afc44700053c9a28f9ab26f6aec4862ac1d0795d","modified":1512634293388},{"_id":"public/libs/open-sans/fonts/MTP_ySUJH_bn48VBG8sNSugdm0LZdjqr5-oayXSOefg.woff2","hash":"a0b0c389cf46d63c850e61fed572485ff0b68183","modified":1512634293388},{"_id":"public/libs/open-sans/fonts/RjgO7rYTmqiVp7vzi-Q5URJtnKITppOI_IvcXXDNrsc.woff2","hash":"be201d32a9aa5d186723ebb3c538be691aa8c53a","modified":1512634293388},{"_id":"public/libs/open-sans/fonts/u-WUoqrET9fUeobQW7jkRRJtnKITppOI_IvcXXDNrsc.woff2","hash":"113978181dcac77baecef6115a9121d8f6e4fc3a","modified":1512634293388},{"_id":"public/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBjTOQ_MqJVwkKsUn0wKzc2I.woff2","hash":"b366f2fda2e524eb5ef50058eefff249a3b96e6c","modified":1512634293388},{"_id":"public/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBiYE0-AqJ3nfInTTiDXDjU4.woff2","hash":"5067c81462c15422853c94d21a1726865a61634f","modified":1512634293388},{"_id":"public/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBjUj_cnvWIuuBMVgbX098Mw.woff2","hash":"d22904914469be735490e3c8cb093c7862896dd5","modified":1512634293389},{"_id":"public/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBo4P5ICox8Kq3LLUNMylGO4.woff2","hash":"e75607ba1417181397c700775b84303d5a2957b9","modified":1512634293389},{"_id":"public/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBr6up8jxqWt8HVA3mDhkV_0.woff2","hash":"d0b40a7848703556c6631f24e961a98ca5829255","modified":1512634293389},{"_id":"public/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBkbcKLIaa1LC45dFaAfauRA.woff2","hash":"ae80fb3cd16339aa7b5da280ab53975523dcaac2","modified":1512634293389},{"_id":"public/libs/open-sans/fonts/xjAJXh38I15wypJXxuGMBmo_sUJ8uO4YLWRInS22T3Y.woff2","hash":"b85efde42fa3a03c32b1d31c6cd74c622fc7916c","modified":1512634293389},{"_id":"public/libs/open-sans/fonts/xozscpT2726on7jbcb_pAhJtnKITppOI_IvcXXDNrsc.woff2","hash":"be365eca44760ce3fc9b377c43d4634958479c69","modified":1512634293389},{"_id":"public/libs/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasDy2Q8seG17bfDXYR_jUsrzg.woff2","hash":"b0e0bb5ef78db8b15d430d0b9be9d4329289a310","modified":1512634293389},{"_id":"public/libs/source-code-pro/fonts/mrl8jkM18OlOQN8JLgasD9V_2ngZ8dMf8fLgjYEouxg.woff2","hash":"942addaec4d3a60af33947a84a3d85f926015947","modified":1512634293389},{"_id":"public/images/icon.png","hash":"342e89a86946e3178b4ff79b6cbb64b33d787814","modified":1512634295098},{"_id":"public/images/blogimages/2016/androidart_service1.png","hash":"30b35c17a3e468fcbbaab25990439bad304acfa1","modified":1512634295098},{"_id":"public/images/blogimages/2016/androidart_broadcastreceiver2.png","hash":"173269356b75bfe4213c28374a19e3a4938fd36b","modified":1512634295115},{"_id":"public/images/blogimages/2017/Initialize_for_purchase_data.png","hash":"2676a64fa51614baa48f40cede53b9a38d2680ec","modified":1512634295115},{"_id":"public/images/blogimages/2017/Initialize_for_purchase.png","hash":"c72e1a7b86d6ef66846d3bfcd92f7bbf30d1a324","modified":1512634295115},{"_id":"public/images/blogimages/2017/activity-start-process.png","hash":"7fbf542e56930c7eae863a729c9b127400b13a41","modified":1512634295115},{"_id":"public/images/blogimages/2017/Initialize_for_purchase_responce.png","hash":"a1d12d2d387552617b945c40158b53a63d3e1bd2","modified":1512634295115},{"_id":"public/images/blogimages/2017/android_build_process.png","hash":"14d311115864fa5a4606bb7cb8b592460ad46480","modified":1512634295115},{"_id":"public/images/blogimages/2017/ams_binder_process.png","hash":"5c9581165c33f271fa7e4d49e29b1b5ed4b90f3d","modified":1512634295115},{"_id":"public/images/blogimages/2017/binder-drive-principle.png","hash":"b6ef539c56f52e63b0b587916efbf363aebd7551","modified":1512634295115},{"_id":"public/images/blogimages/2017/binder-principle.png","hash":"e380ac2add90a07fbe5168f20e165f224d76d099","modified":1512634295116},{"_id":"public/images/blogimages/2017/hook-clipboard-process.png","hash":"320b490fd9d38bcc5bf1615d5d2bff20d766d51a","modified":1512634295116},{"_id":"public/images/blogimages/2017/listview_recyclebin.png","hash":"b90022a471f8339162107f2d57a744d1d0c9654c","modified":1512634295116},{"_id":"public/images/blogimages/2017/multi-Application-flow-chart.png","hash":"c319d32184bc3fdaf97faa83f6568723b29f193a","modified":1512634295116},{"_id":"public/images/blogimages/2017/process-ipc-structure.png","hash":"4488ffef5b4655dd72d1ad77c765b57ce1f83341","modified":1512634295116},{"_id":"public/images/blogimages/2017/servicemanager-add-service.png","hash":"338c7fb1a3208538ebbc1e9fd00b5387a2a688d0","modified":1512634295116},{"_id":"public/images/blogimages/2017/service-proxy-common.png","hash":"49eea6c0ea05522d586dffe8e29da9448708fa08","modified":1512634295116},{"_id":"public/images/blogimages/2017/servicemanager-init.png","hash":"e6acdb9b04ae085a6d6d0f45bc089447758a0082","modified":1512634295116},{"_id":"public/images/blogimages/2017/im_company_abroad/im_layer_email.png","hash":"1ba76d94651319eca5c6b701403c627c50c4e85b","modified":1512634295116},{"_id":"public/images/blogimages/2017/im_company_abroad/im_quickblox.png","hash":"d52b5c41e3771e0bba78fad79d26153da63b3d61","modified":1512634295116},{"_id":"public/images/blogimages/2017/im_company_abroad/im_snich.png","hash":"45a22cb7867faf9c223ffa52cad7f74171f79fe1","modified":1512634295117},{"_id":"public/libs/font-awesome/fonts/fontawesome-webfont.eot","hash":"965ce8f688fedbeed504efd498bc9c1622d12362","modified":1512634295117},{"_id":"public/libs/font-awesome/fonts/fontawesome-webfont.woff2","hash":"97e438cc545714309882fbceadbf344fcaddcec5","modified":1512634295117},{"_id":"public/libs/font-awesome/fonts/FontAwesome.otf","hash":"1b22f17fdc38070de50e6d1ab3a32da71aa2d819","modified":1512634295117},{"_id":"public/libs/font-awesome/fonts/fontawesome-webfont.woff","hash":"6d7e6a5fc802b13694d8820fc0138037c0977d2e","modified":1512634295117},{"_id":"public/js/insight.js","hash":"6ee84c42c2b230ff9e9bf605a444bd671d44f9e3","modified":1512634295138},{"_id":"public/js/particle.js","hash":"4ec4c6586584c7533e8e2f745b4cb6b9241f4179","modified":1512634295138},{"_id":"public/js/main.js","hash":"80cde22d84fad8be4d7dc77c0cdf8eb8f01f8903","modified":1512634295138},{"_id":"public/libs/justified-gallery/justifiedGallery.min.css","hash":"13fbcba5e97aa88b748d94d3efc4718475279907","modified":1512634295138},{"_id":"public/libs/source-code-pro/styles.css","hash":"93c308012738728f906cd4c5cfdb34189e0c712b","modified":1512634295138},{"_id":"public/libs/open-sans/styles.css","hash":"5ca6e111046232bde112d33201a60532aee7d3c4","modified":1512634295138},{"_id":"public/libs/lightgallery/css/lg-fb-comment-box.css","hash":"844ce27b8488968bccb3e50bb49184ba2aae0625","modified":1512634295138},{"_id":"public/libs/lightgallery/css/lg-fb-comment-box.min.css","hash":"05830fadb8454f39dcc98c8686eb4d5c24b71fc0","modified":1512634295138},{"_id":"public/libs/lightgallery/js/lg-fullscreen.js","hash":"65c47ac65362854ba44b00a010bb01e3630209d8","modified":1512634295139},{"_id":"public/libs/lightgallery/js/lg-autoplay.js","hash":"426bb78b93acfc39d533ea2bab1cec8dc289cf24","modified":1512634295139},{"_id":"public/libs/lightgallery/js/lg-fullscreen.min.js","hash":"b6b9e4022700b7faf2a5a175ba44a3bd938fdd20","modified":1512634295139},{"_id":"public/libs/lightgallery/js/lg-autoplay.min.js","hash":"d845741bcaf961579622880eb2a445257efad1ac","modified":1512634295139},{"_id":"public/libs/lightgallery/js/lg-hash.min.js","hash":"43f1e1e720ab0e241c19b83aa26bd6848eab8edc","modified":1512634295139},{"_id":"public/libs/lightgallery/js/lg-hash.js","hash":"15d16516c5642d3de1566ff8fc9160136ccaa405","modified":1512634295139},{"_id":"public/libs/lightgallery/js/lg-pager.min.js","hash":"25caa6ff65b1c6dee09941e795ae2633bdbab211","modified":1512634295139},{"_id":"public/libs/lightgallery/js/lg-pager.js","hash":"8092c692b244bb26343eb03b91bd97deb9dafc9c","modified":1512634295139},{"_id":"public/libs/lightgallery/js/lg-share.min.js","hash":"39c615f07c5d3aaa65a2c3068a30fdd6dd5c372d","modified":1512634295139},{"_id":"public/libs/lightgallery/js/lg-share.js","hash":"b7fb5f6474911060a351b0a6fe9dbb9ac3fb22aa","modified":1512634295139},{"_id":"public/libs/lightgallery/js/lg-thumbnail.min.js","hash":"18dd7d2909d1bfd6852f031d03e774b4428c512b","modified":1512634295139},{"_id":"public/libs/lightgallery/js/lg-zoom.min.js","hash":"15b49f9728439819ece15e4295cce254c87a4f45","modified":1512634295139},{"_id":"public/libs/lightgallery/js/lg-video.js","hash":"4f99b598f6bb18de9eca8c45c5b4373a03962367","modified":1512634295139},{"_id":"public/libs/lightgallery/js/lg-video.min.js","hash":"032c001ab045a69856f9c3ed4a2a3bf12a8e310f","modified":1512634295139},{"_id":"public/css/style.css","hash":"b73cb3186dea6cbdb7a47fd7f6fa73c717fddf1e","modified":1512634295139},{"_id":"public/css/bootstrap.min.css","hash":"94e5838701e98ced38fdc85bca1e3543a1870393","modified":1512634295139},{"_id":"public/libs/justified-gallery/jquery.justifiedGallery.min.js","hash":"b2683e7a872bc109b1756a65188a37cef7d0bd5c","modified":1512634295139},{"_id":"public/libs/font-awesome/css/font-awesome.min.css","hash":"7cd5a3384333f95c3d37d9488ad82cd6c4b03761","modified":1512634295139},{"_id":"public/libs/font-awesome/css/font-awesome.css","hash":"b5020c3860669185ba3f316fa7332cdf5c06f393","modified":1512634295139},{"_id":"public/libs/lightgallery/css/lightgallery.css","hash":"bef55316a32e512d5a8940e5d0bfe8bf7a9c5c61","modified":1512634295139},{"_id":"public/libs/lightgallery/css/lg-transitions.css","hash":"7871c28498d74451d6aa438c8d3a1817810a1e19","modified":1512634295139},{"_id":"public/libs/lightgallery/css/lg-transitions.min.css","hash":"5c22e2073a4c96d6212c72135391b599e8d1359f","modified":1512634295139},{"_id":"public/libs/lightgallery/css/lightgallery.min.css","hash":"c9a2e19c932b56f4a2ce30c98910d10b74edb38a","modified":1512634295139},{"_id":"public/libs/lightgallery/js/lg-thumbnail.js","hash":"3a6476b6df1d2bef4a21861a78776282a7a11ef1","modified":1512634295140},{"_id":"public/libs/lightgallery/js/lg-zoom.js","hash":"a758e2c8fcf710f9ff761da0eea0ab9321f3484d","modified":1512634295140},{"_id":"public/libs/lightgallery/js/lightgallery.js","hash":"3cd19b33ba99efd5ba1d167da91720566d274b2c","modified":1512634295140},{"_id":"public/libs/lightgallery/js/lightgallery.min.js","hash":"956ef9b706755318da69ad0b5d7786339d831251","modified":1512634295140},{"_id":"public/libs/jquery/2.1.3/jquery.min.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1512634295140},{"_id":"public/images/blogimages/2016/androidart_activity.png","hash":"9d8bda879c62adc0b71cd26262603850ca16ab05","modified":1512634295140},{"_id":"public/images/blogimages/2016/androidart_contentprovider.png","hash":"9dbe7f17e629d0f36218b5dd3c3941cd8aa320f0","modified":1512634295140},{"_id":"public/images/blogimages/2017/EIT-form.png","hash":"edb86938e964f0602d2fcaa5676dc67bcbce5b26","modified":1512634295140},{"_id":"public/images/blogimages/2017/IPC-data-format.png","hash":"6bda10ce15610da9102e67cbf763ecfb8a088e83","modified":1512634295140},{"_id":"public/images/blogimages/2017/android_lint.png","hash":"fdf172859ab1ce584d06c6a5ff040d85d578b3f5","modified":1512634295140},{"_id":"public/images/blogimages/2017/aosp_make_single_module.png","hash":"e18bcd65212b1f74330a4154671a40d2f3923f1b","modified":1512634295140},{"_id":"public/images/blogimages/2017/binder-EIT.png","hash":"1193bf7dbc3228cd60447548c412dce6644fff09","modified":1512634295140},{"_id":"public/images/blogimages/2017/binder-EIT-onTransact.png","hash":"3c10e03250b8f501385e44785ebd470a54bc63b5","modified":1512634295140},{"_id":"public/images/blogimages/2017/binder-example-media.png","hash":"ca53f947f638cc270027476b1476f1546c463855","modified":1512634295140},{"_id":"public/images/blogimages/2017/pin_verify.png","hash":"a18ac663b5ad7d78659a7998b3a56bc6fc05a0a7","modified":1512634295140},{"_id":"public/images/blogimages/cisco/Adobe_Connect_Online_Store.png","hash":"e915a2be8e8e3bf922f4256be6e3264b2a564e11","modified":1512634295141},{"_id":"public/images/blogimages/cisco/Cisco_WebEx_Meetings_Pricing.png","hash":"807bc9239bff4322f98c6f5610be7c7a168ac45d","modified":1512634295141},{"_id":"public/images/blogimages/cisco/VC5_5_1.png","hash":"c67ade2c767fea92ffedf66e04dd4cbe6683f3c6","modified":1512634295141},{"_id":"public/images/blogimages/2017/im_company_abroad/im_sendbird.png","hash":"541226b66fbf291d61d3d52c5c030b2f41ec8f94","modified":1512634295141},{"_id":"public/images/blogimages/2017/im_company_abroad/im_applozic.png","hash":"fc0a0a0145e92182e93048d2f48cfd0b2886af88","modified":1512634295141},{"_id":"public/libs/font-awesome/fonts/fontawesome-webfont.ttf","hash":"61d8d967807ef12598d81582fa95b9f600c3ee01","modified":1512634295141},{"_id":"public/images/blogimages/2016/androidart_service2.png","hash":"afdf0ded0d671ec79a03fddbd253de15eb5248ea","modified":1512634295170},{"_id":"public/images/blogimages/2016/androidart_ipc.png","hash":"3f3a0ead6d747386983ab5618f46a2f0c33bd84e","modified":1512634295170},{"_id":"public/images/blogimages/2017/communication-timing.png","hash":"d1eeb3d916b557902714e42604eb428e8820e1d8","modified":1512634295171},{"_id":"public/images/blogimages/2017/media-server-process.png","hash":"43c087cbbcde726dca7c9db58f46f7fb33153a55","modified":1512634295171},{"_id":"public/images/blogimages/2017/system-service-register-process.png","hash":"a0f5a638c157a8cad7be85e1e232d15ecb8ac5de","modified":1512634295171},{"_id":"public/images/blogimages/2017/binder-example-media-detail.png","hash":"1b250dc477539c98519b7f752f5816edf6cecf98","modified":1512634295202},{"_id":"public/images/blogimages/cisco/Cisco_Collaboration_Meeting_Rooms_Hybrid_-_Cisco.png","hash":"cb3f157655946b3b3609804e39a4596470d99f0d","modified":1512634295202},{"_id":"public/images/blogimages/cisco/Adobe_web_conferencing_software.png","hash":"adcf5f49b46dce8457f5b32acad726995c750b2e","modified":1512634295202},{"_id":"public/images/blogimages/2017/aosp_monitor_position.png","hash":"ac98da872053c9a6e5637304b33077727c7f29f2","modified":1512634295242},{"_id":"public/images/blogimages/cisco/Cisco_Collaboration_Meeting_Rooms_Premises_-_Cisco.png","hash":"3d2108f0c5cb9020d58e19fe77c47e594e07eb82","modified":1512634295243},{"_id":"public/images/blogimages/cisco/zoom_cloud_hybrid.png","hash":"006d3089661e40e800bd8b24f960412a81875181","modified":1512634295245},{"_id":"public/images/blogimages/cisco/VC5_5_3.png","hash":"25f7bbc61cec17c1c0b701f82fd18c0a9c070b89","modified":1512634295246},{"_id":"public/libs/font-awesome/fonts/fontawesome-webfont.svg","hash":"c0522272bbaef2acb3d341912754d6ea2d0ecfc0","modified":1512634295246},{"_id":"public/images/blogimages/2017/binder-summary.png","hash":"0cc9038284ccce38e566e75459aa512fa2eccb75","modified":1512634295331},{"_id":"public/images/blogimages/2017/service-manager-activity.png","hash":"1e98a4ac00ef83968c28d1df7c84b0fa9fbdd100","modified":1512634295331},{"_id":"public/images/blogimages/cisco/Collaboration_Products_and_Solutions.png","hash":"85a88cd7196fd068952dfbe1eba2e7743b4b3fd8","modified":1512634295332},{"_id":"public/images/blogimages/cisco/VC5_5_4.png","hash":"9ce30296a85f313e2eecd16f876a48003c3fbb41","modified":1512634295410},{"_id":"public/images/blogimages/cisco/cmr_introduction.png","hash":"53bc162a868da6dc1f432caf5f58c302acd5693d","modified":1512634295410},{"_id":"public/images/blogimages/cisco/Adobe-Connect-Store.png","hash":"903d8df197da17ff185d835d7f5c61f1a021bad1","modified":1512634295418},{"_id":"public/images/blogimages/cisco/mx-700.png","hash":"8a6d2096c6e1c559558bfb65b7f27bfdcd293f88","modified":1512634295446},{"_id":"public/images/blogimages/cisco/Web_Conferencing__Video_Conferencing_Fuze.png","hash":"9d9e57804f57786b62aae008af1978d98a362bae","modified":1512634295449},{"_id":"public/images/blogimages/2017/im_company_abroad/im_comparation.png","hash":"7251d4e152770b0ce93f9000e44a71d5b5ccf9e5","modified":1512634295452}],"Category":[{"name":"accumulation","_id":"cjaw7ebvd0006d6yklfnfvm1k"},{"name":"read","_id":"cjaw7ebwd000gd6yktaurin3d"},{"name":"technology","_id":"cjaw7ebxh0011d6ykvpmfiasa"},{"name":"Investigation","_id":"cjaw7ec03002nd6ykv1w4bk0x"}],"Data":[],"Page":[{"title":"","layout":"about","_content":"","source":"about/index.md","raw":"title: \"\"\nlayout: \"about\"\n---\n","date":"2017-03-13T07:25:42.000Z","updated":"2017-03-13T07:25:42.000Z","path":"about/index.html","comments":1,"_id":"cjaw7ebuu0001d6ykyytt8pxu","content":"<hr>\n<p><a href=\"http://agehua.github.io/about/index.html\">http://agehua.github.io/about/index.html</a></p>\n","readingTime":{"text":"1 min read","minutes":0.01,"time":600,"words":2},"excerpt":"","more":"<hr>\n<p><a href=\"http://agehua.github.io/about/index.html\">http://agehua.github.io/about/index.html</a></p>\n"},{"title":"Categories","layout":"categories","_content":"","source":"categories/index.md","raw":"title: \"Categories\"\nlayout: \"categories\"\n---\n","date":"2016-12-26T10:41:15.000Z","updated":"2016-12-26T10:41:15.000Z","path":"categories/index.html","comments":1,"_id":"cjaw7ebv20003d6yk6hyxsy7m","content":"<hr>\n<p><a href=\"http://agehua.github.io/categories/index.html\">http://agehua.github.io/categories/index.html</a></p>\n","readingTime":{"text":"1 min read","minutes":0.01,"time":600,"words":2},"excerpt":"","more":"<hr>\n<p><a href=\"http://agehua.github.io/categories/index.html\">http://agehua.github.io/categories/index.html</a></p>\n"},{"title":"Tags","layout":"tags","_content":"","source":"tags/index.md","raw":"title: \"Tags\"\nlayout: \"tags\"\n---\n","date":"2017-07-18T07:35:27.000Z","updated":"2017-07-18T07:35:27.000Z","path":"tags/index.html","comments":1,"_id":"cjaw7ebv80005d6yk9atoyens","content":"<hr>\n<p><a href=\"http://agehua.github.io/tags/index.html\">http://agehua.github.io/tags/index.html</a></p>\n","readingTime":{"text":"1 min read","minutes":0.01,"time":600,"words":2},"excerpt":"","more":"<hr>\n<p><a href=\"http://agehua.github.io/tags/index.html\">http://agehua.github.io/tags/index.html</a></p>\n"}],"Post":[{"layout":"post","title":"Hello World","_content":"Welcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\n<!--more-->\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/deployment.html)\n","source":"_posts/2014-12-23-hello-world.md","raw":"---\nlayout: post\ntitle: Hello World\n---\nWelcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\n<!--more-->\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/deployment.html)\n","slug":"hello-world","published":1,"date":"2014-12-22T16:00:00.000Z","updated":"2017-11-20T08:36:25.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ebum0000d6ykpeyqwj9f","content":"<p>Welcome to <a href=\"https://hexo.io/\" target=\"_blank\" rel=\"external\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\" target=\"_blank\" rel=\"external\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\" target=\"_blank\" rel=\"external\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\" target=\"_blank\" rel=\"external\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><div class=\"line\">$ hexo new <span class=\"string\">\"My New Post\"</span></div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\" target=\"_blank\" rel=\"external\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><div class=\"line\">$ hexo server</div></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n<p>More info: <a href=\"https://hexo.io/docs/server.html\" target=\"_blank\" rel=\"external\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><div class=\"line\">$ hexo generate</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\" target=\"_blank\" rel=\"external\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><div class=\"line\">$ hexo deploy</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/deployment.html\" target=\"_blank\" rel=\"external\">Deployment</a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2014/12/23/hello-world/\">http://agehua.github.io/2014/12/23/hello-world/</a></p>\n","readingTime":{"text":"1 min read","minutes":0.59,"time":35400,"words":118},"excerpt":"<p>Welcome to <a href=\"https://hexo.io/\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><div class=\"line\">$ hexo new <span class=\"string\">\"My New Post\"</span></div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><div class=\"line\">$ hexo server</div></pre></td></tr></table></figure>","more":"<p>More info: <a href=\"https://hexo.io/docs/server.html\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><div class=\"line\">$ hexo generate</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><div class=\"line\">$ hexo deploy</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/deployment.html\">Deployment</a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2014/12/23/hello-world/\">http://agehua.github.io/2014/12/23/hello-world/</a></p>"},{"layout":"post","title":"Android","keywords":"Android","description":"Android","banner":"http://obxk8w81b.bkt.clouddn.com/At%20the%20Foot%20of%20the%20Mountains.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/At%20the%20Foot%20of%20the%20Mountains.jpg","_content":"\nAndroid[Android](http://android.eoe.cn/)[tisa007](http://my.eoe.cn/123581)\n[](http://www.eoeandroid.com/thread-272453-1-1.html)\n\n### \n- [Apollo](https://github.com/Splitter/android_packages_apps_apolloMod)\n- [oschina](https://github.com/oschina/android-app)oschinawpiOS\n- [xabberxmpp](https://github.com/redsolution/xabber-android)\n- [](https://github.com/qii/weiciyuan)\n- [Google IO](https://code.google.com/p/iosched/)\n- [eoe](https://github.com/eoecn/android-app/)eoeAndroid\n\n\n<!--more-->\n\n### \n- [Android-Flip](https://github.com/openaphid/android-flip)FlipBoard\n- [Drag-Sort-Listview](https://github.com/bauerca/drag-sort-listview)itemlistview\n- [HoloEveryWhere](https://github.com/Prototik/HoloEverywhere)Androidholohappy\n- [Universal-ImageLoader](https://github.com/tisa007/Android-Universal-Image-Loader)\n- [JazzyViewPager](https://github.com/jfeinstein10/JazzyViewPager)ViewPager~~\n- [SlidingMenu](https://github.com/jfeinstein10/SlidingMenu)facebook\n- [StickyListHeaders](https://github.com/emilsjolander/StickyListHeaders)iPhonelistview\n- [Android-PullToRefresh](https://github.com/chrisbanes/Android-PullToRefresh)\n- [StaggeredGridView](https://github.com/maurycyw/StaggeredGridView)\n- [android-async-http](https://github.com/loopj/android-async-http)androidasynctask\n- [ActionBarSherlock](https://github.com/JakeWharton/ActionBarSherlock?source=cr)ActionBar2.x\n- [facebook-android-sdk](https://github.com/facebook/facebook-android-sdk/)SDKSDK\n- [NineOldAndroids](https://github.com/JakeWharton/NineOldAndroids)2.xSDKAndroid 3.0API~\n- [android-swipelistview](https://github.com/47deg/android-swipelistview)listviewitemGmailPocket~\n- [DataDroid](https://github.com/foxykeep/DataDroid)AndroidRESTfulRESTful\n- [EventBus](https://github.com/greenrobot/EventBus)DataDroidlib\n- [android-switch-backport](https://github.com/BoD/android-switch-backport)Android3.0switch2.x\n- [PagerSlidingTabStrip](https://github.com/astuetz/PagerSlidingTabStrip)GooglePlaytab\n- [chromeview](https://github.com/pwnall/chromeview)webviewAndroidchromechromechromeview\n- [picasso](https://github.com/square/picasso)squareAPI~\n\n### \n\n- [github](https://github.com/)\n- [oschina](http://www.oschina.net/)\n- [eoeandroid](http://www.eoe.cn/code/android.html)\n- [AndroidViews](http://www.androidviews.net/)\n- vogella:~\n\ngithub\njava [](https://github.com/languages/Java/most_watched)\nAndroidstar [](https://github.com/search?q=android&type=Repositories&s=stars) \nfork\n","source":"_posts/2015-01-27-android-open-sources.md","raw":"---\nlayout: post\ntitle: Android\ncategory: accumulation\ntags:\n  - ANDROID\n  - Open souces\nkeywords: Android\ndescription: Android\nbanner: http://obxk8w81b.bkt.clouddn.com/At%20the%20Foot%20of%20the%20Mountains.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/At%20the%20Foot%20of%20the%20Mountains.jpg\n---\n\nAndroid[Android](http://android.eoe.cn/)[tisa007](http://my.eoe.cn/123581)\n[](http://www.eoeandroid.com/thread-272453-1-1.html)\n\n### \n- [Apollo](https://github.com/Splitter/android_packages_apps_apolloMod)\n- [oschina](https://github.com/oschina/android-app)oschinawpiOS\n- [xabberxmpp](https://github.com/redsolution/xabber-android)\n- [](https://github.com/qii/weiciyuan)\n- [Google IO](https://code.google.com/p/iosched/)\n- [eoe](https://github.com/eoecn/android-app/)eoeAndroid\n\n\n<!--more-->\n\n### \n- [Android-Flip](https://github.com/openaphid/android-flip)FlipBoard\n- [Drag-Sort-Listview](https://github.com/bauerca/drag-sort-listview)itemlistview\n- [HoloEveryWhere](https://github.com/Prototik/HoloEverywhere)Androidholohappy\n- [Universal-ImageLoader](https://github.com/tisa007/Android-Universal-Image-Loader)\n- [JazzyViewPager](https://github.com/jfeinstein10/JazzyViewPager)ViewPager~~\n- [SlidingMenu](https://github.com/jfeinstein10/SlidingMenu)facebook\n- [StickyListHeaders](https://github.com/emilsjolander/StickyListHeaders)iPhonelistview\n- [Android-PullToRefresh](https://github.com/chrisbanes/Android-PullToRefresh)\n- [StaggeredGridView](https://github.com/maurycyw/StaggeredGridView)\n- [android-async-http](https://github.com/loopj/android-async-http)androidasynctask\n- [ActionBarSherlock](https://github.com/JakeWharton/ActionBarSherlock?source=cr)ActionBar2.x\n- [facebook-android-sdk](https://github.com/facebook/facebook-android-sdk/)SDKSDK\n- [NineOldAndroids](https://github.com/JakeWharton/NineOldAndroids)2.xSDKAndroid 3.0API~\n- [android-swipelistview](https://github.com/47deg/android-swipelistview)listviewitemGmailPocket~\n- [DataDroid](https://github.com/foxykeep/DataDroid)AndroidRESTfulRESTful\n- [EventBus](https://github.com/greenrobot/EventBus)DataDroidlib\n- [android-switch-backport](https://github.com/BoD/android-switch-backport)Android3.0switch2.x\n- [PagerSlidingTabStrip](https://github.com/astuetz/PagerSlidingTabStrip)GooglePlaytab\n- [chromeview](https://github.com/pwnall/chromeview)webviewAndroidchromechromechromeview\n- [picasso](https://github.com/square/picasso)squareAPI~\n\n### \n\n- [github](https://github.com/)\n- [oschina](http://www.oschina.net/)\n- [eoeandroid](http://www.eoe.cn/code/android.html)\n- [AndroidViews](http://www.androidviews.net/)\n- vogella:~\n\ngithub\njava [](https://github.com/languages/Java/most_watched)\nAndroidstar [](https://github.com/search?q=android&type=Repositories&s=stars) \nfork\n","slug":"android-open-sources","published":1,"date":"2015-01-26T16:00:00.000Z","updated":"2017-11-23T07:23:45.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ebuy0002d6yk1k3u5h9m","content":"<p>Android<a href=\"http://android.eoe.cn/\" target=\"_blank\" rel=\"external\">Android</a><a href=\"http://my.eoe.cn/123581\" target=\"_blank\" rel=\"external\">tisa007</a><br><a href=\"http://www.eoeandroid.com/thread-272453-1-1.html\" target=\"_blank\" rel=\"external\"></a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><a href=\"https://github.com/Splitter/android_packages_apps_apolloMod\" target=\"_blank\" rel=\"external\">Apollo</a></li>\n<li><a href=\"https://github.com/oschina/android-app\" target=\"_blank\" rel=\"external\">oschina</a>oschinawpiOS</li>\n<li><a href=\"https://github.com/redsolution/xabber-android\" target=\"_blank\" rel=\"external\">xabberxmpp</a></li>\n<li><a href=\"https://github.com/qii/weiciyuan\" target=\"_blank\" rel=\"external\"></a></li>\n<li><a href=\"https://code.google.com/p/iosched/\" target=\"_blank\" rel=\"external\">Google IO</a></li>\n<li><a href=\"https://github.com/eoecn/android-app/\" target=\"_blank\" rel=\"external\">eoe</a>eoeAndroid</li>\n</ul>\n<a id=\"more\"></a>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><a href=\"https://github.com/openaphid/android-flip\" target=\"_blank\" rel=\"external\">Android-Flip</a>FlipBoard</li>\n<li><a href=\"https://github.com/bauerca/drag-sort-listview\" target=\"_blank\" rel=\"external\">Drag-Sort-Listview</a>itemlistview</li>\n<li><a href=\"https://github.com/Prototik/HoloEverywhere\" target=\"_blank\" rel=\"external\">HoloEveryWhere</a>Androidholohappy</li>\n<li><a href=\"https://github.com/tisa007/Android-Universal-Image-Loader\" target=\"_blank\" rel=\"external\">Universal-ImageLoader</a></li>\n<li><a href=\"https://github.com/jfeinstein10/JazzyViewPager\" target=\"_blank\" rel=\"external\">JazzyViewPager</a>ViewPager~~</li>\n<li><a href=\"https://github.com/jfeinstein10/SlidingMenu\" target=\"_blank\" rel=\"external\">SlidingMenu</a>facebook</li>\n<li><a href=\"https://github.com/emilsjolander/StickyListHeaders\" target=\"_blank\" rel=\"external\">StickyListHeaders</a>iPhonelistview</li>\n<li><a href=\"https://github.com/chrisbanes/Android-PullToRefresh\" target=\"_blank\" rel=\"external\">Android-PullToRefresh</a></li>\n<li><a href=\"https://github.com/maurycyw/StaggeredGridView\" target=\"_blank\" rel=\"external\">StaggeredGridView</a></li>\n<li><a href=\"https://github.com/loopj/android-async-http\" target=\"_blank\" rel=\"external\">android-async-http</a>androidasynctask</li>\n<li><a href=\"https://github.com/JakeWharton/ActionBarSherlock?source=cr\" target=\"_blank\" rel=\"external\">ActionBarSherlock</a>ActionBar2.x</li>\n<li><a href=\"https://github.com/facebook/facebook-android-sdk/\" target=\"_blank\" rel=\"external\">facebook-android-sdk</a>SDKSDK</li>\n<li><a href=\"https://github.com/JakeWharton/NineOldAndroids\" target=\"_blank\" rel=\"external\">NineOldAndroids</a>2.xSDKAndroid 3.0API~</li>\n<li><a href=\"https://github.com/47deg/android-swipelistview\" target=\"_blank\" rel=\"external\">android-swipelistview</a>listviewitemGmailPocket~</li>\n<li><a href=\"https://github.com/foxykeep/DataDroid\" target=\"_blank\" rel=\"external\">DataDroid</a>AndroidRESTfulRESTful</li>\n<li><a href=\"https://github.com/greenrobot/EventBus\" target=\"_blank\" rel=\"external\">EventBus</a>DataDroidlib</li>\n<li><a href=\"https://github.com/BoD/android-switch-backport\" target=\"_blank\" rel=\"external\">android-switch-backport</a>Android3.0switch2.x</li>\n<li><a href=\"https://github.com/astuetz/PagerSlidingTabStrip\" target=\"_blank\" rel=\"external\">PagerSlidingTabStrip</a>GooglePlaytab</li>\n<li><a href=\"https://github.com/pwnall/chromeview\" target=\"_blank\" rel=\"external\">chromeview</a>webviewAndroidchromechromechromeview</li>\n<li><a href=\"https://github.com/square/picasso\" target=\"_blank\" rel=\"external\">picasso</a>squareAPI~</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><a href=\"https://github.com/\" target=\"_blank\" rel=\"external\">github</a></li>\n<li><a href=\"http://www.oschina.net/\" target=\"_blank\" rel=\"external\">oschina</a></li>\n<li><a href=\"http://www.eoe.cn/code/android.html\" target=\"_blank\" rel=\"external\">eoeandroid</a></li>\n<li><a href=\"http://www.androidviews.net/\" target=\"_blank\" rel=\"external\">AndroidViews</a></li>\n<li>vogella:~</li>\n</ul>\n<p>github<br>java <a href=\"https://github.com/languages/Java/most_watched\" target=\"_blank\" rel=\"external\"></a><br>Androidstar <a href=\"https://github.com/search?q=android&amp;type=Repositories&amp;s=stars\" target=\"_blank\" rel=\"external\"></a> <br>fork</p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2015/01/27/android-open-sources/\">http://agehua.github.io/2015/01/27/android-open-sources/</a></p>\n","readingTime":{"text":"1 min read","minutes":0.485,"time":29099.999999999996,"words":97},"excerpt":"<p>Android<a href=\"http://android.eoe.cn/\">Android</a><a href=\"http://my.eoe.cn/123581\">tisa007</a><br><a href=\"http://www.eoeandroid.com/thread-272453-1-1.html\"></a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><a href=\"https://github.com/Splitter/android_packages_apps_apolloMod\">Apollo</a></li>\n<li><a href=\"https://github.com/oschina/android-app\">oschina</a>oschinawpiOS</li>\n<li><a href=\"https://github.com/redsolution/xabber-android\">xabberxmpp</a></li>\n<li><a href=\"https://github.com/qii/weiciyuan\"></a></li>\n<li><a href=\"https://code.google.com/p/iosched/\">Google IO</a></li>\n<li><a href=\"https://github.com/eoecn/android-app/\">eoe</a>eoeAndroid</li>\n</ul>","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><a href=\"https://github.com/openaphid/android-flip\">Android-Flip</a>FlipBoard</li>\n<li><a href=\"https://github.com/bauerca/drag-sort-listview\">Drag-Sort-Listview</a>itemlistview</li>\n<li><a href=\"https://github.com/Prototik/HoloEverywhere\">HoloEveryWhere</a>Androidholohappy</li>\n<li><a href=\"https://github.com/tisa007/Android-Universal-Image-Loader\">Universal-ImageLoader</a></li>\n<li><a href=\"https://github.com/jfeinstein10/JazzyViewPager\">JazzyViewPager</a>ViewPager~~</li>\n<li><a href=\"https://github.com/jfeinstein10/SlidingMenu\">SlidingMenu</a>facebook</li>\n<li><a href=\"https://github.com/emilsjolander/StickyListHeaders\">StickyListHeaders</a>iPhonelistview</li>\n<li><a href=\"https://github.com/chrisbanes/Android-PullToRefresh\">Android-PullToRefresh</a></li>\n<li><a href=\"https://github.com/maurycyw/StaggeredGridView\">StaggeredGridView</a></li>\n<li><a href=\"https://github.com/loopj/android-async-http\">android-async-http</a>androidasynctask</li>\n<li><a href=\"https://github.com/JakeWharton/ActionBarSherlock?source=cr\">ActionBarSherlock</a>ActionBar2.x</li>\n<li><a href=\"https://github.com/facebook/facebook-android-sdk/\">facebook-android-sdk</a>SDKSDK</li>\n<li><a href=\"https://github.com/JakeWharton/NineOldAndroids\">NineOldAndroids</a>2.xSDKAndroid 3.0API~</li>\n<li><a href=\"https://github.com/47deg/android-swipelistview\">android-swipelistview</a>listviewitemGmailPocket~</li>\n<li><a href=\"https://github.com/foxykeep/DataDroid\">DataDroid</a>AndroidRESTfulRESTful</li>\n<li><a href=\"https://github.com/greenrobot/EventBus\">EventBus</a>DataDroidlib</li>\n<li><a href=\"https://github.com/BoD/android-switch-backport\">android-switch-backport</a>Android3.0switch2.x</li>\n<li><a href=\"https://github.com/astuetz/PagerSlidingTabStrip\">PagerSlidingTabStrip</a>GooglePlaytab</li>\n<li><a href=\"https://github.com/pwnall/chromeview\">chromeview</a>webviewAndroidchromechromechromeview</li>\n<li><a href=\"https://github.com/square/picasso\">picasso</a>squareAPI~</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><a href=\"https://github.com/\">github</a></li>\n<li><a href=\"http://www.oschina.net/\">oschina</a></li>\n<li><a href=\"http://www.eoe.cn/code/android.html\">eoeandroid</a></li>\n<li><a href=\"http://www.androidviews.net/\">AndroidViews</a></li>\n<li>vogella:~</li>\n</ul>\n<p>github<br>java <a href=\"https://github.com/languages/Java/most_watched\"></a><br>Androidstar <a href=\"https://github.com/search?q=android&amp;type=Repositories&amp;s=stars\"></a> <br>fork</p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2015/01/27/android-open-sources/\">http://agehua.github.io/2015/01/27/android-open-sources/</a></p>"},{"layout":"post","title":"java","keywords":"java, , ","description":null,"banner":"http://obxk8w81b.bkt.clouddn.com/Daubigny%20s%20Garden%203.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Daubigny%20s%20Garden%203.jpg","_content":"\n**java**[](http://www.kuqin.com/shuoit/20140708/341091.html)\n\n------\n\n\n\nJavaJava\n\n<!--more-->\n\n# Java\n\n### 1. \nCPU\n\n,\n\n### 2. \n(self contained)\n\n- ,,\n- \n- \n- \n- \n\n> \nfrom [JacobK](https://www.zhihu.com/question/21535820/answer/19120563)\n\n\n### 3. \n- \n- ,\n\nCPU(heap memory)ServletsCGIServletsCGI\n\n### 4. \nJavaJVMJVM****emailJVM\n\n### 5. \nRunnableThreadThreadThread[Read more...](http://www.journaldev.com/1016/java-thread-example-extending-thread-class-and-implementing-runnable-interface)\n\n### 6. \nJavaNewstart()RunnableRunnableCPURunningWaitingBlockedDead[Read more...](http://www.journaldev.com/1044/life-cycle-of-thread-understanding-thread-states-in-java)\n\n- **new Thread**Thread`Thread  t1=new Thread()`;\n- **runnable**CPUCPU`t1.start()`;\n- **running**CPUrun()CPU\n- **dead**\n- ****run()\n- ****stop()\n- **blocked**CPU\n- ****sleep(long t) \n- ****wait()motify()\n- ****suspend()resume()\n\n### 7. Threadrun()\nThreadrun()Threadstart()\n\n### 8. \nThreadSleep()Runnable\n\n### 9. \nCPU**CPU**32031 ****OS****Class SetThreadPriority\n\n### 10. (Thread Scheduler)(Time Slicing)\nRunnableCPUCPURunnableCPUJava\n\n### 11. (context-switching)\nCPU\n\n### 12. main()Java\nThreadjoint()main()[Read more...](http://www.journaldev.com/1024/java-thread-join-example-with-explanation)\n> join()join()join()join()sleepjoin()join()\n\n### 13.\n\n\na. violate\n\nb. WindowsUIsendMessage,postMessage\n\n```\n1)#define WM_THREAD_SENDMSG=WM_USER+20;  \n2)afx_msg int OnTSendmsg();\n3)ON_MESSAGE(WM_THREAD_SENDMSG,OnTSM)\n4)OnTSM()\n5)PostMessagePost\n```\n\nc. CEventEvent\n\n```\n1)CEventCEvent threadStart;\n2)threadStart.SetEvent();\n3)WaitForSingleObject()CEvent\n```\n\nObjectwait()notify()notifyAll()[Read more](http://www.journaldev.com/1037/java-thread-wait-notify-and-notifyall-example)\n\n### 14. \n()/windowsLinux\n\n****\n\n**FIFO**[^14] [Read Read Read...](http://blog.csdn.net/chenhuajie123/article/details/9315477)\n\n\n### 15. wait(), notify()notifyAll()Object\nJava(monitor) wait()notify()JavaObjectJava\n\n### 16. wait(), notify()notifyAll()\nwait()notify()notify()\n\n### 17. Threadsleep()yield()\nThreadsleep()yield()\n\n### 18. \nJava(atomic concurrent classes)volatile[Read more](http://www.journaldev.com/1061/java-synchronization-and-thread-safety-tutorial-with-examples)\n\n### 19. volatileJava\nvolatile\n\n### 20. \n\n\n### 21. \nThreadsetDaemon(true)start()IllegalThreadStateException\n\n### 22. ThreadLocal?\nThreadLocalThreadLocal\n\nThreadget()set()ThreadLocalprivate static[Read more](http://www.journaldev.com/1076/java-threadlocal-example-to-create-thread-local-variables)\n\n### 23. (Deadlock)\n\n- **Mutual exclusion**\n- **Hold and wait**\n- **No preemption**\n- **Circular wait**\n\n[](http://blog.csdn.net/joejames/article/details/37960873)\n\n### 24. Java\n\n\njava.util.concurrent.Executorsjava.util.concurrent.Executor[](http://www.journaldev.com/1069/java-thread-pool-example-using-executors-and-threadpoolexecutor)\n\n# Java\n\n### 1. Java Concurrency API(atomic classes)\n\n\nint++1\n\nJDK1.5JDK1.5java.util.concurrent.atomicintlong[Read more](http://www.journaldev.com/1069/java-thread-pool-example-using-executors-and-threadpoolexecutor)\n\n### 2. Java Concurrency APILock(Lock interface)\nLock\n- \n- \n- \n- \n\n### 3. Executors\nExecutorjava.util.concurrent.Executor Java5Executor\n\nExecutors[Read more](http://www.journaldev.com/1069/java-thread-pool-example-using-executors-and-threadpoolexecutor)\n\n### 4. -\njava.util.concurrent.BlockingQueue\n\nNullPointerException\n\n\n\nBlockingQueuejava collections-[-](http://www.journaldev.com/1034/java-blockingqueue-example-implementing-producer-consumer-problem)\n\n### 5. \nJavanext()ConcurrentModificationException\n\n\n\nConcurrentHashMap, CopyOnWriteArrayList CopyOnWriteArraySet\n\n### 6. Executors\nExecutorsExecutorExecutorServiceScheduledExecutorServiceThreadFactoryCallable\n\nExecutors\n\n# \n\n### [](http://blog.csdn.net/column/details/killthreadseries.html)\n\n### [](http://blog.csdn.net/chenhuajie123/article/details/9315477)\n\n-----\n\n[^1-3]: [](http://blog.chinaunix.net/uid-21411227-id-1826748.html)\n[^14]: [](http://blog.csdn.net/chenhuajie123/article/details/9315477)\n","source":"_posts/2015-03-16-java-multithreading-concurrent.md","raw":"---\nlayout: post\ntitle: java\ncategory: accumulation\ntags:\n  - Java\n  - multi-thread\n  - Interview Knowledge\nkeywords: java, , \ndescription:\nbanner: http://obxk8w81b.bkt.clouddn.com/Daubigny%20s%20Garden%203.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Daubigny%20s%20Garden%203.jpg\n---\n\n**java**[](http://www.kuqin.com/shuoit/20140708/341091.html)\n\n------\n\n\n\nJavaJava\n\n<!--more-->\n\n# Java\n\n### 1. \nCPU\n\n,\n\n### 2. \n(self contained)\n\n- ,,\n- \n- \n- \n- \n\n> \nfrom [JacobK](https://www.zhihu.com/question/21535820/answer/19120563)\n\n\n### 3. \n- \n- ,\n\nCPU(heap memory)ServletsCGIServletsCGI\n\n### 4. \nJavaJVMJVM****emailJVM\n\n### 5. \nRunnableThreadThreadThread[Read more...](http://www.journaldev.com/1016/java-thread-example-extending-thread-class-and-implementing-runnable-interface)\n\n### 6. \nJavaNewstart()RunnableRunnableCPURunningWaitingBlockedDead[Read more...](http://www.journaldev.com/1044/life-cycle-of-thread-understanding-thread-states-in-java)\n\n- **new Thread**Thread`Thread  t1=new Thread()`;\n- **runnable**CPUCPU`t1.start()`;\n- **running**CPUrun()CPU\n- **dead**\n- ****run()\n- ****stop()\n- **blocked**CPU\n- ****sleep(long t) \n- ****wait()motify()\n- ****suspend()resume()\n\n### 7. Threadrun()\nThreadrun()Threadstart()\n\n### 8. \nThreadSleep()Runnable\n\n### 9. \nCPU**CPU**32031 ****OS****Class SetThreadPriority\n\n### 10. (Thread Scheduler)(Time Slicing)\nRunnableCPUCPURunnableCPUJava\n\n### 11. (context-switching)\nCPU\n\n### 12. main()Java\nThreadjoint()main()[Read more...](http://www.journaldev.com/1024/java-thread-join-example-with-explanation)\n> join()join()join()join()sleepjoin()join()\n\n### 13.\n\n\na. violate\n\nb. WindowsUIsendMessage,postMessage\n\n```\n1)#define WM_THREAD_SENDMSG=WM_USER+20;  \n2)afx_msg int OnTSendmsg();\n3)ON_MESSAGE(WM_THREAD_SENDMSG,OnTSM)\n4)OnTSM()\n5)PostMessagePost\n```\n\nc. CEventEvent\n\n```\n1)CEventCEvent threadStart;\n2)threadStart.SetEvent();\n3)WaitForSingleObject()CEvent\n```\n\nObjectwait()notify()notifyAll()[Read more](http://www.journaldev.com/1037/java-thread-wait-notify-and-notifyall-example)\n\n### 14. \n()/windowsLinux\n\n****\n\n**FIFO**[^14] [Read Read Read...](http://blog.csdn.net/chenhuajie123/article/details/9315477)\n\n\n### 15. wait(), notify()notifyAll()Object\nJava(monitor) wait()notify()JavaObjectJava\n\n### 16. wait(), notify()notifyAll()\nwait()notify()notify()\n\n### 17. Threadsleep()yield()\nThreadsleep()yield()\n\n### 18. \nJava(atomic concurrent classes)volatile[Read more](http://www.journaldev.com/1061/java-synchronization-and-thread-safety-tutorial-with-examples)\n\n### 19. volatileJava\nvolatile\n\n### 20. \n\n\n### 21. \nThreadsetDaemon(true)start()IllegalThreadStateException\n\n### 22. ThreadLocal?\nThreadLocalThreadLocal\n\nThreadget()set()ThreadLocalprivate static[Read more](http://www.journaldev.com/1076/java-threadlocal-example-to-create-thread-local-variables)\n\n### 23. (Deadlock)\n\n- **Mutual exclusion**\n- **Hold and wait**\n- **No preemption**\n- **Circular wait**\n\n[](http://blog.csdn.net/joejames/article/details/37960873)\n\n### 24. Java\n\n\njava.util.concurrent.Executorsjava.util.concurrent.Executor[](http://www.journaldev.com/1069/java-thread-pool-example-using-executors-and-threadpoolexecutor)\n\n# Java\n\n### 1. Java Concurrency API(atomic classes)\n\n\nint++1\n\nJDK1.5JDK1.5java.util.concurrent.atomicintlong[Read more](http://www.journaldev.com/1069/java-thread-pool-example-using-executors-and-threadpoolexecutor)\n\n### 2. Java Concurrency APILock(Lock interface)\nLock\n- \n- \n- \n- \n\n### 3. Executors\nExecutorjava.util.concurrent.Executor Java5Executor\n\nExecutors[Read more](http://www.journaldev.com/1069/java-thread-pool-example-using-executors-and-threadpoolexecutor)\n\n### 4. -\njava.util.concurrent.BlockingQueue\n\nNullPointerException\n\n\n\nBlockingQueuejava collections-[-](http://www.journaldev.com/1034/java-blockingqueue-example-implementing-producer-consumer-problem)\n\n### 5. \nJavanext()ConcurrentModificationException\n\n\n\nConcurrentHashMap, CopyOnWriteArrayList CopyOnWriteArraySet\n\n### 6. Executors\nExecutorsExecutorExecutorServiceScheduledExecutorServiceThreadFactoryCallable\n\nExecutors\n\n# \n\n### [](http://blog.csdn.net/column/details/killthreadseries.html)\n\n### [](http://blog.csdn.net/chenhuajie123/article/details/9315477)\n\n-----\n\n[^1-3]: [](http://blog.chinaunix.net/uid-21411227-id-1826748.html)\n[^14]: [](http://blog.csdn.net/chenhuajie123/article/details/9315477)\n","slug":"java-multithreading-concurrent","published":1,"date":"2015-03-15T16:00:00.000Z","updated":"2017-11-23T06:58:42.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ebv50004d6ykpui4ccos","content":"<p><strong>java</strong><a href=\"http://www.kuqin.com/shuoit/20140708/341091.html\" target=\"_blank\" rel=\"external\"></a></p>\n<hr>\n<p></p>\n<p>JavaJava</p>\n<a id=\"more\"></a>\n<h1 id=\"Java\"><a href=\"#Java\" class=\"headerlink\" title=\"Java\"></a>Java</h1><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h3><p>CPU</p>\n<p>,</p>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h3><p>(self contained)</p>\n<ul>\n<li>,,</li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<blockquote>\n<p><br>from <a href=\"https://www.zhihu.com/question/21535820/answer/19120563\" target=\"_blank\" rel=\"external\">JacobK</a></p>\n</blockquote>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3. \"></a>3. </h3><ul>\n<li></li>\n<li>,</li>\n</ul>\n<p>CPU(heap memory)ServletsCGIServletsCGI</p>\n<h3 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4. \"></a>4. </h3><p>JavaJVMJVM<strong></strong>emailJVM</p>\n<h3 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5. \"></a>5. </h3><p>RunnableThreadThreadThread<a href=\"http://www.journaldev.com/1016/java-thread-example-extending-thread-class-and-implementing-runnable-interface\" target=\"_blank\" rel=\"external\">Read more</a></p>\n<h3 id=\"6-\"><a href=\"#6-\" class=\"headerlink\" title=\"6. \"></a>6. </h3><p>JavaNewstart()RunnableRunnableCPURunningWaitingBlockedDead<a href=\"http://www.journaldev.com/1044/life-cycle-of-thread-understanding-thread-states-in-java\" target=\"_blank\" rel=\"external\">Read more</a></p>\n<ul>\n<li><strong>new Thread</strong>Thread<code>Thread  t1=new Thread()</code>;</li>\n<li><strong>runnable</strong>CPUCPU<code>t1.start()</code>;</li>\n<li><strong>running</strong>CPUrun()CPU</li>\n<li><strong>dead</strong></li>\n<li><strong></strong>run()</li>\n<li><strong></strong>stop()</li>\n<li><strong>blocked</strong>CPU</li>\n<li><strong></strong>sleep(long t) </li>\n<li><strong></strong>wait()motify()</li>\n<li><strong></strong>suspend()resume()</li>\n</ul>\n<h3 id=\"7-Threadrun-\"><a href=\"#7-Threadrun-\" class=\"headerlink\" title=\"7. Threadrun()\"></a>7. Threadrun()</h3><p>Threadrun()Threadstart()</p>\n<h3 id=\"8-\"><a href=\"#8-\" class=\"headerlink\" title=\"8. \"></a>8. </h3><p>ThreadSleep()Runnable</p>\n<h3 id=\"9-\"><a href=\"#9-\" class=\"headerlink\" title=\"9. \"></a>9. </h3><p>CPU<strong>CPU</strong>32031 <strong></strong>OS<strong></strong>Class SetThreadPriority</p>\n<h3 id=\"10--Thread-Scheduler--Time-Slicing-\"><a href=\"#10--Thread-Scheduler--Time-Slicing-\" class=\"headerlink\" title=\"10. (Thread Scheduler)(Time Slicing)\"></a>10. (Thread Scheduler)(Time Slicing)</h3><p>RunnableCPUCPURunnableCPUJava</p>\n<h3 id=\"11--context-switching-\"><a href=\"#11--context-switching-\" class=\"headerlink\" title=\"11. (context-switching)\"></a>11. (context-switching)</h3><p>CPU</p>\n<h3 id=\"12-main-Java\"><a href=\"#12-main-Java\" class=\"headerlink\" title=\"12. main()Java\"></a>12. main()Java</h3><p>Threadjoint()main()<a href=\"http://www.journaldev.com/1024/java-thread-join-example-with-explanation\" target=\"_blank\" rel=\"external\">Read more</a></p>\n<blockquote>\n<p>join()join()join()join()sleepjoin()join()</p>\n</blockquote>\n<h3 id=\"13-\"><a href=\"#13-\" class=\"headerlink\" title=\"13.\"></a>13.</h3><p></p>\n<p>a. violate</p>\n<p>b. WindowsUIsendMessage,postMessage</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><div class=\"line\">1)#define WM_THREAD_SENDMSG=WM_USER+20;  </div><div class=\"line\">2)afx_msg int OnTSendmsg();</div><div class=\"line\">3)ON_MESSAGE(WM_THREAD_SENDMSG,OnTSM)</div><div class=\"line\">4)OnTSM()</div><div class=\"line\">5)PostMessagePost</div></pre></td></tr></table></figure>\n<p>c. CEventEvent</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><div class=\"line\">1)CEventCEvent threadStart;</div><div class=\"line\">2)threadStart.SetEvent();</div><div class=\"line\">3)WaitForSingleObject()CEvent</div></pre></td></tr></table></figure>\n<p>Objectwait()notify()notifyAll()<a href=\"http://www.journaldev.com/1037/java-thread-wait-notify-and-notifyall-example\" target=\"_blank\" rel=\"external\">Read more</a></p>\n<h3 id=\"14-\"><a href=\"#14-\" class=\"headerlink\" title=\"14. \"></a>14. </h3><p>()/windowsLinux</p>\n<p><strong></strong></p>\n<p><strong>FIFO</strong>[^14] <a href=\"http://blog.csdn.net/chenhuajie123/article/details/9315477\" target=\"_blank\" rel=\"external\">Read Read Read</a></p>\n<h3 id=\"15-wait-notify-notifyAll-Object\"><a href=\"#15-wait-notify-notifyAll-Object\" class=\"headerlink\" title=\"15. wait(), notify()notifyAll()Object\"></a>15. wait(), notify()notifyAll()Object</h3><p>Java(monitor) wait()notify()JavaObjectJava</p>\n<h3 id=\"16-wait-notify-notifyAll-\"><a href=\"#16-wait-notify-notifyAll-\" class=\"headerlink\" title=\"16. wait(), notify()notifyAll()\"></a>16. wait(), notify()notifyAll()</h3><p>wait()notify()notify()</p>\n<h3 id=\"17-Threadsleep-yield-\"><a href=\"#17-Threadsleep-yield-\" class=\"headerlink\" title=\"17. Threadsleep()yield()\"></a>17. Threadsleep()yield()</h3><p>Threadsleep()yield()</p>\n<h3 id=\"18-\"><a href=\"#18-\" class=\"headerlink\" title=\"18. \"></a>18. </h3><p>Java(atomic concurrent classes)volatile<a href=\"http://www.journaldev.com/1061/java-synchronization-and-thread-safety-tutorial-with-examples\" target=\"_blank\" rel=\"external\">Read more</a></p>\n<h3 id=\"19-volatileJava\"><a href=\"#19-volatileJava\" class=\"headerlink\" title=\"19. volatileJava\"></a>19. volatileJava</h3><p>volatile</p>\n<h3 id=\"20-\"><a href=\"#20-\" class=\"headerlink\" title=\"20. \"></a>20. </h3><p></p>\n<h3 id=\"21-\"><a href=\"#21-\" class=\"headerlink\" title=\"21. \"></a>21. </h3><p>ThreadsetDaemon(true)start()IllegalThreadStateException</p>\n<h3 id=\"22-ThreadLocal\"><a href=\"#22-ThreadLocal\" class=\"headerlink\" title=\"22. ThreadLocal?\"></a>22. ThreadLocal?</h3><p>ThreadLocalThreadLocal</p>\n<p>Threadget()set()ThreadLocalprivate static<a href=\"http://www.journaldev.com/1076/java-threadlocal-example-to-create-thread-local-variables\" target=\"_blank\" rel=\"external\">Read more</a></p>\n<h3 id=\"23--Deadlock-\"><a href=\"#23--Deadlock-\" class=\"headerlink\" title=\"23. (Deadlock)\"></a>23. (Deadlock)</h3><p></p>\n<ul>\n<li><strong>Mutual exclusion</strong></li>\n<li><strong>Hold and wait</strong></li>\n<li><strong>No preemption</strong></li>\n<li><strong>Circular wait</strong></li>\n</ul>\n<p><a href=\"http://blog.csdn.net/joejames/article/details/37960873\" target=\"_blank\" rel=\"external\"></a></p>\n<h3 id=\"24-Java\"><a href=\"#24-Java\" class=\"headerlink\" title=\"24. Java\"></a>24. Java</h3><p></p>\n<p>java.util.concurrent.Executorsjava.util.concurrent.Executor<a href=\"http://www.journaldev.com/1069/java-thread-pool-example-using-executors-and-threadpoolexecutor\" target=\"_blank\" rel=\"external\"></a></p>\n<h1 id=\"Java\"><a href=\"#Java\" class=\"headerlink\" title=\"Java\"></a>Java</h1><h3 id=\"1-Java-Concurrency-API-atomic-classes-\"><a href=\"#1-Java-Concurrency-API-atomic-classes-\" class=\"headerlink\" title=\"1. Java Concurrency API(atomic classes)\"></a>1. Java Concurrency API(atomic classes)</h3><p></p>\n<p>int++1</p>\n<p>JDK1.5JDK1.5java.util.concurrent.atomicintlong<a href=\"http://www.journaldev.com/1069/java-thread-pool-example-using-executors-and-threadpoolexecutor\" target=\"_blank\" rel=\"external\">Read more</a></p>\n<h3 id=\"2-Java-Concurrency-APILock-Lock-interface-\"><a href=\"#2-Java-Concurrency-APILock-Lock-interface-\" class=\"headerlink\" title=\"2. Java Concurrency APILock(Lock interface)\"></a>2. Java Concurrency APILock(Lock interface)</h3><p>Lock</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h3 id=\"3-Executors\"><a href=\"#3-Executors\" class=\"headerlink\" title=\"3. Executors\"></a>3. Executors</h3><p>Executorjava.util.concurrent.Executor Java5Executor</p>\n<p>Executors<a href=\"http://www.journaldev.com/1069/java-thread-pool-example-using-executors-and-threadpoolexecutor\" target=\"_blank\" rel=\"external\">Read more</a></p>\n<h3 id=\"4--\"><a href=\"#4--\" class=\"headerlink\" title=\"4. -\"></a>4. -</h3><p>java.util.concurrent.BlockingQueue</p>\n<p>NullPointerException</p>\n<p></p>\n<p>BlockingQueuejava collections-<a href=\"http://www.journaldev.com/1034/java-blockingqueue-example-implementing-producer-consumer-problem\" target=\"_blank\" rel=\"external\">-</a></p>\n<h3 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5. \"></a>5. </h3><p>Javanext()ConcurrentModificationException</p>\n<p></p>\n<p>ConcurrentHashMap, CopyOnWriteArrayList CopyOnWriteArraySet</p>\n<h3 id=\"6-Executors\"><a href=\"#6-Executors\" class=\"headerlink\" title=\"6. Executors\"></a>6. Executors</h3><p>ExecutorsExecutorExecutorServiceScheduledExecutorServiceThreadFactoryCallable</p>\n<p>Executors</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><a href=\"http://blog.csdn.net/column/details/killthreadseries.html\" target=\"_blank\" rel=\"external\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><a href=\"http://blog.csdn.net/chenhuajie123/article/details/9315477\" target=\"_blank\" rel=\"external\"></a></h3><hr>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2015/03/16/java-multithreading-concurrent/\">http://agehua.github.io/2015/03/16/java-multithreading-concurrent/</a></p>\n","readingTime":{"text":"2 min read","minutes":1.49,"time":89400,"words":298},"excerpt":"<p><strong>java</strong><a href=\"http://www.kuqin.com/shuoit/20140708/341091.html\"></a></p>\n<hr>\n<p></p>\n<p>JavaJava</p>","more":"<h1 id=\"Java\"><a href=\"#Java\" class=\"headerlink\" title=\"Java\"></a>Java</h1><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h3><p>CPU</p>\n<p>,</p>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h3><p>(self contained)</p>\n<ul>\n<li>,,</li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<blockquote>\n<p><br>from <a href=\"https://www.zhihu.com/question/21535820/answer/19120563\">JacobK</a></p>\n</blockquote>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3. \"></a>3. </h3><ul>\n<li></li>\n<li>,</li>\n</ul>\n<p>CPU(heap memory)ServletsCGIServletsCGI</p>\n<h3 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4. \"></a>4. </h3><p>JavaJVMJVM<strong></strong>emailJVM</p>\n<h3 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5. \"></a>5. </h3><p>RunnableThreadThreadThread<a href=\"http://www.journaldev.com/1016/java-thread-example-extending-thread-class-and-implementing-runnable-interface\">Read more</a></p>\n<h3 id=\"6-\"><a href=\"#6-\" class=\"headerlink\" title=\"6. \"></a>6. </h3><p>JavaNewstart()RunnableRunnableCPURunningWaitingBlockedDead<a href=\"http://www.journaldev.com/1044/life-cycle-of-thread-understanding-thread-states-in-java\">Read more</a></p>\n<ul>\n<li><strong>new Thread</strong>Thread<code>Thread  t1=new Thread()</code>;</li>\n<li><strong>runnable</strong>CPUCPU<code>t1.start()</code>;</li>\n<li><strong>running</strong>CPUrun()CPU</li>\n<li><strong>dead</strong></li>\n<li><strong></strong>run()</li>\n<li><strong></strong>stop()</li>\n<li><strong>blocked</strong>CPU</li>\n<li><strong></strong>sleep(long t) </li>\n<li><strong></strong>wait()motify()</li>\n<li><strong></strong>suspend()resume()</li>\n</ul>\n<h3 id=\"7-Threadrun-\"><a href=\"#7-Threadrun-\" class=\"headerlink\" title=\"7. Threadrun()\"></a>7. Threadrun()</h3><p>Threadrun()Threadstart()</p>\n<h3 id=\"8-\"><a href=\"#8-\" class=\"headerlink\" title=\"8. \"></a>8. </h3><p>ThreadSleep()Runnable</p>\n<h3 id=\"9-\"><a href=\"#9-\" class=\"headerlink\" title=\"9. \"></a>9. </h3><p>CPU<strong>CPU</strong>32031 <strong></strong>OS<strong></strong>Class SetThreadPriority</p>\n<h3 id=\"10--Thread-Scheduler--Time-Slicing-\"><a href=\"#10--Thread-Scheduler--Time-Slicing-\" class=\"headerlink\" title=\"10. (Thread Scheduler)(Time Slicing)\"></a>10. (Thread Scheduler)(Time Slicing)</h3><p>RunnableCPUCPURunnableCPUJava</p>\n<h3 id=\"11--context-switching-\"><a href=\"#11--context-switching-\" class=\"headerlink\" title=\"11. (context-switching)\"></a>11. (context-switching)</h3><p>CPU</p>\n<h3 id=\"12-main-Java\"><a href=\"#12-main-Java\" class=\"headerlink\" title=\"12. main()Java\"></a>12. main()Java</h3><p>Threadjoint()main()<a href=\"http://www.journaldev.com/1024/java-thread-join-example-with-explanation\">Read more</a></p>\n<blockquote>\n<p>join()join()join()join()sleepjoin()join()</p>\n</blockquote>\n<h3 id=\"13-\"><a href=\"#13-\" class=\"headerlink\" title=\"13.\"></a>13.</h3><p></p>\n<p>a. violate</p>\n<p>b. WindowsUIsendMessage,postMessage</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><div class=\"line\">1)#define WM_THREAD_SENDMSG=WM_USER+20;  </div><div class=\"line\">2)afx_msg int OnTSendmsg();</div><div class=\"line\">3)ON_MESSAGE(WM_THREAD_SENDMSG,OnTSM)</div><div class=\"line\">4)OnTSM()</div><div class=\"line\">5)PostMessagePost</div></pre></td></tr></table></figure>\n<p>c. CEventEvent</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><div class=\"line\">1)CEventCEvent threadStart;</div><div class=\"line\">2)threadStart.SetEvent();</div><div class=\"line\">3)WaitForSingleObject()CEvent</div></pre></td></tr></table></figure>\n<p>Objectwait()notify()notifyAll()<a href=\"http://www.journaldev.com/1037/java-thread-wait-notify-and-notifyall-example\">Read more</a></p>\n<h3 id=\"14-\"><a href=\"#14-\" class=\"headerlink\" title=\"14. \"></a>14. </h3><p>()/windowsLinux</p>\n<p><strong></strong></p>\n<p><strong>FIFO</strong>[^14] <a href=\"http://blog.csdn.net/chenhuajie123/article/details/9315477\">Read Read Read</a></p>\n<h3 id=\"15-wait-notify-notifyAll-Object\"><a href=\"#15-wait-notify-notifyAll-Object\" class=\"headerlink\" title=\"15. wait(), notify()notifyAll()Object\"></a>15. wait(), notify()notifyAll()Object</h3><p>Java(monitor) wait()notify()JavaObjectJava</p>\n<h3 id=\"16-wait-notify-notifyAll-\"><a href=\"#16-wait-notify-notifyAll-\" class=\"headerlink\" title=\"16. wait(), notify()notifyAll()\"></a>16. wait(), notify()notifyAll()</h3><p>wait()notify()notify()</p>\n<h3 id=\"17-Threadsleep-yield-\"><a href=\"#17-Threadsleep-yield-\" class=\"headerlink\" title=\"17. Threadsleep()yield()\"></a>17. Threadsleep()yield()</h3><p>Threadsleep()yield()</p>\n<h3 id=\"18-\"><a href=\"#18-\" class=\"headerlink\" title=\"18. \"></a>18. </h3><p>Java(atomic concurrent classes)volatile<a href=\"http://www.journaldev.com/1061/java-synchronization-and-thread-safety-tutorial-with-examples\">Read more</a></p>\n<h3 id=\"19-volatileJava\"><a href=\"#19-volatileJava\" class=\"headerlink\" title=\"19. volatileJava\"></a>19. volatileJava</h3><p>volatile</p>\n<h3 id=\"20-\"><a href=\"#20-\" class=\"headerlink\" title=\"20. \"></a>20. </h3><p></p>\n<h3 id=\"21-\"><a href=\"#21-\" class=\"headerlink\" title=\"21. \"></a>21. </h3><p>ThreadsetDaemon(true)start()IllegalThreadStateException</p>\n<h3 id=\"22-ThreadLocal\"><a href=\"#22-ThreadLocal\" class=\"headerlink\" title=\"22. ThreadLocal?\"></a>22. ThreadLocal?</h3><p>ThreadLocalThreadLocal</p>\n<p>Threadget()set()ThreadLocalprivate static<a href=\"http://www.journaldev.com/1076/java-threadlocal-example-to-create-thread-local-variables\">Read more</a></p>\n<h3 id=\"23--Deadlock-\"><a href=\"#23--Deadlock-\" class=\"headerlink\" title=\"23. (Deadlock)\"></a>23. (Deadlock)</h3><p></p>\n<ul>\n<li><strong>Mutual exclusion</strong></li>\n<li><strong>Hold and wait</strong></li>\n<li><strong>No preemption</strong></li>\n<li><strong>Circular wait</strong></li>\n</ul>\n<p><a href=\"http://blog.csdn.net/joejames/article/details/37960873\"></a></p>\n<h3 id=\"24-Java\"><a href=\"#24-Java\" class=\"headerlink\" title=\"24. Java\"></a>24. Java</h3><p></p>\n<p>java.util.concurrent.Executorsjava.util.concurrent.Executor<a href=\"http://www.journaldev.com/1069/java-thread-pool-example-using-executors-and-threadpoolexecutor\"></a></p>\n<h1 id=\"Java\"><a href=\"#Java\" class=\"headerlink\" title=\"Java\"></a>Java</h1><h3 id=\"1-Java-Concurrency-API-atomic-classes-\"><a href=\"#1-Java-Concurrency-API-atomic-classes-\" class=\"headerlink\" title=\"1. Java Concurrency API(atomic classes)\"></a>1. Java Concurrency API(atomic classes)</h3><p></p>\n<p>int++1</p>\n<p>JDK1.5JDK1.5java.util.concurrent.atomicintlong<a href=\"http://www.journaldev.com/1069/java-thread-pool-example-using-executors-and-threadpoolexecutor\">Read more</a></p>\n<h3 id=\"2-Java-Concurrency-APILock-Lock-interface-\"><a href=\"#2-Java-Concurrency-APILock-Lock-interface-\" class=\"headerlink\" title=\"2. Java Concurrency APILock(Lock interface)\"></a>2. Java Concurrency APILock(Lock interface)</h3><p>Lock</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h3 id=\"3-Executors\"><a href=\"#3-Executors\" class=\"headerlink\" title=\"3. Executors\"></a>3. Executors</h3><p>Executorjava.util.concurrent.Executor Java5Executor</p>\n<p>Executors<a href=\"http://www.journaldev.com/1069/java-thread-pool-example-using-executors-and-threadpoolexecutor\">Read more</a></p>\n<h3 id=\"4--\"><a href=\"#4--\" class=\"headerlink\" title=\"4. -\"></a>4. -</h3><p>java.util.concurrent.BlockingQueue</p>\n<p>NullPointerException</p>\n<p></p>\n<p>BlockingQueuejava collections-<a href=\"http://www.journaldev.com/1034/java-blockingqueue-example-implementing-producer-consumer-problem\">-</a></p>\n<h3 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5. \"></a>5. </h3><p>Javanext()ConcurrentModificationException</p>\n<p></p>\n<p>ConcurrentHashMap, CopyOnWriteArrayList CopyOnWriteArraySet</p>\n<h3 id=\"6-Executors\"><a href=\"#6-Executors\" class=\"headerlink\" title=\"6. Executors\"></a>6. Executors</h3><p>ExecutorsExecutorExecutorServiceScheduledExecutorServiceThreadFactoryCallable</p>\n<p>Executors</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><a href=\"http://blog.csdn.net/column/details/killthreadseries.html\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><a href=\"http://blog.csdn.net/chenhuajie123/article/details/9315477\"></a></h3><hr>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2015/03/16/java-multithreading-concurrent/\">http://agehua.github.io/2015/03/16/java-multithreading-concurrent/</a></p>"},{"layout":"book","title":"2015","keywords":",,2015","books":[{"title":"2 The Sicilian","status":"","author":"","publisher":"","language":"","link":"https://book.douban.com/subject/25762007/","cover":"https://img3.doubanio.com/mpic/s27244215.jpg","description":""},{"title":" The Godfather's Revenge","status":"","author":"","publisher":"","language":"","link":"http://book.douban.com/subject/4020110/","cover":"http://img3.douban.com/mpic/s4014854.jpg","description":null},{"title":" The Godfather Returns","status":"","author":"","publisher":"","language":"","link":"http://book.douban.com/subject/1959055/","cover":"http://img3.doubanio.com/mpic/s5848649.jpg","description":null},{"title":" The Godfather","status":"","author":"","publisher":"","language":"","link":"http://book.douban.com/subject/25762009/","cover":"http://img3.douban.com/mpic/s27227804.jpg","description":"ing"},{"title":" The Kite Runner","status":"","author":"","publisher":"","language":"","link":"http://book.douban.com/subject/1770782/","cover":"http://img3.douban.com/mpic/s1727290.jpg","description":""}],"_content":"","source":"_posts/2015-11-06-book-list-of-2015.md","raw":"---\nlayout: book\ntitle: 2015\ncategory: read\ntags: read\nkeywords: ,,2015\nbooks:\n    - title: 2 The Sicilian\n      status: \n      author: \n      publisher: \n      language: \n      link: https://book.douban.com/subject/25762007/\n      cover: https://img3.doubanio.com/mpic/s27244215.jpg\n      description: \n    - title:  The Godfather's Revenge\n      status: \n      author: \n      publisher: \n      language: \n      link: http://book.douban.com/subject/4020110/\n      cover: http://img3.douban.com/mpic/s4014854.jpg\n      description:\n    - title:  The Godfather Returns\n      status: \n      author: \n      publisher: \n      language: \n      link: http://book.douban.com/subject/1959055/\n      cover: http://img3.doubanio.com/mpic/s5848649.jpg\n      description:\n    - title:  The Godfather\n      status: \n      author: \n      publisher: \n      language: \n      link: http://book.douban.com/subject/25762009/\n      cover: http://img3.douban.com/mpic/s27227804.jpg\n      description: ing\n    - title:  The Kite Runner\n      status: \n      author: \n      publisher: \n      language: \n      link: http://book.douban.com/subject/1770782/\n      cover: http://img3.douban.com/mpic/s1727290.jpg\n      description: \n---\n","slug":"book-list-of-2015","published":1,"date":"2015-11-05T16:00:00.000Z","updated":"2016-12-26T10:41:15.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ebvo0008d6yk6b8vzqxl","content":"<hr>\n<p><a href=\"http://agehua.github.io/2015/11/06/book-list-of-2015/\">http://agehua.github.io/2015/11/06/book-list-of-2015/</a></p>\n","readingTime":{"text":"1 min read","minutes":0.01,"time":600,"words":2},"excerpt":"","more":"<hr>\n<p><a href=\"http://agehua.github.io/2015/11/06/book-list-of-2015/\">http://agehua.github.io/2015/11/06/book-list-of-2015/</a></p>\n"},{"layout":"post","title":"android Google map","keywords":"android, google map","description":"google map2.0","banner":"http://obxk8w81b.bkt.clouddn.com/Chestnut%20Tree%20in%20Blossom.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Chestnut%20Tree%20in%20Blossom.jpg","_content":"\n\n### 1.google map\ngoogle mapGoogle map apigoogle-play-services_libSDK Managerandroid apiExtrasGoogle Play Service\n\nmap2.0com.google.android.gms\n\nGoogle Maps Android API OpenGL ES2OpenGL ES2 AndroidManifest.xml <uses-feature><manifest>\n\n~~~ Java\n<uses-feature\n        android:glEsVersion=\"0x00020000\"\n        android:required=\"true\"/>\n~~~\n\n<!--more-->\n\n### 2.\n1.OnCameraChangeListener\n\n~~~ Java\n@Override\npublic void onCameraChange(CameraPosition arg0) {\n\t// TODO Auto-generated method stub\n\tzoom = arg0.zoom;\n}\n~~~\n\n2. Activity  Fragment  Activity  <fragment> \n\n3. OnMapReadyCallback onMapReady(GoogleMap)GoogleMapGoogleMapUiSettings\n\n4.FragmentgetMapAsync()\n\n5.map\n\n~~~ Java\nMarkerOptions markerOpt = new MarkerOptions();  \nmarkerOpt.position(new LatLng(geoLat, geoLng));  \nmarkerOpt.draggable(false);  \nmarkerOpt.visible(true);  \nmarkerOpt.anchor(0.5f, 0.5f);//  \nmarkerOpt.icon(BitmapDescriptorFactory  \n\t.fromResource(R.drawable.sos_location_38x53));  \nmMap.addMarker(markerOpt);  \n//  \ncameraPosition = new CameraPosition.Builder()  \n.target(new LatLng(geoLat, geoLng))              // Sets the center of the map to ZINTUN  \n\t.zoom(zoom)                  //   \n\t.bearing(0)                // Sets the orientation of the camera to east  \n\t.build();                  // Creates a CameraPosition from the builder  \nmMap.animateCamera(CameraUpdateFactory.newCameraPosition(cameraPosition));\n~~~   \n\n6..9<br>\n[Is there a way to implement rounded corners to a Mapfragment?](http://stackoverflow.com/questions/14469208/is-there-a-way-to-implement-rounded-corners-to-a-mapfragment)\n\n7.google\nGoogleMap.setMyLocationEnabled(false);\n\n8.mapviewscrollview\ngetParent().requestDisallowInterceptTouchEvent(true);touch\n\n~~~ Java\npublic class MyMapView extends MapView {\n    private ViewParent mViewParent;\n\n    public MyMapView(Context context) {\n        super(context);\n    }\n\n    public MyMapView(Context context, AttributeSet attrs) {\n        super(context, attrs);\n    }\n\n    public MyMapView(Context context, AttributeSet attrs, int defStyle) {\n        super(context, attrs, defStyle);\n    }\n\n    public MyMapView(Context context, GoogleMapOptions options) {\n        super(context, options);\n    }\n\n\n    public void setViewParent(@Nullable final ViewParent viewParent) { //any ViewGroup\n        mViewParent = viewParent;\n    }\n\n    @Override\n    public boolean onInterceptTouchEvent(final MotionEvent event) {\n        switch (event.getAction()) {\n            case MotionEvent.ACTION_DOWN:\n                if (null == mViewParent) {\n                    //touchviewtouch\n                    getParent().requestDisallowInterceptTouchEvent(true);\n                } else {\n                    mViewParent.requestDisallowInterceptTouchEvent(true);\n                }\n                break;\n            case MotionEvent.ACTION_UP:\n                if (null == mViewParent) {\n                    //touch\n                    getParent().requestDisallowInterceptTouchEvent(false);\n                } else {\n                    mViewParent.requestDisallowInterceptTouchEvent(false);\n                }\n                break;\n            default:\n                break;\n        }\n\n        return super.onInterceptTouchEvent(event);\n    }\n}\n~~~\n\n9.LocationListeneronProviderDisabled\n\n\n\n~~~ Java\n@Override\npublic void onProviderDisabled(String provider) {\n    isLocatedSuccess = false;\n    if (provider.equals(\"network\")) //\n        startActivity(new Intent(android.provider.Settings.ACTION_LOCATION_SOURCE_SETTINGS));\n}\n~~~\n\n### 3.\ncom.android.vending.apkGoogle play storecom.google.android.gms.apkGoogle play services\n\n\nhttp://pan.baidu.com/s/1i5q8jo5 solm\n\n\n","source":"_posts/2016-03-01-android-googlemap-summary.md","raw":"---\nlayout: post\ntitle: android Google map\ncategory: accumulation\ntags:\n  - ANDROID\n  - google map\nkeywords: android, google map\ndescription: google map2.0\nbanner: http://obxk8w81b.bkt.clouddn.com/Chestnut%20Tree%20in%20Blossom.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Chestnut%20Tree%20in%20Blossom.jpg\n---\n\n\n### 1.google map\ngoogle mapGoogle map apigoogle-play-services_libSDK Managerandroid apiExtrasGoogle Play Service\n\nmap2.0com.google.android.gms\n\nGoogle Maps Android API OpenGL ES2OpenGL ES2 AndroidManifest.xml <uses-feature><manifest>\n\n~~~ Java\n<uses-feature\n        android:glEsVersion=\"0x00020000\"\n        android:required=\"true\"/>\n~~~\n\n<!--more-->\n\n### 2.\n1.OnCameraChangeListener\n\n~~~ Java\n@Override\npublic void onCameraChange(CameraPosition arg0) {\n\t// TODO Auto-generated method stub\n\tzoom = arg0.zoom;\n}\n~~~\n\n2. Activity  Fragment  Activity  <fragment> \n\n3. OnMapReadyCallback onMapReady(GoogleMap)GoogleMapGoogleMapUiSettings\n\n4.FragmentgetMapAsync()\n\n5.map\n\n~~~ Java\nMarkerOptions markerOpt = new MarkerOptions();  \nmarkerOpt.position(new LatLng(geoLat, geoLng));  \nmarkerOpt.draggable(false);  \nmarkerOpt.visible(true);  \nmarkerOpt.anchor(0.5f, 0.5f);//  \nmarkerOpt.icon(BitmapDescriptorFactory  \n\t.fromResource(R.drawable.sos_location_38x53));  \nmMap.addMarker(markerOpt);  \n//  \ncameraPosition = new CameraPosition.Builder()  \n.target(new LatLng(geoLat, geoLng))              // Sets the center of the map to ZINTUN  \n\t.zoom(zoom)                  //   \n\t.bearing(0)                // Sets the orientation of the camera to east  \n\t.build();                  // Creates a CameraPosition from the builder  \nmMap.animateCamera(CameraUpdateFactory.newCameraPosition(cameraPosition));\n~~~   \n\n6..9<br>\n[Is there a way to implement rounded corners to a Mapfragment?](http://stackoverflow.com/questions/14469208/is-there-a-way-to-implement-rounded-corners-to-a-mapfragment)\n\n7.google\nGoogleMap.setMyLocationEnabled(false);\n\n8.mapviewscrollview\ngetParent().requestDisallowInterceptTouchEvent(true);touch\n\n~~~ Java\npublic class MyMapView extends MapView {\n    private ViewParent mViewParent;\n\n    public MyMapView(Context context) {\n        super(context);\n    }\n\n    public MyMapView(Context context, AttributeSet attrs) {\n        super(context, attrs);\n    }\n\n    public MyMapView(Context context, AttributeSet attrs, int defStyle) {\n        super(context, attrs, defStyle);\n    }\n\n    public MyMapView(Context context, GoogleMapOptions options) {\n        super(context, options);\n    }\n\n\n    public void setViewParent(@Nullable final ViewParent viewParent) { //any ViewGroup\n        mViewParent = viewParent;\n    }\n\n    @Override\n    public boolean onInterceptTouchEvent(final MotionEvent event) {\n        switch (event.getAction()) {\n            case MotionEvent.ACTION_DOWN:\n                if (null == mViewParent) {\n                    //touchviewtouch\n                    getParent().requestDisallowInterceptTouchEvent(true);\n                } else {\n                    mViewParent.requestDisallowInterceptTouchEvent(true);\n                }\n                break;\n            case MotionEvent.ACTION_UP:\n                if (null == mViewParent) {\n                    //touch\n                    getParent().requestDisallowInterceptTouchEvent(false);\n                } else {\n                    mViewParent.requestDisallowInterceptTouchEvent(false);\n                }\n                break;\n            default:\n                break;\n        }\n\n        return super.onInterceptTouchEvent(event);\n    }\n}\n~~~\n\n9.LocationListeneronProviderDisabled\n\n\n\n~~~ Java\n@Override\npublic void onProviderDisabled(String provider) {\n    isLocatedSuccess = false;\n    if (provider.equals(\"network\")) //\n        startActivity(new Intent(android.provider.Settings.ACTION_LOCATION_SOURCE_SETTINGS));\n}\n~~~\n\n### 3.\ncom.android.vending.apkGoogle play storecom.google.android.gms.apkGoogle play services\n\n\nhttp://pan.baidu.com/s/1i5q8jo5 solm\n\n\n","slug":"android-googlemap-summary","published":1,"date":"2016-02-29T16:00:00.000Z","updated":"2017-11-23T07:23:56.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ebvs0009d6yktahbspes","content":"<h3 id=\"1-google-map\"><a href=\"#1-google-map\" class=\"headerlink\" title=\"1.google map\"></a>1.google map</h3><p>google mapGoogle map apigoogle-play-services_libSDK Managerandroid apiExtrasGoogle Play Service</p>\n<p>map2.0com.google.android.gms</p>\n<p>Google Maps Android API OpenGL ES2OpenGL ES2 AndroidManifest.xml <uses-feature><manifest></manifest></uses-feature></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;uses-feature</div><div class=\"line\">        android:glEsVersion=<span class=\"string\">\"0x00020000\"</span></div><div class=\"line\">        android:required=<span class=\"string\">\"true\"</span>/&gt;</div></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h3><p>1.OnCameraChangeListener</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onCameraChange</span><span class=\"params\">(CameraPosition arg0)</span> </span>&#123;</div><div class=\"line\">\t<span class=\"comment\">// TODO Auto-generated method stub</span></div><div class=\"line\">\tzoom = arg0.zoom;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>2. Activity  Fragment  Activity  <fragment> </fragment></p>\n<p>3. OnMapReadyCallback onMapReady(GoogleMap)GoogleMapGoogleMapUiSettings</p>\n<p>4.FragmentgetMapAsync()</p>\n<p>5.map</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">MarkerOptions markerOpt = <span class=\"keyword\">new</span> MarkerOptions();  </div><div class=\"line\">markerOpt.position(<span class=\"keyword\">new</span> LatLng(geoLat, geoLng));  </div><div class=\"line\">markerOpt.draggable(<span class=\"keyword\">false</span>);  </div><div class=\"line\">markerOpt.visible(<span class=\"keyword\">true</span>);  </div><div class=\"line\">markerOpt.anchor(<span class=\"number\">0.5f</span>, <span class=\"number\">0.5f</span>);<span class=\"comment\">//  </span></div><div class=\"line\">markerOpt.icon(BitmapDescriptorFactory  </div><div class=\"line\">\t.fromResource(R.drawable.sos_location_38x53));  </div><div class=\"line\">mMap.addMarker(markerOpt);  </div><div class=\"line\"><span class=\"comment\">//  </span></div><div class=\"line\">cameraPosition = <span class=\"keyword\">new</span> CameraPosition.Builder()  </div><div class=\"line\">.target(<span class=\"keyword\">new</span> LatLng(geoLat, geoLng))              <span class=\"comment\">// Sets the center of the map to ZINTUN  </span></div><div class=\"line\">\t.zoom(zoom)                  <span class=\"comment\">//   </span></div><div class=\"line\">\t.bearing(<span class=\"number\">0</span>)                <span class=\"comment\">// Sets the orientation of the camera to east  </span></div><div class=\"line\">\t.build();                  <span class=\"comment\">// Creates a CameraPosition from the builder  </span></div><div class=\"line\">mMap.animateCamera(CameraUpdateFactory.newCameraPosition(cameraPosition));</div><div class=\"line\">~~~   </div><div class=\"line\"></div><div class=\"line\"><span class=\"number\">6</span>..<span class=\"number\">9</span>&lt;br&gt;</div><div class=\"line\">[Is there a way to implement rounded corners to a Mapfragment?](http:<span class=\"comment\">//stackoverflow.com/questions/14469208/is-there-a-way-to-implement-rounded-corners-to-a-mapfragment)</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"number\">7</span>.google</div><div class=\"line\">GoogleMap.setMyLocationEnabled(<span class=\"keyword\">false</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"number\">8</span>.mapviewscrollview</div><div class=\"line\">getParent().requestDisallowInterceptTouchEvent(<span class=\"keyword\">true</span>);touch</div><div class=\"line\"></div><div class=\"line\">~~~ Java</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyMapView</span> <span class=\"keyword\">extends</span> <span class=\"title\">MapView</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">private</span> ViewParent mViewParent;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MyMapView</span><span class=\"params\">(Context context)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>(context);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MyMapView</span><span class=\"params\">(Context context, AttributeSet attrs)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>(context, attrs);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MyMapView</span><span class=\"params\">(Context context, AttributeSet attrs, <span class=\"keyword\">int</span> defStyle)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>(context, attrs, defStyle);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MyMapView</span><span class=\"params\">(Context context, GoogleMapOptions options)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>(context, options);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setViewParent</span><span class=\"params\">(@Nullable <span class=\"keyword\">final</span> ViewParent viewParent)</span> </span>&#123; <span class=\"comment\">//any ViewGroup</span></div><div class=\"line\">        mViewParent = viewParent;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">onInterceptTouchEvent</span><span class=\"params\">(<span class=\"keyword\">final</span> MotionEvent event)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">switch</span> (event.getAction()) &#123;</div><div class=\"line\">            <span class=\"keyword\">case</span> MotionEvent.ACTION_DOWN:</div><div class=\"line\">                <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> == mViewParent) &#123;</div><div class=\"line\">                    <span class=\"comment\">//touchviewtouch</span></div><div class=\"line\">                    getParent().requestDisallowInterceptTouchEvent(<span class=\"keyword\">true</span>);</div><div class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">                    mViewParent.requestDisallowInterceptTouchEvent(<span class=\"keyword\">true</span>);</div><div class=\"line\">                &#125;</div><div class=\"line\">                <span class=\"keyword\">break</span>;</div><div class=\"line\">            <span class=\"keyword\">case</span> MotionEvent.ACTION_UP:</div><div class=\"line\">                <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> == mViewParent) &#123;</div><div class=\"line\">                    <span class=\"comment\">//touch</span></div><div class=\"line\">                    getParent().requestDisallowInterceptTouchEvent(<span class=\"keyword\">false</span>);</div><div class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">                    mViewParent.requestDisallowInterceptTouchEvent(<span class=\"keyword\">false</span>);</div><div class=\"line\">                &#125;</div><div class=\"line\">                <span class=\"keyword\">break</span>;</div><div class=\"line\">            <span class=\"keyword\">default</span>:</div><div class=\"line\">                <span class=\"keyword\">break</span>;</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">super</span>.onInterceptTouchEvent(event);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>9.LocationListeneronProviderDisabled</p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onProviderDisabled</span><span class=\"params\">(String provider)</span> </span>&#123;</div><div class=\"line\">    isLocatedSuccess = <span class=\"keyword\">false</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (provider.equals(<span class=\"string\">\"network\"</span>)) <span class=\"comment\">//</span></div><div class=\"line\">        startActivity(<span class=\"keyword\">new</span> Intent(android.provider.Settings.ACTION_LOCATION_SOURCE_SETTINGS));</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h3><p>com.android.vending.apkGoogle play storecom.google.android.gms.apkGoogle play services<br></p>\n<p><a href=\"http://pan.baidu.com/s/1i5q8jo5\" target=\"_blank\" rel=\"external\">http://pan.baidu.com/s/1i5q8jo5</a> solm</p>\n<p></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/03/01/android-googlemap-summary/\">http://agehua.github.io/2016/03/01/android-googlemap-summary/</a></p>\n","readingTime":{"text":"3 min read","minutes":2.395,"time":143700,"words":479},"excerpt":"<h3 id=\"1-google-map\"><a href=\"#1-google-map\" class=\"headerlink\" title=\"1.google map\"></a>1.google map</h3><p>google mapGoogle map apigoogle-play-services_libSDK Managerandroid apiExtrasGoogle Play Service</p>\n<p>map2.0com.google.android.gms</p>\n<p>Google Maps Android API OpenGL ES2OpenGL ES2 AndroidManifest.xml <uses-feature><manifest></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;uses-feature</div><div class=\"line\">        android:glEsVersion=<span class=\"string\">\"0x00020000\"</span></div><div class=\"line\">        android:required=<span class=\"string\">\"true\"</span>/&gt;</div></pre></td></tr></table></figure>","more":"<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h3><p>1.OnCameraChangeListener</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onCameraChange</span><span class=\"params\">(CameraPosition arg0)</span> </span>&#123;</div><div class=\"line\">\t<span class=\"comment\">// TODO Auto-generated method stub</span></div><div class=\"line\">\tzoom = arg0.zoom;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>2. Activity  Fragment  Activity  <fragment> </p>\n<p>3. OnMapReadyCallback onMapReady(GoogleMap)GoogleMapGoogleMapUiSettings</p>\n<p>4.FragmentgetMapAsync()</p>\n<p>5.map</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">MarkerOptions markerOpt = <span class=\"keyword\">new</span> MarkerOptions();  </div><div class=\"line\">markerOpt.position(<span class=\"keyword\">new</span> LatLng(geoLat, geoLng));  </div><div class=\"line\">markerOpt.draggable(<span class=\"keyword\">false</span>);  </div><div class=\"line\">markerOpt.visible(<span class=\"keyword\">true</span>);  </div><div class=\"line\">markerOpt.anchor(<span class=\"number\">0.5f</span>, <span class=\"number\">0.5f</span>);<span class=\"comment\">//  </span></div><div class=\"line\">markerOpt.icon(BitmapDescriptorFactory  </div><div class=\"line\">\t.fromResource(R.drawable.sos_location_38x53));  </div><div class=\"line\">mMap.addMarker(markerOpt);  </div><div class=\"line\"><span class=\"comment\">//  </span></div><div class=\"line\">cameraPosition = <span class=\"keyword\">new</span> CameraPosition.Builder()  </div><div class=\"line\">.target(<span class=\"keyword\">new</span> LatLng(geoLat, geoLng))              <span class=\"comment\">// Sets the center of the map to ZINTUN  </span></div><div class=\"line\">\t.zoom(zoom)                  <span class=\"comment\">//   </span></div><div class=\"line\">\t.bearing(<span class=\"number\">0</span>)                <span class=\"comment\">// Sets the orientation of the camera to east  </span></div><div class=\"line\">\t.build();                  <span class=\"comment\">// Creates a CameraPosition from the builder  </span></div><div class=\"line\">mMap.animateCamera(CameraUpdateFactory.newCameraPosition(cameraPosition));</div><div class=\"line\">~~~   </div><div class=\"line\"></div><div class=\"line\"><span class=\"number\">6</span>..<span class=\"number\">9</span>&lt;br&gt;</div><div class=\"line\">[Is there a way to implement rounded corners to a Mapfragment?](http:<span class=\"comment\">//stackoverflow.com/questions/14469208/is-there-a-way-to-implement-rounded-corners-to-a-mapfragment)</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"number\">7</span>.google</div><div class=\"line\">GoogleMap.setMyLocationEnabled(<span class=\"keyword\">false</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"number\">8</span>.mapviewscrollview</div><div class=\"line\">getParent().requestDisallowInterceptTouchEvent(<span class=\"keyword\">true</span>);touch</div><div class=\"line\"></div><div class=\"line\">~~~ Java</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyMapView</span> <span class=\"keyword\">extends</span> <span class=\"title\">MapView</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">private</span> ViewParent mViewParent;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MyMapView</span><span class=\"params\">(Context context)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>(context);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MyMapView</span><span class=\"params\">(Context context, AttributeSet attrs)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>(context, attrs);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MyMapView</span><span class=\"params\">(Context context, AttributeSet attrs, <span class=\"keyword\">int</span> defStyle)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>(context, attrs, defStyle);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MyMapView</span><span class=\"params\">(Context context, GoogleMapOptions options)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>(context, options);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setViewParent</span><span class=\"params\">(@Nullable <span class=\"keyword\">final</span> ViewParent viewParent)</span> </span>&#123; <span class=\"comment\">//any ViewGroup</span></div><div class=\"line\">        mViewParent = viewParent;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">onInterceptTouchEvent</span><span class=\"params\">(<span class=\"keyword\">final</span> MotionEvent event)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">switch</span> (event.getAction()) &#123;</div><div class=\"line\">            <span class=\"keyword\">case</span> MotionEvent.ACTION_DOWN:</div><div class=\"line\">                <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> == mViewParent) &#123;</div><div class=\"line\">                    <span class=\"comment\">//touchviewtouch</span></div><div class=\"line\">                    getParent().requestDisallowInterceptTouchEvent(<span class=\"keyword\">true</span>);</div><div class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">                    mViewParent.requestDisallowInterceptTouchEvent(<span class=\"keyword\">true</span>);</div><div class=\"line\">                &#125;</div><div class=\"line\">                <span class=\"keyword\">break</span>;</div><div class=\"line\">            <span class=\"keyword\">case</span> MotionEvent.ACTION_UP:</div><div class=\"line\">                <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> == mViewParent) &#123;</div><div class=\"line\">                    <span class=\"comment\">//touch</span></div><div class=\"line\">                    getParent().requestDisallowInterceptTouchEvent(<span class=\"keyword\">false</span>);</div><div class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">                    mViewParent.requestDisallowInterceptTouchEvent(<span class=\"keyword\">false</span>);</div><div class=\"line\">                &#125;</div><div class=\"line\">                <span class=\"keyword\">break</span>;</div><div class=\"line\">            <span class=\"keyword\">default</span>:</div><div class=\"line\">                <span class=\"keyword\">break</span>;</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">super</span>.onInterceptTouchEvent(event);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>9.LocationListeneronProviderDisabled</p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onProviderDisabled</span><span class=\"params\">(String provider)</span> </span>&#123;</div><div class=\"line\">    isLocatedSuccess = <span class=\"keyword\">false</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (provider.equals(<span class=\"string\">\"network\"</span>)) <span class=\"comment\">//</span></div><div class=\"line\">        startActivity(<span class=\"keyword\">new</span> Intent(android.provider.Settings.ACTION_LOCATION_SOURCE_SETTINGS));</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h3><p>com.android.vending.apkGoogle play storecom.google.android.gms.apkGoogle play services<br></p>\n<p><a href=\"http://pan.baidu.com/s/1i5q8jo5\">http://pan.baidu.com/s/1i5q8jo5</a> solm</p>\n<p></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/03/01/android-googlemap-summary/\">http://agehua.github.io/2016/03/01/android-googlemap-summary/</a></p>"},{"layout":"post","title":"facebook google+ Twitter sign-in fragment","keywords":"android, google map, fragments","description":"google map2.0","banner":"http://obxk8w81b.bkt.clouddn.com/Cottages%20with%20a%20Woman%20Working%20in%20the%20Foreground.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Cottages%20with%20a%20Woman%20Working%20in%20the%20Foreground.jpg","_content":"\n\n### 1.\nblog: [Google+Facebook](http://www.cnblogs.com/lngg057/p/5020192.html)\n\ng+: [G+ start](https://developers.google.com/identity/sign-in/android/start)\n\nfacebook: [Facebook start](https://developers.facebook.com/docs/android/getting-started)\n\niCCP: [Not recognizing known sRGB profile](http://www.bigademo.com/iccp-not-recognizing-known-srgb-profile/)\n\n<!--more-->\n\n- \n\n    [2016-04-01 11:24:04 - Dex Loader] Unable to execute dex: method ID not in [0, 0xffff]: 65536\n    [2016-04-01 11:24:04 - VIVAT_SHARESDK] Conversion to Dalvik format failed: Unable to execute dex: method ID not in [0, 0xffff]: 65536\n\n[](http://www.cnblogs.com/yaozhongxiao/p/3521428.html)\n\n- iCCP: Not recognizing known sRGB profile pngiCCP profile sRGB\n\nhttp://my.oschina.net/1pei/blog/479162?fromerr=ARrUPlGS\n\n\n\n1:Image Magick http://www.imagemagick.com.cn/download.html.windowsdll\n\n2  \n\n~~~ C++\n//WINDOWS\nset fn=E:\\Program Files\\ImageMagick-6.9.0-Q16\\convert.exe  \nfor /f \"tokens=*\" %i in ('dir/s/b *.png') do \"%fn%\" \"%i\" -strip \"%i\"\nwindow%%i%i\n~~~\n\n~~~ C++\n//LINUX\n set fn=E:\\Program Files\\ImageMagick-6.9.0-Q16\\convert.exe  \nfor /f \"tokens=*\" %%i in ('dir/s/b *.png') do \"%fn%\" \"%%i\" -strip \"%%i\"\n~~~\n\n### 2.\n\n- 1.This client application's callback url has been locked.\n\n    Twitter signinlogcat[Twitter](https://apps.twitter.com)SettingsEnable Callback Locking (It is recommended to enable callback locking to ensure apps cannot overwrite the callback url)appcallback url[](https://twittercommunity.com/t/callback-url-is-locked/59481)\n\n### 3.add() vs. replace()\n- Fragment2add()replace()\n\n    add()FragmentFragmentonAttach()-onResume()FragmentViewattachcontainerView\n\n    ActivtyFragmentonPause()-onDetach()\n\n    replace()FragmentFragmentFragmentonAttach()FragmentonPause()-onDetach()containerViewdetachFragmentView\n\n- show() & hide().\n\n    FragmentFragmentViewFragmentViewdetachcontainerViewchildViewattach() & detach()Fragmentdetach()onPause()-onDestroyView()\n\n    FragmentViewdetachattach()onCreateView()-onResume()\n\n- remove()\n\n    remove()add()onAttach()-onResume()remove()onPause()-onDetach()\n\n\n### 4.FragmentTransaction add  replace \n FragmentTransaction  add   replace .add  replace \n\n- add fragment container \n\n    Add a fragment to the activity state. This fragment may optionally also have its view (if Fragment.onCreateView returns non-null) into a container view of the activity.\n\n~~~ Java\npublic abstract FragmentTransaction add (int containerViewId, Fragment fragment, String tag)\n~~~\n\n\n- replace removeidfragmentaddfragment\n\n    Replace an existing fragment that was added to a container. This is essentially the same as calling remove(Fragment) for all currently added fragments that were added with the same containerViewId and then add(int, Fragment, String) with the same arguments given here.\n\n~~~ Java\npublic abstract FragmentTransaction replace (int containerViewId, Fragment fragment, String tag)\n~~~\n\n\n\nFrameLayoutFragmentadd  replace FrameLayoutaddFrameLayout2replaceaddFragmentFrameLayoutaddFragment\n\naddreplace\n\n###\t5.fragment\nfragmentreplace()tagonResume\n\n~~~ Java\ngetFragmentManager()\n \t.beginTransaction()\n    .replace(R.id.base_container,\n    \t inputVerifyCodeFragment,\"tag_code\")\n    .addToBackStack(null).commit();\n~~~\n\n### 6.fragment\nfragment2fragmentfragment1fragment2android:clickable=\"true\"\n","source":"_posts/2016-03-15-facebook-google+signin.md","raw":"---\nlayout: post\ntitle: facebook google+ Twitter sign-in fragment\ncategory: accumulation\ntags:\n  - ANDROID\n  - third-party signin\nkeywords: android, google map, fragments\ndescription: google map2.0\nbanner: http://obxk8w81b.bkt.clouddn.com/Cottages%20with%20a%20Woman%20Working%20in%20the%20Foreground.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Cottages%20with%20a%20Woman%20Working%20in%20the%20Foreground.jpg\n---\n\n\n### 1.\nblog: [Google+Facebook](http://www.cnblogs.com/lngg057/p/5020192.html)\n\ng+: [G+ start](https://developers.google.com/identity/sign-in/android/start)\n\nfacebook: [Facebook start](https://developers.facebook.com/docs/android/getting-started)\n\niCCP: [Not recognizing known sRGB profile](http://www.bigademo.com/iccp-not-recognizing-known-srgb-profile/)\n\n<!--more-->\n\n- \n\n    [2016-04-01 11:24:04 - Dex Loader] Unable to execute dex: method ID not in [0, 0xffff]: 65536\n    [2016-04-01 11:24:04 - VIVAT_SHARESDK] Conversion to Dalvik format failed: Unable to execute dex: method ID not in [0, 0xffff]: 65536\n\n[](http://www.cnblogs.com/yaozhongxiao/p/3521428.html)\n\n- iCCP: Not recognizing known sRGB profile pngiCCP profile sRGB\n\nhttp://my.oschina.net/1pei/blog/479162?fromerr=ARrUPlGS\n\n\n\n1:Image Magick http://www.imagemagick.com.cn/download.html.windowsdll\n\n2  \n\n~~~ C++\n//WINDOWS\nset fn=E:\\Program Files\\ImageMagick-6.9.0-Q16\\convert.exe  \nfor /f \"tokens=*\" %i in ('dir/s/b *.png') do \"%fn%\" \"%i\" -strip \"%i\"\nwindow%%i%i\n~~~\n\n~~~ C++\n//LINUX\n set fn=E:\\Program Files\\ImageMagick-6.9.0-Q16\\convert.exe  \nfor /f \"tokens=*\" %%i in ('dir/s/b *.png') do \"%fn%\" \"%%i\" -strip \"%%i\"\n~~~\n\n### 2.\n\n- 1.This client application's callback url has been locked.\n\n    Twitter signinlogcat[Twitter](https://apps.twitter.com)SettingsEnable Callback Locking (It is recommended to enable callback locking to ensure apps cannot overwrite the callback url)appcallback url[](https://twittercommunity.com/t/callback-url-is-locked/59481)\n\n### 3.add() vs. replace()\n- Fragment2add()replace()\n\n    add()FragmentFragmentonAttach()-onResume()FragmentViewattachcontainerView\n\n    ActivtyFragmentonPause()-onDetach()\n\n    replace()FragmentFragmentFragmentonAttach()FragmentonPause()-onDetach()containerViewdetachFragmentView\n\n- show() & hide().\n\n    FragmentFragmentViewFragmentViewdetachcontainerViewchildViewattach() & detach()Fragmentdetach()onPause()-onDestroyView()\n\n    FragmentViewdetachattach()onCreateView()-onResume()\n\n- remove()\n\n    remove()add()onAttach()-onResume()remove()onPause()-onDetach()\n\n\n### 4.FragmentTransaction add  replace \n FragmentTransaction  add   replace .add  replace \n\n- add fragment container \n\n    Add a fragment to the activity state. This fragment may optionally also have its view (if Fragment.onCreateView returns non-null) into a container view of the activity.\n\n~~~ Java\npublic abstract FragmentTransaction add (int containerViewId, Fragment fragment, String tag)\n~~~\n\n\n- replace removeidfragmentaddfragment\n\n    Replace an existing fragment that was added to a container. This is essentially the same as calling remove(Fragment) for all currently added fragments that were added with the same containerViewId and then add(int, Fragment, String) with the same arguments given here.\n\n~~~ Java\npublic abstract FragmentTransaction replace (int containerViewId, Fragment fragment, String tag)\n~~~\n\n\n\nFrameLayoutFragmentadd  replace FrameLayoutaddFrameLayout2replaceaddFragmentFrameLayoutaddFragment\n\naddreplace\n\n###\t5.fragment\nfragmentreplace()tagonResume\n\n~~~ Java\ngetFragmentManager()\n \t.beginTransaction()\n    .replace(R.id.base_container,\n    \t inputVerifyCodeFragment,\"tag_code\")\n    .addToBackStack(null).commit();\n~~~\n\n### 6.fragment\nfragment2fragmentfragment1fragment2android:clickable=\"true\"\n","slug":"facebook-google+signin","published":1,"date":"2016-03-14T16:00:00.000Z","updated":"2017-11-23T07:23:59.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ebvw000ad6yk14yre00n","content":"<h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h3><p>blog: <a href=\"http://www.cnblogs.com/lngg057/p/5020192.html\" target=\"_blank\" rel=\"external\">Google+Facebook</a></p>\n<p>g+: <a href=\"https://developers.google.com/identity/sign-in/android/start\" target=\"_blank\" rel=\"external\">G+ start</a></p>\n<p>facebook: <a href=\"https://developers.facebook.com/docs/android/getting-started\" target=\"_blank\" rel=\"external\">Facebook start</a></p>\n<p>iCCP: <a href=\"http://www.bigademo.com/iccp-not-recognizing-known-srgb-profile/\" target=\"_blank\" rel=\"external\">Not recognizing known sRGB profile</a></p>\n<a id=\"more\"></a>\n<ul>\n<li><p></p>\n<p>  [2016-04-01 11:24:04 - Dex Loader] Unable to execute dex: method ID not in [0, 0xffff]: 65536<br>  [2016-04-01 11:24:04 - VIVAT_SHARESDK] Conversion to Dalvik format failed: Unable to execute dex: method ID not in [0, 0xffff]: 65536</p>\n</li>\n</ul>\n<p><a href=\"http://www.cnblogs.com/yaozhongxiao/p/3521428.html\" target=\"_blank\" rel=\"external\"></a></p>\n<ul>\n<li>iCCP: Not recognizing known sRGB profile pngiCCP profile sRGB</li>\n</ul>\n<p><a href=\"http://my.oschina.net/1pei/blog/479162?fromerr=ARrUPlGS\" target=\"_blank\" rel=\"external\">http://my.oschina.net/1pei/blog/479162?fromerr=ARrUPlGS</a></p>\n<p></p>\n<p>1:Image Magick <a href=\"http://www.imagemagick.com.cn/download.html.windowsdll\" target=\"_blank\" rel=\"external\">http://www.imagemagick.com.cn/download.html.windowsdll</a></p>\n<p>2  </p>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><div class=\"line\">//WINDOWS</div><div class=\"line\">set fn=E:\\Program Files\\ImageMagick-6.9.0-Q16\\convert.exe  </div><div class=\"line\">for /f \"tokens=*\" %i in ('dir/s/b *.png') do \"%fn%\" \"%i\" -strip \"%i\"</div><div class=\"line\">window%%i%i</div></pre></td></tr></table></figure>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><div class=\"line\">//LINUX</div><div class=\"line\"> set fn=E:\\Program Files\\ImageMagick-6.9.0-Q16\\convert.exe  </div><div class=\"line\">for /f \"tokens=*\" %%i in ('dir/s/b *.png') do \"%fn%\" \"%%i\" -strip \"%%i\"</div></pre></td></tr></table></figure>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h3><ul>\n<li><p>1.This client applications callback url has been locked.</p>\n<p>  Twitter signinlogcat<a href=\"https://apps.twitter.com\" target=\"_blank\" rel=\"external\">Twitter</a>SettingsEnable Callback Locking (It is recommended to enable callback locking to ensure apps cannot overwrite the callback url)appcallback url<a href=\"https://twittercommunity.com/t/callback-url-is-locked/59481\" target=\"_blank\" rel=\"external\"></a></p>\n</li>\n</ul>\n<h3 id=\"3-add-vs-replace\"><a href=\"#3-add-vs-replace\" class=\"headerlink\" title=\"3.add() vs. replace()\"></a>3.add() vs. replace()</h3><ul>\n<li><p>Fragment2add()replace()</p>\n<p>  add()FragmentFragmentonAttach()-onResume()FragmentViewattachcontainerView</p>\n<p>  ActivtyFragmentonPause()-onDetach()</p>\n<p>  replace()FragmentFragmentFragmentonAttach()FragmentonPause()-onDetach()containerViewdetachFragmentView</p>\n</li>\n<li><p>show() &amp; hide().</p>\n<p>  FragmentFragmentViewFragmentViewdetachcontainerViewchildViewattach() &amp; detach()Fragmentdetach()onPause()-onDestroyView()</p>\n<p>  FragmentViewdetachattach()onCreateView()-onResume()</p>\n</li>\n<li><p>remove()</p>\n<p>  remove()add()onAttach()-onResume()remove()onPause()-onDetach()</p>\n</li>\n</ul>\n<h3 id=\"4-FragmentTransaction-add--replace-\"><a href=\"#4-FragmentTransaction-add--replace-\" class=\"headerlink\" title=\"4.FragmentTransaction add  replace \"></a>4.FragmentTransaction add  replace </h3><p> FragmentTransaction  add   replace .add  replace </p>\n<ul>\n<li><p>add fragment container </p>\n<p>  Add a fragment to the activity state. This fragment may optionally also have its view (if Fragment.onCreateView returns non-null) into a container view of the activity.</p>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> FragmentTransaction <span class=\"title\">add</span> <span class=\"params\">(<span class=\"keyword\">int</span> containerViewId, Fragment fragment, String tag)</span></span></div></pre></td></tr></table></figure>\n<ul>\n<li><p>replace removeidfragmentaddfragment</p>\n<p>  Replace an existing fragment that was added to a container. This is essentially the same as calling remove(Fragment) for all currently added fragments that were added with the same containerViewId and then add(int, Fragment, String) with the same arguments given here.</p>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> FragmentTransaction <span class=\"title\">replace</span> <span class=\"params\">(<span class=\"keyword\">int</span> containerViewId, Fragment fragment, String tag)</span></span></div></pre></td></tr></table></figure>\n<p>FrameLayoutFragmentadd  replace FrameLayoutaddFrameLayout2replaceaddFragmentFrameLayoutaddFragment</p>\n<p>addreplace</p>\n<h3 id=\"5-fragment\"><a href=\"#5-fragment\" class=\"headerlink\" title=\"5.fragment\"></a>5.fragment</h3><p>fragmentreplace()tagonResume</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">getFragmentManager()</div><div class=\"line\"> \t.beginTransaction()</div><div class=\"line\">    .replace(R.id.base_container,</div><div class=\"line\">    \t inputVerifyCodeFragment,<span class=\"string\">\"tag_code\"</span>)</div><div class=\"line\">    .addToBackStack(<span class=\"keyword\">null</span>).commit();</div></pre></td></tr></table></figure>\n<h3 id=\"6-fragment\"><a href=\"#6-fragment\" class=\"headerlink\" title=\"6.fragment\"></a>6.fragment</h3><p>fragment2fragmentfragment1fragment2android:clickable=true</p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/03/15/facebook-google+signin/\">http://agehua.github.io/2016/03/15/facebook-google+signin/</a></p>\n","readingTime":{"text":"2 min read","minutes":1.71,"time":102600,"words":342},"excerpt":"<h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h3><p>blog: <a href=\"http://www.cnblogs.com/lngg057/p/5020192.html\">Google+Facebook</a></p>\n<p>g+: <a href=\"https://developers.google.com/identity/sign-in/android/start\">G+ start</a></p>\n<p>facebook: <a href=\"https://developers.facebook.com/docs/android/getting-started\">Facebook start</a></p>\n<p>iCCP: <a href=\"http://www.bigademo.com/iccp-not-recognizing-known-srgb-profile/\">Not recognizing known sRGB profile</a></p>","more":"<ul>\n<li><p></p>\n<p>  [2016-04-01 11:24:04 - Dex Loader] Unable to execute dex: method ID not in [0, 0xffff]: 65536<br>  [2016-04-01 11:24:04 - VIVAT_SHARESDK] Conversion to Dalvik format failed: Unable to execute dex: method ID not in [0, 0xffff]: 65536</p>\n</li>\n</ul>\n<p><a href=\"http://www.cnblogs.com/yaozhongxiao/p/3521428.html\"></a></p>\n<ul>\n<li>iCCP: Not recognizing known sRGB profile pngiCCP profile sRGB</li>\n</ul>\n<p><a href=\"http://my.oschina.net/1pei/blog/479162?fromerr=ARrUPlGS\">http://my.oschina.net/1pei/blog/479162?fromerr=ARrUPlGS</a></p>\n<p></p>\n<p>1:Image Magick <a href=\"http://www.imagemagick.com.cn/download.html.windowsdll\">http://www.imagemagick.com.cn/download.html.windowsdll</a></p>\n<p>2  </p>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><div class=\"line\">//WINDOWS</div><div class=\"line\">set fn=E:\\Program Files\\ImageMagick-6.9.0-Q16\\convert.exe  </div><div class=\"line\">for /f \"tokens=*\" %i in ('dir/s/b *.png') do \"%fn%\" \"%i\" -strip \"%i\"</div><div class=\"line\">window%%i%i</div></pre></td></tr></table></figure>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><div class=\"line\">//LINUX</div><div class=\"line\"> set fn=E:\\Program Files\\ImageMagick-6.9.0-Q16\\convert.exe  </div><div class=\"line\">for /f \"tokens=*\" %%i in ('dir/s/b *.png') do \"%fn%\" \"%%i\" -strip \"%%i\"</div></pre></td></tr></table></figure>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h3><ul>\n<li><p>1.This client applications callback url has been locked.</p>\n<p>  Twitter signinlogcat<a href=\"https://apps.twitter.com\">Twitter</a>SettingsEnable Callback Locking (It is recommended to enable callback locking to ensure apps cannot overwrite the callback url)appcallback url<a href=\"https://twittercommunity.com/t/callback-url-is-locked/59481\"></a></p>\n</li>\n</ul>\n<h3 id=\"3-add-vs-replace\"><a href=\"#3-add-vs-replace\" class=\"headerlink\" title=\"3.add() vs. replace()\"></a>3.add() vs. replace()</h3><ul>\n<li><p>Fragment2add()replace()</p>\n<p>  add()FragmentFragmentonAttach()-onResume()FragmentViewattachcontainerView</p>\n<p>  ActivtyFragmentonPause()-onDetach()</p>\n<p>  replace()FragmentFragmentFragmentonAttach()FragmentonPause()-onDetach()containerViewdetachFragmentView</p>\n</li>\n<li><p>show() &amp; hide().</p>\n<p>  FragmentFragmentViewFragmentViewdetachcontainerViewchildViewattach() &amp; detach()Fragmentdetach()onPause()-onDestroyView()</p>\n<p>  FragmentViewdetachattach()onCreateView()-onResume()</p>\n</li>\n<li><p>remove()</p>\n<p>  remove()add()onAttach()-onResume()remove()onPause()-onDetach()</p>\n</li>\n</ul>\n<h3 id=\"4-FragmentTransaction-add--replace-\"><a href=\"#4-FragmentTransaction-add--replace-\" class=\"headerlink\" title=\"4.FragmentTransaction add  replace \"></a>4.FragmentTransaction add  replace </h3><p> FragmentTransaction  add   replace .add  replace </p>\n<ul>\n<li><p>add fragment container </p>\n<p>  Add a fragment to the activity state. This fragment may optionally also have its view (if Fragment.onCreateView returns non-null) into a container view of the activity.</p>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> FragmentTransaction <span class=\"title\">add</span> <span class=\"params\">(<span class=\"keyword\">int</span> containerViewId, Fragment fragment, String tag)</span></span></div></pre></td></tr></table></figure>\n<ul>\n<li><p>replace removeidfragmentaddfragment</p>\n<p>  Replace an existing fragment that was added to a container. This is essentially the same as calling remove(Fragment) for all currently added fragments that were added with the same containerViewId and then add(int, Fragment, String) with the same arguments given here.</p>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> FragmentTransaction <span class=\"title\">replace</span> <span class=\"params\">(<span class=\"keyword\">int</span> containerViewId, Fragment fragment, String tag)</span></span></div></pre></td></tr></table></figure>\n<p>FrameLayoutFragmentadd  replace FrameLayoutaddFrameLayout2replaceaddFragmentFrameLayoutaddFragment</p>\n<p>addreplace</p>\n<h3 id=\"5-fragment\"><a href=\"#5-fragment\" class=\"headerlink\" title=\"5.fragment\"></a>5.fragment</h3><p>fragmentreplace()tagonResume</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">getFragmentManager()</div><div class=\"line\"> \t.beginTransaction()</div><div class=\"line\">    .replace(R.id.base_container,</div><div class=\"line\">    \t inputVerifyCodeFragment,<span class=\"string\">\"tag_code\"</span>)</div><div class=\"line\">    .addToBackStack(<span class=\"keyword\">null</span>).commit();</div></pre></td></tr></table></figure>\n<h3 id=\"6-fragment\"><a href=\"#6-fragment\" class=\"headerlink\" title=\"6.fragment\"></a>6.fragment</h3><p>fragment2fragmentfragment1fragment2android:clickable=true</p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/03/15/facebook-google+signin/\">http://agehua.github.io/2016/03/15/facebook-google+signin/</a></p>"},{"layout":"post","title":"android","keywords":", ,","banner":"http://obxk8w81b.bkt.clouddn.com/Blossoming%20Chestnut%20Branches.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Blossoming%20Chestnut%20Branches.jpg","_content":"\n\n### mipmap drawable \nNexus 6  493 ppi xxhdpixxxhdpixxxhdpimipmap-xxxhdpi,sclaemipmap\n\n### setTranslucentStatus()\nAndroid4.4\n\n<!--more-->\n\n~~~ Java\npublic class MainActivity extends Activity\n{\n    @Override\n    protected void onCreate(Bundle savedInstanceState)\n    {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_main);\n\n        //api>=19\n        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT)\n        {\n            setTranslucentStatus(true);\n        }\n\n        SystemBarTintManager tintManager = new SystemBarTintManager(this);\n        tintManager.setStatusBarTintEnabled(true);\n        tintManager.setStatusBarTintColor(Color.parseColor(\"#FFC1E0\"));\n    }\n\n    @TargetApi(19)\n    private void setTranslucentStatus(boolean on)\n    {\n        Window win = getWindow();\n        WindowManager.LayoutParams winParams = win.getAttributes();\n        final int bits = WindowManager.LayoutParams.FLAG_TRANSLUCENT_STATUS;\n        if (on)\n        {\n            winParams.flags |= bits;\n        }\n        else\n        {\n            winParams.flags &= ~bits;\n        }\n        win.setAttributes(winParams);\n    }\n}\n~~~\n\n\n\n~~~ Javascript%\n<LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n              android:layout_width=\"match_parent\"\n              android:layout_height=\"match_parent\"\n              <!---->\n              android:fitsSystemWindows=\"true\"\n              android:clipToPadding=\"true\"\n\n              android:orientation=\"vertical\"\n              android:background=\"#FFD9EC\"\n        >\n\n    <TextView\n            android:text=\"\"\n            android:layout_width=\"match_parent\"\n            android:layout_height=\"50dp\"\n            android:textSize=\"23dp\"\n            android:layout_gravity=\"center_horizontal\"\n            android:gravity=\"center\"\n            android:background=\"#FFD9EC\"\n            />\n    <TextView\n            android:layout_width=\"match_parent\"\n            android:layout_height=\"match_parent\"\n            android:background=\"@android:color/darker_gray\"/>\n\n</LinearLayout>\n~~~\n\n### Bitmap\n\n~~~ Java\npublic int getBitmapSize(Bitmap bitmap){\n    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT){     //API 19\n        return bitmap.getAllocationByteCount();\n    }\n    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB_MR1){//API 12\n        return bitmap.getByteCount();\n    }\n    return bitmap.getRowBytes() * bitmap.getHeight();                //earlier version\n}\n~~~\n\n\n### Activity\n\n\n\n* 1Activityandroid:configChanges\n\n* 2Activityandroid:configChanges=\"orientation\"\n\n* 3Activityandroid:configChanges=\"orientation\\|keyboardHidden\"onConfigurationChanged\n\n\n\n1Activity\n\n2Activity\n\n~~~ Java\nonCreate-->\nonStart-->\nonResume-->\n~~~\n\n3crtl+f12\n\n~~~ Java\nonSaveInstanceState-->\nonPause-->\nonStop-->\nonDestroy-->\nonCreate-->\nonStart-->\nonRestoreInstanceState-->\nonResume-->\n~~~\n4crtl+f12log\n\n~~~ Java\nonSaveInstanceState-->\nonPause-->\nonStop-->\nonDestroy-->\nonCreate-->\nonStart-->\nonRestoreInstanceState-->\nonResume-->\nonSaveInstanceState-->\nonPause-->\nonStop-->\nonDestroy-->\nonCreate-->\nonStart-->\nonRestoreInstanceState-->\nonResume-->\n~~~\n5AndroidManifest.xmlActivity android:configChanges=\"orientation\"3\n\n~~~ Java\nonSaveInstanceState-->\nonPause-->\nonStop-->\nonDestroy-->\nonCreate-->\nonStart-->\nonRestoreInstanceState-->\nonResume-->\n~~~\n64onConfigChanged\n\n~~~ Java\nonSaveInstanceState-->\nonPause-->\nonStop-->\nonDestroy-->\nonCreate-->\nonStart-->\nonRestoreInstanceState-->\nonResume-->\nonConfigurationChanged-->\n~~~\n75android:configChanges=\"orientation\" android:configChanges=\"orientation\\|keyboardHidden\"3onConfigChanged\n\n~~~ Java\nonConfigurationChanged-->\n~~~\n84\n\n~~~ Java\nonConfigurationChanged-->\nonConfigurationChanged-->\n~~~\n\nActivity\n\n  - 1.ActivityToastAlertDialogActivity\n  - 2.ActivityHOME()onSaveInstanceState --> onPause --> onStop       onRestart -->onStart--->onResume\n  - 3.ActivityonPause--->onResume\n","source":"_posts/2016-03-20-android-new-knowledge-summary.md","raw":"---\nlayout: post\ntitle:  android\ncategory: accumulation\ntags:\n  - ANDROID\n  - new features\n  - Basic Knowledge\nkeywords: , ,\nbanner: http://obxk8w81b.bkt.clouddn.com/Blossoming%20Chestnut%20Branches.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Blossoming%20Chestnut%20Branches.jpg\n---\n\n\n### mipmap drawable \nNexus 6  493 ppi xxhdpixxxhdpixxxhdpimipmap-xxxhdpi,sclaemipmap\n\n### setTranslucentStatus()\nAndroid4.4\n\n<!--more-->\n\n~~~ Java\npublic class MainActivity extends Activity\n{\n    @Override\n    protected void onCreate(Bundle savedInstanceState)\n    {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_main);\n\n        //api>=19\n        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT)\n        {\n            setTranslucentStatus(true);\n        }\n\n        SystemBarTintManager tintManager = new SystemBarTintManager(this);\n        tintManager.setStatusBarTintEnabled(true);\n        tintManager.setStatusBarTintColor(Color.parseColor(\"#FFC1E0\"));\n    }\n\n    @TargetApi(19)\n    private void setTranslucentStatus(boolean on)\n    {\n        Window win = getWindow();\n        WindowManager.LayoutParams winParams = win.getAttributes();\n        final int bits = WindowManager.LayoutParams.FLAG_TRANSLUCENT_STATUS;\n        if (on)\n        {\n            winParams.flags |= bits;\n        }\n        else\n        {\n            winParams.flags &= ~bits;\n        }\n        win.setAttributes(winParams);\n    }\n}\n~~~\n\n\n\n~~~ Javascript%\n<LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n              android:layout_width=\"match_parent\"\n              android:layout_height=\"match_parent\"\n              <!---->\n              android:fitsSystemWindows=\"true\"\n              android:clipToPadding=\"true\"\n\n              android:orientation=\"vertical\"\n              android:background=\"#FFD9EC\"\n        >\n\n    <TextView\n            android:text=\"\"\n            android:layout_width=\"match_parent\"\n            android:layout_height=\"50dp\"\n            android:textSize=\"23dp\"\n            android:layout_gravity=\"center_horizontal\"\n            android:gravity=\"center\"\n            android:background=\"#FFD9EC\"\n            />\n    <TextView\n            android:layout_width=\"match_parent\"\n            android:layout_height=\"match_parent\"\n            android:background=\"@android:color/darker_gray\"/>\n\n</LinearLayout>\n~~~\n\n### Bitmap\n\n~~~ Java\npublic int getBitmapSize(Bitmap bitmap){\n    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT){     //API 19\n        return bitmap.getAllocationByteCount();\n    }\n    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB_MR1){//API 12\n        return bitmap.getByteCount();\n    }\n    return bitmap.getRowBytes() * bitmap.getHeight();                //earlier version\n}\n~~~\n\n\n### Activity\n\n\n\n* 1Activityandroid:configChanges\n\n* 2Activityandroid:configChanges=\"orientation\"\n\n* 3Activityandroid:configChanges=\"orientation\\|keyboardHidden\"onConfigurationChanged\n\n\n\n1Activity\n\n2Activity\n\n~~~ Java\nonCreate-->\nonStart-->\nonResume-->\n~~~\n\n3crtl+f12\n\n~~~ Java\nonSaveInstanceState-->\nonPause-->\nonStop-->\nonDestroy-->\nonCreate-->\nonStart-->\nonRestoreInstanceState-->\nonResume-->\n~~~\n4crtl+f12log\n\n~~~ Java\nonSaveInstanceState-->\nonPause-->\nonStop-->\nonDestroy-->\nonCreate-->\nonStart-->\nonRestoreInstanceState-->\nonResume-->\nonSaveInstanceState-->\nonPause-->\nonStop-->\nonDestroy-->\nonCreate-->\nonStart-->\nonRestoreInstanceState-->\nonResume-->\n~~~\n5AndroidManifest.xmlActivity android:configChanges=\"orientation\"3\n\n~~~ Java\nonSaveInstanceState-->\nonPause-->\nonStop-->\nonDestroy-->\nonCreate-->\nonStart-->\nonRestoreInstanceState-->\nonResume-->\n~~~\n64onConfigChanged\n\n~~~ Java\nonSaveInstanceState-->\nonPause-->\nonStop-->\nonDestroy-->\nonCreate-->\nonStart-->\nonRestoreInstanceState-->\nonResume-->\nonConfigurationChanged-->\n~~~\n75android:configChanges=\"orientation\" android:configChanges=\"orientation\\|keyboardHidden\"3onConfigChanged\n\n~~~ Java\nonConfigurationChanged-->\n~~~\n84\n\n~~~ Java\nonConfigurationChanged-->\nonConfigurationChanged-->\n~~~\n\nActivity\n\n  - 1.ActivityToastAlertDialogActivity\n  - 2.ActivityHOME()onSaveInstanceState --> onPause --> onStop       onRestart -->onStart--->onResume\n  - 3.ActivityonPause--->onResume\n","slug":"android-new-knowledge-summary","published":1,"date":"2016-03-19T16:00:00.000Z","updated":"2017-12-05T06:33:51.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ebw2000dd6yklg3an2hg","content":"<h3 id=\"mipmap-drawable-\"><a href=\"#mipmap-drawable-\" class=\"headerlink\" title=\"mipmap drawable \"></a>mipmap drawable </h3><p>Nexus 6  493 ppi xxhdpixxxhdpixxxhdpimipmap-xxxhdpi,sclaemipmap</p>\n<h3 id=\"setTranslucentStatus-\"><a href=\"#setTranslucentStatus-\" class=\"headerlink\" title=\"setTranslucentStatus()\"></a>setTranslucentStatus()</h3><p>Android4.4</p>\n<a id=\"more\"></a>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MainActivity</span> <span class=\"keyword\">extends</span> <span class=\"title\">Activity</span></span></div><div class=\"line\">&#123;</div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">onCreate</span><span class=\"params\">(Bundle savedInstanceState)</span></span></div><div class=\"line\">    &#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>.onCreate(savedInstanceState);</div><div class=\"line\">        setContentView(R.layout.activity_main);</div><div class=\"line\"></div><div class=\"line\">        <span class=\"comment\">//api&gt;=19</span></div><div class=\"line\">        <span class=\"keyword\">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT)</div><div class=\"line\">        &#123;</div><div class=\"line\">            setTranslucentStatus(<span class=\"keyword\">true</span>);</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        SystemBarTintManager tintManager = <span class=\"keyword\">new</span> SystemBarTintManager(<span class=\"keyword\">this</span>);</div><div class=\"line\">        tintManager.setStatusBarTintEnabled(<span class=\"keyword\">true</span>);</div><div class=\"line\">        tintManager.setStatusBarTintColor(Color.parseColor(<span class=\"string\">\"#FFC1E0\"</span>));</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@TargetApi</span>(<span class=\"number\">19</span>)</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">setTranslucentStatus</span><span class=\"params\">(<span class=\"keyword\">boolean</span> on)</span></span></div><div class=\"line\">    &#123;</div><div class=\"line\">        Window win = getWindow();</div><div class=\"line\">        WindowManager.LayoutParams winParams = win.getAttributes();</div><div class=\"line\">        <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> bits = WindowManager.LayoutParams.FLAG_TRANSLUCENT_STATUS;</div><div class=\"line\">        <span class=\"keyword\">if</span> (on)</div><div class=\"line\">        &#123;</div><div class=\"line\">            winParams.flags |= bits;</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">else</span></div><div class=\"line\">        &#123;</div><div class=\"line\">            winParams.flags &amp;= ~bits;</div><div class=\"line\">        &#125;</div><div class=\"line\">        win.setAttributes(winParams);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</div><div class=\"line\">              android:layout_width=&quot;match_parent&quot;</div><div class=\"line\">              android:layout_height=&quot;match_parent&quot;</div><div class=\"line\">              &lt;!----&gt;</div><div class=\"line\">              android:fitsSystemWindows=&quot;true&quot;</div><div class=\"line\">              android:clipToPadding=&quot;true&quot;</div><div class=\"line\"></div><div class=\"line\">              android:orientation=&quot;vertical&quot;</div><div class=\"line\">              android:background=&quot;#FFD9EC&quot;</div><div class=\"line\">        &gt;</div><div class=\"line\"></div><div class=\"line\">    &lt;TextView</div><div class=\"line\">            android:text=&quot;&quot;</div><div class=\"line\">            android:layout_width=&quot;match_parent&quot;</div><div class=\"line\">            android:layout_height=&quot;50dp&quot;</div><div class=\"line\">            android:textSize=&quot;23dp&quot;</div><div class=\"line\">            android:layout_gravity=&quot;center_horizontal&quot;</div><div class=\"line\">            android:gravity=&quot;center&quot;</div><div class=\"line\">            android:background=&quot;#FFD9EC&quot;</div><div class=\"line\">            /&gt;</div><div class=\"line\">    &lt;TextView</div><div class=\"line\">            android:layout_width=&quot;match_parent&quot;</div><div class=\"line\">            android:layout_height=&quot;match_parent&quot;</div><div class=\"line\">            android:background=&quot;@android:color/darker_gray&quot;/&gt;</div><div class=\"line\"></div><div class=\"line\">&lt;/LinearLayout&gt;</div></pre></td></tr></table></figure>\n<h3 id=\"Bitmap\"><a href=\"#Bitmap\" class=\"headerlink\" title=\"Bitmap\"></a>Bitmap</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getBitmapSize</span><span class=\"params\">(Bitmap bitmap)</span></span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT)&#123;     <span class=\"comment\">//API 19</span></div><div class=\"line\">        <span class=\"keyword\">return</span> bitmap.getAllocationByteCount();</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.HONEYCOMB_MR1)&#123;<span class=\"comment\">//API 12</span></div><div class=\"line\">        <span class=\"keyword\">return</span> bitmap.getByteCount();</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> bitmap.getRowBytes() * bitmap.getHeight();                <span class=\"comment\">//earlier version</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"Activity\"><a href=\"#Activity\" class=\"headerlink\" title=\"Activity\"></a>Activity</h3><p></p>\n<ul>\n<li><p>1Activityandroid:configChanges</p>\n</li>\n<li><p>2Activityandroid:configChanges=orientation</p>\n</li>\n<li><p>3Activityandroid:configChanges=orientation|keyboardHiddenonConfigurationChanged</p>\n</li>\n</ul>\n<p></p>\n<p>1Activity</p>\n<p>2Activity</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">onCreate--&gt;</div><div class=\"line\">onStart--&gt;</div><div class=\"line\">onResume--&gt;</div></pre></td></tr></table></figure>\n<p>3crtl+f12</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">onSaveInstanceState--&gt;</div><div class=\"line\">onPause--&gt;</div><div class=\"line\">onStop--&gt;</div><div class=\"line\">onDestroy--&gt;</div><div class=\"line\">onCreate--&gt;</div><div class=\"line\">onStart--&gt;</div><div class=\"line\">onRestoreInstanceState--&gt;</div><div class=\"line\">onResume--&gt;</div></pre></td></tr></table></figure>\n<p>4crtl+f12log</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">onSaveInstanceState--&gt;</div><div class=\"line\">onPause--&gt;</div><div class=\"line\">onStop--&gt;</div><div class=\"line\">onDestroy--&gt;</div><div class=\"line\">onCreate--&gt;</div><div class=\"line\">onStart--&gt;</div><div class=\"line\">onRestoreInstanceState--&gt;</div><div class=\"line\">onResume--&gt;</div><div class=\"line\">onSaveInstanceState--&gt;</div><div class=\"line\">onPause--&gt;</div><div class=\"line\">onStop--&gt;</div><div class=\"line\">onDestroy--&gt;</div><div class=\"line\">onCreate--&gt;</div><div class=\"line\">onStart--&gt;</div><div class=\"line\">onRestoreInstanceState--&gt;</div><div class=\"line\">onResume--&gt;</div></pre></td></tr></table></figure>\n<p>5AndroidManifest.xmlActivity android:configChanges=orientation3</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">onSaveInstanceState--&gt;</div><div class=\"line\">onPause--&gt;</div><div class=\"line\">onStop--&gt;</div><div class=\"line\">onDestroy--&gt;</div><div class=\"line\">onCreate--&gt;</div><div class=\"line\">onStart--&gt;</div><div class=\"line\">onRestoreInstanceState--&gt;</div><div class=\"line\">onResume--&gt;</div></pre></td></tr></table></figure>\n<p>64onConfigChanged</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">onSaveInstanceState--&gt;</div><div class=\"line\">onPause--&gt;</div><div class=\"line\">onStop--&gt;</div><div class=\"line\">onDestroy--&gt;</div><div class=\"line\">onCreate--&gt;</div><div class=\"line\">onStart--&gt;</div><div class=\"line\">onRestoreInstanceState--&gt;</div><div class=\"line\">onResume--&gt;</div><div class=\"line\">onConfigurationChanged--&gt;</div></pre></td></tr></table></figure>\n<p>75android:configChanges=orientation android:configChanges=orientation|keyboardHidden3onConfigChanged</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">onConfigurationChanged--&gt;</div></pre></td></tr></table></figure>\n<p>84</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">onConfigurationChanged--&gt;</div><div class=\"line\">onConfigurationChanged--&gt;</div></pre></td></tr></table></figure>\n<p>Activity</p>\n<ul>\n<li>1.ActivityToastAlertDialogActivity</li>\n<li>2.ActivityHOME()onSaveInstanceState &gt; onPause &gt; onStop       onRestart &gt;onStart&gt;onResume</li>\n<li>3.ActivityonPause&gt;onResume</li>\n</ul>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/03/20/android-new-knowledge-summary/\">http://agehua.github.io/2016/03/20/android-new-knowledge-summary/</a></p>\n","readingTime":{"text":"2 min read","minutes":1.9,"time":114000,"words":380},"excerpt":"<h3 id=\"mipmap-drawable-\"><a href=\"#mipmap-drawable-\" class=\"headerlink\" title=\"mipmap drawable \"></a>mipmap drawable </h3><p>Nexus 6  493 ppi xxhdpixxxhdpixxxhdpimipmap-xxxhdpi,sclaemipmap</p>\n<h3 id=\"setTranslucentStatus-\"><a href=\"#setTranslucentStatus-\" class=\"headerlink\" title=\"setTranslucentStatus()\"></a>setTranslucentStatus()</h3><p>Android4.4</p>","more":"<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MainActivity</span> <span class=\"keyword\">extends</span> <span class=\"title\">Activity</span></div><div class=\"line\"></span>&#123;</div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">onCreate</span><span class=\"params\">(Bundle savedInstanceState)</span></div><div class=\"line\">    </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>.onCreate(savedInstanceState);</div><div class=\"line\">        setContentView(R.layout.activity_main);</div><div class=\"line\"></div><div class=\"line\">        <span class=\"comment\">//api&gt;=19</span></div><div class=\"line\">        <span class=\"keyword\">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT)</div><div class=\"line\">        &#123;</div><div class=\"line\">            setTranslucentStatus(<span class=\"keyword\">true</span>);</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        SystemBarTintManager tintManager = <span class=\"keyword\">new</span> SystemBarTintManager(<span class=\"keyword\">this</span>);</div><div class=\"line\">        tintManager.setStatusBarTintEnabled(<span class=\"keyword\">true</span>);</div><div class=\"line\">        tintManager.setStatusBarTintColor(Color.parseColor(<span class=\"string\">\"#FFC1E0\"</span>));</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@TargetApi</span>(<span class=\"number\">19</span>)</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">setTranslucentStatus</span><span class=\"params\">(<span class=\"keyword\">boolean</span> on)</span></div><div class=\"line\">    </span>&#123;</div><div class=\"line\">        Window win = getWindow();</div><div class=\"line\">        WindowManager.LayoutParams winParams = win.getAttributes();</div><div class=\"line\">        <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> bits = WindowManager.LayoutParams.FLAG_TRANSLUCENT_STATUS;</div><div class=\"line\">        <span class=\"keyword\">if</span> (on)</div><div class=\"line\">        &#123;</div><div class=\"line\">            winParams.flags |= bits;</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">else</span></div><div class=\"line\">        &#123;</div><div class=\"line\">            winParams.flags &amp;= ~bits;</div><div class=\"line\">        &#125;</div><div class=\"line\">        win.setAttributes(winParams);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</div><div class=\"line\">              android:layout_width=&quot;match_parent&quot;</div><div class=\"line\">              android:layout_height=&quot;match_parent&quot;</div><div class=\"line\">              &lt;!----&gt;</div><div class=\"line\">              android:fitsSystemWindows=&quot;true&quot;</div><div class=\"line\">              android:clipToPadding=&quot;true&quot;</div><div class=\"line\"></div><div class=\"line\">              android:orientation=&quot;vertical&quot;</div><div class=\"line\">              android:background=&quot;#FFD9EC&quot;</div><div class=\"line\">        &gt;</div><div class=\"line\"></div><div class=\"line\">    &lt;TextView</div><div class=\"line\">            android:text=&quot;&quot;</div><div class=\"line\">            android:layout_width=&quot;match_parent&quot;</div><div class=\"line\">            android:layout_height=&quot;50dp&quot;</div><div class=\"line\">            android:textSize=&quot;23dp&quot;</div><div class=\"line\">            android:layout_gravity=&quot;center_horizontal&quot;</div><div class=\"line\">            android:gravity=&quot;center&quot;</div><div class=\"line\">            android:background=&quot;#FFD9EC&quot;</div><div class=\"line\">            /&gt;</div><div class=\"line\">    &lt;TextView</div><div class=\"line\">            android:layout_width=&quot;match_parent&quot;</div><div class=\"line\">            android:layout_height=&quot;match_parent&quot;</div><div class=\"line\">            android:background=&quot;@android:color/darker_gray&quot;/&gt;</div><div class=\"line\"></div><div class=\"line\">&lt;/LinearLayout&gt;</div></pre></td></tr></table></figure>\n<h3 id=\"Bitmap\"><a href=\"#Bitmap\" class=\"headerlink\" title=\"Bitmap\"></a>Bitmap</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getBitmapSize</span><span class=\"params\">(Bitmap bitmap)</span></span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT)&#123;     <span class=\"comment\">//API 19</span></div><div class=\"line\">        <span class=\"keyword\">return</span> bitmap.getAllocationByteCount();</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.HONEYCOMB_MR1)&#123;<span class=\"comment\">//API 12</span></div><div class=\"line\">        <span class=\"keyword\">return</span> bitmap.getByteCount();</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> bitmap.getRowBytes() * bitmap.getHeight();                <span class=\"comment\">//earlier version</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"Activity\"><a href=\"#Activity\" class=\"headerlink\" title=\"Activity\"></a>Activity</h3><p></p>\n<ul>\n<li><p>1Activityandroid:configChanges</p>\n</li>\n<li><p>2Activityandroid:configChanges=orientation</p>\n</li>\n<li><p>3Activityandroid:configChanges=orientation|keyboardHiddenonConfigurationChanged</p>\n</li>\n</ul>\n<p></p>\n<p>1Activity</p>\n<p>2Activity</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">onCreate--&gt;</div><div class=\"line\">onStart--&gt;</div><div class=\"line\">onResume--&gt;</div></pre></td></tr></table></figure>\n<p>3crtl+f12</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">onSaveInstanceState--&gt;</div><div class=\"line\">onPause--&gt;</div><div class=\"line\">onStop--&gt;</div><div class=\"line\">onDestroy--&gt;</div><div class=\"line\">onCreate--&gt;</div><div class=\"line\">onStart--&gt;</div><div class=\"line\">onRestoreInstanceState--&gt;</div><div class=\"line\">onResume--&gt;</div></pre></td></tr></table></figure>\n<p>4crtl+f12log</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">onSaveInstanceState--&gt;</div><div class=\"line\">onPause--&gt;</div><div class=\"line\">onStop--&gt;</div><div class=\"line\">onDestroy--&gt;</div><div class=\"line\">onCreate--&gt;</div><div class=\"line\">onStart--&gt;</div><div class=\"line\">onRestoreInstanceState--&gt;</div><div class=\"line\">onResume--&gt;</div><div class=\"line\">onSaveInstanceState--&gt;</div><div class=\"line\">onPause--&gt;</div><div class=\"line\">onStop--&gt;</div><div class=\"line\">onDestroy--&gt;</div><div class=\"line\">onCreate--&gt;</div><div class=\"line\">onStart--&gt;</div><div class=\"line\">onRestoreInstanceState--&gt;</div><div class=\"line\">onResume--&gt;</div></pre></td></tr></table></figure>\n<p>5AndroidManifest.xmlActivity android:configChanges=orientation3</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">onSaveInstanceState--&gt;</div><div class=\"line\">onPause--&gt;</div><div class=\"line\">onStop--&gt;</div><div class=\"line\">onDestroy--&gt;</div><div class=\"line\">onCreate--&gt;</div><div class=\"line\">onStart--&gt;</div><div class=\"line\">onRestoreInstanceState--&gt;</div><div class=\"line\">onResume--&gt;</div></pre></td></tr></table></figure>\n<p>64onConfigChanged</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">onSaveInstanceState--&gt;</div><div class=\"line\">onPause--&gt;</div><div class=\"line\">onStop--&gt;</div><div class=\"line\">onDestroy--&gt;</div><div class=\"line\">onCreate--&gt;</div><div class=\"line\">onStart--&gt;</div><div class=\"line\">onRestoreInstanceState--&gt;</div><div class=\"line\">onResume--&gt;</div><div class=\"line\">onConfigurationChanged--&gt;</div></pre></td></tr></table></figure>\n<p>75android:configChanges=orientation android:configChanges=orientation|keyboardHidden3onConfigChanged</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">onConfigurationChanged--&gt;</div></pre></td></tr></table></figure>\n<p>84</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">onConfigurationChanged--&gt;</div><div class=\"line\">onConfigurationChanged--&gt;</div></pre></td></tr></table></figure>\n<p>Activity</p>\n<ul>\n<li>1.ActivityToastAlertDialogActivity</li>\n<li>2.ActivityHOME()onSaveInstanceState &gt; onPause &gt; onStop       onRestart &gt;onStart&gt;onResume</li>\n<li>3.ActivityonPause&gt;onResume</li>\n</ul>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/03/20/android-new-knowledge-summary/\">http://agehua.github.io/2016/03/20/android-new-knowledge-summary/</a></p>"},{"layout":"post","title":"android","keywords":"android,","banner":"http://obxk8w81b.bkt.clouddn.com/Auvers%20Town%20Hall%20on%2014%20July%201890.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Auvers%20Town%20Hall%20on%2014%20July%201890.jpg","_content":"\n\n### 1 Activity\n\nAndroid8ActivityActivity\n\n1 Activity\n\n#### 1.1 Activity\n\n##### 1.1.1 \n\n- (1)ActivityonRestart\n\n- (2)ActivityonPause -> onStopActivityonStopActivityonRestart -> onStart -> onResume\n\n<!--more-->\n\n- (3)onStartonStopActivityonPauseonResumeActivity\n\n- (4)Activity AActivity BonPause(A) -> onCreate(B) -> onStart(B) -> onResume(B) -> onStop(A)onPause\n\n1.1.2 \n\n- (1)onSaveInstanceStateActivityonStoponPause\n\n    ActivityonRestoreInstanceStateonStart\n\n    ActivityonSaveInstanceState\n\n    ActivityActivityActivitylistviewviewviewviewonSaveInstanceStateonRestoreInstanceState\n\n- (2)Activity\n\n    ActivityActivityActivity\n\n- (3)android:configChanges=\"xxx\"\n\n    local\n\n    keyboardHidden\n\n    orientation\n\n    android:configChanges=\"xxx\"ActivityActivityonConfigurationChanged\n\n#### 1.2 Activity\n\n##### 1.2.1 \n\n- (1)Activity\n\n- (2)ActivityContext(ApplicationContextService)standardActivitycontextActivityFLAG_ACTIVITY_NEW_TASK\n\n- (3)Activity\n\n- (4)TaskAffinityActivity\n\n    ActivityTaskAffinitysingleTaskallowTaskReparenting\n\n    TaskAffinitysingleTaskActivityActivityTaskAffinity\n\n    TaskAffinityallowTaskReparentingABActivity CActivity CallowTaskReparentingtrueBActivity CActivity CAB\n\n- (5)singleTask\n\n    singleTaskActivityA\n\n    ActivityActivityActivity.\n\n    ActivityonNewIntent(ActivitysingleTaskFLAG_ACTIVITY_CLEAR_TOP)ActivityActivity\n\n- (6)xmlandroid:launchModeintent.addFlags()ActivityFLAG_ACTIVITY_CLEAR_TOPActivitysingleInstance\n\n##### 1.2.2 ActivityFlags\n\nFLAG_ACTIVITY_NEW_TASK,FLAG_ACTIVITY_SINGLE_TOP,FLAG_ACTIVITY_CLEAR_TOP\n\nFLAG_ACTIVITY_EXCLUDE_FROM_RECENTSActivityActivityActivityandroid:excludeFromRecents=\"true\"\n\n#### 1.3 IntentFilter\n\n- (1)IntentFilteractioncategorydataactioncategorydata\n\n    actioncategorydataactioncategorydataIntentactioncategorydataActivityActivityintent-filterIntentintenf-filterActivity\n~~~ Javascript\n<intent-filter>\n    <action android:name=\"com.ryg.charpter_1.c\" />\n    <action android:name=\"com.ryg.charpter_1.d\" />\n\n    <category android:name=\"com.ryg.category.c\" />\n    <category android:name=\"com.ryg.category.d\" />\n    <category android:name=\"android.intent.category.DEFAULT\" />\n\n    <data android:mimeType=\"text/plain\" />\n</intent-filter>\n~~~  \n\n- (2)action\n\n    Intentactionactionaction\n\n- (3)category\n\n    Intentcategorycategorycategorycategorycategoryandroid.intent.category.DEFAULTActivitycategorycategory\n\n- (4)data\n\n    data\n~~~ Javascript\n<data android:scheme=\"string\"\n\tandroid:host=\"string\"\n\tandroid:port=\"string\"\n\tandroid:path=\"string\"`\n\tandroid:pathPattern=\"string\"\n\tandroid:pathPrefix=\"string\"\n\tandroid:mimeType=\"string\" />\n~~~\n    mimeTypeURImimeTypeURI\n~~~ Javascript\n<scheme>://<host>:<port>/[<path>]|[<pathPrefix>]|[pathPattern]\n~~~\n    content://com.example.project:200/folder/subfolder/etc\n\n  - schemehostportURIschemehostURI\n\n  - pathpathPatternpathPrefixpathpathPrefixpathPattern(\\*)\n\n  dataIntentdatadatadata\n\n  URIscheme\n\n  mimeTypeimage/\\*text/\\*URIURIschemecontentfileschemescheme\n\n~~~ Java\n//URI\n<intent-filter>\n    <data android:mimeType=\"image/*\"/>\n  ...\n</intent-filter>\n~~~\n\n~~~ Java\n//URI\n<intent-filter>\n    <data android:mimeType=\"image/*\" android:scheme=\"http\" .../>\n    ...\n</intent-filter>\n~~~\n\n  IntentdatasetDataAndType\n\n  setDatasetType\n~~~ Java\nintent.setDataAndType(Uri.parse(\"file://abc\"), \"image/png\");\n~~~\n  data\n\n~~~ Java\n<intent-filter>\n    <data android:scheme=\"file\" android:host=\"www.github.com\"/>\n</intent-filter>\n\n<intent-filter>\n    <data android:scheme=\"file\"/>\n    <data android:host=\"www.github.com\"/>\n</intent-filter>\n~~~\n  ActivityIntent\n\n  - (1)PackageManagerresolveActivityIntentresolveActivitynull\n\n  - (2)PackageManagerqueryIntentActivitiesActivity\nServiceBroadcastReceiverPackageManagerqueryIntentServicesqueryBroadcastReceivers\n\n  - actioncategoryActivity\n~~~ Java\n<intent-filter>\n    <action android:name=\"android.intent.action.MAIN\" />\n    <category android:name=\"android.intent.category.LAUNCHER\" />\n</intent-filter>\n~~~\n\n### 2 IPC\n\n#### 2.1 Android IPC\n\n(1)IPCLinuxAndroidBinderIPCSocket\n\n#### 2.2 Android\n\n- (1)android:process.\n\n    packageName::ShareUID\n\n    android:process=\":xyz\" // packageName:xyz\n\n    android:process=\"aaa.bbb.ccc\" // aaa.bbb.ccc\n\n- (2)AndroidUIDUID\n\n    ShareUIDShareUID data\n- (3)android\n\n- (4)\n\n  - 1.\n  - 2.\n  - 3.SharedPreferencesSharedPreferences\n  - 4.ApplicationApplicationApplication\n\n    \n\n#### 2.3 IPC\n\n- (1)SerializableJavaParcelableAndroid\n\n- (2)serialVersionUIdlongserialVersionUIdserialVersionUId\n\n  serialVersionUIdserialVersionUIdserialVersionUIdserialVersionUIdserialVersionUId\n\n  - 1.\n\n  - 2.transient\n\n- (3)ParcelableBinderParcelableIntentBundleBitmapListMapParcelable\n\n~~~ Java\npublic class Book implements Parcelable {\n    public int bookId;\n    public String bookName;\n    public Book() {\n    }\n\n    public Book(int bookId, String bookName) {\n        this.bookId = bookId;\n        this.bookName = bookName;\n    }\n\n    //100\n    public int describeContents() {\n        return 0;\n    }\n\n    //flags0110\n    public void writeToParcel(Parcel out, int flags) {\n        out.writeInt(bookId);\n        out.writeString(bookName);\n    }\n\n    //\n    public static final Parcelable.Creator<Book> CREATOR = new Parcelable.Creator<Book>() {\n        //\n        public Book createFromParcel(Parcel in) {\n            return new Book(in);\n        }\n        public Book[] newArray(int size) {//\n            return new Book[size];\n        }\n    };\n\n    private Book(Parcel in) {\n        bookId = in.readInt();\n        bookName = in.readString();\n    }\n\n}\n~~~\n\n- (4)BinderAndroidIBinder\n\n  IPCBinderAndroidBinder/dev/binder\n\n  FrameworkBinderServiceManagerManagerManagerService\n\n  AndroidBinderbindServiceBinderBinderAIDL\n\n\n  AndroidBinderServiceAIDLMessengerServiceBinderMessengerAIDLBinder\n\n- (5)aidlaidljava\n\n  ididtransact\n\n  StubStubBindertransacttransactStubProxy\n\n  StubStubProxy \n\n  - 1.asInterface(android.os.IBinder obj)BinderAIDLStubStub.Proxy\n  - 2.asBinderBinder\n  - 3.onTransactBinder\n\n    public Boolean onTransact(int code, Parcelable data, Parcelable reply, int flags)\n\n    codedatareplyfalse()\n\n  - 4.Proxy#[Method]\n\n    _datatransactRPConTransactRPC_replyRPC_reply\n\n  AIDLBinder[](https://github.com/singwhatiwanna/android-art-res/blob/master/Chapter_2/src/com/ryg/chapter_2/manualbinder/BookManagerImpl.java)\n\n- (6)BinderlinkToDeathunlinkToDeath\n\n  BinderBinderlinkToDeathunlinkToDeathlinkToDeathBinderBinder\n\n  Binder\n\n  - 1.DeathRecipientDeathRecipientbindeDiedBinder\n\n~~~ Java\nprivate IBinder.DeathRecipient mDeathRecipient = new IBinder.DeathRecipient() {\n    @Override\n    public void binderDied() {\n        if (mRemoteBookManager == null) return;\n        mRemoteBookManager.asBinder().unlinkToDeath(mDeathRecipient, 0);\n        mRemoteBookManager = null;\n        // TODO:Service\n    }\n};\n~~~\n  - 2.binder\n\n~~~ Java\nmRemoteBookManager.asBinder().linkToDeath(mDeathRecipient, 0);\n~~~\n\n#### 2.4 AndroidIPC\n\n- (1)BundleBundleParcelableActivityServiceReceiverIntentBundle\n\n- (2)\n\n  SharedPreferencesSharedPreferencesSharedPreferences\n\n- (3)MessengerMessengerIPCAIDLMessenger\n\n- (4)AIDL\n\n  ServiceAIDLAIDLStubStubServiceonBindService\n\n  - 1.AIDLStringCharSequenceArrayListHashMapParcelableAIDL\n  - 2.AIDLimport\n  - 3.AIDLinoutinout\n  - 4.AIDL\n  - 5.AIDLAIDL\n  - 6.RemoteCallbackListListenerRemoteCallbackListAIDLAIDLIInterface\n\n- (5)ContentProvider\n\n  - 1.ContentProvider\n  - 2.ContentProviderMediaStoreContentProvider\n  - 3.ContentProviderSQLite\n  - 4.ContentProviderContentResolverregisterContentObserver\n\n- (6)Socket\n\n  SocketTCPUDP\n\n#### 2.5 Binder\n\n- (1)ServiceserviceserviceAIDLService\n\n  AIDLBinderServicequeryBinderBinderBinder\n\n  BinderBinderServiceService\n\n- (2)BinderBinderPoolAIDLBinderPool\n\n#### 2.6 IPC\n\n![IPC](http://oui2w5whj.bkt.clouddn.com/blogimages/2016/androidart_ipc.png)\n\n\n\n### 9 \n[amurocrash](http://blog.csdn.net/amurocrash/article/details/48858353)\n\n#### 9.1 \n\n- (1)BroadcastReceiverAndroidManifestAndroidManifestContentProviderIntentIntent\n- (2)ActivityIntent\n- (3)ServiceserviceServiceserviceservice\n- (4)BroadcastReceiverAndroidManifestContext.registerReceiver()BroadcastReceiver\n- (5)ContentProviderContentProviderinsertdeleteupdatequeryBinderContentProvider\n\n#### 9.2 Activity\n\n##### (1)Activity\n![Activity](http://oui2w5whj.bkt.clouddn.com/blogimages/2016/androidart_activity.png)\n\n(2)ApplicationThreadActivityThreadApplicationThreadNativeApplicationThreadNativeBinderIApplicationThreadApplicationThreadNativeAIDL\n(3)ActivityManagerService(AMS)ActivityManagerNativeActivityManagerNativeBinderIActivityManagerBinderAMSBinder\n(4)ApplicationInstrumentationActivity\n(5)ContextImplContextContextImplActivityattachActivityattachActivityWindowWindowwindowActivity [Activitywindow]\n\n#### 9.3 Service\n\n##### (1)Service\n\n****\n![Service1](http://oui2w5whj.bkt.clouddn.com/blogimages/2016/androidart_service1.png)\n\n****\n![Service2](http://oui2w5whj.bkt.clouddn.com/blogimages/2016/androidart_service2.png)\n\n#### 9.4 BroadcastReceiver\n##### (1)BroadcastReceiver\n\n****PackageManagerService\n![broadcastreceiver1](http://oui2w5whj.bkt.clouddn.com/blogimages/2016/androidart_broadcastreceiver1.png)\n****\n![broadcastreceiver2](http://oui2w5whj.bkt.clouddn.com/blogimages/2016/androidart_broadcastreceiver2.png)\n##### (2)\n\n##### (3)\nAndroid 3.1\n\n#### 9.5 ContentProvider\n\n##### (1)ContentProviderAMSonCreateApplicationonCreate\n##### (2)ContentProvider\n- 1.ActivityThreadmainActivityThread\n- 2.ActivityThreadattachActivityManagerServiceattachApplicationApplicationThreadAMSApplicationThreadActivityThreadAMS\n- 3.ActivityManagerServiceattachApplicationApplicationThreadbindApplicationHActivityThreadhandleBindApplication\n- 4.handleBindApplicationApplicationContentProviderContentProviderApplicationonCreate\n\n##### (3)ContentProviderandroid:multiprocessfalsetrueContentProvider\n\n##### (4)ContentProviderinsertdeleteupdatequeryContentProviderContentProviderContentProviderContentProviderquery\n![ContentProvider](http://oui2w5whj.bkt.clouddn.com/blogimages/2016/androidart_contentprovider.png)\n","source":"_posts/2016-03-20-android-books-reading-.md","raw":"---\nlayout: post\ntitle: android\ncategory: accumulation\ntags:\n  - reading\n  - ANDROID\nkeywords: android,\nbanner: http://obxk8w81b.bkt.clouddn.com/Auvers%20Town%20Hall%20on%2014%20July%201890.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Auvers%20Town%20Hall%20on%2014%20July%201890.jpg\n---\n\n\n### 1 Activity\n\nAndroid8ActivityActivity\n\n1 Activity\n\n#### 1.1 Activity\n\n##### 1.1.1 \n\n- (1)ActivityonRestart\n\n- (2)ActivityonPause -> onStopActivityonStopActivityonRestart -> onStart -> onResume\n\n<!--more-->\n\n- (3)onStartonStopActivityonPauseonResumeActivity\n\n- (4)Activity AActivity BonPause(A) -> onCreate(B) -> onStart(B) -> onResume(B) -> onStop(A)onPause\n\n1.1.2 \n\n- (1)onSaveInstanceStateActivityonStoponPause\n\n    ActivityonRestoreInstanceStateonStart\n\n    ActivityonSaveInstanceState\n\n    ActivityActivityActivitylistviewviewviewviewonSaveInstanceStateonRestoreInstanceState\n\n- (2)Activity\n\n    ActivityActivityActivity\n\n- (3)android:configChanges=\"xxx\"\n\n    local\n\n    keyboardHidden\n\n    orientation\n\n    android:configChanges=\"xxx\"ActivityActivityonConfigurationChanged\n\n#### 1.2 Activity\n\n##### 1.2.1 \n\n- (1)Activity\n\n- (2)ActivityContext(ApplicationContextService)standardActivitycontextActivityFLAG_ACTIVITY_NEW_TASK\n\n- (3)Activity\n\n- (4)TaskAffinityActivity\n\n    ActivityTaskAffinitysingleTaskallowTaskReparenting\n\n    TaskAffinitysingleTaskActivityActivityTaskAffinity\n\n    TaskAffinityallowTaskReparentingABActivity CActivity CallowTaskReparentingtrueBActivity CActivity CAB\n\n- (5)singleTask\n\n    singleTaskActivityA\n\n    ActivityActivityActivity.\n\n    ActivityonNewIntent(ActivitysingleTaskFLAG_ACTIVITY_CLEAR_TOP)ActivityActivity\n\n- (6)xmlandroid:launchModeintent.addFlags()ActivityFLAG_ACTIVITY_CLEAR_TOPActivitysingleInstance\n\n##### 1.2.2 ActivityFlags\n\nFLAG_ACTIVITY_NEW_TASK,FLAG_ACTIVITY_SINGLE_TOP,FLAG_ACTIVITY_CLEAR_TOP\n\nFLAG_ACTIVITY_EXCLUDE_FROM_RECENTSActivityActivityActivityandroid:excludeFromRecents=\"true\"\n\n#### 1.3 IntentFilter\n\n- (1)IntentFilteractioncategorydataactioncategorydata\n\n    actioncategorydataactioncategorydataIntentactioncategorydataActivityActivityintent-filterIntentintenf-filterActivity\n~~~ Javascript\n<intent-filter>\n    <action android:name=\"com.ryg.charpter_1.c\" />\n    <action android:name=\"com.ryg.charpter_1.d\" />\n\n    <category android:name=\"com.ryg.category.c\" />\n    <category android:name=\"com.ryg.category.d\" />\n    <category android:name=\"android.intent.category.DEFAULT\" />\n\n    <data android:mimeType=\"text/plain\" />\n</intent-filter>\n~~~  \n\n- (2)action\n\n    Intentactionactionaction\n\n- (3)category\n\n    Intentcategorycategorycategorycategorycategoryandroid.intent.category.DEFAULTActivitycategorycategory\n\n- (4)data\n\n    data\n~~~ Javascript\n<data android:scheme=\"string\"\n\tandroid:host=\"string\"\n\tandroid:port=\"string\"\n\tandroid:path=\"string\"`\n\tandroid:pathPattern=\"string\"\n\tandroid:pathPrefix=\"string\"\n\tandroid:mimeType=\"string\" />\n~~~\n    mimeTypeURImimeTypeURI\n~~~ Javascript\n<scheme>://<host>:<port>/[<path>]|[<pathPrefix>]|[pathPattern]\n~~~\n    content://com.example.project:200/folder/subfolder/etc\n\n  - schemehostportURIschemehostURI\n\n  - pathpathPatternpathPrefixpathpathPrefixpathPattern(\\*)\n\n  dataIntentdatadatadata\n\n  URIscheme\n\n  mimeTypeimage/\\*text/\\*URIURIschemecontentfileschemescheme\n\n~~~ Java\n//URI\n<intent-filter>\n    <data android:mimeType=\"image/*\"/>\n  ...\n</intent-filter>\n~~~\n\n~~~ Java\n//URI\n<intent-filter>\n    <data android:mimeType=\"image/*\" android:scheme=\"http\" .../>\n    ...\n</intent-filter>\n~~~\n\n  IntentdatasetDataAndType\n\n  setDatasetType\n~~~ Java\nintent.setDataAndType(Uri.parse(\"file://abc\"), \"image/png\");\n~~~\n  data\n\n~~~ Java\n<intent-filter>\n    <data android:scheme=\"file\" android:host=\"www.github.com\"/>\n</intent-filter>\n\n<intent-filter>\n    <data android:scheme=\"file\"/>\n    <data android:host=\"www.github.com\"/>\n</intent-filter>\n~~~\n  ActivityIntent\n\n  - (1)PackageManagerresolveActivityIntentresolveActivitynull\n\n  - (2)PackageManagerqueryIntentActivitiesActivity\nServiceBroadcastReceiverPackageManagerqueryIntentServicesqueryBroadcastReceivers\n\n  - actioncategoryActivity\n~~~ Java\n<intent-filter>\n    <action android:name=\"android.intent.action.MAIN\" />\n    <category android:name=\"android.intent.category.LAUNCHER\" />\n</intent-filter>\n~~~\n\n### 2 IPC\n\n#### 2.1 Android IPC\n\n(1)IPCLinuxAndroidBinderIPCSocket\n\n#### 2.2 Android\n\n- (1)android:process.\n\n    packageName::ShareUID\n\n    android:process=\":xyz\" // packageName:xyz\n\n    android:process=\"aaa.bbb.ccc\" // aaa.bbb.ccc\n\n- (2)AndroidUIDUID\n\n    ShareUIDShareUID data\n- (3)android\n\n- (4)\n\n  - 1.\n  - 2.\n  - 3.SharedPreferencesSharedPreferences\n  - 4.ApplicationApplicationApplication\n\n    \n\n#### 2.3 IPC\n\n- (1)SerializableJavaParcelableAndroid\n\n- (2)serialVersionUIdlongserialVersionUIdserialVersionUId\n\n  serialVersionUIdserialVersionUIdserialVersionUIdserialVersionUIdserialVersionUId\n\n  - 1.\n\n  - 2.transient\n\n- (3)ParcelableBinderParcelableIntentBundleBitmapListMapParcelable\n\n~~~ Java\npublic class Book implements Parcelable {\n    public int bookId;\n    public String bookName;\n    public Book() {\n    }\n\n    public Book(int bookId, String bookName) {\n        this.bookId = bookId;\n        this.bookName = bookName;\n    }\n\n    //100\n    public int describeContents() {\n        return 0;\n    }\n\n    //flags0110\n    public void writeToParcel(Parcel out, int flags) {\n        out.writeInt(bookId);\n        out.writeString(bookName);\n    }\n\n    //\n    public static final Parcelable.Creator<Book> CREATOR = new Parcelable.Creator<Book>() {\n        //\n        public Book createFromParcel(Parcel in) {\n            return new Book(in);\n        }\n        public Book[] newArray(int size) {//\n            return new Book[size];\n        }\n    };\n\n    private Book(Parcel in) {\n        bookId = in.readInt();\n        bookName = in.readString();\n    }\n\n}\n~~~\n\n- (4)BinderAndroidIBinder\n\n  IPCBinderAndroidBinder/dev/binder\n\n  FrameworkBinderServiceManagerManagerManagerService\n\n  AndroidBinderbindServiceBinderBinderAIDL\n\n\n  AndroidBinderServiceAIDLMessengerServiceBinderMessengerAIDLBinder\n\n- (5)aidlaidljava\n\n  ididtransact\n\n  StubStubBindertransacttransactStubProxy\n\n  StubStubProxy \n\n  - 1.asInterface(android.os.IBinder obj)BinderAIDLStubStub.Proxy\n  - 2.asBinderBinder\n  - 3.onTransactBinder\n\n    public Boolean onTransact(int code, Parcelable data, Parcelable reply, int flags)\n\n    codedatareplyfalse()\n\n  - 4.Proxy#[Method]\n\n    _datatransactRPConTransactRPC_replyRPC_reply\n\n  AIDLBinder[](https://github.com/singwhatiwanna/android-art-res/blob/master/Chapter_2/src/com/ryg/chapter_2/manualbinder/BookManagerImpl.java)\n\n- (6)BinderlinkToDeathunlinkToDeath\n\n  BinderBinderlinkToDeathunlinkToDeathlinkToDeathBinderBinder\n\n  Binder\n\n  - 1.DeathRecipientDeathRecipientbindeDiedBinder\n\n~~~ Java\nprivate IBinder.DeathRecipient mDeathRecipient = new IBinder.DeathRecipient() {\n    @Override\n    public void binderDied() {\n        if (mRemoteBookManager == null) return;\n        mRemoteBookManager.asBinder().unlinkToDeath(mDeathRecipient, 0);\n        mRemoteBookManager = null;\n        // TODO:Service\n    }\n};\n~~~\n  - 2.binder\n\n~~~ Java\nmRemoteBookManager.asBinder().linkToDeath(mDeathRecipient, 0);\n~~~\n\n#### 2.4 AndroidIPC\n\n- (1)BundleBundleParcelableActivityServiceReceiverIntentBundle\n\n- (2)\n\n  SharedPreferencesSharedPreferencesSharedPreferences\n\n- (3)MessengerMessengerIPCAIDLMessenger\n\n- (4)AIDL\n\n  ServiceAIDLAIDLStubStubServiceonBindService\n\n  - 1.AIDLStringCharSequenceArrayListHashMapParcelableAIDL\n  - 2.AIDLimport\n  - 3.AIDLinoutinout\n  - 4.AIDL\n  - 5.AIDLAIDL\n  - 6.RemoteCallbackListListenerRemoteCallbackListAIDLAIDLIInterface\n\n- (5)ContentProvider\n\n  - 1.ContentProvider\n  - 2.ContentProviderMediaStoreContentProvider\n  - 3.ContentProviderSQLite\n  - 4.ContentProviderContentResolverregisterContentObserver\n\n- (6)Socket\n\n  SocketTCPUDP\n\n#### 2.5 Binder\n\n- (1)ServiceserviceserviceAIDLService\n\n  AIDLBinderServicequeryBinderBinderBinder\n\n  BinderBinderServiceService\n\n- (2)BinderBinderPoolAIDLBinderPool\n\n#### 2.6 IPC\n\n![IPC](http://oui2w5whj.bkt.clouddn.com/blogimages/2016/androidart_ipc.png)\n\n\n\n### 9 \n[amurocrash](http://blog.csdn.net/amurocrash/article/details/48858353)\n\n#### 9.1 \n\n- (1)BroadcastReceiverAndroidManifestAndroidManifestContentProviderIntentIntent\n- (2)ActivityIntent\n- (3)ServiceserviceServiceserviceservice\n- (4)BroadcastReceiverAndroidManifestContext.registerReceiver()BroadcastReceiver\n- (5)ContentProviderContentProviderinsertdeleteupdatequeryBinderContentProvider\n\n#### 9.2 Activity\n\n##### (1)Activity\n![Activity](http://oui2w5whj.bkt.clouddn.com/blogimages/2016/androidart_activity.png)\n\n(2)ApplicationThreadActivityThreadApplicationThreadNativeApplicationThreadNativeBinderIApplicationThreadApplicationThreadNativeAIDL\n(3)ActivityManagerService(AMS)ActivityManagerNativeActivityManagerNativeBinderIActivityManagerBinderAMSBinder\n(4)ApplicationInstrumentationActivity\n(5)ContextImplContextContextImplActivityattachActivityattachActivityWindowWindowwindowActivity [Activitywindow]\n\n#### 9.3 Service\n\n##### (1)Service\n\n****\n![Service1](http://oui2w5whj.bkt.clouddn.com/blogimages/2016/androidart_service1.png)\n\n****\n![Service2](http://oui2w5whj.bkt.clouddn.com/blogimages/2016/androidart_service2.png)\n\n#### 9.4 BroadcastReceiver\n##### (1)BroadcastReceiver\n\n****PackageManagerService\n![broadcastreceiver1](http://oui2w5whj.bkt.clouddn.com/blogimages/2016/androidart_broadcastreceiver1.png)\n****\n![broadcastreceiver2](http://oui2w5whj.bkt.clouddn.com/blogimages/2016/androidart_broadcastreceiver2.png)\n##### (2)\n\n##### (3)\nAndroid 3.1\n\n#### 9.5 ContentProvider\n\n##### (1)ContentProviderAMSonCreateApplicationonCreate\n##### (2)ContentProvider\n- 1.ActivityThreadmainActivityThread\n- 2.ActivityThreadattachActivityManagerServiceattachApplicationApplicationThreadAMSApplicationThreadActivityThreadAMS\n- 3.ActivityManagerServiceattachApplicationApplicationThreadbindApplicationHActivityThreadhandleBindApplication\n- 4.handleBindApplicationApplicationContentProviderContentProviderApplicationonCreate\n\n##### (3)ContentProviderandroid:multiprocessfalsetrueContentProvider\n\n##### (4)ContentProviderinsertdeleteupdatequeryContentProviderContentProviderContentProviderContentProviderquery\n![ContentProvider](http://oui2w5whj.bkt.clouddn.com/blogimages/2016/androidart_contentprovider.png)\n","slug":"android-books-reading-","published":1,"date":"2016-03-19T16:00:00.000Z","updated":"2017-11-23T07:24:03.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ebwb000fd6ykr7v031ya","content":"<h3 id=\"1-Activity\"><a href=\"#1-Activity\" class=\"headerlink\" title=\"1 Activity\"></a>1 Activity</h3><p>Android8ActivityActivity</p>\n<p>1 Activity</p>\n<h4 id=\"1-1-Activity\"><a href=\"#1-1-Activity\" class=\"headerlink\" title=\"1.1 Activity\"></a>1.1 Activity</h4><h5 id=\"1-1-1-\"><a href=\"#1-1-1-\" class=\"headerlink\" title=\"1.1.1 \"></a>1.1.1 </h5><ul>\n<li><p>(1)ActivityonRestart</p>\n</li>\n<li><p>(2)ActivityonPause -&gt; onStopActivityonStopActivityonRestart -&gt; onStart -&gt; onResume</p>\n</li>\n</ul>\n<a id=\"more\"></a>\n<ul>\n<li><p>(3)onStartonStopActivityonPauseonResumeActivity</p>\n</li>\n<li><p>(4)Activity AActivity BonPause(A) -&gt; onCreate(B) -&gt; onStart(B) -&gt; onResume(B) -&gt; onStop(A)onPause</p>\n</li>\n</ul>\n<p>1.1.2 </p>\n<ul>\n<li><p>(1)onSaveInstanceStateActivityonStoponPause</p>\n<p>  ActivityonRestoreInstanceStateonStart</p>\n<p>  ActivityonSaveInstanceState</p>\n<p>  ActivityActivityActivitylistviewviewviewviewonSaveInstanceStateonRestoreInstanceState</p>\n</li>\n<li><p>(2)Activity</p>\n<p>  ActivityActivityActivity</p>\n</li>\n<li><p>(3)android:configChanges=xxx</p>\n<p>  local</p>\n<p>  keyboardHidden</p>\n<p>  orientation</p>\n<p>  android:configChanges=xxxActivityActivityonConfigurationChanged</p>\n</li>\n</ul>\n<h4 id=\"1-2-Activity\"><a href=\"#1-2-Activity\" class=\"headerlink\" title=\"1.2 Activity\"></a>1.2 Activity</h4><h5 id=\"1-2-1-\"><a href=\"#1-2-1-\" class=\"headerlink\" title=\"1.2.1 \"></a>1.2.1 </h5><ul>\n<li><p>(1)Activity</p>\n</li>\n<li><p>(2)ActivityContext(ApplicationContextService)standardActivitycontextActivityFLAG_ACTIVITY_NEW_TASK</p>\n</li>\n<li><p>(3)Activity</p>\n</li>\n<li><p>(4)TaskAffinityActivity</p>\n<p>  ActivityTaskAffinitysingleTaskallowTaskReparenting</p>\n<p>  TaskAffinitysingleTaskActivityActivityTaskAffinity</p>\n<p>  TaskAffinityallowTaskReparentingABActivity CActivity CallowTaskReparentingtrueBActivity CActivity CAB</p>\n</li>\n<li><p>(5)singleTask</p>\n<p>  singleTaskActivityA</p>\n<p>  ActivityActivityActivity.</p>\n<p>  ActivityonNewIntent(ActivitysingleTaskFLAG_ACTIVITY_CLEAR_TOP)ActivityActivity</p>\n</li>\n<li><p>(6)xmlandroid:launchModeintent.addFlags()ActivityFLAG_ACTIVITY_CLEAR_TOPActivitysingleInstance</p>\n</li>\n</ul>\n<h5 id=\"1-2-2-ActivityFlags\"><a href=\"#1-2-2-ActivityFlags\" class=\"headerlink\" title=\"1.2.2 ActivityFlags\"></a>1.2.2 ActivityFlags</h5><p>FLAG_ACTIVITY_NEW_TASK,FLAG_ACTIVITY_SINGLE_TOP,FLAG_ACTIVITY_CLEAR_TOP</p>\n<p>FLAG_ACTIVITY_EXCLUDE_FROM_RECENTSActivityActivityActivityandroid:excludeFromRecents=true</p>\n<h4 id=\"1-3-IntentFilter\"><a href=\"#1-3-IntentFilter\" class=\"headerlink\" title=\"1.3 IntentFilter\"></a>1.3 IntentFilter</h4><ul>\n<li><p>(1)IntentFilteractioncategorydataactioncategorydata</p>\n<p>  actioncategorydataactioncategorydataIntentactioncategorydataActivityActivityintent-filterIntentintenf-filterActivity</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;intent-filter&gt;</div><div class=\"line\">    &lt;action android:name=\"com.ryg.charpter_1.c\" /&gt;</div><div class=\"line\">    &lt;action android:name=\"com.ryg.charpter_1.d\" /&gt;</div><div class=\"line\"></div><div class=\"line\">    &lt;category android:name=\"com.ryg.category.c\" /&gt;</div><div class=\"line\">    &lt;category android:name=\"com.ryg.category.d\" /&gt;</div><div class=\"line\">    &lt;category android:name=\"android.intent.category.DEFAULT\" /&gt;</div><div class=\"line\"></div><div class=\"line\">    &lt;data android:mimeType=\"text/plain\" /&gt;</div><div class=\"line\">&lt;/intent-filter&gt;</div><div class=\"line\">~~~  </div><div class=\"line\"></div><div class=\"line\">- (2)action</div><div class=\"line\"></div><div class=\"line\">    Intentactionactionaction</div><div class=\"line\"></div><div class=\"line\">- (3)category</div><div class=\"line\"></div><div class=\"line\">    Intentcategorycategorycategorycategorycategoryandroid.intent.category.DEFAULTActivitycategorycategory</div><div class=\"line\"></div><div class=\"line\">- (4)data</div><div class=\"line\"></div><div class=\"line\">    data</div><div class=\"line\">~~~ Javascript</div><div class=\"line\">&lt;data android:scheme=\"string\"</div><div class=\"line\">\tandroid:host=\"string\"</div><div class=\"line\">\tandroid:port=\"string\"</div><div class=\"line\">\tandroid:path=\"string\"`</div><div class=\"line\">\tandroid:pathPattern=\"string\"</div><div class=\"line\">\tandroid:pathPrefix=\"string\"</div><div class=\"line\">\tandroid:mimeType=\"string\" /&gt;</div></pre></td></tr></table></figure>\n<p>  mimeTypeURImimeTypeURI</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;scheme&gt;:<span class=\"comment\">//&lt;host&gt;:&lt;port&gt;/[&lt;path&gt;]|[&lt;pathPrefix&gt;]|[pathPattern]</span></div></pre></td></tr></table></figure>\n<p>  content://com.example.project:200/folder/subfolder/etc</p>\n<ul>\n<li><p>schemehostportURIschemehostURI</p>\n</li>\n<li><p>pathpathPatternpathPrefixpathpathPrefixpathPattern(*)</p>\n</li>\n</ul>\n<p>dataIntentdatadatadata</p>\n<p>URIscheme</p>\n<p>mimeTypeimage/*text/*URIURIschemecontentfileschemescheme</p>\n</li>\n</ul>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><div class=\"line\">//URI</div><div class=\"line\">&lt;intent-filter&gt;</div><div class=\"line\">    &lt;data android:mimeType=\"image/*\"/&gt;</div><div class=\"line\">  ...</div><div class=\"line\">&lt;/intent-filter&gt;</div></pre></td></tr></table></figure>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><div class=\"line\">//URI</div><div class=\"line\">&lt;intent-filter&gt;</div><div class=\"line\">    &lt;data android:mimeType=\"image/*\" android:scheme=\"http\" .../&gt;</div><div class=\"line\">    ...</div><div class=\"line\">&lt;/intent-filter&gt;</div></pre></td></tr></table></figure>\n<p>  IntentdatasetDataAndType</p>\n<p>  setDatasetType<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">intent.setDataAndType(Uri.parse(<span class=\"string\">\"file://abc\"</span>), <span class=\"string\">\"image/png\"</span>);</div></pre></td></tr></table></figure></p>\n<p>  data</p>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;intent-filter&gt;</div><div class=\"line\">    &lt;data android:scheme=\"file\" android:host=\"www.github.com\"/&gt;</div><div class=\"line\">&lt;/intent-filter&gt;</div><div class=\"line\"></div><div class=\"line\">&lt;intent-filter&gt;</div><div class=\"line\">    &lt;data android:scheme=\"file\"/&gt;</div><div class=\"line\">    &lt;data android:host=\"www.github.com\"/&gt;</div><div class=\"line\">&lt;/intent-filter&gt;</div></pre></td></tr></table></figure>\n<p>  ActivityIntent</p>\n<ul>\n<li><p>(1)PackageManagerresolveActivityIntentresolveActivitynull</p>\n</li>\n<li><p>(2)PackageManagerqueryIntentActivitiesActivity<br>ServiceBroadcastReceiverPackageManagerqueryIntentServicesqueryBroadcastReceivers</p>\n</li>\n<li><p>actioncategoryActivity</p>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;intent-filter&gt;</div><div class=\"line\">    &lt;action android:name=\"android.intent.action.MAIN\" /&gt;</div><div class=\"line\">    &lt;category android:name=\"android.intent.category.LAUNCHER\" /&gt;</div><div class=\"line\">&lt;/intent-filter&gt;</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<h3 id=\"2-IPC\"><a href=\"#2-IPC\" class=\"headerlink\" title=\"2 IPC\"></a>2 IPC</h3><h4 id=\"2-1-Android-IPC\"><a href=\"#2-1-Android-IPC\" class=\"headerlink\" title=\"2.1 Android IPC\"></a>2.1 Android IPC</h4><p>(1)IPCLinuxAndroidBinderIPCSocket</p>\n<h4 id=\"2-2-Android\"><a href=\"#2-2-Android\" class=\"headerlink\" title=\"2.2 Android\"></a>2.2 Android</h4><ul>\n<li><p>(1)android:process.</p>\n<p>  packageName::ShareUID</p>\n<p>  android:process=:xyz // packageName:xyz</p>\n<p>  android:process=aaa.bbb.ccc // aaa.bbb.ccc</p>\n</li>\n<li><p>(2)AndroidUIDUID</p>\n<p>  ShareUIDShareUID data</p>\n</li>\n<li><p>(3)android</p>\n</li>\n<li><p>(4)</p>\n<ul>\n<li>1.</li>\n<li>2.</li>\n<li>3.SharedPreferencesSharedPreferences</li>\n<li><p>4.ApplicationApplicationApplication</p>\n<p></p>\n</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"2-3-IPC\"><a href=\"#2-3-IPC\" class=\"headerlink\" title=\"2.3 IPC\"></a>2.3 IPC</h4><ul>\n<li><p>(1)SerializableJavaParcelableAndroid</p>\n</li>\n<li><p>(2)serialVersionUIdlongserialVersionUIdserialVersionUId</p>\n<p>serialVersionUIdserialVersionUIdserialVersionUIdserialVersionUIdserialVersionUId</p>\n<ul>\n<li><p>1.</p>\n</li>\n<li><p>2.transient</p>\n</li>\n</ul>\n</li>\n<li><p>(3)ParcelableBinderParcelableIntentBundleBitmapListMapParcelable</p>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Book</span> <span class=\"keyword\">implements</span> <span class=\"title\">Parcelable</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">int</span> bookId;</div><div class=\"line\">    <span class=\"keyword\">public</span> String bookName;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Book</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Book</span><span class=\"params\">(<span class=\"keyword\">int</span> bookId, String bookName)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">this</span>.bookId = bookId;</div><div class=\"line\">        <span class=\"keyword\">this</span>.bookName = bookName;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//100</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">describeContents</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//flags0110</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">writeToParcel</span><span class=\"params\">(Parcel out, <span class=\"keyword\">int</span> flags)</span> </span>&#123;</div><div class=\"line\">        out.writeInt(bookId);</div><div class=\"line\">        out.writeString(bookName);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//</span></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Parcelable.Creator&lt;Book&gt; CREATOR = <span class=\"keyword\">new</span> Parcelable.Creator&lt;Book&gt;() &#123;</div><div class=\"line\">        <span class=\"comment\">//</span></div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> Book <span class=\"title\">createFromParcel</span><span class=\"params\">(Parcel in)</span> </span>&#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Book(in);</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">public</span> Book[] newArray(<span class=\"keyword\">int</span> size) &#123;<span class=\"comment\">//</span></div><div class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Book[size];</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Book</span><span class=\"params\">(Parcel in)</span> </span>&#123;</div><div class=\"line\">        bookId = in.readInt();</div><div class=\"line\">        bookName = in.readString();</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<ul>\n<li><p>(4)BinderAndroidIBinder</p>\n<p>IPCBinderAndroidBinder/dev/binder</p>\n<p>FrameworkBinderServiceManagerManagerManagerService</p>\n<p>AndroidBinderbindServiceBinderBinderAIDL</p>\n</li>\n</ul>\n<p>  AndroidBinderServiceAIDLMessengerServiceBinderMessengerAIDLBinder</p>\n<ul>\n<li><p>(5)aidlaidljava</p>\n<p>ididtransact</p>\n<p>StubStubBindertransacttransactStubProxy</p>\n<p>StubStubProxy </p>\n<ul>\n<li>1.asInterface(android.os.IBinder obj)BinderAIDLStubStub.Proxy</li>\n<li>2.asBinderBinder</li>\n<li><p>3.onTransactBinder</p>\n<p>public Boolean onTransact(int code, Parcelable data, Parcelable reply, int flags)</p>\n<p>codedatareplyfalse()</p>\n</li>\n<li><p>4.Proxy#[Method]</p>\n<p>_datatransactRPConTransactRPC_replyRPC_reply</p>\n</li>\n</ul>\n<p>AIDLBinder<a href=\"https://github.com/singwhatiwanna/android-art-res/blob/master/Chapter_2/src/com/ryg/chapter_2/manualbinder/BookManagerImpl.java\" target=\"_blank\" rel=\"external\"></a></p>\n</li>\n<li><p>(6)BinderlinkToDeathunlinkToDeath</p>\n<p>BinderBinderlinkToDeathunlinkToDeathlinkToDeathBinderBinder</p>\n<p>Binder</p>\n<ul>\n<li>1.DeathRecipientDeathRecipientbindeDiedBinder</li>\n</ul>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">private</span> IBinder.DeathRecipient mDeathRecipient = <span class=\"keyword\">new</span> IBinder.DeathRecipient() &#123;</div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">binderDied</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (mRemoteBookManager == <span class=\"keyword\">null</span>) <span class=\"keyword\">return</span>;</div><div class=\"line\">        mRemoteBookManager.asBinder().unlinkToDeath(mDeathRecipient, <span class=\"number\">0</span>);</div><div class=\"line\">        mRemoteBookManager = <span class=\"keyword\">null</span>;</div><div class=\"line\">        <span class=\"comment\">// <span class=\"doctag\">TODO:</span>Service</span></div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure>\n<ul>\n<li>2.binder</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">mRemoteBookManager.asBinder().linkToDeath(mDeathRecipient, <span class=\"number\">0</span>);</div></pre></td></tr></table></figure>\n<h4 id=\"2-4-AndroidIPC\"><a href=\"#2-4-AndroidIPC\" class=\"headerlink\" title=\"2.4 AndroidIPC\"></a>2.4 AndroidIPC</h4><ul>\n<li><p>(1)BundleBundleParcelableActivityServiceReceiverIntentBundle</p>\n</li>\n<li><p>(2)</p>\n<p>SharedPreferencesSharedPreferencesSharedPreferences</p>\n</li>\n<li><p>(3)MessengerMessengerIPCAIDLMessenger</p>\n</li>\n<li><p>(4)AIDL</p>\n<p>ServiceAIDLAIDLStubStubServiceonBindService</p>\n<ul>\n<li>1.AIDLStringCharSequenceArrayListHashMapParcelableAIDL</li>\n<li>2.AIDLimport</li>\n<li>3.AIDLinoutinout</li>\n<li>4.AIDL</li>\n<li>5.AIDLAIDL</li>\n<li>6.RemoteCallbackListListenerRemoteCallbackListAIDLAIDLIInterface</li>\n</ul>\n</li>\n<li><p>(5)ContentProvider</p>\n<ul>\n<li>1.ContentProvider</li>\n<li>2.ContentProviderMediaStoreContentProvider</li>\n<li>3.ContentProviderSQLite</li>\n<li>4.ContentProviderContentResolverregisterContentObserver</li>\n</ul>\n</li>\n<li><p>(6)Socket</p>\n<p>SocketTCPUDP</p>\n</li>\n</ul>\n<h4 id=\"2-5-Binder\"><a href=\"#2-5-Binder\" class=\"headerlink\" title=\"2.5 Binder\"></a>2.5 Binder</h4><ul>\n<li><p>(1)ServiceserviceserviceAIDLService</p>\n<p>AIDLBinderServicequeryBinderBinderBinder</p>\n<p>BinderBinderServiceService</p>\n</li>\n<li><p>(2)BinderBinderPoolAIDLBinderPool</p>\n</li>\n</ul>\n<h4 id=\"2-6-IPC\"><a href=\"#2-6-IPC\" class=\"headerlink\" title=\"2.6 IPC\"></a>2.6 IPC</h4><p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2016/androidart_ipc.png\" alt=\"IPC\"></p>\n<h3 id=\"9-\"><a href=\"#9-\" class=\"headerlink\" title=\"9 \"></a>9 </h3><p><a href=\"http://blog.csdn.net/amurocrash/article/details/48858353\" target=\"_blank\" rel=\"external\">amurocrash</a></p>\n<h4 id=\"9-1-\"><a href=\"#9-1-\" class=\"headerlink\" title=\"9.1 \"></a>9.1 </h4><ul>\n<li>(1)BroadcastReceiverAndroidManifestAndroidManifestContentProviderIntentIntent</li>\n<li>(2)ActivityIntent</li>\n<li>(3)ServiceserviceServiceserviceservice</li>\n<li>(4)BroadcastReceiverAndroidManifestContext.registerReceiver()BroadcastReceiver</li>\n<li>(5)ContentProviderContentProviderinsertdeleteupdatequeryBinderContentProvider</li>\n</ul>\n<h4 id=\"9-2-Activity\"><a href=\"#9-2-Activity\" class=\"headerlink\" title=\"9.2 Activity\"></a>9.2 Activity</h4><h5 id=\"1-Activity\"><a href=\"#1-Activity\" class=\"headerlink\" title=\"(1)Activity\"></a>(1)Activity</h5><p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2016/androidart_activity.png\" alt=\"Activity\"></p>\n<p>(2)ApplicationThreadActivityThreadApplicationThreadNativeApplicationThreadNativeBinderIApplicationThreadApplicationThreadNativeAIDL<br>(3)ActivityManagerService(AMS)ActivityManagerNativeActivityManagerNativeBinderIActivityManagerBinderAMSBinder<br>(4)ApplicationInstrumentationActivity<br>(5)ContextImplContextContextImplActivityattachActivityattachActivityWindowWindowwindowActivity [Activitywindow]</p>\n<h4 id=\"9-3-Service\"><a href=\"#9-3-Service\" class=\"headerlink\" title=\"9.3 Service\"></a>9.3 Service</h4><h5 id=\"1-Service\"><a href=\"#1-Service\" class=\"headerlink\" title=\"(1)Service\"></a>(1)Service</h5><p><br><strong></strong><br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2016/androidart_service1.png\" alt=\"Service1\"></p>\n<p><strong></strong><br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2016/androidart_service2.png\" alt=\"Service2\"></p>\n<h4 id=\"9-4-BroadcastReceiver\"><a href=\"#9-4-BroadcastReceiver\" class=\"headerlink\" title=\"9.4 BroadcastReceiver\"></a>9.4 BroadcastReceiver</h4><h5 id=\"1-BroadcastReceiver\"><a href=\"#1-BroadcastReceiver\" class=\"headerlink\" title=\"(1)BroadcastReceiver\"></a>(1)BroadcastReceiver</h5><p><strong></strong>PackageManagerService<br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2016/androidart_broadcastreceiver1.png\" alt=\"broadcastreceiver1\"><br><strong></strong><br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2016/androidart_broadcastreceiver2.png\" alt=\"broadcastreceiver2\"></p>\n<h5 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"(2)\"></a>(2)</h5><p></p>\n<h5 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"(3)\"></a>(3)</h5><p>Android 3.1</p>\n<h4 id=\"9-5-ContentProvider\"><a href=\"#9-5-ContentProvider\" class=\"headerlink\" title=\"9.5 ContentProvider\"></a>9.5 ContentProvider</h4><h5 id=\"1-ContentProviderAMSonCreateApplicationonCreate\"><a href=\"#1-ContentProviderAMSonCreateApplicationonCreate\" class=\"headerlink\" title=\"(1)ContentProviderAMSonCreateApplicationonCreate\"></a>(1)ContentProviderAMSonCreateApplicationonCreate</h5><h5 id=\"2-ContentProvider\"><a href=\"#2-ContentProvider\" class=\"headerlink\" title=\"(2)ContentProvider\"></a>(2)ContentProvider</h5><ul>\n<li>1.ActivityThreadmainActivityThread</li>\n<li>2.ActivityThreadattachActivityManagerServiceattachApplicationApplicationThreadAMSApplicationThreadActivityThreadAMS</li>\n<li>3.ActivityManagerServiceattachApplicationApplicationThreadbindApplicationHActivityThreadhandleBindApplication</li>\n<li>4.handleBindApplicationApplicationContentProviderContentProviderApplicationonCreate</li>\n</ul>\n<h5 id=\"3-ContentProviderandroid-multiprocessfalsetrueContentProvider\"><a href=\"#3-ContentProviderandroid-multiprocessfalsetrueContentProvider\" class=\"headerlink\" title=\"(3)ContentProviderandroid:multiprocessfalsetrueContentProvider\"></a>(3)ContentProviderandroid:multiprocessfalsetrueContentProvider</h5><h5 id=\"4-ContentProviderinsertdeleteupdatequeryContentProviderContentProviderContentProviderContentProviderquery\"><a href=\"#4-ContentProviderinsertdeleteupdatequeryContentProviderContentProviderContentProviderContentProviderquery\" class=\"headerlink\" title=\"(4)ContentProviderinsertdeleteupdatequeryContentProviderContentProviderContentProviderContentProviderquery\"></a>(4)ContentProviderinsertdeleteupdatequeryContentProviderContentProviderContentProviderContentProviderquery</h5><p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2016/androidart_contentprovider.png\" alt=\"ContentProvider\"></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/03/20/android-books-reading-/\">http://agehua.github.io/2016/03/20/android-books-reading-/</a></p>\n","readingTime":{"text":"4 min read","minutes":3.655,"time":219299.99999999997,"words":731},"excerpt":"<h3 id=\"1-Activity\"><a href=\"#1-Activity\" class=\"headerlink\" title=\"1 Activity\"></a>1 Activity</h3><p>Android8ActivityActivity</p>\n<p>1 Activity</p>\n<h4 id=\"1-1-Activity\"><a href=\"#1-1-Activity\" class=\"headerlink\" title=\"1.1 Activity\"></a>1.1 Activity</h4><h5 id=\"1-1-1-\"><a href=\"#1-1-1-\" class=\"headerlink\" title=\"1.1.1 \"></a>1.1.1 </h5><ul>\n<li><p>(1)ActivityonRestart</p>\n</li>\n<li><p>(2)ActivityonPause -&gt; onStopActivityonStopActivityonRestart -&gt; onStart -&gt; onResume</p>\n</li>\n</ul>","more":"<ul>\n<li><p>(3)onStartonStopActivityonPauseonResumeActivity</p>\n</li>\n<li><p>(4)Activity AActivity BonPause(A) -&gt; onCreate(B) -&gt; onStart(B) -&gt; onResume(B) -&gt; onStop(A)onPause</p>\n</li>\n</ul>\n<p>1.1.2 </p>\n<ul>\n<li><p>(1)onSaveInstanceStateActivityonStoponPause</p>\n<p>  ActivityonRestoreInstanceStateonStart</p>\n<p>  ActivityonSaveInstanceState</p>\n<p>  ActivityActivityActivitylistviewviewviewviewonSaveInstanceStateonRestoreInstanceState</p>\n</li>\n<li><p>(2)Activity</p>\n<p>  ActivityActivityActivity</p>\n</li>\n<li><p>(3)android:configChanges=xxx</p>\n<p>  local</p>\n<p>  keyboardHidden</p>\n<p>  orientation</p>\n<p>  android:configChanges=xxxActivityActivityonConfigurationChanged</p>\n</li>\n</ul>\n<h4 id=\"1-2-Activity\"><a href=\"#1-2-Activity\" class=\"headerlink\" title=\"1.2 Activity\"></a>1.2 Activity</h4><h5 id=\"1-2-1-\"><a href=\"#1-2-1-\" class=\"headerlink\" title=\"1.2.1 \"></a>1.2.1 </h5><ul>\n<li><p>(1)Activity</p>\n</li>\n<li><p>(2)ActivityContext(ApplicationContextService)standardActivitycontextActivityFLAG_ACTIVITY_NEW_TASK</p>\n</li>\n<li><p>(3)Activity</p>\n</li>\n<li><p>(4)TaskAffinityActivity</p>\n<p>  ActivityTaskAffinitysingleTaskallowTaskReparenting</p>\n<p>  TaskAffinitysingleTaskActivityActivityTaskAffinity</p>\n<p>  TaskAffinityallowTaskReparentingABActivity CActivity CallowTaskReparentingtrueBActivity CActivity CAB</p>\n</li>\n<li><p>(5)singleTask</p>\n<p>  singleTaskActivityA</p>\n<p>  ActivityActivityActivity.</p>\n<p>  ActivityonNewIntent(ActivitysingleTaskFLAG_ACTIVITY_CLEAR_TOP)ActivityActivity</p>\n</li>\n<li><p>(6)xmlandroid:launchModeintent.addFlags()ActivityFLAG_ACTIVITY_CLEAR_TOPActivitysingleInstance</p>\n</li>\n</ul>\n<h5 id=\"1-2-2-ActivityFlags\"><a href=\"#1-2-2-ActivityFlags\" class=\"headerlink\" title=\"1.2.2 ActivityFlags\"></a>1.2.2 ActivityFlags</h5><p>FLAG_ACTIVITY_NEW_TASK,FLAG_ACTIVITY_SINGLE_TOP,FLAG_ACTIVITY_CLEAR_TOP</p>\n<p>FLAG_ACTIVITY_EXCLUDE_FROM_RECENTSActivityActivityActivityandroid:excludeFromRecents=true</p>\n<h4 id=\"1-3-IntentFilter\"><a href=\"#1-3-IntentFilter\" class=\"headerlink\" title=\"1.3 IntentFilter\"></a>1.3 IntentFilter</h4><ul>\n<li><p>(1)IntentFilteractioncategorydataactioncategorydata</p>\n<p>  actioncategorydataactioncategorydataIntentactioncategorydataActivityActivityintent-filterIntentintenf-filterActivity</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;intent-filter&gt;</div><div class=\"line\">    &lt;action android:name=\"com.ryg.charpter_1.c\" /&gt;</div><div class=\"line\">    &lt;action android:name=\"com.ryg.charpter_1.d\" /&gt;</div><div class=\"line\"></div><div class=\"line\">    &lt;category android:name=\"com.ryg.category.c\" /&gt;</div><div class=\"line\">    &lt;category android:name=\"com.ryg.category.d\" /&gt;</div><div class=\"line\">    &lt;category android:name=\"android.intent.category.DEFAULT\" /&gt;</div><div class=\"line\"></div><div class=\"line\">    &lt;data android:mimeType=\"text/plain\" /&gt;</div><div class=\"line\">&lt;/intent-filter&gt;</div><div class=\"line\">~~~  </div><div class=\"line\"></div><div class=\"line\">- (2)action</div><div class=\"line\"></div><div class=\"line\">    Intentactionactionaction</div><div class=\"line\"></div><div class=\"line\">- (3)category</div><div class=\"line\"></div><div class=\"line\">    Intentcategorycategorycategorycategorycategoryandroid.intent.category.DEFAULTActivitycategorycategory</div><div class=\"line\"></div><div class=\"line\">- (4)data</div><div class=\"line\"></div><div class=\"line\">    data</div><div class=\"line\">~~~ Javascript</div><div class=\"line\">&lt;data android:scheme=\"string\"</div><div class=\"line\">\tandroid:host=\"string\"</div><div class=\"line\">\tandroid:port=\"string\"</div><div class=\"line\">\tandroid:path=\"string\"`</div><div class=\"line\">\tandroid:pathPattern=\"string\"</div><div class=\"line\">\tandroid:pathPrefix=\"string\"</div><div class=\"line\">\tandroid:mimeType=\"string\" /&gt;</div></pre></td></tr></table></figure>\n<p>  mimeTypeURImimeTypeURI</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;scheme&gt;:<span class=\"comment\">//&lt;host&gt;:&lt;port&gt;/[&lt;path&gt;]|[&lt;pathPrefix&gt;]|[pathPattern]</span></div></pre></td></tr></table></figure>\n<p>  content://com.example.project:200/folder/subfolder/etc</p>\n<ul>\n<li><p>schemehostportURIschemehostURI</p>\n</li>\n<li><p>pathpathPatternpathPrefixpathpathPrefixpathPattern(*)</p>\n</li>\n</ul>\n<p>dataIntentdatadatadata</p>\n<p>URIscheme</p>\n<p>mimeTypeimage/*text/*URIURIschemecontentfileschemescheme</p>\n</li>\n</ul>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><div class=\"line\">//URI</div><div class=\"line\">&lt;intent-filter&gt;</div><div class=\"line\">    &lt;data android:mimeType=\"image/*\"/&gt;</div><div class=\"line\">  ...</div><div class=\"line\">&lt;/intent-filter&gt;</div></pre></td></tr></table></figure>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><div class=\"line\">//URI</div><div class=\"line\">&lt;intent-filter&gt;</div><div class=\"line\">    &lt;data android:mimeType=\"image/*\" android:scheme=\"http\" .../&gt;</div><div class=\"line\">    ...</div><div class=\"line\">&lt;/intent-filter&gt;</div></pre></td></tr></table></figure>\n<p>  IntentdatasetDataAndType</p>\n<p>  setDatasetType<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">intent.setDataAndType(Uri.parse(<span class=\"string\">\"file://abc\"</span>), <span class=\"string\">\"image/png\"</span>);</div></pre></td></tr></table></figure></p>\n<p>  data</p>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;intent-filter&gt;</div><div class=\"line\">    &lt;data android:scheme=\"file\" android:host=\"www.github.com\"/&gt;</div><div class=\"line\">&lt;/intent-filter&gt;</div><div class=\"line\"></div><div class=\"line\">&lt;intent-filter&gt;</div><div class=\"line\">    &lt;data android:scheme=\"file\"/&gt;</div><div class=\"line\">    &lt;data android:host=\"www.github.com\"/&gt;</div><div class=\"line\">&lt;/intent-filter&gt;</div></pre></td></tr></table></figure>\n<p>  ActivityIntent</p>\n<ul>\n<li><p>(1)PackageManagerresolveActivityIntentresolveActivitynull</p>\n</li>\n<li><p>(2)PackageManagerqueryIntentActivitiesActivity<br>ServiceBroadcastReceiverPackageManagerqueryIntentServicesqueryBroadcastReceivers</p>\n</li>\n<li><p>actioncategoryActivity</p>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;intent-filter&gt;</div><div class=\"line\">    &lt;action android:name=\"android.intent.action.MAIN\" /&gt;</div><div class=\"line\">    &lt;category android:name=\"android.intent.category.LAUNCHER\" /&gt;</div><div class=\"line\">&lt;/intent-filter&gt;</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<h3 id=\"2-IPC\"><a href=\"#2-IPC\" class=\"headerlink\" title=\"2 IPC\"></a>2 IPC</h3><h4 id=\"2-1-Android-IPC\"><a href=\"#2-1-Android-IPC\" class=\"headerlink\" title=\"2.1 Android IPC\"></a>2.1 Android IPC</h4><p>(1)IPCLinuxAndroidBinderIPCSocket</p>\n<h4 id=\"2-2-Android\"><a href=\"#2-2-Android\" class=\"headerlink\" title=\"2.2 Android\"></a>2.2 Android</h4><ul>\n<li><p>(1)android:process.</p>\n<p>  packageName::ShareUID</p>\n<p>  android:process=:xyz // packageName:xyz</p>\n<p>  android:process=aaa.bbb.ccc // aaa.bbb.ccc</p>\n</li>\n<li><p>(2)AndroidUIDUID</p>\n<p>  ShareUIDShareUID data</p>\n</li>\n<li><p>(3)android</p>\n</li>\n<li><p>(4)</p>\n<ul>\n<li>1.</li>\n<li>2.</li>\n<li>3.SharedPreferencesSharedPreferences</li>\n<li><p>4.ApplicationApplicationApplication</p>\n<p></p>\n</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"2-3-IPC\"><a href=\"#2-3-IPC\" class=\"headerlink\" title=\"2.3 IPC\"></a>2.3 IPC</h4><ul>\n<li><p>(1)SerializableJavaParcelableAndroid</p>\n</li>\n<li><p>(2)serialVersionUIdlongserialVersionUIdserialVersionUId</p>\n<p>serialVersionUIdserialVersionUIdserialVersionUIdserialVersionUIdserialVersionUId</p>\n<ul>\n<li><p>1.</p>\n</li>\n<li><p>2.transient</p>\n</li>\n</ul>\n</li>\n<li><p>(3)ParcelableBinderParcelableIntentBundleBitmapListMapParcelable</p>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Book</span> <span class=\"keyword\">implements</span> <span class=\"title\">Parcelable</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">int</span> bookId;</div><div class=\"line\">    <span class=\"keyword\">public</span> String bookName;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Book</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Book</span><span class=\"params\">(<span class=\"keyword\">int</span> bookId, String bookName)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">this</span>.bookId = bookId;</div><div class=\"line\">        <span class=\"keyword\">this</span>.bookName = bookName;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//100</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">describeContents</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//flags0110</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">writeToParcel</span><span class=\"params\">(Parcel out, <span class=\"keyword\">int</span> flags)</span> </span>&#123;</div><div class=\"line\">        out.writeInt(bookId);</div><div class=\"line\">        out.writeString(bookName);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//</span></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Parcelable.Creator&lt;Book&gt; CREATOR = <span class=\"keyword\">new</span> Parcelable.Creator&lt;Book&gt;() &#123;</div><div class=\"line\">        <span class=\"comment\">//</span></div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> Book <span class=\"title\">createFromParcel</span><span class=\"params\">(Parcel in)</span> </span>&#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Book(in);</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">public</span> Book[] newArray(<span class=\"keyword\">int</span> size) &#123;<span class=\"comment\">//</span></div><div class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Book[size];</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Book</span><span class=\"params\">(Parcel in)</span> </span>&#123;</div><div class=\"line\">        bookId = in.readInt();</div><div class=\"line\">        bookName = in.readString();</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<ul>\n<li><p>(4)BinderAndroidIBinder</p>\n<p>IPCBinderAndroidBinder/dev/binder</p>\n<p>FrameworkBinderServiceManagerManagerManagerService</p>\n<p>AndroidBinderbindServiceBinderBinderAIDL</p>\n</li>\n</ul>\n<p>  AndroidBinderServiceAIDLMessengerServiceBinderMessengerAIDLBinder</p>\n<ul>\n<li><p>(5)aidlaidljava</p>\n<p>ididtransact</p>\n<p>StubStubBindertransacttransactStubProxy</p>\n<p>StubStubProxy </p>\n<ul>\n<li>1.asInterface(android.os.IBinder obj)BinderAIDLStubStub.Proxy</li>\n<li>2.asBinderBinder</li>\n<li><p>3.onTransactBinder</p>\n<p>public Boolean onTransact(int code, Parcelable data, Parcelable reply, int flags)</p>\n<p>codedatareplyfalse()</p>\n</li>\n<li><p>4.Proxy#[Method]</p>\n<p>_datatransactRPConTransactRPC_replyRPC_reply</p>\n</li>\n</ul>\n<p>AIDLBinder<a href=\"https://github.com/singwhatiwanna/android-art-res/blob/master/Chapter_2/src/com/ryg/chapter_2/manualbinder/BookManagerImpl.java\"></a></p>\n</li>\n<li><p>(6)BinderlinkToDeathunlinkToDeath</p>\n<p>BinderBinderlinkToDeathunlinkToDeathlinkToDeathBinderBinder</p>\n<p>Binder</p>\n<ul>\n<li>1.DeathRecipientDeathRecipientbindeDiedBinder</li>\n</ul>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">private</span> IBinder.DeathRecipient mDeathRecipient = <span class=\"keyword\">new</span> IBinder.DeathRecipient() &#123;</div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">binderDied</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (mRemoteBookManager == <span class=\"keyword\">null</span>) <span class=\"keyword\">return</span>;</div><div class=\"line\">        mRemoteBookManager.asBinder().unlinkToDeath(mDeathRecipient, <span class=\"number\">0</span>);</div><div class=\"line\">        mRemoteBookManager = <span class=\"keyword\">null</span>;</div><div class=\"line\">        <span class=\"comment\">// <span class=\"doctag\">TODO:</span>Service</span></div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure>\n<ul>\n<li>2.binder</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">mRemoteBookManager.asBinder().linkToDeath(mDeathRecipient, <span class=\"number\">0</span>);</div></pre></td></tr></table></figure>\n<h4 id=\"2-4-AndroidIPC\"><a href=\"#2-4-AndroidIPC\" class=\"headerlink\" title=\"2.4 AndroidIPC\"></a>2.4 AndroidIPC</h4><ul>\n<li><p>(1)BundleBundleParcelableActivityServiceReceiverIntentBundle</p>\n</li>\n<li><p>(2)</p>\n<p>SharedPreferencesSharedPreferencesSharedPreferences</p>\n</li>\n<li><p>(3)MessengerMessengerIPCAIDLMessenger</p>\n</li>\n<li><p>(4)AIDL</p>\n<p>ServiceAIDLAIDLStubStubServiceonBindService</p>\n<ul>\n<li>1.AIDLStringCharSequenceArrayListHashMapParcelableAIDL</li>\n<li>2.AIDLimport</li>\n<li>3.AIDLinoutinout</li>\n<li>4.AIDL</li>\n<li>5.AIDLAIDL</li>\n<li>6.RemoteCallbackListListenerRemoteCallbackListAIDLAIDLIInterface</li>\n</ul>\n</li>\n<li><p>(5)ContentProvider</p>\n<ul>\n<li>1.ContentProvider</li>\n<li>2.ContentProviderMediaStoreContentProvider</li>\n<li>3.ContentProviderSQLite</li>\n<li>4.ContentProviderContentResolverregisterContentObserver</li>\n</ul>\n</li>\n<li><p>(6)Socket</p>\n<p>SocketTCPUDP</p>\n</li>\n</ul>\n<h4 id=\"2-5-Binder\"><a href=\"#2-5-Binder\" class=\"headerlink\" title=\"2.5 Binder\"></a>2.5 Binder</h4><ul>\n<li><p>(1)ServiceserviceserviceAIDLService</p>\n<p>AIDLBinderServicequeryBinderBinderBinder</p>\n<p>BinderBinderServiceService</p>\n</li>\n<li><p>(2)BinderBinderPoolAIDLBinderPool</p>\n</li>\n</ul>\n<h4 id=\"2-6-IPC\"><a href=\"#2-6-IPC\" class=\"headerlink\" title=\"2.6 IPC\"></a>2.6 IPC</h4><p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2016/androidart_ipc.png\" alt=\"IPC\"></p>\n<h3 id=\"9-\"><a href=\"#9-\" class=\"headerlink\" title=\"9 \"></a>9 </h3><p><a href=\"http://blog.csdn.net/amurocrash/article/details/48858353\">amurocrash</a></p>\n<h4 id=\"9-1-\"><a href=\"#9-1-\" class=\"headerlink\" title=\"9.1 \"></a>9.1 </h4><ul>\n<li>(1)BroadcastReceiverAndroidManifestAndroidManifestContentProviderIntentIntent</li>\n<li>(2)ActivityIntent</li>\n<li>(3)ServiceserviceServiceserviceservice</li>\n<li>(4)BroadcastReceiverAndroidManifestContext.registerReceiver()BroadcastReceiver</li>\n<li>(5)ContentProviderContentProviderinsertdeleteupdatequeryBinderContentProvider</li>\n</ul>\n<h4 id=\"9-2-Activity\"><a href=\"#9-2-Activity\" class=\"headerlink\" title=\"9.2 Activity\"></a>9.2 Activity</h4><h5 id=\"1-Activity\"><a href=\"#1-Activity\" class=\"headerlink\" title=\"(1)Activity\"></a>(1)Activity</h5><p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2016/androidart_activity.png\" alt=\"Activity\"></p>\n<p>(2)ApplicationThreadActivityThreadApplicationThreadNativeApplicationThreadNativeBinderIApplicationThreadApplicationThreadNativeAIDL<br>(3)ActivityManagerService(AMS)ActivityManagerNativeActivityManagerNativeBinderIActivityManagerBinderAMSBinder<br>(4)ApplicationInstrumentationActivity<br>(5)ContextImplContextContextImplActivityattachActivityattachActivityWindowWindowwindowActivity [Activitywindow]</p>\n<h4 id=\"9-3-Service\"><a href=\"#9-3-Service\" class=\"headerlink\" title=\"9.3 Service\"></a>9.3 Service</h4><h5 id=\"1-Service\"><a href=\"#1-Service\" class=\"headerlink\" title=\"(1)Service\"></a>(1)Service</h5><p><br><strong></strong><br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2016/androidart_service1.png\" alt=\"Service1\"></p>\n<p><strong></strong><br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2016/androidart_service2.png\" alt=\"Service2\"></p>\n<h4 id=\"9-4-BroadcastReceiver\"><a href=\"#9-4-BroadcastReceiver\" class=\"headerlink\" title=\"9.4 BroadcastReceiver\"></a>9.4 BroadcastReceiver</h4><h5 id=\"1-BroadcastReceiver\"><a href=\"#1-BroadcastReceiver\" class=\"headerlink\" title=\"(1)BroadcastReceiver\"></a>(1)BroadcastReceiver</h5><p><strong></strong>PackageManagerService<br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2016/androidart_broadcastreceiver1.png\" alt=\"broadcastreceiver1\"><br><strong></strong><br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2016/androidart_broadcastreceiver2.png\" alt=\"broadcastreceiver2\"></p>\n<h5 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"(2)\"></a>(2)</h5><p></p>\n<h5 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"(3)\"></a>(3)</h5><p>Android 3.1</p>\n<h4 id=\"9-5-ContentProvider\"><a href=\"#9-5-ContentProvider\" class=\"headerlink\" title=\"9.5 ContentProvider\"></a>9.5 ContentProvider</h4><h5 id=\"1-ContentProviderAMSonCreateApplicationonCreate\"><a href=\"#1-ContentProviderAMSonCreateApplicationonCreate\" class=\"headerlink\" title=\"(1)ContentProviderAMSonCreateApplicationonCreate\"></a>(1)ContentProviderAMSonCreateApplicationonCreate</h5><h5 id=\"2-ContentProvider\"><a href=\"#2-ContentProvider\" class=\"headerlink\" title=\"(2)ContentProvider\"></a>(2)ContentProvider</h5><ul>\n<li>1.ActivityThreadmainActivityThread</li>\n<li>2.ActivityThreadattachActivityManagerServiceattachApplicationApplicationThreadAMSApplicationThreadActivityThreadAMS</li>\n<li>3.ActivityManagerServiceattachApplicationApplicationThreadbindApplicationHActivityThreadhandleBindApplication</li>\n<li>4.handleBindApplicationApplicationContentProviderContentProviderApplicationonCreate</li>\n</ul>\n<h5 id=\"3-ContentProviderandroid-multiprocessfalsetrueContentProvider\"><a href=\"#3-ContentProviderandroid-multiprocessfalsetrueContentProvider\" class=\"headerlink\" title=\"(3)ContentProviderandroid:multiprocessfalsetrueContentProvider\"></a>(3)ContentProviderandroid:multiprocessfalsetrueContentProvider</h5><h5 id=\"4-ContentProviderinsertdeleteupdatequeryContentProviderContentProviderContentProviderContentProviderquery\"><a href=\"#4-ContentProviderinsertdeleteupdatequeryContentProviderContentProviderContentProviderContentProviderquery\" class=\"headerlink\" title=\"(4)ContentProviderinsertdeleteupdatequeryContentProviderContentProviderContentProviderContentProviderquery\"></a>(4)ContentProviderinsertdeleteupdatequeryContentProviderContentProviderContentProviderContentProviderquery</h5><p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2016/androidart_contentprovider.png\" alt=\"ContentProvider\"></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/03/20/android-books-reading-/\">http://agehua.github.io/2016/03/20/android-books-reading-/</a></p>"},{"layout":"post","title":"google cloud messageGCMAzureNotification","keywords":"gcm, azure, notification","description":"google cloud messageGCMAzureNotification","banner":"http://obxk8w81b.bkt.clouddn.com/Country%20Lane%20with%20Two%20Figures.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Country%20Lane%20with%20Two%20Figures.jpg","_content":"\n\n### 1.\nmicrosoftazure\n\ngcm start: https://developers.google.com/cloud-messaging/android/start\n\nazure start: https://azure.microsoft.com/zh-cn/documentation/articles/notification-hubs-android-get-started/\n\ngcm official demo: https://github.com/google/gcm\n\ngcm personal demo: https://github.com/iammert/FastGCM\n\n<!--more-->\n\n### 2.\n- 1.demo\n\nstackoverflowhttp://stackoverflow.com/questions/13835676/google-cloud-messaging-messages-sometimes-not-received-until-network-state-cha\n\n\n### 3.onActivityResult()onResume()\nAPIActivityonResume()\n\n\n\n1.onResume()\n2.onAcitviyResult()\n\n\n\n### 4.Android4.4Uri\n\n~~~ Java\n\npublic static String getPhotoPathFromContentUri(Context context, Uri uri) {\n    String photoPath = \"\";\n    if(context == null || uri == null) {\n        return photoPath;\n    }\n\n    if(Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT && DocumentsContract.isDocumentUri(context, uri)) {\n        String docId = DocumentsContract.getDocumentId(uri);\n        if(isExternalStorageDocument(uri)) {\n            String [] split = docId.split(\":\");\n            if(split.length >= 2) {\n                String type = split[0];\n                if(\"primary\".equalsIgnoreCase(type)) {\n                    photoPath = Environment.getExternalStorageDirectory() + \"/\" + split[1];\n                }\n            }\n        }\n        else if(isDownloadsDocument(uri)) {\n            Uri contentUri = ContentUris.withAppendedId(Uri.parse(\"content://downloads/public_downloads\"), Long.valueOf(docId));\n            photoPath = getDataColumn(context, contentUri, null, null);\n        }\n        else if(isMediaDocument(uri)) {\n            String[] split = docId.split(\":\");\n            if(split.length >= 2) {\n                String type = split[0];\n                Uri contentUris = null;\n                if(\"image\".equals(type)) {\n                    contentUris = MediaStore.Images.Media.EXTERNAL_CONTENT_URI;\n                }\n                else if(\"video\".equals(type)) {\n                    contentUris = MediaStore.Video.Media.EXTERNAL_CONTENT_URI;\n                }\n                else if(\"audio\".equals(type)) {\n                    contentUris = MediaStore.Audio.Media.EXTERNAL_CONTENT_URI;\n                }\n                String selection = MediaStore.Images.Media._ID + \"=?\";\n                String[] selectionArgs = new String[] { split[1] };\n                photoPath = getDataColumn(context, contentUris, selection, selectionArgs);\n            }\n        }\n    }\n    else if(\"file\".equalsIgnoreCase(uri.getScheme())) {\n        photoPath = uri.getPath();\n    }\n    else {\n        photoPath = getDataColumn(context, uri, null, null);\n    }\n\n    return photoPath;\n}\n\nprivate static boolean isExternalStorageDocument(Uri uri) {\n    return \"com.android.externalstorage.documents\".equals(uri.getAuthority());\n}\n\nprivate static boolean isDownloadsDocument(Uri uri) {\n    return \"com.android.providers.downloads.documents\".equals(uri.getAuthority());\n}\n\nprivate static boolean isMediaDocument(Uri uri) {\n    return \"com.android.providers.media.documents\".equals(uri.getAuthority());\n}\n\nprivate static String getDataColumn(Context context, Uri uri, String selection, String[] selectionArgs) {\n    Cursor cursor = null;\n    String column = MediaStore.Images.Media.DATA;\n    String[] projection = { column };\n    try {\n        cursor = context.getContentResolver().query(uri, projection, selection, selectionArgs, null);\n        if (cursor != null && cursor.moveToFirst()) {\n            int index = cursor.getColumnIndexOrThrow(column);\n            return cursor.getString(index);\n        }\n    } finally {\n        if (cursor != null && !cursor.isClosed())\n                cursor.close();\n    }\n    return null;\n}\n\n~~~\n","source":"_posts/2016-05-12-GCM-Azure_summary.md","raw":"---\nlayout: post\ntitle: google cloud messageGCMAzureNotification\ncategory: accumulation\ntags:\n  - ANDROID\n  - GCM\n  - azure\n  - notification\nkeywords: gcm, azure, notification\ndescription: google cloud messageGCMAzureNotification\nbanner: http://obxk8w81b.bkt.clouddn.com/Country%20Lane%20with%20Two%20Figures.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Country%20Lane%20with%20Two%20Figures.jpg\n\n---\n\n\n### 1.\nmicrosoftazure\n\ngcm start: https://developers.google.com/cloud-messaging/android/start\n\nazure start: https://azure.microsoft.com/zh-cn/documentation/articles/notification-hubs-android-get-started/\n\ngcm official demo: https://github.com/google/gcm\n\ngcm personal demo: https://github.com/iammert/FastGCM\n\n<!--more-->\n\n### 2.\n- 1.demo\n\nstackoverflowhttp://stackoverflow.com/questions/13835676/google-cloud-messaging-messages-sometimes-not-received-until-network-state-cha\n\n\n### 3.onActivityResult()onResume()\nAPIActivityonResume()\n\n\n\n1.onResume()\n2.onAcitviyResult()\n\n\n\n### 4.Android4.4Uri\n\n~~~ Java\n\npublic static String getPhotoPathFromContentUri(Context context, Uri uri) {\n    String photoPath = \"\";\n    if(context == null || uri == null) {\n        return photoPath;\n    }\n\n    if(Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT && DocumentsContract.isDocumentUri(context, uri)) {\n        String docId = DocumentsContract.getDocumentId(uri);\n        if(isExternalStorageDocument(uri)) {\n            String [] split = docId.split(\":\");\n            if(split.length >= 2) {\n                String type = split[0];\n                if(\"primary\".equalsIgnoreCase(type)) {\n                    photoPath = Environment.getExternalStorageDirectory() + \"/\" + split[1];\n                }\n            }\n        }\n        else if(isDownloadsDocument(uri)) {\n            Uri contentUri = ContentUris.withAppendedId(Uri.parse(\"content://downloads/public_downloads\"), Long.valueOf(docId));\n            photoPath = getDataColumn(context, contentUri, null, null);\n        }\n        else if(isMediaDocument(uri)) {\n            String[] split = docId.split(\":\");\n            if(split.length >= 2) {\n                String type = split[0];\n                Uri contentUris = null;\n                if(\"image\".equals(type)) {\n                    contentUris = MediaStore.Images.Media.EXTERNAL_CONTENT_URI;\n                }\n                else if(\"video\".equals(type)) {\n                    contentUris = MediaStore.Video.Media.EXTERNAL_CONTENT_URI;\n                }\n                else if(\"audio\".equals(type)) {\n                    contentUris = MediaStore.Audio.Media.EXTERNAL_CONTENT_URI;\n                }\n                String selection = MediaStore.Images.Media._ID + \"=?\";\n                String[] selectionArgs = new String[] { split[1] };\n                photoPath = getDataColumn(context, contentUris, selection, selectionArgs);\n            }\n        }\n    }\n    else if(\"file\".equalsIgnoreCase(uri.getScheme())) {\n        photoPath = uri.getPath();\n    }\n    else {\n        photoPath = getDataColumn(context, uri, null, null);\n    }\n\n    return photoPath;\n}\n\nprivate static boolean isExternalStorageDocument(Uri uri) {\n    return \"com.android.externalstorage.documents\".equals(uri.getAuthority());\n}\n\nprivate static boolean isDownloadsDocument(Uri uri) {\n    return \"com.android.providers.downloads.documents\".equals(uri.getAuthority());\n}\n\nprivate static boolean isMediaDocument(Uri uri) {\n    return \"com.android.providers.media.documents\".equals(uri.getAuthority());\n}\n\nprivate static String getDataColumn(Context context, Uri uri, String selection, String[] selectionArgs) {\n    Cursor cursor = null;\n    String column = MediaStore.Images.Media.DATA;\n    String[] projection = { column };\n    try {\n        cursor = context.getContentResolver().query(uri, projection, selection, selectionArgs, null);\n        if (cursor != null && cursor.moveToFirst()) {\n            int index = cursor.getColumnIndexOrThrow(column);\n            return cursor.getString(index);\n        }\n    } finally {\n        if (cursor != null && !cursor.isClosed())\n                cursor.close();\n    }\n    return null;\n}\n\n~~~\n","slug":"GCM-Azure_summary","published":1,"date":"2016-05-11T16:00:00.000Z","updated":"2017-11-23T07:24:10.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ebwl000jd6ykedf1baiw","content":"<h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h3><p>microsoftazure</p>\n<p>gcm start: <a href=\"https://developers.google.com/cloud-messaging/android/start\" target=\"_blank\" rel=\"external\">https://developers.google.com/cloud-messaging/android/start</a></p>\n<p>azure start: <a href=\"https://azure.microsoft.com/zh-cn/documentation/articles/notification-hubs-android-get-started/\" target=\"_blank\" rel=\"external\">https://azure.microsoft.com/zh-cn/documentation/articles/notification-hubs-android-get-started/</a></p>\n<p>gcm official demo: <a href=\"https://github.com/google/gcm\" target=\"_blank\" rel=\"external\">https://github.com/google/gcm</a></p>\n<p>gcm personal demo: <a href=\"https://github.com/iammert/FastGCM\" target=\"_blank\" rel=\"external\">https://github.com/iammert/FastGCM</a></p>\n<a id=\"more\"></a>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h3><ul>\n<li>1.demo</li>\n</ul>\n<p>stackoverflow<a href=\"http://stackoverflow.com/questions/13835676/google-cloud-messaging-messages-sometimes-not-received-until-network-state-cha\" target=\"_blank\" rel=\"external\">http://stackoverflow.com/questions/13835676/google-cloud-messaging-messages-sometimes-not-received-until-network-state-cha</a></p>\n<h3 id=\"3-onActivityResult-onResume-\"><a href=\"#3-onActivityResult-onResume-\" class=\"headerlink\" title=\"3.onActivityResult()onResume()\"></a>3.onActivityResult()onResume()</h3><p>APIActivityonResume()</p>\n<p><br><br>1.onResume()<br>2.onAcitviyResult()</p>\n<p></p>\n<h3 id=\"4-Android4-4Uri\"><a href=\"#4-Android4-4Uri\" class=\"headerlink\" title=\"4.Android4.4Uri\"></a>4.Android4.4Uri</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">getPhotoPathFromContentUri</span><span class=\"params\">(Context context, Uri uri)</span> </span>&#123;</div><div class=\"line\">    String photoPath = <span class=\"string\">\"\"</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span>(context == <span class=\"keyword\">null</span> || uri == <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> photoPath;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">if</span>(Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT &amp;&amp; DocumentsContract.isDocumentUri(context, uri)) &#123;</div><div class=\"line\">        String docId = DocumentsContract.getDocumentId(uri);</div><div class=\"line\">        <span class=\"keyword\">if</span>(isExternalStorageDocument(uri)) &#123;</div><div class=\"line\">            String [] split = docId.split(<span class=\"string\">\":\"</span>);</div><div class=\"line\">            <span class=\"keyword\">if</span>(split.length &gt;= <span class=\"number\">2</span>) &#123;</div><div class=\"line\">                String type = split[<span class=\"number\">0</span>];</div><div class=\"line\">                <span class=\"keyword\">if</span>(<span class=\"string\">\"primary\"</span>.equalsIgnoreCase(type)) &#123;</div><div class=\"line\">                    photoPath = Environment.getExternalStorageDirectory() + <span class=\"string\">\"/\"</span> + split[<span class=\"number\">1</span>];</div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(isDownloadsDocument(uri)) &#123;</div><div class=\"line\">            Uri contentUri = ContentUris.withAppendedId(Uri.parse(<span class=\"string\">\"content://downloads/public_downloads\"</span>), Long.valueOf(docId));</div><div class=\"line\">            photoPath = getDataColumn(context, contentUri, <span class=\"keyword\">null</span>, <span class=\"keyword\">null</span>);</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(isMediaDocument(uri)) &#123;</div><div class=\"line\">            String[] split = docId.split(<span class=\"string\">\":\"</span>);</div><div class=\"line\">            <span class=\"keyword\">if</span>(split.length &gt;= <span class=\"number\">2</span>) &#123;</div><div class=\"line\">                String type = split[<span class=\"number\">0</span>];</div><div class=\"line\">                Uri contentUris = <span class=\"keyword\">null</span>;</div><div class=\"line\">                <span class=\"keyword\">if</span>(<span class=\"string\">\"image\"</span>.equals(type)) &#123;</div><div class=\"line\">                    contentUris = MediaStore.Images.Media.EXTERNAL_CONTENT_URI;</div><div class=\"line\">                &#125;</div><div class=\"line\">                <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(<span class=\"string\">\"video\"</span>.equals(type)) &#123;</div><div class=\"line\">                    contentUris = MediaStore.Video.Media.EXTERNAL_CONTENT_URI;</div><div class=\"line\">                &#125;</div><div class=\"line\">                <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(<span class=\"string\">\"audio\"</span>.equals(type)) &#123;</div><div class=\"line\">                    contentUris = MediaStore.Audio.Media.EXTERNAL_CONTENT_URI;</div><div class=\"line\">                &#125;</div><div class=\"line\">                String selection = MediaStore.Images.Media._ID + <span class=\"string\">\"=?\"</span>;</div><div class=\"line\">                String[] selectionArgs = <span class=\"keyword\">new</span> String[] &#123; split[<span class=\"number\">1</span>] &#125;;</div><div class=\"line\">                photoPath = getDataColumn(context, contentUris, selection, selectionArgs);</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(<span class=\"string\">\"file\"</span>.equalsIgnoreCase(uri.getScheme())) &#123;</div><div class=\"line\">        photoPath = uri.getPath();</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">        photoPath = getDataColumn(context, uri, <span class=\"keyword\">null</span>, <span class=\"keyword\">null</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">return</span> photoPath;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isExternalStorageDocument</span><span class=\"params\">(Uri uri)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">\"com.android.externalstorage.documents\"</span>.equals(uri.getAuthority());</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isDownloadsDocument</span><span class=\"params\">(Uri uri)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">\"com.android.providers.downloads.documents\"</span>.equals(uri.getAuthority());</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isMediaDocument</span><span class=\"params\">(Uri uri)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">\"com.android.providers.media.documents\"</span>.equals(uri.getAuthority());</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> String <span class=\"title\">getDataColumn</span><span class=\"params\">(Context context, Uri uri, String selection, String[] selectionArgs)</span> </span>&#123;</div><div class=\"line\">    Cursor cursor = <span class=\"keyword\">null</span>;</div><div class=\"line\">    String column = MediaStore.Images.Media.DATA;</div><div class=\"line\">    String[] projection = &#123; column &#125;;</div><div class=\"line\">    <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">        cursor = context.getContentResolver().query(uri, projection, selection, selectionArgs, <span class=\"keyword\">null</span>);</div><div class=\"line\">        <span class=\"keyword\">if</span> (cursor != <span class=\"keyword\">null</span> &amp;&amp; cursor.moveToFirst()) &#123;</div><div class=\"line\">            <span class=\"keyword\">int</span> index = cursor.getColumnIndexOrThrow(column);</div><div class=\"line\">            <span class=\"keyword\">return</span> cursor.getString(index);</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (cursor != <span class=\"keyword\">null</span> &amp;&amp; !cursor.isClosed())</div><div class=\"line\">                cursor.close();</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/05/12/GCM-Azure_summary/\">http://agehua.github.io/2016/05/12/GCM-Azure_summary/</a></p>\n","readingTime":{"text":"3 min read","minutes":2.31,"time":138600,"words":462},"excerpt":"<h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h3><p>microsoftazure</p>\n<p>gcm start: <a href=\"https://developers.google.com/cloud-messaging/android/start\">https://developers.google.com/cloud-messaging/android/start</a></p>\n<p>azure start: <a href=\"https://azure.microsoft.com/zh-cn/documentation/articles/notification-hubs-android-get-started/\">https://azure.microsoft.com/zh-cn/documentation/articles/notification-hubs-android-get-started/</a></p>\n<p>gcm official demo: <a href=\"https://github.com/google/gcm\">https://github.com/google/gcm</a></p>\n<p>gcm personal demo: <a href=\"https://github.com/iammert/FastGCM\">https://github.com/iammert/FastGCM</a></p>","more":"<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h3><ul>\n<li>1.demo</li>\n</ul>\n<p>stackoverflow<a href=\"http://stackoverflow.com/questions/13835676/google-cloud-messaging-messages-sometimes-not-received-until-network-state-cha\">http://stackoverflow.com/questions/13835676/google-cloud-messaging-messages-sometimes-not-received-until-network-state-cha</a></p>\n<h3 id=\"3-onActivityResult-onResume-\"><a href=\"#3-onActivityResult-onResume-\" class=\"headerlink\" title=\"3.onActivityResult()onResume()\"></a>3.onActivityResult()onResume()</h3><p>APIActivityonResume()</p>\n<p><br><br>1.onResume()<br>2.onAcitviyResult()</p>\n<p></p>\n<h3 id=\"4-Android4-4Uri\"><a href=\"#4-Android4-4Uri\" class=\"headerlink\" title=\"4.Android4.4Uri\"></a>4.Android4.4Uri</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">getPhotoPathFromContentUri</span><span class=\"params\">(Context context, Uri uri)</span> </span>&#123;</div><div class=\"line\">    String photoPath = <span class=\"string\">\"\"</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span>(context == <span class=\"keyword\">null</span> || uri == <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> photoPath;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">if</span>(Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT &amp;&amp; DocumentsContract.isDocumentUri(context, uri)) &#123;</div><div class=\"line\">        String docId = DocumentsContract.getDocumentId(uri);</div><div class=\"line\">        <span class=\"keyword\">if</span>(isExternalStorageDocument(uri)) &#123;</div><div class=\"line\">            String [] split = docId.split(<span class=\"string\">\":\"</span>);</div><div class=\"line\">            <span class=\"keyword\">if</span>(split.length &gt;= <span class=\"number\">2</span>) &#123;</div><div class=\"line\">                String type = split[<span class=\"number\">0</span>];</div><div class=\"line\">                <span class=\"keyword\">if</span>(<span class=\"string\">\"primary\"</span>.equalsIgnoreCase(type)) &#123;</div><div class=\"line\">                    photoPath = Environment.getExternalStorageDirectory() + <span class=\"string\">\"/\"</span> + split[<span class=\"number\">1</span>];</div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(isDownloadsDocument(uri)) &#123;</div><div class=\"line\">            Uri contentUri = ContentUris.withAppendedId(Uri.parse(<span class=\"string\">\"content://downloads/public_downloads\"</span>), Long.valueOf(docId));</div><div class=\"line\">            photoPath = getDataColumn(context, contentUri, <span class=\"keyword\">null</span>, <span class=\"keyword\">null</span>);</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(isMediaDocument(uri)) &#123;</div><div class=\"line\">            String[] split = docId.split(<span class=\"string\">\":\"</span>);</div><div class=\"line\">            <span class=\"keyword\">if</span>(split.length &gt;= <span class=\"number\">2</span>) &#123;</div><div class=\"line\">                String type = split[<span class=\"number\">0</span>];</div><div class=\"line\">                Uri contentUris = <span class=\"keyword\">null</span>;</div><div class=\"line\">                <span class=\"keyword\">if</span>(<span class=\"string\">\"image\"</span>.equals(type)) &#123;</div><div class=\"line\">                    contentUris = MediaStore.Images.Media.EXTERNAL_CONTENT_URI;</div><div class=\"line\">                &#125;</div><div class=\"line\">                <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(<span class=\"string\">\"video\"</span>.equals(type)) &#123;</div><div class=\"line\">                    contentUris = MediaStore.Video.Media.EXTERNAL_CONTENT_URI;</div><div class=\"line\">                &#125;</div><div class=\"line\">                <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(<span class=\"string\">\"audio\"</span>.equals(type)) &#123;</div><div class=\"line\">                    contentUris = MediaStore.Audio.Media.EXTERNAL_CONTENT_URI;</div><div class=\"line\">                &#125;</div><div class=\"line\">                String selection = MediaStore.Images.Media._ID + <span class=\"string\">\"=?\"</span>;</div><div class=\"line\">                String[] selectionArgs = <span class=\"keyword\">new</span> String[] &#123; split[<span class=\"number\">1</span>] &#125;;</div><div class=\"line\">                photoPath = getDataColumn(context, contentUris, selection, selectionArgs);</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(<span class=\"string\">\"file\"</span>.equalsIgnoreCase(uri.getScheme())) &#123;</div><div class=\"line\">        photoPath = uri.getPath();</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">        photoPath = getDataColumn(context, uri, <span class=\"keyword\">null</span>, <span class=\"keyword\">null</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">return</span> photoPath;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isExternalStorageDocument</span><span class=\"params\">(Uri uri)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">\"com.android.externalstorage.documents\"</span>.equals(uri.getAuthority());</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isDownloadsDocument</span><span class=\"params\">(Uri uri)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">\"com.android.providers.downloads.documents\"</span>.equals(uri.getAuthority());</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isMediaDocument</span><span class=\"params\">(Uri uri)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">\"com.android.providers.media.documents\"</span>.equals(uri.getAuthority());</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> String <span class=\"title\">getDataColumn</span><span class=\"params\">(Context context, Uri uri, String selection, String[] selectionArgs)</span> </span>&#123;</div><div class=\"line\">    Cursor cursor = <span class=\"keyword\">null</span>;</div><div class=\"line\">    String column = MediaStore.Images.Media.DATA;</div><div class=\"line\">    String[] projection = &#123; column &#125;;</div><div class=\"line\">    <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">        cursor = context.getContentResolver().query(uri, projection, selection, selectionArgs, <span class=\"keyword\">null</span>);</div><div class=\"line\">        <span class=\"keyword\">if</span> (cursor != <span class=\"keyword\">null</span> &amp;&amp; cursor.moveToFirst()) &#123;</div><div class=\"line\">            <span class=\"keyword\">int</span> index = cursor.getColumnIndexOrThrow(column);</div><div class=\"line\">            <span class=\"keyword\">return</span> cursor.getString(index);</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (cursor != <span class=\"keyword\">null</span> &amp;&amp; !cursor.isClosed())</div><div class=\"line\">                cursor.close();</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/05/12/GCM-Azure_summary/\">http://agehua.github.io/2016/05/12/GCM-Azure_summary/</a></p>"},{"layout":"post","title":"Java StringC/C++byte[]","keywords":"Java String, bytes,coding","description":"Java StringC/C++byte[]","banner":"http://obxk8w81b.bkt.clouddn.com/Bridge%20and%20Houses%20on%20the%20Corner%20of%20Herengracht-Prinsessegracht,%20The%20Hague.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Bridge%20and%20Houses%20on%20the%20Corner%20of%20Herengracht-Prinsessegracht,%20The%20Hague.jpg","_content":"\n\n   JAVAStringJAVA\n\n### 1\n   JAVA****3PC330x330x333ultraEdit\n\n   <!--more-->\n\n### 2+\n   0x3330x430x03ASCIIGB23120xB5, 0xB1 ****GB23120xB5,0xB1ASCIIASCIIBIG5\n\n### 3UNICODE\n   GB2312BIG50xB5,0xB1\n   +128 **UNICODE28**8x8x8x8x = 655366GB2312UNICODE80xB5,0xB1UNICODE\n\n### 4C\n   CCJAVA**Cchar[]**CCchar816****char[]\n\n### 5JAVA\n   JAVAJAVAStringJAVA**String**  **StringUNICODE**JAVAchar28160~65535UNICODEStringUNICODEgetChars(int srcBegin, int srcEnd, char[] dst, int dstBegin) char[]char[]StringUNICODE\n\n   UNICODEJAVAUNICODE0xB5,0xB1JAVAJAVAWIN98JAVALINUXJAVAASCIInew String({0xB5,0xB1})StringStringnew String({0xB5,0xB1},\"GB2312\")StringJAVAStringWIN9880xB5,0xB10xB5,0xB1GB2312**String.getBytes(\"GB2312\")** **byte[]**JAVAI/Obyte[]byte[]ServletHttpRequest.getParameter()JSP/SERVLET\n\n### 6JAVA\n\n   new String(...,\"ISO-8859-1\")StringUNICODEBYTEStringchar[]\n\n   GB2312UTF-8UTF-8new String(...)StringStringUTF-8StringJAVACJAVAbyte[]char[]\n\n\n### 7\n[](http://www.regexlab.com/zh/encoding.htm)\n","source":"_posts/2016-05-18-javaString-and-bytes.md","raw":"---\nlayout: post\ntitle: Java StringC/C++byte[]\ncategory: accumulation\ntags:\n  - Java\n  - byte[]\nkeywords: Java String, bytes,coding\ndescription: Java StringC/C++byte[]\nbanner: http://obxk8w81b.bkt.clouddn.com/Bridge%20and%20Houses%20on%20the%20Corner%20of%20Herengracht-Prinsessegracht,%20The%20Hague.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Bridge%20and%20Houses%20on%20the%20Corner%20of%20Herengracht-Prinsessegracht,%20The%20Hague.jpg\n---\n\n\n   JAVAStringJAVA\n\n### 1\n   JAVA****3PC330x330x333ultraEdit\n\n   <!--more-->\n\n### 2+\n   0x3330x430x03ASCIIGB23120xB5, 0xB1 ****GB23120xB5,0xB1ASCIIASCIIBIG5\n\n### 3UNICODE\n   GB2312BIG50xB5,0xB1\n   +128 **UNICODE28**8x8x8x8x = 655366GB2312UNICODE80xB5,0xB1UNICODE\n\n### 4C\n   CCJAVA**Cchar[]**CCchar816****char[]\n\n### 5JAVA\n   JAVAJAVAStringJAVA**String**  **StringUNICODE**JAVAchar28160~65535UNICODEStringUNICODEgetChars(int srcBegin, int srcEnd, char[] dst, int dstBegin) char[]char[]StringUNICODE\n\n   UNICODEJAVAUNICODE0xB5,0xB1JAVAJAVAWIN98JAVALINUXJAVAASCIInew String({0xB5,0xB1})StringStringnew String({0xB5,0xB1},\"GB2312\")StringJAVAStringWIN9880xB5,0xB10xB5,0xB1GB2312**String.getBytes(\"GB2312\")** **byte[]**JAVAI/Obyte[]byte[]ServletHttpRequest.getParameter()JSP/SERVLET\n\n### 6JAVA\n\n   new String(...,\"ISO-8859-1\")StringUNICODEBYTEStringchar[]\n\n   GB2312UTF-8UTF-8new String(...)StringStringUTF-8StringJAVACJAVAbyte[]char[]\n\n\n### 7\n[](http://www.regexlab.com/zh/encoding.htm)\n","slug":"javaString-and-bytes","published":1,"date":"2016-05-17T16:00:00.000Z","updated":"2017-11-23T07:04:19.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ebwo000md6ykzt5r5bpr","content":"<p>   JAVAStringJAVA</p>\n<h3 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a>1</h3><p>   JAVA<strong></strong>3PC330x330x333ultraEdit</p>\n   <a id=\"more\"></a>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2+\"></a>2+</h3><p>   0x3330x430x03ASCIIGB23120xB5, 0xB1 <strong></strong>GB23120xB5,0xB1ASCIIASCIIBIG5</p>\n<h3 id=\"3UNICODE\"><a href=\"#3UNICODE\" class=\"headerlink\" title=\"3UNICODE\"></a>3UNICODE</h3><p>   GB2312BIG50xB5,0xB1<br>   +128 <strong>UNICODE28</strong>8x8x8x8x = 655366GB2312UNICODE80xB5,0xB1UNICODE</p>\n<h3 id=\"4C\"><a href=\"#4C\" class=\"headerlink\" title=\"4C\"></a>4C</h3><p>   CCJAVA<strong>Cchar[]</strong>CCchar816<strong></strong>char[]</p>\n<h3 id=\"5JAVA\"><a href=\"#5JAVA\" class=\"headerlink\" title=\"5JAVA\"></a>5JAVA</h3><p>   JAVAJAVAStringJAVA<strong>String</strong>  <strong>StringUNICODE</strong>JAVAchar28160~65535UNICODEStringUNICODEgetChars(int srcBegin, int srcEnd, char[] dst, int dstBegin) char[]char[]StringUNICODE</p>\n<p>   UNICODEJAVAUNICODE0xB5,0xB1JAVAJAVAWIN98JAVALINUXJAVAASCIInew String({0xB5,0xB1})StringStringnew String({0xB5,0xB1},GB2312)StringJAVAStringWIN9880xB5,0xB10xB5,0xB1GB2312<strong>String.getBytes(GB2312)</strong> <strong>byte[]</strong>JAVAI/Obyte[]byte[]ServletHttpRequest.getParameter()JSP/SERVLET</p>\n<h3 id=\"6JAVA\"><a href=\"#6JAVA\" class=\"headerlink\" title=\"6JAVA\"></a>6JAVA</h3><p>   new String(,ISO-8859-1)StringUNICODEBYTEStringchar[]</p>\n<p>   GB2312UTF-8UTF-8new String()StringStringUTF-8StringJAVACJAVAbyte[]char[]</p>\n<h3 id=\"7\"><a href=\"#7\" class=\"headerlink\" title=\"7\"></a>7</h3><p><a href=\"http://www.regexlab.com/zh/encoding.htm\" target=\"_blank\" rel=\"external\"></a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/05/18/javaString-and-bytes/\">http://agehua.github.io/2016/05/18/javaString-and-bytes/</a></p>\n","readingTime":{"text":"1 min read","minutes":0.315,"time":18900,"words":63},"excerpt":"<p>   JAVAStringJAVA</p>\n<h3 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a>1</h3><p>   JAVA<strong></strong>3PC330x330x333ultraEdit</p>","more":"<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2+\"></a>2+</h3><p>   0x3330x430x03ASCIIGB23120xB5, 0xB1 <strong></strong>GB23120xB5,0xB1ASCIIASCIIBIG5</p>\n<h3 id=\"3UNICODE\"><a href=\"#3UNICODE\" class=\"headerlink\" title=\"3UNICODE\"></a>3UNICODE</h3><p>   GB2312BIG50xB5,0xB1<br>   +128 <strong>UNICODE28</strong>8x8x8x8x = 655366GB2312UNICODE80xB5,0xB1UNICODE</p>\n<h3 id=\"4C\"><a href=\"#4C\" class=\"headerlink\" title=\"4C\"></a>4C</h3><p>   CCJAVA<strong>Cchar[]</strong>CCchar816<strong></strong>char[]</p>\n<h3 id=\"5JAVA\"><a href=\"#5JAVA\" class=\"headerlink\" title=\"5JAVA\"></a>5JAVA</h3><p>   JAVAJAVAStringJAVA<strong>String</strong>  <strong>StringUNICODE</strong>JAVAchar28160~65535UNICODEStringUNICODEgetChars(int srcBegin, int srcEnd, char[] dst, int dstBegin) char[]char[]StringUNICODE</p>\n<p>   UNICODEJAVAUNICODE0xB5,0xB1JAVAJAVAWIN98JAVALINUXJAVAASCIInew String({0xB5,0xB1})StringStringnew String({0xB5,0xB1},GB2312)StringJAVAStringWIN9880xB5,0xB10xB5,0xB1GB2312<strong>String.getBytes(GB2312)</strong> <strong>byte[]</strong>JAVAI/Obyte[]byte[]ServletHttpRequest.getParameter()JSP/SERVLET</p>\n<h3 id=\"6JAVA\"><a href=\"#6JAVA\" class=\"headerlink\" title=\"6JAVA\"></a>6JAVA</h3><p>   new String(,ISO-8859-1)StringUNICODEBYTEStringchar[]</p>\n<p>   GB2312UTF-8UTF-8new String()StringStringUTF-8StringJAVACJAVAbyte[]char[]</p>\n<h3 id=\"7\"><a href=\"#7\" class=\"headerlink\" title=\"7\"></a>7</h3><p><a href=\"http://www.regexlab.com/zh/encoding.htm\"></a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/05/18/javaString-and-bytes/\">http://agehua.github.io/2016/05/18/javaString-and-bytes/</a></p>"},{"layout":"post","title":"android JNI ","keywords":"jni, aes ","description":"android JNIaes","banner":"http://obxk8w81b.bkt.clouddn.com/Avenue%20of%20Plane%20Trees%20near%20Arles%20Station.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Avenue%20of%20Plane%20Trees%20near%20Arles%20Station.jpg","_content":"\n\n\n\n\n### 1.JNI\nJNI : Java,Java Native Interface, , JavaC/C++,  Java, C/C++ Java;\n\nCJava :\n\n- C : C  function;\n- Java : Java JVM, class, class;\n\nCJava :\n\n- JNI : CJava, ,  JNI, JNI;\n- CJava : CJavaclass, ;\n- JavaC : Java, CJava;\n- JNI : JNI, CJava;\n\n<!--more-->\n\nJNI :\n\n- native : Java, ;\n- Native : JavanativeNative;\n- JNI : JavaNative;\n- JNI : JNIEnv, jni.h;\n- JNI : NativeJNI C/C++, jniC;\n\n### 2.NDK\nC : C, ,   ;\n\n-  : unix.so, windows.dll ; C;\n-  :.a;\n\n : C   , , CPU  ;\n\n- CPU : arm, ; x86, pc; CPU;\n-  :windows x86arm;\n-  : Google NDK , linuxarn;\n\nNDK : Google, linuxarm;\n\nNDK : android-ndk-windows windowscygwin, android-ndk-linux linux;\n\nNDKcygwinCcygwin\n\n### 3.android studioEclipse\nEclipseEclipse.hso[Eclipse ADT.h/.so](http://blog.csdn.net/jspping/article/details/47780307)\n\n#### 3.1 JavaC\n\n- a.  Native  : com.packagename.jni.JNITest.java  Native  public native int add(int x, int y);\n- b.  :  AndroidProject/bin/classes ,  javah com.packagename.jni.JNITest , ,  jni.h,  Native ,  JNIEXPORT jint JNICALL Java_com_packagename_jni_JNITest_add (JNIEnv \\*, jobject, jint, jint);  \n\nJava :\n\n~~~ Java\n//Javaint C, , java shuliang.han.ndkparameterpassing.DataProvider  \npublic native int add(int x, int y);  \n~~~\nC :\n\n~~~ C++\n#include <jni.h>  \n\n//, Javanative, native  \njint Java_com_packagename_jni_JNITest_add(JNIEnv * env, jobject obj, jint x, jint y)  \n{  \n    return x + y;  \n}  \n~~~\n\n#### 3.2 .so\n\nAndroid.mk \n\n~~~ C++\nLOCAL_PATH := $(call my-dir)    \n\ninclude $(CLEAR_VARS)    \n\nLOCAL_MODULE    := hello-jni    \nLOCAL_SRC_FILES := hello-jni.c    \n\ninclude $(BUILD_SHARED_LIBRARY)  \n~~~\n\n- \n\n  **** : $(call my-dir) , , ;\n\n  **** : \" := \" ,   ,  LOCAL_PATH;\n\n  **** : $(CLEAR_VARS) , LOCAL_MODULE LOCAL_SRC_FILES ;\n\n  **** : LOCAL_MODULE    := hello-jni ,  so ,  \"lib\",  \".so\";\n\n  **** : LOCAL_SRC_FILES := hello-jni.c , ;\n\n  **** : include $(BUILD_SHARED_LIBRARY), , .so;\n\n  **** : NDKplatform \".a\" , , ;\n\n-   so  :  Android.mk , ndkndk-build;\n- Java :  Java , , , \n\n~~~ C++\nstatic{ System.loadLibrary(\"hello\"); } ;\n~~~\n\n- Application.mk :\n\n~~~ Java\nAPP_STL := stlport_static\nAPP_ABI := all\n~~~\n\n<!-- ![]({{ site.url }}/assets/img/jni_structure.png  =338x461) -->\n<!--  -->\n\n<!-- [![Pure CSS Happy Hacking Keyboard](/assets/img/jni_structure.png)](http://codepen.io/P233/pen/qEagi) -->\n![Eclipse JNI](http://oui2w5whj.bkt.clouddn.com/blogimages/2016/jni_structure.png)\n\n[](http://blog.csdn.net/hejinjing_tom_com/article/details/8125648)javah\n\n\n### 4.\n\n- JavaStringCchar\nC\n\n~~~ Javascript\n// javajstring, c  \nchar* Jstring2CStr(JNIEnv* env, jstring jstr) {  \n// rtn  \nchar* rtn = NULL;  \n//JavaStringClass  \njclass clsstring = (*env)->FindClass(env, \"java/lang/String\");  \n//Java \"GB2312\"  \njstring strencode = (*env)->NewStringUTF(env, \"GB2312\");  \n/*\n * String getBytes(),  String,  byte[]\n * \"(Ljava/lang/String;)[B\"  :\n * -- Ljava/lang/String; String\n * -- [B : , Bbyte, byte\n */  \njmethodID mid = (*env)->GetMethodID(env, clsstring, \"getBytes\",  \n\t\t\"(Ljava/lang/String;)[B\");  \n//JavagetBytes,  , id ,   \njbyteArray barr = (jbyteArray)(*env)->CallObjectMethod(env, jstr, mid,  \n\t\tstrencode); // String .getByte(\"GB2312\");  \n//  \njsize alen = (*env)->GetArrayLength(env, barr);  \n// ,  jbyte*  \njbyte* ba = (*env)->GetByteArrayElements(env, barr, JNI_FALSE);  \n//JavaCchar*, C '\\0'  \nif (alen > 0) {  \n\trtn = (char*) malloc(alen + 1); //new   char[alen+1]; \"\\0\"  \n\tmemcpy(rtn, ba, alen);  \n\trtn[alen] = 0;  \n}  \n(*env)->ReleaseByteArrayElements(env, barr, ba, 0); //  \n\treturn rtn;  \n}  \n~~~\n\n- Jstring2CStr :\n   - a. JavaStringclass :  :  env, String ;\n~~~ Javascript\njclass clsstring = (*env)->FindClass(env, \"java/lang/String\");  \n~~~\n   - b.Java :  NewStringUTF ;\n~~~ Javascript\njstring strencode = (*env)->NewStringUTF(env, \"GB2312\");  \n~~~   \n   - c.StringgetBytes() :   env       ,  Ljava/lang/String; String, [B  , Bbyte, byte;\n~~~ Javascript\njmethodID mid = (*env)->GetMethodID(env, clsstring, \"getBytes\",  \n    \"(Ljava/lang/String;)[B\");  \n~~~       \n   - d.  :\n~~~ Javascript\njsize alen = (*env)->GetArrayLength(env, barr);  \n~~~\n   - e.  :  ,  jbyte*;\n~~~ Javascript\njbyte* ba = (*env)->GetByteArrayElements(env, barr, JNI_FALSE);  \n~~~\n   - f.: JavaCchar*, C '\\0';\n~~~ Javascript\nif (alen > 0) {  \n    rtn = (char*) malloc(alen + 1); //new   char[alen+1]; \"\\0\"  \n    memcpy(rtn, ba, alen);  \n    rtn[alen] = 0;  \n}  \n~~~\n   - g. :\n~~~ Javascript\n(*env)->ReleaseByteArrayElements(env, barr, ba, 0); //\n~~~\n\n### 5.JNI(JNI)\n\n- **JNIJavaNative :**\n\n  , javahbin/classes, ;\n\n- **JNI:**\n\n   : JNIJNIEnv;\n\n   : Native, Java, Native, JavaClass;\n\n- **JNI:**  \n\n  +Java+++ JNIEnv+ jobject+;\n\n   : Java       \"\\_\" ;\n\n- **  :**\n\n  Native : public int hello (String str, int i);\n\n  JNI: jint Java_shuliang_han_Hello_hello(JNIEnv * env, jobject obj, jstring str, jint i);\n\n- **   :**\n\n  Native : public static int hello (String str, int i);\n\n  JNI : jint Java_shuliang_han_Hello_hello(JNIEnv * env, jobject clazz, jstring str, jint i);\n\n- ** :**\n\n  JavaJNI, Android, Android  JNI,   Native  JNI;\n\n- **JNIEnv :**\n\n  JNIEnv ,JNI, jni.h, Java  JNI , JNIEnv JNI java, java;\n\n- **JNI :**\n\n  JNIEnv,JNIEnv, Java, JNIEnv, NativeJava;\n\n- **JNIEnv :**\n\n  JNIEnv,,JNI.\n\n### 6.AES\nAES\n\n- 1.GithubJNIAES[](https://github.com/MasonLiuChn/AndroidUltimateEncrypt)\n\n- 2.JNIkeyValueivJava[](http://blog.csdn.net/why_2012_gogo/article/details/40055245)\n\n\n\n~~~ Java\nstatic {\n\tSystem.loadLibrary(\"cwtlib\");\n\tkeyValue = getKeyValue();\n\tiv = getIv();\n\n\tif(null != keyValue &&\n\t\tnull != iv) {\n\t\tKeyGenerator kgen;  \n        try {  \n            kgen = KeyGenerator.getInstance(\"AES\");  \n            kgen.init(128, new SecureRandom(keyValue));  \n            key = kgen.generateKey();  \n            paramSpec = new IvParameterSpec(iv);  \n            ecipher = Cipher.getInstance(\"AES/CBC/PKCS5Padding\");         \n        } catch (NoSuchAlgorithmException e) {  \n        } catch (NoSuchPaddingException e) {  \n        }  \n\t}\n}   \n\npublic static native byte[] getKeyValue();\npublic static native byte[] getIv();\n~~~\n\n  android appapp****\n\n- 3.CC++AES\n\n  \n\n### 7.JNI\n\n   C/C++Java\n\n  \n\n~~~ Java\n//jni\n-keep class com.your.jnicallback.class { *; }\n//\n-keepclasseswithmembernames class * {\n    native <methods>;\n}\n~~~\n\n### 8.\nandroid JNI\n\n#### 8.1 JNIpublickey\n64.0.4[JNIpublickey](https://agehua.github.io/2016/05/24/JNI-Learning0/)\n","source":"_posts/2016-05-24-JNI-Learning.md","raw":"---\nlayout: post\ntitle: android JNI \ncategory: accumulation\ntags:\n  - JNI\n  - AES\nkeywords: jni, aes \ndescription: android JNIaes\nbanner: http://obxk8w81b.bkt.clouddn.com/Avenue%20of%20Plane%20Trees%20near%20Arles%20Station.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Avenue%20of%20Plane%20Trees%20near%20Arles%20Station.jpg\n---\n\n\n\n\n\n### 1.JNI\nJNI : Java,Java Native Interface, , JavaC/C++,  Java, C/C++ Java;\n\nCJava :\n\n- C : C  function;\n- Java : Java JVM, class, class;\n\nCJava :\n\n- JNI : CJava, ,  JNI, JNI;\n- CJava : CJavaclass, ;\n- JavaC : Java, CJava;\n- JNI : JNI, CJava;\n\n<!--more-->\n\nJNI :\n\n- native : Java, ;\n- Native : JavanativeNative;\n- JNI : JavaNative;\n- JNI : JNIEnv, jni.h;\n- JNI : NativeJNI C/C++, jniC;\n\n### 2.NDK\nC : C, ,   ;\n\n-  : unix.so, windows.dll ; C;\n-  :.a;\n\n : C   , , CPU  ;\n\n- CPU : arm, ; x86, pc; CPU;\n-  :windows x86arm;\n-  : Google NDK , linuxarn;\n\nNDK : Google, linuxarm;\n\nNDK : android-ndk-windows windowscygwin, android-ndk-linux linux;\n\nNDKcygwinCcygwin\n\n### 3.android studioEclipse\nEclipseEclipse.hso[Eclipse ADT.h/.so](http://blog.csdn.net/jspping/article/details/47780307)\n\n#### 3.1 JavaC\n\n- a.  Native  : com.packagename.jni.JNITest.java  Native  public native int add(int x, int y);\n- b.  :  AndroidProject/bin/classes ,  javah com.packagename.jni.JNITest , ,  jni.h,  Native ,  JNIEXPORT jint JNICALL Java_com_packagename_jni_JNITest_add (JNIEnv \\*, jobject, jint, jint);  \n\nJava :\n\n~~~ Java\n//Javaint C, , java shuliang.han.ndkparameterpassing.DataProvider  \npublic native int add(int x, int y);  \n~~~\nC :\n\n~~~ C++\n#include <jni.h>  \n\n//, Javanative, native  \njint Java_com_packagename_jni_JNITest_add(JNIEnv * env, jobject obj, jint x, jint y)  \n{  \n    return x + y;  \n}  \n~~~\n\n#### 3.2 .so\n\nAndroid.mk \n\n~~~ C++\nLOCAL_PATH := $(call my-dir)    \n\ninclude $(CLEAR_VARS)    \n\nLOCAL_MODULE    := hello-jni    \nLOCAL_SRC_FILES := hello-jni.c    \n\ninclude $(BUILD_SHARED_LIBRARY)  \n~~~\n\n- \n\n  **** : $(call my-dir) , , ;\n\n  **** : \" := \" ,   ,  LOCAL_PATH;\n\n  **** : $(CLEAR_VARS) , LOCAL_MODULE LOCAL_SRC_FILES ;\n\n  **** : LOCAL_MODULE    := hello-jni ,  so ,  \"lib\",  \".so\";\n\n  **** : LOCAL_SRC_FILES := hello-jni.c , ;\n\n  **** : include $(BUILD_SHARED_LIBRARY), , .so;\n\n  **** : NDKplatform \".a\" , , ;\n\n-   so  :  Android.mk , ndkndk-build;\n- Java :  Java , , , \n\n~~~ C++\nstatic{ System.loadLibrary(\"hello\"); } ;\n~~~\n\n- Application.mk :\n\n~~~ Java\nAPP_STL := stlport_static\nAPP_ABI := all\n~~~\n\n<!-- ![]({{ site.url }}/assets/img/jni_structure.png  =338x461) -->\n<!--  -->\n\n<!-- [![Pure CSS Happy Hacking Keyboard](/assets/img/jni_structure.png)](http://codepen.io/P233/pen/qEagi) -->\n![Eclipse JNI](http://oui2w5whj.bkt.clouddn.com/blogimages/2016/jni_structure.png)\n\n[](http://blog.csdn.net/hejinjing_tom_com/article/details/8125648)javah\n\n\n### 4.\n\n- JavaStringCchar\nC\n\n~~~ Javascript\n// javajstring, c  \nchar* Jstring2CStr(JNIEnv* env, jstring jstr) {  \n// rtn  \nchar* rtn = NULL;  \n//JavaStringClass  \njclass clsstring = (*env)->FindClass(env, \"java/lang/String\");  \n//Java \"GB2312\"  \njstring strencode = (*env)->NewStringUTF(env, \"GB2312\");  \n/*\n * String getBytes(),  String,  byte[]\n * \"(Ljava/lang/String;)[B\"  :\n * -- Ljava/lang/String; String\n * -- [B : , Bbyte, byte\n */  \njmethodID mid = (*env)->GetMethodID(env, clsstring, \"getBytes\",  \n\t\t\"(Ljava/lang/String;)[B\");  \n//JavagetBytes,  , id ,   \njbyteArray barr = (jbyteArray)(*env)->CallObjectMethod(env, jstr, mid,  \n\t\tstrencode); // String .getByte(\"GB2312\");  \n//  \njsize alen = (*env)->GetArrayLength(env, barr);  \n// ,  jbyte*  \njbyte* ba = (*env)->GetByteArrayElements(env, barr, JNI_FALSE);  \n//JavaCchar*, C '\\0'  \nif (alen > 0) {  \n\trtn = (char*) malloc(alen + 1); //new   char[alen+1]; \"\\0\"  \n\tmemcpy(rtn, ba, alen);  \n\trtn[alen] = 0;  \n}  \n(*env)->ReleaseByteArrayElements(env, barr, ba, 0); //  \n\treturn rtn;  \n}  \n~~~\n\n- Jstring2CStr :\n   - a. JavaStringclass :  :  env, String ;\n~~~ Javascript\njclass clsstring = (*env)->FindClass(env, \"java/lang/String\");  \n~~~\n   - b.Java :  NewStringUTF ;\n~~~ Javascript\njstring strencode = (*env)->NewStringUTF(env, \"GB2312\");  \n~~~   \n   - c.StringgetBytes() :   env       ,  Ljava/lang/String; String, [B  , Bbyte, byte;\n~~~ Javascript\njmethodID mid = (*env)->GetMethodID(env, clsstring, \"getBytes\",  \n    \"(Ljava/lang/String;)[B\");  \n~~~       \n   - d.  :\n~~~ Javascript\njsize alen = (*env)->GetArrayLength(env, barr);  \n~~~\n   - e.  :  ,  jbyte*;\n~~~ Javascript\njbyte* ba = (*env)->GetByteArrayElements(env, barr, JNI_FALSE);  \n~~~\n   - f.: JavaCchar*, C '\\0';\n~~~ Javascript\nif (alen > 0) {  \n    rtn = (char*) malloc(alen + 1); //new   char[alen+1]; \"\\0\"  \n    memcpy(rtn, ba, alen);  \n    rtn[alen] = 0;  \n}  \n~~~\n   - g. :\n~~~ Javascript\n(*env)->ReleaseByteArrayElements(env, barr, ba, 0); //\n~~~\n\n### 5.JNI(JNI)\n\n- **JNIJavaNative :**\n\n  , javahbin/classes, ;\n\n- **JNI:**\n\n   : JNIJNIEnv;\n\n   : Native, Java, Native, JavaClass;\n\n- **JNI:**  \n\n  +Java+++ JNIEnv+ jobject+;\n\n   : Java       \"\\_\" ;\n\n- **  :**\n\n  Native : public int hello (String str, int i);\n\n  JNI: jint Java_shuliang_han_Hello_hello(JNIEnv * env, jobject obj, jstring str, jint i);\n\n- **   :**\n\n  Native : public static int hello (String str, int i);\n\n  JNI : jint Java_shuliang_han_Hello_hello(JNIEnv * env, jobject clazz, jstring str, jint i);\n\n- ** :**\n\n  JavaJNI, Android, Android  JNI,   Native  JNI;\n\n- **JNIEnv :**\n\n  JNIEnv ,JNI, jni.h, Java  JNI , JNIEnv JNI java, java;\n\n- **JNI :**\n\n  JNIEnv,JNIEnv, Java, JNIEnv, NativeJava;\n\n- **JNIEnv :**\n\n  JNIEnv,,JNI.\n\n### 6.AES\nAES\n\n- 1.GithubJNIAES[](https://github.com/MasonLiuChn/AndroidUltimateEncrypt)\n\n- 2.JNIkeyValueivJava[](http://blog.csdn.net/why_2012_gogo/article/details/40055245)\n\n\n\n~~~ Java\nstatic {\n\tSystem.loadLibrary(\"cwtlib\");\n\tkeyValue = getKeyValue();\n\tiv = getIv();\n\n\tif(null != keyValue &&\n\t\tnull != iv) {\n\t\tKeyGenerator kgen;  \n        try {  \n            kgen = KeyGenerator.getInstance(\"AES\");  \n            kgen.init(128, new SecureRandom(keyValue));  \n            key = kgen.generateKey();  \n            paramSpec = new IvParameterSpec(iv);  \n            ecipher = Cipher.getInstance(\"AES/CBC/PKCS5Padding\");         \n        } catch (NoSuchAlgorithmException e) {  \n        } catch (NoSuchPaddingException e) {  \n        }  \n\t}\n}   \n\npublic static native byte[] getKeyValue();\npublic static native byte[] getIv();\n~~~\n\n  android appapp****\n\n- 3.CC++AES\n\n  \n\n### 7.JNI\n\n   C/C++Java\n\n  \n\n~~~ Java\n//jni\n-keep class com.your.jnicallback.class { *; }\n//\n-keepclasseswithmembernames class * {\n    native <methods>;\n}\n~~~\n\n### 8.\nandroid JNI\n\n#### 8.1 JNIpublickey\n64.0.4[JNIpublickey](https://agehua.github.io/2016/05/24/JNI-Learning0/)\n","slug":"JNI-Learning","published":1,"date":"2016-05-23T16:00:00.000Z","updated":"2017-11-23T07:04:34.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ebwx000qd6ykm6a060j6","content":"<p></p>\n<h3 id=\"1-JNI\"><a href=\"#1-JNI\" class=\"headerlink\" title=\"1.JNI\"></a>1.JNI</h3><p>JNI : Java,Java Native Interface, , JavaC/C++,  Java, C/C++ Java;</p>\n<p>CJava :</p>\n<ul>\n<li>C : C  function;</li>\n<li>Java : Java JVM, class, class;</li>\n</ul>\n<p>CJava :</p>\n<ul>\n<li>JNI : CJava, ,  JNI, JNI;</li>\n<li>CJava : CJavaclass, ;</li>\n<li>JavaC : Java, CJava;</li>\n<li>JNI : JNI, CJava;</li>\n</ul>\n<a id=\"more\"></a>\n<p>JNI :</p>\n<ul>\n<li>native : Java, ;</li>\n<li>Native : JavanativeNative;</li>\n<li>JNI : JavaNative;</li>\n<li>JNI : JNIEnv, jni.h;</li>\n<li>JNI : NativeJNI C/C++, jniC;</li>\n</ul>\n<h3 id=\"2-NDK\"><a href=\"#2-NDK\" class=\"headerlink\" title=\"2.NDK\"></a>2.NDK</h3><p>C : C, ,   ;</p>\n<ul>\n<li> : unix.so, windows.dll ; C;</li>\n<li> :.a;</li>\n</ul>\n<p> : C   , , CPU  ;</p>\n<ul>\n<li>CPU : arm, ; x86, pc; CPU;</li>\n<li> :windows x86arm;</li>\n<li> : Google NDK , linuxarn;</li>\n</ul>\n<p>NDK : Google, linuxarm;</p>\n<p>NDK : android-ndk-windows windowscygwin, android-ndk-linux linux;</p>\n<p>NDKcygwinCcygwin</p>\n<h3 id=\"3-android-studioEclipse\"><a href=\"#3-android-studioEclipse\" class=\"headerlink\" title=\"3.android studioEclipse\"></a>3.android studioEclipse</h3><p>EclipseEclipse.hso<a href=\"http://blog.csdn.net/jspping/article/details/47780307\" target=\"_blank\" rel=\"external\">Eclipse ADT.h/.so</a></p>\n<h4 id=\"3-1-JavaC\"><a href=\"#3-1-JavaC\" class=\"headerlink\" title=\"3.1 JavaC\"></a>3.1 JavaC</h4><ul>\n<li>a.  Native  : com.packagename.jni.JNITest.java  Native  public native int add(int x, int y);</li>\n<li>b.  :  AndroidProject/bin/classes ,  javah com.packagename.jni.JNITest , ,  jni.h,  Native ,  JNIEXPORT jint JNICALL Java_com_packagename_jni_JNITest_add (JNIEnv *, jobject, jint, jint);  </li>\n</ul>\n<p>Java :</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//Javaint C, , java shuliang.han.ndkparameterpassing.DataProvider  </span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">native</span> <span class=\"keyword\">int</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> y)</span></span>;</div></pre></td></tr></table></figure>\n<p>C :</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;jni.h&gt;</span>  </span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">//, Javanative, native  </span></div><div class=\"line\"><span class=\"function\">jint <span class=\"title\">Java_com_packagename_jni_JNITest_add</span><span class=\"params\">(JNIEnv * env, jobject obj, jint x, jint y)</span>  </span></div><div class=\"line\">&#123;  </div><div class=\"line\">    <span class=\"keyword\">return</span> x + y;  </div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h4 id=\"3-2--so\"><a href=\"#3-2--so\" class=\"headerlink\" title=\"3.2 .so\"></a>3.2 .so</h4><p>Android.mk </p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">LOCAL_PATH := $(call my-dir)    </div><div class=\"line\"></div><div class=\"line\">include $(CLEAR_VARS)    </div><div class=\"line\"></div><div class=\"line\">LOCAL_MODULE    := hello-jni    </div><div class=\"line\">LOCAL_SRC_FILES := hello-jni.c    </div><div class=\"line\"></div><div class=\"line\">include $(BUILD_SHARED_LIBRARY)</div></pre></td></tr></table></figure>\n<ul>\n<li><p></p>\n<p><strong></strong> : $(call my-dir) , , ;</p>\n<p><strong></strong> :  :=  ,   ,  LOCAL_PATH;</p>\n<p><strong></strong> : $(CLEAR_VARS) , LOCAL_MODULE LOCAL_SRC_FILES ;</p>\n<p><strong></strong> : LOCAL_MODULE    := hello-jni ,  so ,  lib,  .so;</p>\n<p><strong></strong> : LOCAL_SRC_FILES := hello-jni.c , ;</p>\n<p><strong></strong> : include $(BUILD_SHARED_LIBRARY), , .so;</p>\n<p><strong></strong> : NDKplatform .a , , ;</p>\n</li>\n<li><p>  so  :  Android.mk , ndkndk-build;</p>\n</li>\n<li>Java :  Java , , , </li>\n</ul>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">static</span>&#123; System.loadLibrary(<span class=\"string\">\"hello\"</span>); &#125; ;</div></pre></td></tr></table></figure>\n<ul>\n<li>Application.mk :</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">APP_STL := stlport_static</div><div class=\"line\">APP_ABI := all</div></pre></td></tr></table></figure>\n<!-- ![](/assets/img/jni_structure.png  =338x461) &gt;\n<!--  -->\n<!-- [![Pure CSS Happy Hacking Keyboard](/assets/img/jni_structure.png)](http://codepen.io/P233/pen/qEagi) -->\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2016/jni_structure.png\" alt=\"Eclipse JNI\"></p>\n<p><a href=\"http://blog.csdn.net/hejinjing_tom_com/article/details/8125648\" target=\"_blank\" rel=\"external\"></a>javah</p>\n<h3 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4.\"></a>4.</h3><ul>\n<li>JavaStringCchar<br>C</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// javajstring, c  </span></div><div class=\"line\">char* Jstring2CStr(JNIEnv* env, jstring jstr) &#123;  </div><div class=\"line\"><span class=\"comment\">// rtn  </span></div><div class=\"line\">char* rtn = NULL;  </div><div class=\"line\"><span class=\"comment\">//JavaStringClass  </span></div><div class=\"line\">jclass clsstring = (*env)-&gt;FindClass(env, <span class=\"string\">\"java/lang/String\"</span>);  </div><div class=\"line\"><span class=\"comment\">//Java \"GB2312\"  </span></div><div class=\"line\">jstring strencode = (*env)-&gt;NewStringUTF(env, <span class=\"string\">\"GB2312\"</span>);  </div><div class=\"line\"><span class=\"comment\">/*</span></div><div class=\"line\"> * String getBytes(),  String,  byte[]</div><div class=\"line\"> * \"(Ljava/lang/String;)[B\"  :</div><div class=\"line\"> * -- Ljava/lang/String; String</div><div class=\"line\"> * -- [B : , Bbyte, byte</div><div class=\"line\"> */  </div><div class=\"line\">jmethodID mid = (*env)-&gt;GetMethodID(env, clsstring, <span class=\"string\">\"getBytes\"</span>,  </div><div class=\"line\">\t\t<span class=\"string\">\"(Ljava/lang/String;)[B\"</span>);  </div><div class=\"line\"><span class=\"comment\">//JavagetBytes,  , id ,   </span></div><div class=\"line\">jbyteArray barr = (jbyteArray)(*env)-&gt;CallObjectMethod(env, jstr, mid,  </div><div class=\"line\">\t\tstrencode); <span class=\"comment\">// String .getByte(\"GB2312\");  </span></div><div class=\"line\"><span class=\"comment\">//  </span></div><div class=\"line\">jsize alen = (*env)-&gt;GetArrayLength(env, barr);  </div><div class=\"line\"><span class=\"comment\">// ,  jbyte*  </span></div><div class=\"line\">jbyte* ba = (*env)-&gt;GetByteArrayElements(env, barr, JNI_FALSE);  </div><div class=\"line\"><span class=\"comment\">//JavaCchar*, C '\\0'  </span></div><div class=\"line\"><span class=\"keyword\">if</span> (alen &gt; <span class=\"number\">0</span>) &#123;  </div><div class=\"line\">\trtn = (char*) malloc(alen + <span class=\"number\">1</span>); <span class=\"comment\">//new   char[alen+1]; \"\\0\"  </span></div><div class=\"line\">\tmemcpy(rtn, ba, alen);  </div><div class=\"line\">\trtn[alen] = <span class=\"number\">0</span>;  </div><div class=\"line\">&#125;  </div><div class=\"line\">(*env)-&gt;ReleaseByteArrayElements(env, barr, ba, <span class=\"number\">0</span>); <span class=\"comment\">//  </span></div><div class=\"line\">\t<span class=\"keyword\">return</span> rtn;  </div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<ul>\n<li><p>Jstring2CStr :</p>\n<ul>\n<li><p>a. JavaStringclass :  :  env, String ;</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">jclass clsstring = (*env)-&gt;FindClass(env, <span class=\"string\">\"java/lang/String\"</span>);</div></pre></td></tr></table></figure>\n</li>\n<li><p>b.Java :  NewStringUTF ;</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">jstring strencode = (*env)-&gt;NewStringUTF(env, <span class=\"string\">\"GB2312\"</span>);  </div><div class=\"line\">~~~   </div><div class=\"line\">   - c.<span class=\"built_in\">String</span>getBytes() :   env       ,  Ljava/lang/<span class=\"built_in\">String</span>; <span class=\"built_in\">String</span>, [B  , Bbyte, byte;</div><div class=\"line\">~~~ Javascript</div><div class=\"line\">jmethodID mid = (*env)-&gt;GetMethodID(env, clsstring, <span class=\"string\">\"getBytes\"</span>,  </div><div class=\"line\">    <span class=\"string\">\"(Ljava/lang/String;)[B\"</span>);  </div><div class=\"line\">~~~       </div><div class=\"line\">   - d.  :</div><div class=\"line\">~~~ Javascript</div><div class=\"line\">jsize alen = (*env)-&gt;GetArrayLength(env, barr);</div></pre></td></tr></table></figure>\n</li>\n<li><p>e.  :  ,  jbyte*;</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">jbyte* ba = (*env)-&gt;GetByteArrayElements(env, barr, JNI_FALSE);</div></pre></td></tr></table></figure>\n</li>\n<li><p>f.: JavaCchar*, C \\0;</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">if</span> (alen &gt; <span class=\"number\">0</span>) &#123;  </div><div class=\"line\">    rtn = (char*) malloc(alen + <span class=\"number\">1</span>); <span class=\"comment\">//new   char[alen+1]; \"\\0\"  </span></div><div class=\"line\">    memcpy(rtn, ba, alen);  </div><div class=\"line\">    rtn[alen] = <span class=\"number\">0</span>;  </div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n</li>\n<li><p>g. :</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">(*env)-&gt;ReleaseByteArrayElements(env, barr, ba, <span class=\"number\">0</span>); <span class=\"comment\">//</span></div></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"5-JNI-JNI\"><a href=\"#5-JNI-JNI\" class=\"headerlink\" title=\"5.JNI(JNI)\"></a>5.JNI(JNI)</h3><ul>\n<li><p><strong>JNIJavaNative :</strong></p>\n<p>, javahbin/classes, ;</p>\n</li>\n<li><p><strong>JNI:</strong></p>\n<p> : JNIJNIEnv;</p>\n<p> : Native, Java, Native, JavaClass;</p>\n</li>\n<li><p><strong>JNI:</strong>  </p>\n<p>+Java+++ JNIEnv+ jobject+;</p>\n<p> : Java       _ ;</p>\n</li>\n<li><p><strong>  :</strong></p>\n<p>Native : public int hello (String str, int i);</p>\n<p>JNI: jint Java_shuliang_han_Hello_hello(JNIEnv * env, jobject obj, jstring str, jint i);</p>\n</li>\n<li><p><strong>   :</strong></p>\n<p>Native : public static int hello (String str, int i);</p>\n<p>JNI : jint Java_shuliang_han_Hello_hello(JNIEnv * env, jobject clazz, jstring str, jint i);</p>\n</li>\n<li><p><strong> :</strong></p>\n<p>JavaJNI, Android, Android  JNI,   Native  JNI;</p>\n</li>\n<li><p><strong>JNIEnv :</strong></p>\n<p>JNIEnv ,JNI, jni.h, Java  JNI , JNIEnv JNI java, java;</p>\n</li>\n<li><p><strong>JNI :</strong></p>\n<p>JNIEnv,JNIEnv, Java, JNIEnv, NativeJava;</p>\n</li>\n<li><p><strong>JNIEnv :</strong></p>\n<p>JNIEnv,,JNI.</p>\n</li>\n</ul>\n<h3 id=\"6-AES\"><a href=\"#6-AES\" class=\"headerlink\" title=\"6.AES\"></a>6.AES</h3><p>AES</p>\n<ul>\n<li><p>1.GithubJNIAES<a href=\"https://github.com/MasonLiuChn/AndroidUltimateEncrypt\" target=\"_blank\" rel=\"external\"></a></p>\n</li>\n<li><p>2.JNIkeyValueivJava<a href=\"http://blog.csdn.net/why_2012_gogo/article/details/40055245\" target=\"_blank\" rel=\"external\"></a></p>\n</li>\n</ul>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">static</span> &#123;</div><div class=\"line\">\tSystem.loadLibrary(<span class=\"string\">\"cwtlib\"</span>);</div><div class=\"line\">\tkeyValue = getKeyValue();</div><div class=\"line\">\tiv = getIv();</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">if</span>(<span class=\"keyword\">null</span> != keyValue &amp;&amp;</div><div class=\"line\">\t\t<span class=\"keyword\">null</span> != iv) &#123;</div><div class=\"line\">\t\tKeyGenerator kgen;  </div><div class=\"line\">        <span class=\"keyword\">try</span> &#123;  </div><div class=\"line\">            kgen = KeyGenerator.getInstance(<span class=\"string\">\"AES\"</span>);  </div><div class=\"line\">            kgen.init(<span class=\"number\">128</span>, <span class=\"keyword\">new</span> SecureRandom(keyValue));  </div><div class=\"line\">            key = kgen.generateKey();  </div><div class=\"line\">            paramSpec = <span class=\"keyword\">new</span> IvParameterSpec(iv);  </div><div class=\"line\">            ecipher = Cipher.getInstance(<span class=\"string\">\"AES/CBC/PKCS5Padding\"</span>);         </div><div class=\"line\">        &#125; <span class=\"keyword\">catch</span> (NoSuchAlgorithmException e) &#123;  </div><div class=\"line\">        &#125; <span class=\"keyword\">catch</span> (NoSuchPaddingException e) &#123;  </div><div class=\"line\">        &#125;  </div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;   </div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">native</span> <span class=\"keyword\">byte</span>[] getKeyValue();</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">native</span> <span class=\"keyword\">byte</span>[] getIv();</div></pre></td></tr></table></figure>\n<p>  android appapp<strong></strong></p>\n<ul>\n<li><p>3.CC++AES</p>\n<p></p>\n</li>\n</ul>\n<h3 id=\"7-JNI\"><a href=\"#7-JNI\" class=\"headerlink\" title=\"7.JNI\"></a>7.JNI</h3><p>   C/C++Java</p>\n<p>  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//jni</span></div><div class=\"line\">-keep <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">com</span>.<span class=\"title\">your</span>.<span class=\"title\">jnicallback</span>.<span class=\"title\">class</span> </span>&#123; *; &#125;</div><div class=\"line\"><span class=\"comment\">//</span></div><div class=\"line\">-keepclasseswithmembernames <span class=\"class\"><span class=\"keyword\">class</span> * </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">native</span> &lt;methods&gt;;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"8-\"><a href=\"#8-\" class=\"headerlink\" title=\"8.\"></a>8.</h3><p>android JNI</p>\n<h4 id=\"8-1-JNIpublickey\"><a href=\"#8-1-JNIpublickey\" class=\"headerlink\" title=\"8.1 JNIpublickey\"></a>8.1 JNIpublickey</h4><p>64.0.4<a href=\"https://agehua.github.io/2016/05/24/JNI-Learning0/\">JNIpublickey</a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/05/24/JNI-Learning/\">http://agehua.github.io/2016/05/24/JNI-Learning/</a></p>\n","readingTime":{"text":"6 min read","minutes":5.42,"time":325200,"words":1084},"excerpt":"<p></p>\n<h3 id=\"1-JNI\"><a href=\"#1-JNI\" class=\"headerlink\" title=\"1.JNI\"></a>1.JNI</h3><p>JNI : Java,Java Native Interface, , JavaC/C++,  Java, C/C++ Java;</p>\n<p>CJava :</p>\n<ul>\n<li>C : C  function;</li>\n<li>Java : Java JVM, class, class;</li>\n</ul>\n<p>CJava :</p>\n<ul>\n<li>JNI : CJava, ,  JNI, JNI;</li>\n<li>CJava : CJavaclass, ;</li>\n<li>JavaC : Java, CJava;</li>\n<li>JNI : JNI, CJava;</li>\n</ul>","more":"<p>JNI :</p>\n<ul>\n<li>native : Java, ;</li>\n<li>Native : JavanativeNative;</li>\n<li>JNI : JavaNative;</li>\n<li>JNI : JNIEnv, jni.h;</li>\n<li>JNI : NativeJNI C/C++, jniC;</li>\n</ul>\n<h3 id=\"2-NDK\"><a href=\"#2-NDK\" class=\"headerlink\" title=\"2.NDK\"></a>2.NDK</h3><p>C : C, ,   ;</p>\n<ul>\n<li> : unix.so, windows.dll ; C;</li>\n<li> :.a;</li>\n</ul>\n<p> : C   , , CPU  ;</p>\n<ul>\n<li>CPU : arm, ; x86, pc; CPU;</li>\n<li> :windows x86arm;</li>\n<li> : Google NDK , linuxarn;</li>\n</ul>\n<p>NDK : Google, linuxarm;</p>\n<p>NDK : android-ndk-windows windowscygwin, android-ndk-linux linux;</p>\n<p>NDKcygwinCcygwin</p>\n<h3 id=\"3-android-studioEclipse\"><a href=\"#3-android-studioEclipse\" class=\"headerlink\" title=\"3.android studioEclipse\"></a>3.android studioEclipse</h3><p>EclipseEclipse.hso<a href=\"http://blog.csdn.net/jspping/article/details/47780307\">Eclipse ADT.h/.so</a></p>\n<h4 id=\"3-1-JavaC\"><a href=\"#3-1-JavaC\" class=\"headerlink\" title=\"3.1 JavaC\"></a>3.1 JavaC</h4><ul>\n<li>a.  Native  : com.packagename.jni.JNITest.java  Native  public native int add(int x, int y);</li>\n<li>b.  :  AndroidProject/bin/classes ,  javah com.packagename.jni.JNITest , ,  jni.h,  Native ,  JNIEXPORT jint JNICALL Java_com_packagename_jni_JNITest_add (JNIEnv *, jobject, jint, jint);  </li>\n</ul>\n<p>Java :</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//Javaint C, , java shuliang.han.ndkparameterpassing.DataProvider  </span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">native</span> <span class=\"keyword\">int</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> y)</span></span>;</div></pre></td></tr></table></figure>\n<p>C :</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;jni.h&gt;</span>  </span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">//, Javanative, native  </span></div><div class=\"line\"><span class=\"function\">jint <span class=\"title\">Java_com_packagename_jni_JNITest_add</span><span class=\"params\">(JNIEnv * env, jobject obj, jint x, jint y)</span>  </div><div class=\"line\"></span>&#123;  </div><div class=\"line\">    <span class=\"keyword\">return</span> x + y;  </div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h4 id=\"3-2--so\"><a href=\"#3-2--so\" class=\"headerlink\" title=\"3.2 .so\"></a>3.2 .so</h4><p>Android.mk </p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">LOCAL_PATH := $(call my-dir)    </div><div class=\"line\"></div><div class=\"line\">include $(CLEAR_VARS)    </div><div class=\"line\"></div><div class=\"line\">LOCAL_MODULE    := hello-jni    </div><div class=\"line\">LOCAL_SRC_FILES := hello-jni.c    </div><div class=\"line\"></div><div class=\"line\">include $(BUILD_SHARED_LIBRARY)</div></pre></td></tr></table></figure>\n<ul>\n<li><p></p>\n<p><strong></strong> : $(call my-dir) , , ;</p>\n<p><strong></strong> :  :=  ,   ,  LOCAL_PATH;</p>\n<p><strong></strong> : $(CLEAR_VARS) , LOCAL_MODULE LOCAL_SRC_FILES ;</p>\n<p><strong></strong> : LOCAL_MODULE    := hello-jni ,  so ,  lib,  .so;</p>\n<p><strong></strong> : LOCAL_SRC_FILES := hello-jni.c , ;</p>\n<p><strong></strong> : include $(BUILD_SHARED_LIBRARY), , .so;</p>\n<p><strong></strong> : NDKplatform .a , , ;</p>\n</li>\n<li><p>  so  :  Android.mk , ndkndk-build;</p>\n</li>\n<li>Java :  Java , , , </li>\n</ul>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">static</span>&#123; System.loadLibrary(<span class=\"string\">\"hello\"</span>); &#125; ;</div></pre></td></tr></table></figure>\n<ul>\n<li>Application.mk :</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">APP_STL := stlport_static</div><div class=\"line\">APP_ABI := all</div></pre></td></tr></table></figure>\n<!-- ![](/assets/img/jni_structure.png  =338x461) &gt;\n<!--  -->\n<!-- [![Pure CSS Happy Hacking Keyboard](/assets/img/jni_structure.png)](http://codepen.io/P233/pen/qEagi) -->\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2016/jni_structure.png\" alt=\"Eclipse JNI\"></p>\n<p><a href=\"http://blog.csdn.net/hejinjing_tom_com/article/details/8125648\"></a>javah</p>\n<h3 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4.\"></a>4.</h3><ul>\n<li>JavaStringCchar<br>C</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// javajstring, c  </span></div><div class=\"line\">char* Jstring2CStr(JNIEnv* env, jstring jstr) &#123;  </div><div class=\"line\"><span class=\"comment\">// rtn  </span></div><div class=\"line\">char* rtn = NULL;  </div><div class=\"line\"><span class=\"comment\">//JavaStringClass  </span></div><div class=\"line\">jclass clsstring = (*env)-&gt;FindClass(env, <span class=\"string\">\"java/lang/String\"</span>);  </div><div class=\"line\"><span class=\"comment\">//Java \"GB2312\"  </span></div><div class=\"line\">jstring strencode = (*env)-&gt;NewStringUTF(env, <span class=\"string\">\"GB2312\"</span>);  </div><div class=\"line\"><span class=\"comment\">/*</div><div class=\"line\"> * String getBytes(),  String,  byte[]</div><div class=\"line\"> * \"(Ljava/lang/String;)[B\"  :</div><div class=\"line\"> * -- Ljava/lang/String; String</div><div class=\"line\"> * -- [B : , Bbyte, byte</div><div class=\"line\"> */</span>  </div><div class=\"line\">jmethodID mid = (*env)-&gt;GetMethodID(env, clsstring, <span class=\"string\">\"getBytes\"</span>,  </div><div class=\"line\">\t\t<span class=\"string\">\"(Ljava/lang/String;)[B\"</span>);  </div><div class=\"line\"><span class=\"comment\">//JavagetBytes,  , id ,   </span></div><div class=\"line\">jbyteArray barr = (jbyteArray)(*env)-&gt;CallObjectMethod(env, jstr, mid,  </div><div class=\"line\">\t\tstrencode); <span class=\"comment\">// String .getByte(\"GB2312\");  </span></div><div class=\"line\"><span class=\"comment\">//  </span></div><div class=\"line\">jsize alen = (*env)-&gt;GetArrayLength(env, barr);  </div><div class=\"line\"><span class=\"comment\">// ,  jbyte*  </span></div><div class=\"line\">jbyte* ba = (*env)-&gt;GetByteArrayElements(env, barr, JNI_FALSE);  </div><div class=\"line\"><span class=\"comment\">//JavaCchar*, C '\\0'  </span></div><div class=\"line\"><span class=\"keyword\">if</span> (alen &gt; <span class=\"number\">0</span>) &#123;  </div><div class=\"line\">\trtn = (char*) malloc(alen + <span class=\"number\">1</span>); <span class=\"comment\">//new   char[alen+1]; \"\\0\"  </span></div><div class=\"line\">\tmemcpy(rtn, ba, alen);  </div><div class=\"line\">\trtn[alen] = <span class=\"number\">0</span>;  </div><div class=\"line\">&#125;  </div><div class=\"line\">(*env)-&gt;ReleaseByteArrayElements(env, barr, ba, <span class=\"number\">0</span>); <span class=\"comment\">//  </span></div><div class=\"line\">\t<span class=\"keyword\">return</span> rtn;  </div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<ul>\n<li><p>Jstring2CStr :</p>\n<ul>\n<li><p>a. JavaStringclass :  :  env, String ;</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">jclass clsstring = (*env)-&gt;FindClass(env, <span class=\"string\">\"java/lang/String\"</span>);</div></pre></td></tr></table></figure>\n</li>\n<li><p>b.Java :  NewStringUTF ;</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">jstring strencode = (*env)-&gt;NewStringUTF(env, <span class=\"string\">\"GB2312\"</span>);  </div><div class=\"line\">~~~   </div><div class=\"line\">   - c.<span class=\"built_in\">String</span>getBytes() :   env       ,  Ljava/lang/<span class=\"built_in\">String</span>; <span class=\"built_in\">String</span>, [B  , Bbyte, byte;</div><div class=\"line\">~~~ Javascript</div><div class=\"line\">jmethodID mid = (*env)-&gt;GetMethodID(env, clsstring, <span class=\"string\">\"getBytes\"</span>,  </div><div class=\"line\">    <span class=\"string\">\"(Ljava/lang/String;)[B\"</span>);  </div><div class=\"line\">~~~       </div><div class=\"line\">   - d.  :</div><div class=\"line\">~~~ Javascript</div><div class=\"line\">jsize alen = (*env)-&gt;GetArrayLength(env, barr);</div></pre></td></tr></table></figure>\n</li>\n<li><p>e.  :  ,  jbyte*;</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">jbyte* ba = (*env)-&gt;GetByteArrayElements(env, barr, JNI_FALSE);</div></pre></td></tr></table></figure>\n</li>\n<li><p>f.: JavaCchar*, C \\0;</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">if</span> (alen &gt; <span class=\"number\">0</span>) &#123;  </div><div class=\"line\">    rtn = (char*) malloc(alen + <span class=\"number\">1</span>); <span class=\"comment\">//new   char[alen+1]; \"\\0\"  </span></div><div class=\"line\">    memcpy(rtn, ba, alen);  </div><div class=\"line\">    rtn[alen] = <span class=\"number\">0</span>;  </div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n</li>\n<li><p>g. :</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">(*env)-&gt;ReleaseByteArrayElements(env, barr, ba, <span class=\"number\">0</span>); <span class=\"comment\">//</span></div></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"5-JNI-JNI\"><a href=\"#5-JNI-JNI\" class=\"headerlink\" title=\"5.JNI(JNI)\"></a>5.JNI(JNI)</h3><ul>\n<li><p><strong>JNIJavaNative :</strong></p>\n<p>, javahbin/classes, ;</p>\n</li>\n<li><p><strong>JNI:</strong></p>\n<p> : JNIJNIEnv;</p>\n<p> : Native, Java, Native, JavaClass;</p>\n</li>\n<li><p><strong>JNI:</strong>  </p>\n<p>+Java+++ JNIEnv+ jobject+;</p>\n<p> : Java       _ ;</p>\n</li>\n<li><p><strong>  :</strong></p>\n<p>Native : public int hello (String str, int i);</p>\n<p>JNI: jint Java_shuliang_han_Hello_hello(JNIEnv * env, jobject obj, jstring str, jint i);</p>\n</li>\n<li><p><strong>   :</strong></p>\n<p>Native : public static int hello (String str, int i);</p>\n<p>JNI : jint Java_shuliang_han_Hello_hello(JNIEnv * env, jobject clazz, jstring str, jint i);</p>\n</li>\n<li><p><strong> :</strong></p>\n<p>JavaJNI, Android, Android  JNI,   Native  JNI;</p>\n</li>\n<li><p><strong>JNIEnv :</strong></p>\n<p>JNIEnv ,JNI, jni.h, Java  JNI , JNIEnv JNI java, java;</p>\n</li>\n<li><p><strong>JNI :</strong></p>\n<p>JNIEnv,JNIEnv, Java, JNIEnv, NativeJava;</p>\n</li>\n<li><p><strong>JNIEnv :</strong></p>\n<p>JNIEnv,,JNI.</p>\n</li>\n</ul>\n<h3 id=\"6-AES\"><a href=\"#6-AES\" class=\"headerlink\" title=\"6.AES\"></a>6.AES</h3><p>AES</p>\n<ul>\n<li><p>1.GithubJNIAES<a href=\"https://github.com/MasonLiuChn/AndroidUltimateEncrypt\"></a></p>\n</li>\n<li><p>2.JNIkeyValueivJava<a href=\"http://blog.csdn.net/why_2012_gogo/article/details/40055245\"></a></p>\n</li>\n</ul>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">static</span> &#123;</div><div class=\"line\">\tSystem.loadLibrary(<span class=\"string\">\"cwtlib\"</span>);</div><div class=\"line\">\tkeyValue = getKeyValue();</div><div class=\"line\">\tiv = getIv();</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">if</span>(<span class=\"keyword\">null</span> != keyValue &amp;&amp;</div><div class=\"line\">\t\t<span class=\"keyword\">null</span> != iv) &#123;</div><div class=\"line\">\t\tKeyGenerator kgen;  </div><div class=\"line\">        <span class=\"keyword\">try</span> &#123;  </div><div class=\"line\">            kgen = KeyGenerator.getInstance(<span class=\"string\">\"AES\"</span>);  </div><div class=\"line\">            kgen.init(<span class=\"number\">128</span>, <span class=\"keyword\">new</span> SecureRandom(keyValue));  </div><div class=\"line\">            key = kgen.generateKey();  </div><div class=\"line\">            paramSpec = <span class=\"keyword\">new</span> IvParameterSpec(iv);  </div><div class=\"line\">            ecipher = Cipher.getInstance(<span class=\"string\">\"AES/CBC/PKCS5Padding\"</span>);         </div><div class=\"line\">        &#125; <span class=\"keyword\">catch</span> (NoSuchAlgorithmException e) &#123;  </div><div class=\"line\">        &#125; <span class=\"keyword\">catch</span> (NoSuchPaddingException e) &#123;  </div><div class=\"line\">        &#125;  </div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;   </div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">native</span> <span class=\"keyword\">byte</span>[] getKeyValue();</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">native</span> <span class=\"keyword\">byte</span>[] getIv();</div></pre></td></tr></table></figure>\n<p>  android appapp<strong></strong></p>\n<ul>\n<li><p>3.CC++AES</p>\n<p></p>\n</li>\n</ul>\n<h3 id=\"7-JNI\"><a href=\"#7-JNI\" class=\"headerlink\" title=\"7.JNI\"></a>7.JNI</h3><p>   C/C++Java</p>\n<p>  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//jni</span></div><div class=\"line\">-keep <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">com</span>.<span class=\"title\">your</span>.<span class=\"title\">jnicallback</span>.<span class=\"title\">class</span> </span>&#123; *; &#125;</div><div class=\"line\"><span class=\"comment\">//</span></div><div class=\"line\">-keepclasseswithmembernames <span class=\"class\"><span class=\"keyword\">class</span> * </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">native</span> &lt;methods&gt;;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"8-\"><a href=\"#8-\" class=\"headerlink\" title=\"8.\"></a>8.</h3><p>android JNI</p>\n<h4 id=\"8-1-JNIpublickey\"><a href=\"#8-1-JNIpublickey\" class=\"headerlink\" title=\"8.1 JNIpublickey\"></a>8.1 JNIpublickey</h4><p>64.0.4<a href=\"https://agehua.github.io/2016/05/24/JNI-Learning0/\">JNIpublickey</a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/05/24/JNI-Learning/\">http://agehua.github.io/2016/05/24/JNI-Learning/</a></p>"},{"layout":"post","title":"android JNI JNI","keywords":"jni, android","description":"android Jni","banner":"http://obxk8w81b.bkt.clouddn.com/Cottages%20Reminiscence%20of%20the%20North.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Cottages%20Reminiscence%20of%20the%20North.jpg","_content":"\n\n###  1.Android JNI\n\n#### 1.1 AndroidJNI\n\nAndroid**Kernelinit**initforkJavaC/C++ZygoteZygote**AndroidRuntime.cppstartVm**VMstartRegJNI\n\n<!--more-->\n\nAndroidRuntime.cpp\n\n~~~ C++\nint AndroidRuntime::startReg(JNIEnv* env)\n{\n    //javaCreateThreadEtc\n    androidSetCreateThreadFunc((android_create_thread_fn) javaCreateThreadEtc);\n\n    env->PushLocalFrame(200);\n    //NI\n    if (register_jni_procs(gRegJNI, NELEM(gRegJNI), env) < 0) {\n        env->PopLocalFrame(NULL);\n        return -1;\n    }\n    env->PopLocalFrame(NULL);\n    return 0;\n}\n~~~\n\n**register_jni_procs(gRegJNI, NELEM(gRegJNI), env)**gRegJNI\n\n~~~ C++\nstatic int register_jni_procs(const RegJNIRec array[], size_t count, JNIEnv* env)\n{\n    for (size_t i = 0; i < count; i++) {\n        if (array[i].mProc(env) < 0) {\n            return -1;\n        }\n    }\n    return 0;\n}\n~~~\n\n   gRegJNI100AndroidRuntime.cpp\n\n~~~ C++\nstatic const RegJNIRec gRegJNI[] = {\n    REG_JNI(register_android_os_MessageQueue),\n    REG_JNI(register_android_os_Binder),\n    ...\n};\n~~~\n\n   jniREG_JNI\n\nMessageQueueBinderAndroidAndroidRuntime.cppnative**AndroidRuntime.cppgRegJNI**\n\n~~~ Java\nregister_[]_[]\n~~~\n\n##### MessageQueue.javanativePollOnce\n\n~~~ Java\nprivate native void nativePollOnce(long ptr, int timeoutMillis);\n~~~\n**android.os.MessageQueue.nativePollOnce()**native**android_os_MessageQueue_nativePollOnce()**\n\n- MessageQueue.javajni**register_android_os_MessageQueue**gRegJNIJNIAndroidRuntime.cppextern\n\n~~~ C++\nextern int register_android_os_MessageQueue(JNIEnv* env);\n~~~\n\nextern/framework/base/core/jni/native\n\n~~~ C++\n[]_[].cpp\n[]_[].h\n~~~\n\n> **Tips** MessageQueue.java ==> android_os_MessageQueue.cpp\n\n- android_os_MessageQueue.cppandroid_os_MessageQueue_nativePollOnce\n\n~~~ C++\nstatic void android_os_MessageQueue_nativePollOnce(JNIEnv* env, jobject obj,\n        jlong ptr, jint timeoutMillis) {\n    NativeMessageQueue* nativeMessageQueue = reinterpret_cast<NativeMessageQueue*>(ptr);\n    nativeMessageQueue->pollOnce(env, obj, timeoutMillis);\n}\n~~~\n\n##### native[]\\_[].cppBinder.java\n\nBinder.javanative**android_util_Binder.cpp**\n\n~~~ Java\npublic static final native int getCallingPid();\n~~~\n\n   getCallingPid ==> android_os_Binder_getCallingPid()AndroidRuntime.cppgRegJNIregister_android_os_Binder\n\n()nativeandroid_os_Binder.cpp/framework/base/core/jni/******android_util_Binder.cpp**google\n\n~~~ C++\nstatic jint android_os_Binder_getCallingPid(JNIEnv* env, jobject clazz)\n{\n    return IPCThreadState::self()->getCallingPid();\n}\n~~~\n\n/framework/base/core/jni/binder.javabindergrepandroid_os_Binder_getCallingPid\n\njni\n\n- /framework/base/core/jni/\n- /framework/base/services/core/jni/\n- /framework/base/media/jni/\n\n\n#### 1.2 JNI\nAndroidJNI jnijniMediaPlayer.javaandroid.media\n\n~~~ Java\npublic class MediaPlayer{\n    static {\n        System.loadLibrary(\"media_jni\");\n        native_init();\n    }\n\n    private static native final void native_init();\n    ...\n}\n~~~\n\n- staticSystem.loadLibrarymedia_jni, Androidlibmedia_jni.so\n\n- libmedia_jni.soAndroid.mk**LOCAL_MODULE:= libmedia_jni**grepmgreplibmedia_jniAndroid.mk\n\nlibmedia_jni.so/frameworks/base/media/jni/Android.mk()\n\n~~~ C++\nandroid_media_MediaPlayer.cpp\nandroid_media_MediaPlayer_native_init()\n~~~\n\n- Android.mk/frameworks/base/media/jni/android_media_MediaPlayer.cpp\n\n~~~ C++\nstatic void\nandroid_media_MediaPlayer_native_init(JNIEnv *env)\n{\n    jclass clazz;\n    clazz = env->FindClass(\"android/media/MediaPlayer\");\n    fields.context = env->GetFieldID(clazz, \"mNativeContext\", \"J\");\n    ...\n}\n~~~\n\n> **Tips**MediaPlayer.javanative_initnative/frameworks/base/media/jni/android_media_MediaPlayer.cppandroid_media_MediaPlayer_native_init\n\n**System.loadLibrary()JNI_OnLoad()**\n\n#### 1.3 **JNI_OnLoad()**\n\n[-> android_media_MediaPlayer.cpp]\n\n~~~ C++\njint JNI_OnLoad(JavaVM* vm, void* reserved)\n{\n    JNIEnv* env = NULL;\n    if (register_android_media_MediaPlayer(env) < 0) {\n        goto bail;\n    }\n    ...\n}\n~~~\n\n**register_android_media_MediaPlayer**\n\n[-> android_media_MediaPlayer.cpp]\n\n~~~ C++\nstatic int register_android_media_MediaPlayer(JNIEnv *env)\n{\n    //3.4\n    return AndroidRuntime::registerNativeMethods(env,\n                \"android/media/MediaPlayer\", gMethods, NELEM(gMethods));\n}\n~~~\n\nJavaVMJNIEnv:\n\n- 1.JavaVMJavaVM\n- 2.JNIEnvJNIEnv\n\ngMethodsjavaC/C++\n\n~~~ C++\nstatic JNINativeMethod gMethods[] = {\n    {\"prepare\",      \"()V\",  (void *)android_media_MediaPlayer_prepare},\n    {\"_start\",       \"()V\",  (void *)android_media_MediaPlayer_start},\n    {\"_stop\",        \"()V\",  (void *)android_media_MediaPlayer_stop},\n    {\"seekTo\",       \"(I)V\", (void *)android_media_MediaPlayer_seekTo},\n    {\"_release\",     \"()V\",  (void *)android_media_MediaPlayer_release},\n    {\"native_init\",  \"()V\",  (void *)android_media_MediaPlayer_native_init},\n    ...\n};\n~~~\n\n**JNINativeMethod**jni.h\n\n~~~ C++\ntypedef struct {\n    const char* name;  //Javanative\n    const char* signature; //Java\n    void*       fnPtr; //Native\n} JNINativeMethod;\n~~~\n\n### 2.JNI\n\nJNINativeMethod**signature()**signatureJavaNative\n\n#### 2.1 \n\n- ****\n\n| *Signature* |\t*Java* |\t*Native* |\n|:--------:|:-------:|:--------:|\n|B | byte\t|jbyte|\n|C | char\t| jchar|\n|D\t| double\t| jdouble|\n|F\t| float | jfloat|\n|I\t| int |\tjint|\n|S\t| short |\tjshort|\n|J\t| long\t| jlong|\n|Z\t| boolean\t| jboolean|\n|V\t| void\t| void|\n\n- ****\n\n**[**\n\n| *Signature* |\t*Java* |\t*Native*|\n|:--------:|:-------:|:--------:|\n|[B |\tbyte[] |\tjbyteArray|\n|[C |\tchar[] |\tjcharArray|\n|[D |\tdouble[] |\tjdoubleArray|\n|[F |\tfloat[] |\tjfloatArray|\n|[I |\tint[] |\tjintArray|\n|[S |\tshort[] |\tjshortArray|\n|[J |\tlong[] |\tjlongArray|\n|[Z |\tboolean[] | jbooleanArray|\n\n- ****\n\n**L+classname +**;\n\n| Signature | Java | Native |\n|:--------:|:-------:|:--------:|\n| Ljava/lang/String; | String | jstring |\n| L+classname +;\t| |\tjobject|\n|[L+classname +;\t| Object[]\t| jobjectArray|\n| Ljava.lang.Class; |\tClass\t|jclass |\n|Ljava.lang.Throwable;\t| Throwable\t| jthrowable|\n\n- **Signature**\n\n (...)Signature\n\n| Java | |\n|:--------:|:--------:|\n|void foo()\t| ()V|\n|float foo(int i) |\t(I)F|\n|long foo(int[] i)\t| ([I)J|\n|double foo(Class c) |\t(Ljava/lang/Class;)D|\n|boolean foo(int[] i,String s) |\t([ILjava/lang/String;)Z|\n|String foo(int i) |\t(I)Ljava/lang/String;|\n\n#### 2.2 \n\n- **()**\nJavaGCJNIJNIReferenceLocal Reference() Global Reference Weak Global Reference()Global Reference\n\n  ARTGCGCJavaJNIDalvikART\n\n- **()**\nJavatry..catchthrowJNIJNIEnvJava\n\n  DalvikJNINULLARTDalvikART\n\n### 3.JNI\n\nJNI ---- \nhttp://blog.csdn.net/qinjuning/article/details/7595104\n\nJNI ---- \nhttp://blog.csdn.net/qinjuning/article/details/7599796\n\nJNI ---- JNI\nhttp://blog.csdn.net/qinjuning/article/details/7607214\n\nJNI \nhttp://blog.csdn.net/banketree/article/details/40535325\n","source":"_posts/2016-05-24-JNI-Learning0.md","raw":"---\nlayout: post\ntitle: android JNI JNI\ncategory: accumulation\ntags:\n  - JNI\n  - android source code\nkeywords: jni, android\ndescription: android Jni\nbanner: http://obxk8w81b.bkt.clouddn.com/Cottages%20Reminiscence%20of%20the%20North.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Cottages%20Reminiscence%20of%20the%20North.jpg\n---\n\n\n###  1.Android JNI\n\n#### 1.1 AndroidJNI\n\nAndroid**Kernelinit**initforkJavaC/C++ZygoteZygote**AndroidRuntime.cppstartVm**VMstartRegJNI\n\n<!--more-->\n\nAndroidRuntime.cpp\n\n~~~ C++\nint AndroidRuntime::startReg(JNIEnv* env)\n{\n    //javaCreateThreadEtc\n    androidSetCreateThreadFunc((android_create_thread_fn) javaCreateThreadEtc);\n\n    env->PushLocalFrame(200);\n    //NI\n    if (register_jni_procs(gRegJNI, NELEM(gRegJNI), env) < 0) {\n        env->PopLocalFrame(NULL);\n        return -1;\n    }\n    env->PopLocalFrame(NULL);\n    return 0;\n}\n~~~\n\n**register_jni_procs(gRegJNI, NELEM(gRegJNI), env)**gRegJNI\n\n~~~ C++\nstatic int register_jni_procs(const RegJNIRec array[], size_t count, JNIEnv* env)\n{\n    for (size_t i = 0; i < count; i++) {\n        if (array[i].mProc(env) < 0) {\n            return -1;\n        }\n    }\n    return 0;\n}\n~~~\n\n   gRegJNI100AndroidRuntime.cpp\n\n~~~ C++\nstatic const RegJNIRec gRegJNI[] = {\n    REG_JNI(register_android_os_MessageQueue),\n    REG_JNI(register_android_os_Binder),\n    ...\n};\n~~~\n\n   jniREG_JNI\n\nMessageQueueBinderAndroidAndroidRuntime.cppnative**AndroidRuntime.cppgRegJNI**\n\n~~~ Java\nregister_[]_[]\n~~~\n\n##### MessageQueue.javanativePollOnce\n\n~~~ Java\nprivate native void nativePollOnce(long ptr, int timeoutMillis);\n~~~\n**android.os.MessageQueue.nativePollOnce()**native**android_os_MessageQueue_nativePollOnce()**\n\n- MessageQueue.javajni**register_android_os_MessageQueue**gRegJNIJNIAndroidRuntime.cppextern\n\n~~~ C++\nextern int register_android_os_MessageQueue(JNIEnv* env);\n~~~\n\nextern/framework/base/core/jni/native\n\n~~~ C++\n[]_[].cpp\n[]_[].h\n~~~\n\n> **Tips** MessageQueue.java ==> android_os_MessageQueue.cpp\n\n- android_os_MessageQueue.cppandroid_os_MessageQueue_nativePollOnce\n\n~~~ C++\nstatic void android_os_MessageQueue_nativePollOnce(JNIEnv* env, jobject obj,\n        jlong ptr, jint timeoutMillis) {\n    NativeMessageQueue* nativeMessageQueue = reinterpret_cast<NativeMessageQueue*>(ptr);\n    nativeMessageQueue->pollOnce(env, obj, timeoutMillis);\n}\n~~~\n\n##### native[]\\_[].cppBinder.java\n\nBinder.javanative**android_util_Binder.cpp**\n\n~~~ Java\npublic static final native int getCallingPid();\n~~~\n\n   getCallingPid ==> android_os_Binder_getCallingPid()AndroidRuntime.cppgRegJNIregister_android_os_Binder\n\n()nativeandroid_os_Binder.cpp/framework/base/core/jni/******android_util_Binder.cpp**google\n\n~~~ C++\nstatic jint android_os_Binder_getCallingPid(JNIEnv* env, jobject clazz)\n{\n    return IPCThreadState::self()->getCallingPid();\n}\n~~~\n\n/framework/base/core/jni/binder.javabindergrepandroid_os_Binder_getCallingPid\n\njni\n\n- /framework/base/core/jni/\n- /framework/base/services/core/jni/\n- /framework/base/media/jni/\n\n\n#### 1.2 JNI\nAndroidJNI jnijniMediaPlayer.javaandroid.media\n\n~~~ Java\npublic class MediaPlayer{\n    static {\n        System.loadLibrary(\"media_jni\");\n        native_init();\n    }\n\n    private static native final void native_init();\n    ...\n}\n~~~\n\n- staticSystem.loadLibrarymedia_jni, Androidlibmedia_jni.so\n\n- libmedia_jni.soAndroid.mk**LOCAL_MODULE:= libmedia_jni**grepmgreplibmedia_jniAndroid.mk\n\nlibmedia_jni.so/frameworks/base/media/jni/Android.mk()\n\n~~~ C++\nandroid_media_MediaPlayer.cpp\nandroid_media_MediaPlayer_native_init()\n~~~\n\n- Android.mk/frameworks/base/media/jni/android_media_MediaPlayer.cpp\n\n~~~ C++\nstatic void\nandroid_media_MediaPlayer_native_init(JNIEnv *env)\n{\n    jclass clazz;\n    clazz = env->FindClass(\"android/media/MediaPlayer\");\n    fields.context = env->GetFieldID(clazz, \"mNativeContext\", \"J\");\n    ...\n}\n~~~\n\n> **Tips**MediaPlayer.javanative_initnative/frameworks/base/media/jni/android_media_MediaPlayer.cppandroid_media_MediaPlayer_native_init\n\n**System.loadLibrary()JNI_OnLoad()**\n\n#### 1.3 **JNI_OnLoad()**\n\n[-> android_media_MediaPlayer.cpp]\n\n~~~ C++\njint JNI_OnLoad(JavaVM* vm, void* reserved)\n{\n    JNIEnv* env = NULL;\n    if (register_android_media_MediaPlayer(env) < 0) {\n        goto bail;\n    }\n    ...\n}\n~~~\n\n**register_android_media_MediaPlayer**\n\n[-> android_media_MediaPlayer.cpp]\n\n~~~ C++\nstatic int register_android_media_MediaPlayer(JNIEnv *env)\n{\n    //3.4\n    return AndroidRuntime::registerNativeMethods(env,\n                \"android/media/MediaPlayer\", gMethods, NELEM(gMethods));\n}\n~~~\n\nJavaVMJNIEnv:\n\n- 1.JavaVMJavaVM\n- 2.JNIEnvJNIEnv\n\ngMethodsjavaC/C++\n\n~~~ C++\nstatic JNINativeMethod gMethods[] = {\n    {\"prepare\",      \"()V\",  (void *)android_media_MediaPlayer_prepare},\n    {\"_start\",       \"()V\",  (void *)android_media_MediaPlayer_start},\n    {\"_stop\",        \"()V\",  (void *)android_media_MediaPlayer_stop},\n    {\"seekTo\",       \"(I)V\", (void *)android_media_MediaPlayer_seekTo},\n    {\"_release\",     \"()V\",  (void *)android_media_MediaPlayer_release},\n    {\"native_init\",  \"()V\",  (void *)android_media_MediaPlayer_native_init},\n    ...\n};\n~~~\n\n**JNINativeMethod**jni.h\n\n~~~ C++\ntypedef struct {\n    const char* name;  //Javanative\n    const char* signature; //Java\n    void*       fnPtr; //Native\n} JNINativeMethod;\n~~~\n\n### 2.JNI\n\nJNINativeMethod**signature()**signatureJavaNative\n\n#### 2.1 \n\n- ****\n\n| *Signature* |\t*Java* |\t*Native* |\n|:--------:|:-------:|:--------:|\n|B | byte\t|jbyte|\n|C | char\t| jchar|\n|D\t| double\t| jdouble|\n|F\t| float | jfloat|\n|I\t| int |\tjint|\n|S\t| short |\tjshort|\n|J\t| long\t| jlong|\n|Z\t| boolean\t| jboolean|\n|V\t| void\t| void|\n\n- ****\n\n**[**\n\n| *Signature* |\t*Java* |\t*Native*|\n|:--------:|:-------:|:--------:|\n|[B |\tbyte[] |\tjbyteArray|\n|[C |\tchar[] |\tjcharArray|\n|[D |\tdouble[] |\tjdoubleArray|\n|[F |\tfloat[] |\tjfloatArray|\n|[I |\tint[] |\tjintArray|\n|[S |\tshort[] |\tjshortArray|\n|[J |\tlong[] |\tjlongArray|\n|[Z |\tboolean[] | jbooleanArray|\n\n- ****\n\n**L+classname +**;\n\n| Signature | Java | Native |\n|:--------:|:-------:|:--------:|\n| Ljava/lang/String; | String | jstring |\n| L+classname +;\t| |\tjobject|\n|[L+classname +;\t| Object[]\t| jobjectArray|\n| Ljava.lang.Class; |\tClass\t|jclass |\n|Ljava.lang.Throwable;\t| Throwable\t| jthrowable|\n\n- **Signature**\n\n (...)Signature\n\n| Java | |\n|:--------:|:--------:|\n|void foo()\t| ()V|\n|float foo(int i) |\t(I)F|\n|long foo(int[] i)\t| ([I)J|\n|double foo(Class c) |\t(Ljava/lang/Class;)D|\n|boolean foo(int[] i,String s) |\t([ILjava/lang/String;)Z|\n|String foo(int i) |\t(I)Ljava/lang/String;|\n\n#### 2.2 \n\n- **()**\nJavaGCJNIJNIReferenceLocal Reference() Global Reference Weak Global Reference()Global Reference\n\n  ARTGCGCJavaJNIDalvikART\n\n- **()**\nJavatry..catchthrowJNIJNIEnvJava\n\n  DalvikJNINULLARTDalvikART\n\n### 3.JNI\n\nJNI ---- \nhttp://blog.csdn.net/qinjuning/article/details/7595104\n\nJNI ---- \nhttp://blog.csdn.net/qinjuning/article/details/7599796\n\nJNI ---- JNI\nhttp://blog.csdn.net/qinjuning/article/details/7607214\n\nJNI \nhttp://blog.csdn.net/banketree/article/details/40535325\n","slug":"JNI-Learning0","published":1,"date":"2016-05-23T16:00:00.000Z","updated":"2017-11-23T07:05:09.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ebx1000sd6ykxpy1fxsm","content":"<h3 id=\"1-Android-JNI\"><a href=\"#1-Android-JNI\" class=\"headerlink\" title=\"1.Android JNI\"></a>1.Android JNI</h3><h4 id=\"1-1-AndroidJNI\"><a href=\"#1-1-AndroidJNI\" class=\"headerlink\" title=\"1.1 AndroidJNI\"></a>1.1 AndroidJNI</h4><p>Android<strong>Kernelinit</strong>initforkJavaC/C++ZygoteZygote<strong>AndroidRuntime.cppstartVm</strong>VMstartRegJNI</p>\n<a id=\"more\"></a>\n<p>AndroidRuntime.cpp</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">int</span> AndroidRuntime::startReg(JNIEnv* env)</div><div class=\"line\">&#123;</div><div class=\"line\">    <span class=\"comment\">//javaCreateThreadEtc</span></div><div class=\"line\">    androidSetCreateThreadFunc((android_create_thread_fn) javaCreateThreadEtc);</div><div class=\"line\"></div><div class=\"line\">    env-&gt;PushLocalFrame(<span class=\"number\">200</span>);</div><div class=\"line\">    <span class=\"comment\">//NI</span></div><div class=\"line\">    <span class=\"keyword\">if</span> (register_jni_procs(gRegJNI, NELEM(gRegJNI), env) &lt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">        env-&gt;PopLocalFrame(<span class=\"literal\">NULL</span>);</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\">    env-&gt;PopLocalFrame(<span class=\"literal\">NULL</span>);</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p><strong>register_jni_procs(gRegJNI, NELEM(gRegJNI), env)</strong>gRegJNI</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">int</span> <span class=\"title\">register_jni_procs</span><span class=\"params\">(<span class=\"keyword\">const</span> RegJNIRec <span class=\"built_in\">array</span>[], <span class=\"keyword\">size_t</span> count, JNIEnv* env)</span></span></div><div class=\"line\">&#123;</div><div class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">size_t</span> i = <span class=\"number\">0</span>; i &lt; count; i++) &#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"built_in\">array</span>[i].mProc(env) &lt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>   gRegJNI100AndroidRuntime.cpp</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">static</span> <span class=\"keyword\">const</span> RegJNIRec gRegJNI[] = &#123;</div><div class=\"line\">    REG_JNI(register_android_os_MessageQueue),</div><div class=\"line\">    REG_JNI(register_android_os_Binder),</div><div class=\"line\">    ...</div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure>\n<p>   jniREG_JNI</p>\n<p>MessageQueueBinderAndroidAndroidRuntime.cppnative<strong>AndroidRuntime.cppgRegJNI</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">register_[]_[]</div></pre></td></tr></table></figure>\n<h5 id=\"MessageQueue-javanativePollOnce\"><a href=\"#MessageQueue-javanativePollOnce\" class=\"headerlink\" title=\"MessageQueue.javanativePollOnce\"></a>MessageQueue.javanativePollOnce</h5><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">native</span> <span class=\"keyword\">void</span> <span class=\"title\">nativePollOnce</span><span class=\"params\">(<span class=\"keyword\">long</span> ptr, <span class=\"keyword\">int</span> timeoutMillis)</span></span>;</div></pre></td></tr></table></figure>\n<p><strong>android.os.MessageQueue.nativePollOnce()</strong>native<strong>android_os_MessageQueue_nativePollOnce()</strong></p>\n<ul>\n<li>MessageQueue.javajni<strong>register_android_os_MessageQueue</strong>gRegJNIJNIAndroidRuntime.cppextern</li>\n</ul>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">extern</span> <span class=\"keyword\">int</span> <span class=\"title\">register_android_os_MessageQueue</span><span class=\"params\">(JNIEnv* env)</span></span>;</div></pre></td></tr></table></figure>\n<p>extern/framework/base/core/jni/native</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">[]_[].cpp</div><div class=\"line\">[]_[].h</div></pre></td></tr></table></figure>\n<blockquote>\n<p><strong>Tips</strong> MessageQueue.java ==&gt; android_os_MessageQueue.cpp</p>\n</blockquote>\n<ul>\n<li>android_os_MessageQueue.cppandroid_os_MessageQueue_nativePollOnce</li>\n</ul>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">android_os_MessageQueue_nativePollOnce</span><span class=\"params\">(JNIEnv* env, jobject obj,</span></span></div><div class=\"line\">        jlong ptr, jint timeoutMillis) &#123;</div><div class=\"line\">    NativeMessageQueue* nativeMessageQueue = <span class=\"keyword\">reinterpret_cast</span>&lt;NativeMessageQueue*&gt;(ptr);</div><div class=\"line\">    nativeMessageQueue-&gt;pollOnce(env, obj, timeoutMillis);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h5 id=\"native---cppBinder-java\"><a href=\"#native---cppBinder-java\" class=\"headerlink\" title=\"native[]_[].cppBinder.java\"></a>native[]_[].cppBinder.java</h5><p>Binder.javanative<strong>android_util_Binder.cpp</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">native</span> <span class=\"keyword\">int</span> <span class=\"title\">getCallingPid</span><span class=\"params\">()</span></span>;</div></pre></td></tr></table></figure>\n<p>   getCallingPid ==&gt; android_os_Binder_getCallingPid()AndroidRuntime.cppgRegJNIregister_android_os_Binder</p>\n<p>()nativeandroid_os_Binder.cpp/framework/base/core/jni/<strong></strong><strong>android_util_Binder.cpp</strong>google</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> jint <span class=\"title\">android_os_Binder_getCallingPid</span><span class=\"params\">(JNIEnv* env, jobject clazz)</span></span></div><div class=\"line\">&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> IPCThreadState::self()-&gt;getCallingPid();</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>/framework/base/core/jni/binder.javabindergrepandroid_os_Binder_getCallingPid</p>\n<p>jni</p>\n<ul>\n<li>/framework/base/core/jni/</li>\n<li>/framework/base/services/core/jni/</li>\n<li>/framework/base/media/jni/</li>\n</ul>\n<h4 id=\"1-2-JNI\"><a href=\"#1-2-JNI\" class=\"headerlink\" title=\"1.2 JNI\"></a>1.2 JNI</h4><p>AndroidJNI jnijniMediaPlayer.javaandroid.media</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MediaPlayer</span></span>&#123;</div><div class=\"line\">    <span class=\"keyword\">static</span> &#123;</div><div class=\"line\">        System.loadLibrary(<span class=\"string\">\"media_jni\"</span>);</div><div class=\"line\">        native_init();</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">native</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title\">native_init</span><span class=\"params\">()</span></span>;</div><div class=\"line\">    ...</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<ul>\n<li><p>staticSystem.loadLibrarymedia_jni, Androidlibmedia_jni.so</p>\n</li>\n<li><p>libmedia_jni.soAndroid.mk<strong>LOCAL_MODULE:= libmedia_jni</strong>grepmgreplibmedia_jniAndroid.mk</p>\n</li>\n</ul>\n<p>libmedia_jni.so/frameworks/base/media/jni/Android.mk()</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">android_media_MediaPlayer.<span class=\"function\">cpp</span></div><div class=\"line\"><span class=\"title\">android_media_MediaPlayer_native_init</span><span class=\"params\">()</span></div></pre></td></tr></table></figure>\n<ul>\n<li>Android.mk/frameworks/base/media/jni/android_media_MediaPlayer.cpp</li>\n</ul>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span></span></div><div class=\"line\"><span class=\"title\">android_media_MediaPlayer_native_init</span><span class=\"params\">(JNIEnv *env)</span></div><div class=\"line\">&#123;</div><div class=\"line\">    jclass clazz;</div><div class=\"line\">    clazz = env-&gt;FindClass(<span class=\"string\">\"android/media/MediaPlayer\"</span>);</div><div class=\"line\">    fields.context = env-&gt;GetFieldID(clazz, <span class=\"string\">\"mNativeContext\"</span>, <span class=\"string\">\"J\"</span>);</div><div class=\"line\">    ...</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<blockquote>\n<p><strong>Tips</strong>MediaPlayer.javanative_initnative/frameworks/base/media/jni/android_media_MediaPlayer.cppandroid_media_MediaPlayer_native_init</p>\n</blockquote>\n<p><strong>System.loadLibrary()JNI_OnLoad()</strong></p>\n<h4 id=\"1-3-JNI-OnLoad-\"><a href=\"#1-3-JNI-OnLoad-\" class=\"headerlink\" title=\"1.3 JNI_OnLoad()\"></a>1.3 <strong>JNI_OnLoad()</strong></h4><p>[-&gt; android_media_MediaPlayer.cpp]</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\">jint <span class=\"title\">JNI_OnLoad</span><span class=\"params\">(JavaVM* vm, <span class=\"keyword\">void</span>* reserved)</span></span></div><div class=\"line\">&#123;</div><div class=\"line\">    JNIEnv* env = <span class=\"literal\">NULL</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (register_android_media_MediaPlayer(env) &lt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">        <span class=\"keyword\">goto</span> bail;</div><div class=\"line\">    &#125;</div><div class=\"line\">    ...</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p><strong>register_android_media_MediaPlayer</strong></p>\n<p>[-&gt; android_media_MediaPlayer.cpp]</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">int</span> <span class=\"title\">register_android_media_MediaPlayer</span><span class=\"params\">(JNIEnv *env)</span></span></div><div class=\"line\">&#123;</div><div class=\"line\">    <span class=\"comment\">//3.4</span></div><div class=\"line\">    <span class=\"keyword\">return</span> AndroidRuntime::registerNativeMethods(env,</div><div class=\"line\">                <span class=\"string\">\"android/media/MediaPlayer\"</span>, gMethods, NELEM(gMethods));</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>JavaVMJNIEnv:</p>\n<ul>\n<li>1.JavaVMJavaVM</li>\n<li>2.JNIEnvJNIEnv</li>\n</ul>\n<p>gMethodsjavaC/C++</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">static</span> JNINativeMethod gMethods[] = &#123;</div><div class=\"line\">    &#123;<span class=\"string\">\"prepare\"</span>,      <span class=\"string\">\"()V\"</span>,  (<span class=\"keyword\">void</span> *)android_media_MediaPlayer_prepare&#125;,</div><div class=\"line\">    &#123;<span class=\"string\">\"_start\"</span>,       <span class=\"string\">\"()V\"</span>,  (<span class=\"keyword\">void</span> *)android_media_MediaPlayer_start&#125;,</div><div class=\"line\">    &#123;<span class=\"string\">\"_stop\"</span>,        <span class=\"string\">\"()V\"</span>,  (<span class=\"keyword\">void</span> *)android_media_MediaPlayer_stop&#125;,</div><div class=\"line\">    &#123;<span class=\"string\">\"seekTo\"</span>,       <span class=\"string\">\"(I)V\"</span>, (<span class=\"keyword\">void</span> *)android_media_MediaPlayer_seekTo&#125;,</div><div class=\"line\">    &#123;<span class=\"string\">\"_release\"</span>,     <span class=\"string\">\"()V\"</span>,  (<span class=\"keyword\">void</span> *)android_media_MediaPlayer_release&#125;,</div><div class=\"line\">    &#123;<span class=\"string\">\"native_init\"</span>,  <span class=\"string\">\"()V\"</span>,  (<span class=\"keyword\">void</span> *)android_media_MediaPlayer_native_init&#125;,</div><div class=\"line\">    ...</div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure>\n<p><strong>JNINativeMethod</strong>jni.h</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">struct</span> &#123;</div><div class=\"line\">    <span class=\"keyword\">const</span> <span class=\"keyword\">char</span>* name;  <span class=\"comment\">//Javanative</span></div><div class=\"line\">    <span class=\"keyword\">const</span> <span class=\"keyword\">char</span>* signature; <span class=\"comment\">//Java</span></div><div class=\"line\">    <span class=\"keyword\">void</span>*       fnPtr; <span class=\"comment\">//Native</span></div><div class=\"line\">&#125; JNINativeMethod;</div></pre></td></tr></table></figure>\n<h3 id=\"2-JNI\"><a href=\"#2-JNI\" class=\"headerlink\" title=\"2.JNI\"></a>2.JNI</h3><p>JNINativeMethod<strong>signature()</strong>signatureJavaNative</p>\n<h4 id=\"2-1-\"><a href=\"#2-1-\" class=\"headerlink\" title=\"2.1 \"></a>2.1 </h4><ul>\n<li><strong></strong></li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\"><em>Signature</em></th>\n<th style=\"text-align:center\"><em>Java</em></th>\n<th style=\"text-align:center\"><em>Native</em></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">B</td>\n<td style=\"text-align:center\">byte</td>\n<td style=\"text-align:center\">jbyte</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">C</td>\n<td style=\"text-align:center\">char</td>\n<td style=\"text-align:center\">jchar</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">D</td>\n<td style=\"text-align:center\">double</td>\n<td style=\"text-align:center\">jdouble</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">F</td>\n<td style=\"text-align:center\">float</td>\n<td style=\"text-align:center\">jfloat</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">I</td>\n<td style=\"text-align:center\">int</td>\n<td style=\"text-align:center\">jint</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">S</td>\n<td style=\"text-align:center\">short</td>\n<td style=\"text-align:center\">jshort</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">J</td>\n<td style=\"text-align:center\">long</td>\n<td style=\"text-align:center\">jlong</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Z</td>\n<td style=\"text-align:center\">boolean</td>\n<td style=\"text-align:center\">jboolean</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">V</td>\n<td style=\"text-align:center\">void</td>\n<td style=\"text-align:center\">void</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li><strong></strong></li>\n</ul>\n<p><strong>[</strong></p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\"><em>Signature</em></th>\n<th style=\"text-align:center\"><em>Java</em></th>\n<th style=\"text-align:center\"><em>Native</em></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">[B</td>\n<td style=\"text-align:center\">byte[]</td>\n<td style=\"text-align:center\">jbyteArray</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">[C</td>\n<td style=\"text-align:center\">char[]</td>\n<td style=\"text-align:center\">jcharArray</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">[D</td>\n<td style=\"text-align:center\">double[]</td>\n<td style=\"text-align:center\">jdoubleArray</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">[F</td>\n<td style=\"text-align:center\">float[]</td>\n<td style=\"text-align:center\">jfloatArray</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">[I</td>\n<td style=\"text-align:center\">int[]</td>\n<td style=\"text-align:center\">jintArray</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">[S</td>\n<td style=\"text-align:center\">short[]</td>\n<td style=\"text-align:center\">jshortArray</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">[J</td>\n<td style=\"text-align:center\">long[]</td>\n<td style=\"text-align:center\">jlongArray</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">[Z</td>\n<td style=\"text-align:center\">boolean[]</td>\n<td style=\"text-align:center\">jbooleanArray</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li><strong></strong></li>\n</ul>\n<p><strong>L+classname +</strong>;</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">Signature</th>\n<th style=\"text-align:center\">Java</th>\n<th style=\"text-align:center\">Native</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">Ljava/lang/String;</td>\n<td style=\"text-align:center\">String</td>\n<td style=\"text-align:center\">jstring</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">L+classname +;</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">jobject</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">[L+classname +;</td>\n<td style=\"text-align:center\">Object[]</td>\n<td style=\"text-align:center\">jobjectArray</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Ljava.lang.Class;</td>\n<td style=\"text-align:center\">Class</td>\n<td style=\"text-align:center\">jclass</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Ljava.lang.Throwable;</td>\n<td style=\"text-align:center\">Throwable</td>\n<td style=\"text-align:center\">jthrowable</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li><strong>Signature</strong></li>\n</ul>\n<p> ()Signature</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">Java</th>\n<th style=\"text-align:center\"></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">void foo()</td>\n<td style=\"text-align:center\">()V</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">float foo(int i)</td>\n<td style=\"text-align:center\">(I)F</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">long foo(int[] i)</td>\n<td style=\"text-align:center\">([I)J</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">double foo(Class c)</td>\n<td style=\"text-align:center\">(Ljava/lang/Class;)D</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">boolean foo(int[] i,String s)</td>\n<td style=\"text-align:center\">([ILjava/lang/String;)Z</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">String foo(int i)</td>\n<td style=\"text-align:center\">(I)Ljava/lang/String;</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"2-2-\"><a href=\"#2-2-\" class=\"headerlink\" title=\"2.2 \"></a>2.2 </h4><ul>\n<li><p><strong>()</strong><br>JavaGCJNIJNIReferenceLocal Reference() Global Reference Weak Global Reference()Global Reference</p>\n<p>ARTGCGCJavaJNIDalvikART</p>\n</li>\n<li><p><strong>()</strong><br>Javatry..catchthrowJNIJNIEnvJava</p>\n<p>DalvikJNINULLARTDalvikART</p>\n</li>\n</ul>\n<h3 id=\"3-JNI\"><a href=\"#3-JNI\" class=\"headerlink\" title=\"3.JNI\"></a>3.JNI</h3><p>JNI - <br><a href=\"http://blog.csdn.net/qinjuning/article/details/7595104\" target=\"_blank\" rel=\"external\">http://blog.csdn.net/qinjuning/article/details/7595104</a></p>\n<p>JNI - <br><a href=\"http://blog.csdn.net/qinjuning/article/details/7599796\" target=\"_blank\" rel=\"external\">http://blog.csdn.net/qinjuning/article/details/7599796</a></p>\n<p>JNI - JNI<br><a href=\"http://blog.csdn.net/qinjuning/article/details/7607214\" target=\"_blank\" rel=\"external\">http://blog.csdn.net/qinjuning/article/details/7607214</a></p>\n<p>JNI <br><a href=\"http://blog.csdn.net/banketree/article/details/40535325\" target=\"_blank\" rel=\"external\">http://blog.csdn.net/banketree/article/details/40535325</a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/05/24/JNI-Learning0/\">http://agehua.github.io/2016/05/24/JNI-Learning0/</a></p>\n","readingTime":{"text":"5 min read","minutes":4.01,"time":240600,"words":802},"excerpt":"<h3 id=\"1-Android-JNI\"><a href=\"#1-Android-JNI\" class=\"headerlink\" title=\"1.Android JNI\"></a>1.Android JNI</h3><h4 id=\"1-1-AndroidJNI\"><a href=\"#1-1-AndroidJNI\" class=\"headerlink\" title=\"1.1 AndroidJNI\"></a>1.1 AndroidJNI</h4><p>Android<strong>Kernelinit</strong>initforkJavaC/C++ZygoteZygote<strong>AndroidRuntime.cppstartVm</strong>VMstartRegJNI</p>","more":"<p>AndroidRuntime.cpp</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">int</span> AndroidRuntime::startReg(JNIEnv* env)</div><div class=\"line\">&#123;</div><div class=\"line\">    <span class=\"comment\">//javaCreateThreadEtc</span></div><div class=\"line\">    androidSetCreateThreadFunc((android_create_thread_fn) javaCreateThreadEtc);</div><div class=\"line\"></div><div class=\"line\">    env-&gt;PushLocalFrame(<span class=\"number\">200</span>);</div><div class=\"line\">    <span class=\"comment\">//NI</span></div><div class=\"line\">    <span class=\"keyword\">if</span> (register_jni_procs(gRegJNI, NELEM(gRegJNI), env) &lt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">        env-&gt;PopLocalFrame(<span class=\"literal\">NULL</span>);</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\">    env-&gt;PopLocalFrame(<span class=\"literal\">NULL</span>);</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p><strong>register_jni_procs(gRegJNI, NELEM(gRegJNI), env)</strong>gRegJNI</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">int</span> <span class=\"title\">register_jni_procs</span><span class=\"params\">(<span class=\"keyword\">const</span> RegJNIRec <span class=\"built_in\">array</span>[], <span class=\"keyword\">size_t</span> count, JNIEnv* env)</span></div><div class=\"line\"></span>&#123;</div><div class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">size_t</span> i = <span class=\"number\">0</span>; i &lt; count; i++) &#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"built_in\">array</span>[i].mProc(env) &lt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>   gRegJNI100AndroidRuntime.cpp</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">static</span> <span class=\"keyword\">const</span> RegJNIRec gRegJNI[] = &#123;</div><div class=\"line\">    REG_JNI(register_android_os_MessageQueue),</div><div class=\"line\">    REG_JNI(register_android_os_Binder),</div><div class=\"line\">    ...</div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure>\n<p>   jniREG_JNI</p>\n<p>MessageQueueBinderAndroidAndroidRuntime.cppnative<strong>AndroidRuntime.cppgRegJNI</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">register_[]_[]</div></pre></td></tr></table></figure>\n<h5 id=\"MessageQueue-javanativePollOnce\"><a href=\"#MessageQueue-javanativePollOnce\" class=\"headerlink\" title=\"MessageQueue.javanativePollOnce\"></a>MessageQueue.javanativePollOnce</h5><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">native</span> <span class=\"keyword\">void</span> <span class=\"title\">nativePollOnce</span><span class=\"params\">(<span class=\"keyword\">long</span> ptr, <span class=\"keyword\">int</span> timeoutMillis)</span></span>;</div></pre></td></tr></table></figure>\n<p><strong>android.os.MessageQueue.nativePollOnce()</strong>native<strong>android_os_MessageQueue_nativePollOnce()</strong></p>\n<ul>\n<li>MessageQueue.javajni<strong>register_android_os_MessageQueue</strong>gRegJNIJNIAndroidRuntime.cppextern</li>\n</ul>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">extern</span> <span class=\"keyword\">int</span> <span class=\"title\">register_android_os_MessageQueue</span><span class=\"params\">(JNIEnv* env)</span></span>;</div></pre></td></tr></table></figure>\n<p>extern/framework/base/core/jni/native</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">[]_[].cpp</div><div class=\"line\">[]_[].h</div></pre></td></tr></table></figure>\n<blockquote>\n<p><strong>Tips</strong> MessageQueue.java ==&gt; android_os_MessageQueue.cpp</p>\n</blockquote>\n<ul>\n<li>android_os_MessageQueue.cppandroid_os_MessageQueue_nativePollOnce</li>\n</ul>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">android_os_MessageQueue_nativePollOnce</span><span class=\"params\">(JNIEnv* env, jobject obj,</div><div class=\"line\">        jlong ptr, jint timeoutMillis)</span> </span>&#123;</div><div class=\"line\">    NativeMessageQueue* nativeMessageQueue = <span class=\"keyword\">reinterpret_cast</span>&lt;NativeMessageQueue*&gt;(ptr);</div><div class=\"line\">    nativeMessageQueue-&gt;pollOnce(env, obj, timeoutMillis);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h5 id=\"native---cppBinder-java\"><a href=\"#native---cppBinder-java\" class=\"headerlink\" title=\"native[]_[].cppBinder.java\"></a>native[]_[].cppBinder.java</h5><p>Binder.javanative<strong>android_util_Binder.cpp</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">native</span> <span class=\"keyword\">int</span> <span class=\"title\">getCallingPid</span><span class=\"params\">()</span></span>;</div></pre></td></tr></table></figure>\n<p>   getCallingPid ==&gt; android_os_Binder_getCallingPid()AndroidRuntime.cppgRegJNIregister_android_os_Binder</p>\n<p>()nativeandroid_os_Binder.cpp/framework/base/core/jni/<strong></strong><strong>android_util_Binder.cpp</strong>google</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> jint <span class=\"title\">android_os_Binder_getCallingPid</span><span class=\"params\">(JNIEnv* env, jobject clazz)</span></div><div class=\"line\"></span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> IPCThreadState::self()-&gt;getCallingPid();</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>/framework/base/core/jni/binder.javabindergrepandroid_os_Binder_getCallingPid</p>\n<p>jni</p>\n<ul>\n<li>/framework/base/core/jni/</li>\n<li>/framework/base/services/core/jni/</li>\n<li>/framework/base/media/jni/</li>\n</ul>\n<h4 id=\"1-2-JNI\"><a href=\"#1-2-JNI\" class=\"headerlink\" title=\"1.2 JNI\"></a>1.2 JNI</h4><p>AndroidJNI jnijniMediaPlayer.javaandroid.media</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MediaPlayer</span></span>&#123;</div><div class=\"line\">    <span class=\"keyword\">static</span> &#123;</div><div class=\"line\">        System.loadLibrary(<span class=\"string\">\"media_jni\"</span>);</div><div class=\"line\">        native_init();</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">native</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title\">native_init</span><span class=\"params\">()</span></span>;</div><div class=\"line\">    ...</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<ul>\n<li><p>staticSystem.loadLibrarymedia_jni, Androidlibmedia_jni.so</p>\n</li>\n<li><p>libmedia_jni.soAndroid.mk<strong>LOCAL_MODULE:= libmedia_jni</strong>grepmgreplibmedia_jniAndroid.mk</p>\n</li>\n</ul>\n<p>libmedia_jni.so/frameworks/base/media/jni/Android.mk()</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">android_media_MediaPlayer.<span class=\"function\">cpp</div><div class=\"line\"><span class=\"title\">android_media_MediaPlayer_native_init</span><span class=\"params\">()</span></span></div></pre></td></tr></table></figure>\n<ul>\n<li>Android.mk/frameworks/base/media/jni/android_media_MediaPlayer.cpp</li>\n</ul>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span></div><div class=\"line\"><span class=\"title\">android_media_MediaPlayer_native_init</span><span class=\"params\">(JNIEnv *env)</span></div><div class=\"line\"></span>&#123;</div><div class=\"line\">    jclass clazz;</div><div class=\"line\">    clazz = env-&gt;FindClass(<span class=\"string\">\"android/media/MediaPlayer\"</span>);</div><div class=\"line\">    fields.context = env-&gt;GetFieldID(clazz, <span class=\"string\">\"mNativeContext\"</span>, <span class=\"string\">\"J\"</span>);</div><div class=\"line\">    ...</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<blockquote>\n<p><strong>Tips</strong>MediaPlayer.javanative_initnative/frameworks/base/media/jni/android_media_MediaPlayer.cppandroid_media_MediaPlayer_native_init</p>\n</blockquote>\n<p><strong>System.loadLibrary()JNI_OnLoad()</strong></p>\n<h4 id=\"1-3-JNI-OnLoad-\"><a href=\"#1-3-JNI-OnLoad-\" class=\"headerlink\" title=\"1.3 JNI_OnLoad()\"></a>1.3 <strong>JNI_OnLoad()</strong></h4><p>[-&gt; android_media_MediaPlayer.cpp]</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\">jint <span class=\"title\">JNI_OnLoad</span><span class=\"params\">(JavaVM* vm, <span class=\"keyword\">void</span>* reserved)</span></div><div class=\"line\"></span>&#123;</div><div class=\"line\">    JNIEnv* env = <span class=\"literal\">NULL</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (register_android_media_MediaPlayer(env) &lt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">        <span class=\"keyword\">goto</span> bail;</div><div class=\"line\">    &#125;</div><div class=\"line\">    ...</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p><strong>register_android_media_MediaPlayer</strong></p>\n<p>[-&gt; android_media_MediaPlayer.cpp]</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">int</span> <span class=\"title\">register_android_media_MediaPlayer</span><span class=\"params\">(JNIEnv *env)</span></div><div class=\"line\"></span>&#123;</div><div class=\"line\">    <span class=\"comment\">//3.4</span></div><div class=\"line\">    <span class=\"keyword\">return</span> AndroidRuntime::registerNativeMethods(env,</div><div class=\"line\">                <span class=\"string\">\"android/media/MediaPlayer\"</span>, gMethods, NELEM(gMethods));</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>JavaVMJNIEnv:</p>\n<ul>\n<li>1.JavaVMJavaVM</li>\n<li>2.JNIEnvJNIEnv</li>\n</ul>\n<p>gMethodsjavaC/C++</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">static</span> JNINativeMethod gMethods[] = &#123;</div><div class=\"line\">    &#123;<span class=\"string\">\"prepare\"</span>,      <span class=\"string\">\"()V\"</span>,  (<span class=\"keyword\">void</span> *)android_media_MediaPlayer_prepare&#125;,</div><div class=\"line\">    &#123;<span class=\"string\">\"_start\"</span>,       <span class=\"string\">\"()V\"</span>,  (<span class=\"keyword\">void</span> *)android_media_MediaPlayer_start&#125;,</div><div class=\"line\">    &#123;<span class=\"string\">\"_stop\"</span>,        <span class=\"string\">\"()V\"</span>,  (<span class=\"keyword\">void</span> *)android_media_MediaPlayer_stop&#125;,</div><div class=\"line\">    &#123;<span class=\"string\">\"seekTo\"</span>,       <span class=\"string\">\"(I)V\"</span>, (<span class=\"keyword\">void</span> *)android_media_MediaPlayer_seekTo&#125;,</div><div class=\"line\">    &#123;<span class=\"string\">\"_release\"</span>,     <span class=\"string\">\"()V\"</span>,  (<span class=\"keyword\">void</span> *)android_media_MediaPlayer_release&#125;,</div><div class=\"line\">    &#123;<span class=\"string\">\"native_init\"</span>,  <span class=\"string\">\"()V\"</span>,  (<span class=\"keyword\">void</span> *)android_media_MediaPlayer_native_init&#125;,</div><div class=\"line\">    ...</div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure>\n<p><strong>JNINativeMethod</strong>jni.h</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">struct</span> &#123;</div><div class=\"line\">    <span class=\"keyword\">const</span> <span class=\"keyword\">char</span>* name;  <span class=\"comment\">//Javanative</span></div><div class=\"line\">    <span class=\"keyword\">const</span> <span class=\"keyword\">char</span>* signature; <span class=\"comment\">//Java</span></div><div class=\"line\">    <span class=\"keyword\">void</span>*       fnPtr; <span class=\"comment\">//Native</span></div><div class=\"line\">&#125; JNINativeMethod;</div></pre></td></tr></table></figure>\n<h3 id=\"2-JNI\"><a href=\"#2-JNI\" class=\"headerlink\" title=\"2.JNI\"></a>2.JNI</h3><p>JNINativeMethod<strong>signature()</strong>signatureJavaNative</p>\n<h4 id=\"2-1-\"><a href=\"#2-1-\" class=\"headerlink\" title=\"2.1 \"></a>2.1 </h4><ul>\n<li><strong></strong></li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\"><em>Signature</em></th>\n<th style=\"text-align:center\"><em>Java</em></th>\n<th style=\"text-align:center\"><em>Native</em></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">B</td>\n<td style=\"text-align:center\">byte</td>\n<td style=\"text-align:center\">jbyte</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">C</td>\n<td style=\"text-align:center\">char</td>\n<td style=\"text-align:center\">jchar</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">D</td>\n<td style=\"text-align:center\">double</td>\n<td style=\"text-align:center\">jdouble</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">F</td>\n<td style=\"text-align:center\">float</td>\n<td style=\"text-align:center\">jfloat</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">I</td>\n<td style=\"text-align:center\">int</td>\n<td style=\"text-align:center\">jint</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">S</td>\n<td style=\"text-align:center\">short</td>\n<td style=\"text-align:center\">jshort</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">J</td>\n<td style=\"text-align:center\">long</td>\n<td style=\"text-align:center\">jlong</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Z</td>\n<td style=\"text-align:center\">boolean</td>\n<td style=\"text-align:center\">jboolean</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">V</td>\n<td style=\"text-align:center\">void</td>\n<td style=\"text-align:center\">void</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li><strong></strong></li>\n</ul>\n<p><strong>[</strong></p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\"><em>Signature</em></th>\n<th style=\"text-align:center\"><em>Java</em></th>\n<th style=\"text-align:center\"><em>Native</em></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">[B</td>\n<td style=\"text-align:center\">byte[]</td>\n<td style=\"text-align:center\">jbyteArray</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">[C</td>\n<td style=\"text-align:center\">char[]</td>\n<td style=\"text-align:center\">jcharArray</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">[D</td>\n<td style=\"text-align:center\">double[]</td>\n<td style=\"text-align:center\">jdoubleArray</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">[F</td>\n<td style=\"text-align:center\">float[]</td>\n<td style=\"text-align:center\">jfloatArray</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">[I</td>\n<td style=\"text-align:center\">int[]</td>\n<td style=\"text-align:center\">jintArray</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">[S</td>\n<td style=\"text-align:center\">short[]</td>\n<td style=\"text-align:center\">jshortArray</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">[J</td>\n<td style=\"text-align:center\">long[]</td>\n<td style=\"text-align:center\">jlongArray</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">[Z</td>\n<td style=\"text-align:center\">boolean[]</td>\n<td style=\"text-align:center\">jbooleanArray</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li><strong></strong></li>\n</ul>\n<p><strong>L+classname +</strong>;</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">Signature</th>\n<th style=\"text-align:center\">Java</th>\n<th style=\"text-align:center\">Native</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">Ljava/lang/String;</td>\n<td style=\"text-align:center\">String</td>\n<td style=\"text-align:center\">jstring</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">L+classname +;</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">jobject</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">[L+classname +;</td>\n<td style=\"text-align:center\">Object[]</td>\n<td style=\"text-align:center\">jobjectArray</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Ljava.lang.Class;</td>\n<td style=\"text-align:center\">Class</td>\n<td style=\"text-align:center\">jclass</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Ljava.lang.Throwable;</td>\n<td style=\"text-align:center\">Throwable</td>\n<td style=\"text-align:center\">jthrowable</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li><strong>Signature</strong></li>\n</ul>\n<p> ()Signature</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">Java</th>\n<th style=\"text-align:center\"></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">void foo()</td>\n<td style=\"text-align:center\">()V</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">float foo(int i)</td>\n<td style=\"text-align:center\">(I)F</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">long foo(int[] i)</td>\n<td style=\"text-align:center\">([I)J</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">double foo(Class c)</td>\n<td style=\"text-align:center\">(Ljava/lang/Class;)D</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">boolean foo(int[] i,String s)</td>\n<td style=\"text-align:center\">([ILjava/lang/String;)Z</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">String foo(int i)</td>\n<td style=\"text-align:center\">(I)Ljava/lang/String;</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"2-2-\"><a href=\"#2-2-\" class=\"headerlink\" title=\"2.2 \"></a>2.2 </h4><ul>\n<li><p><strong>()</strong><br>JavaGCJNIJNIReferenceLocal Reference() Global Reference Weak Global Reference()Global Reference</p>\n<p>ARTGCGCJavaJNIDalvikART</p>\n</li>\n<li><p><strong>()</strong><br>Javatry..catchthrowJNIJNIEnvJava</p>\n<p>DalvikJNINULLARTDalvikART</p>\n</li>\n</ul>\n<h3 id=\"3-JNI\"><a href=\"#3-JNI\" class=\"headerlink\" title=\"3.JNI\"></a>3.JNI</h3><p>JNI - <br><a href=\"http://blog.csdn.net/qinjuning/article/details/7595104\">http://blog.csdn.net/qinjuning/article/details/7595104</a></p>\n<p>JNI - <br><a href=\"http://blog.csdn.net/qinjuning/article/details/7599796\">http://blog.csdn.net/qinjuning/article/details/7599796</a></p>\n<p>JNI - JNI<br><a href=\"http://blog.csdn.net/qinjuning/article/details/7607214\">http://blog.csdn.net/qinjuning/article/details/7607214</a></p>\n<p>JNI <br><a href=\"http://blog.csdn.net/banketree/article/details/40535325\">http://blog.csdn.net/banketree/article/details/40535325</a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/05/24/JNI-Learning0/\">http://agehua.github.io/2016/05/24/JNI-Learning0/</a></p>"},{"layout":"post","title":"Gson","keywords":"gson, json","description":"Gson","banner":"http://obxk8w81b.bkt.clouddn.com/Child%20with%20Orange.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Child%20with%20Orange.jpg","_content":"\n\n### 1.Gson\nGson GoogleJavaJSONJavaJSONJavaJavaJSON\nGson\n\n- 1.**{XXXBean.class**\n- 2.**[XXXBean[].classlist<XXXBean>**\n\n<!--more-->\n\n### 2.\n\n- json\n\n~~~ javascript\n{\n    \"items\": [\n        {\n            \"key\": \"H60-L12__1464938219953__346589_483\",\n            \"hash\": \"Fip_In4BhB5syoZ28W3l_eb6rBDU\",\n            \"fsize\": 348120,\n            \"mimeType\": \"image/jpeg\",\n            \"putTime\": 14649382507765902\n        },\n        {\n            \"key\": \"H60-L12__1465352164202__397253_2946\",\n            \"hash\": \"Fs-UwiosdckN9kVY01GrOYC-b7a9\",\n            \"fsize\": 938413,\n            \"mimeType\": \"image/jpeg\",\n            \"putTime\": 14653521712332144\n        },\n        {\n            \"key\": \"H60-L12__1465352548728__322577_4114\",\n            \"hash\": \"Frga_QiMJVb9caiuwMlJABCsu1rc\",\n            \"fsize\": 506921,\n            \"mimeType\": \"image/jpeg\",\n            \"putTime\": 14653525989907168\n        }\n    ]\n}\n~~~\n\n\n- \n\n{gson.fromJson(jsonstring, XXXBean.class)XXXBeanitems\nitems[itemslist\n\n\n- \n\nGson\n\n~~~ Java\npublic class XXXBean {\n\n    public List<XXXItem> items;\n\n    public List<XXXItem> getItems() {\n        return items;\n    }\n\n    public void setItems(List<XXXItem> items) {\n        this.items = items;\n    }\n\n    public static class XXXItem {\n        private String key;\n        private String hash;\n        private String fsize;\n        private String mimeType;\n        private String putTime;\n\n        ...\n\t}\n}\n\nGson gson = new Gson();\nList<XXXBean.XXXItem> list = gson.fromJson(jsonstring,XXXBean.class).getItems();\n~~~\n\n\n### 3.\n\njson[\n\njson==[{\"id\":1,\"name\":\"\",\"birthDay\":\"Jun 22, 2012 8:28:52 AM\"},{\"id\":2,\"name\":\"\",\"birthDay\":\"Jun 22, 2012 8:28:52 AM\"},{\"id\":3,\"name\":\"\",\"birthDay\":\"Jun 22, 2012 8:28:52 AM\"}]\n\n- list\n\n~~~ Java\n List<Student> retList = gson.fromJson(jsonstring2,  new TypeToken<List<Student>>(){}.getType());\n~~~\n\n\n- \n\n~~~ Java\nStudent[] students= gson.fromJson(jsonstring2,new Student[].class);\n~~~\n\n- listTypeToken\n\n\tTypeTokenGson\n","source":"_posts/2016-06-08-gson-summary.md","raw":"---\nlayout: post\ntitle: Gson\ncategory: accumulation\ntags:\n  - gson \nkeywords: gson, json\ndescription: Gson\nbanner: http://obxk8w81b.bkt.clouddn.com/Child%20with%20Orange.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Child%20with%20Orange.jpg\n---\n\n\n### 1.Gson\nGson GoogleJavaJSONJavaJSONJavaJavaJSON\nGson\n\n- 1.**{XXXBean.class**\n- 2.**[XXXBean[].classlist<XXXBean>**\n\n<!--more-->\n\n### 2.\n\n- json\n\n~~~ javascript\n{\n    \"items\": [\n        {\n            \"key\": \"H60-L12__1464938219953__346589_483\",\n            \"hash\": \"Fip_In4BhB5syoZ28W3l_eb6rBDU\",\n            \"fsize\": 348120,\n            \"mimeType\": \"image/jpeg\",\n            \"putTime\": 14649382507765902\n        },\n        {\n            \"key\": \"H60-L12__1465352164202__397253_2946\",\n            \"hash\": \"Fs-UwiosdckN9kVY01GrOYC-b7a9\",\n            \"fsize\": 938413,\n            \"mimeType\": \"image/jpeg\",\n            \"putTime\": 14653521712332144\n        },\n        {\n            \"key\": \"H60-L12__1465352548728__322577_4114\",\n            \"hash\": \"Frga_QiMJVb9caiuwMlJABCsu1rc\",\n            \"fsize\": 506921,\n            \"mimeType\": \"image/jpeg\",\n            \"putTime\": 14653525989907168\n        }\n    ]\n}\n~~~\n\n\n- \n\n{gson.fromJson(jsonstring, XXXBean.class)XXXBeanitems\nitems[itemslist\n\n\n- \n\nGson\n\n~~~ Java\npublic class XXXBean {\n\n    public List<XXXItem> items;\n\n    public List<XXXItem> getItems() {\n        return items;\n    }\n\n    public void setItems(List<XXXItem> items) {\n        this.items = items;\n    }\n\n    public static class XXXItem {\n        private String key;\n        private String hash;\n        private String fsize;\n        private String mimeType;\n        private String putTime;\n\n        ...\n\t}\n}\n\nGson gson = new Gson();\nList<XXXBean.XXXItem> list = gson.fromJson(jsonstring,XXXBean.class).getItems();\n~~~\n\n\n### 3.\n\njson[\n\njson==[{\"id\":1,\"name\":\"\",\"birthDay\":\"Jun 22, 2012 8:28:52 AM\"},{\"id\":2,\"name\":\"\",\"birthDay\":\"Jun 22, 2012 8:28:52 AM\"},{\"id\":3,\"name\":\"\",\"birthDay\":\"Jun 22, 2012 8:28:52 AM\"}]\n\n- list\n\n~~~ Java\n List<Student> retList = gson.fromJson(jsonstring2,  new TypeToken<List<Student>>(){}.getType());\n~~~\n\n\n- \n\n~~~ Java\nStudent[] students= gson.fromJson(jsonstring2,new Student[].class);\n~~~\n\n- listTypeToken\n\n\tTypeTokenGson\n","slug":"gson-summary","published":1,"date":"2016-06-07T16:00:00.000Z","updated":"2017-11-23T07:05:38.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ebx8000vd6yk88dz51lz","content":"<h3 id=\"1-Gson\"><a href=\"#1-Gson\" class=\"headerlink\" title=\"1.Gson\"></a>1.Gson</h3><p>Gson GoogleJavaJSONJavaJSONJavaJavaJSON<br>Gson</p>\n<ul>\n<li>1.<strong>{XXXBean.class</strong></li>\n<li>2.<strong>[XXXBean[].classlist<xxxbean></xxxbean></strong></li>\n</ul>\n<a id=\"more\"></a>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h3><ul>\n<li>json</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">&#123;</div><div class=\"line\">    <span class=\"string\">\"items\"</span>: [</div><div class=\"line\">        &#123;</div><div class=\"line\">            <span class=\"string\">\"key\"</span>: <span class=\"string\">\"H60-L12__1464938219953__346589_483\"</span>,</div><div class=\"line\">            <span class=\"string\">\"hash\"</span>: <span class=\"string\">\"Fip_In4BhB5syoZ28W3l_eb6rBDU\"</span>,</div><div class=\"line\">            <span class=\"string\">\"fsize\"</span>: <span class=\"number\">348120</span>,</div><div class=\"line\">            <span class=\"string\">\"mimeType\"</span>: <span class=\"string\">\"image/jpeg\"</span>,</div><div class=\"line\">            <span class=\"string\">\"putTime\"</span>: <span class=\"number\">14649382507765902</span></div><div class=\"line\">        &#125;,</div><div class=\"line\">        &#123;</div><div class=\"line\">            <span class=\"string\">\"key\"</span>: <span class=\"string\">\"H60-L12__1465352164202__397253_2946\"</span>,</div><div class=\"line\">            <span class=\"string\">\"hash\"</span>: <span class=\"string\">\"Fs-UwiosdckN9kVY01GrOYC-b7a9\"</span>,</div><div class=\"line\">            <span class=\"string\">\"fsize\"</span>: <span class=\"number\">938413</span>,</div><div class=\"line\">            <span class=\"string\">\"mimeType\"</span>: <span class=\"string\">\"image/jpeg\"</span>,</div><div class=\"line\">            <span class=\"string\">\"putTime\"</span>: <span class=\"number\">14653521712332144</span></div><div class=\"line\">        &#125;,</div><div class=\"line\">        &#123;</div><div class=\"line\">            <span class=\"string\">\"key\"</span>: <span class=\"string\">\"H60-L12__1465352548728__322577_4114\"</span>,</div><div class=\"line\">            <span class=\"string\">\"hash\"</span>: <span class=\"string\">\"Frga_QiMJVb9caiuwMlJABCsu1rc\"</span>,</div><div class=\"line\">            <span class=\"string\">\"fsize\"</span>: <span class=\"number\">506921</span>,</div><div class=\"line\">            <span class=\"string\">\"mimeType\"</span>: <span class=\"string\">\"image/jpeg\"</span>,</div><div class=\"line\">            <span class=\"string\">\"putTime\"</span>: <span class=\"number\">14653525989907168</span></div><div class=\"line\">        &#125;</div><div class=\"line\">    ]</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<ul>\n<li></li>\n</ul>\n<p>{gson.fromJson(jsonstring, XXXBean.class)XXXBeanitems<br>items[itemslist</p>\n<ul>\n<li></li>\n</ul>\n<p>Gson</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">XXXBean</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">public</span> List&lt;XXXItem&gt; items;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> List&lt;XXXItem&gt; <span class=\"title\">getItems</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> items;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setItems</span><span class=\"params\">(List&lt;XXXItem&gt; items)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">this</span>.items = items;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">XXXItem</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">private</span> String key;</div><div class=\"line\">        <span class=\"keyword\">private</span> String hash;</div><div class=\"line\">        <span class=\"keyword\">private</span> String fsize;</div><div class=\"line\">        <span class=\"keyword\">private</span> String mimeType;</div><div class=\"line\">        <span class=\"keyword\">private</span> String putTime;</div><div class=\"line\"></div><div class=\"line\">        ...</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">Gson gson = <span class=\"keyword\">new</span> Gson();</div><div class=\"line\">List&lt;XXXBean.XXXItem&gt; list = gson.fromJson(jsonstring,XXXBean.class).getItems();</div></pre></td></tr></table></figure>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h3><p>json[</p>\n<p>json==[{id:1,name:,birthDay:Jun 22, 2012 8:28:52 AM},{id:2,name:,birthDay:Jun 22, 2012 8:28:52 AM},{id:3,name:,birthDay:Jun 22, 2012 8:28:52 AM}]</p>\n<ul>\n<li>list</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">List&lt;Student&gt; retList = gson.fromJson(jsonstring2,  <span class=\"keyword\">new</span> TypeToken&lt;List&lt;Student&gt;&gt;()&#123;&#125;.getType());</div></pre></td></tr></table></figure>\n<ul>\n<li></li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Student[] students= gson.fromJson(jsonstring2,<span class=\"keyword\">new</span> Student[].class);</div></pre></td></tr></table></figure>\n<ul>\n<li><p>listTypeToken</p>\n<p>  TypeTokenGson</p>\n</li>\n</ul>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/06/08/gson-summary/\">http://agehua.github.io/2016/06/08/gson-summary/</a></p>\n","readingTime":{"text":"2 min read","minutes":1.44,"time":86399.99999999999,"words":288},"excerpt":"<h3 id=\"1-Gson\"><a href=\"#1-Gson\" class=\"headerlink\" title=\"1.Gson\"></a>1.Gson</h3><p>Gson GoogleJavaJSONJavaJSONJavaJavaJSON<br>Gson</p>\n<ul>\n<li>1.<strong>{XXXBean.class</strong></li>\n<li>2.<strong>[XXXBean[].classlist<XXXBean></strong></li>\n</ul>","more":"<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h3><ul>\n<li>json</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">&#123;</div><div class=\"line\">    <span class=\"string\">\"items\"</span>: [</div><div class=\"line\">        &#123;</div><div class=\"line\">            <span class=\"string\">\"key\"</span>: <span class=\"string\">\"H60-L12__1464938219953__346589_483\"</span>,</div><div class=\"line\">            <span class=\"string\">\"hash\"</span>: <span class=\"string\">\"Fip_In4BhB5syoZ28W3l_eb6rBDU\"</span>,</div><div class=\"line\">            <span class=\"string\">\"fsize\"</span>: <span class=\"number\">348120</span>,</div><div class=\"line\">            <span class=\"string\">\"mimeType\"</span>: <span class=\"string\">\"image/jpeg\"</span>,</div><div class=\"line\">            <span class=\"string\">\"putTime\"</span>: <span class=\"number\">14649382507765902</span></div><div class=\"line\">        &#125;,</div><div class=\"line\">        &#123;</div><div class=\"line\">            <span class=\"string\">\"key\"</span>: <span class=\"string\">\"H60-L12__1465352164202__397253_2946\"</span>,</div><div class=\"line\">            <span class=\"string\">\"hash\"</span>: <span class=\"string\">\"Fs-UwiosdckN9kVY01GrOYC-b7a9\"</span>,</div><div class=\"line\">            <span class=\"string\">\"fsize\"</span>: <span class=\"number\">938413</span>,</div><div class=\"line\">            <span class=\"string\">\"mimeType\"</span>: <span class=\"string\">\"image/jpeg\"</span>,</div><div class=\"line\">            <span class=\"string\">\"putTime\"</span>: <span class=\"number\">14653521712332144</span></div><div class=\"line\">        &#125;,</div><div class=\"line\">        &#123;</div><div class=\"line\">            <span class=\"string\">\"key\"</span>: <span class=\"string\">\"H60-L12__1465352548728__322577_4114\"</span>,</div><div class=\"line\">            <span class=\"string\">\"hash\"</span>: <span class=\"string\">\"Frga_QiMJVb9caiuwMlJABCsu1rc\"</span>,</div><div class=\"line\">            <span class=\"string\">\"fsize\"</span>: <span class=\"number\">506921</span>,</div><div class=\"line\">            <span class=\"string\">\"mimeType\"</span>: <span class=\"string\">\"image/jpeg\"</span>,</div><div class=\"line\">            <span class=\"string\">\"putTime\"</span>: <span class=\"number\">14653525989907168</span></div><div class=\"line\">        &#125;</div><div class=\"line\">    ]</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<ul>\n<li></li>\n</ul>\n<p>{gson.fromJson(jsonstring, XXXBean.class)XXXBeanitems<br>items[itemslist</p>\n<ul>\n<li></li>\n</ul>\n<p>Gson</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">XXXBean</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">public</span> List&lt;XXXItem&gt; items;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> List&lt;XXXItem&gt; <span class=\"title\">getItems</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> items;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setItems</span><span class=\"params\">(List&lt;XXXItem&gt; items)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">this</span>.items = items;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">XXXItem</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">private</span> String key;</div><div class=\"line\">        <span class=\"keyword\">private</span> String hash;</div><div class=\"line\">        <span class=\"keyword\">private</span> String fsize;</div><div class=\"line\">        <span class=\"keyword\">private</span> String mimeType;</div><div class=\"line\">        <span class=\"keyword\">private</span> String putTime;</div><div class=\"line\"></div><div class=\"line\">        ...</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">Gson gson = <span class=\"keyword\">new</span> Gson();</div><div class=\"line\">List&lt;XXXBean.XXXItem&gt; list = gson.fromJson(jsonstring,XXXBean.class).getItems();</div></pre></td></tr></table></figure>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h3><p>json[</p>\n<p>json==[{id:1,name:,birthDay:Jun 22, 2012 8:28:52 AM},{id:2,name:,birthDay:Jun 22, 2012 8:28:52 AM},{id:3,name:,birthDay:Jun 22, 2012 8:28:52 AM}]</p>\n<ul>\n<li>list</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">List&lt;Student&gt; retList = gson.fromJson(jsonstring2,  <span class=\"keyword\">new</span> TypeToken&lt;List&lt;Student&gt;&gt;()&#123;&#125;.getType());</div></pre></td></tr></table></figure>\n<ul>\n<li></li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Student[] students= gson.fromJson(jsonstring2,<span class=\"keyword\">new</span> Student[].class);</div></pre></td></tr></table></figure>\n<ul>\n<li><p>listTypeToken</p>\n<p>  TypeTokenGson</p>\n</li>\n</ul>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/06/08/gson-summary/\">http://agehua.github.io/2016/06/08/gson-summary/</a></p>"},{"layout":"post","title":"android","keywords":"qiniu, android","description":"androidlistdeleteuploaddownload","banner":"http://obxk8w81b.bkt.clouddn.com/Avenue%20of%20Plane%20Trees%20near%20Arles%20Station.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Avenue%20of%20Plane%20Trees%20near%20Arles%20Station.jpg","_content":"\n\n\n### 1.android\n\n  androidlistdeleteuploaddownload\n\n  **AccessKeySecretKeyjava**\n\n  :)  \n\n<!--more-->\n\n### 2.\n\n\n\n- \n\n~~~ Java\n package com.qiniu.ui.utils;\n\n import android.graphics.Bitmap;\n import android.graphics.Bitmap.CompressFormat;\n import android.os.Environment;\n import android.util.Log;\n import com.loopj.android.http.AsyncHttpClient;\n import com.loopj.android.http.AsyncHttpResponseHandler;\n import com.loopj.android.http.RequestParams;\n import com.qiniu.android.storage.UpProgressHandler;\n import com.qiniu.android.storage.UploadManager;\n import com.qiniu.android.storage.UploadOptions;\n import com.qiniu.android.utils.UrlSafeBase64;\n import com.qiniu.api.auth.AuthException;\n import com.qiniu.api.auth.digest.Mac;\n import com.qiniu.api.rs.PutPolicy;\n import com.qiniu.ui.SHA;\n import com.qiniu.ui.contains.QiNiuConfig;\n import org.apache.http.Header;\n import org.json.JSONException;\n import java.io.BufferedOutputStream;\n import java.io.FileOutputStream;\n import java.util.Random;\n import static com.qiniu.ui.SHA.hMacSHA1Encrypt;\n\n\n /**\n  * @date 2016526 11:00:43\n  * @author lijixin\n  * @web https://agehua.github.io\n  * @Description: \n  */\n public class QiniuUitls {\n\n \tprivate static final String fileName = \"temp.jpg\";\n \tprivate static final String tempJpeg = Environment.getExternalStorageDirectory().getPath() + \"/\" + fileName;\n\n \tprivate static int maxWidth = 720;\n \tprivate static int maxHeight = 1080;\n\n \tpublic interface QiniuUploadUitlsListener {\n \t\tvoid onSucess(String fileUrl);\n \t\tvoid onError(int errorCode, String msg);\n \t\tvoid onProgress(int progress);\n \t}\n\n \tpublic interface QiniuRequestListener {\n \t\tvoid onSucceed(byte[] bytes);\n \t\tvoid onFailed(byte[] bytes);\n \t}\n\n \t/**\n \t * bitmapjpeg720*1080\n \t * @param bitmap\n \t * @param filePath\n \t * @param quality\n \t * @return\n \t */\n \tpublic static boolean saveBitmapToJpegFile(Bitmap bitmap, String filePath, int quality) {\n \t\ttry {\n \t\t\tFileOutputStream fileOutStr = new FileOutputStream(filePath);\n \t\t\tBufferedOutputStream bufOutStr = new BufferedOutputStream(fileOutStr);\n \t\t\tresizeBitmap(bitmap).compress(CompressFormat.JPEG, quality, bufOutStr);\n \t\t\tbufOutStr.flush();\n \t\t\tbufOutStr.close();\n \t\t} catch (Exception exception) {\n \t\t\treturn false;\n \t\t}\n \t\treturn true;\n \t}\n\n \t/**\n \t * \n \t *\n \t * @param bitmap\n \t * @return\n \t */\n \tpublic static Bitmap resizeBitmap(Bitmap bitmap) {\n \t\tif (bitmap != null) {\n \t\t\tint width = bitmap.getWidth();\n \t\t\tint height = bitmap.getHeight();\n \t\t\t//720\n \t\t\tif (width > maxWidth) {\n \t\t\t\t//\n \t\t\t\tint pWidth = maxWidth;\n \t\t\t\tint pHeight = maxWidth * height / width;\n \t\t\t\tBitmap result = Bitmap.createScaledBitmap(bitmap, pWidth, pHeight, false);\n \t\t\t\tbitmap.recycle();\n \t\t\t\treturn result;\n \t\t\t}\n \t\t\tif (height > maxHeight) {\n \t\t\t\t//\n \t\t\t\tint pHeight = maxHeight;\n \t\t\t\tint pWidth = maxHeight * width / height;\n \t\t\t\tBitmap result = Bitmap.createScaledBitmap(bitmap, pWidth, pHeight, false);\n \t\t\t\tbitmap.recycle();\n \t\t\t\treturn result;\n \t\t\t}\n \t\t}\n \t\treturn bitmap;\n \t}\n\n \tpublic static void uploadImage(Bitmap bitmap, QiniuUploadUitlsListener listener) {\n \t\tsaveBitmapToJpegFile(bitmap, tempJpeg,100);\n \t\tuploadImage(tempJpeg, listener);\n \t}\n\n \t/**\n \t * jpgapijpg\n \t * @param filePath\n \t * @param listener\n \t */\n \tpublic static void uploadImage(String filePath, final QiniuUploadUitlsListener listener) {\n \t\tfinal String fileUrlUUID = getFileUrlUUID();\n \t\tString token = getToken();\n \t\tif (token == null) {\n \t\t\tif (listener != null) {\n \t\t\t\tlistener.onError(-1, \"token is null\");\n \t\t\t}\n \t\t\treturn;\n \t\t}\n \t\tUploadManager uploadManager = new UploadManager();\n \t\tuploadManager.put(filePath, fileUrlUUID, token, (key, info, response) -> {\n \t\t\tSystem.out.println(\"debug:info = \" + info + \",response = \" + response);\n \t\t\tif (info != null && info.statusCode == 200) {// \n \t\t\t\tString fileRealUrl = getRealUrl(fileUrlUUID);\n \t\t\t\tSystem.out.println(\"debug:fileRealUrl = \" + fileRealUrl);\n \t\t\t\tif (listener != null) {\n \t\t\t\t\tlistener.onSucess(fileRealUrl);\n \t\t\t\t}\n \t\t\t} else {\n \t\t\t\tif (listener != null) {\n \t\t\t\t\tlistener.onError(info.statusCode, info.error);\n \t\t\t\t}\n \t\t\t}\n \t\t}, new UploadOptions(null, null, false, new UpProgressHandler() {\n \t\t\tpublic void progress(String key, double percent) {\n \t\t\t\tif (listener != null) {\n \t\t\t\t\tlistener.onProgress((int) (percent * 100));\n \t\t\t\t}\n \t\t\t}\n \t\t}, null));\n \t}\n\n \t/**\n \t * \n \t * <p>\t H60-L12__1464851303930__156750_1884</p>\n \t * @return\n \t */\n \tprivate static String getFileUrlUUID() {\n \t\tString filePath = android.os.Build.MODEL + \"__\" + System.currentTimeMillis() + \"__\" + (new Random().nextInt(500000))\n \t\t\t\t+ \"_\" + (new Random().nextInt(10000));\n \t\treturn filePath.replace(\".\", \"0\");\n \t}\n\n \tprivate static String getRealUrl(String fileUrlUUID) {\n \t\tString filePath = \"http://\" + QiNiuConfig.QINIU_BUCKNAME + \".qiniudn.com/\" + fileUrlUUID;\n \t\treturn filePath;\n \t}\n\n \t/**\n \t * token \n \t *\n \t * @return\n \t */\n \tprivate static String getToken() {\n \t\tMac mac = new Mac(QiNiuConfig.QINIU_AK, QiNiuConfig.QINIU_SK);\n \t\tPutPolicy putPolicy = new PutPolicy(QiNiuConfig.QINIU_BUCKNAME);\n \t\tputPolicy.returnBody = \"{\\\"name\\\": $(fname),\\\"size\\\": \\\"$(fsize)\\\",\\\"w\\\": \\\"$(imageInfo.width)\\\",\\\"h\\\": \\\"$(imageInfo.height)\\\",\\\"key\\\":$(etag)}\";\n \t\ttry {\n \t\t\tString uptoken = putPolicy.token(mac);\n \t\t\tSystem.out.println(\"debug:uptoken = \" + uptoken);\n \t\t\treturn uptoken;\n \t\t} catch (AuthException e) {\n \t\t\te.printStackTrace();\n \t\t} catch (JSONException e) {\n \t\t\te.printStackTrace();\n \t\t}\n \t\treturn null;\n \t}\n\n \t/**\n \t * hostfileurl\n \t * @param domain host\n \t * @param imgKey file key\n \t * @return url\n \t */\n \tpublic static String downloadFile(String domain,String imgKey){\n \t\t//\n \t\t//\n //\t\tString domain =\"http://example.xxx.clouddn.com/\";\n //\t\tString path =\"H60-L12__1464917382714__36888_5255\";\n \t\tStringBuilder sb =new StringBuilder();\n \t\t//\n \t\tString url = sb.append(domain).append(imgKey).append(\"?e=1478365261\").toString();\n \t\tLog.e(\"encodedEntryURI\",url);\n\n \t\tbyte[] sign =null;\n \t\ttry {\n \t\t\tsign = SHA.hMacSHA1Encrypt(url,QiNiuConfig.QINIU_SK);\n \t\t} catch (Exception e) {\n \t\t\te.printStackTrace();\n \t\t}\n \t\tString encodedSign = UrlSafeBase64.encodeToString(sign);\n \t\tsb.append(\"&token=\").append(QiNiuConfig.QINIU_AK).append(\":\").append(encodedSign);\n \t\tLog.e(\"download token\",sb.toString());\n \t\treturn sb.toString();\n \t}\n\n \t/**\n \t * \n \t * @param bucket \n \t * @param prefix \n \t * @param listener\n \t * @return\n \t */\n \tpublic static void listFile(String bucket, String prefix,final QiniuRequestListener listener){\n\n \t\ttry{\n \t\t\tStringBuilder sb = new StringBuilder();\n\n \t\t\tString entryUrl = sb.append(\"bucket=\").append(bucket)\n \t\t\t\t\t.append(\"&prefix=\").append(prefix).toString();\n \t\t\tString host = \"http://rsf.qbox.me\";\n \t\t\tString path = \"/list?\" +entryUrl;\n \t\t\tString url = host+path;\n \t\t\tLog.e(\"AAAAAAA\", url);\n \t\t\tbyte[] sign = SHA.hMacSHA1Encrypt(path+\"\\n\", QiNiuConfig.QINIU_SK);\n \t\t\tString encodedSign = UrlSafeBase64.encodeToString(sign);\n \t\t\tString authorization = QiNiuConfig.QINIU_AK + ':' + encodedSign;\n \t\t\tAsyncHttpClient client = new AsyncHttpClient();\n \t\t\tclient.addHeader(\"Content-Type\",\"application/x-www-form-urlencoded\");\n \t\t\tclient.addHeader(\"Authorization\", \"QBox \"+authorization);\n \t\t\tRequestParams params = new RequestParams();\n \t\t\tclient.post(url, params, new AsyncHttpResponseHandler() {\n \t\t\t\t@Override\n \t\t\t\tpublic void onSuccess(int i, Header[] headers, byte[] bytes) {\n \t\t\t\t\tif (null!=listener)\n \t\t\t\t\t\tlistener.onSucceed(bytes);\n \t\t\t\t}\n\n \t\t\t\t@Override\n \t\t\t\tpublic void onFailure(int i, Header[] headers, byte[] bytes, Throwable throwable) {\n \t\t\t\t\tif (null!=listener)\n \t\t\t\t\t\tlistener.onFailed(bytes);\n \t\t\t\t}\n \t\t\t});\n \t\t}catch(Exception e){\n \t\t\te.printStackTrace();\n \t\t}\n \t\treturn ;\n \t}\n\n \t/**\n \t * \n \t * @param bucket \n \t * @param fileName \n \t * */\n \tpublic static boolean deleteFile(String bucket,String fileName,final QiniuRequestListener listener){\n \t\ttry{\n \t\t\tString entryUrl = bucket+\":\"+fileName;\n \t\t\tString encodedEntryURI = UrlSafeBase64.encodeToString(entryUrl.getBytes());\n \t\t\tString host = \"http://rs.qiniu.com\";\n \t\t\tString path = \"/delete/\"+encodedEntryURI;\n \t\t\tString url = host+path;\n \t\t\tLog.e(\"AAAAAAA\", url);\n \t\t\tbyte[] sign = hMacSHA1Encrypt(path+\"\\n\", QiNiuConfig.QINIU_SK);\n \t\t\tString encodedSign = UrlSafeBase64.encodeToString(sign);\n \t\t\tString authorization = QiNiuConfig.QINIU_AK + ':' + encodedSign;\n\n \t\t\tAsyncHttpClient client = new AsyncHttpClient();\n \t\t\tclient.addHeader(\"Content-Type\",\"application/x-www-form-urlencoded\");\n \t\t\tclient.addHeader(\"Authorization\", \"QBox \"+authorization);\n \t\t\tRequestParams params = new RequestParams();\n \t\t\tclient.post(url, params, new AsyncHttpResponseHandler() {\n \t\t\t\t@Override\n \t\t\t\tpublic void onSuccess(int i, Header[] headers, byte[] bytes) {\n \t\t\t\t\tif (null!=listener)\n \t\t\t\t\t\tlistener.onSucceed(bytes);\n \t\t\t\t}\n\n \t\t\t\t@Override\n \t\t\t\tpublic void onFailure(int i, Header[] headers, byte[] bytes, Throwable throwable) {\n \t\t\t\t\tif (null!=listener)\n \t\t\t\t\t\tlistener.onFailed(bytes);\n \t\t\t\t\tif (null!=bytes) {\n \t\t\t\t\t\tString s = new String(bytes);\n \t\t\t\t\t}\n \t\t\t\t}\n \t\t\t});\n\n \t\t}catch(Exception e){\n \t\t\te.printStackTrace();\n \t\t}\n \t\treturn false;\n \t}\n\n }\n~~~\n\n- HMAC-SHA1\n\n[](http://developer.qiniu.com/article/developer/security/access-token.html)\n\n~~~ Java\n/**\n * HMAC-SHA1\n * @author agehua\n *\n */\npublic class SHA {\n\n    private static final String MAC_NAME = \"HmacSHA1\";\n    private static final String ENCODING = \"UTF-8\";\n\n    /**\n     *\n     *  HMAC-SHA1 encryptText\n     * @param encryptText \n     * @param encryptKey \n     * @return\n     * @throws Exception\n     */\n    public static byte[] hMacSHA1Encrypt(String encryptText, String encryptKey)\n            throws Exception {\n        byte[] data = encryptKey.getBytes(ENCODING);\n        // ,\n        SecretKey secretKey = new SecretKeySpec(data, MAC_NAME);\n        //  Mac   Mac \n        Mac mac = Mac.getInstance(MAC_NAME);\n        //  Mac \n        mac.init(secretKey);\n        byte[] text = encryptText.getBytes(ENCODING);\n        //  Mac \n        return mac.doFinal(text);\n    }\n}  \n~~~  \n\n- Config\n\n~~~ Java\npublic final class QiNiuConfig {\n\tpublic static final String token = getToken();\n\tpublic static final String QINIU_AK = \"Your_AccessKey\";\n\tpublic static final String QINIU_SK = \"Your_SecretKey\";\n\tpublic static final String QINIU_BUCKNAME = \"\";\n\n\tpublic static String getToken() {\n\t\tMac mac = new Mac(QiNiuConfig.QINIU_AK, QiNiuConfig.QINIU_SK);\n\t\tPutPolicy putPolicy = new PutPolicy(QiNiuConfig.QINIU_BUCKNAME);\n\t\tputPolicy.returnBody = \"{\\\"name\\\": $(fname),\\\"size\\\": \\\"$(fsize)\\\",\\\"w\\\": \\\"$(imageInfo.width)\\\",\\\"h\\\": \\\"$(imageInfo.height)\\\",\\\"key\\\":$(etag)}\";\n\t\ttry {\n\t\t\tString uptoken = putPolicy.token(mac);\n\t\t\tSystem.out.println(\"debug:uptoken = \" + uptoken);\n\t\t\treturn uptoken;\n\t\t} catch (AuthException e) {\n\t\t\te.printStackTrace();\n\t\t} catch (JSONException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t\treturn null;\n\t}\n}\n\n~~~\n\n [Gist](https://gist.github.com/agehua/f73bcb98af2c0c44a4c49c7c7b7e6bda)\n\n :)  \n","source":"_posts/2016-05-28-qiniu-android-summary.md","raw":"---\nlayout: post\ntitle: android\ncategory: technology\ntags:\n  - ANDROID\n  - qiniu\nkeywords: qiniu, android\ndescription: androidlistdeleteuploaddownload\nbanner: http://obxk8w81b.bkt.clouddn.com/Avenue%20of%20Plane%20Trees%20near%20Arles%20Station.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Avenue%20of%20Plane%20Trees%20near%20Arles%20Station.jpg\n\n---\n\n\n\n### 1.android\n\n  androidlistdeleteuploaddownload\n\n  **AccessKeySecretKeyjava**\n\n  :)  \n\n<!--more-->\n\n### 2.\n\n\n\n- \n\n~~~ Java\n package com.qiniu.ui.utils;\n\n import android.graphics.Bitmap;\n import android.graphics.Bitmap.CompressFormat;\n import android.os.Environment;\n import android.util.Log;\n import com.loopj.android.http.AsyncHttpClient;\n import com.loopj.android.http.AsyncHttpResponseHandler;\n import com.loopj.android.http.RequestParams;\n import com.qiniu.android.storage.UpProgressHandler;\n import com.qiniu.android.storage.UploadManager;\n import com.qiniu.android.storage.UploadOptions;\n import com.qiniu.android.utils.UrlSafeBase64;\n import com.qiniu.api.auth.AuthException;\n import com.qiniu.api.auth.digest.Mac;\n import com.qiniu.api.rs.PutPolicy;\n import com.qiniu.ui.SHA;\n import com.qiniu.ui.contains.QiNiuConfig;\n import org.apache.http.Header;\n import org.json.JSONException;\n import java.io.BufferedOutputStream;\n import java.io.FileOutputStream;\n import java.util.Random;\n import static com.qiniu.ui.SHA.hMacSHA1Encrypt;\n\n\n /**\n  * @date 2016526 11:00:43\n  * @author lijixin\n  * @web https://agehua.github.io\n  * @Description: \n  */\n public class QiniuUitls {\n\n \tprivate static final String fileName = \"temp.jpg\";\n \tprivate static final String tempJpeg = Environment.getExternalStorageDirectory().getPath() + \"/\" + fileName;\n\n \tprivate static int maxWidth = 720;\n \tprivate static int maxHeight = 1080;\n\n \tpublic interface QiniuUploadUitlsListener {\n \t\tvoid onSucess(String fileUrl);\n \t\tvoid onError(int errorCode, String msg);\n \t\tvoid onProgress(int progress);\n \t}\n\n \tpublic interface QiniuRequestListener {\n \t\tvoid onSucceed(byte[] bytes);\n \t\tvoid onFailed(byte[] bytes);\n \t}\n\n \t/**\n \t * bitmapjpeg720*1080\n \t * @param bitmap\n \t * @param filePath\n \t * @param quality\n \t * @return\n \t */\n \tpublic static boolean saveBitmapToJpegFile(Bitmap bitmap, String filePath, int quality) {\n \t\ttry {\n \t\t\tFileOutputStream fileOutStr = new FileOutputStream(filePath);\n \t\t\tBufferedOutputStream bufOutStr = new BufferedOutputStream(fileOutStr);\n \t\t\tresizeBitmap(bitmap).compress(CompressFormat.JPEG, quality, bufOutStr);\n \t\t\tbufOutStr.flush();\n \t\t\tbufOutStr.close();\n \t\t} catch (Exception exception) {\n \t\t\treturn false;\n \t\t}\n \t\treturn true;\n \t}\n\n \t/**\n \t * \n \t *\n \t * @param bitmap\n \t * @return\n \t */\n \tpublic static Bitmap resizeBitmap(Bitmap bitmap) {\n \t\tif (bitmap != null) {\n \t\t\tint width = bitmap.getWidth();\n \t\t\tint height = bitmap.getHeight();\n \t\t\t//720\n \t\t\tif (width > maxWidth) {\n \t\t\t\t//\n \t\t\t\tint pWidth = maxWidth;\n \t\t\t\tint pHeight = maxWidth * height / width;\n \t\t\t\tBitmap result = Bitmap.createScaledBitmap(bitmap, pWidth, pHeight, false);\n \t\t\t\tbitmap.recycle();\n \t\t\t\treturn result;\n \t\t\t}\n \t\t\tif (height > maxHeight) {\n \t\t\t\t//\n \t\t\t\tint pHeight = maxHeight;\n \t\t\t\tint pWidth = maxHeight * width / height;\n \t\t\t\tBitmap result = Bitmap.createScaledBitmap(bitmap, pWidth, pHeight, false);\n \t\t\t\tbitmap.recycle();\n \t\t\t\treturn result;\n \t\t\t}\n \t\t}\n \t\treturn bitmap;\n \t}\n\n \tpublic static void uploadImage(Bitmap bitmap, QiniuUploadUitlsListener listener) {\n \t\tsaveBitmapToJpegFile(bitmap, tempJpeg,100);\n \t\tuploadImage(tempJpeg, listener);\n \t}\n\n \t/**\n \t * jpgapijpg\n \t * @param filePath\n \t * @param listener\n \t */\n \tpublic static void uploadImage(String filePath, final QiniuUploadUitlsListener listener) {\n \t\tfinal String fileUrlUUID = getFileUrlUUID();\n \t\tString token = getToken();\n \t\tif (token == null) {\n \t\t\tif (listener != null) {\n \t\t\t\tlistener.onError(-1, \"token is null\");\n \t\t\t}\n \t\t\treturn;\n \t\t}\n \t\tUploadManager uploadManager = new UploadManager();\n \t\tuploadManager.put(filePath, fileUrlUUID, token, (key, info, response) -> {\n \t\t\tSystem.out.println(\"debug:info = \" + info + \",response = \" + response);\n \t\t\tif (info != null && info.statusCode == 200) {// \n \t\t\t\tString fileRealUrl = getRealUrl(fileUrlUUID);\n \t\t\t\tSystem.out.println(\"debug:fileRealUrl = \" + fileRealUrl);\n \t\t\t\tif (listener != null) {\n \t\t\t\t\tlistener.onSucess(fileRealUrl);\n \t\t\t\t}\n \t\t\t} else {\n \t\t\t\tif (listener != null) {\n \t\t\t\t\tlistener.onError(info.statusCode, info.error);\n \t\t\t\t}\n \t\t\t}\n \t\t}, new UploadOptions(null, null, false, new UpProgressHandler() {\n \t\t\tpublic void progress(String key, double percent) {\n \t\t\t\tif (listener != null) {\n \t\t\t\t\tlistener.onProgress((int) (percent * 100));\n \t\t\t\t}\n \t\t\t}\n \t\t}, null));\n \t}\n\n \t/**\n \t * \n \t * <p>\t H60-L12__1464851303930__156750_1884</p>\n \t * @return\n \t */\n \tprivate static String getFileUrlUUID() {\n \t\tString filePath = android.os.Build.MODEL + \"__\" + System.currentTimeMillis() + \"__\" + (new Random().nextInt(500000))\n \t\t\t\t+ \"_\" + (new Random().nextInt(10000));\n \t\treturn filePath.replace(\".\", \"0\");\n \t}\n\n \tprivate static String getRealUrl(String fileUrlUUID) {\n \t\tString filePath = \"http://\" + QiNiuConfig.QINIU_BUCKNAME + \".qiniudn.com/\" + fileUrlUUID;\n \t\treturn filePath;\n \t}\n\n \t/**\n \t * token \n \t *\n \t * @return\n \t */\n \tprivate static String getToken() {\n \t\tMac mac = new Mac(QiNiuConfig.QINIU_AK, QiNiuConfig.QINIU_SK);\n \t\tPutPolicy putPolicy = new PutPolicy(QiNiuConfig.QINIU_BUCKNAME);\n \t\tputPolicy.returnBody = \"{\\\"name\\\": $(fname),\\\"size\\\": \\\"$(fsize)\\\",\\\"w\\\": \\\"$(imageInfo.width)\\\",\\\"h\\\": \\\"$(imageInfo.height)\\\",\\\"key\\\":$(etag)}\";\n \t\ttry {\n \t\t\tString uptoken = putPolicy.token(mac);\n \t\t\tSystem.out.println(\"debug:uptoken = \" + uptoken);\n \t\t\treturn uptoken;\n \t\t} catch (AuthException e) {\n \t\t\te.printStackTrace();\n \t\t} catch (JSONException e) {\n \t\t\te.printStackTrace();\n \t\t}\n \t\treturn null;\n \t}\n\n \t/**\n \t * hostfileurl\n \t * @param domain host\n \t * @param imgKey file key\n \t * @return url\n \t */\n \tpublic static String downloadFile(String domain,String imgKey){\n \t\t//\n \t\t//\n //\t\tString domain =\"http://example.xxx.clouddn.com/\";\n //\t\tString path =\"H60-L12__1464917382714__36888_5255\";\n \t\tStringBuilder sb =new StringBuilder();\n \t\t//\n \t\tString url = sb.append(domain).append(imgKey).append(\"?e=1478365261\").toString();\n \t\tLog.e(\"encodedEntryURI\",url);\n\n \t\tbyte[] sign =null;\n \t\ttry {\n \t\t\tsign = SHA.hMacSHA1Encrypt(url,QiNiuConfig.QINIU_SK);\n \t\t} catch (Exception e) {\n \t\t\te.printStackTrace();\n \t\t}\n \t\tString encodedSign = UrlSafeBase64.encodeToString(sign);\n \t\tsb.append(\"&token=\").append(QiNiuConfig.QINIU_AK).append(\":\").append(encodedSign);\n \t\tLog.e(\"download token\",sb.toString());\n \t\treturn sb.toString();\n \t}\n\n \t/**\n \t * \n \t * @param bucket \n \t * @param prefix \n \t * @param listener\n \t * @return\n \t */\n \tpublic static void listFile(String bucket, String prefix,final QiniuRequestListener listener){\n\n \t\ttry{\n \t\t\tStringBuilder sb = new StringBuilder();\n\n \t\t\tString entryUrl = sb.append(\"bucket=\").append(bucket)\n \t\t\t\t\t.append(\"&prefix=\").append(prefix).toString();\n \t\t\tString host = \"http://rsf.qbox.me\";\n \t\t\tString path = \"/list?\" +entryUrl;\n \t\t\tString url = host+path;\n \t\t\tLog.e(\"AAAAAAA\", url);\n \t\t\tbyte[] sign = SHA.hMacSHA1Encrypt(path+\"\\n\", QiNiuConfig.QINIU_SK);\n \t\t\tString encodedSign = UrlSafeBase64.encodeToString(sign);\n \t\t\tString authorization = QiNiuConfig.QINIU_AK + ':' + encodedSign;\n \t\t\tAsyncHttpClient client = new AsyncHttpClient();\n \t\t\tclient.addHeader(\"Content-Type\",\"application/x-www-form-urlencoded\");\n \t\t\tclient.addHeader(\"Authorization\", \"QBox \"+authorization);\n \t\t\tRequestParams params = new RequestParams();\n \t\t\tclient.post(url, params, new AsyncHttpResponseHandler() {\n \t\t\t\t@Override\n \t\t\t\tpublic void onSuccess(int i, Header[] headers, byte[] bytes) {\n \t\t\t\t\tif (null!=listener)\n \t\t\t\t\t\tlistener.onSucceed(bytes);\n \t\t\t\t}\n\n \t\t\t\t@Override\n \t\t\t\tpublic void onFailure(int i, Header[] headers, byte[] bytes, Throwable throwable) {\n \t\t\t\t\tif (null!=listener)\n \t\t\t\t\t\tlistener.onFailed(bytes);\n \t\t\t\t}\n \t\t\t});\n \t\t}catch(Exception e){\n \t\t\te.printStackTrace();\n \t\t}\n \t\treturn ;\n \t}\n\n \t/**\n \t * \n \t * @param bucket \n \t * @param fileName \n \t * */\n \tpublic static boolean deleteFile(String bucket,String fileName,final QiniuRequestListener listener){\n \t\ttry{\n \t\t\tString entryUrl = bucket+\":\"+fileName;\n \t\t\tString encodedEntryURI = UrlSafeBase64.encodeToString(entryUrl.getBytes());\n \t\t\tString host = \"http://rs.qiniu.com\";\n \t\t\tString path = \"/delete/\"+encodedEntryURI;\n \t\t\tString url = host+path;\n \t\t\tLog.e(\"AAAAAAA\", url);\n \t\t\tbyte[] sign = hMacSHA1Encrypt(path+\"\\n\", QiNiuConfig.QINIU_SK);\n \t\t\tString encodedSign = UrlSafeBase64.encodeToString(sign);\n \t\t\tString authorization = QiNiuConfig.QINIU_AK + ':' + encodedSign;\n\n \t\t\tAsyncHttpClient client = new AsyncHttpClient();\n \t\t\tclient.addHeader(\"Content-Type\",\"application/x-www-form-urlencoded\");\n \t\t\tclient.addHeader(\"Authorization\", \"QBox \"+authorization);\n \t\t\tRequestParams params = new RequestParams();\n \t\t\tclient.post(url, params, new AsyncHttpResponseHandler() {\n \t\t\t\t@Override\n \t\t\t\tpublic void onSuccess(int i, Header[] headers, byte[] bytes) {\n \t\t\t\t\tif (null!=listener)\n \t\t\t\t\t\tlistener.onSucceed(bytes);\n \t\t\t\t}\n\n \t\t\t\t@Override\n \t\t\t\tpublic void onFailure(int i, Header[] headers, byte[] bytes, Throwable throwable) {\n \t\t\t\t\tif (null!=listener)\n \t\t\t\t\t\tlistener.onFailed(bytes);\n \t\t\t\t\tif (null!=bytes) {\n \t\t\t\t\t\tString s = new String(bytes);\n \t\t\t\t\t}\n \t\t\t\t}\n \t\t\t});\n\n \t\t}catch(Exception e){\n \t\t\te.printStackTrace();\n \t\t}\n \t\treturn false;\n \t}\n\n }\n~~~\n\n- HMAC-SHA1\n\n[](http://developer.qiniu.com/article/developer/security/access-token.html)\n\n~~~ Java\n/**\n * HMAC-SHA1\n * @author agehua\n *\n */\npublic class SHA {\n\n    private static final String MAC_NAME = \"HmacSHA1\";\n    private static final String ENCODING = \"UTF-8\";\n\n    /**\n     *\n     *  HMAC-SHA1 encryptText\n     * @param encryptText \n     * @param encryptKey \n     * @return\n     * @throws Exception\n     */\n    public static byte[] hMacSHA1Encrypt(String encryptText, String encryptKey)\n            throws Exception {\n        byte[] data = encryptKey.getBytes(ENCODING);\n        // ,\n        SecretKey secretKey = new SecretKeySpec(data, MAC_NAME);\n        //  Mac   Mac \n        Mac mac = Mac.getInstance(MAC_NAME);\n        //  Mac \n        mac.init(secretKey);\n        byte[] text = encryptText.getBytes(ENCODING);\n        //  Mac \n        return mac.doFinal(text);\n    }\n}  \n~~~  \n\n- Config\n\n~~~ Java\npublic final class QiNiuConfig {\n\tpublic static final String token = getToken();\n\tpublic static final String QINIU_AK = \"Your_AccessKey\";\n\tpublic static final String QINIU_SK = \"Your_SecretKey\";\n\tpublic static final String QINIU_BUCKNAME = \"\";\n\n\tpublic static String getToken() {\n\t\tMac mac = new Mac(QiNiuConfig.QINIU_AK, QiNiuConfig.QINIU_SK);\n\t\tPutPolicy putPolicy = new PutPolicy(QiNiuConfig.QINIU_BUCKNAME);\n\t\tputPolicy.returnBody = \"{\\\"name\\\": $(fname),\\\"size\\\": \\\"$(fsize)\\\",\\\"w\\\": \\\"$(imageInfo.width)\\\",\\\"h\\\": \\\"$(imageInfo.height)\\\",\\\"key\\\":$(etag)}\";\n\t\ttry {\n\t\t\tString uptoken = putPolicy.token(mac);\n\t\t\tSystem.out.println(\"debug:uptoken = \" + uptoken);\n\t\t\treturn uptoken;\n\t\t} catch (AuthException e) {\n\t\t\te.printStackTrace();\n\t\t} catch (JSONException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t\treturn null;\n\t}\n}\n\n~~~\n\n [Gist](https://gist.github.com/agehua/f73bcb98af2c0c44a4c49c7c7b7e6bda)\n\n :)  \n","slug":"qiniu-android-summary","published":1,"date":"2016-05-27T16:00:00.000Z","updated":"2017-11-23T07:24:19.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ebxc000xd6ykek6dssmh","content":"<h3 id=\"1-android\"><a href=\"#1-android\" class=\"headerlink\" title=\"1.android\"></a>1.android</h3><p>  androidlistdeleteuploaddownload</p>\n<p>  <strong>AccessKeySecretKeyjava</strong></p>\n<p>  :)  </p>\n<a id=\"more\"></a>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h3><p></p>\n<ul>\n<li></li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">package</span> com.qiniu.ui.utils;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">import</span> android.graphics.Bitmap;</div><div class=\"line\"><span class=\"keyword\">import</span> android.graphics.Bitmap.CompressFormat;</div><div class=\"line\"><span class=\"keyword\">import</span> android.os.Environment;</div><div class=\"line\"><span class=\"keyword\">import</span> android.util.Log;</div><div class=\"line\"><span class=\"keyword\">import</span> com.loopj.android.http.AsyncHttpClient;</div><div class=\"line\"><span class=\"keyword\">import</span> com.loopj.android.http.AsyncHttpResponseHandler;</div><div class=\"line\"><span class=\"keyword\">import</span> com.loopj.android.http.RequestParams;</div><div class=\"line\"><span class=\"keyword\">import</span> com.qiniu.android.storage.UpProgressHandler;</div><div class=\"line\"><span class=\"keyword\">import</span> com.qiniu.android.storage.UploadManager;</div><div class=\"line\"><span class=\"keyword\">import</span> com.qiniu.android.storage.UploadOptions;</div><div class=\"line\"><span class=\"keyword\">import</span> com.qiniu.android.utils.UrlSafeBase64;</div><div class=\"line\"><span class=\"keyword\">import</span> com.qiniu.api.auth.AuthException;</div><div class=\"line\"><span class=\"keyword\">import</span> com.qiniu.api.auth.digest.Mac;</div><div class=\"line\"><span class=\"keyword\">import</span> com.qiniu.api.rs.PutPolicy;</div><div class=\"line\"><span class=\"keyword\">import</span> com.qiniu.ui.SHA;</div><div class=\"line\"><span class=\"keyword\">import</span> com.qiniu.ui.contains.QiNiuConfig;</div><div class=\"line\"><span class=\"keyword\">import</span> org.apache.http.Header;</div><div class=\"line\"><span class=\"keyword\">import</span> org.json.JSONException;</div><div class=\"line\"><span class=\"keyword\">import</span> java.io.BufferedOutputStream;</div><div class=\"line\"><span class=\"keyword\">import</span> java.io.FileOutputStream;</div><div class=\"line\"><span class=\"keyword\">import</span> java.util.Random;</div><div class=\"line\"><span class=\"keyword\">import</span> <span class=\"keyword\">static</span> com.qiniu.ui.SHA.hMacSHA1Encrypt;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * <span class=\"doctag\">@date</span> 2016526 11:00:43</div><div class=\"line\"> * <span class=\"doctag\">@author</span> lijixin</div><div class=\"line\"> * <span class=\"doctag\">@web</span> https://agehua.github.io</div><div class=\"line\"> * <span class=\"doctag\">@Description</span>: </div><div class=\"line\"> */</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">QiniuUitls</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String fileName = <span class=\"string\">\"temp.jpg\"</span>;</div><div class=\"line\">\t<span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String tempJpeg = Environment.getExternalStorageDirectory().getPath() + <span class=\"string\">\"/\"</span> + fileName;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> maxWidth = <span class=\"number\">720</span>;</div><div class=\"line\">\t<span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> maxHeight = <span class=\"number\">1080</span>;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">QiniuUploadUitlsListener</span> </span>&#123;</div><div class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">onSucess</span><span class=\"params\">(String fileUrl)</span></span>;</div><div class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">onError</span><span class=\"params\">(<span class=\"keyword\">int</span> errorCode, String msg)</span></span>;</div><div class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">onProgress</span><span class=\"params\">(<span class=\"keyword\">int</span> progress)</span></span>;</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">QiniuRequestListener</span> </span>&#123;</div><div class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">onSucceed</span><span class=\"params\">(<span class=\"keyword\">byte</span>[] bytes)</span></span>;</div><div class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">onFailed</span><span class=\"params\">(<span class=\"keyword\">byte</span>[] bytes)</span></span>;</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\">/**</span></div><div class=\"line\">\t * bitmapjpeg720*1080</div><div class=\"line\">\t * <span class=\"doctag\">@param</span> bitmap</div><div class=\"line\">\t * <span class=\"doctag\">@param</span> filePath</div><div class=\"line\">\t * <span class=\"doctag\">@param</span> quality</div><div class=\"line\">\t * <span class=\"doctag\">@return</span></div><div class=\"line\">\t */</div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">boolean</span> <span class=\"title\">saveBitmapToJpegFile</span><span class=\"params\">(Bitmap bitmap, String filePath, <span class=\"keyword\">int</span> quality)</span> </span>&#123;</div><div class=\"line\">\t\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\t\tFileOutputStream fileOutStr = <span class=\"keyword\">new</span> FileOutputStream(filePath);</div><div class=\"line\">\t\t\tBufferedOutputStream bufOutStr = <span class=\"keyword\">new</span> BufferedOutputStream(fileOutStr);</div><div class=\"line\">\t\t\tresizeBitmap(bitmap).compress(CompressFormat.JPEG, quality, bufOutStr);</div><div class=\"line\">\t\t\tbufOutStr.flush();</div><div class=\"line\">\t\t\tbufOutStr.close();</div><div class=\"line\">\t\t&#125; <span class=\"keyword\">catch</span> (Exception exception) &#123;</div><div class=\"line\">\t\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\">/**</span></div><div class=\"line\">\t * </div><div class=\"line\">\t *</div><div class=\"line\">\t * <span class=\"doctag\">@param</span> bitmap</div><div class=\"line\">\t * <span class=\"doctag\">@return</span></div><div class=\"line\">\t */</div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Bitmap <span class=\"title\">resizeBitmap</span><span class=\"params\">(Bitmap bitmap)</span> </span>&#123;</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> (bitmap != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">\t\t\t<span class=\"keyword\">int</span> width = bitmap.getWidth();</div><div class=\"line\">\t\t\t<span class=\"keyword\">int</span> height = bitmap.getHeight();</div><div class=\"line\">\t\t\t<span class=\"comment\">//720</span></div><div class=\"line\">\t\t\t<span class=\"keyword\">if</span> (width &gt; maxWidth) &#123;</div><div class=\"line\">\t\t\t\t<span class=\"comment\">//</span></div><div class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> pWidth = maxWidth;</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> pHeight = maxWidth * height / width;</div><div class=\"line\">\t\t\t\tBitmap result = Bitmap.createScaledBitmap(bitmap, pWidth, pHeight, <span class=\"keyword\">false</span>);</div><div class=\"line\">\t\t\t\tbitmap.recycle();</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> result;</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t\t\t<span class=\"keyword\">if</span> (height &gt; maxHeight) &#123;</div><div class=\"line\">\t\t\t\t<span class=\"comment\">//</span></div><div class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> pHeight = maxHeight;</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> pWidth = maxHeight * width / height;</div><div class=\"line\">\t\t\t\tBitmap result = Bitmap.createScaledBitmap(bitmap, pWidth, pHeight, <span class=\"keyword\">false</span>);</div><div class=\"line\">\t\t\t\tbitmap.recycle();</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> result;</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> bitmap;</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">uploadImage</span><span class=\"params\">(Bitmap bitmap, QiniuUploadUitlsListener listener)</span> </span>&#123;</div><div class=\"line\">\t\tsaveBitmapToJpegFile(bitmap, tempJpeg,<span class=\"number\">100</span>);</div><div class=\"line\">\t\tuploadImage(tempJpeg, listener);</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\">/**</span></div><div class=\"line\">\t * jpgapijpg</div><div class=\"line\">\t * <span class=\"doctag\">@param</span> filePath</div><div class=\"line\">\t * <span class=\"doctag\">@param</span> listener</div><div class=\"line\">\t */</div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">uploadImage</span><span class=\"params\">(String filePath, <span class=\"keyword\">final</span> QiniuUploadUitlsListener listener)</span> </span>&#123;</div><div class=\"line\">\t\t<span class=\"keyword\">final</span> String fileUrlUUID = getFileUrlUUID();</div><div class=\"line\">\t\tString token = getToken();</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> (token == <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">\t\t\t<span class=\"keyword\">if</span> (listener != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">\t\t\t\tlistener.onError(-<span class=\"number\">1</span>, <span class=\"string\">\"token is null\"</span>);</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t\t\t<span class=\"keyword\">return</span>;</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t\tUploadManager uploadManager = <span class=\"keyword\">new</span> UploadManager();</div><div class=\"line\">\t\tuploadManager.put(filePath, fileUrlUUID, token, (key, info, response) -&gt; &#123;</div><div class=\"line\">\t\t\tSystem.out.println(<span class=\"string\">\"debug:info = \"</span> + info + <span class=\"string\">\",response = \"</span> + response);</div><div class=\"line\">\t\t\t<span class=\"keyword\">if</span> (info != <span class=\"keyword\">null</span> &amp;&amp; info.statusCode == <span class=\"number\">200</span>) &#123;<span class=\"comment\">// </span></div><div class=\"line\">\t\t\t\tString fileRealUrl = getRealUrl(fileUrlUUID);</div><div class=\"line\">\t\t\t\tSystem.out.println(<span class=\"string\">\"debug:fileRealUrl = \"</span> + fileRealUrl);</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (listener != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">\t\t\t\t\tlistener.onSucess(fileRealUrl);</div><div class=\"line\">\t\t\t\t&#125;</div><div class=\"line\">\t\t\t&#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (listener != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">\t\t\t\t\tlistener.onError(info.statusCode, info.error);</div><div class=\"line\">\t\t\t\t&#125;</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t\t&#125;, <span class=\"keyword\">new</span> UploadOptions(<span class=\"keyword\">null</span>, <span class=\"keyword\">null</span>, <span class=\"keyword\">false</span>, <span class=\"keyword\">new</span> UpProgressHandler() &#123;</div><div class=\"line\">\t\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">progress</span><span class=\"params\">(String key, <span class=\"keyword\">double</span> percent)</span> </span>&#123;</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (listener != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">\t\t\t\t\tlistener.onProgress((<span class=\"keyword\">int</span>) (percent * <span class=\"number\">100</span>));</div><div class=\"line\">\t\t\t\t&#125;</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t\t&#125;, <span class=\"keyword\">null</span>));</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\">/**</span></div><div class=\"line\">\t * </div><div class=\"line\">\t * &lt;p&gt;\t H60-L12__1464851303930__156750_1884&lt;/p&gt;</div><div class=\"line\">\t * <span class=\"doctag\">@return</span></div><div class=\"line\">\t */</div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> String <span class=\"title\">getFileUrlUUID</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">\t\tString filePath = android.os.Build.MODEL + <span class=\"string\">\"__\"</span> + System.currentTimeMillis() + <span class=\"string\">\"__\"</span> + (<span class=\"keyword\">new</span> Random().nextInt(<span class=\"number\">500000</span>))</div><div class=\"line\">\t\t\t\t+ <span class=\"string\">\"_\"</span> + (<span class=\"keyword\">new</span> Random().nextInt(<span class=\"number\">10000</span>));</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> filePath.replace(<span class=\"string\">\".\"</span>, <span class=\"string\">\"0\"</span>);</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> String <span class=\"title\">getRealUrl</span><span class=\"params\">(String fileUrlUUID)</span> </span>&#123;</div><div class=\"line\">\t\tString filePath = <span class=\"string\">\"http://\"</span> + QiNiuConfig.QINIU_BUCKNAME + <span class=\"string\">\".qiniudn.com/\"</span> + fileUrlUUID;</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> filePath;</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\">/**</span></div><div class=\"line\">\t * token </div><div class=\"line\">\t *</div><div class=\"line\">\t * <span class=\"doctag\">@return</span></div><div class=\"line\">\t */</div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> String <span class=\"title\">getToken</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">\t\tMac mac = <span class=\"keyword\">new</span> Mac(QiNiuConfig.QINIU_AK, QiNiuConfig.QINIU_SK);</div><div class=\"line\">\t\tPutPolicy putPolicy = <span class=\"keyword\">new</span> PutPolicy(QiNiuConfig.QINIU_BUCKNAME);</div><div class=\"line\">\t\tputPolicy.returnBody = <span class=\"string\">\"&#123;\\\"name\\\": $(fname),\\\"size\\\": \\\"$(fsize)\\\",\\\"w\\\": \\\"$(imageInfo.width)\\\",\\\"h\\\": \\\"$(imageInfo.height)\\\",\\\"key\\\":$(etag)&#125;\"</span>;</div><div class=\"line\">\t\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\t\tString uptoken = putPolicy.token(mac);</div><div class=\"line\">\t\t\tSystem.out.println(<span class=\"string\">\"debug:uptoken = \"</span> + uptoken);</div><div class=\"line\">\t\t\t<span class=\"keyword\">return</span> uptoken;</div><div class=\"line\">\t\t&#125; <span class=\"keyword\">catch</span> (AuthException e) &#123;</div><div class=\"line\">\t\t\te.printStackTrace();</div><div class=\"line\">\t\t&#125; <span class=\"keyword\">catch</span> (JSONException e) &#123;</div><div class=\"line\">\t\t\te.printStackTrace();</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\">/**</span></div><div class=\"line\">\t * hostfileurl</div><div class=\"line\">\t * <span class=\"doctag\">@param</span> domain host</div><div class=\"line\">\t * <span class=\"doctag\">@param</span> imgKey file key</div><div class=\"line\">\t * <span class=\"doctag\">@return</span> url</div><div class=\"line\">\t */</div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">downloadFile</span><span class=\"params\">(String domain,String imgKey)</span></span>&#123;</div><div class=\"line\">\t\t<span class=\"comment\">//</span></div><div class=\"line\">\t\t<span class=\"comment\">//</span></div><div class=\"line\"><span class=\"comment\">//\t\tString domain =\"http://example.xxx.clouddn.com/\";</span></div><div class=\"line\"><span class=\"comment\">//\t\tString path =\"H60-L12__1464917382714__36888_5255\";</span></div><div class=\"line\">\t\tStringBuilder sb =<span class=\"keyword\">new</span> StringBuilder();</div><div class=\"line\">\t\t<span class=\"comment\">//</span></div><div class=\"line\">\t\tString url = sb.append(domain).append(imgKey).append(<span class=\"string\">\"?e=1478365261\"</span>).toString();</div><div class=\"line\">\t\tLog.e(<span class=\"string\">\"encodedEntryURI\"</span>,url);</div><div class=\"line\"></div><div class=\"line\">\t\t<span class=\"keyword\">byte</span>[] sign =<span class=\"keyword\">null</span>;</div><div class=\"line\">\t\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\t\tsign = SHA.hMacSHA1Encrypt(url,QiNiuConfig.QINIU_SK);</div><div class=\"line\">\t\t&#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</div><div class=\"line\">\t\t\te.printStackTrace();</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t\tString encodedSign = UrlSafeBase64.encodeToString(sign);</div><div class=\"line\">\t\tsb.append(<span class=\"string\">\"&amp;token=\"</span>).append(QiNiuConfig.QINIU_AK).append(<span class=\"string\">\":\"</span>).append(encodedSign);</div><div class=\"line\">\t\tLog.e(<span class=\"string\">\"download token\"</span>,sb.toString());</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> sb.toString();</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\">/**</span></div><div class=\"line\">\t * </div><div class=\"line\">\t * <span class=\"doctag\">@param</span> bucket </div><div class=\"line\">\t * <span class=\"doctag\">@param</span> prefix </div><div class=\"line\">\t * <span class=\"doctag\">@param</span> listener</div><div class=\"line\">\t * <span class=\"doctag\">@return</span></div><div class=\"line\">\t */</div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">listFile</span><span class=\"params\">(String bucket, String prefix,<span class=\"keyword\">final</span> QiniuRequestListener listener)</span></span>&#123;</div><div class=\"line\"></div><div class=\"line\">\t\t<span class=\"keyword\">try</span>&#123;</div><div class=\"line\">\t\t\tStringBuilder sb = <span class=\"keyword\">new</span> StringBuilder();</div><div class=\"line\"></div><div class=\"line\">\t\t\tString entryUrl = sb.append(<span class=\"string\">\"bucket=\"</span>).append(bucket)</div><div class=\"line\">\t\t\t\t\t.append(<span class=\"string\">\"&amp;prefix=\"</span>).append(prefix).toString();</div><div class=\"line\">\t\t\tString host = <span class=\"string\">\"http://rsf.qbox.me\"</span>;</div><div class=\"line\">\t\t\tString path = <span class=\"string\">\"/list?\"</span> +entryUrl;</div><div class=\"line\">\t\t\tString url = host+path;</div><div class=\"line\">\t\t\tLog.e(<span class=\"string\">\"AAAAAAA\"</span>, url);</div><div class=\"line\">\t\t\t<span class=\"keyword\">byte</span>[] sign = SHA.hMacSHA1Encrypt(path+<span class=\"string\">\"\\n\"</span>, QiNiuConfig.QINIU_SK);</div><div class=\"line\">\t\t\tString encodedSign = UrlSafeBase64.encodeToString(sign);</div><div class=\"line\">\t\t\tString authorization = QiNiuConfig.QINIU_AK + <span class=\"string\">':'</span> + encodedSign;</div><div class=\"line\">\t\t\tAsyncHttpClient client = <span class=\"keyword\">new</span> AsyncHttpClient();</div><div class=\"line\">\t\t\tclient.addHeader(<span class=\"string\">\"Content-Type\"</span>,<span class=\"string\">\"application/x-www-form-urlencoded\"</span>);</div><div class=\"line\">\t\t\tclient.addHeader(<span class=\"string\">\"Authorization\"</span>, <span class=\"string\">\"QBox \"</span>+authorization);</div><div class=\"line\">\t\t\tRequestParams params = <span class=\"keyword\">new</span> RequestParams();</div><div class=\"line\">\t\t\tclient.post(url, params, <span class=\"keyword\">new</span> AsyncHttpResponseHandler() &#123;</div><div class=\"line\">\t\t\t\t<span class=\"meta\">@Override</span></div><div class=\"line\">\t\t\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onSuccess</span><span class=\"params\">(<span class=\"keyword\">int</span> i, Header[] headers, <span class=\"keyword\">byte</span>[] bytes)</span> </span>&#123;</div><div class=\"line\">\t\t\t\t\t<span class=\"keyword\">if</span> (<span class=\"keyword\">null</span>!=listener)</div><div class=\"line\">\t\t\t\t\t\tlistener.onSucceed(bytes);</div><div class=\"line\">\t\t\t\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t\t\t\t<span class=\"meta\">@Override</span></div><div class=\"line\">\t\t\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onFailure</span><span class=\"params\">(<span class=\"keyword\">int</span> i, Header[] headers, <span class=\"keyword\">byte</span>[] bytes, Throwable throwable)</span> </span>&#123;</div><div class=\"line\">\t\t\t\t\t<span class=\"keyword\">if</span> (<span class=\"keyword\">null</span>!=listener)</div><div class=\"line\">\t\t\t\t\t\tlistener.onFailed(bytes);</div><div class=\"line\">\t\t\t\t&#125;</div><div class=\"line\">\t\t\t&#125;);</div><div class=\"line\">\t\t&#125;<span class=\"keyword\">catch</span>(Exception e)&#123;</div><div class=\"line\">\t\t\te.printStackTrace();</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> ;</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\">/**</span></div><div class=\"line\">\t * </div><div class=\"line\">\t * <span class=\"doctag\">@param</span> bucket </div><div class=\"line\">\t * <span class=\"doctag\">@param</span> fileName </div><div class=\"line\">\t * */</div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">boolean</span> <span class=\"title\">deleteFile</span><span class=\"params\">(String bucket,String fileName,<span class=\"keyword\">final</span> QiniuRequestListener listener)</span></span>&#123;</div><div class=\"line\">\t\t<span class=\"keyword\">try</span>&#123;</div><div class=\"line\">\t\t\tString entryUrl = bucket+<span class=\"string\">\":\"</span>+fileName;</div><div class=\"line\">\t\t\tString encodedEntryURI = UrlSafeBase64.encodeToString(entryUrl.getBytes());</div><div class=\"line\">\t\t\tString host = <span class=\"string\">\"http://rs.qiniu.com\"</span>;</div><div class=\"line\">\t\t\tString path = <span class=\"string\">\"/delete/\"</span>+encodedEntryURI;</div><div class=\"line\">\t\t\tString url = host+path;</div><div class=\"line\">\t\t\tLog.e(<span class=\"string\">\"AAAAAAA\"</span>, url);</div><div class=\"line\">\t\t\t<span class=\"keyword\">byte</span>[] sign = hMacSHA1Encrypt(path+<span class=\"string\">\"\\n\"</span>, QiNiuConfig.QINIU_SK);</div><div class=\"line\">\t\t\tString encodedSign = UrlSafeBase64.encodeToString(sign);</div><div class=\"line\">\t\t\tString authorization = QiNiuConfig.QINIU_AK + <span class=\"string\">':'</span> + encodedSign;</div><div class=\"line\"></div><div class=\"line\">\t\t\tAsyncHttpClient client = <span class=\"keyword\">new</span> AsyncHttpClient();</div><div class=\"line\">\t\t\tclient.addHeader(<span class=\"string\">\"Content-Type\"</span>,<span class=\"string\">\"application/x-www-form-urlencoded\"</span>);</div><div class=\"line\">\t\t\tclient.addHeader(<span class=\"string\">\"Authorization\"</span>, <span class=\"string\">\"QBox \"</span>+authorization);</div><div class=\"line\">\t\t\tRequestParams params = <span class=\"keyword\">new</span> RequestParams();</div><div class=\"line\">\t\t\tclient.post(url, params, <span class=\"keyword\">new</span> AsyncHttpResponseHandler() &#123;</div><div class=\"line\">\t\t\t\t<span class=\"meta\">@Override</span></div><div class=\"line\">\t\t\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onSuccess</span><span class=\"params\">(<span class=\"keyword\">int</span> i, Header[] headers, <span class=\"keyword\">byte</span>[] bytes)</span> </span>&#123;</div><div class=\"line\">\t\t\t\t\t<span class=\"keyword\">if</span> (<span class=\"keyword\">null</span>!=listener)</div><div class=\"line\">\t\t\t\t\t\tlistener.onSucceed(bytes);</div><div class=\"line\">\t\t\t\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t\t\t\t<span class=\"meta\">@Override</span></div><div class=\"line\">\t\t\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onFailure</span><span class=\"params\">(<span class=\"keyword\">int</span> i, Header[] headers, <span class=\"keyword\">byte</span>[] bytes, Throwable throwable)</span> </span>&#123;</div><div class=\"line\">\t\t\t\t\t<span class=\"keyword\">if</span> (<span class=\"keyword\">null</span>!=listener)</div><div class=\"line\">\t\t\t\t\t\tlistener.onFailed(bytes);</div><div class=\"line\">\t\t\t\t\t<span class=\"keyword\">if</span> (<span class=\"keyword\">null</span>!=bytes) &#123;</div><div class=\"line\">\t\t\t\t\t\tString s = <span class=\"keyword\">new</span> String(bytes);</div><div class=\"line\">\t\t\t\t\t&#125;</div><div class=\"line\">\t\t\t\t&#125;</div><div class=\"line\">\t\t\t&#125;);</div><div class=\"line\"></div><div class=\"line\">\t\t&#125;<span class=\"keyword\">catch</span>(Exception e)&#123;</div><div class=\"line\">\t\t\te.printStackTrace();</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<ul>\n<li>HMAC-SHA1</li>\n</ul>\n<p><a href=\"http://developer.qiniu.com/article/developer/security/access-token.html\" target=\"_blank\" rel=\"external\"></a></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * HMAC-SHA1</div><div class=\"line\"> * <span class=\"doctag\">@author</span> agehua</div><div class=\"line\"> *</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SHA</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String MAC_NAME = <span class=\"string\">\"HmacSHA1\"</span>;</div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String ENCODING = <span class=\"string\">\"UTF-8\"</span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">/**</span></div><div class=\"line\">     *</div><div class=\"line\">     *  HMAC-SHA1 encryptText</div><div class=\"line\">     * <span class=\"doctag\">@param</span> encryptText </div><div class=\"line\">     * <span class=\"doctag\">@param</span> encryptKey </div><div class=\"line\">     * <span class=\"doctag\">@return</span></div><div class=\"line\">     * <span class=\"doctag\">@throws</span> Exception</div><div class=\"line\">     */</div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">byte</span>[] hMacSHA1Encrypt(String encryptText, String encryptKey)</div><div class=\"line\">            <span class=\"keyword\">throws</span> Exception &#123;</div><div class=\"line\">        <span class=\"keyword\">byte</span>[] data = encryptKey.getBytes(ENCODING);</div><div class=\"line\">        <span class=\"comment\">// ,</span></div><div class=\"line\">        SecretKey secretKey = <span class=\"keyword\">new</span> SecretKeySpec(data, MAC_NAME);</div><div class=\"line\">        <span class=\"comment\">//  Mac   Mac </span></div><div class=\"line\">        Mac mac = Mac.getInstance(MAC_NAME);</div><div class=\"line\">        <span class=\"comment\">//  Mac </span></div><div class=\"line\">        mac.init(secretKey);</div><div class=\"line\">        <span class=\"keyword\">byte</span>[] text = encryptText.getBytes(ENCODING);</div><div class=\"line\">        <span class=\"comment\">//  Mac </span></div><div class=\"line\">        <span class=\"keyword\">return</span> mac.doFinal(text);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;  </div><div class=\"line\">~~~  </div><div class=\"line\"></div><div class=\"line\">- Config</div><div class=\"line\"></div><div class=\"line\">~~~ Java</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">QiNiuConfig</span> </span>&#123;</div><div class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String token = getToken();</div><div class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String QINIU_AK = <span class=\"string\">\"Your_AccessKey\"</span>;</div><div class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String QINIU_SK = <span class=\"string\">\"Your_SecretKey\"</span>;</div><div class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String QINIU_BUCKNAME = <span class=\"string\">\"\"</span>;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">getToken</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">\t\tMac mac = <span class=\"keyword\">new</span> Mac(QiNiuConfig.QINIU_AK, QiNiuConfig.QINIU_SK);</div><div class=\"line\">\t\tPutPolicy putPolicy = <span class=\"keyword\">new</span> PutPolicy(QiNiuConfig.QINIU_BUCKNAME);</div><div class=\"line\">\t\tputPolicy.returnBody = <span class=\"string\">\"&#123;\\\"name\\\": $(fname),\\\"size\\\": \\\"$(fsize)\\\",\\\"w\\\": \\\"$(imageInfo.width)\\\",\\\"h\\\": \\\"$(imageInfo.height)\\\",\\\"key\\\":$(etag)&#125;\"</span>;</div><div class=\"line\">\t\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\t\tString uptoken = putPolicy.token(mac);</div><div class=\"line\">\t\t\tSystem.out.println(<span class=\"string\">\"debug:uptoken = \"</span> + uptoken);</div><div class=\"line\">\t\t\t<span class=\"keyword\">return</span> uptoken;</div><div class=\"line\">\t\t&#125; <span class=\"keyword\">catch</span> (AuthException e) &#123;</div><div class=\"line\">\t\t\te.printStackTrace();</div><div class=\"line\">\t\t&#125; <span class=\"keyword\">catch</span> (JSONException e) &#123;</div><div class=\"line\">\t\t\te.printStackTrace();</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p> <a href=\"https://gist.github.com/agehua/f73bcb98af2c0c44a4c49c7c7b7e6bda\" target=\"_blank\" rel=\"external\">Gist</a></p>\n<p> :)  </p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/05/28/qiniu-android-summary/\">http://agehua.github.io/2016/05/28/qiniu-android-summary/</a></p>\n","readingTime":{"text":"10 min read","minutes":9.11,"time":546599.9999999999,"words":1822},"excerpt":"<h3 id=\"1-android\"><a href=\"#1-android\" class=\"headerlink\" title=\"1.android\"></a>1.android</h3><p>  androidlistdeleteuploaddownload</p>\n<p>  <strong>AccessKeySecretKeyjava</strong></p>\n<p>  :)  </p>","more":"<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h3><p></p>\n<ul>\n<li></li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">package</span> com.qiniu.ui.utils;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">import</span> android.graphics.Bitmap;</div><div class=\"line\"><span class=\"keyword\">import</span> android.graphics.Bitmap.CompressFormat;</div><div class=\"line\"><span class=\"keyword\">import</span> android.os.Environment;</div><div class=\"line\"><span class=\"keyword\">import</span> android.util.Log;</div><div class=\"line\"><span class=\"keyword\">import</span> com.loopj.android.http.AsyncHttpClient;</div><div class=\"line\"><span class=\"keyword\">import</span> com.loopj.android.http.AsyncHttpResponseHandler;</div><div class=\"line\"><span class=\"keyword\">import</span> com.loopj.android.http.RequestParams;</div><div class=\"line\"><span class=\"keyword\">import</span> com.qiniu.android.storage.UpProgressHandler;</div><div class=\"line\"><span class=\"keyword\">import</span> com.qiniu.android.storage.UploadManager;</div><div class=\"line\"><span class=\"keyword\">import</span> com.qiniu.android.storage.UploadOptions;</div><div class=\"line\"><span class=\"keyword\">import</span> com.qiniu.android.utils.UrlSafeBase64;</div><div class=\"line\"><span class=\"keyword\">import</span> com.qiniu.api.auth.AuthException;</div><div class=\"line\"><span class=\"keyword\">import</span> com.qiniu.api.auth.digest.Mac;</div><div class=\"line\"><span class=\"keyword\">import</span> com.qiniu.api.rs.PutPolicy;</div><div class=\"line\"><span class=\"keyword\">import</span> com.qiniu.ui.SHA;</div><div class=\"line\"><span class=\"keyword\">import</span> com.qiniu.ui.contains.QiNiuConfig;</div><div class=\"line\"><span class=\"keyword\">import</span> org.apache.http.Header;</div><div class=\"line\"><span class=\"keyword\">import</span> org.json.JSONException;</div><div class=\"line\"><span class=\"keyword\">import</span> java.io.BufferedOutputStream;</div><div class=\"line\"><span class=\"keyword\">import</span> java.io.FileOutputStream;</div><div class=\"line\"><span class=\"keyword\">import</span> java.util.Random;</div><div class=\"line\"><span class=\"keyword\">import</span> <span class=\"keyword\">static</span> com.qiniu.ui.SHA.hMacSHA1Encrypt;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">/**</div><div class=\"line\"> * <span class=\"doctag\">@date</span> 2016526 11:00:43</div><div class=\"line\"> * <span class=\"doctag\">@author</span> lijixin</div><div class=\"line\"> * <span class=\"doctag\">@web</span> https://agehua.github.io</div><div class=\"line\"> * <span class=\"doctag\">@Description</span>: </div><div class=\"line\"> */</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">QiniuUitls</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String fileName = <span class=\"string\">\"temp.jpg\"</span>;</div><div class=\"line\">\t<span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String tempJpeg = Environment.getExternalStorageDirectory().getPath() + <span class=\"string\">\"/\"</span> + fileName;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> maxWidth = <span class=\"number\">720</span>;</div><div class=\"line\">\t<span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> maxHeight = <span class=\"number\">1080</span>;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">QiniuUploadUitlsListener</span> </span>&#123;</div><div class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">onSucess</span><span class=\"params\">(String fileUrl)</span></span>;</div><div class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">onError</span><span class=\"params\">(<span class=\"keyword\">int</span> errorCode, String msg)</span></span>;</div><div class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">onProgress</span><span class=\"params\">(<span class=\"keyword\">int</span> progress)</span></span>;</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">QiniuRequestListener</span> </span>&#123;</div><div class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">onSucceed</span><span class=\"params\">(<span class=\"keyword\">byte</span>[] bytes)</span></span>;</div><div class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">onFailed</span><span class=\"params\">(<span class=\"keyword\">byte</span>[] bytes)</span></span>;</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\">/**</div><div class=\"line\">\t * bitmapjpeg720*1080</div><div class=\"line\">\t * <span class=\"doctag\">@param</span> bitmap</div><div class=\"line\">\t * <span class=\"doctag\">@param</span> filePath</div><div class=\"line\">\t * <span class=\"doctag\">@param</span> quality</div><div class=\"line\">\t * <span class=\"doctag\">@return</span></div><div class=\"line\">\t */</span></div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">boolean</span> <span class=\"title\">saveBitmapToJpegFile</span><span class=\"params\">(Bitmap bitmap, String filePath, <span class=\"keyword\">int</span> quality)</span> </span>&#123;</div><div class=\"line\">\t\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\t\tFileOutputStream fileOutStr = <span class=\"keyword\">new</span> FileOutputStream(filePath);</div><div class=\"line\">\t\t\tBufferedOutputStream bufOutStr = <span class=\"keyword\">new</span> BufferedOutputStream(fileOutStr);</div><div class=\"line\">\t\t\tresizeBitmap(bitmap).compress(CompressFormat.JPEG, quality, bufOutStr);</div><div class=\"line\">\t\t\tbufOutStr.flush();</div><div class=\"line\">\t\t\tbufOutStr.close();</div><div class=\"line\">\t\t&#125; <span class=\"keyword\">catch</span> (Exception exception) &#123;</div><div class=\"line\">\t\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\">/**</div><div class=\"line\">\t * </div><div class=\"line\">\t *</div><div class=\"line\">\t * <span class=\"doctag\">@param</span> bitmap</div><div class=\"line\">\t * <span class=\"doctag\">@return</span></div><div class=\"line\">\t */</span></div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Bitmap <span class=\"title\">resizeBitmap</span><span class=\"params\">(Bitmap bitmap)</span> </span>&#123;</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> (bitmap != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">\t\t\t<span class=\"keyword\">int</span> width = bitmap.getWidth();</div><div class=\"line\">\t\t\t<span class=\"keyword\">int</span> height = bitmap.getHeight();</div><div class=\"line\">\t\t\t<span class=\"comment\">//720</span></div><div class=\"line\">\t\t\t<span class=\"keyword\">if</span> (width &gt; maxWidth) &#123;</div><div class=\"line\">\t\t\t\t<span class=\"comment\">//</span></div><div class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> pWidth = maxWidth;</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> pHeight = maxWidth * height / width;</div><div class=\"line\">\t\t\t\tBitmap result = Bitmap.createScaledBitmap(bitmap, pWidth, pHeight, <span class=\"keyword\">false</span>);</div><div class=\"line\">\t\t\t\tbitmap.recycle();</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> result;</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t\t\t<span class=\"keyword\">if</span> (height &gt; maxHeight) &#123;</div><div class=\"line\">\t\t\t\t<span class=\"comment\">//</span></div><div class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> pHeight = maxHeight;</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> pWidth = maxHeight * width / height;</div><div class=\"line\">\t\t\t\tBitmap result = Bitmap.createScaledBitmap(bitmap, pWidth, pHeight, <span class=\"keyword\">false</span>);</div><div class=\"line\">\t\t\t\tbitmap.recycle();</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> result;</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> bitmap;</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">uploadImage</span><span class=\"params\">(Bitmap bitmap, QiniuUploadUitlsListener listener)</span> </span>&#123;</div><div class=\"line\">\t\tsaveBitmapToJpegFile(bitmap, tempJpeg,<span class=\"number\">100</span>);</div><div class=\"line\">\t\tuploadImage(tempJpeg, listener);</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\">/**</div><div class=\"line\">\t * jpgapijpg</div><div class=\"line\">\t * <span class=\"doctag\">@param</span> filePath</div><div class=\"line\">\t * <span class=\"doctag\">@param</span> listener</div><div class=\"line\">\t */</span></div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">uploadImage</span><span class=\"params\">(String filePath, <span class=\"keyword\">final</span> QiniuUploadUitlsListener listener)</span> </span>&#123;</div><div class=\"line\">\t\t<span class=\"keyword\">final</span> String fileUrlUUID = getFileUrlUUID();</div><div class=\"line\">\t\tString token = getToken();</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> (token == <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">\t\t\t<span class=\"keyword\">if</span> (listener != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">\t\t\t\tlistener.onError(-<span class=\"number\">1</span>, <span class=\"string\">\"token is null\"</span>);</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t\t\t<span class=\"keyword\">return</span>;</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t\tUploadManager uploadManager = <span class=\"keyword\">new</span> UploadManager();</div><div class=\"line\">\t\tuploadManager.put(filePath, fileUrlUUID, token, (key, info, response) -&gt; &#123;</div><div class=\"line\">\t\t\tSystem.out.println(<span class=\"string\">\"debug:info = \"</span> + info + <span class=\"string\">\",response = \"</span> + response);</div><div class=\"line\">\t\t\t<span class=\"keyword\">if</span> (info != <span class=\"keyword\">null</span> &amp;&amp; info.statusCode == <span class=\"number\">200</span>) &#123;<span class=\"comment\">// </span></div><div class=\"line\">\t\t\t\tString fileRealUrl = getRealUrl(fileUrlUUID);</div><div class=\"line\">\t\t\t\tSystem.out.println(<span class=\"string\">\"debug:fileRealUrl = \"</span> + fileRealUrl);</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (listener != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">\t\t\t\t\tlistener.onSucess(fileRealUrl);</div><div class=\"line\">\t\t\t\t&#125;</div><div class=\"line\">\t\t\t&#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (listener != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">\t\t\t\t\tlistener.onError(info.statusCode, info.error);</div><div class=\"line\">\t\t\t\t&#125;</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t\t&#125;, <span class=\"keyword\">new</span> UploadOptions(<span class=\"keyword\">null</span>, <span class=\"keyword\">null</span>, <span class=\"keyword\">false</span>, <span class=\"keyword\">new</span> UpProgressHandler() &#123;</div><div class=\"line\">\t\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">progress</span><span class=\"params\">(String key, <span class=\"keyword\">double</span> percent)</span> </span>&#123;</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (listener != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">\t\t\t\t\tlistener.onProgress((<span class=\"keyword\">int</span>) (percent * <span class=\"number\">100</span>));</div><div class=\"line\">\t\t\t\t&#125;</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t\t&#125;, <span class=\"keyword\">null</span>));</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\">/**</div><div class=\"line\">\t * </div><div class=\"line\">\t * &lt;p&gt;\t H60-L12__1464851303930__156750_1884&lt;/p&gt;</div><div class=\"line\">\t * <span class=\"doctag\">@return</span></div><div class=\"line\">\t */</span></div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> String <span class=\"title\">getFileUrlUUID</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">\t\tString filePath = android.os.Build.MODEL + <span class=\"string\">\"__\"</span> + System.currentTimeMillis() + <span class=\"string\">\"__\"</span> + (<span class=\"keyword\">new</span> Random().nextInt(<span class=\"number\">500000</span>))</div><div class=\"line\">\t\t\t\t+ <span class=\"string\">\"_\"</span> + (<span class=\"keyword\">new</span> Random().nextInt(<span class=\"number\">10000</span>));</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> filePath.replace(<span class=\"string\">\".\"</span>, <span class=\"string\">\"0\"</span>);</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> String <span class=\"title\">getRealUrl</span><span class=\"params\">(String fileUrlUUID)</span> </span>&#123;</div><div class=\"line\">\t\tString filePath = <span class=\"string\">\"http://\"</span> + QiNiuConfig.QINIU_BUCKNAME + <span class=\"string\">\".qiniudn.com/\"</span> + fileUrlUUID;</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> filePath;</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\">/**</div><div class=\"line\">\t * token </div><div class=\"line\">\t *</div><div class=\"line\">\t * <span class=\"doctag\">@return</span></div><div class=\"line\">\t */</span></div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> String <span class=\"title\">getToken</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">\t\tMac mac = <span class=\"keyword\">new</span> Mac(QiNiuConfig.QINIU_AK, QiNiuConfig.QINIU_SK);</div><div class=\"line\">\t\tPutPolicy putPolicy = <span class=\"keyword\">new</span> PutPolicy(QiNiuConfig.QINIU_BUCKNAME);</div><div class=\"line\">\t\tputPolicy.returnBody = <span class=\"string\">\"&#123;\\\"name\\\": $(fname),\\\"size\\\": \\\"$(fsize)\\\",\\\"w\\\": \\\"$(imageInfo.width)\\\",\\\"h\\\": \\\"$(imageInfo.height)\\\",\\\"key\\\":$(etag)&#125;\"</span>;</div><div class=\"line\">\t\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\t\tString uptoken = putPolicy.token(mac);</div><div class=\"line\">\t\t\tSystem.out.println(<span class=\"string\">\"debug:uptoken = \"</span> + uptoken);</div><div class=\"line\">\t\t\t<span class=\"keyword\">return</span> uptoken;</div><div class=\"line\">\t\t&#125; <span class=\"keyword\">catch</span> (AuthException e) &#123;</div><div class=\"line\">\t\t\te.printStackTrace();</div><div class=\"line\">\t\t&#125; <span class=\"keyword\">catch</span> (JSONException e) &#123;</div><div class=\"line\">\t\t\te.printStackTrace();</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\">/**</div><div class=\"line\">\t * hostfileurl</div><div class=\"line\">\t * <span class=\"doctag\">@param</span> domain host</div><div class=\"line\">\t * <span class=\"doctag\">@param</span> imgKey file key</div><div class=\"line\">\t * <span class=\"doctag\">@return</span> url</div><div class=\"line\">\t */</span></div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">downloadFile</span><span class=\"params\">(String domain,String imgKey)</span></span>&#123;</div><div class=\"line\">\t\t<span class=\"comment\">//</span></div><div class=\"line\">\t\t<span class=\"comment\">//</span></div><div class=\"line\"><span class=\"comment\">//\t\tString domain =\"http://example.xxx.clouddn.com/\";</span></div><div class=\"line\"><span class=\"comment\">//\t\tString path =\"H60-L12__1464917382714__36888_5255\";</span></div><div class=\"line\">\t\tStringBuilder sb =<span class=\"keyword\">new</span> StringBuilder();</div><div class=\"line\">\t\t<span class=\"comment\">//</span></div><div class=\"line\">\t\tString url = sb.append(domain).append(imgKey).append(<span class=\"string\">\"?e=1478365261\"</span>).toString();</div><div class=\"line\">\t\tLog.e(<span class=\"string\">\"encodedEntryURI\"</span>,url);</div><div class=\"line\"></div><div class=\"line\">\t\t<span class=\"keyword\">byte</span>[] sign =<span class=\"keyword\">null</span>;</div><div class=\"line\">\t\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\t\tsign = SHA.hMacSHA1Encrypt(url,QiNiuConfig.QINIU_SK);</div><div class=\"line\">\t\t&#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</div><div class=\"line\">\t\t\te.printStackTrace();</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t\tString encodedSign = UrlSafeBase64.encodeToString(sign);</div><div class=\"line\">\t\tsb.append(<span class=\"string\">\"&amp;token=\"</span>).append(QiNiuConfig.QINIU_AK).append(<span class=\"string\">\":\"</span>).append(encodedSign);</div><div class=\"line\">\t\tLog.e(<span class=\"string\">\"download token\"</span>,sb.toString());</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> sb.toString();</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\">/**</div><div class=\"line\">\t * </div><div class=\"line\">\t * <span class=\"doctag\">@param</span> bucket </div><div class=\"line\">\t * <span class=\"doctag\">@param</span> prefix </div><div class=\"line\">\t * <span class=\"doctag\">@param</span> listener</div><div class=\"line\">\t * <span class=\"doctag\">@return</span></div><div class=\"line\">\t */</span></div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">listFile</span><span class=\"params\">(String bucket, String prefix,<span class=\"keyword\">final</span> QiniuRequestListener listener)</span></span>&#123;</div><div class=\"line\"></div><div class=\"line\">\t\t<span class=\"keyword\">try</span>&#123;</div><div class=\"line\">\t\t\tStringBuilder sb = <span class=\"keyword\">new</span> StringBuilder();</div><div class=\"line\"></div><div class=\"line\">\t\t\tString entryUrl = sb.append(<span class=\"string\">\"bucket=\"</span>).append(bucket)</div><div class=\"line\">\t\t\t\t\t.append(<span class=\"string\">\"&amp;prefix=\"</span>).append(prefix).toString();</div><div class=\"line\">\t\t\tString host = <span class=\"string\">\"http://rsf.qbox.me\"</span>;</div><div class=\"line\">\t\t\tString path = <span class=\"string\">\"/list?\"</span> +entryUrl;</div><div class=\"line\">\t\t\tString url = host+path;</div><div class=\"line\">\t\t\tLog.e(<span class=\"string\">\"AAAAAAA\"</span>, url);</div><div class=\"line\">\t\t\t<span class=\"keyword\">byte</span>[] sign = SHA.hMacSHA1Encrypt(path+<span class=\"string\">\"\\n\"</span>, QiNiuConfig.QINIU_SK);</div><div class=\"line\">\t\t\tString encodedSign = UrlSafeBase64.encodeToString(sign);</div><div class=\"line\">\t\t\tString authorization = QiNiuConfig.QINIU_AK + <span class=\"string\">':'</span> + encodedSign;</div><div class=\"line\">\t\t\tAsyncHttpClient client = <span class=\"keyword\">new</span> AsyncHttpClient();</div><div class=\"line\">\t\t\tclient.addHeader(<span class=\"string\">\"Content-Type\"</span>,<span class=\"string\">\"application/x-www-form-urlencoded\"</span>);</div><div class=\"line\">\t\t\tclient.addHeader(<span class=\"string\">\"Authorization\"</span>, <span class=\"string\">\"QBox \"</span>+authorization);</div><div class=\"line\">\t\t\tRequestParams params = <span class=\"keyword\">new</span> RequestParams();</div><div class=\"line\">\t\t\tclient.post(url, params, <span class=\"keyword\">new</span> AsyncHttpResponseHandler() &#123;</div><div class=\"line\">\t\t\t\t<span class=\"meta\">@Override</span></div><div class=\"line\">\t\t\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onSuccess</span><span class=\"params\">(<span class=\"keyword\">int</span> i, Header[] headers, <span class=\"keyword\">byte</span>[] bytes)</span> </span>&#123;</div><div class=\"line\">\t\t\t\t\t<span class=\"keyword\">if</span> (<span class=\"keyword\">null</span>!=listener)</div><div class=\"line\">\t\t\t\t\t\tlistener.onSucceed(bytes);</div><div class=\"line\">\t\t\t\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t\t\t\t<span class=\"meta\">@Override</span></div><div class=\"line\">\t\t\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onFailure</span><span class=\"params\">(<span class=\"keyword\">int</span> i, Header[] headers, <span class=\"keyword\">byte</span>[] bytes, Throwable throwable)</span> </span>&#123;</div><div class=\"line\">\t\t\t\t\t<span class=\"keyword\">if</span> (<span class=\"keyword\">null</span>!=listener)</div><div class=\"line\">\t\t\t\t\t\tlistener.onFailed(bytes);</div><div class=\"line\">\t\t\t\t&#125;</div><div class=\"line\">\t\t\t&#125;);</div><div class=\"line\">\t\t&#125;<span class=\"keyword\">catch</span>(Exception e)&#123;</div><div class=\"line\">\t\t\te.printStackTrace();</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> ;</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\">/**</div><div class=\"line\">\t * </div><div class=\"line\">\t * <span class=\"doctag\">@param</span> bucket </div><div class=\"line\">\t * <span class=\"doctag\">@param</span> fileName </div><div class=\"line\">\t * */</span></div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">boolean</span> <span class=\"title\">deleteFile</span><span class=\"params\">(String bucket,String fileName,<span class=\"keyword\">final</span> QiniuRequestListener listener)</span></span>&#123;</div><div class=\"line\">\t\t<span class=\"keyword\">try</span>&#123;</div><div class=\"line\">\t\t\tString entryUrl = bucket+<span class=\"string\">\":\"</span>+fileName;</div><div class=\"line\">\t\t\tString encodedEntryURI = UrlSafeBase64.encodeToString(entryUrl.getBytes());</div><div class=\"line\">\t\t\tString host = <span class=\"string\">\"http://rs.qiniu.com\"</span>;</div><div class=\"line\">\t\t\tString path = <span class=\"string\">\"/delete/\"</span>+encodedEntryURI;</div><div class=\"line\">\t\t\tString url = host+path;</div><div class=\"line\">\t\t\tLog.e(<span class=\"string\">\"AAAAAAA\"</span>, url);</div><div class=\"line\">\t\t\t<span class=\"keyword\">byte</span>[] sign = hMacSHA1Encrypt(path+<span class=\"string\">\"\\n\"</span>, QiNiuConfig.QINIU_SK);</div><div class=\"line\">\t\t\tString encodedSign = UrlSafeBase64.encodeToString(sign);</div><div class=\"line\">\t\t\tString authorization = QiNiuConfig.QINIU_AK + <span class=\"string\">':'</span> + encodedSign;</div><div class=\"line\"></div><div class=\"line\">\t\t\tAsyncHttpClient client = <span class=\"keyword\">new</span> AsyncHttpClient();</div><div class=\"line\">\t\t\tclient.addHeader(<span class=\"string\">\"Content-Type\"</span>,<span class=\"string\">\"application/x-www-form-urlencoded\"</span>);</div><div class=\"line\">\t\t\tclient.addHeader(<span class=\"string\">\"Authorization\"</span>, <span class=\"string\">\"QBox \"</span>+authorization);</div><div class=\"line\">\t\t\tRequestParams params = <span class=\"keyword\">new</span> RequestParams();</div><div class=\"line\">\t\t\tclient.post(url, params, <span class=\"keyword\">new</span> AsyncHttpResponseHandler() &#123;</div><div class=\"line\">\t\t\t\t<span class=\"meta\">@Override</span></div><div class=\"line\">\t\t\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onSuccess</span><span class=\"params\">(<span class=\"keyword\">int</span> i, Header[] headers, <span class=\"keyword\">byte</span>[] bytes)</span> </span>&#123;</div><div class=\"line\">\t\t\t\t\t<span class=\"keyword\">if</span> (<span class=\"keyword\">null</span>!=listener)</div><div class=\"line\">\t\t\t\t\t\tlistener.onSucceed(bytes);</div><div class=\"line\">\t\t\t\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t\t\t\t<span class=\"meta\">@Override</span></div><div class=\"line\">\t\t\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onFailure</span><span class=\"params\">(<span class=\"keyword\">int</span> i, Header[] headers, <span class=\"keyword\">byte</span>[] bytes, Throwable throwable)</span> </span>&#123;</div><div class=\"line\">\t\t\t\t\t<span class=\"keyword\">if</span> (<span class=\"keyword\">null</span>!=listener)</div><div class=\"line\">\t\t\t\t\t\tlistener.onFailed(bytes);</div><div class=\"line\">\t\t\t\t\t<span class=\"keyword\">if</span> (<span class=\"keyword\">null</span>!=bytes) &#123;</div><div class=\"line\">\t\t\t\t\t\tString s = <span class=\"keyword\">new</span> String(bytes);</div><div class=\"line\">\t\t\t\t\t&#125;</div><div class=\"line\">\t\t\t\t&#125;</div><div class=\"line\">\t\t\t&#125;);</div><div class=\"line\"></div><div class=\"line\">\t\t&#125;<span class=\"keyword\">catch</span>(Exception e)&#123;</div><div class=\"line\">\t\t\te.printStackTrace();</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<ul>\n<li>HMAC-SHA1</li>\n</ul>\n<p><a href=\"http://developer.qiniu.com/article/developer/security/access-token.html\"></a></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</div><div class=\"line\"> * HMAC-SHA1</div><div class=\"line\"> * <span class=\"doctag\">@author</span> agehua</div><div class=\"line\"> *</div><div class=\"line\"> */</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SHA</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String MAC_NAME = <span class=\"string\">\"HmacSHA1\"</span>;</div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String ENCODING = <span class=\"string\">\"UTF-8\"</span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">/**</div><div class=\"line\">     *</div><div class=\"line\">     *  HMAC-SHA1 encryptText</div><div class=\"line\">     * <span class=\"doctag\">@param</span> encryptText </div><div class=\"line\">     * <span class=\"doctag\">@param</span> encryptKey </div><div class=\"line\">     * <span class=\"doctag\">@return</span></div><div class=\"line\">     * <span class=\"doctag\">@throws</span> Exception</div><div class=\"line\">     */</span></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">byte</span>[] hMacSHA1Encrypt(String encryptText, String encryptKey)</div><div class=\"line\">            <span class=\"keyword\">throws</span> Exception &#123;</div><div class=\"line\">        <span class=\"keyword\">byte</span>[] data = encryptKey.getBytes(ENCODING);</div><div class=\"line\">        <span class=\"comment\">// ,</span></div><div class=\"line\">        SecretKey secretKey = <span class=\"keyword\">new</span> SecretKeySpec(data, MAC_NAME);</div><div class=\"line\">        <span class=\"comment\">//  Mac   Mac </span></div><div class=\"line\">        Mac mac = Mac.getInstance(MAC_NAME);</div><div class=\"line\">        <span class=\"comment\">//  Mac </span></div><div class=\"line\">        mac.init(secretKey);</div><div class=\"line\">        <span class=\"keyword\">byte</span>[] text = encryptText.getBytes(ENCODING);</div><div class=\"line\">        <span class=\"comment\">//  Mac </span></div><div class=\"line\">        <span class=\"keyword\">return</span> mac.doFinal(text);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;  </div><div class=\"line\">~~~  </div><div class=\"line\"></div><div class=\"line\">- Config</div><div class=\"line\"></div><div class=\"line\">~~~ Java</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">QiNiuConfig</span> </span>&#123;</div><div class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String token = getToken();</div><div class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String QINIU_AK = <span class=\"string\">\"Your_AccessKey\"</span>;</div><div class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String QINIU_SK = <span class=\"string\">\"Your_SecretKey\"</span>;</div><div class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String QINIU_BUCKNAME = <span class=\"string\">\"\"</span>;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">getToken</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">\t\tMac mac = <span class=\"keyword\">new</span> Mac(QiNiuConfig.QINIU_AK, QiNiuConfig.QINIU_SK);</div><div class=\"line\">\t\tPutPolicy putPolicy = <span class=\"keyword\">new</span> PutPolicy(QiNiuConfig.QINIU_BUCKNAME);</div><div class=\"line\">\t\tputPolicy.returnBody = <span class=\"string\">\"&#123;\\\"name\\\": $(fname),\\\"size\\\": \\\"$(fsize)\\\",\\\"w\\\": \\\"$(imageInfo.width)\\\",\\\"h\\\": \\\"$(imageInfo.height)\\\",\\\"key\\\":$(etag)&#125;\"</span>;</div><div class=\"line\">\t\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\t\tString uptoken = putPolicy.token(mac);</div><div class=\"line\">\t\t\tSystem.out.println(<span class=\"string\">\"debug:uptoken = \"</span> + uptoken);</div><div class=\"line\">\t\t\t<span class=\"keyword\">return</span> uptoken;</div><div class=\"line\">\t\t&#125; <span class=\"keyword\">catch</span> (AuthException e) &#123;</div><div class=\"line\">\t\t\te.printStackTrace();</div><div class=\"line\">\t\t&#125; <span class=\"keyword\">catch</span> (JSONException e) &#123;</div><div class=\"line\">\t\t\te.printStackTrace();</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p> <a href=\"https://gist.github.com/agehua/f73bcb98af2c0c44a4c49c7c7b7e6bda\">Gist</a></p>\n<p> :)  </p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/05/28/qiniu-android-summary/\">http://agehua.github.io/2016/05/28/qiniu-android-summary/</a></p>"},{"layout":"post","title":"Android Webview :(","keywords":"Android Webview, js","description":"Android Webview :(","banner":"http://obxk8w81b.bkt.clouddn.com/Cottages%20Reminiscence%20of%20the%20North.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Cottages%20Reminiscence%20of%20the%20North.jpg","_content":"\n\n### 1.Android Webview\n\n- 1.webview\n\n  - 1.\n\n  - 2.Acivity\n\n  <!--more-->\n\n  ~~~ Java\n   public void goFinish(){\n        isLoadWithError =false;\n        if (null!=jsCallBack)\n            mWebView.removeJavascriptInterface(\"XXX\");\n        mWebView.setFocusable(true);\n        mWebView.removeAllViews();\n        try {\n        \tmWebView.clearHistory(); //webview\n        }catch(Exception e){\n            e.printStackTrace();\n        }\n        mWebView.destroy();\n\n        try {\n        \t//mWebViewWebView\n            Field fieldWebView = this.getClass().getDeclaredField(\"mWebView\");\n            fieldWebView.setAccessible(true);\n            WebView webView = (WebView) fieldWebView.get(this);\n            webView.removeAllViews();\n            webView.destroy();\n\n        }catch (NoSuchFieldException e) {\n            e.printStackTrace();\n\n        }catch (IllegalArgumentException e) {\n            e.printStackTrace();\n\n        }catch (IllegalAccessException e) {\n            e.printStackTrace();\n\n        }catch(Exception e){\n            e.printStackTrace();\n        }\n        this.finish();\n    }\n   ~~~\n\n> webview****\n\n\n- 2.h5 game\n\n\t :)\n\n- 3.android WebviewCrosswalk\n\n\tCrosswalk4,2html5\n\n\t[Crosswalk](https://crosswalk-project.org/)\n\n\tCrosswalkCrosswalkAppAPK20M[](https://www.zhihu.com/question/26484511)\n\n- 4.\n\n\t[](http://x5.tencent.com/index)\n\n### 2.WebView\n\n- 1.Android4.2Java@JavascriptInterface  \n\n- 2.Android4.2searchBoxJavaBridge_Js\n\n  [Android WebViewJs](http://blog.csdn.net/leehong2005/article/details/11808557/)\n\n  webview[BaseWebView](https://gist.github.com/agehua/99233b40e05db29ee0ed4f50fb2c7530)\n\n### 3.AndroidWebViewJavaScript\n:[AndroidWebViewJavaScript](http://blog.csdn.net/jiangwei0910410003/article/details/52687530)\n","source":"_posts/2016-07-25-android-webview-summary.md","raw":"---\nlayout: post\ntitle: Android Webview :(\ncategory: accumulation\ntags:\n  - ANDROID\n  - webview\nkeywords: Android Webview, js\ndescription: Android Webview :(\nbanner: http://obxk8w81b.bkt.clouddn.com/Cottages%20Reminiscence%20of%20the%20North.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Cottages%20Reminiscence%20of%20the%20North.jpg\n---\n\n\n### 1.Android Webview\n\n- 1.webview\n\n  - 1.\n\n  - 2.Acivity\n\n  <!--more-->\n\n  ~~~ Java\n   public void goFinish(){\n        isLoadWithError =false;\n        if (null!=jsCallBack)\n            mWebView.removeJavascriptInterface(\"XXX\");\n        mWebView.setFocusable(true);\n        mWebView.removeAllViews();\n        try {\n        \tmWebView.clearHistory(); //webview\n        }catch(Exception e){\n            e.printStackTrace();\n        }\n        mWebView.destroy();\n\n        try {\n        \t//mWebViewWebView\n            Field fieldWebView = this.getClass().getDeclaredField(\"mWebView\");\n            fieldWebView.setAccessible(true);\n            WebView webView = (WebView) fieldWebView.get(this);\n            webView.removeAllViews();\n            webView.destroy();\n\n        }catch (NoSuchFieldException e) {\n            e.printStackTrace();\n\n        }catch (IllegalArgumentException e) {\n            e.printStackTrace();\n\n        }catch (IllegalAccessException e) {\n            e.printStackTrace();\n\n        }catch(Exception e){\n            e.printStackTrace();\n        }\n        this.finish();\n    }\n   ~~~\n\n> webview****\n\n\n- 2.h5 game\n\n\t :)\n\n- 3.android WebviewCrosswalk\n\n\tCrosswalk4,2html5\n\n\t[Crosswalk](https://crosswalk-project.org/)\n\n\tCrosswalkCrosswalkAppAPK20M[](https://www.zhihu.com/question/26484511)\n\n- 4.\n\n\t[](http://x5.tencent.com/index)\n\n### 2.WebView\n\n- 1.Android4.2Java@JavascriptInterface  \n\n- 2.Android4.2searchBoxJavaBridge_Js\n\n  [Android WebViewJs](http://blog.csdn.net/leehong2005/article/details/11808557/)\n\n  webview[BaseWebView](https://gist.github.com/agehua/99233b40e05db29ee0ed4f50fb2c7530)\n\n### 3.AndroidWebViewJavaScript\n:[AndroidWebViewJavaScript](http://blog.csdn.net/jiangwei0910410003/article/details/52687530)\n","slug":"android-webview-summary","published":1,"date":"2016-07-24T16:00:00.000Z","updated":"2017-11-23T07:24:24.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ebxf000zd6ykcgubw7g7","content":"<h3 id=\"1-Android-Webview\"><a href=\"#1-Android-Webview\" class=\"headerlink\" title=\"1.Android Webview\"></a>1.Android Webview</h3><ul>\n<li><p>1.webview</p>\n<ul>\n<li><p>1.</p>\n</li>\n<li><p>2.Acivity</p>\n</li>\n</ul>\n<a id=\"more\"></a>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">goFinish</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">     isLoadWithError =<span class=\"keyword\">false</span>;</div><div class=\"line\">     <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span>!=jsCallBack)</div><div class=\"line\">         mWebView.removeJavascriptInterface(<span class=\"string\">\"XXX\"</span>);</div><div class=\"line\">     mWebView.setFocusable(<span class=\"keyword\">true</span>);</div><div class=\"line\">     mWebView.removeAllViews();</div><div class=\"line\">     <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">     \tmWebView.clearHistory(); <span class=\"comment\">//webview</span></div><div class=\"line\">     &#125;<span class=\"keyword\">catch</span>(Exception e)&#123;</div><div class=\"line\">         e.printStackTrace();</div><div class=\"line\">     &#125;</div><div class=\"line\">     mWebView.destroy();</div><div class=\"line\"></div><div class=\"line\">     <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">     \t<span class=\"comment\">//mWebViewWebView</span></div><div class=\"line\">         Field fieldWebView = <span class=\"keyword\">this</span>.getClass().getDeclaredField(<span class=\"string\">\"mWebView\"</span>);</div><div class=\"line\">         fieldWebView.setAccessible(<span class=\"keyword\">true</span>);</div><div class=\"line\">         WebView webView = (WebView) fieldWebView.get(<span class=\"keyword\">this</span>);</div><div class=\"line\">         webView.removeAllViews();</div><div class=\"line\">         webView.destroy();</div><div class=\"line\"></div><div class=\"line\">     &#125;<span class=\"keyword\">catch</span> (NoSuchFieldException e) &#123;</div><div class=\"line\">         e.printStackTrace();</div><div class=\"line\"></div><div class=\"line\">     &#125;<span class=\"keyword\">catch</span> (IllegalArgumentException e) &#123;</div><div class=\"line\">         e.printStackTrace();</div><div class=\"line\"></div><div class=\"line\">     &#125;<span class=\"keyword\">catch</span> (IllegalAccessException e) &#123;</div><div class=\"line\">         e.printStackTrace();</div><div class=\"line\"></div><div class=\"line\">     &#125;<span class=\"keyword\">catch</span>(Exception e)&#123;</div><div class=\"line\">         e.printStackTrace();</div><div class=\"line\">     &#125;</div><div class=\"line\">     <span class=\"keyword\">this</span>.finish();</div><div class=\"line\"> &#125;</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<blockquote>\n<p>webview<strong></strong></p>\n</blockquote>\n<ul>\n<li><p>2.h5 game</p>\n<p>   :)</p>\n</li>\n<li><p>3.android WebviewCrosswalk</p>\n<p>  Crosswalk4,2html5</p>\n<p>  <a href=\"https://crosswalk-project.org/\" target=\"_blank\" rel=\"external\">Crosswalk</a></p>\n<p>  CrosswalkCrosswalkAppAPK20M<a href=\"https://www.zhihu.com/question/26484511\" target=\"_blank\" rel=\"external\"></a></p>\n</li>\n<li><p>4.</p>\n<p>  <a href=\"http://x5.tencent.com/index\" target=\"_blank\" rel=\"external\"></a></p>\n</li>\n</ul>\n<h3 id=\"2-WebView\"><a href=\"#2-WebView\" class=\"headerlink\" title=\"2.WebView\"></a>2.WebView</h3><ul>\n<li><p>1.Android4.2Java@JavascriptInterface  </p>\n</li>\n<li><p>2.Android4.2searchBoxJavaBridge_Js</p>\n<p><a href=\"http://blog.csdn.net/leehong2005/article/details/11808557/\" target=\"_blank\" rel=\"external\">Android WebViewJs</a></p>\n<p>webview<a href=\"https://gist.github.com/agehua/99233b40e05db29ee0ed4f50fb2c7530\" target=\"_blank\" rel=\"external\">BaseWebView</a></p>\n</li>\n</ul>\n<h3 id=\"3-AndroidWebViewJavaScript\"><a href=\"#3-AndroidWebViewJavaScript\" class=\"headerlink\" title=\"3.AndroidWebViewJavaScript\"></a>3.AndroidWebViewJavaScript</h3><p>:<a href=\"http://blog.csdn.net/jiangwei0910410003/article/details/52687530\" target=\"_blank\" rel=\"external\">AndroidWebViewJavaScript</a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/07/25/android-webview-summary/\">http://agehua.github.io/2016/07/25/android-webview-summary/</a></p>\n","readingTime":{"text":"1 min read","minutes":0.86,"time":51600,"words":172},"excerpt":"<h3 id=\"1-Android-Webview\"><a href=\"#1-Android-Webview\" class=\"headerlink\" title=\"1.Android Webview\"></a>1.Android Webview</h3><ul>\n<li><p>1.webview</p>\n<ul>\n<li><p>1.</p>\n</li>\n<li><p>2.Acivity</p>\n</li>\n</ul>","more":"<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">goFinish</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">     isLoadWithError =<span class=\"keyword\">false</span>;</div><div class=\"line\">     <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span>!=jsCallBack)</div><div class=\"line\">         mWebView.removeJavascriptInterface(<span class=\"string\">\"XXX\"</span>);</div><div class=\"line\">     mWebView.setFocusable(<span class=\"keyword\">true</span>);</div><div class=\"line\">     mWebView.removeAllViews();</div><div class=\"line\">     <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">     \tmWebView.clearHistory(); <span class=\"comment\">//webview</span></div><div class=\"line\">     &#125;<span class=\"keyword\">catch</span>(Exception e)&#123;</div><div class=\"line\">         e.printStackTrace();</div><div class=\"line\">     &#125;</div><div class=\"line\">     mWebView.destroy();</div><div class=\"line\"></div><div class=\"line\">     <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">     \t<span class=\"comment\">//mWebViewWebView</span></div><div class=\"line\">         Field fieldWebView = <span class=\"keyword\">this</span>.getClass().getDeclaredField(<span class=\"string\">\"mWebView\"</span>);</div><div class=\"line\">         fieldWebView.setAccessible(<span class=\"keyword\">true</span>);</div><div class=\"line\">         WebView webView = (WebView) fieldWebView.get(<span class=\"keyword\">this</span>);</div><div class=\"line\">         webView.removeAllViews();</div><div class=\"line\">         webView.destroy();</div><div class=\"line\"></div><div class=\"line\">     &#125;<span class=\"keyword\">catch</span> (NoSuchFieldException e) &#123;</div><div class=\"line\">         e.printStackTrace();</div><div class=\"line\"></div><div class=\"line\">     &#125;<span class=\"keyword\">catch</span> (IllegalArgumentException e) &#123;</div><div class=\"line\">         e.printStackTrace();</div><div class=\"line\"></div><div class=\"line\">     &#125;<span class=\"keyword\">catch</span> (IllegalAccessException e) &#123;</div><div class=\"line\">         e.printStackTrace();</div><div class=\"line\"></div><div class=\"line\">     &#125;<span class=\"keyword\">catch</span>(Exception e)&#123;</div><div class=\"line\">         e.printStackTrace();</div><div class=\"line\">     &#125;</div><div class=\"line\">     <span class=\"keyword\">this</span>.finish();</div><div class=\"line\"> &#125;</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<blockquote>\n<p>webview<strong></strong></p>\n</blockquote>\n<ul>\n<li><p>2.h5 game</p>\n<p>   :)</p>\n</li>\n<li><p>3.android WebviewCrosswalk</p>\n<p>  Crosswalk4,2html5</p>\n<p>  <a href=\"https://crosswalk-project.org/\">Crosswalk</a></p>\n<p>  CrosswalkCrosswalkAppAPK20M<a href=\"https://www.zhihu.com/question/26484511\"></a></p>\n</li>\n<li><p>4.</p>\n<p>  <a href=\"http://x5.tencent.com/index\"></a></p>\n</li>\n</ul>\n<h3 id=\"2-WebView\"><a href=\"#2-WebView\" class=\"headerlink\" title=\"2.WebView\"></a>2.WebView</h3><ul>\n<li><p>1.Android4.2Java@JavascriptInterface  </p>\n</li>\n<li><p>2.Android4.2searchBoxJavaBridge_Js</p>\n<p><a href=\"http://blog.csdn.net/leehong2005/article/details/11808557/\">Android WebViewJs</a></p>\n<p>webview<a href=\"https://gist.github.com/agehua/99233b40e05db29ee0ed4f50fb2c7530\">BaseWebView</a></p>\n</li>\n</ul>\n<h3 id=\"3-AndroidWebViewJavaScript\"><a href=\"#3-AndroidWebViewJavaScript\" class=\"headerlink\" title=\"3.AndroidWebViewJavaScript\"></a>3.AndroidWebViewJavaScript</h3><p>:<a href=\"http://blog.csdn.net/jiangwei0910410003/article/details/52687530\">AndroidWebViewJavaScript</a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/07/25/android-webview-summary/\">http://agehua.github.io/2016/07/25/android-webview-summary/</a></p>"},{"layout":"post","title":"Android","keywords":"LocationListener","description":"AndroidGPS","banner":"http://obxk8w81b.bkt.clouddn.com/Blossoming%20Acacia%20Branches.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Blossoming%20Acacia%20Branches.jpg","_content":"\n\n\n### 1.LocationListener\n\nGPS\n\n<!--more-->\n\n\n\n~~~ Java\n/**\n  * \n  */\nprivate void startLocationService(){\n    locationListener = new LocationListener() {\n\n        @Override\n        public void onStatusChanged(String provider, int status, Bundle extras) {\n        }\n        @Override\n        public void onProviderEnabled(String provider) {\n            // GPS LocationProvider\n            location = locManager.getLastKnownLocation(provider);\n        }\n        @Override\n        public void onProviderDisabled(String provider) {\n            isLocatedSuccess = false;\n            if (provider.equals(\"network\")) {\n                    locManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 3 * 1000, 8,locationListener);\n            }else if(provider.equals(\"gps\")){//GPS\n                startActivity(new Intent(android.provider.Settings.ACTION_LOCATION_SOURCE_SETTINGS));\n            }else {\n                updateToNewLocation(null);\n            }\n        }\n        @Override\n        public void onLocationChanged(Location location) {\n            // \n            isLocatedSuccess = true;\n            updateToNewLocation(location);\n            locManager.removeUpdates(this);\n        }\n    };\n\n    if (locManager.getProvider(LocationManager.NETWORK_PROVIDER) != null)\n        locManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 3 * 1000, 8,locationListener);\n    else if (locManager.getProvider(LocationManager.GPS_PROVIDER) != null)\n        locManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 3 * 1000, 8,locationListener);\n    else Toast.makeText(mActivity(), \"\", Toast.LENGTH_SHORT).show();\n}\n~~~\n","source":"_posts/2016-08-03-android-LocationListener.md","raw":"---\nlayout: post\ntitle: Android\ncategory: technology\ntags:\n  - ANDROID\n  - LocationListener\nkeywords: LocationListener\ndescription: AndroidGPS\nbanner: http://obxk8w81b.bkt.clouddn.com/Blossoming%20Acacia%20Branches.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Blossoming%20Acacia%20Branches.jpg\n---\n\n\n\n### 1.LocationListener\n\nGPS\n\n<!--more-->\n\n\n\n~~~ Java\n/**\n  * \n  */\nprivate void startLocationService(){\n    locationListener = new LocationListener() {\n\n        @Override\n        public void onStatusChanged(String provider, int status, Bundle extras) {\n        }\n        @Override\n        public void onProviderEnabled(String provider) {\n            // GPS LocationProvider\n            location = locManager.getLastKnownLocation(provider);\n        }\n        @Override\n        public void onProviderDisabled(String provider) {\n            isLocatedSuccess = false;\n            if (provider.equals(\"network\")) {\n                    locManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 3 * 1000, 8,locationListener);\n            }else if(provider.equals(\"gps\")){//GPS\n                startActivity(new Intent(android.provider.Settings.ACTION_LOCATION_SOURCE_SETTINGS));\n            }else {\n                updateToNewLocation(null);\n            }\n        }\n        @Override\n        public void onLocationChanged(Location location) {\n            // \n            isLocatedSuccess = true;\n            updateToNewLocation(location);\n            locManager.removeUpdates(this);\n        }\n    };\n\n    if (locManager.getProvider(LocationManager.NETWORK_PROVIDER) != null)\n        locManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 3 * 1000, 8,locationListener);\n    else if (locManager.getProvider(LocationManager.GPS_PROVIDER) != null)\n        locManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 3 * 1000, 8,locationListener);\n    else Toast.makeText(mActivity(), \"\", Toast.LENGTH_SHORT).show();\n}\n~~~\n","slug":"android-LocationListener","published":1,"date":"2016-08-02T16:00:00.000Z","updated":"2017-11-23T07:24:27.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ebxi0014d6ykplzczbw9","content":"<h3 id=\"1-LocationListener\"><a href=\"#1-LocationListener\" class=\"headerlink\" title=\"1.LocationListener\"></a>1.LocationListener</h3><p>GPS</p>\n<a id=\"more\"></a>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\">  * </div><div class=\"line\">  */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">startLocationService</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">    locationListener = <span class=\"keyword\">new</span> LocationListener() &#123;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"meta\">@Override</span></div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onStatusChanged</span><span class=\"params\">(String provider, <span class=\"keyword\">int</span> status, Bundle extras)</span> </span>&#123;</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"meta\">@Override</span></div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onProviderEnabled</span><span class=\"params\">(String provider)</span> </span>&#123;</div><div class=\"line\">            <span class=\"comment\">// GPS LocationProvider</span></div><div class=\"line\">            location = locManager.getLastKnownLocation(provider);</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"meta\">@Override</span></div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onProviderDisabled</span><span class=\"params\">(String provider)</span> </span>&#123;</div><div class=\"line\">            isLocatedSuccess = <span class=\"keyword\">false</span>;</div><div class=\"line\">            <span class=\"keyword\">if</span> (provider.equals(<span class=\"string\">\"network\"</span>)) &#123;</div><div class=\"line\">                    locManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, <span class=\"number\">3</span> * <span class=\"number\">1000</span>, <span class=\"number\">8</span>,locationListener);</div><div class=\"line\">            &#125;<span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(provider.equals(<span class=\"string\">\"gps\"</span>))&#123;<span class=\"comment\">//GPS</span></div><div class=\"line\">                startActivity(<span class=\"keyword\">new</span> Intent(android.provider.Settings.ACTION_LOCATION_SOURCE_SETTINGS));</div><div class=\"line\">            &#125;<span class=\"keyword\">else</span> &#123;</div><div class=\"line\">                updateToNewLocation(<span class=\"keyword\">null</span>);</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"meta\">@Override</span></div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onLocationChanged</span><span class=\"params\">(Location location)</span> </span>&#123;</div><div class=\"line\">            <span class=\"comment\">// </span></div><div class=\"line\">            isLocatedSuccess = <span class=\"keyword\">true</span>;</div><div class=\"line\">            updateToNewLocation(location);</div><div class=\"line\">            locManager.removeUpdates(<span class=\"keyword\">this</span>);</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">if</span> (locManager.getProvider(LocationManager.NETWORK_PROVIDER) != <span class=\"keyword\">null</span>)</div><div class=\"line\">        locManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, <span class=\"number\">3</span> * <span class=\"number\">1000</span>, <span class=\"number\">8</span>,locationListener);</div><div class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (locManager.getProvider(LocationManager.GPS_PROVIDER) != <span class=\"keyword\">null</span>)</div><div class=\"line\">        locManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, <span class=\"number\">3</span> * <span class=\"number\">1000</span>, <span class=\"number\">8</span>,locationListener);</div><div class=\"line\">    <span class=\"keyword\">else</span> Toast.makeText(mActivity(), <span class=\"string\">\"\"</span>, Toast.LENGTH_SHORT).show();</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/08/03/android-LocationListener/\">http://agehua.github.io/2016/08/03/android-LocationListener/</a></p>\n","readingTime":{"text":"2 min read","minutes":1.13,"time":67800,"words":226},"excerpt":"<h3 id=\"1-LocationListener\"><a href=\"#1-LocationListener\" class=\"headerlink\" title=\"1.LocationListener\"></a>1.LocationListener</h3><p>GPS</p>","more":"<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</div><div class=\"line\">  * </div><div class=\"line\">  */</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">startLocationService</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">    locationListener = <span class=\"keyword\">new</span> LocationListener() &#123;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"meta\">@Override</span></div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onStatusChanged</span><span class=\"params\">(String provider, <span class=\"keyword\">int</span> status, Bundle extras)</span> </span>&#123;</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"meta\">@Override</span></div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onProviderEnabled</span><span class=\"params\">(String provider)</span> </span>&#123;</div><div class=\"line\">            <span class=\"comment\">// GPS LocationProvider</span></div><div class=\"line\">            location = locManager.getLastKnownLocation(provider);</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"meta\">@Override</span></div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onProviderDisabled</span><span class=\"params\">(String provider)</span> </span>&#123;</div><div class=\"line\">            isLocatedSuccess = <span class=\"keyword\">false</span>;</div><div class=\"line\">            <span class=\"keyword\">if</span> (provider.equals(<span class=\"string\">\"network\"</span>)) &#123;</div><div class=\"line\">                    locManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, <span class=\"number\">3</span> * <span class=\"number\">1000</span>, <span class=\"number\">8</span>,locationListener);</div><div class=\"line\">            &#125;<span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(provider.equals(<span class=\"string\">\"gps\"</span>))&#123;<span class=\"comment\">//GPS</span></div><div class=\"line\">                startActivity(<span class=\"keyword\">new</span> Intent(android.provider.Settings.ACTION_LOCATION_SOURCE_SETTINGS));</div><div class=\"line\">            &#125;<span class=\"keyword\">else</span> &#123;</div><div class=\"line\">                updateToNewLocation(<span class=\"keyword\">null</span>);</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"meta\">@Override</span></div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onLocationChanged</span><span class=\"params\">(Location location)</span> </span>&#123;</div><div class=\"line\">            <span class=\"comment\">// </span></div><div class=\"line\">            isLocatedSuccess = <span class=\"keyword\">true</span>;</div><div class=\"line\">            updateToNewLocation(location);</div><div class=\"line\">            locManager.removeUpdates(<span class=\"keyword\">this</span>);</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">if</span> (locManager.getProvider(LocationManager.NETWORK_PROVIDER) != <span class=\"keyword\">null</span>)</div><div class=\"line\">        locManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, <span class=\"number\">3</span> * <span class=\"number\">1000</span>, <span class=\"number\">8</span>,locationListener);</div><div class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (locManager.getProvider(LocationManager.GPS_PROVIDER) != <span class=\"keyword\">null</span>)</div><div class=\"line\">        locManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, <span class=\"number\">3</span> * <span class=\"number\">1000</span>, <span class=\"number\">8</span>,locationListener);</div><div class=\"line\">    <span class=\"keyword\">else</span> Toast.makeText(mActivity(), <span class=\"string\">\"\"</span>, Toast.LENGTH_SHORT).show();</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/08/03/android-LocationListener/\">http://agehua.github.io/2016/08/03/android-LocationListener/</a></p>"},{"layout":"post","title":"RxJava ","keywords":"RxJava RxAndroid","description":"RxAndroid","banner":"http://obxk8w81b.bkt.clouddn.com/Bulb%20Fields.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Bulb%20Fields.jpg","_content":"\n\n### 1.\n[AndroidRxJava](http://gank.io/post/560e15be2dca930e00da1083)\n\n    RxJava\n\n### 2.\nRxJava\nRxJavaObservable() Observer () subscribe ()ObservableObserversubscribe()ObservableObserver\n\n<!--more-->\n\n RxJava onNext()onClick()/onEvent()onCompleted()onError()\n\n> RxJavaObserverObservableScheduler\n\n### 3.Observer\n\nObserver  RxJava  Observer \n\n~~~ Java\nObserver<String> observer = new Observer<String>() {\n    @Override\n    public void onNext(String s) {\n        Log.d(tag, \"Item: \" + s);\n    }\n\n    @Override\n    public void onCompleted() {\n        Log.d(tag, \"Completed!\");\n    }\n\n    @Override\n    public void onError(Throwable e) {\n        Log.d(tag, \"Error!\");\n    }\n};\n~~~\n Observer RxJavaObserverSubscriber SubscriberObserver\n\n~~~ Java\nSubscriber<String> subscriber = new Subscriber<String>() {\n    @Override\n    public void onNext(String s) {\n        Log.d(tag, \"Item: \" + s);\n    }\n\n    @Override\n    public void onCompleted() {\n        Log.d(tag, \"Completed!\");\n    }\n\n    @Override\n    public void onError(Throwable e) {\n        Log.d(tag, \"Error!\");\n    }\n};\n~~~\n\nObserverSubscriber\n\n- onStart(): Subscriber\n\n    subscribe\n    >  onStart()subscribe  doOnSubscribe() \n\n- unsubscribe(): SubscriberSubscription\n\n    SubscriberisUnsubscribed() **unsubscribe()**subscribe()Observable Subscriber ******** onPause() onStop()  unsubscribe() \n\n### 4.Observable\n\n#### **1.Observable.just(T...)from(T[])/from(Iterable<? extends T>)**\n\n  - 1). just(T...): \n\n  - 2). from(T[])/from(Iterable<? extends T>):  Iterable \n\n  - 3). ObservableObserverObservableonNext()Observable.just()/from()ObservableonComplete()\n\n  ~~~ Java\n  Observable<List<String>> listObservable = Observable.just(getColorList());\n  ~~~\n\n  > just()UIgetColorList().\n\n    ObserverObservable\n\n~~~ Java\nlistObservable.subscribe(new Observer<List<String>>() {\n\n    @Override\n    public void onCompleted() { }\n\n    @Override\n    public void onError(Throwable e) { }\n\n    @Override\n    public void onNext(List<String> colors) {\n        mSimpleStringAdapter.setStrings(colors);\n    }\n});\n~~~\n  ObservableonComplete()onError()\n\n#### **2.Observable.fromCallable()**\n\n  \n\n~~~ Java\nObservable<List<String>> tvShowObservable = Observable.fromCallable(new Callable<List<String>>() {\n\n      @Override\n      public List<String> call() {\n          return mRestClient.getFavoriteTvShows();\n      }\n});\n~~~\n\nObservable.fromCallable()\n\n  - 1).Observer\n\n  - 2).call()just()\n\n    \n\nObservable\n\n~~~ Java\nmTvShowSubscription = tvShowObservable\n    .subscribeOn(Schedulers.io())\n    .observeOn(AndroidSchedulers.mainThread())\n    .subscribe(new Observer<List<String>>() {\n\n        @Override\n        public void onCompleted() { }\n\n        @Override\n        public void onError(Throwable e) { }\n\n        @Override\n        public void onNext(List<String> tvShows){\n            displayTvShows(tvShows);\n        }\n});\n~~~\n\n  \n\n  - 1).subscribeOn() \n\n    Observablesubscribe()subscribeOn()\"IO Scheduler\"Schedulers.io()Scheduler\n\n  - 2).observeOn() onNext()\n\n    observeOn()ScheduleronNext()AndroidSchedules.mainThread()Scheduler(UIScheduler)\n\n  - 3).subscribe() CallableObservablesubscribe()\n\n    Observable.subscribe(Subscriber) \n\n~~~ Java  \n//  subscribe() \n//  RxJava  GitHub \npublic Subscription subscribe(Subscriber subscriber) {\n    subscriber.onStart();\n    onSubscribe.call(subscriber);\n    return subscriber;\n}\n~~~\n  subscriber()3\n\n>   .Subscriber.onStart()\n   .ObservableOnSubscribe.call(Subscriber)RxJava Observable subscribe()\n   .SubscriberSubscriptionunsubscribe().\n\n  - 4).mTvShowSubscription\n\n    ObserverObservableSubscriptionSubscriptionObserverObservableActivityonDestroy()\n\n~~~ Java  \nif (mTvShowSubscription != null && !mTvShowSubscription.isUnsubscribed()) {\n      mTvShowSubscription.unsubscribe(); //\n}\n~~~\n   unsubscribe()ObservableObserverunsubscribe()ObserverObservable\n\n#### **3.Single**\n\nSingleObservableObservableObservableonComplete()/onNext()/onError()onSuccess()/onError()\n\n  ObservableSingleSingle:\n\n~~~ Java\nSingle<List<String>> tvShowSingle = Single.fromCallable(new Callable<List<String>>() {\n    @Override\n    public List<String> call() throws Exception {\n        mRestClient.getFavoriteTvShows();\n    }\n});\n~~~\n\n  \n\n~~~ Java\nmTvShowSubscription = tvShowSingle\n    .subscribeOn(Schedulers.io())\n    .observeOn(AndroidSchedulers.mainThread())\n    .subscribe(new SingleSubscriber<List<String>>() {\n\n        @Override\n        public void onSuccess(List<String> tvShows) {\n            displayTvShows(tvShows);\n        }\n\n        @Override\n        public void onError(Throwable error) {\n            displayErrorMessage();\n        }\n});\n~~~\n\n\nObserverSingleSubscriberObserveronSuccess()onError()SingleSubscriberSingleObserverObservable\n\nSingleSubscriptionSubscriptiononDestroy()\n\n### 5.Scheduler\n\n  RxJava Scheduler \n\n> - 1.Schedulers.immediate():  Scheduler\n- 2.Schedulers.newThread(): \n- 3.Schedulers.io(): I/O  Scheduler newThread()  io()  io()  newThread()  io() \n- 4.Schedulers.computation():  Scheduler CPU  I/O  Scheduler  CPU  I/O  computation()  I/O  CPU\n- 5. Android  AndroidSchedulers.mainThread() Android \n\n### 6.\n\n1.Subject ObservableObserver\n\n  Subjects = Observable + ObserverSubjectObservableObserver\n\n  RxjavaSubject:\n\n>    PublishSubject  subject\n    BehaviorSubject : \n    ReplaySubject  \n    AsyncSubject  \n","source":"_posts/2016-08-16-RxAndroid-Learning.md","raw":"---\nlayout: post\ntitle: RxJava \ncategory: technology\ntags:\n  - RxJava\n  - RxAndroid\nkeywords: RxJava RxAndroid\ndescription: RxAndroid\nbanner: http://obxk8w81b.bkt.clouddn.com/Bulb%20Fields.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Bulb%20Fields.jpg\n---\n\n\n### 1.\n[AndroidRxJava](http://gank.io/post/560e15be2dca930e00da1083)\n\n    RxJava\n\n### 2.\nRxJava\nRxJavaObservable() Observer () subscribe ()ObservableObserversubscribe()ObservableObserver\n\n<!--more-->\n\n RxJava onNext()onClick()/onEvent()onCompleted()onError()\n\n> RxJavaObserverObservableScheduler\n\n### 3.Observer\n\nObserver  RxJava  Observer \n\n~~~ Java\nObserver<String> observer = new Observer<String>() {\n    @Override\n    public void onNext(String s) {\n        Log.d(tag, \"Item: \" + s);\n    }\n\n    @Override\n    public void onCompleted() {\n        Log.d(tag, \"Completed!\");\n    }\n\n    @Override\n    public void onError(Throwable e) {\n        Log.d(tag, \"Error!\");\n    }\n};\n~~~\n Observer RxJavaObserverSubscriber SubscriberObserver\n\n~~~ Java\nSubscriber<String> subscriber = new Subscriber<String>() {\n    @Override\n    public void onNext(String s) {\n        Log.d(tag, \"Item: \" + s);\n    }\n\n    @Override\n    public void onCompleted() {\n        Log.d(tag, \"Completed!\");\n    }\n\n    @Override\n    public void onError(Throwable e) {\n        Log.d(tag, \"Error!\");\n    }\n};\n~~~\n\nObserverSubscriber\n\n- onStart(): Subscriber\n\n    subscribe\n    >  onStart()subscribe  doOnSubscribe() \n\n- unsubscribe(): SubscriberSubscription\n\n    SubscriberisUnsubscribed() **unsubscribe()**subscribe()Observable Subscriber ******** onPause() onStop()  unsubscribe() \n\n### 4.Observable\n\n#### **1.Observable.just(T...)from(T[])/from(Iterable<? extends T>)**\n\n  - 1). just(T...): \n\n  - 2). from(T[])/from(Iterable<? extends T>):  Iterable \n\n  - 3). ObservableObserverObservableonNext()Observable.just()/from()ObservableonComplete()\n\n  ~~~ Java\n  Observable<List<String>> listObservable = Observable.just(getColorList());\n  ~~~\n\n  > just()UIgetColorList().\n\n    ObserverObservable\n\n~~~ Java\nlistObservable.subscribe(new Observer<List<String>>() {\n\n    @Override\n    public void onCompleted() { }\n\n    @Override\n    public void onError(Throwable e) { }\n\n    @Override\n    public void onNext(List<String> colors) {\n        mSimpleStringAdapter.setStrings(colors);\n    }\n});\n~~~\n  ObservableonComplete()onError()\n\n#### **2.Observable.fromCallable()**\n\n  \n\n~~~ Java\nObservable<List<String>> tvShowObservable = Observable.fromCallable(new Callable<List<String>>() {\n\n      @Override\n      public List<String> call() {\n          return mRestClient.getFavoriteTvShows();\n      }\n});\n~~~\n\nObservable.fromCallable()\n\n  - 1).Observer\n\n  - 2).call()just()\n\n    \n\nObservable\n\n~~~ Java\nmTvShowSubscription = tvShowObservable\n    .subscribeOn(Schedulers.io())\n    .observeOn(AndroidSchedulers.mainThread())\n    .subscribe(new Observer<List<String>>() {\n\n        @Override\n        public void onCompleted() { }\n\n        @Override\n        public void onError(Throwable e) { }\n\n        @Override\n        public void onNext(List<String> tvShows){\n            displayTvShows(tvShows);\n        }\n});\n~~~\n\n  \n\n  - 1).subscribeOn() \n\n    Observablesubscribe()subscribeOn()\"IO Scheduler\"Schedulers.io()Scheduler\n\n  - 2).observeOn() onNext()\n\n    observeOn()ScheduleronNext()AndroidSchedules.mainThread()Scheduler(UIScheduler)\n\n  - 3).subscribe() CallableObservablesubscribe()\n\n    Observable.subscribe(Subscriber) \n\n~~~ Java  \n//  subscribe() \n//  RxJava  GitHub \npublic Subscription subscribe(Subscriber subscriber) {\n    subscriber.onStart();\n    onSubscribe.call(subscriber);\n    return subscriber;\n}\n~~~\n  subscriber()3\n\n>   .Subscriber.onStart()\n   .ObservableOnSubscribe.call(Subscriber)RxJava Observable subscribe()\n   .SubscriberSubscriptionunsubscribe().\n\n  - 4).mTvShowSubscription\n\n    ObserverObservableSubscriptionSubscriptionObserverObservableActivityonDestroy()\n\n~~~ Java  \nif (mTvShowSubscription != null && !mTvShowSubscription.isUnsubscribed()) {\n      mTvShowSubscription.unsubscribe(); //\n}\n~~~\n   unsubscribe()ObservableObserverunsubscribe()ObserverObservable\n\n#### **3.Single**\n\nSingleObservableObservableObservableonComplete()/onNext()/onError()onSuccess()/onError()\n\n  ObservableSingleSingle:\n\n~~~ Java\nSingle<List<String>> tvShowSingle = Single.fromCallable(new Callable<List<String>>() {\n    @Override\n    public List<String> call() throws Exception {\n        mRestClient.getFavoriteTvShows();\n    }\n});\n~~~\n\n  \n\n~~~ Java\nmTvShowSubscription = tvShowSingle\n    .subscribeOn(Schedulers.io())\n    .observeOn(AndroidSchedulers.mainThread())\n    .subscribe(new SingleSubscriber<List<String>>() {\n\n        @Override\n        public void onSuccess(List<String> tvShows) {\n            displayTvShows(tvShows);\n        }\n\n        @Override\n        public void onError(Throwable error) {\n            displayErrorMessage();\n        }\n});\n~~~\n\n\nObserverSingleSubscriberObserveronSuccess()onError()SingleSubscriberSingleObserverObservable\n\nSingleSubscriptionSubscriptiononDestroy()\n\n### 5.Scheduler\n\n  RxJava Scheduler \n\n> - 1.Schedulers.immediate():  Scheduler\n- 2.Schedulers.newThread(): \n- 3.Schedulers.io(): I/O  Scheduler newThread()  io()  io()  newThread()  io() \n- 4.Schedulers.computation():  Scheduler CPU  I/O  Scheduler  CPU  I/O  computation()  I/O  CPU\n- 5. Android  AndroidSchedulers.mainThread() Android \n\n### 6.\n\n1.Subject ObservableObserver\n\n  Subjects = Observable + ObserverSubjectObservableObserver\n\n  RxjavaSubject:\n\n>    PublishSubject  subject\n    BehaviorSubject : \n    ReplaySubject  \n    AsyncSubject  \n","slug":"RxAndroid-Learning","published":1,"date":"2016-08-15T16:00:00.000Z","updated":"2017-11-23T07:06:24.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ebxo0017d6yk943ra445","content":"<h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h3><p><a href=\"http://gank.io/post/560e15be2dca930e00da1083\" target=\"_blank\" rel=\"external\">AndroidRxJava</a></p>\n<pre><code>RxJava\n</code></pre><h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h3><p>RxJava<br>RxJavaObservable() Observer () subscribe ()ObservableObserversubscribe()ObservableObserver</p>\n<a id=\"more\"></a>\n<p> RxJava onNext()onClick()/onEvent()onCompleted()onError()</p>\n<blockquote>\n<p>RxJavaObserverObservableScheduler</p>\n</blockquote>\n<h3 id=\"3-Observer\"><a href=\"#3-Observer\" class=\"headerlink\" title=\"3.Observer\"></a>3.Observer</h3><p>Observer  RxJava  Observer </p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Observer&lt;String&gt; observer = <span class=\"keyword\">new</span> Observer&lt;String&gt;() &#123;</div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onNext</span><span class=\"params\">(String s)</span> </span>&#123;</div><div class=\"line\">        Log.d(tag, <span class=\"string\">\"Item: \"</span> + s);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onCompleted</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        Log.d(tag, <span class=\"string\">\"Completed!\"</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onError</span><span class=\"params\">(Throwable e)</span> </span>&#123;</div><div class=\"line\">        Log.d(tag, <span class=\"string\">\"Error!\"</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure>\n<p> Observer RxJavaObserverSubscriber SubscriberObserver</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Subscriber&lt;String&gt; subscriber = <span class=\"keyword\">new</span> Subscriber&lt;String&gt;() &#123;</div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onNext</span><span class=\"params\">(String s)</span> </span>&#123;</div><div class=\"line\">        Log.d(tag, <span class=\"string\">\"Item: \"</span> + s);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onCompleted</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        Log.d(tag, <span class=\"string\">\"Completed!\"</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onError</span><span class=\"params\">(Throwable e)</span> </span>&#123;</div><div class=\"line\">        Log.d(tag, <span class=\"string\">\"Error!\"</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure>\n<p>ObserverSubscriber</p>\n<ul>\n<li><p>onStart(): Subscriber</p>\n<p>  subscribe</p>\n<blockquote>\n<p> onStart()subscribe  doOnSubscribe() </p>\n</blockquote>\n</li>\n<li><p>unsubscribe(): SubscriberSubscription</p>\n<p>  SubscriberisUnsubscribed() <strong>unsubscribe()</strong>subscribe()Observable Subscriber <strong></strong><strong></strong> onPause() onStop()  unsubscribe() </p>\n</li>\n</ul>\n<h3 id=\"4-Observable\"><a href=\"#4-Observable\" class=\"headerlink\" title=\"4.Observable\"></a>4.Observable</h3><h4 id=\"1-Observable-just-T-from-T-from-Iterable-lt-extends-T-gt\"><a href=\"#1-Observable-just-T-from-T-from-Iterable-lt-extends-T-gt\" class=\"headerlink\" title=\"1.Observable.just(T)from(T[])/from(Iterable&lt;? extends T&gt;)\"></a><strong>1.Observable.just(T)from(T[])/from(Iterable&lt;? extends T&gt;)</strong></h4><ul>\n<li><p>1). just(T): </p>\n</li>\n<li><p>2). from(T[])/from(Iterable&lt;? extends T&gt;):  Iterable </p>\n</li>\n<li><p>3). ObservableObserverObservableonNext()Observable.just()/from()ObservableonComplete()</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Observable&lt;List&lt;String&gt;&gt; listObservable = Observable.just(getColorList());</div></pre></td></tr></table></figure>\n<blockquote>\n<p>just()UIgetColorList().</p>\n</blockquote>\n<p>ObserverObservable</p>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">listObservable.subscribe(<span class=\"keyword\">new</span> Observer&lt;List&lt;String&gt;&gt;() &#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onCompleted</span><span class=\"params\">()</span> </span>&#123; &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onError</span><span class=\"params\">(Throwable e)</span> </span>&#123; &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onNext</span><span class=\"params\">(List&lt;String&gt; colors)</span> </span>&#123;</div><div class=\"line\">        mSimpleStringAdapter.setStrings(colors);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure>\n<p>  ObservableonComplete()onError()</p>\n<h4 id=\"2-Observable-fromCallable\"><a href=\"#2-Observable-fromCallable\" class=\"headerlink\" title=\"2.Observable.fromCallable()\"></a><strong>2.Observable.fromCallable()</strong></h4><p>  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Observable&lt;List&lt;String&gt;&gt; tvShowObservable = Observable.fromCallable(<span class=\"keyword\">new</span> Callable&lt;List&lt;String&gt;&gt;() &#123;</div><div class=\"line\"></div><div class=\"line\">      <span class=\"meta\">@Override</span></div><div class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> List&lt;String&gt; <span class=\"title\">call</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">          <span class=\"keyword\">return</span> mRestClient.getFavoriteTvShows();</div><div class=\"line\">      &#125;</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure>\n<p>Observable.fromCallable()</p>\n<ul>\n<li><p>1).Observer</p>\n</li>\n<li><p>2).call()just()</p>\n<p></p>\n</li>\n</ul>\n<p>Observable</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">mTvShowSubscription = tvShowObservable</div><div class=\"line\">    .subscribeOn(Schedulers.io())</div><div class=\"line\">    .observeOn(AndroidSchedulers.mainThread())</div><div class=\"line\">    .subscribe(<span class=\"keyword\">new</span> Observer&lt;List&lt;String&gt;&gt;() &#123;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"meta\">@Override</span></div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onCompleted</span><span class=\"params\">()</span> </span>&#123; &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"meta\">@Override</span></div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onError</span><span class=\"params\">(Throwable e)</span> </span>&#123; &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"meta\">@Override</span></div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onNext</span><span class=\"params\">(List&lt;String&gt; tvShows)</span></span>&#123;</div><div class=\"line\">            displayTvShows(tvShows);</div><div class=\"line\">        &#125;</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure>\n<p>  </p>\n<ul>\n<li><p>1).subscribeOn() </p>\n<p>Observablesubscribe()subscribeOn()IO SchedulerSchedulers.io()Scheduler</p>\n</li>\n<li><p>2).observeOn() onNext()</p>\n<p>observeOn()ScheduleronNext()AndroidSchedules.mainThread()Scheduler(UIScheduler)</p>\n</li>\n<li><p>3).subscribe() CallableObservablesubscribe()</p>\n<p>Observable.subscribe(Subscriber) </p>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//  subscribe() </span></div><div class=\"line\"><span class=\"comment\">//  RxJava  GitHub </span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Subscription <span class=\"title\">subscribe</span><span class=\"params\">(Subscriber subscriber)</span> </span>&#123;</div><div class=\"line\">    subscriber.onStart();</div><div class=\"line\">    onSubscribe.call(subscriber);</div><div class=\"line\">    <span class=\"keyword\">return</span> subscriber;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>  subscriber()3</p>\n<blockquote>\n<p>  .Subscriber.onStart()<br>   .ObservableOnSubscribe.call(Subscriber)RxJava Observable subscribe()<br>   .SubscriberSubscriptionunsubscribe().</p>\n</blockquote>\n<ul>\n<li><p>4).mTvShowSubscription</p>\n<p>ObserverObservableSubscriptionSubscriptionObserverObservableActivityonDestroy()</p>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">if</span> (mTvShowSubscription != <span class=\"keyword\">null</span> &amp;&amp; !mTvShowSubscription.isUnsubscribed()) &#123;</div><div class=\"line\">      mTvShowSubscription.unsubscribe(); <span class=\"comment\">//</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>   unsubscribe()ObservableObserverunsubscribe()ObserverObservable</p>\n<h4 id=\"3-Single\"><a href=\"#3-Single\" class=\"headerlink\" title=\"3.Single\"></a><strong>3.Single</strong></h4><p>SingleObservableObservableObservableonComplete()/onNext()/onError()onSuccess()/onError()</p>\n<p>  ObservableSingleSingle:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Single&lt;List&lt;String&gt;&gt; tvShowSingle = Single.fromCallable(<span class=\"keyword\">new</span> Callable&lt;List&lt;String&gt;&gt;() &#123;</div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> List&lt;String&gt; <span class=\"title\">call</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</div><div class=\"line\">        mRestClient.getFavoriteTvShows();</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure>\n<p>  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">mTvShowSubscription = tvShowSingle</div><div class=\"line\">    .subscribeOn(Schedulers.io())</div><div class=\"line\">    .observeOn(AndroidSchedulers.mainThread())</div><div class=\"line\">    .subscribe(<span class=\"keyword\">new</span> SingleSubscriber&lt;List&lt;String&gt;&gt;() &#123;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"meta\">@Override</span></div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onSuccess</span><span class=\"params\">(List&lt;String&gt; tvShows)</span> </span>&#123;</div><div class=\"line\">            displayTvShows(tvShows);</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"meta\">@Override</span></div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onError</span><span class=\"params\">(Throwable error)</span> </span>&#123;</div><div class=\"line\">            displayErrorMessage();</div><div class=\"line\">        &#125;</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure>\n<p>ObserverSingleSubscriberObserveronSuccess()onError()SingleSubscriberSingleObserverObservable</p>\n<p>SingleSubscriptionSubscriptiononDestroy()</p>\n<h3 id=\"5-Scheduler\"><a href=\"#5-Scheduler\" class=\"headerlink\" title=\"5.Scheduler\"></a>5.Scheduler</h3><p>  RxJava Scheduler </p>\n<blockquote>\n<ul>\n<li>1.Schedulers.immediate():  Scheduler</li>\n<li>2.Schedulers.newThread(): </li>\n<li>3.Schedulers.io(): I/O  Scheduler newThread()  io()  io()  newThread()  io() </li>\n<li>4.Schedulers.computation():  Scheduler CPU  I/O  Scheduler  CPU  I/O  computation()  I/O  CPU</li>\n<li>5. Android  AndroidSchedulers.mainThread() Android </li>\n</ul>\n</blockquote>\n<h3 id=\"6-\"><a href=\"#6-\" class=\"headerlink\" title=\"6.\"></a>6.</h3><p>1.Subject ObservableObserver</p>\n<p>  Subjects = Observable + ObserverSubjectObservableObserver</p>\n<p>  RxjavaSubject:</p>\n<blockquote>\n<p>   PublishSubject  subject<br>    BehaviorSubject : <br>    ReplaySubject  <br>    AsyncSubject  </p>\n</blockquote>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/08/16/RxAndroid-Learning/\">http://agehua.github.io/2016/08/16/RxAndroid-Learning/</a></p>\n","readingTime":{"text":"4 min read","minutes":3.345,"time":200700.00000000003,"words":669},"excerpt":"<h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h3><p><a href=\"http://gank.io/post/560e15be2dca930e00da1083\">AndroidRxJava</a></p>\n<pre><code>RxJava\n</code></pre><h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h3><p>RxJava<br>RxJavaObservable() Observer () subscribe ()ObservableObserversubscribe()ObservableObserver</p>","more":"<p> RxJava onNext()onClick()/onEvent()onCompleted()onError()</p>\n<blockquote>\n<p>RxJavaObserverObservableScheduler</p>\n</blockquote>\n<h3 id=\"3-Observer\"><a href=\"#3-Observer\" class=\"headerlink\" title=\"3.Observer\"></a>3.Observer</h3><p>Observer  RxJava  Observer </p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Observer&lt;String&gt; observer = <span class=\"keyword\">new</span> Observer&lt;String&gt;() &#123;</div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onNext</span><span class=\"params\">(String s)</span> </span>&#123;</div><div class=\"line\">        Log.d(tag, <span class=\"string\">\"Item: \"</span> + s);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onCompleted</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        Log.d(tag, <span class=\"string\">\"Completed!\"</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onError</span><span class=\"params\">(Throwable e)</span> </span>&#123;</div><div class=\"line\">        Log.d(tag, <span class=\"string\">\"Error!\"</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure>\n<p> Observer RxJavaObserverSubscriber SubscriberObserver</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Subscriber&lt;String&gt; subscriber = <span class=\"keyword\">new</span> Subscriber&lt;String&gt;() &#123;</div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onNext</span><span class=\"params\">(String s)</span> </span>&#123;</div><div class=\"line\">        Log.d(tag, <span class=\"string\">\"Item: \"</span> + s);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onCompleted</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        Log.d(tag, <span class=\"string\">\"Completed!\"</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onError</span><span class=\"params\">(Throwable e)</span> </span>&#123;</div><div class=\"line\">        Log.d(tag, <span class=\"string\">\"Error!\"</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure>\n<p>ObserverSubscriber</p>\n<ul>\n<li><p>onStart(): Subscriber</p>\n<p>  subscribe</p>\n<blockquote>\n<p> onStart()subscribe  doOnSubscribe() </p>\n</blockquote>\n</li>\n<li><p>unsubscribe(): SubscriberSubscription</p>\n<p>  SubscriberisUnsubscribed() <strong>unsubscribe()</strong>subscribe()Observable Subscriber <strong></strong><strong></strong> onPause() onStop()  unsubscribe() </p>\n</li>\n</ul>\n<h3 id=\"4-Observable\"><a href=\"#4-Observable\" class=\"headerlink\" title=\"4.Observable\"></a>4.Observable</h3><h4 id=\"1-Observable-just-T-from-T-from-Iterable-lt-extends-T-gt\"><a href=\"#1-Observable-just-T-from-T-from-Iterable-lt-extends-T-gt\" class=\"headerlink\" title=\"1.Observable.just(T)from(T[])/from(Iterable&lt;? extends T&gt;)\"></a><strong>1.Observable.just(T)from(T[])/from(Iterable&lt;? extends T&gt;)</strong></h4><ul>\n<li><p>1). just(T): </p>\n</li>\n<li><p>2). from(T[])/from(Iterable&lt;? extends T&gt;):  Iterable </p>\n</li>\n<li><p>3). ObservableObserverObservableonNext()Observable.just()/from()ObservableonComplete()</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Observable&lt;List&lt;String&gt;&gt; listObservable = Observable.just(getColorList());</div></pre></td></tr></table></figure>\n<blockquote>\n<p>just()UIgetColorList().</p>\n</blockquote>\n<p>ObserverObservable</p>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">listObservable.subscribe(<span class=\"keyword\">new</span> Observer&lt;List&lt;String&gt;&gt;() &#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onCompleted</span><span class=\"params\">()</span> </span>&#123; &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onError</span><span class=\"params\">(Throwable e)</span> </span>&#123; &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onNext</span><span class=\"params\">(List&lt;String&gt; colors)</span> </span>&#123;</div><div class=\"line\">        mSimpleStringAdapter.setStrings(colors);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure>\n<p>  ObservableonComplete()onError()</p>\n<h4 id=\"2-Observable-fromCallable\"><a href=\"#2-Observable-fromCallable\" class=\"headerlink\" title=\"2.Observable.fromCallable()\"></a><strong>2.Observable.fromCallable()</strong></h4><p>  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Observable&lt;List&lt;String&gt;&gt; tvShowObservable = Observable.fromCallable(<span class=\"keyword\">new</span> Callable&lt;List&lt;String&gt;&gt;() &#123;</div><div class=\"line\"></div><div class=\"line\">      <span class=\"meta\">@Override</span></div><div class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> List&lt;String&gt; <span class=\"title\">call</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">          <span class=\"keyword\">return</span> mRestClient.getFavoriteTvShows();</div><div class=\"line\">      &#125;</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure>\n<p>Observable.fromCallable()</p>\n<ul>\n<li><p>1).Observer</p>\n</li>\n<li><p>2).call()just()</p>\n<p></p>\n</li>\n</ul>\n<p>Observable</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">mTvShowSubscription = tvShowObservable</div><div class=\"line\">    .subscribeOn(Schedulers.io())</div><div class=\"line\">    .observeOn(AndroidSchedulers.mainThread())</div><div class=\"line\">    .subscribe(<span class=\"keyword\">new</span> Observer&lt;List&lt;String&gt;&gt;() &#123;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"meta\">@Override</span></div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onCompleted</span><span class=\"params\">()</span> </span>&#123; &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"meta\">@Override</span></div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onError</span><span class=\"params\">(Throwable e)</span> </span>&#123; &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"meta\">@Override</span></div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onNext</span><span class=\"params\">(List&lt;String&gt; tvShows)</span></span>&#123;</div><div class=\"line\">            displayTvShows(tvShows);</div><div class=\"line\">        &#125;</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure>\n<p>  </p>\n<ul>\n<li><p>1).subscribeOn() </p>\n<p>Observablesubscribe()subscribeOn()IO SchedulerSchedulers.io()Scheduler</p>\n</li>\n<li><p>2).observeOn() onNext()</p>\n<p>observeOn()ScheduleronNext()AndroidSchedules.mainThread()Scheduler(UIScheduler)</p>\n</li>\n<li><p>3).subscribe() CallableObservablesubscribe()</p>\n<p>Observable.subscribe(Subscriber) </p>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//  subscribe() </span></div><div class=\"line\"><span class=\"comment\">//  RxJava  GitHub </span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Subscription <span class=\"title\">subscribe</span><span class=\"params\">(Subscriber subscriber)</span> </span>&#123;</div><div class=\"line\">    subscriber.onStart();</div><div class=\"line\">    onSubscribe.call(subscriber);</div><div class=\"line\">    <span class=\"keyword\">return</span> subscriber;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>  subscriber()3</p>\n<blockquote>\n<p>  .Subscriber.onStart()<br>   .ObservableOnSubscribe.call(Subscriber)RxJava Observable subscribe()<br>   .SubscriberSubscriptionunsubscribe().</p>\n</blockquote>\n<ul>\n<li><p>4).mTvShowSubscription</p>\n<p>ObserverObservableSubscriptionSubscriptionObserverObservableActivityonDestroy()</p>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">if</span> (mTvShowSubscription != <span class=\"keyword\">null</span> &amp;&amp; !mTvShowSubscription.isUnsubscribed()) &#123;</div><div class=\"line\">      mTvShowSubscription.unsubscribe(); <span class=\"comment\">//</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>   unsubscribe()ObservableObserverunsubscribe()ObserverObservable</p>\n<h4 id=\"3-Single\"><a href=\"#3-Single\" class=\"headerlink\" title=\"3.Single\"></a><strong>3.Single</strong></h4><p>SingleObservableObservableObservableonComplete()/onNext()/onError()onSuccess()/onError()</p>\n<p>  ObservableSingleSingle:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Single&lt;List&lt;String&gt;&gt; tvShowSingle = Single.fromCallable(<span class=\"keyword\">new</span> Callable&lt;List&lt;String&gt;&gt;() &#123;</div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> List&lt;String&gt; <span class=\"title\">call</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</div><div class=\"line\">        mRestClient.getFavoriteTvShows();</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure>\n<p>  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">mTvShowSubscription = tvShowSingle</div><div class=\"line\">    .subscribeOn(Schedulers.io())</div><div class=\"line\">    .observeOn(AndroidSchedulers.mainThread())</div><div class=\"line\">    .subscribe(<span class=\"keyword\">new</span> SingleSubscriber&lt;List&lt;String&gt;&gt;() &#123;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"meta\">@Override</span></div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onSuccess</span><span class=\"params\">(List&lt;String&gt; tvShows)</span> </span>&#123;</div><div class=\"line\">            displayTvShows(tvShows);</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"meta\">@Override</span></div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onError</span><span class=\"params\">(Throwable error)</span> </span>&#123;</div><div class=\"line\">            displayErrorMessage();</div><div class=\"line\">        &#125;</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure>\n<p>ObserverSingleSubscriberObserveronSuccess()onError()SingleSubscriberSingleObserverObservable</p>\n<p>SingleSubscriptionSubscriptiononDestroy()</p>\n<h3 id=\"5-Scheduler\"><a href=\"#5-Scheduler\" class=\"headerlink\" title=\"5.Scheduler\"></a>5.Scheduler</h3><p>  RxJava Scheduler </p>\n<blockquote>\n<ul>\n<li>1.Schedulers.immediate():  Scheduler</li>\n<li>2.Schedulers.newThread(): </li>\n<li>3.Schedulers.io(): I/O  Scheduler newThread()  io()  io()  newThread()  io() </li>\n<li>4.Schedulers.computation():  Scheduler CPU  I/O  Scheduler  CPU  I/O  computation()  I/O  CPU</li>\n<li>5. Android  AndroidSchedulers.mainThread() Android </li>\n</ul>\n</blockquote>\n<h3 id=\"6-\"><a href=\"#6-\" class=\"headerlink\" title=\"6.\"></a>6.</h3><p>1.Subject ObservableObserver</p>\n<p>  Subjects = Observable + ObserverSubjectObservableObserver</p>\n<p>  RxjavaSubject:</p>\n<blockquote>\n<p>   PublishSubject  subject<br>    BehaviorSubject : <br>    ReplaySubject  <br>    AsyncSubject  </p>\n</blockquote>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/08/16/RxAndroid-Learning/\">http://agehua.github.io/2016/08/16/RxAndroid-Learning/</a></p>"},{"layout":"post","title":"ThreadLocalHandlerThreadLooper","keywords":"ThreadLocal, HandlerThread, Looper","banner":"http://obxk8w81b.bkt.clouddn.com/A%20Lane%20in%20the%20Public%20Garden%20at%20Arles.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/A%20Lane%20in%20the%20Public%20Garden%20at%20Arles.jpg","_content":"\n\n### 1.\n\n    AndroidUIWorkThreadUIMainThread\n\nhandler Message MessageQueueLooper MessageHandlerHandler \n\n### 2.ThreadLocal<T>\n\nThreadThreadLocal.ThreadLocalMap threadLocals mapkeyThreadLocalvalueThreadLocalThreadLocal putThreadLocal getThreadmapkeyThreadmapLocalThreadThreadLocalThread\n\n<!--more-->\n\nmapmapbeanThreadLocal \n\nThreadLocal\n\n[Android  HandlerLooperHandlerThread ](http://www.jianshu.com/p/08cb3665972f)\n\n\n### 3.Looper\nLooperAndroid handlerLooper\nLooperprivate static final ThreadLocal sThreadLocal = new ThreadLocal();\nAndroidThreadLocalLooper.preparesThreadLocalkeynewloopervalue putmapLooper.loopsThreadLocalLooperMessageQueueMessagemessageHandler\n\n### 4.Handler\nSDKHandler\n\n> A Handler allows you to sendand process Messageand Runnable objects associated with a thread's MessageQueue.Each Handler instance is associated with a single thread and that thread'smessage queue. When you create a new Handler, it is bound to the thread /message queue of the thread that is creating it -- from that point on, it willdeliver messages and runnables to that message queue and execute them as theycome out of the message queue.\n\n#### 4.1 Handler\n\n> There are two main uses for aHandler: (1) to schedule messages and runnables to be executed as some point inthe future; and (2) to enqueue an action to be performed on a different thread than your own.\n\nHandlerLooper(UI-ThreadLooper)\n\n#### 4.2 HandlerUI\n\nHandlerHandlerUIUIHandlerUISDK4UI()\n\n- Activity.runOnUiThread(Runnable)\n- View.post(Runnable)\n- View.postDelayed(Runnable, long)\n- UIHandler\n\n\n- HandlerHandler\n- LooperMessageQueueLooperLooperHandler\n- UIView.post\n- handler\n- handlerhandlerhandler\n- AndroidLooperUI\n- Looper.myLooper();      //Looper\n  Looper.getMainLooper() //UILooper\n- HandleLooperLooperLooper\n- Looper.prepare()Looper.loop();\n\n### 5.\n\n\n\n#### 5.1 \n~~~ Java\nMessage msg =mHandler.obtainMessage();\nmsg.what = what;\nmsg.sendToTarget();\n~~~\n\n#### 5.2 \n\n~~~ Java\nMessageQueue queue= mQueue;\n  if (queue != null){\n  msg.target =this;\n  sent =queue.enqueueMessage(msg, uptimeMillis);\n}\n~~~\nHandler.javasendMessageAtTime(Messagemsg, long uptimeMillis)MessageQueueMessagetargetMessageHandlerMessage\n\n#### 5.3 \n~~~ Java\nLooper me =myLooper();\nMessageQueue queue= me.mQueue;\nwhile (true) {\n  Message msg =queue.next(); // might block\n  if (msg !=null) {\n    if(msg.target == null) {\n      // Notarget is a magic identifier for the quit message.\n      return;\n    }\n    msg.target.dispatchMessage(msg);\n    msg.recycle();\n  }\n}\n~~~\n\nLooper.javaloop()MessageQueuenextMessageMessagetargetHandlerdispatchMessage\n\n#### 5.4 \n~~~ Java\nif (msg.callback!= null) {\n  handleCallback(msg);\n} else {\n  if (mCallback!= null) {\n    if(mCallback.handleMessage(msg)) {\n      return;\n    }\n  }\n handleMessage(msg);\n}\n~~~\nHandler.javadispatchMessage(Messagemsg)handleMessageMessageHandlerhandleMessage(Messagemsg)\ndispatchMessage\nMessageHandlerMessageQueueLooperHandler\n\nView.post(Runnable)\n\n- post(Runnableaction)ViewUIHandleractionpostHandler\n- HandleractionMessageMessagecallbackactionUI\n-  HandlerMessagemCallback.handleMessagerunnablerun\n- UIUI\n\n\n### 5.HandlerThread\nHandlerThreadThreadLooperLooperHandler\n\nHandlerThreadstart()HandlerHandlerThreadlooper\n\n~~~ Java\nHandlerThread thread = new HandlerThread(\"MyHandlerThread\");\nthread.start();\nmHandler = new Handler(thread.getLooper());\nmHandler.post(new Runnable(){...});\n~~~\n\nHandlerHandlerThreadUIHandlerUI\n\nHandlerThreadhandlerThread.quit()\n\n\n\n~~~ Java\npublic class HandlerThreadActivity extends Activity {\n    private static final String TAG = \"HandlerThreadActivity\";\n    private HandlerThreadmHandlerThread;\n    private MyHandler mMyHandler;\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n       // TODO Auto-generatedmethod stub\n       super.onCreate(savedInstanceState);\n       TextView text = new TextView(this);\n       text.setText(\"HandlerThreadActivity\");\n       setContentView(text);\n\n       Log.d(TAG, \"The mainthread id = \" + Thread.currentThread().getId());\n\n       //HandlerThreadLooper\n       //Android\n       mHandlerThread = new HandlerThread(\"handler_thread\");\n\n       //HandlerThreadgetLooper()start();\n       mHandlerThread.start();\n       //HandlermHandlerThread\n       mMyHandler = new MyHandler(mHandlerThread.getLooper());\n\n       mMyHandler.sendEmptyMessage(1);\n    }\n\n    private class MyHandler extends Handler {\n\n       public MyHandler(Looper looper) {\n           super(looper);\n       }\n\n       @Override\n       public void handleMessage(Message msg) {\n           Log.d(TAG, \"MyHandler-->handleMessage-->threadid = \" + Thread.currentThread().getId());\n           super.handleMessage(msg);\n       }\n    }\n}\n~~~\n","source":"_posts/2016-09-05-ThreadLocal-HandlerThread-Looper.md","raw":"---\nlayout: post\ntitle:  ThreadLocalHandlerThreadLooper\ncategory: accumulation\ntags:\n  - ThreadLocal\n  - HandlerThread\n  - Looper\nkeywords: ThreadLocal, HandlerThread, Looper\nbanner: http://obxk8w81b.bkt.clouddn.com/A%20Lane%20in%20the%20Public%20Garden%20at%20Arles.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/A%20Lane%20in%20the%20Public%20Garden%20at%20Arles.jpg\n---\n\n\n### 1.\n\n    AndroidUIWorkThreadUIMainThread\n\nhandler Message MessageQueueLooper MessageHandlerHandler \n\n### 2.ThreadLocal<T>\n\nThreadThreadLocal.ThreadLocalMap threadLocals mapkeyThreadLocalvalueThreadLocalThreadLocal putThreadLocal getThreadmapkeyThreadmapLocalThreadThreadLocalThread\n\n<!--more-->\n\nmapmapbeanThreadLocal \n\nThreadLocal\n\n[Android  HandlerLooperHandlerThread ](http://www.jianshu.com/p/08cb3665972f)\n\n\n### 3.Looper\nLooperAndroid handlerLooper\nLooperprivate static final ThreadLocal sThreadLocal = new ThreadLocal();\nAndroidThreadLocalLooper.preparesThreadLocalkeynewloopervalue putmapLooper.loopsThreadLocalLooperMessageQueueMessagemessageHandler\n\n### 4.Handler\nSDKHandler\n\n> A Handler allows you to sendand process Messageand Runnable objects associated with a thread's MessageQueue.Each Handler instance is associated with a single thread and that thread'smessage queue. When you create a new Handler, it is bound to the thread /message queue of the thread that is creating it -- from that point on, it willdeliver messages and runnables to that message queue and execute them as theycome out of the message queue.\n\n#### 4.1 Handler\n\n> There are two main uses for aHandler: (1) to schedule messages and runnables to be executed as some point inthe future; and (2) to enqueue an action to be performed on a different thread than your own.\n\nHandlerLooper(UI-ThreadLooper)\n\n#### 4.2 HandlerUI\n\nHandlerHandlerUIUIHandlerUISDK4UI()\n\n- Activity.runOnUiThread(Runnable)\n- View.post(Runnable)\n- View.postDelayed(Runnable, long)\n- UIHandler\n\n\n- HandlerHandler\n- LooperMessageQueueLooperLooperHandler\n- UIView.post\n- handler\n- handlerhandlerhandler\n- AndroidLooperUI\n- Looper.myLooper();      //Looper\n  Looper.getMainLooper() //UILooper\n- HandleLooperLooperLooper\n- Looper.prepare()Looper.loop();\n\n### 5.\n\n\n\n#### 5.1 \n~~~ Java\nMessage msg =mHandler.obtainMessage();\nmsg.what = what;\nmsg.sendToTarget();\n~~~\n\n#### 5.2 \n\n~~~ Java\nMessageQueue queue= mQueue;\n  if (queue != null){\n  msg.target =this;\n  sent =queue.enqueueMessage(msg, uptimeMillis);\n}\n~~~\nHandler.javasendMessageAtTime(Messagemsg, long uptimeMillis)MessageQueueMessagetargetMessageHandlerMessage\n\n#### 5.3 \n~~~ Java\nLooper me =myLooper();\nMessageQueue queue= me.mQueue;\nwhile (true) {\n  Message msg =queue.next(); // might block\n  if (msg !=null) {\n    if(msg.target == null) {\n      // Notarget is a magic identifier for the quit message.\n      return;\n    }\n    msg.target.dispatchMessage(msg);\n    msg.recycle();\n  }\n}\n~~~\n\nLooper.javaloop()MessageQueuenextMessageMessagetargetHandlerdispatchMessage\n\n#### 5.4 \n~~~ Java\nif (msg.callback!= null) {\n  handleCallback(msg);\n} else {\n  if (mCallback!= null) {\n    if(mCallback.handleMessage(msg)) {\n      return;\n    }\n  }\n handleMessage(msg);\n}\n~~~\nHandler.javadispatchMessage(Messagemsg)handleMessageMessageHandlerhandleMessage(Messagemsg)\ndispatchMessage\nMessageHandlerMessageQueueLooperHandler\n\nView.post(Runnable)\n\n- post(Runnableaction)ViewUIHandleractionpostHandler\n- HandleractionMessageMessagecallbackactionUI\n-  HandlerMessagemCallback.handleMessagerunnablerun\n- UIUI\n\n\n### 5.HandlerThread\nHandlerThreadThreadLooperLooperHandler\n\nHandlerThreadstart()HandlerHandlerThreadlooper\n\n~~~ Java\nHandlerThread thread = new HandlerThread(\"MyHandlerThread\");\nthread.start();\nmHandler = new Handler(thread.getLooper());\nmHandler.post(new Runnable(){...});\n~~~\n\nHandlerHandlerThreadUIHandlerUI\n\nHandlerThreadhandlerThread.quit()\n\n\n\n~~~ Java\npublic class HandlerThreadActivity extends Activity {\n    private static final String TAG = \"HandlerThreadActivity\";\n    private HandlerThreadmHandlerThread;\n    private MyHandler mMyHandler;\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n       // TODO Auto-generatedmethod stub\n       super.onCreate(savedInstanceState);\n       TextView text = new TextView(this);\n       text.setText(\"HandlerThreadActivity\");\n       setContentView(text);\n\n       Log.d(TAG, \"The mainthread id = \" + Thread.currentThread().getId());\n\n       //HandlerThreadLooper\n       //Android\n       mHandlerThread = new HandlerThread(\"handler_thread\");\n\n       //HandlerThreadgetLooper()start();\n       mHandlerThread.start();\n       //HandlermHandlerThread\n       mMyHandler = new MyHandler(mHandlerThread.getLooper());\n\n       mMyHandler.sendEmptyMessage(1);\n    }\n\n    private class MyHandler extends Handler {\n\n       public MyHandler(Looper looper) {\n           super(looper);\n       }\n\n       @Override\n       public void handleMessage(Message msg) {\n           Log.d(TAG, \"MyHandler-->handleMessage-->threadid = \" + Thread.currentThread().getId());\n           super.handleMessage(msg);\n       }\n    }\n}\n~~~\n","slug":"ThreadLocal-HandlerThread-Looper","published":1,"date":"2016-09-04T16:00:00.000Z","updated":"2017-11-23T07:06:42.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ebxr001bd6yk8m389gx8","content":"<h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h3><pre><code>AndroidUIWorkThreadUIMainThread\n</code></pre><p>handler Message MessageQueueLooper MessageHandlerHandler </p>\n<h3 id=\"2-ThreadLocal\"><a href=\"#2-ThreadLocal\" class=\"headerlink\" title=\"2.ThreadLocal\"></a>2.ThreadLocal<t></t></h3><p>ThreadThreadLocal.ThreadLocalMap threadLocals mapkeyThreadLocalvalueThreadLocalThreadLocal putThreadLocal getThreadmapkeyThreadmapLocalThreadThreadLocalThread</p>\n<a id=\"more\"></a>\n<p>mapmapbeanThreadLocal </p>\n<p>ThreadLocal</p>\n<p><a href=\"http://www.jianshu.com/p/08cb3665972f\" target=\"_blank\" rel=\"external\">Android  HandlerLooperHandlerThread </a></p>\n<h3 id=\"3-Looper\"><a href=\"#3-Looper\" class=\"headerlink\" title=\"3.Looper\"></a>3.Looper</h3><p>LooperAndroid handlerLooper<br>Looperprivate static final ThreadLocal sThreadLocal = new ThreadLocal();<br>AndroidThreadLocalLooper.preparesThreadLocalkeynewloopervalue putmapLooper.loopsThreadLocalLooperMessageQueueMessagemessageHandler</p>\n<h3 id=\"4-Handler\"><a href=\"#4-Handler\" class=\"headerlink\" title=\"4.Handler\"></a>4.Handler</h3><p>SDKHandler</p>\n<blockquote>\n<p>A Handler allows you to sendand process Messageand Runnable objects associated with a threads MessageQueue.Each Handler instance is associated with a single thread and that threadsmessage queue. When you create a new Handler, it is bound to the thread /message queue of the thread that is creating it  from that point on, it willdeliver messages and runnables to that message queue and execute them as theycome out of the message queue.</p>\n</blockquote>\n<h4 id=\"4-1-Handler\"><a href=\"#4-1-Handler\" class=\"headerlink\" title=\"4.1 Handler\"></a>4.1 Handler</h4><blockquote>\n<p>There are two main uses for aHandler: (1) to schedule messages and runnables to be executed as some point inthe future; and (2) to enqueue an action to be performed on a different thread than your own.</p>\n</blockquote>\n<p>HandlerLooper(UI-ThreadLooper)</p>\n<h4 id=\"4-2-HandlerUI\"><a href=\"#4-2-HandlerUI\" class=\"headerlink\" title=\"4.2 HandlerUI\"></a>4.2 HandlerUI</h4><p>HandlerHandlerUIUIHandlerUISDK4UI()</p>\n<ul>\n<li>Activity.runOnUiThread(Runnable)</li>\n<li>View.post(Runnable)</li>\n<li>View.postDelayed(Runnable, long)</li>\n<li>UIHandler</li>\n</ul>\n<p></p>\n<ul>\n<li>HandlerHandler</li>\n<li>LooperMessageQueueLooperLooperHandler</li>\n<li>UIView.post</li>\n<li>handler</li>\n<li>handlerhandlerhandler</li>\n<li>AndroidLooperUI</li>\n<li>Looper.myLooper();      //Looper<br>Looper.getMainLooper() //UILooper</li>\n<li>HandleLooperLooperLooper</li>\n<li>Looper.prepare()Looper.loop();</li>\n</ul>\n<h3 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5.\"></a>5.</h3><p></p>\n<h4 id=\"5-1-\"><a href=\"#5-1-\" class=\"headerlink\" title=\"5.1 \"></a>5.1 </h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Message msg =mHandler.obtainMessage();</div><div class=\"line\">msg.what = what;</div><div class=\"line\">msg.sendToTarget();</div></pre></td></tr></table></figure>\n<h4 id=\"5-2-\"><a href=\"#5-2-\" class=\"headerlink\" title=\"5.2 \"></a>5.2 </h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">MessageQueue queue= mQueue;</div><div class=\"line\">  <span class=\"keyword\">if</span> (queue != <span class=\"keyword\">null</span>)&#123;</div><div class=\"line\">  msg.target =<span class=\"keyword\">this</span>;</div><div class=\"line\">  sent =queue.enqueueMessage(msg, uptimeMillis);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>Handler.javasendMessageAtTime(Messagemsg, long uptimeMillis)MessageQueueMessagetargetMessageHandlerMessage</p>\n<h4 id=\"5-3-\"><a href=\"#5-3-\" class=\"headerlink\" title=\"5.3 \"></a>5.3 </h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Looper me =myLooper();</div><div class=\"line\">MessageQueue queue= me.mQueue;</div><div class=\"line\"><span class=\"keyword\">while</span> (<span class=\"keyword\">true</span>) &#123;</div><div class=\"line\">  Message msg =queue.next(); <span class=\"comment\">// might block</span></div><div class=\"line\">  <span class=\"keyword\">if</span> (msg !=<span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">    <span class=\"keyword\">if</span>(msg.target == <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">      <span class=\"comment\">// Notarget is a magic identifier for the quit message.</span></div><div class=\"line\">      <span class=\"keyword\">return</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\">    msg.target.dispatchMessage(msg);</div><div class=\"line\">    msg.recycle();</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>Looper.javaloop()MessageQueuenextMessageMessagetargetHandlerdispatchMessage</p>\n<h4 id=\"5-4-\"><a href=\"#5-4-\" class=\"headerlink\" title=\"5.4 \"></a>5.4 </h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">if</span> (msg.callback!= <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">  handleCallback(msg);</div><div class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">  <span class=\"keyword\">if</span> (mCallback!= <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">    <span class=\"keyword\">if</span>(mCallback.handleMessage(msg)) &#123;</div><div class=\"line\">      <span class=\"keyword\">return</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\">  &#125;</div><div class=\"line\"> handleMessage(msg);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>Handler.javadispatchMessage(Messagemsg)handleMessageMessageHandlerhandleMessage(Messagemsg)<br>dispatchMessage<br>MessageHandlerMessageQueueLooperHandler</p>\n<p>View.post(Runnable)</p>\n<ul>\n<li>post(Runnableaction)ViewUIHandleractionpostHandler</li>\n<li>HandleractionMessageMessagecallbackactionUI</li>\n<li> HandlerMessagemCallback.handleMessagerunnablerun</li>\n<li>UIUI</li>\n</ul>\n<h3 id=\"5-HandlerThread\"><a href=\"#5-HandlerThread\" class=\"headerlink\" title=\"5.HandlerThread\"></a>5.HandlerThread</h3><p>HandlerThreadThreadLooperLooperHandler</p>\n<p>HandlerThreadstart()HandlerHandlerThreadlooper</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">HandlerThread thread = <span class=\"keyword\">new</span> HandlerThread(<span class=\"string\">\"MyHandlerThread\"</span>);</div><div class=\"line\">thread.start();</div><div class=\"line\">mHandler = <span class=\"keyword\">new</span> Handler(thread.getLooper());</div><div class=\"line\">mHandler.post(<span class=\"keyword\">new</span> Runnable()&#123;...&#125;);</div></pre></td></tr></table></figure>\n<p>HandlerHandlerThreadUIHandlerUI</p>\n<p>HandlerThreadhandlerThread.quit()</p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">HandlerThreadActivity</span> <span class=\"keyword\">extends</span> <span class=\"title\">Activity</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String TAG = <span class=\"string\">\"HandlerThreadActivity\"</span>;</div><div class=\"line\">    <span class=\"keyword\">private</span> HandlerThreadmHandlerThread;</div><div class=\"line\">    <span class=\"keyword\">private</span> MyHandler mMyHandler;</div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">onCreate</span><span class=\"params\">(Bundle savedInstanceState)</span> </span>&#123;</div><div class=\"line\">       <span class=\"comment\">// TODO Auto-generatedmethod stub</span></div><div class=\"line\">       <span class=\"keyword\">super</span>.onCreate(savedInstanceState);</div><div class=\"line\">       TextView text = <span class=\"keyword\">new</span> TextView(<span class=\"keyword\">this</span>);</div><div class=\"line\">       text.setText(<span class=\"string\">\"HandlerThreadActivity\"</span>);</div><div class=\"line\">       setContentView(text);</div><div class=\"line\"></div><div class=\"line\">       Log.d(TAG, <span class=\"string\">\"The mainthread id = \"</span> + Thread.currentThread().getId());</div><div class=\"line\"></div><div class=\"line\">       <span class=\"comment\">//HandlerThreadLooper</span></div><div class=\"line\">       <span class=\"comment\">//Android</span></div><div class=\"line\">       mHandlerThread = <span class=\"keyword\">new</span> HandlerThread(<span class=\"string\">\"handler_thread\"</span>);</div><div class=\"line\"></div><div class=\"line\">       <span class=\"comment\">//HandlerThreadgetLooper()start();</span></div><div class=\"line\">       mHandlerThread.start();</div><div class=\"line\">       <span class=\"comment\">//HandlermHandlerThread</span></div><div class=\"line\">       mMyHandler = <span class=\"keyword\">new</span> MyHandler(mHandlerThread.getLooper());</div><div class=\"line\"></div><div class=\"line\">       mMyHandler.sendEmptyMessage(<span class=\"number\">1</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyHandler</span> <span class=\"keyword\">extends</span> <span class=\"title\">Handler</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MyHandler</span><span class=\"params\">(Looper looper)</span> </span>&#123;</div><div class=\"line\">           <span class=\"keyword\">super</span>(looper);</div><div class=\"line\">       &#125;</div><div class=\"line\"></div><div class=\"line\">       <span class=\"meta\">@Override</span></div><div class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">handleMessage</span><span class=\"params\">(Message msg)</span> </span>&#123;</div><div class=\"line\">           Log.d(TAG, <span class=\"string\">\"MyHandler--&gt;handleMessage--&gt;threadid = \"</span> + Thread.currentThread().getId());</div><div class=\"line\">           <span class=\"keyword\">super</span>.handleMessage(msg);</div><div class=\"line\">       &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/09/05/ThreadLocal-HandlerThread-Looper/\">http://agehua.github.io/2016/09/05/ThreadLocal-HandlerThread-Looper/</a></p>\n","readingTime":{"text":"3 min read","minutes":2.885,"time":173100,"words":577},"excerpt":"<h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h3><pre><code>AndroidUIWorkThreadUIMainThread\n</code></pre><p>handler Message MessageQueueLooper MessageHandlerHandler </p>\n<h3 id=\"2-ThreadLocal\"><a href=\"#2-ThreadLocal\" class=\"headerlink\" title=\"2.ThreadLocal\"></a>2.ThreadLocal<T></h3><p>ThreadThreadLocal.ThreadLocalMap threadLocals mapkeyThreadLocalvalueThreadLocalThreadLocal putThreadLocal getThreadmapkeyThreadmapLocalThreadThreadLocalThread</p>","more":"<p>mapmapbeanThreadLocal </p>\n<p>ThreadLocal</p>\n<p><a href=\"http://www.jianshu.com/p/08cb3665972f\">Android  HandlerLooperHandlerThread </a></p>\n<h3 id=\"3-Looper\"><a href=\"#3-Looper\" class=\"headerlink\" title=\"3.Looper\"></a>3.Looper</h3><p>LooperAndroid handlerLooper<br>Looperprivate static final ThreadLocal sThreadLocal = new ThreadLocal();<br>AndroidThreadLocalLooper.preparesThreadLocalkeynewloopervalue putmapLooper.loopsThreadLocalLooperMessageQueueMessagemessageHandler</p>\n<h3 id=\"4-Handler\"><a href=\"#4-Handler\" class=\"headerlink\" title=\"4.Handler\"></a>4.Handler</h3><p>SDKHandler</p>\n<blockquote>\n<p>A Handler allows you to sendand process Messageand Runnable objects associated with a threads MessageQueue.Each Handler instance is associated with a single thread and that threadsmessage queue. When you create a new Handler, it is bound to the thread /message queue of the thread that is creating it  from that point on, it willdeliver messages and runnables to that message queue and execute them as theycome out of the message queue.</p>\n</blockquote>\n<h4 id=\"4-1-Handler\"><a href=\"#4-1-Handler\" class=\"headerlink\" title=\"4.1 Handler\"></a>4.1 Handler</h4><blockquote>\n<p>There are two main uses for aHandler: (1) to schedule messages and runnables to be executed as some point inthe future; and (2) to enqueue an action to be performed on a different thread than your own.</p>\n</blockquote>\n<p>HandlerLooper(UI-ThreadLooper)</p>\n<h4 id=\"4-2-HandlerUI\"><a href=\"#4-2-HandlerUI\" class=\"headerlink\" title=\"4.2 HandlerUI\"></a>4.2 HandlerUI</h4><p>HandlerHandlerUIUIHandlerUISDK4UI()</p>\n<ul>\n<li>Activity.runOnUiThread(Runnable)</li>\n<li>View.post(Runnable)</li>\n<li>View.postDelayed(Runnable, long)</li>\n<li>UIHandler</li>\n</ul>\n<p></p>\n<ul>\n<li>HandlerHandler</li>\n<li>LooperMessageQueueLooperLooperHandler</li>\n<li>UIView.post</li>\n<li>handler</li>\n<li>handlerhandlerhandler</li>\n<li>AndroidLooperUI</li>\n<li>Looper.myLooper();      //Looper<br>Looper.getMainLooper() //UILooper</li>\n<li>HandleLooperLooperLooper</li>\n<li>Looper.prepare()Looper.loop();</li>\n</ul>\n<h3 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5.\"></a>5.</h3><p></p>\n<h4 id=\"5-1-\"><a href=\"#5-1-\" class=\"headerlink\" title=\"5.1 \"></a>5.1 </h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Message msg =mHandler.obtainMessage();</div><div class=\"line\">msg.what = what;</div><div class=\"line\">msg.sendToTarget();</div></pre></td></tr></table></figure>\n<h4 id=\"5-2-\"><a href=\"#5-2-\" class=\"headerlink\" title=\"5.2 \"></a>5.2 </h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">MessageQueue queue= mQueue;</div><div class=\"line\">  <span class=\"keyword\">if</span> (queue != <span class=\"keyword\">null</span>)&#123;</div><div class=\"line\">  msg.target =<span class=\"keyword\">this</span>;</div><div class=\"line\">  sent =queue.enqueueMessage(msg, uptimeMillis);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>Handler.javasendMessageAtTime(Messagemsg, long uptimeMillis)MessageQueueMessagetargetMessageHandlerMessage</p>\n<h4 id=\"5-3-\"><a href=\"#5-3-\" class=\"headerlink\" title=\"5.3 \"></a>5.3 </h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Looper me =myLooper();</div><div class=\"line\">MessageQueue queue= me.mQueue;</div><div class=\"line\"><span class=\"keyword\">while</span> (<span class=\"keyword\">true</span>) &#123;</div><div class=\"line\">  Message msg =queue.next(); <span class=\"comment\">// might block</span></div><div class=\"line\">  <span class=\"keyword\">if</span> (msg !=<span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">    <span class=\"keyword\">if</span>(msg.target == <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">      <span class=\"comment\">// Notarget is a magic identifier for the quit message.</span></div><div class=\"line\">      <span class=\"keyword\">return</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\">    msg.target.dispatchMessage(msg);</div><div class=\"line\">    msg.recycle();</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>Looper.javaloop()MessageQueuenextMessageMessagetargetHandlerdispatchMessage</p>\n<h4 id=\"5-4-\"><a href=\"#5-4-\" class=\"headerlink\" title=\"5.4 \"></a>5.4 </h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">if</span> (msg.callback!= <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">  handleCallback(msg);</div><div class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">  <span class=\"keyword\">if</span> (mCallback!= <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">    <span class=\"keyword\">if</span>(mCallback.handleMessage(msg)) &#123;</div><div class=\"line\">      <span class=\"keyword\">return</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\">  &#125;</div><div class=\"line\"> handleMessage(msg);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>Handler.javadispatchMessage(Messagemsg)handleMessageMessageHandlerhandleMessage(Messagemsg)<br>dispatchMessage<br>MessageHandlerMessageQueueLooperHandler</p>\n<p>View.post(Runnable)</p>\n<ul>\n<li>post(Runnableaction)ViewUIHandleractionpostHandler</li>\n<li>HandleractionMessageMessagecallbackactionUI</li>\n<li> HandlerMessagemCallback.handleMessagerunnablerun</li>\n<li>UIUI</li>\n</ul>\n<h3 id=\"5-HandlerThread\"><a href=\"#5-HandlerThread\" class=\"headerlink\" title=\"5.HandlerThread\"></a>5.HandlerThread</h3><p>HandlerThreadThreadLooperLooperHandler</p>\n<p>HandlerThreadstart()HandlerHandlerThreadlooper</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">HandlerThread thread = <span class=\"keyword\">new</span> HandlerThread(<span class=\"string\">\"MyHandlerThread\"</span>);</div><div class=\"line\">thread.start();</div><div class=\"line\">mHandler = <span class=\"keyword\">new</span> Handler(thread.getLooper());</div><div class=\"line\">mHandler.post(<span class=\"keyword\">new</span> Runnable()&#123;...&#125;);</div></pre></td></tr></table></figure>\n<p>HandlerHandlerThreadUIHandlerUI</p>\n<p>HandlerThreadhandlerThread.quit()</p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">HandlerThreadActivity</span> <span class=\"keyword\">extends</span> <span class=\"title\">Activity</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String TAG = <span class=\"string\">\"HandlerThreadActivity\"</span>;</div><div class=\"line\">    <span class=\"keyword\">private</span> HandlerThreadmHandlerThread;</div><div class=\"line\">    <span class=\"keyword\">private</span> MyHandler mMyHandler;</div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">onCreate</span><span class=\"params\">(Bundle savedInstanceState)</span> </span>&#123;</div><div class=\"line\">       <span class=\"comment\">// TODO Auto-generatedmethod stub</span></div><div class=\"line\">       <span class=\"keyword\">super</span>.onCreate(savedInstanceState);</div><div class=\"line\">       TextView text = <span class=\"keyword\">new</span> TextView(<span class=\"keyword\">this</span>);</div><div class=\"line\">       text.setText(<span class=\"string\">\"HandlerThreadActivity\"</span>);</div><div class=\"line\">       setContentView(text);</div><div class=\"line\"></div><div class=\"line\">       Log.d(TAG, <span class=\"string\">\"The mainthread id = \"</span> + Thread.currentThread().getId());</div><div class=\"line\"></div><div class=\"line\">       <span class=\"comment\">//HandlerThreadLooper</span></div><div class=\"line\">       <span class=\"comment\">//Android</span></div><div class=\"line\">       mHandlerThread = <span class=\"keyword\">new</span> HandlerThread(<span class=\"string\">\"handler_thread\"</span>);</div><div class=\"line\"></div><div class=\"line\">       <span class=\"comment\">//HandlerThreadgetLooper()start();</span></div><div class=\"line\">       mHandlerThread.start();</div><div class=\"line\">       <span class=\"comment\">//HandlermHandlerThread</span></div><div class=\"line\">       mMyHandler = <span class=\"keyword\">new</span> MyHandler(mHandlerThread.getLooper());</div><div class=\"line\"></div><div class=\"line\">       mMyHandler.sendEmptyMessage(<span class=\"number\">1</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyHandler</span> <span class=\"keyword\">extends</span> <span class=\"title\">Handler</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MyHandler</span><span class=\"params\">(Looper looper)</span> </span>&#123;</div><div class=\"line\">           <span class=\"keyword\">super</span>(looper);</div><div class=\"line\">       &#125;</div><div class=\"line\"></div><div class=\"line\">       <span class=\"meta\">@Override</span></div><div class=\"line\">       <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">handleMessage</span><span class=\"params\">(Message msg)</span> </span>&#123;</div><div class=\"line\">           Log.d(TAG, <span class=\"string\">\"MyHandler--&gt;handleMessage--&gt;threadid = \"</span> + Thread.currentThread().getId());</div><div class=\"line\">           <span class=\"keyword\">super</span>.handleMessage(msg);</div><div class=\"line\">       &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/09/05/ThreadLocal-HandlerThread-Looper/\">http://agehua.github.io/2016/09/05/ThreadLocal-HandlerThread-Looper/</a></p>"},{"layout":"post","title":"apkadmob","keywords":"admob, ","banner":"http://obxk8w81b.bkt.clouddn.com/Blossoming%20Pear%20Tree.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Blossoming%20Pear%20Tree.jpg","_content":"\n\n### \n\n[antivirus-for-android](http://www.avg.com/no-en/antivirus-for-android)apkAVGunwanted software\n\n\nBeware of Adware! 1 Types of Adware Detected\nLast reported adware activity:\tSep 16\nDays with adware in last 30:\t1 days\n\n\n\n<!--more-->\n\n![avg_warning](http://oui2w5whj.bkt.clouddn.com/blogimages/2016/avg_warning.PNG)\n\n### \n\n[](https://play.google.com/store/apps/details?id=imoblife.toolbox.full&hl=zh)apkadmob\n\napkAndroidManifestGoogle AdMobcom.google.ads.AdView\n\n\n\ngoogle servicejarads\n![google_servcie_ads](http://oui2w5whj.bkt.clouddn.com/blogimages/2016/google_servcie_ads.PNG)\n\nadsapkadmob\n","source":"_posts/2016-09-20-AVG-unwanted-software.md","raw":"---\nlayout: post\ntitle:  apkadmob\ncategory: accumulation\ntags:\n  - ANDROID\n  - remove admob\nkeywords: admob, \nbanner: http://obxk8w81b.bkt.clouddn.com/Blossoming%20Pear%20Tree.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Blossoming%20Pear%20Tree.jpg\n---\n\n\n### \n\n[antivirus-for-android](http://www.avg.com/no-en/antivirus-for-android)apkAVGunwanted software\n\n\nBeware of Adware! 1 Types of Adware Detected\nLast reported adware activity:\tSep 16\nDays with adware in last 30:\t1 days\n\n\n\n<!--more-->\n\n![avg_warning](http://oui2w5whj.bkt.clouddn.com/blogimages/2016/avg_warning.PNG)\n\n### \n\n[](https://play.google.com/store/apps/details?id=imoblife.toolbox.full&hl=zh)apkadmob\n\napkAndroidManifestGoogle AdMobcom.google.ads.AdView\n\n\n\ngoogle servicejarads\n![google_servcie_ads](http://oui2w5whj.bkt.clouddn.com/blogimages/2016/google_servcie_ads.PNG)\n\nadsapkadmob\n","slug":"AVG-unwanted-software","published":1,"date":"2016-09-19T16:00:00.000Z","updated":"2017-11-23T07:24:46.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ebxy001fd6ykge65rgq0","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"http://www.avg.com/no-en/antivirus-for-android\" target=\"_blank\" rel=\"external\">antivirus-for-android</a>apkAVGunwanted software</p>\n<p><br>Beware of Adware! 1 Types of Adware Detected<br>Last reported adware activity:    Sep 16<br>Days with adware in last 30:    1 days</p>\n<p></p>\n<a id=\"more\"></a>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2016/avg_warning.PNG\" alt=\"avg_warning\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"https://play.google.com/store/apps/details?id=imoblife.toolbox.full&amp;hl=zh\" target=\"_blank\" rel=\"external\"></a>apkadmob</p>\n<p>apkAndroidManifestGoogle AdMobcom.google.ads.AdView</p>\n<p></p>\n<p>google servicejarads<br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2016/google_servcie_ads.PNG\" alt=\"google_servcie_ads\"></p>\n<p>adsapkadmob</p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/09/20/AVG-unwanted-software/\">http://agehua.github.io/2016/09/20/AVG-unwanted-software/</a></p>\n","readingTime":{"text":"1 min read","minutes":0.285,"time":17099.999999999996,"words":57},"excerpt":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"http://www.avg.com/no-en/antivirus-for-android\">antivirus-for-android</a>apkAVGunwanted software</p>\n<p><br>Beware of Adware! 1 Types of Adware Detected<br>Last reported adware activity:    Sep 16<br>Days with adware in last 30:    1 days</p>\n<p></p>","more":"<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2016/avg_warning.PNG\" alt=\"avg_warning\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"https://play.google.com/store/apps/details?id=imoblife.toolbox.full&amp;hl=zh\"></a>apkadmob</p>\n<p>apkAndroidManifestGoogle AdMobcom.google.ads.AdView</p>\n<p></p>\n<p>google servicejarads<br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2016/google_servcie_ads.PNG\" alt=\"google_servcie_ads\"></p>\n<p>adsapkadmob</p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/09/20/AVG-unwanted-software/\">http://agehua.github.io/2016/09/20/AVG-unwanted-software/</a></p>"},{"layout":"post","title":"ANDROID","keywords":", ANDROID","banner":"http://obxk8w81b.bkt.clouddn.com/Blossoming%20Almond%20Tree.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Blossoming%20Almond%20Tree.jpg","_content":"\n### \n\n[stormzhang ANDROID ](http://stormzhang.com/designpattern/2016/03/27/android-design-pattern-singleton/)\n\n\n### \n\nDesign Pattern23Android\n\n<!--more-->\n#### \n\n~~~ Java\npublic class Singleton{\n\n    private static Singleton instance = new Singleton();\n\n    private Singleton(){}\n\n    public static Singleton newInstance(){\n        return instance;\n    }\n}\n~~~\n\n  \n\n#### \n\n~~~ Java\npublic class Singleton{\n    private static Singleton instance = null;\n\n    private Singleton(){}\n\n    public static Singleton newInstance(){\n        if(null == instance){\n            instance = new Singleton();\n        }\n        return instance;\n    }\n}\n~~~\n\n\n\n### \n\n\n\nJVM newInstance\n\n\n\n#### \n\n~~~ Java\npublic class Singleton {\n\n    private static Singleton instance = null;\n\n    private Singleton(){\n    }\n\n    public static Singleton getInstance() {\n        synchronized (Singleton.class) {\n            if (instance == null) {\n                instance = new Singleton();\n            }\n        }\n\n        return instance;\n    }\n}\n~~~\n\nsynchronized (Singleton.class)instanceAndroid\n\n#### InputMethodManager\n\n~~~ Java\npublic final class InputMethodManager {\n    //  \n    static InputMethodManager sInstance;\n\n    //api  \n    public static InputMethodManager getInstance() {\n        synchronized (InputMethodManager.class) {\n            if (sInstance == null) {\n                IBinder b = ServiceManager.getService(Context.INPUT_METHOD_SERVICE);\n                IInputMethodManager service = IInputMethodManager.Stub.asInterface(b);\n                sInstance = new InputMethodManager(service, Looper.getMainLooper());\n            }\n            return sInstance;\n        }\n    }\n}\n~~~\n\nAndroid\n\n\n\n#### \n\n~~~ Java\npublic class Singleton {\n\n    private static volatile Singleton instance = null;\n\n    private Singleton(){\n    }\n\n    public static Singleton getInstance() {\n        // if already inited, no need to get lock everytime\n        if (instance == null) {\n            synchronized (Singleton.class) {\n                if (instance == null) {\n                    instance = new Singleton();\n                }\n            }\n        }\n\n        return instance;\n    }\n}\n~~~\n\nsynchronized (Singleton.class)ifinstancesynchronized (Singleton.class)\n\n JVMJVM\n\nstatic{}\nfinal\n\nJVM\n\n JVM \n\n\n\n#### \n\n~~~ Java\npublic class Singleton{\n    //\n    private static class SingletonHolder{\n        public static Singleton instance = new Singleton();\n    }\n\n    private Singleton(){}\n\n    public static Singleton newInstance(){\n        return SingletonHolder.instance;\n    }\n\n    public void doSomething(){\n        //do something\n    }\n}\n~~~\n\n\n\nEffective Java\n\n#### \n\n~~~ Java\npublic enum Singleton{\n    //Singleton\n    instance;\n\n    public void doSomething(){\n        // do something ...\n    }    \n}\n~~~\n\n\n\n~~~ Java\npublic static void main(String[] args){\n   Singleton singleton = Singleton.instance;\n   singleton.doSomething();\n}\n~~~\n\n(JVM), \n\n### \n\n5\n","source":"_posts/2016-09-20-android-design-pattern-singleton.md","raw":"---\nlayout: post\ntitle:  ANDROID\ncategory: accumulation\ntags:\n  - ANDROID\n  - Singleton\nkeywords: , ANDROID\nbanner: http://obxk8w81b.bkt.clouddn.com/Blossoming%20Almond%20Tree.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Blossoming%20Almond%20Tree.jpg\n---\n\n### \n\n[stormzhang ANDROID ](http://stormzhang.com/designpattern/2016/03/27/android-design-pattern-singleton/)\n\n\n### \n\nDesign Pattern23Android\n\n<!--more-->\n#### \n\n~~~ Java\npublic class Singleton{\n\n    private static Singleton instance = new Singleton();\n\n    private Singleton(){}\n\n    public static Singleton newInstance(){\n        return instance;\n    }\n}\n~~~\n\n  \n\n#### \n\n~~~ Java\npublic class Singleton{\n    private static Singleton instance = null;\n\n    private Singleton(){}\n\n    public static Singleton newInstance(){\n        if(null == instance){\n            instance = new Singleton();\n        }\n        return instance;\n    }\n}\n~~~\n\n\n\n### \n\n\n\nJVM newInstance\n\n\n\n#### \n\n~~~ Java\npublic class Singleton {\n\n    private static Singleton instance = null;\n\n    private Singleton(){\n    }\n\n    public static Singleton getInstance() {\n        synchronized (Singleton.class) {\n            if (instance == null) {\n                instance = new Singleton();\n            }\n        }\n\n        return instance;\n    }\n}\n~~~\n\nsynchronized (Singleton.class)instanceAndroid\n\n#### InputMethodManager\n\n~~~ Java\npublic final class InputMethodManager {\n    //  \n    static InputMethodManager sInstance;\n\n    //api  \n    public static InputMethodManager getInstance() {\n        synchronized (InputMethodManager.class) {\n            if (sInstance == null) {\n                IBinder b = ServiceManager.getService(Context.INPUT_METHOD_SERVICE);\n                IInputMethodManager service = IInputMethodManager.Stub.asInterface(b);\n                sInstance = new InputMethodManager(service, Looper.getMainLooper());\n            }\n            return sInstance;\n        }\n    }\n}\n~~~\n\nAndroid\n\n\n\n#### \n\n~~~ Java\npublic class Singleton {\n\n    private static volatile Singleton instance = null;\n\n    private Singleton(){\n    }\n\n    public static Singleton getInstance() {\n        // if already inited, no need to get lock everytime\n        if (instance == null) {\n            synchronized (Singleton.class) {\n                if (instance == null) {\n                    instance = new Singleton();\n                }\n            }\n        }\n\n        return instance;\n    }\n}\n~~~\n\nsynchronized (Singleton.class)ifinstancesynchronized (Singleton.class)\n\n JVMJVM\n\nstatic{}\nfinal\n\nJVM\n\n JVM \n\n\n\n#### \n\n~~~ Java\npublic class Singleton{\n    //\n    private static class SingletonHolder{\n        public static Singleton instance = new Singleton();\n    }\n\n    private Singleton(){}\n\n    public static Singleton newInstance(){\n        return SingletonHolder.instance;\n    }\n\n    public void doSomething(){\n        //do something\n    }\n}\n~~~\n\n\n\nEffective Java\n\n#### \n\n~~~ Java\npublic enum Singleton{\n    //Singleton\n    instance;\n\n    public void doSomething(){\n        // do something ...\n    }    \n}\n~~~\n\n\n\n~~~ Java\npublic static void main(String[] args){\n   Singleton singleton = Singleton.instance;\n   singleton.doSomething();\n}\n~~~\n\n(JVM), \n\n### \n\n5\n","slug":"android-design-pattern-singleton","published":1,"date":"2016-09-19T16:00:00.000Z","updated":"2017-11-23T07:24:42.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7eby8001id6ykckgrycuh","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"http://stormzhang.com/designpattern/2016/03/27/android-design-pattern-singleton/\" target=\"_blank\" rel=\"external\">stormzhang ANDROID </a><br></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Design Pattern23Android</p>\n<a id=\"more\"></a>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Singleton</span></span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Singleton instance = <span class=\"keyword\">new</span> Singleton();</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Singleton</span><span class=\"params\">()</span></span>&#123;&#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Singleton <span class=\"title\">newInstance</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> instance;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>  </p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Singleton</span></span>&#123;</div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Singleton instance = <span class=\"keyword\">null</span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Singleton</span><span class=\"params\">()</span></span>&#123;&#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Singleton <span class=\"title\">newInstance</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"keyword\">null</span> == instance)&#123;</div><div class=\"line\">            instance = <span class=\"keyword\">new</span> Singleton();</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">return</span> instance;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p>JVM newInstance</p>\n<p></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Singleton</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Singleton instance = <span class=\"keyword\">null</span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Singleton</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Singleton <span class=\"title\">getInstance</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">synchronized</span> (Singleton.class) &#123;</div><div class=\"line\">            <span class=\"keyword\">if</span> (instance == <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">                instance = <span class=\"keyword\">new</span> Singleton();</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">return</span> instance;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>synchronized (Singleton.class)instanceAndroid</p>\n<h4 id=\"InputMethodManager\"><a href=\"#InputMethodManager\" class=\"headerlink\" title=\"InputMethodManager\"></a>InputMethodManager</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">InputMethodManager</span> </span>&#123;</div><div class=\"line\">    <span class=\"comment\">//  </span></div><div class=\"line\">    <span class=\"keyword\">static</span> InputMethodManager sInstance;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//api  </span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> InputMethodManager <span class=\"title\">getInstance</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">synchronized</span> (InputMethodManager.class) &#123;</div><div class=\"line\">            <span class=\"keyword\">if</span> (sInstance == <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">                IBinder b = ServiceManager.getService(Context.INPUT_METHOD_SERVICE);</div><div class=\"line\">                IInputMethodManager service = IInputMethodManager.Stub.asInterface(b);</div><div class=\"line\">                sInstance = <span class=\"keyword\">new</span> InputMethodManager(service, Looper.getMainLooper());</div><div class=\"line\">            &#125;</div><div class=\"line\">            <span class=\"keyword\">return</span> sInstance;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>Android</p>\n<p></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Singleton</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">volatile</span> Singleton instance = <span class=\"keyword\">null</span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Singleton</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Singleton <span class=\"title\">getInstance</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"comment\">// if already inited, no need to get lock everytime</span></div><div class=\"line\">        <span class=\"keyword\">if</span> (instance == <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">synchronized</span> (Singleton.class) &#123;</div><div class=\"line\">                <span class=\"keyword\">if</span> (instance == <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">                    instance = <span class=\"keyword\">new</span> Singleton();</div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">return</span> instance;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>synchronized (Singleton.class)ifinstancesynchronized (Singleton.class)</p>\n<p> JVMJVM</p>\n<p>static{}<br>final<br><br>JVM</p>\n<p> JVM </p>\n<p></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Singleton</span></span>&#123;</div><div class=\"line\">    <span class=\"comment\">//</span></div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SingletonHolder</span></span>&#123;</div><div class=\"line\">        <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Singleton instance = <span class=\"keyword\">new</span> Singleton();</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Singleton</span><span class=\"params\">()</span></span>&#123;&#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Singleton <span class=\"title\">newInstance</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> SingletonHolder.instance;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">doSomething</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">        <span class=\"comment\">//do something</span></div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p></p>\n<p>Effective Java</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">enum</span> Singleton&#123;</div><div class=\"line\">    <span class=\"comment\">//Singleton</span></div><div class=\"line\">    instance;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">doSomething</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">        <span class=\"comment\">// do something ...</span></div><div class=\"line\">    &#125;    </div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</div><div class=\"line\">   Singleton singleton = Singleton.instance;</div><div class=\"line\">   singleton.doSomething();</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>(JVM), </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>5</p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/09/20/android-design-pattern-singleton/\">http://agehua.github.io/2016/09/20/android-design-pattern-singleton/</a></p>\n","readingTime":{"text":"3 min read","minutes":2.9,"time":174000,"words":580},"excerpt":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"http://stormzhang.com/designpattern/2016/03/27/android-design-pattern-singleton/\">stormzhang ANDROID </a><br></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Design Pattern23Android</p>","more":"<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Singleton</span></span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Singleton instance = <span class=\"keyword\">new</span> Singleton();</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Singleton</span><span class=\"params\">()</span></span>&#123;&#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Singleton <span class=\"title\">newInstance</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> instance;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>  </p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Singleton</span></span>&#123;</div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Singleton instance = <span class=\"keyword\">null</span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Singleton</span><span class=\"params\">()</span></span>&#123;&#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Singleton <span class=\"title\">newInstance</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"keyword\">null</span> == instance)&#123;</div><div class=\"line\">            instance = <span class=\"keyword\">new</span> Singleton();</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">return</span> instance;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p>JVM newInstance</p>\n<p></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Singleton</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Singleton instance = <span class=\"keyword\">null</span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Singleton</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Singleton <span class=\"title\">getInstance</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">synchronized</span> (Singleton.class) &#123;</div><div class=\"line\">            <span class=\"keyword\">if</span> (instance == <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">                instance = <span class=\"keyword\">new</span> Singleton();</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">return</span> instance;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>synchronized (Singleton.class)instanceAndroid</p>\n<h4 id=\"InputMethodManager\"><a href=\"#InputMethodManager\" class=\"headerlink\" title=\"InputMethodManager\"></a>InputMethodManager</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">InputMethodManager</span> </span>&#123;</div><div class=\"line\">    <span class=\"comment\">//  </span></div><div class=\"line\">    <span class=\"keyword\">static</span> InputMethodManager sInstance;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//api  </span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> InputMethodManager <span class=\"title\">getInstance</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">synchronized</span> (InputMethodManager.class) &#123;</div><div class=\"line\">            <span class=\"keyword\">if</span> (sInstance == <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">                IBinder b = ServiceManager.getService(Context.INPUT_METHOD_SERVICE);</div><div class=\"line\">                IInputMethodManager service = IInputMethodManager.Stub.asInterface(b);</div><div class=\"line\">                sInstance = <span class=\"keyword\">new</span> InputMethodManager(service, Looper.getMainLooper());</div><div class=\"line\">            &#125;</div><div class=\"line\">            <span class=\"keyword\">return</span> sInstance;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>Android</p>\n<p></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Singleton</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">volatile</span> Singleton instance = <span class=\"keyword\">null</span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Singleton</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Singleton <span class=\"title\">getInstance</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"comment\">// if already inited, no need to get lock everytime</span></div><div class=\"line\">        <span class=\"keyword\">if</span> (instance == <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">synchronized</span> (Singleton.class) &#123;</div><div class=\"line\">                <span class=\"keyword\">if</span> (instance == <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">                    instance = <span class=\"keyword\">new</span> Singleton();</div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">return</span> instance;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>synchronized (Singleton.class)ifinstancesynchronized (Singleton.class)</p>\n<p> JVMJVM</p>\n<p>static{}<br>final<br><br>JVM</p>\n<p> JVM </p>\n<p></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Singleton</span></span>&#123;</div><div class=\"line\">    <span class=\"comment\">//</span></div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SingletonHolder</span></span>&#123;</div><div class=\"line\">        <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Singleton instance = <span class=\"keyword\">new</span> Singleton();</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Singleton</span><span class=\"params\">()</span></span>&#123;&#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Singleton <span class=\"title\">newInstance</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> SingletonHolder.instance;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">doSomething</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">        <span class=\"comment\">//do something</span></div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p></p>\n<p>Effective Java</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">enum</span> Singleton&#123;</div><div class=\"line\">    <span class=\"comment\">//Singleton</span></div><div class=\"line\">    instance;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">doSomething</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">        <span class=\"comment\">// do something ...</span></div><div class=\"line\">    &#125;    </div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</div><div class=\"line\">   Singleton singleton = Singleton.instance;</div><div class=\"line\">   singleton.doSomething();</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>(JVM), </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>5</p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/09/20/android-design-pattern-singleton/\">http://agehua.github.io/2016/09/20/android-design-pattern-singleton/</a></p>"},{"layout":"post","title":"JNIpublickey","keywords":"JNI, publickey","banner":"http://obxk8w81b.bkt.clouddn.com/Blossoming%20Almond%20Branch%20in%20a%20Glass%20with%20a%20Book.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Blossoming%20Almond%20Branch%20in%20a%20Glass%20with%20a%20Book.jpg","_content":"\n\n### 1.\n[JNI](http://agehua.github.io/2016/JNI-Learning)\nJNIPublickey\n\n### 2.JNIPublickey\n[github](https://github.com/MasonLiuChn/AndroidUltimateEncrypt)\n\n4.0.4publickey\n\n<!--more-->\n\nPublickey\n\n~~~ Java\nOpenSSLRSAPublicKey{modulus=a0d169cedabdaac3527c2099eeac4cbd74bb9b14c2571bcf6755f49e1d8c8439a37e009b0cb1b1ae9bf164dc976ddc4ee050621c746610d995185accbe8b3c09cc4f8c7afd990db47be814f7f45ec9c489be5b0933e89ff58070c29c98199331160bdb3a19e0687d36e850ee686c565737be4f61328264a58792e198d873b023ec11cb26a73305eea631ab18ec3ce746eb253e47c145503e933ee5da892326ecbb29b5a005aacef2d30d720611f7014aa3f2e40954b9e4deeaca1823dd2f7b2230670acabda70d2f14b1adc9480cf0a48d47866a1aa745ae97d0ab906cd76e5ab76916d03ef153b35edc2ae7284a613b3a3a312c73cf0b98e0ce9a8cf6a682fa,publicExponent=10001}\n~~~\n\nGT-S7568 Android4.0.4Publickey\n\n~~~ Java\nRSA Public Key\n      modulus: a0d169cedabdaac3527c2099eeaca0d169cedabdaac3527c2099eeac4cbd74bb9b14c2571bcf6755f49e1d8c8439a37e009b0cb1b1ae9bf164dc976ddc4ee050621c746610d995185accbe8b3c09cc4f8c7afd990db47be814f7f45ec9c489be5b0933e89ff58070c29c98199331160bdb3a19e0687d36e850ee686c565737be4f61328264a58792e198d873b023ec11cb6a73305eea631ab18ec3ce746eb23e47c145503e933ee5da892326ecbb29b5a005aacef2d30d720611f7014aa3f2e40954b9e4deeaca1823dd2f7b2230670acabda70d2f14b1adc9410cf0a48d47866a1aa745ae97d0ab906cd76e5ab76916d03ef153b35edc2ae7284a613b3a3a313c73cf0b98e0ce9a8cf6a682aff0b98e0ce9a8cf6a682fa\n      public exponent: 10001\n~~~\nmodulus**publicExponent****public exponent**\n\n\n\n~~~ C++\njmethodID substring_mid = env->GetMethodID(string_cls,\"substring\", \"(II)Ljava/lang/String;\");\njmethodID indexOf_mid = env->GetMethodID(string_cls,\"indexOf\", \"(Ljava/lang/String;)I\");\n\njint bb = env->CallIntMethod(publicKey_str,indexOf_mid,param2);\njstring publicKey2_str =NULL;\nif (bb ==-1){\n\tjstring param3 = env->NewStringUTF(\"public exponent\");\n\tjint cc = env->CallIntMethod(publicKey_str,indexOf_mid,param3);\n\t__android_log_print(ANDROID_LOG_ERROR, TAG, \"CC value is %d\", cc);\n\tpublicKey2_str= static_cast<jstring>(env->CallObjectMethod(publicKey_str,substring_mid,aa+8,cc-1));\n}else {\n\tpublicKey2_str = static_cast<jstring>(env->CallObjectMethod(publicKey_str,substring_mid,aa+8,bb-1));\n}\n~~~\n\n#### 2.1 JNI native\n\nJNIJNI\\__android_log_print\n\n~~~ C++\n__android_log_print(ANDROID_LOG_ERROR, TAG, \"PublicKey value is %s\",  jstringTostring(env,publicKey2_str));\n~~~\n\n- ANDROID_LOG_INFOANDROID_LOG_DEBUGANDROID_LOG_ERROR\n- LogCat\n- \n\njstringTostringjstringchar*\n\n~~~ C++\nchar* jstringTostring(JNIEnv* env, jstring jstr)\n{\n\tchar* rtn = NULL;\n  jclass clsstring = env->FindClass(\"java/lang/String\");\n  jstring strencode = env->NewStringUTF(\"utf-8\");\n  jmethodID mid = env->GetMethodID(clsstring, \"getBytes\", \"(Ljava/lang/String;)[B\");\n  jbyteArray barr= (jbyteArray)env->CallObjectMethod(jstr, mid, strencode);\n  jsize alen = env->GetArrayLength(barr);\n  jbyte* ba = env->GetByteArrayElements(barr, JNI_FALSE);\n  if (alen > 0)\n  {\n  rtn = (char*)malloc(alen + 1);\n\n  memcpy(rtn, ba, alen);\n  rtn[alen] = 0;\n  }\n  env->ReleaseByteArrayElements(barr, ba, 0);\n  return rtn;\n}\n~~~\n\njstringJavaNative TypeJavastring\n\nJNI\n[JNI ---- ](http://blog.csdn.net/qinjuning/article/details/7599796)\n\nJNI\n\n- 1..h\n.c:\n\n~~~ C++\n#include <android/log.h>\n\n#define LOG_TAG   \"From JNI ===>>\"\n~~~\n\n- 2.Android.mk\n:\n\n~~~ C++\nLOCAL_LDLIBS   := -lm -llog -ljnigraphics\n~~~\n\n\n\n[JNInativeeclipselogcat](http://www.cnblogs.com/liuling/p/2015-8-5-1.html)\n\n[JNILOGCAT Debug](http://blog.csdn.net/llwdslal/article/details/31733035)\n\n#### 2.2 \n\n\n\n~~~ C++\njstring getPublicKey(JNIEnv* env, jobject thiz,jobject context) {\n\tjclass context_cls = env->GetObjectClass(context);\n\n\tjmethodID get_package_manager_mid = env->GetMethodID(context_cls,\n\t\t\t\"getPackageManager\", \"()Landroid/content/pm/PackageManager;\");\n\n\tjmethodID get_package_name_mid = env->GetMethodID(context_cls,\n\t\t\t\"getPackageName\", \"()Ljava/lang/String;\");\n\tenv->DeleteLocalRef(context_cls);\n\tjobject pm_obj = env->CallObjectMethod(context, get_package_manager_mid);\n\tjclass pm_cls = env->FindClass(\"android/content/pm/PackageManager\");\n\n\tjmethodID get_package_info_mid = env->GetMethodID(pm_cls, \"getPackageInfo\",\n\t\t\t\"(Ljava/lang/String;I)Landroid/content/pm/PackageInfo;\");\n\tjstring package_name = reinterpret_cast<jstring>(env->CallObjectMethod(\n\t\t\tcontext, get_package_name_mid));\n\tjfieldID flag_fid = env->GetStaticFieldID(pm_cls, \"GET_SIGNATURES\", \"I\");\n\tjint flag = env->GetStaticIntField(pm_cls, flag_fid);\n\tenv->DeleteLocalRef(pm_cls);\n\tjobject pi_obj = env->CallObjectMethod(pm_obj, get_package_info_mid,\n\t\t\tpackage_name, flag);\n\tenv->DeleteLocalRef(package_name);\n\n\tjclass pi_cls = env->FindClass(\"android/content/pm/PackageInfo\");\n\tjfieldID signatures_fid = env->GetFieldID(pi_cls, \"signatures\",\n\t\t\t\"[Landroid/content/pm/Signature;\");\n\tenv->DeleteLocalRef(pi_cls);\n\tjobject sig_obj = env->GetObjectField(pi_obj, signatures_fid);\n\tenv->DeleteLocalRef(pi_obj);\n\n\tjobjectArray sigs = reinterpret_cast<jobjectArray>(sig_obj);\n\n\tjclass signature_cls = env->FindClass(\"android/content/pm/Signature\");\n\tjmethodID to_byte_array_mid = env->GetMethodID(signature_cls, \"toByteArray\",\n\t\t\t\"()[B\");\n\n\tjbyteArray sig_bytes = reinterpret_cast<jbyteArray>(env->CallObjectMethod(\n\t\t\tenv->GetObjectArrayElement(sigs, 0), to_byte_array_mid));\n\tjclass certificate_factory_cls = env->FindClass(\n\t\t\t\"java/security/cert/CertificateFactory\");\n\tjmethodID get_certificate_instance_mid = env->GetStaticMethodID(\n\t\t\tcertificate_factory_cls, \"getInstance\",\n\t\t\t\"(Ljava/lang/String;)Ljava/security/cert/CertificateFactory;\");\n\n\tjobject certificate_factory_obj = env->CallStaticObjectMethod(\n\t\t\tcertificate_factory_cls, get_certificate_instance_mid,\n\t\t\tenv->NewStringUTF(\"X509\"));\n\tjmethodID generate_certificate_mid = env->GetMethodID(\n\t\t\tcertificate_factory_cls, \"generateCertificate\",\n\t\t\t\"(Ljava/io/InputStream;)Ljava/security/cert/Certificate;\");\n\tenv->DeleteLocalRef(certificate_factory_cls);\n\n\tjclass certificate_cls = env->FindClass(\"java/security/cert/Certificate\");\n\tjclass byte_input_stream_cls = env->FindClass(\n\t\t\t\"java/io/ByteArrayInputStream\");\n\tjmethodID new_sig_bytes_is_mid = env->GetMethodID(byte_input_stream_cls,\n\t\t\t\"<init>\", \"([B)V\");\n\tjobject sig_bytes_is = env->NewObject(byte_input_stream_cls,\n\t\t\tnew_sig_bytes_is_mid, sig_bytes);\n\tenv->DeleteLocalRef(sig_bytes);\n\tenv->DeleteLocalRef(byte_input_stream_cls);\n\tjobject cert = env->CallObjectMethod(certificate_factory_obj,\n\t\t\tgenerate_certificate_mid, sig_bytes_is);\n\tenv->DeleteLocalRef(sig_bytes_is);\n\tenv->DeleteLocalRef(certificate_factory_obj);\n\tjmethodID get_pubic_key_mid = env->GetMethodID(certificate_cls,\n\t\t\t\"getPublicKey\", \"()Ljava/security/PublicKey;\");\n\tenv->DeleteLocalRef(certificate_cls);\n\n\tjobject publicKey  = env->CallObjectMethod(cert, get_pubic_key_mid);\n\tjclass publicKey_cls = env->GetObjectClass(publicKey);\n\tjmethodID toString_mid = env->GetMethodID(publicKey_cls,\"toString\", \"()Ljava/lang/String;\");\n\tjstring publicKey_str = static_cast<jstring>(env->CallObjectMethod(publicKey,toString_mid));\n\tenv->DeleteLocalRef(cert);\n\tenv->DeleteLocalRef(publicKey_cls);\n\tenv->DeleteLocalRef(publicKey);\n\n\n\tjclass string_cls = env->GetObjectClass(publicKey_str);\n\tjmethodID indexOf_mid = env->GetMethodID(string_cls,\"indexOf\", \"(Ljava/lang/String;)I\");\n\tjstring param = env->NewStringUTF(\"modulus\");\n\tjint aa = env->CallIntMethod(publicKey_str,indexOf_mid,param);\n\tjstring param2 = env->NewStringUTF(\"publicExponent\");\n\n\tjmethodID substring_mid = env->GetMethodID(string_cls,\"substring\", \"(II)Ljava/lang/String;\");\n\n\t__android_log_print(ANDROID_LOG_ERROR, TAG, \"PublicKey String is %s\", jstringTostring(env,publicKey_str));\n\n\tjint bb = env->CallIntMethod(publicKey_str,indexOf_mid,param2);\n\tjstring publicKey2_str =NULL;\n\tif (bb ==-1){\n\t\tjstring param3 = env->NewStringUTF(\"public exponent\");\n\t\tjint cc = env->CallIntMethod(publicKey_str,indexOf_mid,param3);\n\t\t__android_log_print(ANDROID_LOG_ERROR, TAG, \"CC value is %d\", cc);\n\t\tpublicKey2_str= static_cast<jstring>(env->CallObjectMethod(publicKey_str,substring_mid,aa+8,cc-1));\n\t}else {\n\t\tpublicKey2_str = static_cast<jstring>(env->CallObjectMethod(publicKey_str,substring_mid,aa+8,bb-1));\n\t}\n\n\t__android_log_print(ANDROID_LOG_ERROR, TAG, \"PublicKey value is %s\",  jstringTostring(env,publicKey2_str));\n\treturn publicKey2_str;\n}\n~~~\n\n\n### 3.\n\nJellybean\n\n    01-20 08:53:00.141: E/AndroidRuntime(24005): java.lang.NoSuchMethodError:\n\t\tandroid.view.ViewTreeObserver.removeOnGlobalLayoutListener\n\n\n\n~~~ Java\nif (Build.VERSION.SDK_INT < Build.VERSION_CODES.JELLY_BEAN) {\n\t\tViewTreeObserver.removeGlobalOnLayoutListener(this);\n}else\n\t\tViewTreeObserver.removeOnGlobalLayoutListener(this);\n~~~\n\nsetBackground\n\n~~~ Java\nif(Build.VERSION.SzDK_INT >= Build.VERSION_CODES.JELLY_BEAN) {\n\t\tView.setBackground(new ColorDrawable(Color.parseColor(\"#CCCCCC\")));\n} else {\n\t\tView.setBackgroundColor(Color.parseColor(\"#CCCCCC\"));\n}\n~~~\n","source":"_posts/2016-09-22-JNI-get-publickey.md","raw":"---\nlayout: post\ntitle:  JNIpublickey\ncategory: technology\ntags:\n  - JNI\n  - publickey\nkeywords: JNI, publickey\nbanner: http://obxk8w81b.bkt.clouddn.com/Blossoming%20Almond%20Branch%20in%20a%20Glass%20with%20a%20Book.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Blossoming%20Almond%20Branch%20in%20a%20Glass%20with%20a%20Book.jpg\n---\n\n\n### 1.\n[JNI](http://agehua.github.io/2016/JNI-Learning)\nJNIPublickey\n\n### 2.JNIPublickey\n[github](https://github.com/MasonLiuChn/AndroidUltimateEncrypt)\n\n4.0.4publickey\n\n<!--more-->\n\nPublickey\n\n~~~ Java\nOpenSSLRSAPublicKey{modulus=a0d169cedabdaac3527c2099eeac4cbd74bb9b14c2571bcf6755f49e1d8c8439a37e009b0cb1b1ae9bf164dc976ddc4ee050621c746610d995185accbe8b3c09cc4f8c7afd990db47be814f7f45ec9c489be5b0933e89ff58070c29c98199331160bdb3a19e0687d36e850ee686c565737be4f61328264a58792e198d873b023ec11cb26a73305eea631ab18ec3ce746eb253e47c145503e933ee5da892326ecbb29b5a005aacef2d30d720611f7014aa3f2e40954b9e4deeaca1823dd2f7b2230670acabda70d2f14b1adc9480cf0a48d47866a1aa745ae97d0ab906cd76e5ab76916d03ef153b35edc2ae7284a613b3a3a312c73cf0b98e0ce9a8cf6a682fa,publicExponent=10001}\n~~~\n\nGT-S7568 Android4.0.4Publickey\n\n~~~ Java\nRSA Public Key\n      modulus: a0d169cedabdaac3527c2099eeaca0d169cedabdaac3527c2099eeac4cbd74bb9b14c2571bcf6755f49e1d8c8439a37e009b0cb1b1ae9bf164dc976ddc4ee050621c746610d995185accbe8b3c09cc4f8c7afd990db47be814f7f45ec9c489be5b0933e89ff58070c29c98199331160bdb3a19e0687d36e850ee686c565737be4f61328264a58792e198d873b023ec11cb6a73305eea631ab18ec3ce746eb23e47c145503e933ee5da892326ecbb29b5a005aacef2d30d720611f7014aa3f2e40954b9e4deeaca1823dd2f7b2230670acabda70d2f14b1adc9410cf0a48d47866a1aa745ae97d0ab906cd76e5ab76916d03ef153b35edc2ae7284a613b3a3a313c73cf0b98e0ce9a8cf6a682aff0b98e0ce9a8cf6a682fa\n      public exponent: 10001\n~~~\nmodulus**publicExponent****public exponent**\n\n\n\n~~~ C++\njmethodID substring_mid = env->GetMethodID(string_cls,\"substring\", \"(II)Ljava/lang/String;\");\njmethodID indexOf_mid = env->GetMethodID(string_cls,\"indexOf\", \"(Ljava/lang/String;)I\");\n\njint bb = env->CallIntMethod(publicKey_str,indexOf_mid,param2);\njstring publicKey2_str =NULL;\nif (bb ==-1){\n\tjstring param3 = env->NewStringUTF(\"public exponent\");\n\tjint cc = env->CallIntMethod(publicKey_str,indexOf_mid,param3);\n\t__android_log_print(ANDROID_LOG_ERROR, TAG, \"CC value is %d\", cc);\n\tpublicKey2_str= static_cast<jstring>(env->CallObjectMethod(publicKey_str,substring_mid,aa+8,cc-1));\n}else {\n\tpublicKey2_str = static_cast<jstring>(env->CallObjectMethod(publicKey_str,substring_mid,aa+8,bb-1));\n}\n~~~\n\n#### 2.1 JNI native\n\nJNIJNI\\__android_log_print\n\n~~~ C++\n__android_log_print(ANDROID_LOG_ERROR, TAG, \"PublicKey value is %s\",  jstringTostring(env,publicKey2_str));\n~~~\n\n- ANDROID_LOG_INFOANDROID_LOG_DEBUGANDROID_LOG_ERROR\n- LogCat\n- \n\njstringTostringjstringchar*\n\n~~~ C++\nchar* jstringTostring(JNIEnv* env, jstring jstr)\n{\n\tchar* rtn = NULL;\n  jclass clsstring = env->FindClass(\"java/lang/String\");\n  jstring strencode = env->NewStringUTF(\"utf-8\");\n  jmethodID mid = env->GetMethodID(clsstring, \"getBytes\", \"(Ljava/lang/String;)[B\");\n  jbyteArray barr= (jbyteArray)env->CallObjectMethod(jstr, mid, strencode);\n  jsize alen = env->GetArrayLength(barr);\n  jbyte* ba = env->GetByteArrayElements(barr, JNI_FALSE);\n  if (alen > 0)\n  {\n  rtn = (char*)malloc(alen + 1);\n\n  memcpy(rtn, ba, alen);\n  rtn[alen] = 0;\n  }\n  env->ReleaseByteArrayElements(barr, ba, 0);\n  return rtn;\n}\n~~~\n\njstringJavaNative TypeJavastring\n\nJNI\n[JNI ---- ](http://blog.csdn.net/qinjuning/article/details/7599796)\n\nJNI\n\n- 1..h\n.c:\n\n~~~ C++\n#include <android/log.h>\n\n#define LOG_TAG   \"From JNI ===>>\"\n~~~\n\n- 2.Android.mk\n:\n\n~~~ C++\nLOCAL_LDLIBS   := -lm -llog -ljnigraphics\n~~~\n\n\n\n[JNInativeeclipselogcat](http://www.cnblogs.com/liuling/p/2015-8-5-1.html)\n\n[JNILOGCAT Debug](http://blog.csdn.net/llwdslal/article/details/31733035)\n\n#### 2.2 \n\n\n\n~~~ C++\njstring getPublicKey(JNIEnv* env, jobject thiz,jobject context) {\n\tjclass context_cls = env->GetObjectClass(context);\n\n\tjmethodID get_package_manager_mid = env->GetMethodID(context_cls,\n\t\t\t\"getPackageManager\", \"()Landroid/content/pm/PackageManager;\");\n\n\tjmethodID get_package_name_mid = env->GetMethodID(context_cls,\n\t\t\t\"getPackageName\", \"()Ljava/lang/String;\");\n\tenv->DeleteLocalRef(context_cls);\n\tjobject pm_obj = env->CallObjectMethod(context, get_package_manager_mid);\n\tjclass pm_cls = env->FindClass(\"android/content/pm/PackageManager\");\n\n\tjmethodID get_package_info_mid = env->GetMethodID(pm_cls, \"getPackageInfo\",\n\t\t\t\"(Ljava/lang/String;I)Landroid/content/pm/PackageInfo;\");\n\tjstring package_name = reinterpret_cast<jstring>(env->CallObjectMethod(\n\t\t\tcontext, get_package_name_mid));\n\tjfieldID flag_fid = env->GetStaticFieldID(pm_cls, \"GET_SIGNATURES\", \"I\");\n\tjint flag = env->GetStaticIntField(pm_cls, flag_fid);\n\tenv->DeleteLocalRef(pm_cls);\n\tjobject pi_obj = env->CallObjectMethod(pm_obj, get_package_info_mid,\n\t\t\tpackage_name, flag);\n\tenv->DeleteLocalRef(package_name);\n\n\tjclass pi_cls = env->FindClass(\"android/content/pm/PackageInfo\");\n\tjfieldID signatures_fid = env->GetFieldID(pi_cls, \"signatures\",\n\t\t\t\"[Landroid/content/pm/Signature;\");\n\tenv->DeleteLocalRef(pi_cls);\n\tjobject sig_obj = env->GetObjectField(pi_obj, signatures_fid);\n\tenv->DeleteLocalRef(pi_obj);\n\n\tjobjectArray sigs = reinterpret_cast<jobjectArray>(sig_obj);\n\n\tjclass signature_cls = env->FindClass(\"android/content/pm/Signature\");\n\tjmethodID to_byte_array_mid = env->GetMethodID(signature_cls, \"toByteArray\",\n\t\t\t\"()[B\");\n\n\tjbyteArray sig_bytes = reinterpret_cast<jbyteArray>(env->CallObjectMethod(\n\t\t\tenv->GetObjectArrayElement(sigs, 0), to_byte_array_mid));\n\tjclass certificate_factory_cls = env->FindClass(\n\t\t\t\"java/security/cert/CertificateFactory\");\n\tjmethodID get_certificate_instance_mid = env->GetStaticMethodID(\n\t\t\tcertificate_factory_cls, \"getInstance\",\n\t\t\t\"(Ljava/lang/String;)Ljava/security/cert/CertificateFactory;\");\n\n\tjobject certificate_factory_obj = env->CallStaticObjectMethod(\n\t\t\tcertificate_factory_cls, get_certificate_instance_mid,\n\t\t\tenv->NewStringUTF(\"X509\"));\n\tjmethodID generate_certificate_mid = env->GetMethodID(\n\t\t\tcertificate_factory_cls, \"generateCertificate\",\n\t\t\t\"(Ljava/io/InputStream;)Ljava/security/cert/Certificate;\");\n\tenv->DeleteLocalRef(certificate_factory_cls);\n\n\tjclass certificate_cls = env->FindClass(\"java/security/cert/Certificate\");\n\tjclass byte_input_stream_cls = env->FindClass(\n\t\t\t\"java/io/ByteArrayInputStream\");\n\tjmethodID new_sig_bytes_is_mid = env->GetMethodID(byte_input_stream_cls,\n\t\t\t\"<init>\", \"([B)V\");\n\tjobject sig_bytes_is = env->NewObject(byte_input_stream_cls,\n\t\t\tnew_sig_bytes_is_mid, sig_bytes);\n\tenv->DeleteLocalRef(sig_bytes);\n\tenv->DeleteLocalRef(byte_input_stream_cls);\n\tjobject cert = env->CallObjectMethod(certificate_factory_obj,\n\t\t\tgenerate_certificate_mid, sig_bytes_is);\n\tenv->DeleteLocalRef(sig_bytes_is);\n\tenv->DeleteLocalRef(certificate_factory_obj);\n\tjmethodID get_pubic_key_mid = env->GetMethodID(certificate_cls,\n\t\t\t\"getPublicKey\", \"()Ljava/security/PublicKey;\");\n\tenv->DeleteLocalRef(certificate_cls);\n\n\tjobject publicKey  = env->CallObjectMethod(cert, get_pubic_key_mid);\n\tjclass publicKey_cls = env->GetObjectClass(publicKey);\n\tjmethodID toString_mid = env->GetMethodID(publicKey_cls,\"toString\", \"()Ljava/lang/String;\");\n\tjstring publicKey_str = static_cast<jstring>(env->CallObjectMethod(publicKey,toString_mid));\n\tenv->DeleteLocalRef(cert);\n\tenv->DeleteLocalRef(publicKey_cls);\n\tenv->DeleteLocalRef(publicKey);\n\n\n\tjclass string_cls = env->GetObjectClass(publicKey_str);\n\tjmethodID indexOf_mid = env->GetMethodID(string_cls,\"indexOf\", \"(Ljava/lang/String;)I\");\n\tjstring param = env->NewStringUTF(\"modulus\");\n\tjint aa = env->CallIntMethod(publicKey_str,indexOf_mid,param);\n\tjstring param2 = env->NewStringUTF(\"publicExponent\");\n\n\tjmethodID substring_mid = env->GetMethodID(string_cls,\"substring\", \"(II)Ljava/lang/String;\");\n\n\t__android_log_print(ANDROID_LOG_ERROR, TAG, \"PublicKey String is %s\", jstringTostring(env,publicKey_str));\n\n\tjint bb = env->CallIntMethod(publicKey_str,indexOf_mid,param2);\n\tjstring publicKey2_str =NULL;\n\tif (bb ==-1){\n\t\tjstring param3 = env->NewStringUTF(\"public exponent\");\n\t\tjint cc = env->CallIntMethod(publicKey_str,indexOf_mid,param3);\n\t\t__android_log_print(ANDROID_LOG_ERROR, TAG, \"CC value is %d\", cc);\n\t\tpublicKey2_str= static_cast<jstring>(env->CallObjectMethod(publicKey_str,substring_mid,aa+8,cc-1));\n\t}else {\n\t\tpublicKey2_str = static_cast<jstring>(env->CallObjectMethod(publicKey_str,substring_mid,aa+8,bb-1));\n\t}\n\n\t__android_log_print(ANDROID_LOG_ERROR, TAG, \"PublicKey value is %s\",  jstringTostring(env,publicKey2_str));\n\treturn publicKey2_str;\n}\n~~~\n\n\n### 3.\n\nJellybean\n\n    01-20 08:53:00.141: E/AndroidRuntime(24005): java.lang.NoSuchMethodError:\n\t\tandroid.view.ViewTreeObserver.removeOnGlobalLayoutListener\n\n\n\n~~~ Java\nif (Build.VERSION.SDK_INT < Build.VERSION_CODES.JELLY_BEAN) {\n\t\tViewTreeObserver.removeGlobalOnLayoutListener(this);\n}else\n\t\tViewTreeObserver.removeOnGlobalLayoutListener(this);\n~~~\n\nsetBackground\n\n~~~ Java\nif(Build.VERSION.SzDK_INT >= Build.VERSION_CODES.JELLY_BEAN) {\n\t\tView.setBackground(new ColorDrawable(Color.parseColor(\"#CCCCCC\")));\n} else {\n\t\tView.setBackgroundColor(Color.parseColor(\"#CCCCCC\"));\n}\n~~~\n","slug":"JNI-get-publickey","published":1,"date":"2016-09-21T16:00:00.000Z","updated":"2017-11-23T07:08:18.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ebyd001ld6ykts3mjggy","content":"<h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h3><p><a href=\"http://agehua.github.io/2016/JNI-Learning\">JNI</a><br>JNIPublickey</p>\n<h3 id=\"2-JNIPublickey\"><a href=\"#2-JNIPublickey\" class=\"headerlink\" title=\"2.JNIPublickey\"></a>2.JNIPublickey</h3><p><a href=\"https://github.com/MasonLiuChn/AndroidUltimateEncrypt\" target=\"_blank\" rel=\"external\">github</a></p>\n<p>4.0.4publickey</p>\n<a id=\"more\"></a>\n<p>Publickey</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">OpenSSLRSAPublicKey&#123;modulus=a0d169cedabdaac3527c2099eeac4cbd74bb9b14c2571bcf6755f49e1d8c8439a37e009b0cb1b1ae9bf164dc976ddc4ee050621c746610d995185accbe8b3c09cc4f8c7afd990db47be814f7f45ec9c489be5b0933e89ff58070c29c98199331160bdb3a19e0687d36e850ee686c565737be4f61328264a58792e198d873b023ec11cb26a73305eea631ab18ec3ce746eb253e47c145503e933ee5da892326ecbb29b5a005aacef2d30d720611f7014aa3f2e40954b9e4deeaca1823dd2f7b2230670acabda70d2f14b1adc9480cf0a48d47866a1aa745ae97d0ab906cd76e5ab76916d03ef153b35edc2ae7284a613b3a3a312c73cf0b98e0ce9a8cf6a682fa,publicExponent=<span class=\"number\">10001</span>&#125;</div></pre></td></tr></table></figure>\n<p>GT-S7568 Android4.0.4Publickey</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">RSA Public Key</div><div class=\"line\">      modulus: a0d169cedabdaac3527c2099eeaca0d169cedabdaac3527c2099eeac4cbd74bb9b14c2571bcf6755f49e1d8c8439a37e009b0cb1b1ae9bf164dc976ddc4ee050621c746610d995185accbe8b3c09cc4f8c7afd990db47be814f7f45ec9c489be5b0933e89ff58070c29c98199331160bdb3a19e0687d36e850ee686c565737be4f61328264a58792e198d873b023ec11cb6a73305eea631ab18ec3ce746eb23e47c145503e933ee5da892326ecbb29b5a005aacef2d30d720611f7014aa3f2e40954b9e4deeaca1823dd2f7b2230670acabda70d2f14b1adc9410cf0a48d47866a1aa745ae97d0ab906cd76e5ab76916d03ef153b35edc2ae7284a613b3a3a313c73cf0b98e0ce9a8cf6a682aff0b98e0ce9a8cf6a682fa</div><div class=\"line\">      <span class=\"keyword\">public</span> exponent: <span class=\"number\">10001</span></div></pre></td></tr></table></figure>\n<p>modulus<strong>publicExponent</strong><strong>public exponent</strong></p>\n<p></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">jmethodID substring_mid = env-&gt;GetMethodID(string_cls,<span class=\"string\">\"substring\"</span>, <span class=\"string\">\"(II)Ljava/lang/String;\"</span>);</div><div class=\"line\">jmethodID indexOf_mid = env-&gt;GetMethodID(string_cls,<span class=\"string\">\"indexOf\"</span>, <span class=\"string\">\"(Ljava/lang/String;)I\"</span>);</div><div class=\"line\"></div><div class=\"line\">jint bb = env-&gt;CallIntMethod(publicKey_str,indexOf_mid,param2);</div><div class=\"line\">jstring publicKey2_str =<span class=\"literal\">NULL</span>;</div><div class=\"line\"><span class=\"keyword\">if</span> (bb ==<span class=\"number\">-1</span>)&#123;</div><div class=\"line\">\tjstring param3 = env-&gt;NewStringUTF(<span class=\"string\">\"public exponent\"</span>);</div><div class=\"line\">\tjint cc = env-&gt;CallIntMethod(publicKey_str,indexOf_mid,param3);</div><div class=\"line\">\t__android_log_print(ANDROID_LOG_ERROR, TAG, <span class=\"string\">\"CC value is %d\"</span>, cc);</div><div class=\"line\">\tpublicKey2_str= <span class=\"keyword\">static_cast</span>&lt;jstring&gt;(env-&gt;CallObjectMethod(publicKey_str,substring_mid,aa+<span class=\"number\">8</span>,cc<span class=\"number\">-1</span>));</div><div class=\"line\">&#125;<span class=\"keyword\">else</span> &#123;</div><div class=\"line\">\tpublicKey2_str = <span class=\"keyword\">static_cast</span>&lt;jstring&gt;(env-&gt;CallObjectMethod(publicKey_str,substring_mid,aa+<span class=\"number\">8</span>,bb<span class=\"number\">-1</span>));</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h4 id=\"2-1-JNI-native\"><a href=\"#2-1-JNI-native\" class=\"headerlink\" title=\"2.1 JNI native\"></a>2.1 JNI native</h4><p>JNIJNI__android_log_print</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">__android_log_print(ANDROID_LOG_ERROR, TAG, <span class=\"string\">\"PublicKey value is %s\"</span>,  jstringTostring(env,publicKey2_str));</div></pre></td></tr></table></figure>\n<ul>\n<li>ANDROID_LOG_INFOANDROID_LOG_DEBUGANDROID_LOG_ERROR</li>\n<li>LogCat</li>\n<li></li>\n</ul>\n<p>jstringTostringjstringchar*</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">char</span>* <span class=\"title\">jstringTostring</span><span class=\"params\">(JNIEnv* env, jstring jstr)</span></span></div><div class=\"line\">&#123;</div><div class=\"line\">\t<span class=\"keyword\">char</span>* rtn = <span class=\"literal\">NULL</span>;</div><div class=\"line\">  jclass clsstring = env-&gt;FindClass(<span class=\"string\">\"java/lang/String\"</span>);</div><div class=\"line\">  jstring strencode = env-&gt;NewStringUTF(<span class=\"string\">\"utf-8\"</span>);</div><div class=\"line\">  jmethodID mid = env-&gt;GetMethodID(clsstring, <span class=\"string\">\"getBytes\"</span>, <span class=\"string\">\"(Ljava/lang/String;)[B\"</span>);</div><div class=\"line\">  jbyteArray barr= (jbyteArray)env-&gt;CallObjectMethod(jstr, mid, strencode);</div><div class=\"line\">  jsize alen = env-&gt;GetArrayLength(barr);</div><div class=\"line\">  jbyte* ba = env-&gt;GetByteArrayElements(barr, JNI_FALSE);</div><div class=\"line\">  <span class=\"keyword\">if</span> (alen &gt; <span class=\"number\">0</span>)</div><div class=\"line\">  &#123;</div><div class=\"line\">  rtn = (<span class=\"keyword\">char</span>*)<span class=\"built_in\">malloc</span>(alen + <span class=\"number\">1</span>);</div><div class=\"line\"></div><div class=\"line\">  <span class=\"built_in\">memcpy</span>(rtn, ba, alen);</div><div class=\"line\">  rtn[alen] = <span class=\"number\">0</span>;</div><div class=\"line\">  &#125;</div><div class=\"line\">  env-&gt;ReleaseByteArrayElements(barr, ba, <span class=\"number\">0</span>);</div><div class=\"line\">  <span class=\"keyword\">return</span> rtn;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>jstringJavaNative TypeJavastring</p>\n<p>JNI<br><a href=\"http://blog.csdn.net/qinjuning/article/details/7599796\" target=\"_blank\" rel=\"external\">JNI - </a></p>\n<p>JNI</p>\n<ul>\n<li>1..h<br>.c:</li>\n</ul>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;android/log.h&gt;</span></span></div><div class=\"line\"></div><div class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> LOG_TAG   <span class=\"meta-string\">\"From JNI ===&gt;&gt;\"</span></span></div></pre></td></tr></table></figure>\n<ul>\n<li>2.Android.mk<br>:</li>\n</ul>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">LOCAL_LDLIBS   := -lm -llog -ljnigraphics</div></pre></td></tr></table></figure>\n<p></p>\n<p><a href=\"http://www.cnblogs.com/liuling/p/2015-8-5-1.html\" target=\"_blank\" rel=\"external\">JNInativeeclipselogcat</a></p>\n<p><a href=\"http://blog.csdn.net/llwdslal/article/details/31733035\" target=\"_blank\" rel=\"external\">JNILOGCAT Debug</a></p>\n<h4 id=\"2-2-\"><a href=\"#2-2-\" class=\"headerlink\" title=\"2.2 \"></a>2.2 </h4><p></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\">jstring <span class=\"title\">getPublicKey</span><span class=\"params\">(JNIEnv* env, jobject thiz,jobject context)</span> </span>&#123;</div><div class=\"line\">\tjclass context_cls = env-&gt;GetObjectClass(context);</div><div class=\"line\"></div><div class=\"line\">\tjmethodID get_package_manager_mid = env-&gt;GetMethodID(context_cls,</div><div class=\"line\">\t\t\t<span class=\"string\">\"getPackageManager\"</span>, <span class=\"string\">\"()Landroid/content/pm/PackageManager;\"</span>);</div><div class=\"line\"></div><div class=\"line\">\tjmethodID get_package_name_mid = env-&gt;GetMethodID(context_cls,</div><div class=\"line\">\t\t\t<span class=\"string\">\"getPackageName\"</span>, <span class=\"string\">\"()Ljava/lang/String;\"</span>);</div><div class=\"line\">\tenv-&gt;DeleteLocalRef(context_cls);</div><div class=\"line\">\tjobject pm_obj = env-&gt;CallObjectMethod(context, get_package_manager_mid);</div><div class=\"line\">\tjclass pm_cls = env-&gt;FindClass(<span class=\"string\">\"android/content/pm/PackageManager\"</span>);</div><div class=\"line\"></div><div class=\"line\">\tjmethodID get_package_info_mid = env-&gt;GetMethodID(pm_cls, <span class=\"string\">\"getPackageInfo\"</span>,</div><div class=\"line\">\t\t\t<span class=\"string\">\"(Ljava/lang/String;I)Landroid/content/pm/PackageInfo;\"</span>);</div><div class=\"line\">\tjstring package_name = <span class=\"keyword\">reinterpret_cast</span>&lt;jstring&gt;(env-&gt;CallObjectMethod(</div><div class=\"line\">\t\t\tcontext, get_package_name_mid));</div><div class=\"line\">\tjfieldID flag_fid = env-&gt;GetStaticFieldID(pm_cls, <span class=\"string\">\"GET_SIGNATURES\"</span>, <span class=\"string\">\"I\"</span>);</div><div class=\"line\">\tjint flag = env-&gt;GetStaticIntField(pm_cls, flag_fid);</div><div class=\"line\">\tenv-&gt;DeleteLocalRef(pm_cls);</div><div class=\"line\">\tjobject pi_obj = env-&gt;CallObjectMethod(pm_obj, get_package_info_mid,</div><div class=\"line\">\t\t\tpackage_name, flag);</div><div class=\"line\">\tenv-&gt;DeleteLocalRef(package_name);</div><div class=\"line\"></div><div class=\"line\">\tjclass pi_cls = env-&gt;FindClass(<span class=\"string\">\"android/content/pm/PackageInfo\"</span>);</div><div class=\"line\">\tjfieldID signatures_fid = env-&gt;GetFieldID(pi_cls, <span class=\"string\">\"signatures\"</span>,</div><div class=\"line\">\t\t\t<span class=\"string\">\"[Landroid/content/pm/Signature;\"</span>);</div><div class=\"line\">\tenv-&gt;DeleteLocalRef(pi_cls);</div><div class=\"line\">\tjobject sig_obj = env-&gt;GetObjectField(pi_obj, signatures_fid);</div><div class=\"line\">\tenv-&gt;DeleteLocalRef(pi_obj);</div><div class=\"line\"></div><div class=\"line\">\tjobjectArray sigs = <span class=\"keyword\">reinterpret_cast</span>&lt;jobjectArray&gt;(sig_obj);</div><div class=\"line\"></div><div class=\"line\">\tjclass signature_cls = env-&gt;FindClass(<span class=\"string\">\"android/content/pm/Signature\"</span>);</div><div class=\"line\">\tjmethodID to_byte_array_mid = env-&gt;GetMethodID(signature_cls, <span class=\"string\">\"toByteArray\"</span>,</div><div class=\"line\">\t\t\t<span class=\"string\">\"()[B\"</span>);</div><div class=\"line\"></div><div class=\"line\">\tjbyteArray sig_bytes = <span class=\"keyword\">reinterpret_cast</span>&lt;jbyteArray&gt;(env-&gt;CallObjectMethod(</div><div class=\"line\">\t\t\tenv-&gt;GetObjectArrayElement(sigs, <span class=\"number\">0</span>), to_byte_array_mid));</div><div class=\"line\">\tjclass certificate_factory_cls = env-&gt;FindClass(</div><div class=\"line\">\t\t\t<span class=\"string\">\"java/security/cert/CertificateFactory\"</span>);</div><div class=\"line\">\tjmethodID get_certificate_instance_mid = env-&gt;GetStaticMethodID(</div><div class=\"line\">\t\t\tcertificate_factory_cls, <span class=\"string\">\"getInstance\"</span>,</div><div class=\"line\">\t\t\t<span class=\"string\">\"(Ljava/lang/String;)Ljava/security/cert/CertificateFactory;\"</span>);</div><div class=\"line\"></div><div class=\"line\">\tjobject certificate_factory_obj = env-&gt;CallStaticObjectMethod(</div><div class=\"line\">\t\t\tcertificate_factory_cls, get_certificate_instance_mid,</div><div class=\"line\">\t\t\tenv-&gt;NewStringUTF(<span class=\"string\">\"X509\"</span>));</div><div class=\"line\">\tjmethodID generate_certificate_mid = env-&gt;GetMethodID(</div><div class=\"line\">\t\t\tcertificate_factory_cls, <span class=\"string\">\"generateCertificate\"</span>,</div><div class=\"line\">\t\t\t<span class=\"string\">\"(Ljava/io/InputStream;)Ljava/security/cert/Certificate;\"</span>);</div><div class=\"line\">\tenv-&gt;DeleteLocalRef(certificate_factory_cls);</div><div class=\"line\"></div><div class=\"line\">\tjclass certificate_cls = env-&gt;FindClass(<span class=\"string\">\"java/security/cert/Certificate\"</span>);</div><div class=\"line\">\tjclass byte_input_stream_cls = env-&gt;FindClass(</div><div class=\"line\">\t\t\t<span class=\"string\">\"java/io/ByteArrayInputStream\"</span>);</div><div class=\"line\">\tjmethodID new_sig_bytes_is_mid = env-&gt;GetMethodID(byte_input_stream_cls,</div><div class=\"line\">\t\t\t<span class=\"string\">\"&lt;init&gt;\"</span>, <span class=\"string\">\"([B)V\"</span>);</div><div class=\"line\">\tjobject sig_bytes_is = env-&gt;NewObject(byte_input_stream_cls,</div><div class=\"line\">\t\t\tnew_sig_bytes_is_mid, sig_bytes);</div><div class=\"line\">\tenv-&gt;DeleteLocalRef(sig_bytes);</div><div class=\"line\">\tenv-&gt;DeleteLocalRef(byte_input_stream_cls);</div><div class=\"line\">\tjobject cert = env-&gt;CallObjectMethod(certificate_factory_obj,</div><div class=\"line\">\t\t\tgenerate_certificate_mid, sig_bytes_is);</div><div class=\"line\">\tenv-&gt;DeleteLocalRef(sig_bytes_is);</div><div class=\"line\">\tenv-&gt;DeleteLocalRef(certificate_factory_obj);</div><div class=\"line\">\tjmethodID get_pubic_key_mid = env-&gt;GetMethodID(certificate_cls,</div><div class=\"line\">\t\t\t<span class=\"string\">\"getPublicKey\"</span>, <span class=\"string\">\"()Ljava/security/PublicKey;\"</span>);</div><div class=\"line\">\tenv-&gt;DeleteLocalRef(certificate_cls);</div><div class=\"line\"></div><div class=\"line\">\tjobject publicKey  = env-&gt;CallObjectMethod(cert, get_pubic_key_mid);</div><div class=\"line\">\tjclass publicKey_cls = env-&gt;GetObjectClass(publicKey);</div><div class=\"line\">\tjmethodID toString_mid = env-&gt;GetMethodID(publicKey_cls,<span class=\"string\">\"toString\"</span>, <span class=\"string\">\"()Ljava/lang/String;\"</span>);</div><div class=\"line\">\tjstring publicKey_str = <span class=\"keyword\">static_cast</span>&lt;jstring&gt;(env-&gt;CallObjectMethod(publicKey,toString_mid));</div><div class=\"line\">\tenv-&gt;DeleteLocalRef(cert);</div><div class=\"line\">\tenv-&gt;DeleteLocalRef(publicKey_cls);</div><div class=\"line\">\tenv-&gt;DeleteLocalRef(publicKey);</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">\tjclass string_cls = env-&gt;GetObjectClass(publicKey_str);</div><div class=\"line\">\tjmethodID indexOf_mid = env-&gt;GetMethodID(string_cls,<span class=\"string\">\"indexOf\"</span>, <span class=\"string\">\"(Ljava/lang/String;)I\"</span>);</div><div class=\"line\">\tjstring param = env-&gt;NewStringUTF(<span class=\"string\">\"modulus\"</span>);</div><div class=\"line\">\tjint aa = env-&gt;CallIntMethod(publicKey_str,indexOf_mid,param);</div><div class=\"line\">\tjstring param2 = env-&gt;NewStringUTF(<span class=\"string\">\"publicExponent\"</span>);</div><div class=\"line\"></div><div class=\"line\">\tjmethodID substring_mid = env-&gt;GetMethodID(string_cls,<span class=\"string\">\"substring\"</span>, <span class=\"string\">\"(II)Ljava/lang/String;\"</span>);</div><div class=\"line\"></div><div class=\"line\">\t__android_log_print(ANDROID_LOG_ERROR, TAG, <span class=\"string\">\"PublicKey String is %s\"</span>, jstringTostring(env,publicKey_str));</div><div class=\"line\"></div><div class=\"line\">\tjint bb = env-&gt;CallIntMethod(publicKey_str,indexOf_mid,param2);</div><div class=\"line\">\tjstring publicKey2_str =<span class=\"literal\">NULL</span>;</div><div class=\"line\">\t<span class=\"keyword\">if</span> (bb ==<span class=\"number\">-1</span>)&#123;</div><div class=\"line\">\t\tjstring param3 = env-&gt;NewStringUTF(<span class=\"string\">\"public exponent\"</span>);</div><div class=\"line\">\t\tjint cc = env-&gt;CallIntMethod(publicKey_str,indexOf_mid,param3);</div><div class=\"line\">\t\t__android_log_print(ANDROID_LOG_ERROR, TAG, <span class=\"string\">\"CC value is %d\"</span>, cc);</div><div class=\"line\">\t\tpublicKey2_str= <span class=\"keyword\">static_cast</span>&lt;jstring&gt;(env-&gt;CallObjectMethod(publicKey_str,substring_mid,aa+<span class=\"number\">8</span>,cc<span class=\"number\">-1</span>));</div><div class=\"line\">\t&#125;<span class=\"keyword\">else</span> &#123;</div><div class=\"line\">\t\tpublicKey2_str = <span class=\"keyword\">static_cast</span>&lt;jstring&gt;(env-&gt;CallObjectMethod(publicKey_str,substring_mid,aa+<span class=\"number\">8</span>,bb<span class=\"number\">-1</span>));</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t__android_log_print(ANDROID_LOG_ERROR, TAG, <span class=\"string\">\"PublicKey value is %s\"</span>,  jstringTostring(env,publicKey2_str));</div><div class=\"line\">\t<span class=\"keyword\">return</span> publicKey2_str;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h3><p>Jellybean</p>\n<pre><code>01-20 08:53:00.141: E/AndroidRuntime(24005): java.lang.NoSuchMethodError:\n    android.view.ViewTreeObserver.removeOnGlobalLayoutListener\n</code></pre><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">if</span> (Build.VERSION.SDK_INT &lt; Build.VERSION_CODES.JELLY_BEAN) &#123;</div><div class=\"line\">\t\tViewTreeObserver.removeGlobalOnLayoutListener(<span class=\"keyword\">this</span>);</div><div class=\"line\">&#125;<span class=\"keyword\">else</span></div><div class=\"line\">\t\tViewTreeObserver.removeOnGlobalLayoutListener(<span class=\"keyword\">this</span>);</div></pre></td></tr></table></figure>\n<p>setBackground</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">if</span>(Build.VERSION.SzDK_INT &gt;= Build.VERSION_CODES.JELLY_BEAN) &#123;</div><div class=\"line\">\t\tView.setBackground(<span class=\"keyword\">new</span> ColorDrawable(Color.parseColor(<span class=\"string\">\"#CCCCCC\"</span>)));</div><div class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">\t\tView.setBackgroundColor(Color.parseColor(<span class=\"string\">\"#CCCCCC\"</span>));</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/09/22/JNI-get-publickey/\">http://agehua.github.io/2016/09/22/JNI-get-publickey/</a></p>\n","readingTime":{"text":"4 min read","minutes":3.87,"time":232200.00000000003,"words":774},"excerpt":"<h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h3><p><a href=\"http://agehua.github.io/2016/JNI-Learning\">JNI</a><br>JNIPublickey</p>\n<h3 id=\"2-JNIPublickey\"><a href=\"#2-JNIPublickey\" class=\"headerlink\" title=\"2.JNIPublickey\"></a>2.JNIPublickey</h3><p><a href=\"https://github.com/MasonLiuChn/AndroidUltimateEncrypt\">github</a></p>\n<p>4.0.4publickey</p>","more":"<p>Publickey</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">OpenSSLRSAPublicKey&#123;modulus=a0d169cedabdaac3527c2099eeac4cbd74bb9b14c2571bcf6755f49e1d8c8439a37e009b0cb1b1ae9bf164dc976ddc4ee050621c746610d995185accbe8b3c09cc4f8c7afd990db47be814f7f45ec9c489be5b0933e89ff58070c29c98199331160bdb3a19e0687d36e850ee686c565737be4f61328264a58792e198d873b023ec11cb26a73305eea631ab18ec3ce746eb253e47c145503e933ee5da892326ecbb29b5a005aacef2d30d720611f7014aa3f2e40954b9e4deeaca1823dd2f7b2230670acabda70d2f14b1adc9480cf0a48d47866a1aa745ae97d0ab906cd76e5ab76916d03ef153b35edc2ae7284a613b3a3a312c73cf0b98e0ce9a8cf6a682fa,publicExponent=<span class=\"number\">10001</span>&#125;</div></pre></td></tr></table></figure>\n<p>GT-S7568 Android4.0.4Publickey</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">RSA Public Key</div><div class=\"line\">      modulus: a0d169cedabdaac3527c2099eeaca0d169cedabdaac3527c2099eeac4cbd74bb9b14c2571bcf6755f49e1d8c8439a37e009b0cb1b1ae9bf164dc976ddc4ee050621c746610d995185accbe8b3c09cc4f8c7afd990db47be814f7f45ec9c489be5b0933e89ff58070c29c98199331160bdb3a19e0687d36e850ee686c565737be4f61328264a58792e198d873b023ec11cb6a73305eea631ab18ec3ce746eb23e47c145503e933ee5da892326ecbb29b5a005aacef2d30d720611f7014aa3f2e40954b9e4deeaca1823dd2f7b2230670acabda70d2f14b1adc9410cf0a48d47866a1aa745ae97d0ab906cd76e5ab76916d03ef153b35edc2ae7284a613b3a3a313c73cf0b98e0ce9a8cf6a682aff0b98e0ce9a8cf6a682fa</div><div class=\"line\">      <span class=\"keyword\">public</span> exponent: <span class=\"number\">10001</span></div></pre></td></tr></table></figure>\n<p>modulus<strong>publicExponent</strong><strong>public exponent</strong></p>\n<p></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">jmethodID substring_mid = env-&gt;GetMethodID(string_cls,<span class=\"string\">\"substring\"</span>, <span class=\"string\">\"(II)Ljava/lang/String;\"</span>);</div><div class=\"line\">jmethodID indexOf_mid = env-&gt;GetMethodID(string_cls,<span class=\"string\">\"indexOf\"</span>, <span class=\"string\">\"(Ljava/lang/String;)I\"</span>);</div><div class=\"line\"></div><div class=\"line\">jint bb = env-&gt;CallIntMethod(publicKey_str,indexOf_mid,param2);</div><div class=\"line\">jstring publicKey2_str =<span class=\"literal\">NULL</span>;</div><div class=\"line\"><span class=\"keyword\">if</span> (bb ==<span class=\"number\">-1</span>)&#123;</div><div class=\"line\">\tjstring param3 = env-&gt;NewStringUTF(<span class=\"string\">\"public exponent\"</span>);</div><div class=\"line\">\tjint cc = env-&gt;CallIntMethod(publicKey_str,indexOf_mid,param3);</div><div class=\"line\">\t__android_log_print(ANDROID_LOG_ERROR, TAG, <span class=\"string\">\"CC value is %d\"</span>, cc);</div><div class=\"line\">\tpublicKey2_str= <span class=\"keyword\">static_cast</span>&lt;jstring&gt;(env-&gt;CallObjectMethod(publicKey_str,substring_mid,aa+<span class=\"number\">8</span>,cc<span class=\"number\">-1</span>));</div><div class=\"line\">&#125;<span class=\"keyword\">else</span> &#123;</div><div class=\"line\">\tpublicKey2_str = <span class=\"keyword\">static_cast</span>&lt;jstring&gt;(env-&gt;CallObjectMethod(publicKey_str,substring_mid,aa+<span class=\"number\">8</span>,bb<span class=\"number\">-1</span>));</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h4 id=\"2-1-JNI-native\"><a href=\"#2-1-JNI-native\" class=\"headerlink\" title=\"2.1 JNI native\"></a>2.1 JNI native</h4><p>JNIJNI__android_log_print</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">__android_log_print(ANDROID_LOG_ERROR, TAG, <span class=\"string\">\"PublicKey value is %s\"</span>,  jstringTostring(env,publicKey2_str));</div></pre></td></tr></table></figure>\n<ul>\n<li>ANDROID_LOG_INFOANDROID_LOG_DEBUGANDROID_LOG_ERROR</li>\n<li>LogCat</li>\n<li></li>\n</ul>\n<p>jstringTostringjstringchar*</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">char</span>* <span class=\"title\">jstringTostring</span><span class=\"params\">(JNIEnv* env, jstring jstr)</span></div><div class=\"line\"></span>&#123;</div><div class=\"line\">\t<span class=\"keyword\">char</span>* rtn = <span class=\"literal\">NULL</span>;</div><div class=\"line\">  jclass clsstring = env-&gt;FindClass(<span class=\"string\">\"java/lang/String\"</span>);</div><div class=\"line\">  jstring strencode = env-&gt;NewStringUTF(<span class=\"string\">\"utf-8\"</span>);</div><div class=\"line\">  jmethodID mid = env-&gt;GetMethodID(clsstring, <span class=\"string\">\"getBytes\"</span>, <span class=\"string\">\"(Ljava/lang/String;)[B\"</span>);</div><div class=\"line\">  jbyteArray barr= (jbyteArray)env-&gt;CallObjectMethod(jstr, mid, strencode);</div><div class=\"line\">  jsize alen = env-&gt;GetArrayLength(barr);</div><div class=\"line\">  jbyte* ba = env-&gt;GetByteArrayElements(barr, JNI_FALSE);</div><div class=\"line\">  <span class=\"keyword\">if</span> (alen &gt; <span class=\"number\">0</span>)</div><div class=\"line\">  &#123;</div><div class=\"line\">  rtn = (<span class=\"keyword\">char</span>*)<span class=\"built_in\">malloc</span>(alen + <span class=\"number\">1</span>);</div><div class=\"line\"></div><div class=\"line\">  <span class=\"built_in\">memcpy</span>(rtn, ba, alen);</div><div class=\"line\">  rtn[alen] = <span class=\"number\">0</span>;</div><div class=\"line\">  &#125;</div><div class=\"line\">  env-&gt;ReleaseByteArrayElements(barr, ba, <span class=\"number\">0</span>);</div><div class=\"line\">  <span class=\"keyword\">return</span> rtn;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>jstringJavaNative TypeJavastring</p>\n<p>JNI<br><a href=\"http://blog.csdn.net/qinjuning/article/details/7599796\">JNI - </a></p>\n<p>JNI</p>\n<ul>\n<li>1..h<br>.c:</li>\n</ul>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;android/log.h&gt;</span></span></div><div class=\"line\"></div><div class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> LOG_TAG   <span class=\"meta-string\">\"From JNI ===&gt;&gt;\"</span></span></div></pre></td></tr></table></figure>\n<ul>\n<li>2.Android.mk<br>:</li>\n</ul>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">LOCAL_LDLIBS   := -lm -llog -ljnigraphics</div></pre></td></tr></table></figure>\n<p></p>\n<p><a href=\"http://www.cnblogs.com/liuling/p/2015-8-5-1.html\">JNInativeeclipselogcat</a></p>\n<p><a href=\"http://blog.csdn.net/llwdslal/article/details/31733035\">JNILOGCAT Debug</a></p>\n<h4 id=\"2-2-\"><a href=\"#2-2-\" class=\"headerlink\" title=\"2.2 \"></a>2.2 </h4><p></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\">jstring <span class=\"title\">getPublicKey</span><span class=\"params\">(JNIEnv* env, jobject thiz,jobject context)</span> </span>&#123;</div><div class=\"line\">\tjclass context_cls = env-&gt;GetObjectClass(context);</div><div class=\"line\"></div><div class=\"line\">\tjmethodID get_package_manager_mid = env-&gt;GetMethodID(context_cls,</div><div class=\"line\">\t\t\t<span class=\"string\">\"getPackageManager\"</span>, <span class=\"string\">\"()Landroid/content/pm/PackageManager;\"</span>);</div><div class=\"line\"></div><div class=\"line\">\tjmethodID get_package_name_mid = env-&gt;GetMethodID(context_cls,</div><div class=\"line\">\t\t\t<span class=\"string\">\"getPackageName\"</span>, <span class=\"string\">\"()Ljava/lang/String;\"</span>);</div><div class=\"line\">\tenv-&gt;DeleteLocalRef(context_cls);</div><div class=\"line\">\tjobject pm_obj = env-&gt;CallObjectMethod(context, get_package_manager_mid);</div><div class=\"line\">\tjclass pm_cls = env-&gt;FindClass(<span class=\"string\">\"android/content/pm/PackageManager\"</span>);</div><div class=\"line\"></div><div class=\"line\">\tjmethodID get_package_info_mid = env-&gt;GetMethodID(pm_cls, <span class=\"string\">\"getPackageInfo\"</span>,</div><div class=\"line\">\t\t\t<span class=\"string\">\"(Ljava/lang/String;I)Landroid/content/pm/PackageInfo;\"</span>);</div><div class=\"line\">\tjstring package_name = <span class=\"keyword\">reinterpret_cast</span>&lt;jstring&gt;(env-&gt;CallObjectMethod(</div><div class=\"line\">\t\t\tcontext, get_package_name_mid));</div><div class=\"line\">\tjfieldID flag_fid = env-&gt;GetStaticFieldID(pm_cls, <span class=\"string\">\"GET_SIGNATURES\"</span>, <span class=\"string\">\"I\"</span>);</div><div class=\"line\">\tjint flag = env-&gt;GetStaticIntField(pm_cls, flag_fid);</div><div class=\"line\">\tenv-&gt;DeleteLocalRef(pm_cls);</div><div class=\"line\">\tjobject pi_obj = env-&gt;CallObjectMethod(pm_obj, get_package_info_mid,</div><div class=\"line\">\t\t\tpackage_name, flag);</div><div class=\"line\">\tenv-&gt;DeleteLocalRef(package_name);</div><div class=\"line\"></div><div class=\"line\">\tjclass pi_cls = env-&gt;FindClass(<span class=\"string\">\"android/content/pm/PackageInfo\"</span>);</div><div class=\"line\">\tjfieldID signatures_fid = env-&gt;GetFieldID(pi_cls, <span class=\"string\">\"signatures\"</span>,</div><div class=\"line\">\t\t\t<span class=\"string\">\"[Landroid/content/pm/Signature;\"</span>);</div><div class=\"line\">\tenv-&gt;DeleteLocalRef(pi_cls);</div><div class=\"line\">\tjobject sig_obj = env-&gt;GetObjectField(pi_obj, signatures_fid);</div><div class=\"line\">\tenv-&gt;DeleteLocalRef(pi_obj);</div><div class=\"line\"></div><div class=\"line\">\tjobjectArray sigs = <span class=\"keyword\">reinterpret_cast</span>&lt;jobjectArray&gt;(sig_obj);</div><div class=\"line\"></div><div class=\"line\">\tjclass signature_cls = env-&gt;FindClass(<span class=\"string\">\"android/content/pm/Signature\"</span>);</div><div class=\"line\">\tjmethodID to_byte_array_mid = env-&gt;GetMethodID(signature_cls, <span class=\"string\">\"toByteArray\"</span>,</div><div class=\"line\">\t\t\t<span class=\"string\">\"()[B\"</span>);</div><div class=\"line\"></div><div class=\"line\">\tjbyteArray sig_bytes = <span class=\"keyword\">reinterpret_cast</span>&lt;jbyteArray&gt;(env-&gt;CallObjectMethod(</div><div class=\"line\">\t\t\tenv-&gt;GetObjectArrayElement(sigs, <span class=\"number\">0</span>), to_byte_array_mid));</div><div class=\"line\">\tjclass certificate_factory_cls = env-&gt;FindClass(</div><div class=\"line\">\t\t\t<span class=\"string\">\"java/security/cert/CertificateFactory\"</span>);</div><div class=\"line\">\tjmethodID get_certificate_instance_mid = env-&gt;GetStaticMethodID(</div><div class=\"line\">\t\t\tcertificate_factory_cls, <span class=\"string\">\"getInstance\"</span>,</div><div class=\"line\">\t\t\t<span class=\"string\">\"(Ljava/lang/String;)Ljava/security/cert/CertificateFactory;\"</span>);</div><div class=\"line\"></div><div class=\"line\">\tjobject certificate_factory_obj = env-&gt;CallStaticObjectMethod(</div><div class=\"line\">\t\t\tcertificate_factory_cls, get_certificate_instance_mid,</div><div class=\"line\">\t\t\tenv-&gt;NewStringUTF(<span class=\"string\">\"X509\"</span>));</div><div class=\"line\">\tjmethodID generate_certificate_mid = env-&gt;GetMethodID(</div><div class=\"line\">\t\t\tcertificate_factory_cls, <span class=\"string\">\"generateCertificate\"</span>,</div><div class=\"line\">\t\t\t<span class=\"string\">\"(Ljava/io/InputStream;)Ljava/security/cert/Certificate;\"</span>);</div><div class=\"line\">\tenv-&gt;DeleteLocalRef(certificate_factory_cls);</div><div class=\"line\"></div><div class=\"line\">\tjclass certificate_cls = env-&gt;FindClass(<span class=\"string\">\"java/security/cert/Certificate\"</span>);</div><div class=\"line\">\tjclass byte_input_stream_cls = env-&gt;FindClass(</div><div class=\"line\">\t\t\t<span class=\"string\">\"java/io/ByteArrayInputStream\"</span>);</div><div class=\"line\">\tjmethodID new_sig_bytes_is_mid = env-&gt;GetMethodID(byte_input_stream_cls,</div><div class=\"line\">\t\t\t<span class=\"string\">\"&lt;init&gt;\"</span>, <span class=\"string\">\"([B)V\"</span>);</div><div class=\"line\">\tjobject sig_bytes_is = env-&gt;NewObject(byte_input_stream_cls,</div><div class=\"line\">\t\t\tnew_sig_bytes_is_mid, sig_bytes);</div><div class=\"line\">\tenv-&gt;DeleteLocalRef(sig_bytes);</div><div class=\"line\">\tenv-&gt;DeleteLocalRef(byte_input_stream_cls);</div><div class=\"line\">\tjobject cert = env-&gt;CallObjectMethod(certificate_factory_obj,</div><div class=\"line\">\t\t\tgenerate_certificate_mid, sig_bytes_is);</div><div class=\"line\">\tenv-&gt;DeleteLocalRef(sig_bytes_is);</div><div class=\"line\">\tenv-&gt;DeleteLocalRef(certificate_factory_obj);</div><div class=\"line\">\tjmethodID get_pubic_key_mid = env-&gt;GetMethodID(certificate_cls,</div><div class=\"line\">\t\t\t<span class=\"string\">\"getPublicKey\"</span>, <span class=\"string\">\"()Ljava/security/PublicKey;\"</span>);</div><div class=\"line\">\tenv-&gt;DeleteLocalRef(certificate_cls);</div><div class=\"line\"></div><div class=\"line\">\tjobject publicKey  = env-&gt;CallObjectMethod(cert, get_pubic_key_mid);</div><div class=\"line\">\tjclass publicKey_cls = env-&gt;GetObjectClass(publicKey);</div><div class=\"line\">\tjmethodID toString_mid = env-&gt;GetMethodID(publicKey_cls,<span class=\"string\">\"toString\"</span>, <span class=\"string\">\"()Ljava/lang/String;\"</span>);</div><div class=\"line\">\tjstring publicKey_str = <span class=\"keyword\">static_cast</span>&lt;jstring&gt;(env-&gt;CallObjectMethod(publicKey,toString_mid));</div><div class=\"line\">\tenv-&gt;DeleteLocalRef(cert);</div><div class=\"line\">\tenv-&gt;DeleteLocalRef(publicKey_cls);</div><div class=\"line\">\tenv-&gt;DeleteLocalRef(publicKey);</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">\tjclass string_cls = env-&gt;GetObjectClass(publicKey_str);</div><div class=\"line\">\tjmethodID indexOf_mid = env-&gt;GetMethodID(string_cls,<span class=\"string\">\"indexOf\"</span>, <span class=\"string\">\"(Ljava/lang/String;)I\"</span>);</div><div class=\"line\">\tjstring param = env-&gt;NewStringUTF(<span class=\"string\">\"modulus\"</span>);</div><div class=\"line\">\tjint aa = env-&gt;CallIntMethod(publicKey_str,indexOf_mid,param);</div><div class=\"line\">\tjstring param2 = env-&gt;NewStringUTF(<span class=\"string\">\"publicExponent\"</span>);</div><div class=\"line\"></div><div class=\"line\">\tjmethodID substring_mid = env-&gt;GetMethodID(string_cls,<span class=\"string\">\"substring\"</span>, <span class=\"string\">\"(II)Ljava/lang/String;\"</span>);</div><div class=\"line\"></div><div class=\"line\">\t__android_log_print(ANDROID_LOG_ERROR, TAG, <span class=\"string\">\"PublicKey String is %s\"</span>, jstringTostring(env,publicKey_str));</div><div class=\"line\"></div><div class=\"line\">\tjint bb = env-&gt;CallIntMethod(publicKey_str,indexOf_mid,param2);</div><div class=\"line\">\tjstring publicKey2_str =<span class=\"literal\">NULL</span>;</div><div class=\"line\">\t<span class=\"keyword\">if</span> (bb ==<span class=\"number\">-1</span>)&#123;</div><div class=\"line\">\t\tjstring param3 = env-&gt;NewStringUTF(<span class=\"string\">\"public exponent\"</span>);</div><div class=\"line\">\t\tjint cc = env-&gt;CallIntMethod(publicKey_str,indexOf_mid,param3);</div><div class=\"line\">\t\t__android_log_print(ANDROID_LOG_ERROR, TAG, <span class=\"string\">\"CC value is %d\"</span>, cc);</div><div class=\"line\">\t\tpublicKey2_str= <span class=\"keyword\">static_cast</span>&lt;jstring&gt;(env-&gt;CallObjectMethod(publicKey_str,substring_mid,aa+<span class=\"number\">8</span>,cc<span class=\"number\">-1</span>));</div><div class=\"line\">\t&#125;<span class=\"keyword\">else</span> &#123;</div><div class=\"line\">\t\tpublicKey2_str = <span class=\"keyword\">static_cast</span>&lt;jstring&gt;(env-&gt;CallObjectMethod(publicKey_str,substring_mid,aa+<span class=\"number\">8</span>,bb<span class=\"number\">-1</span>));</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t__android_log_print(ANDROID_LOG_ERROR, TAG, <span class=\"string\">\"PublicKey value is %s\"</span>,  jstringTostring(env,publicKey2_str));</div><div class=\"line\">\t<span class=\"keyword\">return</span> publicKey2_str;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h3><p>Jellybean</p>\n<pre><code>01-20 08:53:00.141: E/AndroidRuntime(24005): java.lang.NoSuchMethodError:\n    android.view.ViewTreeObserver.removeOnGlobalLayoutListener\n</code></pre><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">if</span> (Build.VERSION.SDK_INT &lt; Build.VERSION_CODES.JELLY_BEAN) &#123;</div><div class=\"line\">\t\tViewTreeObserver.removeGlobalOnLayoutListener(<span class=\"keyword\">this</span>);</div><div class=\"line\">&#125;<span class=\"keyword\">else</span></div><div class=\"line\">\t\tViewTreeObserver.removeOnGlobalLayoutListener(<span class=\"keyword\">this</span>);</div></pre></td></tr></table></figure>\n<p>setBackground</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">if</span>(Build.VERSION.SzDK_INT &gt;= Build.VERSION_CODES.JELLY_BEAN) &#123;</div><div class=\"line\">\t\tView.setBackground(<span class=\"keyword\">new</span> ColorDrawable(Color.parseColor(<span class=\"string\">\"#CCCCCC\"</span>)));</div><div class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">\t\tView.setBackgroundColor(Color.parseColor(<span class=\"string\">\"#CCCCCC\"</span>));</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/09/22/JNI-get-publickey/\">http://agehua.github.io/2016/09/22/JNI-get-publickey/</a></p>"},{"layout":"post","title":"gradle ","keywords":"Android,gradle","banner":"http://obxk8w81b.bkt.clouddn.com/Crab%20on%20Its%20Back.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Crab%20on%20Its%20Back.jpg","_content":"\n\nGradleGroovyJavaXMLGroovyDSLantMavenIvy\n\n### Gradle\n\n> (Project)  (tasks)Gradle \n\n<!--more-->\n\n- Jar\n\n- \n\n-  projects  project  tasks  task\n\n![basic structure](http://oui2w5whj.bkt.clouddn.com/blogimages/2016/gradle_structure1.png)\n\nBuildProjectProjecttask\n\nAntbuild.xmlMavenpom.xmlMakemakefile\n\n#### Gradle\n\nGradle\n\n- build.gradle tasks\n\n- settings.gradle \n\n- gradle.properties \n\n### Gradle\nGradleGradleJava Java  Gradlebuild.gradle apply plugin: 'java'\n\ntasktasktask:\n\n- 1.gradle build\n- 2.gradle assemble, \n- 3.gradle clean build \n- 4.gradle check checkstylepmdfindbugs\n\nGradletask\n\n![basic task](http://oui2w5whj.bkt.clouddn.com/blogimages/2016/gradle_task.png)\n\nbuild\n\n#### \n\n,  Java ,  JAR .  JAR ,  Gradle .  Gradle , JAR  maven \n\nmaven\n\n~~~ Java\nrepositories {\n\tmavenCentral()\n}\n~~~\nmavenCentral() Gradlemavenmavenmavengradlemaven\n\n~~~ Java\ndependencies {\n\tcompile group: 'commons-collections', name: 'commons-collections', version: '3.2'\n\t// \n\t// compile 'commons-collections:commons-collections:3.2'\n}\n~~~\ngroup, name  version JARmvnrepository\n\n#### \n\nGradleJARJARJAR\n\n~~~ Java\ndependencies {\n\tcompile files('dir/file.jar')\n\tcompile fileTree(dir: 'libs', include: '*.jar')\n}\n~~~\n#### \n\nGradlesettings.gradle\n\n~~~ Java\ninclude 'sub-project1', 'sub-project2', 'sub-project3'\n~~~\nsub-project1sub-project2sub-project1build.gradle\n\n~~~ Java\ndependencies {\n\tcompile project(':sub-project2')\n}\n~~~\n#### \n\ngradlegradle\n\nHibernatejarJunitjarjarGradle\n\n~~~ Java\napply plugin: 'java'\n\nrepositories {\n    mavenCentral()\n}\n\ndependencies {\n    compile group: 'org.hibernate', name: 'hibernate-core', version: '3.6.7.Final'\n    testCompile group: 'junit', name: 'junit', version: '4.+'\n}\n~~~\njunitjar\n\nJava \n\n> - compile\n\t\n- runtime\n\t , compile\n- testCompile\n\t , runtimecompile\n- testRuntime\n\t , \n","source":"_posts/2016-10-12-gradle-learning.md","raw":"---\nlayout: post\ntitle:  gradle \ncategory: accumulation\ntags:\n  - gradle\nkeywords: Android,gradle\nbanner: http://obxk8w81b.bkt.clouddn.com/Crab%20on%20Its%20Back.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Crab%20on%20Its%20Back.jpg\n---\n\n\nGradleGroovyJavaXMLGroovyDSLantMavenIvy\n\n### Gradle\n\n> (Project)  (tasks)Gradle \n\n<!--more-->\n\n- Jar\n\n- \n\n-  projects  project  tasks  task\n\n![basic structure](http://oui2w5whj.bkt.clouddn.com/blogimages/2016/gradle_structure1.png)\n\nBuildProjectProjecttask\n\nAntbuild.xmlMavenpom.xmlMakemakefile\n\n#### Gradle\n\nGradle\n\n- build.gradle tasks\n\n- settings.gradle \n\n- gradle.properties \n\n### Gradle\nGradleGradleJava Java  Gradlebuild.gradle apply plugin: 'java'\n\ntasktasktask:\n\n- 1.gradle build\n- 2.gradle assemble, \n- 3.gradle clean build \n- 4.gradle check checkstylepmdfindbugs\n\nGradletask\n\n![basic task](http://oui2w5whj.bkt.clouddn.com/blogimages/2016/gradle_task.png)\n\nbuild\n\n#### \n\n,  Java ,  JAR .  JAR ,  Gradle .  Gradle , JAR  maven \n\nmaven\n\n~~~ Java\nrepositories {\n\tmavenCentral()\n}\n~~~\nmavenCentral() Gradlemavenmavenmavengradlemaven\n\n~~~ Java\ndependencies {\n\tcompile group: 'commons-collections', name: 'commons-collections', version: '3.2'\n\t// \n\t// compile 'commons-collections:commons-collections:3.2'\n}\n~~~\ngroup, name  version JARmvnrepository\n\n#### \n\nGradleJARJARJAR\n\n~~~ Java\ndependencies {\n\tcompile files('dir/file.jar')\n\tcompile fileTree(dir: 'libs', include: '*.jar')\n}\n~~~\n#### \n\nGradlesettings.gradle\n\n~~~ Java\ninclude 'sub-project1', 'sub-project2', 'sub-project3'\n~~~\nsub-project1sub-project2sub-project1build.gradle\n\n~~~ Java\ndependencies {\n\tcompile project(':sub-project2')\n}\n~~~\n#### \n\ngradlegradle\n\nHibernatejarJunitjarjarGradle\n\n~~~ Java\napply plugin: 'java'\n\nrepositories {\n    mavenCentral()\n}\n\ndependencies {\n    compile group: 'org.hibernate', name: 'hibernate-core', version: '3.6.7.Final'\n    testCompile group: 'junit', name: 'junit', version: '4.+'\n}\n~~~\njunitjar\n\nJava \n\n> - compile\n\t\n- runtime\n\t , compile\n- testCompile\n\t , runtimecompile\n- testRuntime\n\t , \n","slug":"gradle-learning","published":1,"date":"2016-10-11T16:00:00.000Z","updated":"2017-11-23T07:09:26.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ebym001pd6ykdeokmvms","content":"<p>GradleGroovyJavaXMLGroovyDSLantMavenIvy</p>\n<h3 id=\"Gradle\"><a href=\"#Gradle\" class=\"headerlink\" title=\"Gradle\"></a>Gradle</h3><blockquote>\n<p>(Project)  (tasks)Gradle </p>\n</blockquote>\n<a id=\"more\"></a>\n<ul>\n<li><p>Jar</p>\n</li>\n<li><p></p>\n</li>\n<li><p> projects  project  tasks  task</p>\n</li>\n</ul>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2016/gradle_structure1.png\" alt=\"basic structure\"></p>\n<p>BuildProjectProjecttask</p>\n<p>Antbuild.xmlMavenpom.xmlMakemakefile</p>\n<h4 id=\"Gradle\"><a href=\"#Gradle\" class=\"headerlink\" title=\"Gradle\"></a>Gradle</h4><p>Gradle</p>\n<ul>\n<li><p>build.gradle tasks</p>\n</li>\n<li><p>settings.gradle </p>\n</li>\n<li><p>gradle.properties </p>\n</li>\n</ul>\n<h3 id=\"Gradle\"><a href=\"#Gradle\" class=\"headerlink\" title=\"Gradle\"></a>Gradle</h3><p>GradleGradleJava Java  Gradlebuild.gradle apply plugin: java</p>\n<p>tasktasktask:</p>\n<ul>\n<li>1.gradle build</li>\n<li>2.gradle assemble, </li>\n<li>3.gradle clean build </li>\n<li>4.gradle check checkstylepmdfindbugs</li>\n</ul>\n<p>Gradletask</p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2016/gradle_task.png\" alt=\"basic task\"></p>\n<p>build</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>,  Java ,  JAR .  JAR ,  Gradle .  Gradle , JAR  maven </p>\n<p>maven</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">repositories &#123;</div><div class=\"line\">\tmavenCentral()</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>mavenCentral() Gradlemavenmavenmavengradlemaven</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">dependencies &#123;</div><div class=\"line\">\tcompile group: <span class=\"string\">'commons-collections'</span>, name: <span class=\"string\">'commons-collections'</span>, version: <span class=\"string\">'3.2'</span></div><div class=\"line\">\t<span class=\"comment\">// </span></div><div class=\"line\">\t<span class=\"comment\">// compile 'commons-collections:commons-collections:3.2'</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>group, name  version JARmvnrepository</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>GradleJARJARJAR</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">dependencies &#123;</div><div class=\"line\">\t<span class=\"function\">compile <span class=\"title\">files</span><span class=\"params\">(<span class=\"string\">'dir/file.jar'</span>)</span></span></div><div class=\"line\">\tcompile <span class=\"title\">fileTree</span><span class=\"params\">(dir: <span class=\"string\">'libs'</span>, include: <span class=\"string\">'*.jar'</span>)</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>Gradlesettings.gradle</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">include <span class=\"string\">'sub-project1'</span>, <span class=\"string\">'sub-project2'</span>, <span class=\"string\">'sub-project3'</span></div></pre></td></tr></table></figure>\n<p>sub-project1sub-project2sub-project1build.gradle</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">dependencies &#123;</div><div class=\"line\">\t<span class=\"function\">compile <span class=\"title\">project</span><span class=\"params\">(<span class=\"string\">':sub-project2'</span>)</span></span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>gradlegradle</p>\n<p>HibernatejarJunitjarjarGradle</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">apply plugin: <span class=\"string\">'java'</span></div><div class=\"line\"></div><div class=\"line\">repositories &#123;</div><div class=\"line\">    mavenCentral()</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">dependencies &#123;</div><div class=\"line\">    compile group: <span class=\"string\">'org.hibernate'</span>, name: <span class=\"string\">'hibernate-core'</span>, version: <span class=\"string\">'3.6.7.Final'</span></div><div class=\"line\">    testCompile group: <span class=\"string\">'junit'</span>, name: <span class=\"string\">'junit'</span>, version: <span class=\"string\">'4.+'</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>junitjar</p>\n<p>Java </p>\n<blockquote>\n<ul>\n<li>compile<br>  </li>\n<li>runtime<br>   , compile</li>\n<li>testCompile<br>   , runtimecompile</li>\n<li>testRuntime<br>   , </li>\n</ul>\n</blockquote>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/10/12/gradle-learning/\">http://agehua.github.io/2016/10/12/gradle-learning/</a></p>\n","readingTime":{"text":"2 min read","minutes":1.365,"time":81900,"words":273},"excerpt":"<p>GradleGroovyJavaXMLGroovyDSLantMavenIvy</p>\n<h3 id=\"Gradle\"><a href=\"#Gradle\" class=\"headerlink\" title=\"Gradle\"></a>Gradle</h3><blockquote>\n<p>(Project)  (tasks)Gradle </p>\n</blockquote>","more":"<ul>\n<li><p>Jar</p>\n</li>\n<li><p></p>\n</li>\n<li><p> projects  project  tasks  task</p>\n</li>\n</ul>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2016/gradle_structure1.png\" alt=\"basic structure\"></p>\n<p>BuildProjectProjecttask</p>\n<p>Antbuild.xmlMavenpom.xmlMakemakefile</p>\n<h4 id=\"Gradle\"><a href=\"#Gradle\" class=\"headerlink\" title=\"Gradle\"></a>Gradle</h4><p>Gradle</p>\n<ul>\n<li><p>build.gradle tasks</p>\n</li>\n<li><p>settings.gradle </p>\n</li>\n<li><p>gradle.properties </p>\n</li>\n</ul>\n<h3 id=\"Gradle\"><a href=\"#Gradle\" class=\"headerlink\" title=\"Gradle\"></a>Gradle</h3><p>GradleGradleJava Java  Gradlebuild.gradle apply plugin: java</p>\n<p>tasktasktask:</p>\n<ul>\n<li>1.gradle build</li>\n<li>2.gradle assemble, </li>\n<li>3.gradle clean build </li>\n<li>4.gradle check checkstylepmdfindbugs</li>\n</ul>\n<p>Gradletask</p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2016/gradle_task.png\" alt=\"basic task\"></p>\n<p>build</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>,  Java ,  JAR .  JAR ,  Gradle .  Gradle , JAR  maven </p>\n<p>maven</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">repositories &#123;</div><div class=\"line\">\tmavenCentral()</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>mavenCentral() Gradlemavenmavenmavengradlemaven</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">dependencies &#123;</div><div class=\"line\">\tcompile group: <span class=\"string\">'commons-collections'</span>, name: <span class=\"string\">'commons-collections'</span>, version: <span class=\"string\">'3.2'</span></div><div class=\"line\">\t<span class=\"comment\">// </span></div><div class=\"line\">\t<span class=\"comment\">// compile 'commons-collections:commons-collections:3.2'</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>group, name  version JARmvnrepository</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>GradleJARJARJAR</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">dependencies &#123;</div><div class=\"line\">\t<span class=\"function\">compile <span class=\"title\">files</span><span class=\"params\">(<span class=\"string\">'dir/file.jar'</span>)</span></div><div class=\"line\">\tcompile <span class=\"title\">fileTree</span><span class=\"params\">(dir: <span class=\"string\">'libs'</span>, include: <span class=\"string\">'*.jar'</span>)</span></div><div class=\"line\">&#125;</span></div></pre></td></tr></table></figure>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>Gradlesettings.gradle</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">include <span class=\"string\">'sub-project1'</span>, <span class=\"string\">'sub-project2'</span>, <span class=\"string\">'sub-project3'</span></div></pre></td></tr></table></figure>\n<p>sub-project1sub-project2sub-project1build.gradle</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">dependencies &#123;</div><div class=\"line\">\t<span class=\"function\">compile <span class=\"title\">project</span><span class=\"params\">(<span class=\"string\">':sub-project2'</span>)</span></div><div class=\"line\">&#125;</span></div></pre></td></tr></table></figure>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>gradlegradle</p>\n<p>HibernatejarJunitjarjarGradle</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">apply plugin: <span class=\"string\">'java'</span></div><div class=\"line\"></div><div class=\"line\">repositories &#123;</div><div class=\"line\">    mavenCentral()</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">dependencies &#123;</div><div class=\"line\">    compile group: <span class=\"string\">'org.hibernate'</span>, name: <span class=\"string\">'hibernate-core'</span>, version: <span class=\"string\">'3.6.7.Final'</span></div><div class=\"line\">    testCompile group: <span class=\"string\">'junit'</span>, name: <span class=\"string\">'junit'</span>, version: <span class=\"string\">'4.+'</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>junitjar</p>\n<p>Java </p>\n<blockquote>\n<ul>\n<li>compile<br>  </li>\n<li>runtime<br>   , compile</li>\n<li>testCompile<br>   , runtimecompile</li>\n<li>testRuntime<br>   , </li>\n</ul>\n</blockquote>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/10/12/gradle-learning/\">http://agehua.github.io/2016/10/12/gradle-learning/</a></p>"},{"layout":"post","title":"Android ","keywords":"Android,","banner":"http://obxk8w81b.bkt.clouddn.com/Enclosed%20Field%20with%20Ploughman.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Enclosed%20Field%20with%20Ploughman.jpg","_content":"\n\n\n\n\n\n- (1)System.exit(0);\n\n- (2)Process.killProcess(Process.myPid());\n\n- (3)ActivityManager activityManager = (ActivityManager) this.getSystemService(Context.ACTIVITY_SERVICE);\n\n    activityManager.restartPackage(\"packagename\");\n\n\n2.2\n\n<!--more-->\n\n### 1\n\nActivityListActivityActivityListListActivity\n\nActivityonCreateActivity\n\n~~~ Java\n@Override\nprotected void onCreate(Bundle savedInstanceState) {\n\n       super.onCreate(savedInstanceState);\n       IntentFilter filter = new IntentFilter();\n       filter.addAction(\"finish\");\n       registerReceiver(mFinishReceiver, filter);\n       \n}\n\nprivate BroadcastReceiver mFinishReceiver = new BroadcastReceiver() {\n\n    @Override\n    public void onReceive(Context context, Intent intent) {\n           if(\"finish\".equals(intent.getAction())) {\n              Log.e(\"#########\", \"I am \" + getLocalClassName()\n                     + \",now finishing myself...\");\n              finish();\n       }\n    }\n};\n~~~\n\nActivity\n\n\n\ngetApplicationContext().sendBroadcast(new Intent(\"finish\"));\n\nhttp://www.cnblogs.com/wader2011/archive/2011/10/10/2205161.html\n\n### 2\n\n~~~ Java\npublic class CloseActivity\n{\n    private static LinkedList<Activity> acys = new LinkedList<Activity>();\n\n    public static Activity curActivity;\n\n    public static void add(Activity acy)\n    {\n        acys.add(acy);\n    }\n\n    public static void remove(Activity acy) {\n        acys.remove(acy);\n    }\n\n    public static void close()\n    {\n        Activity acy;\n        while (acys.size() != 0)\n        {\n            acy = acys.poll();\n            if (!acy.isFinishing())\n            {\n                acy.finish();\n            }\n        }\n//        android.os.Process.killProcess(android.os.Process.myPid());\n    }\n}\n~~~\n\n### 3.activity stack\nAndroidstack\nDAIntentIntent.FLAG_ACTIVITY_CLEAR_TOPAActivity\n\nD:\n\n~~~ Java\nIntent intent = new Intent();\nintent.setClass(D.this, A.class);\nintent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);  //FLAG\nstartActivity(intent);\nfinish();\n~~~\n\nA\n\n~~~ Java\n@Override\nprotected void onNewIntent(Intent intent) { // TODO Auto-generated method stub\n    super.onNewIntent(intent);\n        //\n    if ((Intent.FLAG_ACTIVITY_CLEAR_TOP & intent.getFlags()) != 0) {\n         finish();\n    }\n}\n~~~\n\n      AManifest.xmlandroid:launchMode=\"singleTop\"\n\n ADAactivityIntent.FLAG_ACTIVITY_CLEAR_TOPBCAandroid:launchMode=\"singleTop\" oncreate(),onNewIntentIntent.FLAG_ACTIVITY_CLEAR_TOPA finish A,B,C,D\n\n\n### 4.JNI\n[Android JNI](http://blog.csdn.net/yyh352091626/article/details/50542554)\n","source":"_posts/2016-09-22-quit-whole-application.md","raw":"---\nlayout: post\ntitle:  Android \ncategory: technology\ntags:\n  - ANDROID\n  - exitApplication\nkeywords: Android,\nbanner: http://obxk8w81b.bkt.clouddn.com/Enclosed%20Field%20with%20Ploughman.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Enclosed%20Field%20with%20Ploughman.jpg\n---\n\n\n\n\n\n\n- (1)System.exit(0);\n\n- (2)Process.killProcess(Process.myPid());\n\n- (3)ActivityManager activityManager = (ActivityManager) this.getSystemService(Context.ACTIVITY_SERVICE);\n\n    activityManager.restartPackage(\"packagename\");\n\n\n2.2\n\n<!--more-->\n\n### 1\n\nActivityListActivityActivityListListActivity\n\nActivityonCreateActivity\n\n~~~ Java\n@Override\nprotected void onCreate(Bundle savedInstanceState) {\n\n       super.onCreate(savedInstanceState);\n       IntentFilter filter = new IntentFilter();\n       filter.addAction(\"finish\");\n       registerReceiver(mFinishReceiver, filter);\n       \n}\n\nprivate BroadcastReceiver mFinishReceiver = new BroadcastReceiver() {\n\n    @Override\n    public void onReceive(Context context, Intent intent) {\n           if(\"finish\".equals(intent.getAction())) {\n              Log.e(\"#########\", \"I am \" + getLocalClassName()\n                     + \",now finishing myself...\");\n              finish();\n       }\n    }\n};\n~~~\n\nActivity\n\n\n\ngetApplicationContext().sendBroadcast(new Intent(\"finish\"));\n\nhttp://www.cnblogs.com/wader2011/archive/2011/10/10/2205161.html\n\n### 2\n\n~~~ Java\npublic class CloseActivity\n{\n    private static LinkedList<Activity> acys = new LinkedList<Activity>();\n\n    public static Activity curActivity;\n\n    public static void add(Activity acy)\n    {\n        acys.add(acy);\n    }\n\n    public static void remove(Activity acy) {\n        acys.remove(acy);\n    }\n\n    public static void close()\n    {\n        Activity acy;\n        while (acys.size() != 0)\n        {\n            acy = acys.poll();\n            if (!acy.isFinishing())\n            {\n                acy.finish();\n            }\n        }\n//        android.os.Process.killProcess(android.os.Process.myPid());\n    }\n}\n~~~\n\n### 3.activity stack\nAndroidstack\nDAIntentIntent.FLAG_ACTIVITY_CLEAR_TOPAActivity\n\nD:\n\n~~~ Java\nIntent intent = new Intent();\nintent.setClass(D.this, A.class);\nintent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);  //FLAG\nstartActivity(intent);\nfinish();\n~~~\n\nA\n\n~~~ Java\n@Override\nprotected void onNewIntent(Intent intent) { // TODO Auto-generated method stub\n    super.onNewIntent(intent);\n        //\n    if ((Intent.FLAG_ACTIVITY_CLEAR_TOP & intent.getFlags()) != 0) {\n         finish();\n    }\n}\n~~~\n\n      AManifest.xmlandroid:launchMode=\"singleTop\"\n\n ADAactivityIntent.FLAG_ACTIVITY_CLEAR_TOPBCAandroid:launchMode=\"singleTop\" oncreate(),onNewIntentIntent.FLAG_ACTIVITY_CLEAR_TOPA finish A,B,C,D\n\n\n### 4.JNI\n[Android JNI](http://blog.csdn.net/yyh352091626/article/details/50542554)\n","slug":"quit-whole-application","published":1,"date":"2016-09-21T16:00:00.000Z","updated":"2017-11-23T07:24:52.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ebys001sd6ykew0aco4p","content":"<p></p>\n<p></p>\n<ul>\n<li><p>(1)System.exit(0);</p>\n</li>\n<li><p>(2)Process.killProcess(Process.myPid());</p>\n</li>\n<li><p>(3)ActivityManager activityManager = (ActivityManager) this.getSystemService(Context.ACTIVITY_SERVICE);</p>\n<p>  activityManager.restartPackage(packagename);</p>\n</li>\n</ul>\n<p>2.2</p>\n<a id=\"more\"></a>\n<h3 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a>1</h3><p>ActivityListActivityActivityListListActivity</p>\n<p>ActivityonCreateActivity</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">onCreate</span><span class=\"params\">(Bundle savedInstanceState)</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">       <span class=\"keyword\">super</span>.onCreate(savedInstanceState);</div><div class=\"line\">       IntentFilter filter = <span class=\"keyword\">new</span> IntentFilter();</div><div class=\"line\">       filter.addAction(<span class=\"string\">\"finish\"</span>);</div><div class=\"line\">       registerReceiver(mFinishReceiver, filter);</div><div class=\"line\">       </div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">private</span> BroadcastReceiver mFinishReceiver = <span class=\"keyword\">new</span> BroadcastReceiver() &#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onReceive</span><span class=\"params\">(Context context, Intent intent)</span> </span>&#123;</div><div class=\"line\">           <span class=\"keyword\">if</span>(<span class=\"string\">\"finish\"</span>.equals(intent.getAction())) &#123;</div><div class=\"line\">              Log.e(<span class=\"string\">\"#########\"</span>, <span class=\"string\">\"I am \"</span> + getLocalClassName()</div><div class=\"line\">                     + <span class=\"string\">\",now finishing myself...\"</span>);</div><div class=\"line\">              finish();</div><div class=\"line\">       &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure>\n<p>Activity</p>\n<p></p>\n<p>getApplicationContext().sendBroadcast(new Intent(finish));</p>\n<p><a href=\"http://www.cnblogs.com/wader2011/archive/2011/10/10/2205161.html\" target=\"_blank\" rel=\"external\">http://www.cnblogs.com/wader2011/archive/2011/10/10/2205161.html</a></p>\n<h3 id=\"2\"><a href=\"#2\" class=\"headerlink\" title=\"2\"></a>2</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CloseActivity</span></span></div><div class=\"line\">&#123;</div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> LinkedList&lt;Activity&gt; acys = <span class=\"keyword\">new</span> LinkedList&lt;Activity&gt;();</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Activity curActivity;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(Activity acy)</span></span></div><div class=\"line\">    &#123;</div><div class=\"line\">        acys.add(acy);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">remove</span><span class=\"params\">(Activity acy)</span> </span>&#123;</div><div class=\"line\">        acys.remove(acy);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">close</span><span class=\"params\">()</span></span></div><div class=\"line\">    &#123;</div><div class=\"line\">        Activity acy;</div><div class=\"line\">        <span class=\"keyword\">while</span> (acys.size() != <span class=\"number\">0</span>)</div><div class=\"line\">        &#123;</div><div class=\"line\">            acy = acys.poll();</div><div class=\"line\">            <span class=\"keyword\">if</span> (!acy.isFinishing())</div><div class=\"line\">            &#123;</div><div class=\"line\">                acy.finish();</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\"><span class=\"comment\">//        android.os.Process.killProcess(android.os.Process.myPid());</span></div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"3-activity-stack\"><a href=\"#3-activity-stack\" class=\"headerlink\" title=\"3.activity stack\"></a>3.activity stack</h3><p>Androidstack<br>DAIntentIntent.FLAG_ACTIVITY_CLEAR_TOPAActivity</p>\n<p>D:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Intent intent = <span class=\"keyword\">new</span> Intent();</div><div class=\"line\">intent.setClass(D.<span class=\"keyword\">this</span>, A.class);</div><div class=\"line\">intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);  <span class=\"comment\">//FLAG</span></div><div class=\"line\">startActivity(intent);</div><div class=\"line\">finish();</div></pre></td></tr></table></figure>\n<p>A</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">onNewIntent</span><span class=\"params\">(Intent intent)</span> </span>&#123; <span class=\"comment\">// TODO Auto-generated method stub</span></div><div class=\"line\">    <span class=\"keyword\">super</span>.onNewIntent(intent);</div><div class=\"line\">        <span class=\"comment\">//</span></div><div class=\"line\">    <span class=\"keyword\">if</span> ((Intent.FLAG_ACTIVITY_CLEAR_TOP &amp; intent.getFlags()) != <span class=\"number\">0</span>) &#123;</div><div class=\"line\">         finish();</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<pre><code>AManifest.xmlandroid:launchMode=&quot;singleTop&quot;\n</code></pre><p> ADAactivityIntent.FLAG_ACTIVITY_CLEAR_TOPBCAandroid:launchMode=singleTop oncreate(),onNewIntentIntent.FLAG_ACTIVITY_CLEAR_TOPA finish A,B,C,D</p>\n<h3 id=\"4-JNI\"><a href=\"#4-JNI\" class=\"headerlink\" title=\"4.JNI\"></a>4.JNI</h3><p><a href=\"http://blog.csdn.net/yyh352091626/article/details/50542554\" target=\"_blank\" rel=\"external\">Android JNI</a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/09/22/quit-whole-application/\">http://agehua.github.io/2016/09/22/quit-whole-application/</a></p>\n","readingTime":{"text":"2 min read","minutes":1.635,"time":98100,"words":327},"excerpt":"<p></p>\n<p></p>\n<ul>\n<li><p>(1)System.exit(0);</p>\n</li>\n<li><p>(2)Process.killProcess(Process.myPid());</p>\n</li>\n<li><p>(3)ActivityManager activityManager = (ActivityManager) this.getSystemService(Context.ACTIVITY_SERVICE);</p>\n<p>  activityManager.restartPackage(packagename);</p>\n</li>\n</ul>\n<p>2.2</p>","more":"<h3 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a>1</h3><p>ActivityListActivityActivityListListActivity</p>\n<p>ActivityonCreateActivity</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">onCreate</span><span class=\"params\">(Bundle savedInstanceState)</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">       <span class=\"keyword\">super</span>.onCreate(savedInstanceState);</div><div class=\"line\">       IntentFilter filter = <span class=\"keyword\">new</span> IntentFilter();</div><div class=\"line\">       filter.addAction(<span class=\"string\">\"finish\"</span>);</div><div class=\"line\">       registerReceiver(mFinishReceiver, filter);</div><div class=\"line\">       </div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">private</span> BroadcastReceiver mFinishReceiver = <span class=\"keyword\">new</span> BroadcastReceiver() &#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onReceive</span><span class=\"params\">(Context context, Intent intent)</span> </span>&#123;</div><div class=\"line\">           <span class=\"keyword\">if</span>(<span class=\"string\">\"finish\"</span>.equals(intent.getAction())) &#123;</div><div class=\"line\">              Log.e(<span class=\"string\">\"#########\"</span>, <span class=\"string\">\"I am \"</span> + getLocalClassName()</div><div class=\"line\">                     + <span class=\"string\">\",now finishing myself...\"</span>);</div><div class=\"line\">              finish();</div><div class=\"line\">       &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure>\n<p>Activity</p>\n<p></p>\n<p>getApplicationContext().sendBroadcast(new Intent(finish));</p>\n<p><a href=\"http://www.cnblogs.com/wader2011/archive/2011/10/10/2205161.html\">http://www.cnblogs.com/wader2011/archive/2011/10/10/2205161.html</a></p>\n<h3 id=\"2\"><a href=\"#2\" class=\"headerlink\" title=\"2\"></a>2</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CloseActivity</span></div><div class=\"line\"></span>&#123;</div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> LinkedList&lt;Activity&gt; acys = <span class=\"keyword\">new</span> LinkedList&lt;Activity&gt;();</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Activity curActivity;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(Activity acy)</span></div><div class=\"line\">    </span>&#123;</div><div class=\"line\">        acys.add(acy);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">remove</span><span class=\"params\">(Activity acy)</span> </span>&#123;</div><div class=\"line\">        acys.remove(acy);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">close</span><span class=\"params\">()</span></div><div class=\"line\">    </span>&#123;</div><div class=\"line\">        Activity acy;</div><div class=\"line\">        <span class=\"keyword\">while</span> (acys.size() != <span class=\"number\">0</span>)</div><div class=\"line\">        &#123;</div><div class=\"line\">            acy = acys.poll();</div><div class=\"line\">            <span class=\"keyword\">if</span> (!acy.isFinishing())</div><div class=\"line\">            &#123;</div><div class=\"line\">                acy.finish();</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\"><span class=\"comment\">//        android.os.Process.killProcess(android.os.Process.myPid());</span></div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"3-activity-stack\"><a href=\"#3-activity-stack\" class=\"headerlink\" title=\"3.activity stack\"></a>3.activity stack</h3><p>Androidstack<br>DAIntentIntent.FLAG_ACTIVITY_CLEAR_TOPAActivity</p>\n<p>D:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Intent intent = <span class=\"keyword\">new</span> Intent();</div><div class=\"line\">intent.setClass(D.<span class=\"keyword\">this</span>, A.class);</div><div class=\"line\">intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);  <span class=\"comment\">//FLAG</span></div><div class=\"line\">startActivity(intent);</div><div class=\"line\">finish();</div></pre></td></tr></table></figure>\n<p>A</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">onNewIntent</span><span class=\"params\">(Intent intent)</span> </span>&#123; <span class=\"comment\">// TODO Auto-generated method stub</span></div><div class=\"line\">    <span class=\"keyword\">super</span>.onNewIntent(intent);</div><div class=\"line\">        <span class=\"comment\">//</span></div><div class=\"line\">    <span class=\"keyword\">if</span> ((Intent.FLAG_ACTIVITY_CLEAR_TOP &amp; intent.getFlags()) != <span class=\"number\">0</span>) &#123;</div><div class=\"line\">         finish();</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<pre><code>AManifest.xmlandroid:launchMode=&quot;singleTop&quot;\n</code></pre><p> ADAactivityIntent.FLAG_ACTIVITY_CLEAR_TOPBCAandroid:launchMode=singleTop oncreate(),onNewIntentIntent.FLAG_ACTIVITY_CLEAR_TOPA finish A,B,C,D</p>\n<h3 id=\"4-JNI\"><a href=\"#4-JNI\" class=\"headerlink\" title=\"4.JNI\"></a>4.JNI</h3><p><a href=\"http://blog.csdn.net/yyh352091626/article/details/50542554\">Android JNI</a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/09/22/quit-whole-application/\">http://agehua.github.io/2016/09/22/quit-whole-application/</a></p>"},{"layout":"post","title":"Android","keywords":"Android,","banner":"http://obxk8w81b.bkt.clouddn.com/Cottages%20Reminiscence%20of%20the%20North.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Cottages%20Reminiscence%20of%20the%20North.jpg","_content":"\n\nandroid\n\n#### 1.Android\nAndroid\n\n- (1) **Activity -> Window -> View**\nviewonTouchEventfalseonTouchEventActivity(ActivityonTouchEvent)\n\n<!--more-->\n- (2) view**onInterceptTouchEvent**\n- (3) viewACTION_DOWN********(onTouchEvent)ACTION_DOWNonTouchEvent**view**Activity\n- (4) ViewGroup**onInterceptTouchEvent**falseviewonInterceptTouchEventonTouchEvent\n- (5) View**onTouchEvent**(true)(clickablelongClickablefalse)viewlongClickablefalseclickableButtontrueTextViewfalse\n- (6) **ViewenableonTouchEvent**viewdisableclickablelongClickabletrueonTouchEventtrue\n- (7) ******view****requestDisallowInterceptTouchEvent********ACTION_DOWN**ACTION_DOWNViewGrouponInterceptTouchEvent\nViewGroupdispatchTouchEvent**FLAG_DISALLOW_INTERCEPT****viewrequestDisallowInterceptTouchEvent**trueViewGroup\n- (8) WindowPhoneWindowActivitycontentView\n\n~~~ Java\n((ViewGroup)getWindow().getDecorView().findViewById(android.R.id.content)).getChildAt(0);\n~~~\n\n#### 2.OnTouchListeneronTouchEventOnClickListener\nviewOnTouchListenerOnTouchListeneronTouch**onTouch**falseview**onTouchEvent**trueonTouchEvent\nonTouchEventviewOnClickListeneronClickOnClickListener\n\n#### 3.AsyncTask\n\n#### 4.Handler\n\n#### 5.\n\n#### 6.Android\n\n#### 7.\n- BroadcastReceiver\n- onReceive(Context,Intent)\n      Intent.getAction\n- Context.registerReceiver()IntentFilteraction\n\n\n#### 8.\n- JNI\n- \n- \n\n#### 9.Sqlite\nSQLiteOpenHelper:\n\n    super(Context context, String name, SQLiteDatabase.CursorFactory factory, int version)\n\n.version:\n\n    onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion)\n\nSQLite\n\n\n\n**SQLiteALTER TABLE**Subscription\n\n- ALTER TABLE Subscription ADD COLUMN Activation BLOB;\n- ALTER TABLE Subscription ADD COLUMN Key BLOB;\n\n****SqliteBLOB()\n\n****\n\n- 1Atemp_A\n- 2A\n- 3temp_AA\n\n\n\n~~~ Java\n//\npublic static final String TEMP_SQL_CREATE_TABLE_SUBSCRIBE = \"alter table \"\n            + A + \" rename to temp_A\";\n\n//temp_AcopyAA\npublic static final String INSERT_SUBSCRIBE = \"select 'insert into A (code,name,username,tablename)\n                        values (\"code\",\"name\",\"cnki\",\"tablename\")' as insertSQL from temp_A\";\n\n//\npublic static final String DELETE_TEMP_SUBSCRIBE = \"delete from temp_A \";\npublic static final String DROP_TEMP_SUBSCRIBE = \"drop table if exists temp_A\";\n\n@Override\npublic void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {\n\n        for (int j = oldVersion; j <= newVersion; j++) {\n            switch (j) {\n            case 2:\n//\n                db.execSQL(TEMP_SQL_CREATE_TABLE_SUBSCRIBE);\n //OnCreate\n                onCreate(db);\n//\n                for (int i = 0; i < arrWhereAct.length; i++) {\n                    db.execSQL(DELETE_TEMP_SUBSCRIBE + arrWhereAct[i]);\n                }\n\n                //A\nCursor cursor = db.rawQuery(INSERT_SUBSCRIBE, null);\n                if (cursor.moveToFirst()) {\n                    do {\n                        db.execSQL(cursor.getString(cursor\n                                .getColumnIndex(\"insertSQL\")));\n                    } while (cursor.moveToNext());\n                }\n\n                cursor.close();\n//\n                db.execSQL(DROP_TEMP_SUBSCRIBE);\n\n                break;\n\n            default:\n                break;\n            }\n        }\n}\n~~~\n\n> ****for14for\n\n\n#### 10.AIDL\nAIDL Java Android Java \n\n****AIDL .aidl .java\n\n****AIDL .aidl  Java Book.java  BookManager.aidl com.lypeer.aidldemo   .aidl  Book  .aidl  import com.lypeer.aidldemo.Book;  .java  .aidl \n\n   \n\n- Java byteshortintlongfloatdoublebooleanchar\n- String \n- CharSequence\n- ListListAIDLAIDLparcelableList\n- MapMapAIDLAIDLparcelableMap\n\n**tag**tagAIDLtag**in****out****inout******intagoutinouttag\n\nJava StringCharSequencetagintaginout\n\n**AIDL**AIDL**parcelable**AIDLAIDL****Android\nAIDL\n\nAIDL\n\n~~~ Java\n// Book.aidl\n//AIDL\n// Book AIDL\n//Book.aidlBook.java\npackage com.lypeer.ipcclient;\n\n//parcelable\nparcelable Book;\n\n// BookManager.aidl\n//AIDL\npackage com.lypeer.ipcclient;\n//\nimport com.lypeer.ipcclient.Book;\n\ninterface BookManager {\n\n    //\n    List<Book> getBooks();\n    Book getBook();\n    int getBookCount();\n\n    //JavaStringCharSequence\n    //tag\n    void setBookPrice(in Book book , int price)\n    void setBookName(in Book book , String name)\n    void addBookIn(in Book book);\n    void addBookOut(out Book book);\n    void addBookInout(inout Book book);\n}\n~~~\n\n\n#### 11.Android\n\n- (Hierarchy Viewer)\n- layoutopt\n- <include>\n- < merge />\n- ViewStub\n\n#### 12.Android\n- UI\n- ANR\n- \n- Android API\n        StringBuffer/StringHashMap/ArrayMap/SparseArray\n\n[Andoid](http://blog.csdn.net/yanbober/article/details/48394201)\n","source":"_posts/2016-09-28-Android-interview-questions.md","raw":"---\nlayout: post\ntitle:  Android\ncategory: accumulation\ntags:\n  - ANDROID\n  - Interview Knowledge\nkeywords: Android,\nbanner: http://obxk8w81b.bkt.clouddn.com/Cottages%20Reminiscence%20of%20the%20North.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Cottages%20Reminiscence%20of%20the%20North.jpg\n---\n\n\nandroid\n\n#### 1.Android\nAndroid\n\n- (1) **Activity -> Window -> View**\nviewonTouchEventfalseonTouchEventActivity(ActivityonTouchEvent)\n\n<!--more-->\n- (2) view**onInterceptTouchEvent**\n- (3) viewACTION_DOWN********(onTouchEvent)ACTION_DOWNonTouchEvent**view**Activity\n- (4) ViewGroup**onInterceptTouchEvent**falseviewonInterceptTouchEventonTouchEvent\n- (5) View**onTouchEvent**(true)(clickablelongClickablefalse)viewlongClickablefalseclickableButtontrueTextViewfalse\n- (6) **ViewenableonTouchEvent**viewdisableclickablelongClickabletrueonTouchEventtrue\n- (7) ******view****requestDisallowInterceptTouchEvent********ACTION_DOWN**ACTION_DOWNViewGrouponInterceptTouchEvent\nViewGroupdispatchTouchEvent**FLAG_DISALLOW_INTERCEPT****viewrequestDisallowInterceptTouchEvent**trueViewGroup\n- (8) WindowPhoneWindowActivitycontentView\n\n~~~ Java\n((ViewGroup)getWindow().getDecorView().findViewById(android.R.id.content)).getChildAt(0);\n~~~\n\n#### 2.OnTouchListeneronTouchEventOnClickListener\nviewOnTouchListenerOnTouchListeneronTouch**onTouch**falseview**onTouchEvent**trueonTouchEvent\nonTouchEventviewOnClickListeneronClickOnClickListener\n\n#### 3.AsyncTask\n\n#### 4.Handler\n\n#### 5.\n\n#### 6.Android\n\n#### 7.\n- BroadcastReceiver\n- onReceive(Context,Intent)\n      Intent.getAction\n- Context.registerReceiver()IntentFilteraction\n\n\n#### 8.\n- JNI\n- \n- \n\n#### 9.Sqlite\nSQLiteOpenHelper:\n\n    super(Context context, String name, SQLiteDatabase.CursorFactory factory, int version)\n\n.version:\n\n    onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion)\n\nSQLite\n\n\n\n**SQLiteALTER TABLE**Subscription\n\n- ALTER TABLE Subscription ADD COLUMN Activation BLOB;\n- ALTER TABLE Subscription ADD COLUMN Key BLOB;\n\n****SqliteBLOB()\n\n****\n\n- 1Atemp_A\n- 2A\n- 3temp_AA\n\n\n\n~~~ Java\n//\npublic static final String TEMP_SQL_CREATE_TABLE_SUBSCRIBE = \"alter table \"\n            + A + \" rename to temp_A\";\n\n//temp_AcopyAA\npublic static final String INSERT_SUBSCRIBE = \"select 'insert into A (code,name,username,tablename)\n                        values (\"code\",\"name\",\"cnki\",\"tablename\")' as insertSQL from temp_A\";\n\n//\npublic static final String DELETE_TEMP_SUBSCRIBE = \"delete from temp_A \";\npublic static final String DROP_TEMP_SUBSCRIBE = \"drop table if exists temp_A\";\n\n@Override\npublic void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {\n\n        for (int j = oldVersion; j <= newVersion; j++) {\n            switch (j) {\n            case 2:\n//\n                db.execSQL(TEMP_SQL_CREATE_TABLE_SUBSCRIBE);\n //OnCreate\n                onCreate(db);\n//\n                for (int i = 0; i < arrWhereAct.length; i++) {\n                    db.execSQL(DELETE_TEMP_SUBSCRIBE + arrWhereAct[i]);\n                }\n\n                //A\nCursor cursor = db.rawQuery(INSERT_SUBSCRIBE, null);\n                if (cursor.moveToFirst()) {\n                    do {\n                        db.execSQL(cursor.getString(cursor\n                                .getColumnIndex(\"insertSQL\")));\n                    } while (cursor.moveToNext());\n                }\n\n                cursor.close();\n//\n                db.execSQL(DROP_TEMP_SUBSCRIBE);\n\n                break;\n\n            default:\n                break;\n            }\n        }\n}\n~~~\n\n> ****for14for\n\n\n#### 10.AIDL\nAIDL Java Android Java \n\n****AIDL .aidl .java\n\n****AIDL .aidl  Java Book.java  BookManager.aidl com.lypeer.aidldemo   .aidl  Book  .aidl  import com.lypeer.aidldemo.Book;  .java  .aidl \n\n   \n\n- Java byteshortintlongfloatdoublebooleanchar\n- String \n- CharSequence\n- ListListAIDLAIDLparcelableList\n- MapMapAIDLAIDLparcelableMap\n\n**tag**tagAIDLtag**in****out****inout******intagoutinouttag\n\nJava StringCharSequencetagintaginout\n\n**AIDL**AIDL**parcelable**AIDLAIDL****Android\nAIDL\n\nAIDL\n\n~~~ Java\n// Book.aidl\n//AIDL\n// Book AIDL\n//Book.aidlBook.java\npackage com.lypeer.ipcclient;\n\n//parcelable\nparcelable Book;\n\n// BookManager.aidl\n//AIDL\npackage com.lypeer.ipcclient;\n//\nimport com.lypeer.ipcclient.Book;\n\ninterface BookManager {\n\n    //\n    List<Book> getBooks();\n    Book getBook();\n    int getBookCount();\n\n    //JavaStringCharSequence\n    //tag\n    void setBookPrice(in Book book , int price)\n    void setBookName(in Book book , String name)\n    void addBookIn(in Book book);\n    void addBookOut(out Book book);\n    void addBookInout(inout Book book);\n}\n~~~\n\n\n#### 11.Android\n\n- (Hierarchy Viewer)\n- layoutopt\n- <include>\n- < merge />\n- ViewStub\n\n#### 12.Android\n- UI\n- ANR\n- \n- Android API\n        StringBuffer/StringHashMap/ArrayMap/SparseArray\n\n[Andoid](http://blog.csdn.net/yanbober/article/details/48394201)\n","slug":"Android-interview-questions","published":1,"date":"2016-09-27T16:00:00.000Z","updated":"2017-11-23T07:24:55.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ebyx001vd6yk1k19obak","content":"<p>android</p>\n<h4 id=\"1-Android\"><a href=\"#1-Android\" class=\"headerlink\" title=\"1.Android\"></a>1.Android</h4><p>Android</p>\n<ul>\n<li>(1) <strong>Activity -&gt; Window -&gt; View</strong><br>viewonTouchEventfalseonTouchEventActivity(ActivityonTouchEvent)</li>\n</ul>\n<a id=\"more\"></a>\n<ul>\n<li>(2) view<strong>onInterceptTouchEvent</strong></li>\n<li>(3) viewACTION_DOWN<strong></strong><strong></strong>(onTouchEvent)ACTION_DOWNonTouchEvent<strong>view</strong>Activity</li>\n<li>(4) ViewGroup<strong>onInterceptTouchEvent</strong>falseviewonInterceptTouchEventonTouchEvent</li>\n<li>(5) View<strong>onTouchEvent</strong>(true)(clickablelongClickablefalse)viewlongClickablefalseclickableButtontrueTextViewfalse</li>\n<li>(6) <strong>ViewenableonTouchEvent</strong>viewdisableclickablelongClickabletrueonTouchEventtrue</li>\n<li>(7) <strong></strong><strong>view</strong><strong>requestDisallowInterceptTouchEvent</strong><strong></strong><strong>ACTION_DOWN</strong>ACTION_DOWNViewGrouponInterceptTouchEvent<br>ViewGroupdispatchTouchEvent<strong>FLAG_DISALLOW_INTERCEPT</strong><strong>viewrequestDisallowInterceptTouchEvent</strong>trueViewGroup</li>\n<li>(8) WindowPhoneWindowActivitycontentView</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">((ViewGroup)getWindow().getDecorView().findViewById(android.R.id.content)).getChildAt(<span class=\"number\">0</span>);</div></pre></td></tr></table></figure>\n<h4 id=\"2-OnTouchListeneronTouchEventOnClickListener\"><a href=\"#2-OnTouchListeneronTouchEventOnClickListener\" class=\"headerlink\" title=\"2.OnTouchListeneronTouchEventOnClickListener\"></a>2.OnTouchListeneronTouchEventOnClickListener</h4><p>viewOnTouchListenerOnTouchListeneronTouch<strong>onTouch</strong>falseview<strong>onTouchEvent</strong>trueonTouchEvent<br>onTouchEventviewOnClickListeneronClickOnClickListener</p>\n<h4 id=\"3-AsyncTask\"><a href=\"#3-AsyncTask\" class=\"headerlink\" title=\"3.AsyncTask\"></a>3.AsyncTask</h4><h4 id=\"4-Handler\"><a href=\"#4-Handler\" class=\"headerlink\" title=\"4.Handler\"></a>4.Handler</h4><h4 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5.\"></a>5.</h4><h4 id=\"6-Android\"><a href=\"#6-Android\" class=\"headerlink\" title=\"6.Android\"></a>6.Android</h4><h4 id=\"7-\"><a href=\"#7-\" class=\"headerlink\" title=\"7.\"></a>7.</h4><ul>\n<li>BroadcastReceiver</li>\n<li>onReceive(Context,Intent)<pre><code>Intent.getAction\n</code></pre></li>\n<li>Context.registerReceiver()IntentFilteraction</li>\n</ul>\n<h4 id=\"8-\"><a href=\"#8-\" class=\"headerlink\" title=\"8.\"></a>8.</h4><ul>\n<li>JNI</li>\n<li></li>\n<li></li>\n</ul>\n<h4 id=\"9-Sqlite\"><a href=\"#9-Sqlite\" class=\"headerlink\" title=\"9.Sqlite\"></a>9.Sqlite</h4><p>SQLiteOpenHelper:</p>\n<pre><code>super(Context context, String name, SQLiteDatabase.CursorFactory factory, int version)\n</code></pre><p>.version:</p>\n<pre><code>onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion)\n</code></pre><p>SQLite</p>\n<p></p>\n<p><strong>SQLiteALTER TABLE</strong>Subscription</p>\n<ul>\n<li>ALTER TABLE Subscription ADD COLUMN Activation BLOB;</li>\n<li>ALTER TABLE Subscription ADD COLUMN Key BLOB;</li>\n</ul>\n<p><strong></strong>SqliteBLOB()</p>\n<p><strong></strong></p>\n<ul>\n<li>1Atemp_A</li>\n<li>2A</li>\n<li>3temp_AA</li>\n</ul>\n<p></p>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><div class=\"line\">//</div><div class=\"line\">public static final String TEMP_SQL_CREATE_TABLE_SUBSCRIBE = \"alter table \"</div><div class=\"line\">            + A + \" rename to temp_A\";</div><div class=\"line\"></div><div class=\"line\">//temp_AcopyAA</div><div class=\"line\">public static final String INSERT_SUBSCRIBE = \"select 'insert into A (code,name,username,tablename)</div><div class=\"line\">                        values (\"code\",\"name\",\"cnki\",\"tablename\")' as insertSQL from temp_A\";</div><div class=\"line\"></div><div class=\"line\">//</div><div class=\"line\">public static final String DELETE_TEMP_SUBSCRIBE = \"delete from temp_A \";</div><div class=\"line\">public static final String DROP_TEMP_SUBSCRIBE = \"drop table if exists temp_A\";</div><div class=\"line\"></div><div class=\"line\">@Override</div><div class=\"line\">public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) &#123;</div><div class=\"line\"></div><div class=\"line\">        for (int j = oldVersion; j &lt;= newVersion; j++) &#123;</div><div class=\"line\">            switch (j) &#123;</div><div class=\"line\">            case 2:</div><div class=\"line\">//</div><div class=\"line\">                db.execSQL(TEMP_SQL_CREATE_TABLE_SUBSCRIBE);</div><div class=\"line\"> //OnCreate</div><div class=\"line\">                onCreate(db);</div><div class=\"line\">//</div><div class=\"line\">                for (int i = 0; i &lt; arrWhereAct.length; i++) &#123;</div><div class=\"line\">                    db.execSQL(DELETE_TEMP_SUBSCRIBE + arrWhereAct[i]);</div><div class=\"line\">                &#125;</div><div class=\"line\"></div><div class=\"line\">                //A</div><div class=\"line\">Cursor cursor = db.rawQuery(INSERT_SUBSCRIBE, null);</div><div class=\"line\">                if (cursor.moveToFirst()) &#123;</div><div class=\"line\">                    do &#123;</div><div class=\"line\">                        db.execSQL(cursor.getString(cursor</div><div class=\"line\">                                .getColumnIndex(\"insertSQL\")));</div><div class=\"line\">                    &#125; while (cursor.moveToNext());</div><div class=\"line\">                &#125;</div><div class=\"line\"></div><div class=\"line\">                cursor.close();</div><div class=\"line\">//</div><div class=\"line\">                db.execSQL(DROP_TEMP_SUBSCRIBE);</div><div class=\"line\"></div><div class=\"line\">                break;</div><div class=\"line\"></div><div class=\"line\">            default:</div><div class=\"line\">                break;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<blockquote>\n<p><strong></strong>for14for</p>\n</blockquote>\n<h4 id=\"10-AIDL\"><a href=\"#10-AIDL\" class=\"headerlink\" title=\"10.AIDL\"></a>10.AIDL</h4><p>AIDL Java Android Java </p>\n<p><strong></strong>AIDL .aidl .java</p>\n<p><strong></strong>AIDL .aidl  Java Book.java  BookManager.aidl com.lypeer.aidldemo   .aidl  Book  .aidl  import com.lypeer.aidldemo.Book;  .java  .aidl </p>\n<p>   </p>\n<ul>\n<li>Java byteshortintlongfloatdoublebooleanchar</li>\n<li>String </li>\n<li>CharSequence</li>\n<li>ListListAIDLAIDLparcelableList</li>\n<li>MapMapAIDLAIDLparcelableMap</li>\n</ul>\n<p><strong>tag</strong>tagAIDLtag<strong>in</strong><strong>out</strong><strong>inout</strong><strong></strong>intagoutinouttag</p>\n<p>Java StringCharSequencetagintaginout</p>\n<p><strong>AIDL</strong>AIDL<strong>parcelable</strong>AIDLAIDL<strong></strong>Android<br>AIDL</p>\n<p>AIDL</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// Book.aidl</span></div><div class=\"line\"><span class=\"comment\">//AIDL</span></div><div class=\"line\"><span class=\"comment\">// Book AIDL</span></div><div class=\"line\"><span class=\"comment\">//Book.aidlBook.java</span></div><div class=\"line\"><span class=\"keyword\">package</span> com.lypeer.ipcclient;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">//parcelable</span></div><div class=\"line\">parcelable Book;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// BookManager.aidl</span></div><div class=\"line\"><span class=\"comment\">//AIDL</span></div><div class=\"line\"><span class=\"keyword\">package</span> com.lypeer.ipcclient;</div><div class=\"line\"><span class=\"comment\">//</span></div><div class=\"line\"><span class=\"keyword\">import</span> com.lypeer.ipcclient.Book;</div><div class=\"line\"></div><div class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">BookManager</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//</span></div><div class=\"line\">    <span class=\"function\">List&lt;Book&gt; <span class=\"title\">getBooks</span><span class=\"params\">()</span></span>;</div><div class=\"line\">    <span class=\"function\">Book <span class=\"title\">getBook</span><span class=\"params\">()</span></span>;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">getBookCount</span><span class=\"params\">()</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//JavaStringCharSequence</span></div><div class=\"line\">    <span class=\"comment\">//tag</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">setBookPrice</span><span class=\"params\">(in Book book , <span class=\"keyword\">int</span> price)</span></span></div><div class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title\">setBookName</span><span class=\"params\">(in Book book , String name)</span></div><div class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title\">addBookIn</span><span class=\"params\">(in Book book)</span>;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">addBookOut</span><span class=\"params\">(out Book book)</span></span>;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">addBookInout</span><span class=\"params\">(inout Book book)</span></span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h4 id=\"11-Android\"><a href=\"#11-Android\" class=\"headerlink\" title=\"11.Android\"></a>11.Android</h4><ul>\n<li>(Hierarchy Viewer)</li>\n<li>layoutopt</li>\n<li><include></include></li>\n<li>&lt; merge /&gt;</li>\n<li>ViewStub</li>\n</ul>\n<h4 id=\"12-Android\"><a href=\"#12-Android\" class=\"headerlink\" title=\"12.Android\"></a>12.Android</h4><ul>\n<li>UI</li>\n<li>ANR</li>\n<li></li>\n<li>Android API<pre><code>StringBuffer/StringHashMap/ArrayMap/SparseArray\n</code></pre></li>\n</ul>\n<p><a href=\"http://blog.csdn.net/yanbober/article/details/48394201\" target=\"_blank\" rel=\"external\">Andoid</a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/09/28/Android-interview-questions/\">http://agehua.github.io/2016/09/28/Android-interview-questions/</a></p>\n","readingTime":{"text":"3 min read","minutes":2.52,"time":151200,"words":504},"excerpt":"<p>android</p>\n<h4 id=\"1-Android\"><a href=\"#1-Android\" class=\"headerlink\" title=\"1.Android\"></a>1.Android</h4><p>Android</p>\n<ul>\n<li>(1) <strong>Activity -&gt; Window -&gt; View</strong><br>viewonTouchEventfalseonTouchEventActivity(ActivityonTouchEvent)</li>\n</ul>","more":"<ul>\n<li>(2) view<strong>onInterceptTouchEvent</strong></li>\n<li>(3) viewACTION_DOWN<strong></strong><strong></strong>(onTouchEvent)ACTION_DOWNonTouchEvent<strong>view</strong>Activity</li>\n<li>(4) ViewGroup<strong>onInterceptTouchEvent</strong>falseviewonInterceptTouchEventonTouchEvent</li>\n<li>(5) View<strong>onTouchEvent</strong>(true)(clickablelongClickablefalse)viewlongClickablefalseclickableButtontrueTextViewfalse</li>\n<li>(6) <strong>ViewenableonTouchEvent</strong>viewdisableclickablelongClickabletrueonTouchEventtrue</li>\n<li>(7) <strong></strong><strong>view</strong><strong>requestDisallowInterceptTouchEvent</strong><strong></strong><strong>ACTION_DOWN</strong>ACTION_DOWNViewGrouponInterceptTouchEvent<br>ViewGroupdispatchTouchEvent<strong>FLAG_DISALLOW_INTERCEPT</strong><strong>viewrequestDisallowInterceptTouchEvent</strong>trueViewGroup</li>\n<li>(8) WindowPhoneWindowActivitycontentView</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">((ViewGroup)getWindow().getDecorView().findViewById(android.R.id.content)).getChildAt(<span class=\"number\">0</span>);</div></pre></td></tr></table></figure>\n<h4 id=\"2-OnTouchListeneronTouchEventOnClickListener\"><a href=\"#2-OnTouchListeneronTouchEventOnClickListener\" class=\"headerlink\" title=\"2.OnTouchListeneronTouchEventOnClickListener\"></a>2.OnTouchListeneronTouchEventOnClickListener</h4><p>viewOnTouchListenerOnTouchListeneronTouch<strong>onTouch</strong>falseview<strong>onTouchEvent</strong>trueonTouchEvent<br>onTouchEventviewOnClickListeneronClickOnClickListener</p>\n<h4 id=\"3-AsyncTask\"><a href=\"#3-AsyncTask\" class=\"headerlink\" title=\"3.AsyncTask\"></a>3.AsyncTask</h4><h4 id=\"4-Handler\"><a href=\"#4-Handler\" class=\"headerlink\" title=\"4.Handler\"></a>4.Handler</h4><h4 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5.\"></a>5.</h4><h4 id=\"6-Android\"><a href=\"#6-Android\" class=\"headerlink\" title=\"6.Android\"></a>6.Android</h4><h4 id=\"7-\"><a href=\"#7-\" class=\"headerlink\" title=\"7.\"></a>7.</h4><ul>\n<li>BroadcastReceiver</li>\n<li>onReceive(Context,Intent)<pre><code>Intent.getAction\n</code></pre></li>\n<li>Context.registerReceiver()IntentFilteraction</li>\n</ul>\n<h4 id=\"8-\"><a href=\"#8-\" class=\"headerlink\" title=\"8.\"></a>8.</h4><ul>\n<li>JNI</li>\n<li></li>\n<li></li>\n</ul>\n<h4 id=\"9-Sqlite\"><a href=\"#9-Sqlite\" class=\"headerlink\" title=\"9.Sqlite\"></a>9.Sqlite</h4><p>SQLiteOpenHelper:</p>\n<pre><code>super(Context context, String name, SQLiteDatabase.CursorFactory factory, int version)\n</code></pre><p>.version:</p>\n<pre><code>onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion)\n</code></pre><p>SQLite</p>\n<p></p>\n<p><strong>SQLiteALTER TABLE</strong>Subscription</p>\n<ul>\n<li>ALTER TABLE Subscription ADD COLUMN Activation BLOB;</li>\n<li>ALTER TABLE Subscription ADD COLUMN Key BLOB;</li>\n</ul>\n<p><strong></strong>SqliteBLOB()</p>\n<p><strong></strong></p>\n<ul>\n<li>1Atemp_A</li>\n<li>2A</li>\n<li>3temp_AA</li>\n</ul>\n<p></p>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><div class=\"line\">//</div><div class=\"line\">public static final String TEMP_SQL_CREATE_TABLE_SUBSCRIBE = \"alter table \"</div><div class=\"line\">            + A + \" rename to temp_A\";</div><div class=\"line\"></div><div class=\"line\">//temp_AcopyAA</div><div class=\"line\">public static final String INSERT_SUBSCRIBE = \"select 'insert into A (code,name,username,tablename)</div><div class=\"line\">                        values (\"code\",\"name\",\"cnki\",\"tablename\")' as insertSQL from temp_A\";</div><div class=\"line\"></div><div class=\"line\">//</div><div class=\"line\">public static final String DELETE_TEMP_SUBSCRIBE = \"delete from temp_A \";</div><div class=\"line\">public static final String DROP_TEMP_SUBSCRIBE = \"drop table if exists temp_A\";</div><div class=\"line\"></div><div class=\"line\">@Override</div><div class=\"line\">public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) &#123;</div><div class=\"line\"></div><div class=\"line\">        for (int j = oldVersion; j &lt;= newVersion; j++) &#123;</div><div class=\"line\">            switch (j) &#123;</div><div class=\"line\">            case 2:</div><div class=\"line\">//</div><div class=\"line\">                db.execSQL(TEMP_SQL_CREATE_TABLE_SUBSCRIBE);</div><div class=\"line\"> //OnCreate</div><div class=\"line\">                onCreate(db);</div><div class=\"line\">//</div><div class=\"line\">                for (int i = 0; i &lt; arrWhereAct.length; i++) &#123;</div><div class=\"line\">                    db.execSQL(DELETE_TEMP_SUBSCRIBE + arrWhereAct[i]);</div><div class=\"line\">                &#125;</div><div class=\"line\"></div><div class=\"line\">                //A</div><div class=\"line\">Cursor cursor = db.rawQuery(INSERT_SUBSCRIBE, null);</div><div class=\"line\">                if (cursor.moveToFirst()) &#123;</div><div class=\"line\">                    do &#123;</div><div class=\"line\">                        db.execSQL(cursor.getString(cursor</div><div class=\"line\">                                .getColumnIndex(\"insertSQL\")));</div><div class=\"line\">                    &#125; while (cursor.moveToNext());</div><div class=\"line\">                &#125;</div><div class=\"line\"></div><div class=\"line\">                cursor.close();</div><div class=\"line\">//</div><div class=\"line\">                db.execSQL(DROP_TEMP_SUBSCRIBE);</div><div class=\"line\"></div><div class=\"line\">                break;</div><div class=\"line\"></div><div class=\"line\">            default:</div><div class=\"line\">                break;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<blockquote>\n<p><strong></strong>for14for</p>\n</blockquote>\n<h4 id=\"10-AIDL\"><a href=\"#10-AIDL\" class=\"headerlink\" title=\"10.AIDL\"></a>10.AIDL</h4><p>AIDL Java Android Java </p>\n<p><strong></strong>AIDL .aidl .java</p>\n<p><strong></strong>AIDL .aidl  Java Book.java  BookManager.aidl com.lypeer.aidldemo   .aidl  Book  .aidl  import com.lypeer.aidldemo.Book;  .java  .aidl </p>\n<p>   </p>\n<ul>\n<li>Java byteshortintlongfloatdoublebooleanchar</li>\n<li>String </li>\n<li>CharSequence</li>\n<li>ListListAIDLAIDLparcelableList</li>\n<li>MapMapAIDLAIDLparcelableMap</li>\n</ul>\n<p><strong>tag</strong>tagAIDLtag<strong>in</strong><strong>out</strong><strong>inout</strong><strong></strong>intagoutinouttag</p>\n<p>Java StringCharSequencetagintaginout</p>\n<p><strong>AIDL</strong>AIDL<strong>parcelable</strong>AIDLAIDL<strong></strong>Android<br>AIDL</p>\n<p>AIDL</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// Book.aidl</span></div><div class=\"line\"><span class=\"comment\">//AIDL</span></div><div class=\"line\"><span class=\"comment\">// Book AIDL</span></div><div class=\"line\"><span class=\"comment\">//Book.aidlBook.java</span></div><div class=\"line\"><span class=\"keyword\">package</span> com.lypeer.ipcclient;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">//parcelable</span></div><div class=\"line\">parcelable Book;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// BookManager.aidl</span></div><div class=\"line\"><span class=\"comment\">//AIDL</span></div><div class=\"line\"><span class=\"keyword\">package</span> com.lypeer.ipcclient;</div><div class=\"line\"><span class=\"comment\">//</span></div><div class=\"line\"><span class=\"keyword\">import</span> com.lypeer.ipcclient.Book;</div><div class=\"line\"></div><div class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">BookManager</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//</span></div><div class=\"line\">    <span class=\"function\">List&lt;Book&gt; <span class=\"title\">getBooks</span><span class=\"params\">()</span></span>;</div><div class=\"line\">    <span class=\"function\">Book <span class=\"title\">getBook</span><span class=\"params\">()</span></span>;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">getBookCount</span><span class=\"params\">()</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//JavaStringCharSequence</span></div><div class=\"line\">    <span class=\"comment\">//tag</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">setBookPrice</span><span class=\"params\">(in Book book , <span class=\"keyword\">int</span> price)</span></div><div class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title\">setBookName</span><span class=\"params\">(in Book book , String name)</span></div><div class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title\">addBookIn</span><span class=\"params\">(in Book book)</span></span>;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">addBookOut</span><span class=\"params\">(out Book book)</span></span>;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">addBookInout</span><span class=\"params\">(inout Book book)</span></span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h4 id=\"11-Android\"><a href=\"#11-Android\" class=\"headerlink\" title=\"11.Android\"></a>11.Android</h4><ul>\n<li>(Hierarchy Viewer)</li>\n<li>layoutopt</li>\n<li><include></li>\n<li>&lt; merge /&gt;</li>\n<li>ViewStub</li>\n</ul>\n<h4 id=\"12-Android\"><a href=\"#12-Android\" class=\"headerlink\" title=\"12.Android\"></a>12.Android</h4><ul>\n<li>UI</li>\n<li>ANR</li>\n<li></li>\n<li>Android API<pre><code>StringBuffer/StringHashMap/ArrayMap/SparseArray\n</code></pre></li>\n</ul>\n<p><a href=\"http://blog.csdn.net/yanbober/article/details/48394201\">Andoid</a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/09/28/Android-interview-questions/\">http://agehua.github.io/2016/09/28/Android-interview-questions/</a></p>"},{"layout":"post","title":"Hexo ","keywords":"Hexo","banner":"http://obxk8w81b.bkt.clouddn.com/Couple%20Out%20for%20a%20Stroll.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Couple%20Out%20for%20a%20Stroll.jpg","_content":"\n#### Error: Cannot find module './build/Release/DTraceProviderBindings'\n\nhexomodule ctrl+chexo\n~~~ Java\n{ [Error: Cannot find module './build/Release/DTraceProviderBindings'] code: 'MODULE_NOT_FOUND' }    \n{ [Error: Cannot find module './build/default/DTraceProviderBindings'] code: 'MODULE_NOT_FOUND' }\n{ [Error: Cannot find module './build/Debug/DTraceProviderBindings'] code: 'MODULE_NOT_FOUND' }\n~~~\n<!--more-->\n\n\n**1. Hexohexo**\n\n-  /usr/local/lib/node_modules/ **hexo**\n- /usr/local/bin/ **hexo**. .\n> finderTerminal\ndefaults write com.apple.finder AppleShowAllFiles -bool true\n\n**2. npm install -g hexo --save**\n\n  :)\n","source":"_posts/2016-11-03-hexo-mac-module-not-found.md","raw":"---\nlayout: post\ntitle:  Hexo \ncategory: accumulation\ntags:\n  - Hexo\nkeywords: Hexo\nbanner: http://obxk8w81b.bkt.clouddn.com/Couple%20Out%20for%20a%20Stroll.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Couple%20Out%20for%20a%20Stroll.jpg\n---\n\n#### Error: Cannot find module './build/Release/DTraceProviderBindings'\n\nhexomodule ctrl+chexo\n~~~ Java\n{ [Error: Cannot find module './build/Release/DTraceProviderBindings'] code: 'MODULE_NOT_FOUND' }    \n{ [Error: Cannot find module './build/default/DTraceProviderBindings'] code: 'MODULE_NOT_FOUND' }\n{ [Error: Cannot find module './build/Debug/DTraceProviderBindings'] code: 'MODULE_NOT_FOUND' }\n~~~\n<!--more-->\n\n\n**1. Hexohexo**\n\n-  /usr/local/lib/node_modules/ **hexo**\n- /usr/local/bin/ **hexo**. .\n> finderTerminal\ndefaults write com.apple.finder AppleShowAllFiles -bool true\n\n**2. npm install -g hexo --save**\n\n  :)\n","slug":"hexo-mac-module-not-found","published":1,"date":"2016-11-02T16:00:00.000Z","updated":"2017-11-23T07:09:46.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ebz3001yd6ykf5kdyo3u","content":"<h4 id=\"Error-Cannot-find-module--build-Release-DTraceProviderBindings\"><a href=\"#Error-Cannot-find-module--build-Release-DTraceProviderBindings\" class=\"headerlink\" title=\"Error: Cannot find module ./build/Release/DTraceProviderBindings\"></a>Error: Cannot find module ./build/Release/DTraceProviderBindings</h4><p>hexomodule ctrl+chexo<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">&#123; [Error: Cannot find <span class=\"keyword\">module</span> <span class=\"string\">'./build/Release/DTraceProviderBindings'</span>] code: <span class=\"string\">'MODULE_NOT_FOUND'</span> &#125;    </div><div class=\"line\">&#123; [Error: Cannot find <span class=\"keyword\">module</span> <span class=\"string\">'./build/default/DTraceProviderBindings'</span>] code: <span class=\"string\">'MODULE_NOT_FOUND'</span> &#125;</div><div class=\"line\">&#123; [Error: Cannot find <span class=\"keyword\">module</span> <span class=\"string\">'./build/Debug/DTraceProviderBindings'</span>] code: <span class=\"string\">'MODULE_NOT_FOUND'</span> &#125;</div></pre></td></tr></table></figure></p>\n<a id=\"more\"></a>\n<p></p>\n<p><strong>1. Hexohexo</strong></p>\n<ul>\n<li> /usr/local/lib/node_modules/ <strong>hexo</strong></li>\n<li>/usr/local/bin/ <strong>hexo</strong>. .<blockquote>\n<p>finderTerminal<br>defaults write com.apple.finder AppleShowAllFiles -bool true</p>\n</blockquote>\n</li>\n</ul>\n<p><strong>2. npm install -g hexo save</strong></p>\n<p>  :)</p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/11/03/hexo-mac-module-not-found/\">http://agehua.github.io/2016/11/03/hexo-mac-module-not-found/</a></p>\n","readingTime":{"text":"1 min read","minutes":0.47,"time":28200,"words":94},"excerpt":"<h4 id=\"Error-Cannot-find-module--build-Release-DTraceProviderBindings\"><a href=\"#Error-Cannot-find-module--build-Release-DTraceProviderBindings\" class=\"headerlink\" title=\"Error: Cannot find module ./build/Release/DTraceProviderBindings\"></a>Error: Cannot find module ./build/Release/DTraceProviderBindings</h4><p>hexomodule ctrl+chexo<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">&#123; [Error: Cannot find <span class=\"keyword\">module</span> <span class=\"string\">'./build/Release/DTraceProviderBindings'</span>] code: <span class=\"string\">'MODULE_NOT_FOUND'</span> &#125;    </div><div class=\"line\">&#123; [Error: Cannot find <span class=\"keyword\">module</span> <span class=\"string\">'./build/default/DTraceProviderBindings'</span>] code: <span class=\"string\">'MODULE_NOT_FOUND'</span> &#125;</div><div class=\"line\">&#123; [Error: Cannot find <span class=\"keyword\">module</span> <span class=\"string\">'./build/Debug/DTraceProviderBindings'</span>] code: <span class=\"string\">'MODULE_NOT_FOUND'</span> &#125;</div></pre></td></tr></table></figure></p>","more":"<p></p>\n<p><strong>1. Hexohexo</strong></p>\n<ul>\n<li> /usr/local/lib/node_modules/ <strong>hexo</strong></li>\n<li>/usr/local/bin/ <strong>hexo</strong>. .<blockquote>\n<p>finderTerminal<br>defaults write com.apple.finder AppleShowAllFiles -bool true</p>\n</blockquote>\n</li>\n</ul>\n<p><strong>2. npm install -g hexo save</strong></p>\n<p>  :)</p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/11/03/hexo-mac-module-not-found/\">http://agehua.github.io/2016/11/03/hexo-mac-module-not-found/</a></p>"},{"layout":"post","title":"gradle 2apk","keywords":"Android,gradle","banner":"http://obxk8w81b.bkt.clouddn.com/Cart%20with%20Red%20and%20White%20Ox.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Cart%20with%20Red%20and%20White%20Ox.jpg","_content":"\n[Gradle]()GradleAndroidGradleAPK\n\n### \nAndroidSITUATPRDAPK\n\nJavaapp-release.apk\n\ngradle\n\n> \n- buildType\n- productFlavors \n\n<!--more-->\n#### buildType\n\nAndroid Plugindebugrelease APK\n\nbuildTypeinitWith()\n\n\n\n|*Property name\t*|*Default values for debug\t*|*Default values for release / other*|\n|:--------:|:-------:|:--------:|\n|debuggable\t            | true\t|false |\n|jniDebugBuild\t        | false\t|false|\n|renderscriptDebugBuild\t| false\t|false|\n|renderscriptOptimLevel\t|   3\t|3|\n|applicationIdSuffix\t|  null\t|null|\n|versionNameSuffix\t    |  null\t|null|\n|signingConfig\t  |android.signingConfigs.debug\t|null|\n|zipAlign\t             |false\t|true|\n|runProguard\t         |false\t|false|\n|proguardFile\t     |N/A (set only)\t|N/A (set only)|\n|proguardFiles\t     |N/A (set only)\t|N/A (set only)|\n\n[Gralde plugin User Guide ](https://avatarqing.gitbooks.io/gradlepluginuserguidechineseverision/content/basic_project/build_types.html)\n\n\n#### Product flavors\nproduct flavorflavor\n\n\n\nProduct flavorproductFlavorsDSL\n\n~~~ Java\nandroid {\n    ....\n\n    productFlavors {\n        flavor1 {\n            ...\n        }\n\n        flavor2 {\n            ...\n        }\n    }\n}\n~~~\nflavorflavor1flavor2\n\n> flavorBuild TypeandroidTestsourceSet\n\n#### Build Type + Product Flavor = Build Variant+=\nBuild TypeAPK\n\nProduct FlavorBuild TypeProduct FlavorFlavor\n\nBuild TypeProduct FlavorBuild Variant\n\nFlavordebugreleaseBuild Type4Build Variant\n\n- Flavor1 - debug\n- Flavor1 - release\n- Flavor2 - debug\n- Flavor2 - release\n\nflavorBuild Variantflavordefault()flavor/configBuild VariantBuild Type\n\n### \n**Build Type****Product Flavor**\n**Build Type**\n\n~~~ Java\nbuildTypes {\n        release {\n            buildConfigField \"boolean\", \"LEO_DEBUG\", \"false\"\n            minifyEnabled true\n            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.txt'\n            debuggable false\n            jniDebuggable false\n        }\n        debug {\n            buildConfigField \"int\", \"buildType\", \"2\"\n            buildConfigField \"boolean\", \"LEO_DEBUG\", \"true\"\n        }\n    }\n~~~\n**Product Flavor**\n\n~~~ Java\nproductFlavors{\n\tkaifa{\n\t\tbuildConfigField \"int\", \"buildType\", \"1\"\n\t}\n\tceshi {\n\t\tbuildConfigField \"int\", \"buildType\", \"2\"\n\t}\n\tSIT {\n\t\tbuildConfigField \"int\", \"buildType\", \"3\"\n\t}\n\tUAT {\n\t\tbuildConfigField \"int\", \"buildType\", \"4\"\n\t}\n\tPRD {\n\t\tbuildConfigField \"int\", \"buildType\", \"5\"\n\t}\n}\n~~~\nproductFlavors**app->build->generated->source->buildConfig**flavor\n\n![Gradle build structure](http://oui2w5whj.bkt.clouddn.com/blogimages/2016/gradle_structure2.png)\n\nbuildConfigField**flavor->release/debug->**BuildConfig.javaBuildConfig.javaintbuildTypebooleanLEO_DEBUG:\n\n~~~ Java\nif (BuildConfig.LEO_DEBUG){\n\t\t//Log\n}\nif (Environment ==BuildConfig.buildType){\n\t\t//\n}\n~~~\n\n#### gradleapk\nproductFlavors\n\n~~~ Java\nandroid.applicationVariants.all { variant ->\n        variant.outputs.each { output ->\n            def outputFile = output.outputFile\n            if (outputFile != null && outputFile.name.endsWith('.apk')) {\n                //apk\n                def flavorname =variant.productFlavors[0].name\n                if (flavorname.equals('kaifa'))\n                    flavorname = 'debug'\n                else if (flavorname.equals('ceshi'))\n                    flavorname = 'release'\n\n                def fileName = \"app-${flavorname}-${defaultConfig.versionName}-${releaseTime() }.apk\"\n                output.outputFile = new File(outputFile.parent, fileName)\n            }\n        }\n    }\n~~~\n\n\n~~~ Java\ndef releaseTime() {\n    return new Date().format(\"MMdd\", TimeZone.getTimeZone(\"UTC\"))\n}\n~~~\n\napk\n\n### MacAndroid StudioSHA1MD5\nAndroid StudioTerminal\n\n#### debug.keystoreSHA1MD5\n\n: **keytool -list -v -keystore ~/.android/debug.keystore -alias androiddebugkey -storepass android -keypass android**\n\nkeystore**keytool -list -v -keystore ~/User//debug.keystore -alias androiddebugkey -storepass android -keypass android** \n","source":"_posts/2016-10-13-gradle-learning2.md","raw":"---\nlayout: post\ntitle:  gradle 2apk\ncategory: accumulation\ntags:\n  - gradle\nkeywords: Android,gradle\nbanner: http://obxk8w81b.bkt.clouddn.com/Cart%20with%20Red%20and%20White%20Ox.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Cart%20with%20Red%20and%20White%20Ox.jpg\n---\n\n[Gradle]()GradleAndroidGradleAPK\n\n### \nAndroidSITUATPRDAPK\n\nJavaapp-release.apk\n\ngradle\n\n> \n- buildType\n- productFlavors \n\n<!--more-->\n#### buildType\n\nAndroid Plugindebugrelease APK\n\nbuildTypeinitWith()\n\n\n\n|*Property name\t*|*Default values for debug\t*|*Default values for release / other*|\n|:--------:|:-------:|:--------:|\n|debuggable\t            | true\t|false |\n|jniDebugBuild\t        | false\t|false|\n|renderscriptDebugBuild\t| false\t|false|\n|renderscriptOptimLevel\t|   3\t|3|\n|applicationIdSuffix\t|  null\t|null|\n|versionNameSuffix\t    |  null\t|null|\n|signingConfig\t  |android.signingConfigs.debug\t|null|\n|zipAlign\t             |false\t|true|\n|runProguard\t         |false\t|false|\n|proguardFile\t     |N/A (set only)\t|N/A (set only)|\n|proguardFiles\t     |N/A (set only)\t|N/A (set only)|\n\n[Gralde plugin User Guide ](https://avatarqing.gitbooks.io/gradlepluginuserguidechineseverision/content/basic_project/build_types.html)\n\n\n#### Product flavors\nproduct flavorflavor\n\n\n\nProduct flavorproductFlavorsDSL\n\n~~~ Java\nandroid {\n    ....\n\n    productFlavors {\n        flavor1 {\n            ...\n        }\n\n        flavor2 {\n            ...\n        }\n    }\n}\n~~~\nflavorflavor1flavor2\n\n> flavorBuild TypeandroidTestsourceSet\n\n#### Build Type + Product Flavor = Build Variant+=\nBuild TypeAPK\n\nProduct FlavorBuild TypeProduct FlavorFlavor\n\nBuild TypeProduct FlavorBuild Variant\n\nFlavordebugreleaseBuild Type4Build Variant\n\n- Flavor1 - debug\n- Flavor1 - release\n- Flavor2 - debug\n- Flavor2 - release\n\nflavorBuild Variantflavordefault()flavor/configBuild VariantBuild Type\n\n### \n**Build Type****Product Flavor**\n**Build Type**\n\n~~~ Java\nbuildTypes {\n        release {\n            buildConfigField \"boolean\", \"LEO_DEBUG\", \"false\"\n            minifyEnabled true\n            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.txt'\n            debuggable false\n            jniDebuggable false\n        }\n        debug {\n            buildConfigField \"int\", \"buildType\", \"2\"\n            buildConfigField \"boolean\", \"LEO_DEBUG\", \"true\"\n        }\n    }\n~~~\n**Product Flavor**\n\n~~~ Java\nproductFlavors{\n\tkaifa{\n\t\tbuildConfigField \"int\", \"buildType\", \"1\"\n\t}\n\tceshi {\n\t\tbuildConfigField \"int\", \"buildType\", \"2\"\n\t}\n\tSIT {\n\t\tbuildConfigField \"int\", \"buildType\", \"3\"\n\t}\n\tUAT {\n\t\tbuildConfigField \"int\", \"buildType\", \"4\"\n\t}\n\tPRD {\n\t\tbuildConfigField \"int\", \"buildType\", \"5\"\n\t}\n}\n~~~\nproductFlavors**app->build->generated->source->buildConfig**flavor\n\n![Gradle build structure](http://oui2w5whj.bkt.clouddn.com/blogimages/2016/gradle_structure2.png)\n\nbuildConfigField**flavor->release/debug->**BuildConfig.javaBuildConfig.javaintbuildTypebooleanLEO_DEBUG:\n\n~~~ Java\nif (BuildConfig.LEO_DEBUG){\n\t\t//Log\n}\nif (Environment ==BuildConfig.buildType){\n\t\t//\n}\n~~~\n\n#### gradleapk\nproductFlavors\n\n~~~ Java\nandroid.applicationVariants.all { variant ->\n        variant.outputs.each { output ->\n            def outputFile = output.outputFile\n            if (outputFile != null && outputFile.name.endsWith('.apk')) {\n                //apk\n                def flavorname =variant.productFlavors[0].name\n                if (flavorname.equals('kaifa'))\n                    flavorname = 'debug'\n                else if (flavorname.equals('ceshi'))\n                    flavorname = 'release'\n\n                def fileName = \"app-${flavorname}-${defaultConfig.versionName}-${releaseTime() }.apk\"\n                output.outputFile = new File(outputFile.parent, fileName)\n            }\n        }\n    }\n~~~\n\n\n~~~ Java\ndef releaseTime() {\n    return new Date().format(\"MMdd\", TimeZone.getTimeZone(\"UTC\"))\n}\n~~~\n\napk\n\n### MacAndroid StudioSHA1MD5\nAndroid StudioTerminal\n\n#### debug.keystoreSHA1MD5\n\n: **keytool -list -v -keystore ~/.android/debug.keystore -alias androiddebugkey -storepass android -keypass android**\n\nkeystore**keytool -list -v -keystore ~/User//debug.keystore -alias androiddebugkey -storepass android -keypass android** \n","slug":"gradle-learning2","published":1,"date":"2016-10-12T16:00:00.000Z","updated":"2017-11-23T07:09:33.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ebz80021d6ykyugil0ez","content":"<p><a href=\"\">Gradle</a>GradleAndroidGradleAPK</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>AndroidSITUATPRDAPK</p>\n<p>Javaapp-release.apk</p>\n<p>gradle</p>\n<blockquote>\n<p></p>\n<ul>\n<li>buildType</li>\n<li>productFlavors </li>\n</ul>\n</blockquote>\n<a id=\"more\"></a>\n<h4 id=\"buildType\"><a href=\"#buildType\" class=\"headerlink\" title=\"buildType\"></a>buildType</h4><p>Android Plugindebugrelease APK</p>\n<p>buildTypeinitWith()</p>\n<p></p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\"><em>Property name    </em></th>\n<th style=\"text-align:center\"><em>Default values for debug    </em></th>\n<th style=\"text-align:center\"><em>Default values for release / other</em></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">debuggable</td>\n<td style=\"text-align:center\">true</td>\n<td style=\"text-align:center\">false</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">jniDebugBuild</td>\n<td style=\"text-align:center\">false</td>\n<td style=\"text-align:center\">false</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">renderscriptDebugBuild</td>\n<td style=\"text-align:center\">false</td>\n<td style=\"text-align:center\">false</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">renderscriptOptimLevel</td>\n<td style=\"text-align:center\">3</td>\n<td style=\"text-align:center\">3</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">applicationIdSuffix</td>\n<td style=\"text-align:center\">null</td>\n<td style=\"text-align:center\">null</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">versionNameSuffix</td>\n<td style=\"text-align:center\">null</td>\n<td style=\"text-align:center\">null</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">signingConfig</td>\n<td style=\"text-align:center\">android.signingConfigs.debug</td>\n<td style=\"text-align:center\">null</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">zipAlign</td>\n<td style=\"text-align:center\">false</td>\n<td style=\"text-align:center\">true</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">runProguard</td>\n<td style=\"text-align:center\">false</td>\n<td style=\"text-align:center\">false</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">proguardFile</td>\n<td style=\"text-align:center\">N/A (set only)</td>\n<td style=\"text-align:center\">N/A (set only)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">proguardFiles</td>\n<td style=\"text-align:center\">N/A (set only)</td>\n<td style=\"text-align:center\">N/A (set only)</td>\n</tr>\n</tbody>\n</table>\n<p><a href=\"https://avatarqing.gitbooks.io/gradlepluginuserguidechineseverision/content/basic_project/build_types.html\" target=\"_blank\" rel=\"external\">Gralde plugin User Guide </a></p>\n<h4 id=\"Product-flavors\"><a href=\"#Product-flavors\" class=\"headerlink\" title=\"Product flavors\"></a>Product flavors</h4><p>product flavorflavor</p>\n<p></p>\n<p>Product flavorproductFlavorsDSL</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">android &#123;</div><div class=\"line\">    ....</div><div class=\"line\"></div><div class=\"line\">    productFlavors &#123;</div><div class=\"line\">        flavor1 &#123;</div><div class=\"line\">            ...</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        flavor2 &#123;</div><div class=\"line\">            ...</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>flavorflavor1flavor2</p>\n<blockquote>\n<p>flavorBuild TypeandroidTestsourceSet</p>\n</blockquote>\n<h4 id=\"Build-Type-Product-Flavor-Build-Variant--\"><a href=\"#Build-Type-Product-Flavor-Build-Variant--\" class=\"headerlink\" title=\"Build Type + Product Flavor = Build Variant+=\"></a>Build Type + Product Flavor = Build Variant+=</h4><p>Build TypeAPK</p>\n<p>Product FlavorBuild TypeProduct FlavorFlavor</p>\n<p>Build TypeProduct FlavorBuild Variant</p>\n<p>FlavordebugreleaseBuild Type4Build Variant</p>\n<ul>\n<li>Flavor1 - debug</li>\n<li>Flavor1 - release</li>\n<li>Flavor2 - debug</li>\n<li>Flavor2 - release</li>\n</ul>\n<p>flavorBuild Variantflavordefault()flavor/configBuild VariantBuild Type</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong>Build Type</strong><strong>Product Flavor</strong><br><strong>Build Type</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">buildTypes &#123;</div><div class=\"line\">        release &#123;</div><div class=\"line\">            buildConfigField <span class=\"string\">\"boolean\"</span>, <span class=\"string\">\"LEO_DEBUG\"</span>, <span class=\"string\">\"false\"</span></div><div class=\"line\">            <span class=\"function\">minifyEnabled <span class=\"keyword\">true</span></span></div><div class=\"line\">            proguardFiles <span class=\"title\">getDefaultProguardFile</span><span class=\"params\">(<span class=\"string\">'proguard-android.txt'</span>)</span>, 'proguard-rules.txt'</div><div class=\"line\">            debuggable <span class=\"keyword\">false</span></div><div class=\"line\">            jniDebuggable <span class=\"keyword\">false</span></div><div class=\"line\">        &#125;</div><div class=\"line\">        debug &#123;</div><div class=\"line\">            buildConfigField <span class=\"string\">\"int\"</span>, <span class=\"string\">\"buildType\"</span>, <span class=\"string\">\"2\"</span></div><div class=\"line\">            buildConfigField <span class=\"string\">\"boolean\"</span>, <span class=\"string\">\"LEO_DEBUG\"</span>, <span class=\"string\">\"true\"</span></div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div></pre></td></tr></table></figure>\n<p><strong>Product Flavor</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">productFlavors&#123;</div><div class=\"line\">\tkaifa&#123;</div><div class=\"line\">\t\tbuildConfigField <span class=\"string\">\"int\"</span>, <span class=\"string\">\"buildType\"</span>, <span class=\"string\">\"1\"</span></div><div class=\"line\">\t&#125;</div><div class=\"line\">\tceshi &#123;</div><div class=\"line\">\t\tbuildConfigField <span class=\"string\">\"int\"</span>, <span class=\"string\">\"buildType\"</span>, <span class=\"string\">\"2\"</span></div><div class=\"line\">\t&#125;</div><div class=\"line\">\tSIT &#123;</div><div class=\"line\">\t\tbuildConfigField <span class=\"string\">\"int\"</span>, <span class=\"string\">\"buildType\"</span>, <span class=\"string\">\"3\"</span></div><div class=\"line\">\t&#125;</div><div class=\"line\">\tUAT &#123;</div><div class=\"line\">\t\tbuildConfigField <span class=\"string\">\"int\"</span>, <span class=\"string\">\"buildType\"</span>, <span class=\"string\">\"4\"</span></div><div class=\"line\">\t&#125;</div><div class=\"line\">\tPRD &#123;</div><div class=\"line\">\t\tbuildConfigField <span class=\"string\">\"int\"</span>, <span class=\"string\">\"buildType\"</span>, <span class=\"string\">\"5\"</span></div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>productFlavors<strong>app-&gt;build-&gt;generated-&gt;source-&gt;buildConfig</strong>flavor</p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2016/gradle_structure2.png\" alt=\"Gradle build structure\"></p>\n<p>buildConfigField<strong>flavor-&gt;release/debug-&gt;</strong>BuildConfig.javaBuildConfig.javaintbuildTypebooleanLEO_DEBUG:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">if</span> (BuildConfig.LEO_DEBUG)&#123;</div><div class=\"line\">\t\t<span class=\"comment\">//Log</span></div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"keyword\">if</span> (Environment ==BuildConfig.buildType)&#123;</div><div class=\"line\">\t\t<span class=\"comment\">//</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h4 id=\"gradleapk\"><a href=\"#gradleapk\" class=\"headerlink\" title=\"gradleapk\"></a>gradleapk</h4><p>productFlavors</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">android.applicationVariants.all &#123; variant -&gt;</div><div class=\"line\">        variant.outputs.each &#123; output -&gt;</div><div class=\"line\">            def outputFile = output.<span class=\"function\">outputFile</span></div><div class=\"line\">            <span class=\"title\">if</span> <span class=\"params\">(outputFile != <span class=\"keyword\">null</span> &amp;&amp; outputFile.name.endsWith(<span class=\"string\">'.apk'</span>)</span>) &#123;</div><div class=\"line\">                <span class=\"comment\">//apk</span></div><div class=\"line\">                def flavorname =variant.productFlavors[<span class=\"number\">0</span>].<span class=\"function\">name</span></div><div class=\"line\">                <span class=\"title\">if</span> <span class=\"params\">(flavorname.equals(<span class=\"string\">'kaifa'</span>)</span>)</div><div class=\"line\">                    flavorname = <span class=\"string\">'debug'</span></div><div class=\"line\">                <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (flavorname.equals(<span class=\"string\">'ceshi'</span>))</div><div class=\"line\">                    flavorname = <span class=\"string\">'release'</span></div><div class=\"line\"></div><div class=\"line\">                def fileName = <span class=\"string\">\"app-$&#123;flavorname&#125;-$&#123;defaultConfig.versionName&#125;-$&#123;releaseTime() &#125;.apk\"</span></div><div class=\"line\">                output.outputFile = <span class=\"keyword\">new</span> File(outputFile.parent, fileName)</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div></pre></td></tr></table></figure>\n<p><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\">def <span class=\"title\">releaseTime</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Date().format(<span class=\"string\">\"MMdd\"</span>, TimeZone.getTimeZone(<span class=\"string\">\"UTC\"</span>))</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>apk</p>\n<h3 id=\"MacAndroid-StudioSHA1MD5\"><a href=\"#MacAndroid-StudioSHA1MD5\" class=\"headerlink\" title=\"MacAndroid StudioSHA1MD5\"></a>MacAndroid StudioSHA1MD5</h3><p>Android StudioTerminal</p>\n<h4 id=\"debug-keystoreSHA1MD5\"><a href=\"#debug-keystoreSHA1MD5\" class=\"headerlink\" title=\"debug.keystoreSHA1MD5\"></a>debug.keystoreSHA1MD5</h4><p>: <strong>keytool -list -v -keystore ~/.android/debug.keystore -alias androiddebugkey -storepass android -keypass android</strong></p>\n<p>keystore<strong>keytool -list -v -keystore ~/User//debug.keystore -alias androiddebugkey -storepass android -keypass android</strong> </p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/10/13/gradle-learning2/\">http://agehua.github.io/2016/10/13/gradle-learning2/</a></p>\n","readingTime":{"text":"3 min read","minutes":2.465,"time":147899.99999999997,"words":493},"excerpt":"<p><a href=\"\">Gradle</a>GradleAndroidGradleAPK</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>AndroidSITUATPRDAPK</p>\n<p>Javaapp-release.apk</p>\n<p>gradle</p>\n<blockquote>\n<p></p>\n<ul>\n<li>buildType</li>\n<li>productFlavors </li>\n</ul>\n</blockquote>","more":"<h4 id=\"buildType\"><a href=\"#buildType\" class=\"headerlink\" title=\"buildType\"></a>buildType</h4><p>Android Plugindebugrelease APK</p>\n<p>buildTypeinitWith()</p>\n<p></p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\"><em>Property name    </em></th>\n<th style=\"text-align:center\"><em>Default values for debug    </em></th>\n<th style=\"text-align:center\"><em>Default values for release / other</em></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">debuggable</td>\n<td style=\"text-align:center\">true</td>\n<td style=\"text-align:center\">false</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">jniDebugBuild</td>\n<td style=\"text-align:center\">false</td>\n<td style=\"text-align:center\">false</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">renderscriptDebugBuild</td>\n<td style=\"text-align:center\">false</td>\n<td style=\"text-align:center\">false</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">renderscriptOptimLevel</td>\n<td style=\"text-align:center\">3</td>\n<td style=\"text-align:center\">3</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">applicationIdSuffix</td>\n<td style=\"text-align:center\">null</td>\n<td style=\"text-align:center\">null</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">versionNameSuffix</td>\n<td style=\"text-align:center\">null</td>\n<td style=\"text-align:center\">null</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">signingConfig</td>\n<td style=\"text-align:center\">android.signingConfigs.debug</td>\n<td style=\"text-align:center\">null</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">zipAlign</td>\n<td style=\"text-align:center\">false</td>\n<td style=\"text-align:center\">true</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">runProguard</td>\n<td style=\"text-align:center\">false</td>\n<td style=\"text-align:center\">false</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">proguardFile</td>\n<td style=\"text-align:center\">N/A (set only)</td>\n<td style=\"text-align:center\">N/A (set only)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">proguardFiles</td>\n<td style=\"text-align:center\">N/A (set only)</td>\n<td style=\"text-align:center\">N/A (set only)</td>\n</tr>\n</tbody>\n</table>\n<p><a href=\"https://avatarqing.gitbooks.io/gradlepluginuserguidechineseverision/content/basic_project/build_types.html\">Gralde plugin User Guide </a></p>\n<h4 id=\"Product-flavors\"><a href=\"#Product-flavors\" class=\"headerlink\" title=\"Product flavors\"></a>Product flavors</h4><p>product flavorflavor</p>\n<p></p>\n<p>Product flavorproductFlavorsDSL</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">android &#123;</div><div class=\"line\">    ....</div><div class=\"line\"></div><div class=\"line\">    productFlavors &#123;</div><div class=\"line\">        flavor1 &#123;</div><div class=\"line\">            ...</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        flavor2 &#123;</div><div class=\"line\">            ...</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>flavorflavor1flavor2</p>\n<blockquote>\n<p>flavorBuild TypeandroidTestsourceSet</p>\n</blockquote>\n<h4 id=\"Build-Type-Product-Flavor-Build-Variant--\"><a href=\"#Build-Type-Product-Flavor-Build-Variant--\" class=\"headerlink\" title=\"Build Type + Product Flavor = Build Variant+=\"></a>Build Type + Product Flavor = Build Variant+=</h4><p>Build TypeAPK</p>\n<p>Product FlavorBuild TypeProduct FlavorFlavor</p>\n<p>Build TypeProduct FlavorBuild Variant</p>\n<p>FlavordebugreleaseBuild Type4Build Variant</p>\n<ul>\n<li>Flavor1 - debug</li>\n<li>Flavor1 - release</li>\n<li>Flavor2 - debug</li>\n<li>Flavor2 - release</li>\n</ul>\n<p>flavorBuild Variantflavordefault()flavor/configBuild VariantBuild Type</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong>Build Type</strong><strong>Product Flavor</strong><br><strong>Build Type</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">buildTypes &#123;</div><div class=\"line\">        release &#123;</div><div class=\"line\">            buildConfigField <span class=\"string\">\"boolean\"</span>, <span class=\"string\">\"LEO_DEBUG\"</span>, <span class=\"string\">\"false\"</span></div><div class=\"line\">            <span class=\"function\">minifyEnabled <span class=\"keyword\">true</span></div><div class=\"line\">            proguardFiles <span class=\"title\">getDefaultProguardFile</span><span class=\"params\">(<span class=\"string\">'proguard-android.txt'</span>)</span>, 'proguard-rules.txt'</div><div class=\"line\">            debuggable <span class=\"keyword\">false</span></div><div class=\"line\">            jniDebuggable <span class=\"keyword\">false</span></div><div class=\"line\">        &#125;</div><div class=\"line\">        debug </span>&#123;</div><div class=\"line\">            buildConfigField <span class=\"string\">\"int\"</span>, <span class=\"string\">\"buildType\"</span>, <span class=\"string\">\"2\"</span></div><div class=\"line\">            buildConfigField <span class=\"string\">\"boolean\"</span>, <span class=\"string\">\"LEO_DEBUG\"</span>, <span class=\"string\">\"true\"</span></div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div></pre></td></tr></table></figure>\n<p><strong>Product Flavor</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">productFlavors&#123;</div><div class=\"line\">\tkaifa&#123;</div><div class=\"line\">\t\tbuildConfigField <span class=\"string\">\"int\"</span>, <span class=\"string\">\"buildType\"</span>, <span class=\"string\">\"1\"</span></div><div class=\"line\">\t&#125;</div><div class=\"line\">\tceshi &#123;</div><div class=\"line\">\t\tbuildConfigField <span class=\"string\">\"int\"</span>, <span class=\"string\">\"buildType\"</span>, <span class=\"string\">\"2\"</span></div><div class=\"line\">\t&#125;</div><div class=\"line\">\tSIT &#123;</div><div class=\"line\">\t\tbuildConfigField <span class=\"string\">\"int\"</span>, <span class=\"string\">\"buildType\"</span>, <span class=\"string\">\"3\"</span></div><div class=\"line\">\t&#125;</div><div class=\"line\">\tUAT &#123;</div><div class=\"line\">\t\tbuildConfigField <span class=\"string\">\"int\"</span>, <span class=\"string\">\"buildType\"</span>, <span class=\"string\">\"4\"</span></div><div class=\"line\">\t&#125;</div><div class=\"line\">\tPRD &#123;</div><div class=\"line\">\t\tbuildConfigField <span class=\"string\">\"int\"</span>, <span class=\"string\">\"buildType\"</span>, <span class=\"string\">\"5\"</span></div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>productFlavors<strong>app-&gt;build-&gt;generated-&gt;source-&gt;buildConfig</strong>flavor</p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2016/gradle_structure2.png\" alt=\"Gradle build structure\"></p>\n<p>buildConfigField<strong>flavor-&gt;release/debug-&gt;</strong>BuildConfig.javaBuildConfig.javaintbuildTypebooleanLEO_DEBUG:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">if</span> (BuildConfig.LEO_DEBUG)&#123;</div><div class=\"line\">\t\t<span class=\"comment\">//Log</span></div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"keyword\">if</span> (Environment ==BuildConfig.buildType)&#123;</div><div class=\"line\">\t\t<span class=\"comment\">//</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h4 id=\"gradleapk\"><a href=\"#gradleapk\" class=\"headerlink\" title=\"gradleapk\"></a>gradleapk</h4><p>productFlavors</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">android.applicationVariants.all &#123; variant -&gt;</div><div class=\"line\">        variant.outputs.each &#123; output -&gt;</div><div class=\"line\">            def outputFile = output.<span class=\"function\">outputFile</div><div class=\"line\">            <span class=\"title\">if</span> <span class=\"params\">(outputFile != <span class=\"keyword\">null</span> &amp;&amp; outputFile.name.endsWith(<span class=\"string\">'.apk'</span>)</span>) </span>&#123;</div><div class=\"line\">                <span class=\"comment\">//apk</span></div><div class=\"line\">                def flavorname =variant.productFlavors[<span class=\"number\">0</span>].<span class=\"function\">name</div><div class=\"line\">                <span class=\"title\">if</span> <span class=\"params\">(flavorname.equals(<span class=\"string\">'kaifa'</span>)</span>)</div><div class=\"line\">                    flavorname </span>= <span class=\"string\">'debug'</span></div><div class=\"line\">                <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (flavorname.equals(<span class=\"string\">'ceshi'</span>))</div><div class=\"line\">                    flavorname = <span class=\"string\">'release'</span></div><div class=\"line\"></div><div class=\"line\">                def fileName = <span class=\"string\">\"app-$&#123;flavorname&#125;-$&#123;defaultConfig.versionName&#125;-$&#123;releaseTime() &#125;.apk\"</span></div><div class=\"line\">                output.outputFile = <span class=\"keyword\">new</span> File(outputFile.parent, fileName)</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div></pre></td></tr></table></figure>\n<p><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\">def <span class=\"title\">releaseTime</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Date().format(<span class=\"string\">\"MMdd\"</span>, TimeZone.getTimeZone(<span class=\"string\">\"UTC\"</span>))</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>apk</p>\n<h3 id=\"MacAndroid-StudioSHA1MD5\"><a href=\"#MacAndroid-StudioSHA1MD5\" class=\"headerlink\" title=\"MacAndroid StudioSHA1MD5\"></a>MacAndroid StudioSHA1MD5</h3><p>Android StudioTerminal</p>\n<h4 id=\"debug-keystoreSHA1MD5\"><a href=\"#debug-keystoreSHA1MD5\" class=\"headerlink\" title=\"debug.keystoreSHA1MD5\"></a>debug.keystoreSHA1MD5</h4><p>: <strong>keytool -list -v -keystore ~/.android/debug.keystore -alias androiddebugkey -storepass android -keypass android</strong></p>\n<p>keystore<strong>keytool -list -v -keystore ~/User//debug.keystore -alias androiddebugkey -storepass android -keypass android</strong> </p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/10/13/gradle-learning2/\">http://agehua.github.io/2016/10/13/gradle-learning2/</a></p>"},{"layout":"post","title":"JAVATEKVTClass<T>Class<?>","keywords":"Java, ","banner":"http://obxk8w81b.bkt.clouddn.com/Basket%20of%20Apples.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Basket%20of%20Apples.jpg","toc":true,"_content":"> [JAVATEKVTClass<T>Class<?>](http://www.jianshu.com/p/95f349258afb)\n\n### 1. \n\nJava SE 1.5Java\n\nJava SE 1.5Object\n\n<!--more-->\n\n\n\n      \n\n:\nBox\n~~~ Java\npublic class Box<T> {\n    private T object;\n\n    public void set(T object) { this.object = object; }\n    public T get() { return object; }\n}\n~~~\nBox\n\n~~~ Java\nBox box2 = new Box();\nbox2.set(new Apple());\nApple apple = (Apple) box2.get();\n~~~\nBox\n\n~~~ Java\nBox<Apple> box = new Box<Apple>();\nbox.set(new Apple());\nApple apple = box.get();\n~~~\n\n\n****\n\nTEKV\n\n### 2. TEKV\n\njava\nA,B,C,D......X,Y,ZTAT\n\n-  java\n- T (type) java\n- K V (key value) javaKey Value\n- E (element) Element\n\n\n~~~ Java\npublic class Test<T> {    \n  public List<T> list = new ArrayList<T>();   \n  public static void main(String[] args) {\n        Test<String> test = new Test<String>();\n        test.list.add(\"hello\");\n        System.out.println(test.list);\n}}\n~~~\n\n~~~ Java\npublic class Test<A> {    \n  public List<A> list = new ArrayList<A>();   \n  public static void main(String[] args) {\n        Test<String> test = new Test<String>();\n        test.list.add(\"hello\");\n        System.out.println(test.list);\n}}\n~~~\nTATtype\n\nMapkey,value\n~~~ Java\npublic interface Mymap<K, V> {\n    public K getKey();\n    public V getValue();\n}\n\npublic class MymapImpl<K, V> implements Mymap<K, V> {\n\n    private K key;\n    private V value;\n\n    public MymapImpl(K key, V value) {\n    this.key = key;\n    this.value = value;\n    }\n\n    public K getKey()    { return key; }\n    public V getValue() { return value; }\n}\n~~~\n\n~~~ Java\nMymap<String, Integer> mp1= new MymapImpl<String, Integer>(\"Even\", 8);\nMymap<String, String>  mp2= new MymapImpl<String, String>(\"hello\", \"world\");\nMymap<Integer, Integer> mp3= new MymapImpl<Integer, Integer>(888, 888);\n~~~\nT1, T2, ..., Tn\n~~~ Java\npublic class Test<T1,T2,T3> {\n   public void print(T1 t1,T2 t2,T3 t3){\n        System.out.println(t1.getClass());\n        System.out.println(t2.getClass());\n        System.out.println(t3.getClass());\n    }\n}\n~~~\n### 3. TClass<T>Class<?>\n\nTString,List,Map......\n\nClassClassClassString,List,Map...... \n\nClass\n\n- 1. ObjectgetClass()ClassClass\n~~~ Java\nList list = null;\nClass clazz = list.getClass();\n~~~\n\n- 2. ClassforName()Class\n\n~~~ Java\nClass clazz = Class.forName(\"com.lyang.demo.fanxing.People\");\n~~~\n\n- 3.ClassTJavaT.class\n~~~ Java\nClass clazz = List.class;\n~~~\n> ClassClass<T>Class<?>\n\nClass<T>Class<?>****\n~~~ Java\nPeople people = (People) Class.forName(\"com.lyang.demo.fanxing.People\").newInstance();\n~~~\nPeoplejava.lang.ClassCastException\n\nClass<T>\n~~~ Java\npublic class Test {\n    public static <T> T createInstance(Class<T> clazz) throws IllegalAccessException, InstantiationException {\n        return clazz.newInstance();\n    }\n\n    public static void main(String[] args)  throws IllegalAccessException, InstantiationException  {\n            Fruit fruit= createInstance(Fruit .class);\n            People people= createInstance(People.class);\n    }\n}\n~~~\n> Class<T>Class<?>\n\n- Class<T>T\n- Class<?>?\n\n\n~~~ Java\npublic Class<?> clazz;\n~~~\n\n~~~ Java\npublic Class<T> clazz;\n~~~\nT\n\nClassClass<?>,Class<?>\n","source":"_posts/2016-11-21-Difference_between-T-E-K-V.md","raw":"---\nlayout: post\ntitle:  JAVATEKVTClass<T>Class<?>\ncategory: accumulation\ntags:\n  - Java\n  - genericity\nkeywords: Java, \nbanner: http://obxk8w81b.bkt.clouddn.com/Basket%20of%20Apples.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Basket%20of%20Apples.jpg\ntoc: true\n---\n> [JAVATEKVTClass<T>Class<?>](http://www.jianshu.com/p/95f349258afb)\n\n### 1. \n\nJava SE 1.5Java\n\nJava SE 1.5Object\n\n<!--more-->\n\n\n\n      \n\n:\nBox\n~~~ Java\npublic class Box<T> {\n    private T object;\n\n    public void set(T object) { this.object = object; }\n    public T get() { return object; }\n}\n~~~\nBox\n\n~~~ Java\nBox box2 = new Box();\nbox2.set(new Apple());\nApple apple = (Apple) box2.get();\n~~~\nBox\n\n~~~ Java\nBox<Apple> box = new Box<Apple>();\nbox.set(new Apple());\nApple apple = box.get();\n~~~\n\n\n****\n\nTEKV\n\n### 2. TEKV\n\njava\nA,B,C,D......X,Y,ZTAT\n\n-  java\n- T (type) java\n- K V (key value) javaKey Value\n- E (element) Element\n\n\n~~~ Java\npublic class Test<T> {    \n  public List<T> list = new ArrayList<T>();   \n  public static void main(String[] args) {\n        Test<String> test = new Test<String>();\n        test.list.add(\"hello\");\n        System.out.println(test.list);\n}}\n~~~\n\n~~~ Java\npublic class Test<A> {    \n  public List<A> list = new ArrayList<A>();   \n  public static void main(String[] args) {\n        Test<String> test = new Test<String>();\n        test.list.add(\"hello\");\n        System.out.println(test.list);\n}}\n~~~\nTATtype\n\nMapkey,value\n~~~ Java\npublic interface Mymap<K, V> {\n    public K getKey();\n    public V getValue();\n}\n\npublic class MymapImpl<K, V> implements Mymap<K, V> {\n\n    private K key;\n    private V value;\n\n    public MymapImpl(K key, V value) {\n    this.key = key;\n    this.value = value;\n    }\n\n    public K getKey()    { return key; }\n    public V getValue() { return value; }\n}\n~~~\n\n~~~ Java\nMymap<String, Integer> mp1= new MymapImpl<String, Integer>(\"Even\", 8);\nMymap<String, String>  mp2= new MymapImpl<String, String>(\"hello\", \"world\");\nMymap<Integer, Integer> mp3= new MymapImpl<Integer, Integer>(888, 888);\n~~~\nT1, T2, ..., Tn\n~~~ Java\npublic class Test<T1,T2,T3> {\n   public void print(T1 t1,T2 t2,T3 t3){\n        System.out.println(t1.getClass());\n        System.out.println(t2.getClass());\n        System.out.println(t3.getClass());\n    }\n}\n~~~\n### 3. TClass<T>Class<?>\n\nTString,List,Map......\n\nClassClassClassString,List,Map...... \n\nClass\n\n- 1. ObjectgetClass()ClassClass\n~~~ Java\nList list = null;\nClass clazz = list.getClass();\n~~~\n\n- 2. ClassforName()Class\n\n~~~ Java\nClass clazz = Class.forName(\"com.lyang.demo.fanxing.People\");\n~~~\n\n- 3.ClassTJavaT.class\n~~~ Java\nClass clazz = List.class;\n~~~\n> ClassClass<T>Class<?>\n\nClass<T>Class<?>****\n~~~ Java\nPeople people = (People) Class.forName(\"com.lyang.demo.fanxing.People\").newInstance();\n~~~\nPeoplejava.lang.ClassCastException\n\nClass<T>\n~~~ Java\npublic class Test {\n    public static <T> T createInstance(Class<T> clazz) throws IllegalAccessException, InstantiationException {\n        return clazz.newInstance();\n    }\n\n    public static void main(String[] args)  throws IllegalAccessException, InstantiationException  {\n            Fruit fruit= createInstance(Fruit .class);\n            People people= createInstance(People.class);\n    }\n}\n~~~\n> Class<T>Class<?>\n\n- Class<T>T\n- Class<?>?\n\n\n~~~ Java\npublic Class<?> clazz;\n~~~\n\n~~~ Java\npublic Class<T> clazz;\n~~~\nT\n\nClassClass<?>,Class<?>\n","slug":"Difference_between-T-E-K-V","published":1,"date":"2016-11-20T16:00:00.000Z","updated":"2017-11-23T07:11:19.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ebzc0025d6ykvhddwd65","content":"<blockquote>\n<p><a href=\"http://www.jianshu.com/p/95f349258afb\" target=\"_blank\" rel=\"external\">JAVATEKVTClass<t>Class&lt;?&gt;</t></a></p>\n</blockquote>\n<h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h3><p>Java SE 1.5Java</p>\n<p>Java SE 1.5Object</p>\n<a id=\"more\"></a>\n<p></p>\n<pre><code>\n</code></pre><p>:<br>Box<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Box</span>&lt;<span class=\"title\">T</span>&gt; </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">private</span> T object;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">set</span><span class=\"params\">(T object)</span> </span>&#123; <span class=\"keyword\">this</span>.object = object; &#125;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> T <span class=\"title\">get</span><span class=\"params\">()</span> </span>&#123; <span class=\"keyword\">return</span> object; &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>Box</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Box box2 = <span class=\"keyword\">new</span> Box();</div><div class=\"line\">box2.set(<span class=\"keyword\">new</span> Apple());</div><div class=\"line\">Apple apple = (Apple) box2.get();</div></pre></td></tr></table></figure>\n<p>Box</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Box&lt;Apple&gt; box = <span class=\"keyword\">new</span> Box&lt;Apple&gt;();</div><div class=\"line\">box.set(<span class=\"keyword\">new</span> Apple());</div><div class=\"line\">Apple apple = box.get();</div></pre></td></tr></table></figure>\n<p></p>\n<p><strong></strong></p>\n<p>TEKV</p>\n<h3 id=\"2-TEKV\"><a href=\"#2-TEKV\" class=\"headerlink\" title=\"2. TEKV\"></a>2. TEKV</h3><p>java<br>A,B,C,DX,Y,ZTAT</p>\n<ul>\n<li> java</li>\n<li>T (type) java</li>\n<li>K V (key value) javaKey Value</li>\n<li>E (element) Element</li>\n</ul>\n<p><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span>&lt;<span class=\"title\">T</span>&gt; </span>&#123;    </div><div class=\"line\">  <span class=\"keyword\">public</span> List&lt;T&gt; list = <span class=\"keyword\">new</span> ArrayList&lt;T&gt;();   </div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</div><div class=\"line\">        Test&lt;String&gt; test = <span class=\"keyword\">new</span> Test&lt;String&gt;();</div><div class=\"line\">        test.list.add(<span class=\"string\">\"hello\"</span>);</div><div class=\"line\">        System.out.println(test.list);</div><div class=\"line\">&#125;&#125;</div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span>&lt;<span class=\"title\">A</span>&gt; </span>&#123;    </div><div class=\"line\">  <span class=\"keyword\">public</span> List&lt;A&gt; list = <span class=\"keyword\">new</span> ArrayList&lt;A&gt;();   </div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</div><div class=\"line\">        Test&lt;String&gt; test = <span class=\"keyword\">new</span> Test&lt;String&gt;();</div><div class=\"line\">        test.list.add(<span class=\"string\">\"hello\"</span>);</div><div class=\"line\">        System.out.println(test.list);</div><div class=\"line\">&#125;&#125;</div></pre></td></tr></table></figure></p>\n<p>TATtype</p>\n<p>Mapkey,value<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Mymap</span>&lt;<span class=\"title\">K</span>, <span class=\"title\">V</span>&gt; </span>&#123;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> K <span class=\"title\">getKey</span><span class=\"params\">()</span></span>;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> V <span class=\"title\">getValue</span><span class=\"params\">()</span></span>;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MymapImpl</span>&lt;<span class=\"title\">K</span>, <span class=\"title\">V</span>&gt; <span class=\"keyword\">implements</span> <span class=\"title\">Mymap</span>&lt;<span class=\"title\">K</span>, <span class=\"title\">V</span>&gt; </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">private</span> K key;</div><div class=\"line\">    <span class=\"keyword\">private</span> V value;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MymapImpl</span><span class=\"params\">(K key, V value)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">this</span>.key = key;</div><div class=\"line\">    <span class=\"keyword\">this</span>.value = value;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> K <span class=\"title\">getKey</span><span class=\"params\">()</span>    </span>&#123; <span class=\"keyword\">return</span> key; &#125;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> V <span class=\"title\">getValue</span><span class=\"params\">()</span> </span>&#123; <span class=\"keyword\">return</span> value; &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Mymap&lt;String, Integer&gt; mp1= <span class=\"keyword\">new</span> MymapImpl&lt;String, Integer&gt;(<span class=\"string\">\"Even\"</span>, <span class=\"number\">8</span>);</div><div class=\"line\">Mymap&lt;String, String&gt;  mp2= <span class=\"keyword\">new</span> MymapImpl&lt;String, String&gt;(<span class=\"string\">\"hello\"</span>, <span class=\"string\">\"world\"</span>);</div><div class=\"line\">Mymap&lt;Integer, Integer&gt; mp3= <span class=\"keyword\">new</span> MymapImpl&lt;Integer, Integer&gt;(<span class=\"number\">888</span>, <span class=\"number\">888</span>);</div></pre></td></tr></table></figure></p>\n<p>T1, T2, , Tn<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span>&lt;<span class=\"title\">T1</span>,<span class=\"title\">T2</span>,<span class=\"title\">T3</span>&gt; </span>&#123;</div><div class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">print</span><span class=\"params\">(T1 t1,T2 t2,T3 t3)</span></span>&#123;</div><div class=\"line\">        System.out.println(t1.getClass());</div><div class=\"line\">        System.out.println(t2.getClass());</div><div class=\"line\">        System.out.println(t3.getClass());</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<h3 id=\"3-TClassClass-lt-gt-\"><a href=\"#3-TClassClass-lt-gt-\" class=\"headerlink\" title=\"3. TClassClass&lt;?&gt;\"></a>3. TClass<t>Class&lt;?&gt;</t></h3><p>TString,List,Map</p>\n<p>ClassClassClassString,List,Map </p>\n<p>Class</p>\n<ul>\n<li><ol>\n<li>ObjectgetClass()ClassClass<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">List list = <span class=\"keyword\">null</span>;</div><div class=\"line\">Class clazz = list.getClass();</div></pre></td></tr></table></figure>\n</li>\n</ol>\n</li>\n<li><ol>\n<li>ClassforName()Class</li>\n</ol>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Class clazz = Class.forName(<span class=\"string\">\"com.lyang.demo.fanxing.People\"</span>);</div></pre></td></tr></table></figure>\n<ul>\n<li>3.ClassTJavaT.class<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Class clazz = List.class;</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<blockquote>\n<p>ClassClass<t>Class&lt;?&gt;</t></p>\n</blockquote>\n<p>Class<t>Class&lt;?&gt;<strong></strong><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">People people = (People) Class.forName(<span class=\"string\">\"com.lyang.demo.fanxing.People\"</span>).newInstance();</div></pre></td></tr></table></figure></t></p>\n<p>Peoplejava.lang.ClassCastException</p>\n<p>Class<t><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> &lt;T&gt; <span class=\"function\">T <span class=\"title\">createInstance</span><span class=\"params\">(Class&lt;T&gt; clazz)</span> <span class=\"keyword\">throws</span> IllegalAccessException, InstantiationException </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> clazz.newInstance();</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span>  <span class=\"keyword\">throws</span> IllegalAccessException, InstantiationException  </span>&#123;</div><div class=\"line\">            Fruit fruit= createInstance(Fruit .class);</div><div class=\"line\">            People people= createInstance(People.class);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></t></p>\n<blockquote>\n<p>Class<t>Class&lt;?&gt;</t></p>\n</blockquote>\n<ul>\n<li>Class<t>T</t></li>\n<li>Class&lt;?&gt;?</li>\n</ul>\n<p><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> Class&lt;?&gt; clazz;</div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> Class&lt;T&gt; clazz;</div></pre></td></tr></table></figure></p>\n<p>T</p>\n<p>ClassClass&lt;?&gt;,Class&lt;?&gt;</p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/11/21/Difference_between-T-E-K-V/\">http://agehua.github.io/2016/11/21/Difference_between-T-E-K-V/</a></p>\n","readingTime":{"text":"3 min read","minutes":2.945,"time":176700,"words":589},"excerpt":"<blockquote>\n<p><a href=\"http://www.jianshu.com/p/95f349258afb\">JAVATEKVTClass<T>Class&lt;?&gt;</a></p>\n</blockquote>\n<h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h3><p>Java SE 1.5Java</p>\n<p>Java SE 1.5Object</p>","more":"<p></p>\n<pre><code>\n</code></pre><p>:<br>Box<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Box</span>&lt;<span class=\"title\">T</span>&gt; </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">private</span> T object;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">set</span><span class=\"params\">(T object)</span> </span>&#123; <span class=\"keyword\">this</span>.object = object; &#125;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> T <span class=\"title\">get</span><span class=\"params\">()</span> </span>&#123; <span class=\"keyword\">return</span> object; &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>Box</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Box box2 = <span class=\"keyword\">new</span> Box();</div><div class=\"line\">box2.set(<span class=\"keyword\">new</span> Apple());</div><div class=\"line\">Apple apple = (Apple) box2.get();</div></pre></td></tr></table></figure>\n<p>Box</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Box&lt;Apple&gt; box = <span class=\"keyword\">new</span> Box&lt;Apple&gt;();</div><div class=\"line\">box.set(<span class=\"keyword\">new</span> Apple());</div><div class=\"line\">Apple apple = box.get();</div></pre></td></tr></table></figure>\n<p></p>\n<p><strong></strong></p>\n<p>TEKV</p>\n<h3 id=\"2-TEKV\"><a href=\"#2-TEKV\" class=\"headerlink\" title=\"2. TEKV\"></a>2. TEKV</h3><p>java<br>A,B,C,DX,Y,ZTAT</p>\n<ul>\n<li> java</li>\n<li>T (type) java</li>\n<li>K V (key value) javaKey Value</li>\n<li>E (element) Element</li>\n</ul>\n<p><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span>&lt;<span class=\"title\">T</span>&gt; </span>&#123;    </div><div class=\"line\">  <span class=\"keyword\">public</span> List&lt;T&gt; list = <span class=\"keyword\">new</span> ArrayList&lt;T&gt;();   </div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</div><div class=\"line\">        Test&lt;String&gt; test = <span class=\"keyword\">new</span> Test&lt;String&gt;();</div><div class=\"line\">        test.list.add(<span class=\"string\">\"hello\"</span>);</div><div class=\"line\">        System.out.println(test.list);</div><div class=\"line\">&#125;&#125;</div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span>&lt;<span class=\"title\">A</span>&gt; </span>&#123;    </div><div class=\"line\">  <span class=\"keyword\">public</span> List&lt;A&gt; list = <span class=\"keyword\">new</span> ArrayList&lt;A&gt;();   </div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</div><div class=\"line\">        Test&lt;String&gt; test = <span class=\"keyword\">new</span> Test&lt;String&gt;();</div><div class=\"line\">        test.list.add(<span class=\"string\">\"hello\"</span>);</div><div class=\"line\">        System.out.println(test.list);</div><div class=\"line\">&#125;&#125;</div></pre></td></tr></table></figure></p>\n<p>TATtype</p>\n<p>Mapkey,value<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Mymap</span>&lt;<span class=\"title\">K</span>, <span class=\"title\">V</span>&gt; </span>&#123;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> K <span class=\"title\">getKey</span><span class=\"params\">()</span></span>;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> V <span class=\"title\">getValue</span><span class=\"params\">()</span></span>;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MymapImpl</span>&lt;<span class=\"title\">K</span>, <span class=\"title\">V</span>&gt; <span class=\"keyword\">implements</span> <span class=\"title\">Mymap</span>&lt;<span class=\"title\">K</span>, <span class=\"title\">V</span>&gt; </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">private</span> K key;</div><div class=\"line\">    <span class=\"keyword\">private</span> V value;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MymapImpl</span><span class=\"params\">(K key, V value)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">this</span>.key = key;</div><div class=\"line\">    <span class=\"keyword\">this</span>.value = value;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> K <span class=\"title\">getKey</span><span class=\"params\">()</span>    </span>&#123; <span class=\"keyword\">return</span> key; &#125;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> V <span class=\"title\">getValue</span><span class=\"params\">()</span> </span>&#123; <span class=\"keyword\">return</span> value; &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Mymap&lt;String, Integer&gt; mp1= <span class=\"keyword\">new</span> MymapImpl&lt;String, Integer&gt;(<span class=\"string\">\"Even\"</span>, <span class=\"number\">8</span>);</div><div class=\"line\">Mymap&lt;String, String&gt;  mp2= <span class=\"keyword\">new</span> MymapImpl&lt;String, String&gt;(<span class=\"string\">\"hello\"</span>, <span class=\"string\">\"world\"</span>);</div><div class=\"line\">Mymap&lt;Integer, Integer&gt; mp3= <span class=\"keyword\">new</span> MymapImpl&lt;Integer, Integer&gt;(<span class=\"number\">888</span>, <span class=\"number\">888</span>);</div></pre></td></tr></table></figure></p>\n<p>T1, T2, , Tn<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span>&lt;<span class=\"title\">T1</span>,<span class=\"title\">T2</span>,<span class=\"title\">T3</span>&gt; </span>&#123;</div><div class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">print</span><span class=\"params\">(T1 t1,T2 t2,T3 t3)</span></span>&#123;</div><div class=\"line\">        System.out.println(t1.getClass());</div><div class=\"line\">        System.out.println(t2.getClass());</div><div class=\"line\">        System.out.println(t3.getClass());</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<h3 id=\"3-TClassClass-lt-gt-\"><a href=\"#3-TClassClass-lt-gt-\" class=\"headerlink\" title=\"3. TClassClass&lt;?&gt;\"></a>3. TClass<T>Class&lt;?&gt;</h3><p>TString,List,Map</p>\n<p>ClassClassClassString,List,Map </p>\n<p>Class</p>\n<ul>\n<li><ol>\n<li>ObjectgetClass()ClassClass<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">List list = <span class=\"keyword\">null</span>;</div><div class=\"line\">Class clazz = list.getClass();</div></pre></td></tr></table></figure>\n</li>\n</ol>\n</li>\n<li><ol>\n<li>ClassforName()Class</li>\n</ol>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Class clazz = Class.forName(<span class=\"string\">\"com.lyang.demo.fanxing.People\"</span>);</div></pre></td></tr></table></figure>\n<ul>\n<li>3.ClassTJavaT.class<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Class clazz = List.class;</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<blockquote>\n<p>ClassClass<T>Class&lt;?&gt;</p>\n</blockquote>\n<p>Class<T>Class&lt;?&gt;<strong></strong><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">People people = (People) Class.forName(<span class=\"string\">\"com.lyang.demo.fanxing.People\"</span>).newInstance();</div></pre></td></tr></table></figure></p>\n<p>Peoplejava.lang.ClassCastException</p>\n<p>Class<T><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> &lt;T&gt; <span class=\"function\">T <span class=\"title\">createInstance</span><span class=\"params\">(Class&lt;T&gt; clazz)</span> <span class=\"keyword\">throws</span> IllegalAccessException, InstantiationException </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> clazz.newInstance();</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span>  <span class=\"keyword\">throws</span> IllegalAccessException, InstantiationException  </span>&#123;</div><div class=\"line\">            Fruit fruit= createInstance(Fruit .class);</div><div class=\"line\">            People people= createInstance(People.class);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>Class<T>Class&lt;?&gt;</p>\n</blockquote>\n<ul>\n<li>Class<T>T</li>\n<li>Class&lt;?&gt;?</li>\n</ul>\n<p><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> Class&lt;?&gt; clazz;</div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> Class&lt;T&gt; clazz;</div></pre></td></tr></table></figure></p>\n<p>T</p>\n<p>ClassClass&lt;?&gt;,Class&lt;?&gt;</p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/11/21/Difference_between-T-E-K-V/\">http://agehua.github.io/2016/11/21/Difference_between-T-E-K-V/</a></p>"},{"layout":"post","title":"Hexo Hexo ","keywords":"Hexo","banner":"http://obxk8w81b.bkt.clouddn.com/Boy%20Cutting%20Grass%20with%20a%20Sickle.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Boy%20Cutting%20Grass%20with%20a%20Sickle.jpg","_content":"\n### \nHexo_config.ymltheme, themes/landscape\n\nthemes/landscape/docs-themes4\n\n- _config.yml: \n- source/: CSS\n- layout/: \n- scripts: JavaScript\n\n[docs-templates](https://hexo.io/docs/templates.html)index\n\n<!--more-->\n\n|Template|Page|\tFallback|\n|:--------:|:-------:|:--------:|\n|index\t|Home page | |\n|post\t|Posts\t|index|\n|page|\tPages |index|\n|archive\t|Archives|\tindex|\n|category\t|Category archives\t|archive|\n|tag\t|Tag archives|\tarchive|\n\n\n\nHexosourcesURLURL(EJS)\n\nURLHexolayout.ejsbody(Fallback/archivesarchives.ejsindex.ejs)\n\n\n### \n#### (layout.ejs)\n\nlayoutHexoindex,post,page,archive,category,tagheader + content + footerheaderfooterlayout.ejsbodylayout.ejs:\n\n~~~ JavaScript\n<!doctype html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, user-scalable=no\"/>\n    <title><%= config.title %></title>\n    <%- css('css/style') %>\n</head>\n<body>\n    <%- partial('_partial/header') %>\n    <div class=\"main\">\n        <%- body %>\n    </div>\n    <%- partial('_partial/footer') %>\n    <%- js('js/index.js') %>\n</body>\n</html>\n~~~\n\npartial,jscssHexo\n\n#### \n\nhexo new <title>hexo new [layout] <title>layoutAbouthexo new page \"about\"pageindex.ejs(),post.ejs(),archive.ejs(),tag.ejs(),page.ejs()\n\n##### index.ejs\n\nHexopageindex.ejsHTML_partial/article.ejs{index: true}post.ejspage.ejsindex.ejs:\n\n~~~ JavaScript\n//index.ejs\n<% page.posts.each(function(post, index){ %>\n    <%- partial('_partial/article', {index: true, post: post}) %>\n<% }) %>\n<div class=\"pagination\">\n    <%- paginator({ total: Math.ceil(site.posts.length / config.per_page)}) %>\n</div>\n~~~\n##### post.ejs\n\n{index: false}( XD\n\n~~~ JavaScript\n//post.ejs\n<%- partial('_partial/article', {index: false, post: page}) %>\n~~~\n##### page.ejs\n\nPageabout(hexo new page \"about\")/about/source/aboutindex.mdPage:\n\n~~~ JavaScript\n//page.ejs\n<%- partial('_partial/article', {index: false, post: page}) %>\n_partial/article.ejs\n~~~\narticlepagepost:(index: true)(index: false)_partial/article.ejs\n\n~~~ JavaScript\n//_partial/article.ejs\n<% if(index){ %>\n    //index logic...\n<% }else{ %>\n    //post or page logic...\n<% } %>\n~~~\n\n##### tag.ejs\n\nHexolist_tagsok:\n\n~~~ JavaScript\n//tag.ejs\n<%- list_tags() %>\n~~~\n:\n\n~~~ JavaScript\n//archive.ejs\n<div class=\"archive\">\n  <% var lastyear; %>\n  <% page.posts.each(function(post){ %>\n    <% var year = post.date.year() %>\n    <% if(lastyear !== year){ %>\n      <h4 class=\"year\"><%= year %></h4>\n      <% lastyear = year %>\n    <% } %>\n    <div class=\"archive_item\">\n      <a class=\"title\" href=\"<%- url_for(post.path) %>\"><%= post.title %></a>\n      <span class=\"date\"><%= post.date.format('YYYY-MM-DD') %></span>\n    </div>\n  <% }) %>\n  <div class=\"pagination\">\n    <%- paginator({ total: Math.ceil(site.posts.length / config.per_page)}) %>\n  </div>\n</div>\n~~~\ncategory\n\n### \npage.post,site.posts.length,config.per_pageHexoHexo:\n\n- site: site.posts.length\n\n- page: index.ejspage.postssite.posts\n\n- config: _config.yml\n\n- theme: _config.yml\n\n#### (Helper)\nlinklinkactiveHexo!Hexo**paginator**site.posts.lengthconfig.per_page\n\n##### Helper:\n\n- **list_tags([options])**: \n\n- **js(path/to/js), css(path/to/css)** path()source\n\n- **partial(path/to/partial)** layout\n\n### \nHexoHTML+CSSCSS\n\n### \n#### Disqus\n\npartial\n\n~~~ JavaScript\n//_partial/article.ejs\n<section class='post-content'>\n    <%- post.content %>\n</section>\n//post.commentsconfig.duoshuo_shortname\nconfig.disqus_shortname\n<% if(post.comments){ %>\n    <section id=\"comments\">\n    <% if (config.duoshuo_shortname){ %>\n            <%- partial('_partial/duoshuo') %>\n        <% }else if(config.disqus_shortname){ %>\n            <%- partial('_partial/disqus') %>\n        <% } %>\n    </section>\n<% } %>\n~~~\nDisqusjs**_partial/duoshuo.ejs_partial/disqus.ejs**ok~\n\n#### highlight.js\n\nhighlight.js:\n\n~~~ JavaScript\n//showonne/_config.yml\n\n...other configs\n\n# highlight.js\nhighlight_theme: zenburn\n~~~\nlayout.ejs:\n\n~~~ JavaScript\n<link rel=\"stylesheet\" href=\"//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/styles/<%= theme.highlight_theme %>.min.css\">\n~~~\nCDN\n\n### \nlandscape\n\n### \n","source":"_posts/2016-12-06-hexo-learning1.md","raw":"---\nlayout: post\ntitle:  Hexo Hexo \ncategory: accumulation\ntags:\n  - Hexo\n  - Hexo structure\nkeywords: Hexo\nbanner: http://obxk8w81b.bkt.clouddn.com/Boy%20Cutting%20Grass%20with%20a%20Sickle.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Boy%20Cutting%20Grass%20with%20a%20Sickle.jpg\n---\n\n### \nHexo_config.ymltheme, themes/landscape\n\nthemes/landscape/docs-themes4\n\n- _config.yml: \n- source/: CSS\n- layout/: \n- scripts: JavaScript\n\n[docs-templates](https://hexo.io/docs/templates.html)index\n\n<!--more-->\n\n|Template|Page|\tFallback|\n|:--------:|:-------:|:--------:|\n|index\t|Home page | |\n|post\t|Posts\t|index|\n|page|\tPages |index|\n|archive\t|Archives|\tindex|\n|category\t|Category archives\t|archive|\n|tag\t|Tag archives|\tarchive|\n\n\n\nHexosourcesURLURL(EJS)\n\nURLHexolayout.ejsbody(Fallback/archivesarchives.ejsindex.ejs)\n\n\n### \n#### (layout.ejs)\n\nlayoutHexoindex,post,page,archive,category,tagheader + content + footerheaderfooterlayout.ejsbodylayout.ejs:\n\n~~~ JavaScript\n<!doctype html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, user-scalable=no\"/>\n    <title><%= config.title %></title>\n    <%- css('css/style') %>\n</head>\n<body>\n    <%- partial('_partial/header') %>\n    <div class=\"main\">\n        <%- body %>\n    </div>\n    <%- partial('_partial/footer') %>\n    <%- js('js/index.js') %>\n</body>\n</html>\n~~~\n\npartial,jscssHexo\n\n#### \n\nhexo new <title>hexo new [layout] <title>layoutAbouthexo new page \"about\"pageindex.ejs(),post.ejs(),archive.ejs(),tag.ejs(),page.ejs()\n\n##### index.ejs\n\nHexopageindex.ejsHTML_partial/article.ejs{index: true}post.ejspage.ejsindex.ejs:\n\n~~~ JavaScript\n//index.ejs\n<% page.posts.each(function(post, index){ %>\n    <%- partial('_partial/article', {index: true, post: post}) %>\n<% }) %>\n<div class=\"pagination\">\n    <%- paginator({ total: Math.ceil(site.posts.length / config.per_page)}) %>\n</div>\n~~~\n##### post.ejs\n\n{index: false}( XD\n\n~~~ JavaScript\n//post.ejs\n<%- partial('_partial/article', {index: false, post: page}) %>\n~~~\n##### page.ejs\n\nPageabout(hexo new page \"about\")/about/source/aboutindex.mdPage:\n\n~~~ JavaScript\n//page.ejs\n<%- partial('_partial/article', {index: false, post: page}) %>\n_partial/article.ejs\n~~~\narticlepagepost:(index: true)(index: false)_partial/article.ejs\n\n~~~ JavaScript\n//_partial/article.ejs\n<% if(index){ %>\n    //index logic...\n<% }else{ %>\n    //post or page logic...\n<% } %>\n~~~\n\n##### tag.ejs\n\nHexolist_tagsok:\n\n~~~ JavaScript\n//tag.ejs\n<%- list_tags() %>\n~~~\n:\n\n~~~ JavaScript\n//archive.ejs\n<div class=\"archive\">\n  <% var lastyear; %>\n  <% page.posts.each(function(post){ %>\n    <% var year = post.date.year() %>\n    <% if(lastyear !== year){ %>\n      <h4 class=\"year\"><%= year %></h4>\n      <% lastyear = year %>\n    <% } %>\n    <div class=\"archive_item\">\n      <a class=\"title\" href=\"<%- url_for(post.path) %>\"><%= post.title %></a>\n      <span class=\"date\"><%= post.date.format('YYYY-MM-DD') %></span>\n    </div>\n  <% }) %>\n  <div class=\"pagination\">\n    <%- paginator({ total: Math.ceil(site.posts.length / config.per_page)}) %>\n  </div>\n</div>\n~~~\ncategory\n\n### \npage.post,site.posts.length,config.per_pageHexoHexo:\n\n- site: site.posts.length\n\n- page: index.ejspage.postssite.posts\n\n- config: _config.yml\n\n- theme: _config.yml\n\n#### (Helper)\nlinklinkactiveHexo!Hexo**paginator**site.posts.lengthconfig.per_page\n\n##### Helper:\n\n- **list_tags([options])**: \n\n- **js(path/to/js), css(path/to/css)** path()source\n\n- **partial(path/to/partial)** layout\n\n### \nHexoHTML+CSSCSS\n\n### \n#### Disqus\n\npartial\n\n~~~ JavaScript\n//_partial/article.ejs\n<section class='post-content'>\n    <%- post.content %>\n</section>\n//post.commentsconfig.duoshuo_shortname\nconfig.disqus_shortname\n<% if(post.comments){ %>\n    <section id=\"comments\">\n    <% if (config.duoshuo_shortname){ %>\n            <%- partial('_partial/duoshuo') %>\n        <% }else if(config.disqus_shortname){ %>\n            <%- partial('_partial/disqus') %>\n        <% } %>\n    </section>\n<% } %>\n~~~\nDisqusjs**_partial/duoshuo.ejs_partial/disqus.ejs**ok~\n\n#### highlight.js\n\nhighlight.js:\n\n~~~ JavaScript\n//showonne/_config.yml\n\n...other configs\n\n# highlight.js\nhighlight_theme: zenburn\n~~~\nlayout.ejs:\n\n~~~ JavaScript\n<link rel=\"stylesheet\" href=\"//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/styles/<%= theme.highlight_theme %>.min.css\">\n~~~\nCDN\n\n### \nlandscape\n\n### \n","slug":"hexo-learning1","published":1,"date":"2016-12-05T16:00:00.000Z","updated":"2017-11-23T07:11:47.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ebzh0028d6ykai5f5jkl","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Hexo_config.ymltheme, themes/landscape</p>\n<p>themes/landscape/docs-themes4</p>\n<ul>\n<li>_config.yml: </li>\n<li>source/: CSS</li>\n<li>layout/: </li>\n<li>scripts: JavaScript</li>\n</ul>\n<p><a href=\"https://hexo.io/docs/templates.html\" target=\"_blank\" rel=\"external\">docs-templates</a>index</p>\n<a id=\"more\"></a>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">Template</th>\n<th style=\"text-align:center\">Page</th>\n<th style=\"text-align:center\">Fallback</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">index</td>\n<td style=\"text-align:center\">Home page</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">post</td>\n<td style=\"text-align:center\">Posts</td>\n<td style=\"text-align:center\">index</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">page</td>\n<td style=\"text-align:center\">Pages</td>\n<td style=\"text-align:center\">index</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">archive</td>\n<td style=\"text-align:center\">Archives</td>\n<td style=\"text-align:center\">index</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">category</td>\n<td style=\"text-align:center\">Category archives</td>\n<td style=\"text-align:center\">archive</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">tag</td>\n<td style=\"text-align:center\">Tag archives</td>\n<td style=\"text-align:center\">archive</td>\n</tr>\n</tbody>\n</table>\n<p>HexosourcesURLURL(EJS)</p>\n<p>URLHexolayout.ejsbody(Fallback/archivesarchives.ejsindex.ejs)</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"-layout-ejs\"><a href=\"#-layout-ejs\" class=\"headerlink\" title=\"(layout.ejs)\"></a>(layout.ejs)</h4><p>layoutHexoindex,post,page,archive,category,tagheader + content + footerheaderfooterlayout.ejsbodylayout.ejs:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;!doctype html&gt;</div><div class=\"line\">&lt;html lang=\"en\"&gt;</div><div class=\"line\">&lt;head&gt;</div><div class=\"line\">    &lt;meta charset=\"UTF-8\"&gt;</div><div class=\"line\">    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, user-scalable=no\"/&gt;</div><div class=\"line\">    &lt;title&gt;&lt;%= config.title %&gt;&lt;/title&gt;</div><div class=\"line\">    &lt;%- css('css/style') %&gt;</div><div class=\"line\">&lt;/head&gt;</div><div class=\"line\">&lt;body&gt;</div><div class=\"line\">    &lt;%- partial('_partial/header') %&gt;</div><div class=\"line\">    &lt;div class=\"main\"&gt;</div><div class=\"line\">        &lt;%- body %&gt;</div><div class=\"line\">    &lt;/div&gt;</div><div class=\"line\">    &lt;%- partial('_partial/footer') %&gt;</div><div class=\"line\">    &lt;%- js('js/index.js') %&gt;</div><div class=\"line\">&lt;/body&gt;</div><div class=\"line\">&lt;/html&gt;</div></pre></td></tr></table></figure>\n<p>partial,jscssHexo</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>hexo new <title>hexo new [layout] <title>layoutAbouthexo new page aboutpageindex.ejs(),post.ejs(),archive.ejs(),tag.ejs(),page.ejs()</title></title></p>\n<h5 id=\"index-ejs\"><a href=\"#index-ejs\" class=\"headerlink\" title=\"index.ejs\"></a>index.ejs</h5><p>Hexopageindex.ejsHTML_partial/article.ejs{index: true}post.ejspage.ejsindex.ejs:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//index.ejs</span></div><div class=\"line\">&lt;% page.posts.each(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">post, index</span>)</span>&#123; %&gt;</div><div class=\"line\">    &lt;%- partial('_partial/article', &#123;index: true, post: post&#125;) %&gt;</div><div class=\"line\">&lt;% &#125;) %&gt;</div><div class=\"line\">&lt;div class=\"pagination\"&gt;</div><div class=\"line\">    &lt;%- paginator(&#123; total: Math.ceil(site.posts.length / config.per_page)&#125;) %&gt;</div><div class=\"line\">&lt;/div&gt;</div></pre></td></tr></table></figure>\n<h5 id=\"post-ejs\"><a href=\"#post-ejs\" class=\"headerlink\" title=\"post.ejs\"></a>post.ejs</h5><p>{index: false}( XD</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//post.ejs</span></div><div class=\"line\">&lt;%- partial(<span class=\"string\">'_partial/article'</span>, &#123;<span class=\"attr\">index</span>: <span class=\"literal\">false</span>, <span class=\"attr\">post</span>: page&#125;) %&gt;</div></pre></td></tr></table></figure>\n<h5 id=\"page-ejs\"><a href=\"#page-ejs\" class=\"headerlink\" title=\"page.ejs\"></a>page.ejs</h5><p>Pageabout(hexo new page about)/about/source/aboutindex.mdPage:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//page.ejs</span></div><div class=\"line\">&lt;%- partial(<span class=\"string\">'_partial/article'</span>, &#123;<span class=\"attr\">index</span>: <span class=\"literal\">false</span>, <span class=\"attr\">post</span>: page&#125;) %&gt;</div><div class=\"line\">_partial/article.ejs</div></pre></td></tr></table></figure>\n<p>articlepagepost:(index: true)(index: false)_partial/article.ejs</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//_partial/article.ejs</span></div><div class=\"line\">&lt;% <span class=\"keyword\">if</span>(index)&#123; %&gt;</div><div class=\"line\">    <span class=\"comment\">//index logic...</span></div><div class=\"line\">&lt;% &#125;<span class=\"keyword\">else</span>&#123; %&gt;</div><div class=\"line\">    <span class=\"comment\">//post or page logic...</span></div><div class=\"line\">&lt;% &#125; %&gt;</div></pre></td></tr></table></figure>\n<h5 id=\"tag-ejs\"><a href=\"#tag-ejs\" class=\"headerlink\" title=\"tag.ejs\"></a>tag.ejs</h5><p>Hexolist_tagsok:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//tag.ejs</span></div><div class=\"line\">&lt;%- list_tags() %&gt;</div></pre></td></tr></table></figure>\n<p>:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//archive.ejs</span></div><div class=\"line\">&lt;div <span class=\"class\"><span class=\"keyword\">class</span></span>=<span class=\"string\">\"archive\"</span>&gt;</div><div class=\"line\">  &lt;% var lastyear; %&gt;</div><div class=\"line\">  &lt;% page.posts.each(function(post)&#123; %&gt;</div><div class=\"line\">    &lt;% var year = post.date.year() %&gt;</div><div class=\"line\">    &lt;% if(lastyear !== year)&#123; %&gt;</div><div class=\"line\">      &lt;h4 class=\"year\"&gt;&lt;%= year %&gt;&lt;/h4&gt;</div><div class=\"line\">      &lt;% lastyear = year %&gt;</div><div class=\"line\">    &lt;% &#125; %&gt;</div><div class=\"line\">    &lt;div class=\"archive_item\"&gt;</div><div class=\"line\">      &lt;a class=\"title\" href=\"&lt;%- url_for(post.path) %&gt;\"&gt;&lt;%= post.title %&gt;&lt;/a&gt;</div><div class=\"line\">      &lt;span class=\"date\"&gt;&lt;%= post.date.format('YYYY-MM-DD') %&gt;&lt;/span&gt;</div><div class=\"line\">    &lt;/div&gt;</div><div class=\"line\">  &lt;% &#125;) %&gt;</div><div class=\"line\">  &lt;div class=\"pagination\"&gt;</div><div class=\"line\">    &lt;%- paginator(&#123; total: Math.ceil(site.posts.length / config.per_page)&#125;) %&gt;</div><div class=\"line\">  &lt;/div&gt;</div><div class=\"line\">&lt;/div&gt;</div></pre></td></tr></table></figure>\n<p>category</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>page.post,site.posts.length,config.per_pageHexoHexo:</p>\n<ul>\n<li><p>site: site.posts.length</p>\n</li>\n<li><p>page: index.ejspage.postssite.posts</p>\n</li>\n<li><p>config: _config.yml</p>\n</li>\n<li><p>theme: _config.yml</p>\n</li>\n</ul>\n<h4 id=\"-Helper\"><a href=\"#-Helper\" class=\"headerlink\" title=\"(Helper)\"></a>(Helper)</h4><p>linklinkactiveHexo!Hexo<strong>paginator</strong>site.posts.lengthconfig.per_page</p>\n<h5 id=\"Helper\"><a href=\"#Helper\" class=\"headerlink\" title=\"Helper:\"></a>Helper:</h5><ul>\n<li><p><strong>list_tags([options])</strong>: </p>\n</li>\n<li><p><strong>js(path/to/js), css(path/to/css)</strong> path()source</p>\n</li>\n<li><p><strong>partial(path/to/partial)</strong> layout</p>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>HexoHTML+CSSCSS</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"Disqus\"><a href=\"#Disqus\" class=\"headerlink\" title=\"Disqus\"></a>Disqus</h4><p>partial</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//_partial/article.ejs</span></div><div class=\"line\">&lt;section <span class=\"class\"><span class=\"keyword\">class</span></span>=<span class=\"string\">'post-content'</span>&gt;</div><div class=\"line\">    &lt;%- post.content %&gt;</div><div class=\"line\">&lt;/section&gt;</div><div class=\"line\"><span class=\"comment\">//post.commentsconfig.duoshuo_shortname</span></div><div class=\"line\">config.disqus_shortname</div><div class=\"line\">&lt;% <span class=\"keyword\">if</span>(post.comments)&#123; %&gt;</div><div class=\"line\">    &lt;section id=\"comments\"&gt;</div><div class=\"line\">    &lt;% if (config.duoshuo_shortname)&#123; %&gt;</div><div class=\"line\">            &lt;%- partial('_partial/duoshuo') %&gt;</div><div class=\"line\">        &lt;% &#125;else if(config.disqus_shortname)&#123; %&gt;</div><div class=\"line\">            &lt;%- partial('_partial/disqus') %&gt;</div><div class=\"line\">        &lt;% &#125; %&gt;</div><div class=\"line\">    &lt;/section&gt;</div><div class=\"line\">&lt;% &#125; %&gt;</div></pre></td></tr></table></figure>\n<p>Disqusjs<strong>_partial/duoshuo.ejs_partial/disqus.ejs</strong>ok~</p>\n<h4 id=\"highlight-js\"><a href=\"#highlight-js\" class=\"headerlink\" title=\"highlight.js\"></a>highlight.js</h4><p>highlight.js:</p>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><div class=\"line\">//showonne/_config.yml</div><div class=\"line\"></div><div class=\"line\">...other configs</div><div class=\"line\"></div><div class=\"line\"># highlight.js</div><div class=\"line\">highlight_theme: zenburn</div></pre></td></tr></table></figure>\n<p>layout.ejs:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;link rel=<span class=\"string\">\"stylesheet\"</span> href=<span class=\"string\">\"//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/styles/&lt;%= theme.highlight_theme %&gt;.min.css\"</span>&gt;</div></pre></td></tr></table></figure>\n<p>CDN</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>landscape</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/12/06/hexo-learning1/\">http://agehua.github.io/2016/12/06/hexo-learning1/</a></p>\n","readingTime":{"text":"3 min read","minutes":2.365,"time":141900,"words":473},"excerpt":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Hexo_config.ymltheme, themes/landscape</p>\n<p>themes/landscape/docs-themes4</p>\n<ul>\n<li>_config.yml: </li>\n<li>source/: CSS</li>\n<li>layout/: </li>\n<li>scripts: JavaScript</li>\n</ul>\n<p><a href=\"https://hexo.io/docs/templates.html\">docs-templates</a>index</p>","more":"<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">Template</th>\n<th style=\"text-align:center\">Page</th>\n<th style=\"text-align:center\">Fallback</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">index</td>\n<td style=\"text-align:center\">Home page</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">post</td>\n<td style=\"text-align:center\">Posts</td>\n<td style=\"text-align:center\">index</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">page</td>\n<td style=\"text-align:center\">Pages</td>\n<td style=\"text-align:center\">index</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">archive</td>\n<td style=\"text-align:center\">Archives</td>\n<td style=\"text-align:center\">index</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">category</td>\n<td style=\"text-align:center\">Category archives</td>\n<td style=\"text-align:center\">archive</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">tag</td>\n<td style=\"text-align:center\">Tag archives</td>\n<td style=\"text-align:center\">archive</td>\n</tr>\n</tbody>\n</table>\n<p>HexosourcesURLURL(EJS)</p>\n<p>URLHexolayout.ejsbody(Fallback/archivesarchives.ejsindex.ejs)</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"-layout-ejs\"><a href=\"#-layout-ejs\" class=\"headerlink\" title=\"(layout.ejs)\"></a>(layout.ejs)</h4><p>layoutHexoindex,post,page,archive,category,tagheader + content + footerheaderfooterlayout.ejsbodylayout.ejs:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;!doctype html&gt;</div><div class=\"line\">&lt;html lang=\"en\"&gt;</div><div class=\"line\">&lt;head&gt;</div><div class=\"line\">    &lt;meta charset=\"UTF-8\"&gt;</div><div class=\"line\">    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, user-scalable=no\"/&gt;</div><div class=\"line\">    &lt;title&gt;&lt;%= config.title %&gt;&lt;/title&gt;</div><div class=\"line\">    &lt;%- css('css/style') %&gt;</div><div class=\"line\">&lt;/head&gt;</div><div class=\"line\">&lt;body&gt;</div><div class=\"line\">    &lt;%- partial('_partial/header') %&gt;</div><div class=\"line\">    &lt;div class=\"main\"&gt;</div><div class=\"line\">        &lt;%- body %&gt;</div><div class=\"line\">    &lt;/div&gt;</div><div class=\"line\">    &lt;%- partial('_partial/footer') %&gt;</div><div class=\"line\">    &lt;%- js('js/index.js') %&gt;</div><div class=\"line\">&lt;/body&gt;</div><div class=\"line\">&lt;/html&gt;</div></pre></td></tr></table></figure>\n<p>partial,jscssHexo</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>hexo new <title>hexo new [layout] <title>layoutAbouthexo new page aboutpageindex.ejs(),post.ejs(),archive.ejs(),tag.ejs(),page.ejs()</p>\n<h5 id=\"index-ejs\"><a href=\"#index-ejs\" class=\"headerlink\" title=\"index.ejs\"></a>index.ejs</h5><p>Hexopageindex.ejsHTML_partial/article.ejs{index: true}post.ejspage.ejsindex.ejs:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//index.ejs</span></div><div class=\"line\">&lt;% page.posts.each(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">post, index</span>)</span>&#123; %&gt;</div><div class=\"line\">    &lt;%- partial('_partial/article', &#123;index: true, post: post&#125;) %&gt;</div><div class=\"line\">&lt;% &#125;) %&gt;</div><div class=\"line\">&lt;div class=\"pagination\"&gt;</div><div class=\"line\">    &lt;%- paginator(&#123; total: Math.ceil(site.posts.length / config.per_page)&#125;) %&gt;</div><div class=\"line\">&lt;/div&gt;</div></pre></td></tr></table></figure>\n<h5 id=\"post-ejs\"><a href=\"#post-ejs\" class=\"headerlink\" title=\"post.ejs\"></a>post.ejs</h5><p>{index: false}( XD</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//post.ejs</span></div><div class=\"line\">&lt;%- partial(<span class=\"string\">'_partial/article'</span>, &#123;<span class=\"attr\">index</span>: <span class=\"literal\">false</span>, <span class=\"attr\">post</span>: page&#125;) %&gt;</div></pre></td></tr></table></figure>\n<h5 id=\"page-ejs\"><a href=\"#page-ejs\" class=\"headerlink\" title=\"page.ejs\"></a>page.ejs</h5><p>Pageabout(hexo new page about)/about/source/aboutindex.mdPage:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//page.ejs</span></div><div class=\"line\">&lt;%- partial(<span class=\"string\">'_partial/article'</span>, &#123;<span class=\"attr\">index</span>: <span class=\"literal\">false</span>, <span class=\"attr\">post</span>: page&#125;) %&gt;</div><div class=\"line\">_partial/article.ejs</div></pre></td></tr></table></figure>\n<p>articlepagepost:(index: true)(index: false)_partial/article.ejs</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//_partial/article.ejs</span></div><div class=\"line\">&lt;% <span class=\"keyword\">if</span>(index)&#123; %&gt;</div><div class=\"line\">    <span class=\"comment\">//index logic...</span></div><div class=\"line\">&lt;% &#125;<span class=\"keyword\">else</span>&#123; %&gt;</div><div class=\"line\">    <span class=\"comment\">//post or page logic...</span></div><div class=\"line\">&lt;% &#125; %&gt;</div></pre></td></tr></table></figure>\n<h5 id=\"tag-ejs\"><a href=\"#tag-ejs\" class=\"headerlink\" title=\"tag.ejs\"></a>tag.ejs</h5><p>Hexolist_tagsok:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//tag.ejs</span></div><div class=\"line\">&lt;%- list_tags() %&gt;</div></pre></td></tr></table></figure>\n<p>:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//archive.ejs</span></div><div class=\"line\">&lt;div <span class=\"class\"><span class=\"keyword\">class</span></span>=<span class=\"string\">\"archive\"</span>&gt;</div><div class=\"line\">  &lt;% var lastyear; %&gt;</div><div class=\"line\">  &lt;% page.posts.each(function(post)&#123; %&gt;</div><div class=\"line\">    &lt;% var year = post.date.year() %&gt;</div><div class=\"line\">    &lt;% if(lastyear !== year)&#123; %&gt;</div><div class=\"line\">      &lt;h4 class=\"year\"&gt;&lt;%= year %&gt;&lt;/h4&gt;</div><div class=\"line\">      &lt;% lastyear = year %&gt;</div><div class=\"line\">    &lt;% &#125; %&gt;</div><div class=\"line\">    &lt;div class=\"archive_item\"&gt;</div><div class=\"line\">      &lt;a class=\"title\" href=\"&lt;%- url_for(post.path) %&gt;\"&gt;&lt;%= post.title %&gt;&lt;/a&gt;</div><div class=\"line\">      &lt;span class=\"date\"&gt;&lt;%= post.date.format('YYYY-MM-DD') %&gt;&lt;/span&gt;</div><div class=\"line\">    &lt;/div&gt;</div><div class=\"line\">  &lt;% &#125;) %&gt;</div><div class=\"line\">  &lt;div class=\"pagination\"&gt;</div><div class=\"line\">    &lt;%- paginator(&#123; total: Math.ceil(site.posts.length / config.per_page)&#125;) %&gt;</div><div class=\"line\">  &lt;/div&gt;</div><div class=\"line\">&lt;/div&gt;</div></pre></td></tr></table></figure>\n<p>category</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>page.post,site.posts.length,config.per_pageHexoHexo:</p>\n<ul>\n<li><p>site: site.posts.length</p>\n</li>\n<li><p>page: index.ejspage.postssite.posts</p>\n</li>\n<li><p>config: _config.yml</p>\n</li>\n<li><p>theme: _config.yml</p>\n</li>\n</ul>\n<h4 id=\"-Helper\"><a href=\"#-Helper\" class=\"headerlink\" title=\"(Helper)\"></a>(Helper)</h4><p>linklinkactiveHexo!Hexo<strong>paginator</strong>site.posts.lengthconfig.per_page</p>\n<h5 id=\"Helper\"><a href=\"#Helper\" class=\"headerlink\" title=\"Helper:\"></a>Helper:</h5><ul>\n<li><p><strong>list_tags([options])</strong>: </p>\n</li>\n<li><p><strong>js(path/to/js), css(path/to/css)</strong> path()source</p>\n</li>\n<li><p><strong>partial(path/to/partial)</strong> layout</p>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>HexoHTML+CSSCSS</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"Disqus\"><a href=\"#Disqus\" class=\"headerlink\" title=\"Disqus\"></a>Disqus</h4><p>partial</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//_partial/article.ejs</span></div><div class=\"line\">&lt;section <span class=\"class\"><span class=\"keyword\">class</span></span>=<span class=\"string\">'post-content'</span>&gt;</div><div class=\"line\">    &lt;%- post.content %&gt;</div><div class=\"line\">&lt;/section&gt;</div><div class=\"line\"><span class=\"comment\">//post.commentsconfig.duoshuo_shortname</span></div><div class=\"line\">config.disqus_shortname</div><div class=\"line\">&lt;% <span class=\"keyword\">if</span>(post.comments)&#123; %&gt;</div><div class=\"line\">    &lt;section id=\"comments\"&gt;</div><div class=\"line\">    &lt;% if (config.duoshuo_shortname)&#123; %&gt;</div><div class=\"line\">            &lt;%- partial('_partial/duoshuo') %&gt;</div><div class=\"line\">        &lt;% &#125;else if(config.disqus_shortname)&#123; %&gt;</div><div class=\"line\">            &lt;%- partial('_partial/disqus') %&gt;</div><div class=\"line\">        &lt;% &#125; %&gt;</div><div class=\"line\">    &lt;/section&gt;</div><div class=\"line\">&lt;% &#125; %&gt;</div></pre></td></tr></table></figure>\n<p>Disqusjs<strong>_partial/duoshuo.ejs_partial/disqus.ejs</strong>ok~</p>\n<h4 id=\"highlight-js\"><a href=\"#highlight-js\" class=\"headerlink\" title=\"highlight.js\"></a>highlight.js</h4><p>highlight.js:</p>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><div class=\"line\">//showonne/_config.yml</div><div class=\"line\"></div><div class=\"line\">...other configs</div><div class=\"line\"></div><div class=\"line\"># highlight.js</div><div class=\"line\">highlight_theme: zenburn</div></pre></td></tr></table></figure>\n<p>layout.ejs:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;link rel=<span class=\"string\">\"stylesheet\"</span> href=<span class=\"string\">\"//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/styles/&lt;%= theme.highlight_theme %&gt;.min.css\"</span>&gt;</div></pre></td></tr></table></figure>\n<p>CDN</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>landscape</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/12/06/hexo-learning1/\">http://agehua.github.io/2016/12/06/hexo-learning1/</a></p>"},{"layout":"post","title":"Hexo EJS","keywords":"EJS","banner":"http://obxk8w81b.bkt.clouddn.com/Bulb%20Fields.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Bulb%20Fields.jpg","toc":true,"_content":"\n### EJS\n\nEJSJavaScriptJSONHTML\n\n### EJS\n#### 1html\n\n#### 2&lt;% code %&gt;javascript\n~~~ javascript\n<% alert('hello world') %>\n~~~\n#### 3&lt;%= code =%&gt;codehtml\n\n<!--more-->\n\n~~~ javascript\n<h1><%=title %></h1>                    titleh1\n<p><%= 'hello world' %></p>             hello worldh1\n<h1><%= '<b>hello world</b>' %></h1>    hello worldh1\n~~~ javascript\n#### 4<%- code %>html\n\n~~~ javascript\n<h1><%-title %>asd</h1>          asd\n<p><%# 'hello world' %>asd</p>   asd\n~~~\n#### 5'&lt;%''{{''%&gt;''}}'\n\n    ejs  <%  .. %>\n\n~~~ javascript\napp.set(\"view options\",{                                                                                  \n   \"open\":\"{{\",                                                                                  \n   \"close\":\"}}\"\n});\n~~~\n#### 6\n\n- 1)first\n- 2)last\n- 3)capitalize\n- 4)downcase\n- 5)upcase\n- 6)sortObject.create(obj).sort()\n- 7)sort_by:'prop'prop\n- 8)sizelength\n- 9)plus:nnNumber\n- 10)minus:nnNumber\n- 11)times:nnNumber\n- 12)divided_by:nnNumber\n- 13)join:'val''val'\n- 14)truncate:nn\n- 15)truncate_words:nnwordword\n- 16)replace:pattern,substitutionsubstitution\n- 17)prepend:valval\n- 18)append:valval\n- 19)map:'prop'prop\n- 20)reverse\n- 21)get:'prop''prop'\n- 22)jsonjson\n\n**&lt;%- include filename %&gt;**\n\n#### ejs\n\nejs \n\n- 1.\n\n~~~ JavaScript\n<%= title %>\n~~~\n\n- 2.forjsfor\n\n~~~ JavaScript\n<% for(var i=0; i<headerNavbar.length; i++) {%>\n    <li><a href=\"/reg\"><%= headerNavbar[i].name %></a></li>\n<% } %>\n~~~\n\n- 3.ifjsif\n\n~~~ JavaScript\n <% if(active=='index'){%>\nclass=\"active\"\n <% }%>\n~~~\n\n### stylus\n[stylus](https://segmentfault.com/a/1190000002712872)\n\nstylushttp://stylus-lang.com/\n\nStylus CSS2010Node.jsNodeCSS Stylus CSS SASS/LESS CSS\n\nStylusjsEXPRESSIVE, DYNAMIC, ROBUST CSS\n\n#### Stylus\n\nnode\n~~~ JavaScript\n$ npm install stylus -g\n~~~\n\n#### CSS\nstylusExample/ src  stylus  example.styl  stylusExample \n~~~ JavaScript\n$ stylus --compress src/\n~~~\n\ncompiled src/example.css --compressCSS\n~~~ JavaScript\n$ stylus --css css/example.css css/out.styl CSSstyl\n$ stylus help box-shadow CSS\n$ stylus --css test.css .styl\n~~~\n\n: [Stylus](http://www.zhangxinxu.com/jq/stylus/)\n\n### CSS3 column\nCSS3columnsCSS\n\nColumns\n[CSS3 column](http://cdn2.jianshu.io/p/87d1862f88c6)\n\n### \ncolumn\n\n\n#### Bootstrap:\n[Bootstrap](http://getbootstrap.com/)CSSGird system12\n\nBootstrap2\n- 1containerrowcolumn\n~~~ JavaScript\n<div class=\"container\">\n    <div class=\"row\">\n        <div class=\"col-md-6\"></div>\n        <div class=\"col-md-6\"></div>\n    </div>\n</div>\n~~~\n- 2\n\n  Bootstrapcolumn.col-xx-yy12xxxssmmdlg\n\n  Bootstrapviewportcolumndisplay: blockcolumnfloatxssmmdlgxsxscolumn\n\n#### Foundation\nFoundationGridBootstrapFoundation12\n\n- \nBootstrapFoundation\n~~~ JavaScript\n<div class=\"row\">\n    <div class=\"medium-6 columns\"></div>\n    <div class=\"medium-6 columns\"></div>\n</div>\n~~~\nFoundation.row.columns.column2.medium-6FoundationsmallmediumlargesmallBootstrapxs\n\nFoundationcontainerrowcolumnBootstraprowcontainercolumn0.9375remcolumnrowcolumn\n\nBootstrapFoundationempxBootstrap\n\n#### Block Grid\n\nFoundationBlock Grid\n\n> [css](http://acgtofe.com/posts/2015/07/a-story-of-grid)\n","source":"_posts/2016-12-04-hexo-learning0.md","raw":"---\nlayout: post\ntitle:  Hexo EJS\ncategory: accumulation\ntags:\n  - Hexo\n  - EJS\nkeywords: EJS\nbanner: http://obxk8w81b.bkt.clouddn.com/Bulb%20Fields.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Bulb%20Fields.jpg\ntoc: true\n---\n\n### EJS\n\nEJSJavaScriptJSONHTML\n\n### EJS\n#### 1html\n\n#### 2&lt;% code %&gt;javascript\n~~~ javascript\n<% alert('hello world') %>\n~~~\n#### 3&lt;%= code =%&gt;codehtml\n\n<!--more-->\n\n~~~ javascript\n<h1><%=title %></h1>                    titleh1\n<p><%= 'hello world' %></p>             hello worldh1\n<h1><%= '<b>hello world</b>' %></h1>    hello worldh1\n~~~ javascript\n#### 4<%- code %>html\n\n~~~ javascript\n<h1><%-title %>asd</h1>          asd\n<p><%# 'hello world' %>asd</p>   asd\n~~~\n#### 5'&lt;%''{{''%&gt;''}}'\n\n    ejs  <%  .. %>\n\n~~~ javascript\napp.set(\"view options\",{                                                                                  \n   \"open\":\"{{\",                                                                                  \n   \"close\":\"}}\"\n});\n~~~\n#### 6\n\n- 1)first\n- 2)last\n- 3)capitalize\n- 4)downcase\n- 5)upcase\n- 6)sortObject.create(obj).sort()\n- 7)sort_by:'prop'prop\n- 8)sizelength\n- 9)plus:nnNumber\n- 10)minus:nnNumber\n- 11)times:nnNumber\n- 12)divided_by:nnNumber\n- 13)join:'val''val'\n- 14)truncate:nn\n- 15)truncate_words:nnwordword\n- 16)replace:pattern,substitutionsubstitution\n- 17)prepend:valval\n- 18)append:valval\n- 19)map:'prop'prop\n- 20)reverse\n- 21)get:'prop''prop'\n- 22)jsonjson\n\n**&lt;%- include filename %&gt;**\n\n#### ejs\n\nejs \n\n- 1.\n\n~~~ JavaScript\n<%= title %>\n~~~\n\n- 2.forjsfor\n\n~~~ JavaScript\n<% for(var i=0; i<headerNavbar.length; i++) {%>\n    <li><a href=\"/reg\"><%= headerNavbar[i].name %></a></li>\n<% } %>\n~~~\n\n- 3.ifjsif\n\n~~~ JavaScript\n <% if(active=='index'){%>\nclass=\"active\"\n <% }%>\n~~~\n\n### stylus\n[stylus](https://segmentfault.com/a/1190000002712872)\n\nstylushttp://stylus-lang.com/\n\nStylus CSS2010Node.jsNodeCSS Stylus CSS SASS/LESS CSS\n\nStylusjsEXPRESSIVE, DYNAMIC, ROBUST CSS\n\n#### Stylus\n\nnode\n~~~ JavaScript\n$ npm install stylus -g\n~~~\n\n#### CSS\nstylusExample/ src  stylus  example.styl  stylusExample \n~~~ JavaScript\n$ stylus --compress src/\n~~~\n\ncompiled src/example.css --compressCSS\n~~~ JavaScript\n$ stylus --css css/example.css css/out.styl CSSstyl\n$ stylus help box-shadow CSS\n$ stylus --css test.css .styl\n~~~\n\n: [Stylus](http://www.zhangxinxu.com/jq/stylus/)\n\n### CSS3 column\nCSS3columnsCSS\n\nColumns\n[CSS3 column](http://cdn2.jianshu.io/p/87d1862f88c6)\n\n### \ncolumn\n\n\n#### Bootstrap:\n[Bootstrap](http://getbootstrap.com/)CSSGird system12\n\nBootstrap2\n- 1containerrowcolumn\n~~~ JavaScript\n<div class=\"container\">\n    <div class=\"row\">\n        <div class=\"col-md-6\"></div>\n        <div class=\"col-md-6\"></div>\n    </div>\n</div>\n~~~\n- 2\n\n  Bootstrapcolumn.col-xx-yy12xxxssmmdlg\n\n  Bootstrapviewportcolumndisplay: blockcolumnfloatxssmmdlgxsxscolumn\n\n#### Foundation\nFoundationGridBootstrapFoundation12\n\n- \nBootstrapFoundation\n~~~ JavaScript\n<div class=\"row\">\n    <div class=\"medium-6 columns\"></div>\n    <div class=\"medium-6 columns\"></div>\n</div>\n~~~\nFoundation.row.columns.column2.medium-6FoundationsmallmediumlargesmallBootstrapxs\n\nFoundationcontainerrowcolumnBootstraprowcontainercolumn0.9375remcolumnrowcolumn\n\nBootstrapFoundationempxBootstrap\n\n#### Block Grid\n\nFoundationBlock Grid\n\n> [css](http://acgtofe.com/posts/2015/07/a-story-of-grid)\n","slug":"hexo-learning0","published":1,"date":"2016-12-03T16:00:00.000Z","updated":"2017-11-23T07:11:33.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ebzq002cd6ykpfj7p8na","content":"<h3 id=\"EJS\"><a href=\"#EJS\" class=\"headerlink\" title=\"EJS\"></a>EJS</h3><p>EJSJavaScriptJSONHTML</p>\n<h3 id=\"EJS\"><a href=\"#EJS\" class=\"headerlink\" title=\"EJS\"></a>EJS</h3><h4 id=\"1html\"><a href=\"#1html\" class=\"headerlink\" title=\"1html\"></a>1html</h4><h4 id=\"2-lt-code-gt-javascript\"><a href=\"#2-lt-code-gt-javascript\" class=\"headerlink\" title=\"2&lt;% code %&gt;javascript\"></a>2&lt;% code %&gt;javascript</h4><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;% alert(<span class=\"string\">'hello world'</span>) %&gt;</div></pre></td></tr></table></figure>\n<h4 id=\"3-lt-code-gt-codehtml\"><a href=\"#3-lt-code-gt-codehtml\" class=\"headerlink\" title=\"3&lt;%= code =%&gt;codehtml\"></a>3&lt;%= code =%&gt;codehtml</h4><a id=\"more\"></a>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;h1&gt;&lt;%=title %&gt;&lt;/h1&gt;                    titleh1</div><div class=\"line\">&lt;p&gt;&lt;%= 'hello world' %&gt;&lt;/p&gt;             hello worldh1</div><div class=\"line\">&lt;h1&gt;&lt;%= '&lt;b&gt;hello world&lt;/b&gt;' %&gt;&lt;/h1&gt;    hello worldh1</div><div class=\"line\">~~~ javascript</div><div class=\"line\">#### 4&lt;%- code %&gt;html</div><div class=\"line\"></div><div class=\"line\">~~~ javascript</div><div class=\"line\">&lt;h1&gt;&lt;%-title %&gt;asd&lt;/h1&gt;          asd</div><div class=\"line\">&lt;p&gt;&lt;%# 'hello world' %&gt;asd&lt;/p&gt;   asd</div></pre></td></tr></table></figure>\n<h4 id=\"5-lt-\"><a href=\"#5-lt-\" class=\"headerlink\" title=\"5&lt;%\"></a>5&lt;%NaN</h4><pre><code>ejs  &lt;%  .. %&gt;\n</code></pre><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">app.set(<span class=\"string\">\"view options\"</span>,&#123;                                                                                  </div><div class=\"line\">   <span class=\"string\">\"open\"</span>:<span class=\"string\">\"&#123;&#123;\"</span>,                                                                                  </div><div class=\"line\">   <span class=\"string\">\"close\"</span>:<span class=\"string\">\"&#125;&#125;\"</span></div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure>\n<h4 id=\"6\"><a href=\"#6\" class=\"headerlink\" title=\"6\"></a>6</h4><ul>\n<li>1)first</li>\n<li>2)last</li>\n<li>3)capitalize</li>\n<li>4)downcase</li>\n<li>5)upcase</li>\n<li>6)sortObject.create(obj).sort()</li>\n<li>7)sort_by:propprop</li>\n<li>8)sizelength</li>\n<li>9)plus:nnNumber</li>\n<li>10)minus:nnNumber</li>\n<li>11)times:nnNumber</li>\n<li>12)divided_by:nnNumber</li>\n<li>13)join:valval</li>\n<li>14)truncate:nn</li>\n<li>15)truncate_words:nnwordword</li>\n<li>16)replace:pattern,substitutionsubstitution</li>\n<li>17)prepend:valval</li>\n<li>18)append:valval</li>\n<li>19)map:propprop</li>\n<li>20)reverse</li>\n<li>21)get:propprop</li>\n<li>22)jsonjson</li>\n</ul>\n<p><strong>&lt;%- include filename %&gt;</strong></p>\n<h4 id=\"ejs\"><a href=\"#ejs\" class=\"headerlink\" title=\"ejs\"></a>ejs</h4><p>ejs </p>\n<ul>\n<li>1.</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;%= title %&gt;</div></pre></td></tr></table></figure>\n<ul>\n<li>2.forjsfor</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;% <span class=\"keyword\">for</span>(<span class=\"keyword\">var</span> i=<span class=\"number\">0</span>; i&lt;headerNavbar.length; i++) &#123;%&gt;</div><div class=\"line\">    &lt;li&gt;&lt;a href=\"/reg\"&gt;&lt;%= headerNavbar[i].name %&gt;&lt;/a&gt;&lt;/li&gt;</div><div class=\"line\">&lt;% &#125; %&gt;</div></pre></td></tr></table></figure>\n<ul>\n<li>3.ifjsif</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"> &lt;% <span class=\"keyword\">if</span>(active==<span class=\"string\">'index'</span>)&#123;%&gt;</div><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span></span>=<span class=\"string\">\"active\"</span></div><div class=\"line\"> &lt;% &#125;%&gt;</div></pre></td></tr></table></figure>\n<h3 id=\"stylus\"><a href=\"#stylus\" class=\"headerlink\" title=\"stylus\"></a>stylus</h3><p><a href=\"https://segmentfault.com/a/1190000002712872\" target=\"_blank\" rel=\"external\">stylus</a></p>\n<p>stylus<a href=\"http://stylus-lang.com/\" target=\"_blank\" rel=\"external\">http://stylus-lang.com/</a></p>\n<p>Stylus CSS2010Node.jsNodeCSS Stylus CSS SASS/LESS CSS</p>\n<p>StylusjsEXPRESSIVE, DYNAMIC, ROBUST CSS</p>\n<h4 id=\"Stylus\"><a href=\"#Stylus\" class=\"headerlink\" title=\"Stylus\"></a>Stylus</h4><p>node<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">$ npm install stylus -g</div></pre></td></tr></table></figure></p>\n<h4 id=\"CSS\"><a href=\"#CSS\" class=\"headerlink\" title=\"CSS\"></a>CSS</h4><p>stylusExample/ src  stylus  example.styl  stylusExample <br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">$ stylus --compress src/</div></pre></td></tr></table></figure></p>\n<p>compiled src/example.css compressCSS<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">$ stylus --css css/example.css css/out.styl CSSstyl</div><div class=\"line\">$ stylus help box-shadow CSS</div><div class=\"line\">$ stylus --css test.css .styl</div></pre></td></tr></table></figure></p>\n<p>: <a href=\"http://www.zhangxinxu.com/jq/stylus/\" target=\"_blank\" rel=\"external\">Stylus</a></p>\n<h3 id=\"CSS3-column\"><a href=\"#CSS3-column\" class=\"headerlink\" title=\"CSS3 column\"></a>CSS3 column</h3><p>CSS3columnsCSS</p>\n<p>Columns<br><a href=\"http://cdn2.jianshu.io/p/87d1862f88c6\" target=\"_blank\" rel=\"external\">CSS3 column</a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>column</p>\n<p></p>\n<h4 id=\"Bootstrap\"><a href=\"#Bootstrap\" class=\"headerlink\" title=\"Bootstrap:\"></a>Bootstrap:</h4><p><a href=\"http://getbootstrap.com/\" target=\"_blank\" rel=\"external\">Bootstrap</a>CSSGird system12</p>\n<p>Bootstrap2</p>\n<ul>\n<li><p>1containerrowcolumn</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;div <span class=\"class\"><span class=\"keyword\">class</span></span>=<span class=\"string\">\"container\"</span>&gt;</div><div class=\"line\">    &lt;div class=\"row\"&gt;</div><div class=\"line\">        &lt;div class=\"col-md-6\"&gt;&lt;/div&gt;</div><div class=\"line\">        &lt;div class=\"col-md-6\"&gt;&lt;/div&gt;</div><div class=\"line\">    &lt;/div&gt;</div><div class=\"line\">&lt;<span class=\"regexp\">/div&gt;</span></div></pre></td></tr></table></figure>\n</li>\n<li><p>2</p>\n<p>Bootstrapcolumn.col-xx-yy12xxxssmmdlg</p>\n<p>Bootstrapviewportcolumndisplay: blockcolumnfloatxssmmdlgxsxscolumn</p>\n</li>\n</ul>\n<h4 id=\"Foundation\"><a href=\"#Foundation\" class=\"headerlink\" title=\"Foundation\"></a>Foundation</h4><p>FoundationGridBootstrapFoundation12</p>\n<ul>\n<li><br>BootstrapFoundation<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;div <span class=\"class\"><span class=\"keyword\">class</span></span>=<span class=\"string\">\"row\"</span>&gt;</div><div class=\"line\">    &lt;div class=\"medium-6 columns\"&gt;&lt;/div&gt;</div><div class=\"line\">    &lt;div <span class=\"class\"><span class=\"keyword\">class</span></span>=<span class=\"string\">\"medium-6 columns\"</span>&gt;&lt;/div&gt;</div><div class=\"line\">&lt;<span class=\"regexp\">/div&gt;</span></div></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>Foundation.row.columns.column2.medium-6FoundationsmallmediumlargesmallBootstrapxs</p>\n<p>FoundationcontainerrowcolumnBootstraprowcontainercolumn0.9375remcolumnrowcolumn</p>\n<p>BootstrapFoundationempxBootstrap</p>\n<h4 id=\"Block-Grid\"><a href=\"#Block-Grid\" class=\"headerlink\" title=\"Block Grid\"></a>Block Grid</h4><p>FoundationBlock Grid</p>\n<blockquote>\n<p><a href=\"http://acgtofe.com/posts/2015/07/a-story-of-grid\" target=\"_blank\" rel=\"external\">css</a></p>\n</blockquote>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/12/04/hexo-learning0/\">http://agehua.github.io/2016/12/04/hexo-learning0/</a></p>\n","readingTime":{"text":"2 min read","minutes":1.795,"time":107699.99999999999,"words":359},"excerpt":"<h3 id=\"EJS\"><a href=\"#EJS\" class=\"headerlink\" title=\"EJS\"></a>EJS</h3><p>EJSJavaScriptJSONHTML</p>\n<h3 id=\"EJS\"><a href=\"#EJS\" class=\"headerlink\" title=\"EJS\"></a>EJS</h3><h4 id=\"1html\"><a href=\"#1html\" class=\"headerlink\" title=\"1html\"></a>1html</h4><h4 id=\"2-lt-code-gt-javascript\"><a href=\"#2-lt-code-gt-javascript\" class=\"headerlink\" title=\"2&lt;% code %&gt;javascript\"></a>2&lt;% code %&gt;javascript</h4><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;% alert(<span class=\"string\">'hello world'</span>) %&gt;</div></pre></td></tr></table></figure>\n<h4 id=\"3-lt-code-gt-codehtml\"><a href=\"#3-lt-code-gt-codehtml\" class=\"headerlink\" title=\"3&lt;%= code =%&gt;codehtml\"></a>3&lt;%= code =%&gt;codehtml</h4>","more":"<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;h1&gt;&lt;%=title %&gt;&lt;/h1&gt;                    titleh1</div><div class=\"line\">&lt;p&gt;&lt;%= 'hello world' %&gt;&lt;/p&gt;             hello worldh1</div><div class=\"line\">&lt;h1&gt;&lt;%= '&lt;b&gt;hello world&lt;/b&gt;' %&gt;&lt;/h1&gt;    hello worldh1</div><div class=\"line\">~~~ javascript</div><div class=\"line\">#### 4&lt;%- code %&gt;html</div><div class=\"line\"></div><div class=\"line\">~~~ javascript</div><div class=\"line\">&lt;h1&gt;&lt;%-title %&gt;asd&lt;/h1&gt;          asd</div><div class=\"line\">&lt;p&gt;&lt;%# 'hello world' %&gt;asd&lt;/p&gt;   asd</div></pre></td></tr></table></figure>\n<h4 id=\"5-lt-\"><a href=\"#5-lt-\" class=\"headerlink\" title=\"5&lt;%\"></a>5&lt;%NaN</h4><pre><code>ejs  &lt;%  .. %&gt;\n</code></pre><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">app.set(<span class=\"string\">\"view options\"</span>,&#123;                                                                                  </div><div class=\"line\">   <span class=\"string\">\"open\"</span>:<span class=\"string\">\"&#123;&#123;\"</span>,                                                                                  </div><div class=\"line\">   <span class=\"string\">\"close\"</span>:<span class=\"string\">\"&#125;&#125;\"</span></div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure>\n<h4 id=\"6\"><a href=\"#6\" class=\"headerlink\" title=\"6\"></a>6</h4><ul>\n<li>1)first</li>\n<li>2)last</li>\n<li>3)capitalize</li>\n<li>4)downcase</li>\n<li>5)upcase</li>\n<li>6)sortObject.create(obj).sort()</li>\n<li>7)sort_by:propprop</li>\n<li>8)sizelength</li>\n<li>9)plus:nnNumber</li>\n<li>10)minus:nnNumber</li>\n<li>11)times:nnNumber</li>\n<li>12)divided_by:nnNumber</li>\n<li>13)join:valval</li>\n<li>14)truncate:nn</li>\n<li>15)truncate_words:nnwordword</li>\n<li>16)replace:pattern,substitutionsubstitution</li>\n<li>17)prepend:valval</li>\n<li>18)append:valval</li>\n<li>19)map:propprop</li>\n<li>20)reverse</li>\n<li>21)get:propprop</li>\n<li>22)jsonjson</li>\n</ul>\n<p><strong>&lt;%- include filename %&gt;</strong></p>\n<h4 id=\"ejs\"><a href=\"#ejs\" class=\"headerlink\" title=\"ejs\"></a>ejs</h4><p>ejs </p>\n<ul>\n<li>1.</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;%= title %&gt;</div></pre></td></tr></table></figure>\n<ul>\n<li>2.forjsfor</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;% <span class=\"keyword\">for</span>(<span class=\"keyword\">var</span> i=<span class=\"number\">0</span>; i&lt;headerNavbar.length; i++) &#123;%&gt;</div><div class=\"line\">    &lt;li&gt;&lt;a href=\"/reg\"&gt;&lt;%= headerNavbar[i].name %&gt;&lt;/a&gt;&lt;/li&gt;</div><div class=\"line\">&lt;% &#125; %&gt;</div></pre></td></tr></table></figure>\n<ul>\n<li>3.ifjsif</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"> &lt;% <span class=\"keyword\">if</span>(active==<span class=\"string\">'index'</span>)&#123;%&gt;</div><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span></span>=<span class=\"string\">\"active\"</span></div><div class=\"line\"> &lt;% &#125;%&gt;</div></pre></td></tr></table></figure>\n<h3 id=\"stylus\"><a href=\"#stylus\" class=\"headerlink\" title=\"stylus\"></a>stylus</h3><p><a href=\"https://segmentfault.com/a/1190000002712872\">stylus</a></p>\n<p>stylus<a href=\"http://stylus-lang.com/\">http://stylus-lang.com/</a></p>\n<p>Stylus CSS2010Node.jsNodeCSS Stylus CSS SASS/LESS CSS</p>\n<p>StylusjsEXPRESSIVE, DYNAMIC, ROBUST CSS</p>\n<h4 id=\"Stylus\"><a href=\"#Stylus\" class=\"headerlink\" title=\"Stylus\"></a>Stylus</h4><p>node<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">$ npm install stylus -g</div></pre></td></tr></table></figure></p>\n<h4 id=\"CSS\"><a href=\"#CSS\" class=\"headerlink\" title=\"CSS\"></a>CSS</h4><p>stylusExample/ src  stylus  example.styl  stylusExample <br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">$ stylus --compress src/</div></pre></td></tr></table></figure></p>\n<p>compiled src/example.css compressCSS<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">$ stylus --css css/example.css css/out.styl CSSstyl</div><div class=\"line\">$ stylus help box-shadow CSS</div><div class=\"line\">$ stylus --css test.css .styl</div></pre></td></tr></table></figure></p>\n<p>: <a href=\"http://www.zhangxinxu.com/jq/stylus/\">Stylus</a></p>\n<h3 id=\"CSS3-column\"><a href=\"#CSS3-column\" class=\"headerlink\" title=\"CSS3 column\"></a>CSS3 column</h3><p>CSS3columnsCSS</p>\n<p>Columns<br><a href=\"http://cdn2.jianshu.io/p/87d1862f88c6\">CSS3 column</a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>column</p>\n<p></p>\n<h4 id=\"Bootstrap\"><a href=\"#Bootstrap\" class=\"headerlink\" title=\"Bootstrap:\"></a>Bootstrap:</h4><p><a href=\"http://getbootstrap.com/\">Bootstrap</a>CSSGird system12</p>\n<p>Bootstrap2</p>\n<ul>\n<li><p>1containerrowcolumn</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;div <span class=\"class\"><span class=\"keyword\">class</span></span>=<span class=\"string\">\"container\"</span>&gt;</div><div class=\"line\">    &lt;div class=\"row\"&gt;</div><div class=\"line\">        &lt;div class=\"col-md-6\"&gt;&lt;/div&gt;</div><div class=\"line\">        &lt;div class=\"col-md-6\"&gt;&lt;/div&gt;</div><div class=\"line\">    &lt;/div&gt;</div><div class=\"line\">&lt;<span class=\"regexp\">/div&gt;</span></div></pre></td></tr></table></figure>\n</li>\n<li><p>2</p>\n<p>Bootstrapcolumn.col-xx-yy12xxxssmmdlg</p>\n<p>Bootstrapviewportcolumndisplay: blockcolumnfloatxssmmdlgxsxscolumn</p>\n</li>\n</ul>\n<h4 id=\"Foundation\"><a href=\"#Foundation\" class=\"headerlink\" title=\"Foundation\"></a>Foundation</h4><p>FoundationGridBootstrapFoundation12</p>\n<ul>\n<li><br>BootstrapFoundation<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;div <span class=\"class\"><span class=\"keyword\">class</span></span>=<span class=\"string\">\"row\"</span>&gt;</div><div class=\"line\">    &lt;div class=\"medium-6 columns\"&gt;&lt;/div&gt;</div><div class=\"line\">    &lt;div <span class=\"class\"><span class=\"keyword\">class</span></span>=<span class=\"string\">\"medium-6 columns\"</span>&gt;&lt;/div&gt;</div><div class=\"line\">&lt;<span class=\"regexp\">/div&gt;</span></div></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>Foundation.row.columns.column2.medium-6FoundationsmallmediumlargesmallBootstrapxs</p>\n<p>FoundationcontainerrowcolumnBootstraprowcontainercolumn0.9375remcolumnrowcolumn</p>\n<p>BootstrapFoundationempxBootstrap</p>\n<h4 id=\"Block-Grid\"><a href=\"#Block-Grid\" class=\"headerlink\" title=\"Block Grid\"></a>Block Grid</h4><p>FoundationBlock Grid</p>\n<blockquote>\n<p><a href=\"http://acgtofe.com/posts/2015/07/a-story-of-grid\">css</a></p>\n</blockquote>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/12/04/hexo-learning0/\">http://agehua.github.io/2016/12/04/hexo-learning0/</a></p>"},{"layout":"post","title":"ThreadLocalSimpleDateFormat","keywords":"ThreadLocal","banner":"http://obxk8w81b.bkt.clouddn.com/A%20Wind-Beaten%20Tree.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/A%20Wind-Beaten%20Tree.jpg","toc":true,"_content":"\n### \n\n[ThreadLocalHandlerThreadLopper](https://agehua.github.io/2016/09/05/ThreadLocal-HandlerThread-Lopper/)ThreadLocalSimpleDateFormatThreadLocalThreadLocal\n\n\n\njavaThreadLocalSimpleDateFormat\nhttp://blog.csdn.net/u012706811/article/details/53231598\n\nSimpleDateFormat\nhttp://www.cnblogs.com/zemliu/archive/2013/08/29/3290585.html\n\n\n### \nThreadThreadLocal.ThreadLocalMap threadLocals\n\nmapkeyThreadLocalvalue\n\nThreadLocalThreadLocal putThreadLocal getThreadLocalThreadmapkeyThreadmapLocalThreadThreadLocalThread\n\nThreadLocal\n\nThreadLocal\n\n<!--more-->\n\n### \nThreadLocal\n\nstackoverflow\n\n> [When and how should I use a ThreadLocal variable?](http://stackoverflow.com/questions/817856/when-and-how-should-i-use-a-threadlocal-variable)\nOne possible (and common) use is when you have some object that is not thread-safe, but you want to avoid synchronizing access to that object (I'm looking at you, SimpleDateFormat). Instead, give each thread its own instance of the object.\n\n#### SimpleDateFormat\nSimpleDateFormatCalendar\n\nSimpleDateFormatstaticthreadSimpleDateFormatCalendar\n\nSimpleDateFormat.parse():\n\n~~~ Java\nprotected Calendar calendar;\n\nDate parse() {\n\n  calendar.clear(); // calendar\n\n  ... // ,  calendar \n\n  calendar.getTime(); // calendar\n}\n~~~\n\n> calendar.clear()threadparse()\n\n[](http://www.cnblogs.com/zemliu/archive/2013/08/29/3290585.html)\n\n\n#### \n\nstaticSimpleDateFormat\n\nnew SimpleDateFormatSimpleDateFormat\n\nThreadLocalSimpleDateFormat\n\n~~~ Java\nimport java.text.ParseException;\nimport java.text.SimpleDateFormat;\nimport java.util.Date;\nimport java.util.HashMap;\nimport java.util.Map;\n\npublic class DateUtil {\n\n    /**  */\n    private static final Object lockObj = new Object();\n\n    /** SimpleDateFormatMap */\n    private static Map<String, ThreadLocal<SimpleDateFormat>> sdfMap = new HashMap<String, ThreadLocal<SimpleDateFormat>>();\n\n    /**\n     * ThreadLocalSimpleDateFormat,newSimpleDateFormat\n     *\n     * @param pattern\n     * @return\n     */\n    private static SimpleDateFormat getSdf(final String pattern) {\n        ThreadLocal<SimpleDateFormat> tl = sdfMap.get(pattern);\n\n        // sdfMapputsdf\n        if (tl == null) {\n            synchronized (lockObj) {\n                tl = sdfMap.get(pattern);\n                if (tl == null) {\n                    // Mappatternsdfsdfmap\n                    System.out.println(\"put new sdf of pattern \" + pattern + \" to map\");\n\n                    // ,ThreadLocal<SimpleDateFormat>new SimpleDateFormat\n                    tl = new ThreadLocal<SimpleDateFormat>() {\n\n                        @Override\n                        protected SimpleDateFormat initialValue() {\n                            System.out.println(\"thread: \" + Thread.currentThread() + \" init pattern: \" + pattern);\n                            return new SimpleDateFormat(pattern);\n                        }\n                    };\n                    sdfMap.put(pattern, tl);\n                }\n            }\n        }\n\n        return tl.get();\n    }\n\n    /**\n     * ThreadLocal<SimpleDateFormat>SimpleDateFormat,SimpleDateFormat\n     *\n     * @param date\n     * @param pattern\n     * @return\n     */\n    public static String format(Date date, String pattern) {\n        return getSdf(pattern).format(date);\n    }\n\n    public static Date parse(String dateStr, String pattern) throws ParseException {\n        return getSdf(pattern).parse(dateStr);\n    }\n\n}\n~~~\n\n### \nThreadLocal\n\n        http://www.jianshu.com/p/33c5579ef44f (ThreadLocal)\n\nThreadThreadLocal\n\n![ThreadLocal](http://oui2w5whj.bkt.clouddn.com/blogimages/2016/ThreadLocal.png)\n\nThreadThreadLocalMapthreadLocalsThreadLocalMapTThreadLocalEntryThreadLocalMapThreadLocalMapEntry[] table\n\n#### Entry\nEntryWeakReferenceThreadLocalThreadLocalnulltableEntry\n\n~~~ Java\nclass Entry extends WeakReference<ThreadLocal<?>> {\n      Object value;\n      Entry(ThreadLocal<?> k, Object v) {\n           super(k);\n           value = v;\n      }\n}\n~~~\n#### ThreadLocalMap\ntableEntryINITIAL_CAPACITY(16)\n\n- **size**table\n- **threshold**table2/3size >= thresholdtablekeynullsize >= threshold*3/4table\n\n#### ThreadLocal.set()\n\n~~~ Java\n/**\n * ThreadLocal.set()\n */\npublic void set(T value) {\n    Thread t = Thread.currentThread();\n    ThreadLocalMap map = getMap(t);\n    if (map != null)\n        map.set(this, value);\n    else\n        createMap(t, value);\n}\n\nThreadLocalMap getMap(Thread t) {\n    return t.threadLocals;\n}\n~~~\n\n\n- 1.ThreadThreadLocalMap\n- 2.ThreadLocalvalueEntry\n\n\n#### ThreadLocal.get() \n~~~ Java\npublic T get() {\n    Thread t = Thread.currentThread();\n    ThreadLocalMap map = getMap(t);\n    if (map != null) {\n        ThreadLocalMap.Entry e = map.getEntry(this);\n        if (e != null) {\n            @SuppressWarnings(\"unchecked\")\n            T result = (T)e.value;\n            return result;\n        }\n    }\n    return setInitialValue();\n}\n\nprivate T setInitialValue() {\n        T value = initialValue();\n        Thread t = Thread.currentThread();\n        ThreadLocalMap map = getMap(t);\n        if (map != null)\n            map.set(this, value);\n        else\n            createMap(t, value);\n        return value;\n}\n\nThreadLocalMap getMap(Thread t) {\n    return t.threadLocals;\n}\n~~~\n\n\n> ThreadLocal.get()ThreadLocalMapnull**initialValue()**\nThreadLocalSimpleDateFormat\n\n\nSimpleDateFormat\n\n~~~ Java\n//ThreadLocal.get()\npublic T get() {\n    Thread t = Thread.currentThread();//\n    ThreadLocalMap map = getMap(t);\n    //map\n    if (map != null) {\n        ThreadLocalMap.Entry e = map.getEntry(this);\n        if (e != null) {\n            @SuppressWarnings(\"unchecked\")\n            T result = (T)e.value;\n            return result;\n        }\n    }\n    return setInitialValue();\n}\n\nThreadLocalMap getMap(Thread t) {\n    //ThreadthreadLocals\n    return t.threadLocals;\n}\n~~~\n\nThreadLocalMap.getEntry()Entrytable\n\n#### Entrytable\n\n~~~ Java\n/**\n * static class ThreadLocalMap.set()\n */\nprivate void set(ThreadLocal<?> key, Object value) {\n    Entry[] tab = table;\n    int len = tab.length;\n    int i = key.threadLocalHashCode & (len-1);\n\n    for (Entry e = tab[i]; e != null; e = tab[i = nextIndex(i, len)]) {\n        ThreadLocal<?> k = e.get();\n        if (k == key) {\n            e.value = value;\n            return;\n        }\n        if (k == null) {\n            replaceStaleEntry(key, value, i);\n            return;\n        }\n    }\n\n    tab[i] = new Entry(key, value);\n    int sz = ++size;\n    if (!cleanSomeSlots(i, sz) && sz >= threshold)\n        rehash();\n}\n~~~\n- 1.ThreadLocalnextHashCodehash\n\nthreadLocalHashCodenextHashCode()\n~~~ Java\n/**\n * key.threadLocalHashCode\n * ThreadLocal \n */\nprivate final int threadLocalHashCode = nextHashCode();\n~~~\n\n- 2. key.threadLocalHashCode & (len -1) tableitableif\n- 3.f != nullfk\n  - kThreadLocalvalue\n  - knullfstale()replaceStaleEntrytableentrynull\n  - nextIndexf3\n- 4.f == nullEntrytablei\n- 5.cleanSomeSlotstable\n\n~~~ Java\n/**\n * ThreadLocal \n */\nprivate static AtomicInteger nextHashCode = new AtomicInteger();\nprivate static int nextHashCode() {    \n return nextHashCode.getAndAdd(HASH_INCREMENT);\n}\n~~~\n  nextHashCodeThreadLocalhashHASH_INCREMENT\n\n#### Entrytable\n\ngetEntry()\n~~~ Java\n/**\n * ThreadLocalMapgetEntry()\n */\nprivate Entry getEntry(ThreadLocal<?> key) {\n    int i = key.threadLocalHashCode & (table.length - 1);\n    Entry e = table[i];\n    if (e != null && e.get() == key)\n        return e;\n    else\n        return getEntryAfterMiss(key, i, e);\n}\n~~~\n- 1.key.threadLocalHashCode & (len -1)tableitableig\n- 2.gnullThreadLocalEntry\n\n**ThreadLocal.get()**\n~~~ Java\n//ThreadLocal.get()\npublic T get() {\n    Thread t = Thread.currentThread();//\n    ThreadLocalMap map = getMap(t);\n    //map\n    if (map != null) {\n        //ThreadLocalEntrynull\n        ThreadLocalMap.Entry e = map.getEntry(this);\n        if (e != null) {\n            @SuppressWarnings(\"unchecked\")\n            T result = (T)e.value;\n            return result;\n        }\n    }\n    return setInitialValue();\n}\n~~~\n\n> ThreadLocalMapEntrynulltableresultsetInitialValue()SimpleDateFormat\n\nThreadLocalSimpleDateFormat\n\n\n    p.s. ThreadLocal\n\n\n\n\n\n#### threadLocals\n\n- threadLocalsnullThreadLocalMap.getEntryentrykeytable\n- threadLocalsnullsetInitialValue\n~~~ Java\nprivate Entry getEntryAfterMiss(ThreadLocal<?> key, int i, Entry e) {\n Entry[] tab = table;\n int len = tab.length;\n while (e != null) {\n     ThreadLocal<?> k = e.get();\n     if (k == key)\n         return e;\n     if (k == null)\n         expungeStaleEntry(i);\n     else\n         i = nextIndex(i, len);\n     e = tab[i];\n }\n return null;\n}\n~~~\n\n#### table\ntablethreshold3/4\n\n~~~ Java\n/**\n * ThreadLocalMap\n */\nprivate void resize() {\n    Entry[] oldTab = table;\n    int oldLen = oldTab.length;\n    int newLen = oldLen * 2;\n    Entry[] newTab = new Entry[newLen];\n    int count = 0;\n\n    for (int j = 0; j < oldLen; ++j) {\n        Entry e = oldTab[j];\n        if (e != null) {\n            ThreadLocal<?> k = e.get();\n            if (k == null) {\n                e.value = null; // Help the GC\n            } else {\n                int h = k.threadLocalHashCode & (newLen - 1);\n                while (newTab[h] != null)\n                    h = nextIndex(h, newLen);\n                newTab[h] = e;\n                count++;\n            }\n        }\n    }\n\n    setThreshold(newLen);\n    size = count;\n    table = newTab;\n}\n~~~\n- newTab2\n- tablenewTabtableenewTabii\n\n      :\n       \n","source":"_posts/2016-12-11-ThreadLocal-usage.md","raw":"---\nlayout: post\ntitle:  ThreadLocalSimpleDateFormat\ncategory: accumulation\ntags:\n  - Java\n  - ThreadLocal\nkeywords: ThreadLocal\nbanner: http://obxk8w81b.bkt.clouddn.com/A%20Wind-Beaten%20Tree.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/A%20Wind-Beaten%20Tree.jpg\ntoc: true\n---\n\n### \n\n[ThreadLocalHandlerThreadLopper](https://agehua.github.io/2016/09/05/ThreadLocal-HandlerThread-Lopper/)ThreadLocalSimpleDateFormatThreadLocalThreadLocal\n\n\n\njavaThreadLocalSimpleDateFormat\nhttp://blog.csdn.net/u012706811/article/details/53231598\n\nSimpleDateFormat\nhttp://www.cnblogs.com/zemliu/archive/2013/08/29/3290585.html\n\n\n### \nThreadThreadLocal.ThreadLocalMap threadLocals\n\nmapkeyThreadLocalvalue\n\nThreadLocalThreadLocal putThreadLocal getThreadLocalThreadmapkeyThreadmapLocalThreadThreadLocalThread\n\nThreadLocal\n\nThreadLocal\n\n<!--more-->\n\n### \nThreadLocal\n\nstackoverflow\n\n> [When and how should I use a ThreadLocal variable?](http://stackoverflow.com/questions/817856/when-and-how-should-i-use-a-threadlocal-variable)\nOne possible (and common) use is when you have some object that is not thread-safe, but you want to avoid synchronizing access to that object (I'm looking at you, SimpleDateFormat). Instead, give each thread its own instance of the object.\n\n#### SimpleDateFormat\nSimpleDateFormatCalendar\n\nSimpleDateFormatstaticthreadSimpleDateFormatCalendar\n\nSimpleDateFormat.parse():\n\n~~~ Java\nprotected Calendar calendar;\n\nDate parse() {\n\n  calendar.clear(); // calendar\n\n  ... // ,  calendar \n\n  calendar.getTime(); // calendar\n}\n~~~\n\n> calendar.clear()threadparse()\n\n[](http://www.cnblogs.com/zemliu/archive/2013/08/29/3290585.html)\n\n\n#### \n\nstaticSimpleDateFormat\n\nnew SimpleDateFormatSimpleDateFormat\n\nThreadLocalSimpleDateFormat\n\n~~~ Java\nimport java.text.ParseException;\nimport java.text.SimpleDateFormat;\nimport java.util.Date;\nimport java.util.HashMap;\nimport java.util.Map;\n\npublic class DateUtil {\n\n    /**  */\n    private static final Object lockObj = new Object();\n\n    /** SimpleDateFormatMap */\n    private static Map<String, ThreadLocal<SimpleDateFormat>> sdfMap = new HashMap<String, ThreadLocal<SimpleDateFormat>>();\n\n    /**\n     * ThreadLocalSimpleDateFormat,newSimpleDateFormat\n     *\n     * @param pattern\n     * @return\n     */\n    private static SimpleDateFormat getSdf(final String pattern) {\n        ThreadLocal<SimpleDateFormat> tl = sdfMap.get(pattern);\n\n        // sdfMapputsdf\n        if (tl == null) {\n            synchronized (lockObj) {\n                tl = sdfMap.get(pattern);\n                if (tl == null) {\n                    // Mappatternsdfsdfmap\n                    System.out.println(\"put new sdf of pattern \" + pattern + \" to map\");\n\n                    // ,ThreadLocal<SimpleDateFormat>new SimpleDateFormat\n                    tl = new ThreadLocal<SimpleDateFormat>() {\n\n                        @Override\n                        protected SimpleDateFormat initialValue() {\n                            System.out.println(\"thread: \" + Thread.currentThread() + \" init pattern: \" + pattern);\n                            return new SimpleDateFormat(pattern);\n                        }\n                    };\n                    sdfMap.put(pattern, tl);\n                }\n            }\n        }\n\n        return tl.get();\n    }\n\n    /**\n     * ThreadLocal<SimpleDateFormat>SimpleDateFormat,SimpleDateFormat\n     *\n     * @param date\n     * @param pattern\n     * @return\n     */\n    public static String format(Date date, String pattern) {\n        return getSdf(pattern).format(date);\n    }\n\n    public static Date parse(String dateStr, String pattern) throws ParseException {\n        return getSdf(pattern).parse(dateStr);\n    }\n\n}\n~~~\n\n### \nThreadLocal\n\n        http://www.jianshu.com/p/33c5579ef44f (ThreadLocal)\n\nThreadThreadLocal\n\n![ThreadLocal](http://oui2w5whj.bkt.clouddn.com/blogimages/2016/ThreadLocal.png)\n\nThreadThreadLocalMapthreadLocalsThreadLocalMapTThreadLocalEntryThreadLocalMapThreadLocalMapEntry[] table\n\n#### Entry\nEntryWeakReferenceThreadLocalThreadLocalnulltableEntry\n\n~~~ Java\nclass Entry extends WeakReference<ThreadLocal<?>> {\n      Object value;\n      Entry(ThreadLocal<?> k, Object v) {\n           super(k);\n           value = v;\n      }\n}\n~~~\n#### ThreadLocalMap\ntableEntryINITIAL_CAPACITY(16)\n\n- **size**table\n- **threshold**table2/3size >= thresholdtablekeynullsize >= threshold*3/4table\n\n#### ThreadLocal.set()\n\n~~~ Java\n/**\n * ThreadLocal.set()\n */\npublic void set(T value) {\n    Thread t = Thread.currentThread();\n    ThreadLocalMap map = getMap(t);\n    if (map != null)\n        map.set(this, value);\n    else\n        createMap(t, value);\n}\n\nThreadLocalMap getMap(Thread t) {\n    return t.threadLocals;\n}\n~~~\n\n\n- 1.ThreadThreadLocalMap\n- 2.ThreadLocalvalueEntry\n\n\n#### ThreadLocal.get() \n~~~ Java\npublic T get() {\n    Thread t = Thread.currentThread();\n    ThreadLocalMap map = getMap(t);\n    if (map != null) {\n        ThreadLocalMap.Entry e = map.getEntry(this);\n        if (e != null) {\n            @SuppressWarnings(\"unchecked\")\n            T result = (T)e.value;\n            return result;\n        }\n    }\n    return setInitialValue();\n}\n\nprivate T setInitialValue() {\n        T value = initialValue();\n        Thread t = Thread.currentThread();\n        ThreadLocalMap map = getMap(t);\n        if (map != null)\n            map.set(this, value);\n        else\n            createMap(t, value);\n        return value;\n}\n\nThreadLocalMap getMap(Thread t) {\n    return t.threadLocals;\n}\n~~~\n\n\n> ThreadLocal.get()ThreadLocalMapnull**initialValue()**\nThreadLocalSimpleDateFormat\n\n\nSimpleDateFormat\n\n~~~ Java\n//ThreadLocal.get()\npublic T get() {\n    Thread t = Thread.currentThread();//\n    ThreadLocalMap map = getMap(t);\n    //map\n    if (map != null) {\n        ThreadLocalMap.Entry e = map.getEntry(this);\n        if (e != null) {\n            @SuppressWarnings(\"unchecked\")\n            T result = (T)e.value;\n            return result;\n        }\n    }\n    return setInitialValue();\n}\n\nThreadLocalMap getMap(Thread t) {\n    //ThreadthreadLocals\n    return t.threadLocals;\n}\n~~~\n\nThreadLocalMap.getEntry()Entrytable\n\n#### Entrytable\n\n~~~ Java\n/**\n * static class ThreadLocalMap.set()\n */\nprivate void set(ThreadLocal<?> key, Object value) {\n    Entry[] tab = table;\n    int len = tab.length;\n    int i = key.threadLocalHashCode & (len-1);\n\n    for (Entry e = tab[i]; e != null; e = tab[i = nextIndex(i, len)]) {\n        ThreadLocal<?> k = e.get();\n        if (k == key) {\n            e.value = value;\n            return;\n        }\n        if (k == null) {\n            replaceStaleEntry(key, value, i);\n            return;\n        }\n    }\n\n    tab[i] = new Entry(key, value);\n    int sz = ++size;\n    if (!cleanSomeSlots(i, sz) && sz >= threshold)\n        rehash();\n}\n~~~\n- 1.ThreadLocalnextHashCodehash\n\nthreadLocalHashCodenextHashCode()\n~~~ Java\n/**\n * key.threadLocalHashCode\n * ThreadLocal \n */\nprivate final int threadLocalHashCode = nextHashCode();\n~~~\n\n- 2. key.threadLocalHashCode & (len -1) tableitableif\n- 3.f != nullfk\n  - kThreadLocalvalue\n  - knullfstale()replaceStaleEntrytableentrynull\n  - nextIndexf3\n- 4.f == nullEntrytablei\n- 5.cleanSomeSlotstable\n\n~~~ Java\n/**\n * ThreadLocal \n */\nprivate static AtomicInteger nextHashCode = new AtomicInteger();\nprivate static int nextHashCode() {    \n return nextHashCode.getAndAdd(HASH_INCREMENT);\n}\n~~~\n  nextHashCodeThreadLocalhashHASH_INCREMENT\n\n#### Entrytable\n\ngetEntry()\n~~~ Java\n/**\n * ThreadLocalMapgetEntry()\n */\nprivate Entry getEntry(ThreadLocal<?> key) {\n    int i = key.threadLocalHashCode & (table.length - 1);\n    Entry e = table[i];\n    if (e != null && e.get() == key)\n        return e;\n    else\n        return getEntryAfterMiss(key, i, e);\n}\n~~~\n- 1.key.threadLocalHashCode & (len -1)tableitableig\n- 2.gnullThreadLocalEntry\n\n**ThreadLocal.get()**\n~~~ Java\n//ThreadLocal.get()\npublic T get() {\n    Thread t = Thread.currentThread();//\n    ThreadLocalMap map = getMap(t);\n    //map\n    if (map != null) {\n        //ThreadLocalEntrynull\n        ThreadLocalMap.Entry e = map.getEntry(this);\n        if (e != null) {\n            @SuppressWarnings(\"unchecked\")\n            T result = (T)e.value;\n            return result;\n        }\n    }\n    return setInitialValue();\n}\n~~~\n\n> ThreadLocalMapEntrynulltableresultsetInitialValue()SimpleDateFormat\n\nThreadLocalSimpleDateFormat\n\n\n    p.s. ThreadLocal\n\n\n\n\n\n#### threadLocals\n\n- threadLocalsnullThreadLocalMap.getEntryentrykeytable\n- threadLocalsnullsetInitialValue\n~~~ Java\nprivate Entry getEntryAfterMiss(ThreadLocal<?> key, int i, Entry e) {\n Entry[] tab = table;\n int len = tab.length;\n while (e != null) {\n     ThreadLocal<?> k = e.get();\n     if (k == key)\n         return e;\n     if (k == null)\n         expungeStaleEntry(i);\n     else\n         i = nextIndex(i, len);\n     e = tab[i];\n }\n return null;\n}\n~~~\n\n#### table\ntablethreshold3/4\n\n~~~ Java\n/**\n * ThreadLocalMap\n */\nprivate void resize() {\n    Entry[] oldTab = table;\n    int oldLen = oldTab.length;\n    int newLen = oldLen * 2;\n    Entry[] newTab = new Entry[newLen];\n    int count = 0;\n\n    for (int j = 0; j < oldLen; ++j) {\n        Entry e = oldTab[j];\n        if (e != null) {\n            ThreadLocal<?> k = e.get();\n            if (k == null) {\n                e.value = null; // Help the GC\n            } else {\n                int h = k.threadLocalHashCode & (newLen - 1);\n                while (newTab[h] != null)\n                    h = nextIndex(h, newLen);\n                newTab[h] = e;\n                count++;\n            }\n        }\n    }\n\n    setThreshold(newLen);\n    size = count;\n    table = newTab;\n}\n~~~\n- newTab2\n- tablenewTabtableenewTabii\n\n      :\n       \n","slug":"ThreadLocal-usage","published":1,"date":"2016-12-10T16:00:00.000Z","updated":"2017-11-23T07:12:02.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ebzt002fd6yknh6ho6jc","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"https://agehua.github.io/2016/09/05/ThreadLocal-HandlerThread-Lopper/\">ThreadLocalHandlerThreadLopper</a>ThreadLocalSimpleDateFormatThreadLocalThreadLocal</p>\n<p></p>\n<p>javaThreadLocalSimpleDateFormat<br><a href=\"http://blog.csdn.net/u012706811/article/details/53231598\" target=\"_blank\" rel=\"external\">http://blog.csdn.net/u012706811/article/details/53231598</a></p>\n<p>SimpleDateFormat<br><a href=\"http://www.cnblogs.com/zemliu/archive/2013/08/29/3290585.html\" target=\"_blank\" rel=\"external\">http://www.cnblogs.com/zemliu/archive/2013/08/29/3290585.html</a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>ThreadThreadLocal.ThreadLocalMap threadLocals</p>\n<p>mapkeyThreadLocalvalue</p>\n<p>ThreadLocalThreadLocal putThreadLocal getThreadLocalThreadmapkeyThreadmapLocalThreadThreadLocalThread</p>\n<p>ThreadLocal</p>\n<p>ThreadLocal</p>\n<a id=\"more\"></a>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>ThreadLocal</p>\n<p>stackoverflow</p>\n<blockquote>\n<p><a href=\"http://stackoverflow.com/questions/817856/when-and-how-should-i-use-a-threadlocal-variable\" target=\"_blank\" rel=\"external\">When and how should I use a ThreadLocal variable?</a><br>One possible (and common) use is when you have some object that is not thread-safe, but you want to avoid synchronizing access to that object (Im looking at you, SimpleDateFormat). Instead, give each thread its own instance of the object.</p>\n</blockquote>\n<h4 id=\"SimpleDateFormat\"><a href=\"#SimpleDateFormat\" class=\"headerlink\" title=\"SimpleDateFormat\"></a>SimpleDateFormat</h4><p>SimpleDateFormatCalendar</p>\n<p>SimpleDateFormatstaticthreadSimpleDateFormatCalendar</p>\n<p>SimpleDateFormat.parse():</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">protected</span> Calendar calendar;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\">Date <span class=\"title\">parse</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">  calendar.clear(); <span class=\"comment\">// calendar</span></div><div class=\"line\"></div><div class=\"line\">  ... <span class=\"comment\">// ,  calendar </span></div><div class=\"line\"></div><div class=\"line\">  calendar.getTime(); <span class=\"comment\">// calendar</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<blockquote>\n<p>calendar.clear()threadparse()</p>\n</blockquote>\n<p><a href=\"http://www.cnblogs.com/zemliu/archive/2013/08/29/3290585.html\" target=\"_blank\" rel=\"external\"></a></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>staticSimpleDateFormat</p>\n<p>new SimpleDateFormatSimpleDateFormat</p>\n<p>ThreadLocalSimpleDateFormat</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> java.text.ParseException;</div><div class=\"line\"><span class=\"keyword\">import</span> java.text.SimpleDateFormat;</div><div class=\"line\"><span class=\"keyword\">import</span> java.util.Date;</div><div class=\"line\"><span class=\"keyword\">import</span> java.util.HashMap;</div><div class=\"line\"><span class=\"keyword\">import</span> java.util.Map;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DateUtil</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">/**  */</span></div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Object lockObj = <span class=\"keyword\">new</span> Object();</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">/** SimpleDateFormatMap */</span></div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Map&lt;String, ThreadLocal&lt;SimpleDateFormat&gt;&gt; sdfMap = <span class=\"keyword\">new</span> HashMap&lt;String, ThreadLocal&lt;SimpleDateFormat&gt;&gt;();</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">/**</span></div><div class=\"line\">     * ThreadLocalSimpleDateFormat,newSimpleDateFormat</div><div class=\"line\">     *</div><div class=\"line\">     * <span class=\"doctag\">@param</span> pattern</div><div class=\"line\">     * <span class=\"doctag\">@return</span></div><div class=\"line\">     */</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> SimpleDateFormat <span class=\"title\">getSdf</span><span class=\"params\">(<span class=\"keyword\">final</span> String pattern)</span> </span>&#123;</div><div class=\"line\">        ThreadLocal&lt;SimpleDateFormat&gt; tl = sdfMap.get(pattern);</div><div class=\"line\"></div><div class=\"line\">        <span class=\"comment\">// sdfMapputsdf</span></div><div class=\"line\">        <span class=\"keyword\">if</span> (tl == <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">synchronized</span> (lockObj) &#123;</div><div class=\"line\">                tl = sdfMap.get(pattern);</div><div class=\"line\">                <span class=\"keyword\">if</span> (tl == <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">                    <span class=\"comment\">// Mappatternsdfsdfmap</span></div><div class=\"line\">                    System.out.println(<span class=\"string\">\"put new sdf of pattern \"</span> + pattern + <span class=\"string\">\" to map\"</span>);</div><div class=\"line\"></div><div class=\"line\">                    <span class=\"comment\">// ,ThreadLocal&lt;SimpleDateFormat&gt;new SimpleDateFormat</span></div><div class=\"line\">                    tl = <span class=\"keyword\">new</span> ThreadLocal&lt;SimpleDateFormat&gt;() &#123;</div><div class=\"line\"></div><div class=\"line\">                        <span class=\"meta\">@Override</span></div><div class=\"line\">                        <span class=\"function\"><span class=\"keyword\">protected</span> SimpleDateFormat <span class=\"title\">initialValue</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">                            System.out.println(<span class=\"string\">\"thread: \"</span> + Thread.currentThread() + <span class=\"string\">\" init pattern: \"</span> + pattern);</div><div class=\"line\">                            <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> SimpleDateFormat(pattern);</div><div class=\"line\">                        &#125;</div><div class=\"line\">                    &#125;;</div><div class=\"line\">                    sdfMap.put(pattern, tl);</div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">return</span> tl.get();</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">/**</span></div><div class=\"line\">     * ThreadLocal&lt;SimpleDateFormat&gt;SimpleDateFormat,SimpleDateFormat</div><div class=\"line\">     *</div><div class=\"line\">     * <span class=\"doctag\">@param</span> date</div><div class=\"line\">     * <span class=\"doctag\">@param</span> pattern</div><div class=\"line\">     * <span class=\"doctag\">@return</span></div><div class=\"line\">     */</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">format</span><span class=\"params\">(Date date, String pattern)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> getSdf(pattern).format(date);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Date <span class=\"title\">parse</span><span class=\"params\">(String dateStr, String pattern)</span> <span class=\"keyword\">throws</span> ParseException </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> getSdf(pattern).parse(dateStr);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>ThreadLocal</p>\n<pre><code>http://www.jianshu.com/p/33c5579ef44f (ThreadLocal)\n</code></pre><p>ThreadThreadLocal</p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2016/ThreadLocal.png\" alt=\"ThreadLocal\"></p>\n<p>ThreadThreadLocalMapthreadLocalsThreadLocalMapTThreadLocalEntryThreadLocalMapThreadLocalMapEntry[] table</p>\n<h4 id=\"Entry\"><a href=\"#Entry\" class=\"headerlink\" title=\"Entry\"></a>Entry</h4><p>EntryWeakReferenceThreadLocalThreadLocalnulltableEntry</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Entry</span> <span class=\"keyword\">extends</span> <span class=\"title\">WeakReference</span>&lt;<span class=\"title\">ThreadLocal</span>&lt;?&gt;&gt; </span>&#123;</div><div class=\"line\">      Object value;</div><div class=\"line\">      Entry(ThreadLocal&lt;?&gt; k, Object v) &#123;</div><div class=\"line\">           <span class=\"keyword\">super</span>(k);</div><div class=\"line\">           value = v;</div><div class=\"line\">      &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h4 id=\"ThreadLocalMap\"><a href=\"#ThreadLocalMap\" class=\"headerlink\" title=\"ThreadLocalMap\"></a>ThreadLocalMap</h4><p>tableEntryINITIAL_CAPACITY(16)</p>\n<ul>\n<li><strong>size</strong>table</li>\n<li><strong>threshold</strong>table2/3size &gt;= thresholdtablekeynullsize &gt;= threshold*3/4table</li>\n</ul>\n<h4 id=\"ThreadLocal-set-\"><a href=\"#ThreadLocal-set-\" class=\"headerlink\" title=\"ThreadLocal.set()\"></a>ThreadLocal.set()</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * ThreadLocal.set()</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">set</span><span class=\"params\">(T value)</span> </span>&#123;</div><div class=\"line\">    Thread t = Thread.currentThread();</div><div class=\"line\">    ThreadLocalMap map = getMap(t);</div><div class=\"line\">    <span class=\"keyword\">if</span> (map != <span class=\"keyword\">null</span>)</div><div class=\"line\">        map.set(<span class=\"keyword\">this</span>, value);</div><div class=\"line\">    <span class=\"keyword\">else</span></div><div class=\"line\">        createMap(t, value);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\">ThreadLocalMap <span class=\"title\">getMap</span><span class=\"params\">(Thread t)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> t.threadLocals;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li>1.ThreadThreadLocalMap</li>\n<li>2.ThreadLocalvalueEntry</li>\n</ul>\n<h4 id=\"ThreadLocal-get-\"><a href=\"#ThreadLocal-get-\" class=\"headerlink\" title=\"ThreadLocal.get() \"></a>ThreadLocal.get() </h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> T <span class=\"title\">get</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    Thread t = Thread.currentThread();</div><div class=\"line\">    ThreadLocalMap map = getMap(t);</div><div class=\"line\">    <span class=\"keyword\">if</span> (map != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">        ThreadLocalMap.Entry e = map.getEntry(<span class=\"keyword\">this</span>);</div><div class=\"line\">        <span class=\"keyword\">if</span> (e != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            <span class=\"meta\">@SuppressWarnings</span>(<span class=\"string\">\"unchecked\"</span>)</div><div class=\"line\">            T result = (T)e.value;</div><div class=\"line\">            <span class=\"keyword\">return</span> result;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> setInitialValue();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> T <span class=\"title\">setInitialValue</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        T value = initialValue();</div><div class=\"line\">        Thread t = Thread.currentThread();</div><div class=\"line\">        ThreadLocalMap map = getMap(t);</div><div class=\"line\">        <span class=\"keyword\">if</span> (map != <span class=\"keyword\">null</span>)</div><div class=\"line\">            map.set(<span class=\"keyword\">this</span>, value);</div><div class=\"line\">        <span class=\"keyword\">else</span></div><div class=\"line\">            createMap(t, value);</div><div class=\"line\">        <span class=\"keyword\">return</span> value;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\">ThreadLocalMap <span class=\"title\">getMap</span><span class=\"params\">(Thread t)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> t.threadLocals;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p></p>\n<blockquote>\n<p>ThreadLocal.get()ThreadLocalMapnull<strong>initialValue()</strong><br>ThreadLocalSimpleDateFormat</p>\n</blockquote>\n<p>SimpleDateFormat</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//ThreadLocal.get()</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> T <span class=\"title\">get</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    Thread t = Thread.currentThread();<span class=\"comment\">//</span></div><div class=\"line\">    ThreadLocalMap map = getMap(t);</div><div class=\"line\">    <span class=\"comment\">//map</span></div><div class=\"line\">    <span class=\"keyword\">if</span> (map != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">        ThreadLocalMap.Entry e = map.getEntry(<span class=\"keyword\">this</span>);</div><div class=\"line\">        <span class=\"keyword\">if</span> (e != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            <span class=\"meta\">@SuppressWarnings</span>(<span class=\"string\">\"unchecked\"</span>)</div><div class=\"line\">            T result = (T)e.value;</div><div class=\"line\">            <span class=\"keyword\">return</span> result;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> setInitialValue();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\">ThreadLocalMap <span class=\"title\">getMap</span><span class=\"params\">(Thread t)</span> </span>&#123;</div><div class=\"line\">    <span class=\"comment\">//ThreadthreadLocals</span></div><div class=\"line\">    <span class=\"keyword\">return</span> t.threadLocals;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>ThreadLocalMap.getEntry()Entrytable</p>\n<h4 id=\"Entrytable\"><a href=\"#Entrytable\" class=\"headerlink\" title=\"Entrytable\"></a>Entrytable</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * static class ThreadLocalMap.set()</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">set</span><span class=\"params\">(ThreadLocal&lt;?&gt; key, Object value)</span> </span>&#123;</div><div class=\"line\">    Entry[] tab = table;</div><div class=\"line\">    <span class=\"keyword\">int</span> len = tab.length;</div><div class=\"line\">    <span class=\"keyword\">int</span> i = key.threadLocalHashCode &amp; (len-<span class=\"number\">1</span>);</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">for</span> (Entry e = tab[i]; e != <span class=\"keyword\">null</span>; e = tab[i = nextIndex(i, len)]) &#123;</div><div class=\"line\">        ThreadLocal&lt;?&gt; k = e.get();</div><div class=\"line\">        <span class=\"keyword\">if</span> (k == key) &#123;</div><div class=\"line\">            e.value = value;</div><div class=\"line\">            <span class=\"keyword\">return</span>;</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">if</span> (k == <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            replaceStaleEntry(key, value, i);</div><div class=\"line\">            <span class=\"keyword\">return</span>;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    tab[i] = <span class=\"keyword\">new</span> Entry(key, value);</div><div class=\"line\">    <span class=\"keyword\">int</span> sz = ++size;</div><div class=\"line\">    <span class=\"keyword\">if</span> (!cleanSomeSlots(i, sz) &amp;&amp; sz &gt;= threshold)</div><div class=\"line\">        rehash();</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<ul>\n<li>1.ThreadLocalnextHashCodehash</li>\n</ul>\n<p>threadLocalHashCodenextHashCode()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * key.threadLocalHashCode</div><div class=\"line\"> * ThreadLocal </div><div class=\"line\"> */</div><div class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> threadLocalHashCode = nextHashCode();</div></pre></td></tr></table></figure></p>\n<ul>\n<li>2. key.threadLocalHashCode &amp; (len -1) tableitableif</li>\n<li>3.f != nullfk<ul>\n<li>kThreadLocalvalue</li>\n<li>knullfstale()replaceStaleEntrytableentrynull</li>\n<li>nextIndexf3</li>\n</ul>\n</li>\n<li>4.f == nullEntrytablei</li>\n<li>5.cleanSomeSlotstable</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * ThreadLocal </div><div class=\"line\"> */</div><div class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> AtomicInteger nextHashCode = <span class=\"keyword\">new</span> AtomicInteger();</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> <span class=\"title\">nextHashCode</span><span class=\"params\">()</span> </span>&#123;    </div><div class=\"line\"> <span class=\"keyword\">return</span> nextHashCode.getAndAdd(HASH_INCREMENT);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>  nextHashCodeThreadLocalhashHASH_INCREMENT</p>\n<h4 id=\"Entrytable\"><a href=\"#Entrytable\" class=\"headerlink\" title=\"Entrytable\"></a>Entrytable</h4><p>getEntry()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * ThreadLocalMapgetEntry()</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> Entry <span class=\"title\">getEntry</span><span class=\"params\">(ThreadLocal&lt;?&gt; key)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">int</span> i = key.threadLocalHashCode &amp; (table.length - <span class=\"number\">1</span>);</div><div class=\"line\">    Entry e = table[i];</div><div class=\"line\">    <span class=\"keyword\">if</span> (e != <span class=\"keyword\">null</span> &amp;&amp; e.get() == key)</div><div class=\"line\">        <span class=\"keyword\">return</span> e;</div><div class=\"line\">    <span class=\"keyword\">else</span></div><div class=\"line\">        <span class=\"keyword\">return</span> getEntryAfterMiss(key, i, e);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<ul>\n<li>1.key.threadLocalHashCode &amp; (len -1)tableitableig</li>\n<li>2.gnullThreadLocalEntry</li>\n</ul>\n<p><strong>ThreadLocal.get()</strong><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//ThreadLocal.get()</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> T <span class=\"title\">get</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    Thread t = Thread.currentThread();<span class=\"comment\">//</span></div><div class=\"line\">    ThreadLocalMap map = getMap(t);</div><div class=\"line\">    <span class=\"comment\">//map</span></div><div class=\"line\">    <span class=\"keyword\">if</span> (map != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">        <span class=\"comment\">//ThreadLocalEntrynull</span></div><div class=\"line\">        ThreadLocalMap.Entry e = map.getEntry(<span class=\"keyword\">this</span>);</div><div class=\"line\">        <span class=\"keyword\">if</span> (e != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            <span class=\"meta\">@SuppressWarnings</span>(<span class=\"string\">\"unchecked\"</span>)</div><div class=\"line\">            T result = (T)e.value;</div><div class=\"line\">            <span class=\"keyword\">return</span> result;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> setInitialValue();</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>ThreadLocalMapEntrynulltableresultsetInitialValue()SimpleDateFormat</p>\n</blockquote>\n<p>ThreadLocalSimpleDateFormat</p>\n<pre><code>p.s. ThreadLocal\n</code></pre><h4 id=\"threadLocals\"><a href=\"#threadLocals\" class=\"headerlink\" title=\"threadLocals\"></a>threadLocals</h4><ul>\n<li>threadLocalsnullThreadLocalMap.getEntryentrykeytable</li>\n<li>threadLocalsnullsetInitialValue<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> Entry <span class=\"title\">getEntryAfterMiss</span><span class=\"params\">(ThreadLocal&lt;?&gt; key, <span class=\"keyword\">int</span> i, Entry e)</span> </span>&#123;</div><div class=\"line\"> Entry[] tab = table;</div><div class=\"line\"> <span class=\"keyword\">int</span> len = tab.length;</div><div class=\"line\"> <span class=\"keyword\">while</span> (e != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">     ThreadLocal&lt;?&gt; k = e.get();</div><div class=\"line\">     <span class=\"keyword\">if</span> (k == key)</div><div class=\"line\">         <span class=\"keyword\">return</span> e;</div><div class=\"line\">     <span class=\"keyword\">if</span> (k == <span class=\"keyword\">null</span>)</div><div class=\"line\">         expungeStaleEntry(i);</div><div class=\"line\">     <span class=\"keyword\">else</span></div><div class=\"line\">         i = nextIndex(i, len);</div><div class=\"line\">     e = tab[i];</div><div class=\"line\"> &#125;</div><div class=\"line\"> <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<h4 id=\"table\"><a href=\"#table\" class=\"headerlink\" title=\"table\"></a>table</h4><p>tablethreshold3/4</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * ThreadLocalMap</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">resize</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    Entry[] oldTab = table;</div><div class=\"line\">    <span class=\"keyword\">int</span> oldLen = oldTab.length;</div><div class=\"line\">    <span class=\"keyword\">int</span> newLen = oldLen * <span class=\"number\">2</span>;</div><div class=\"line\">    Entry[] newTab = <span class=\"keyword\">new</span> Entry[newLen];</div><div class=\"line\">    <span class=\"keyword\">int</span> count = <span class=\"number\">0</span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; oldLen; ++j) &#123;</div><div class=\"line\">        Entry e = oldTab[j];</div><div class=\"line\">        <span class=\"keyword\">if</span> (e != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            ThreadLocal&lt;?&gt; k = e.get();</div><div class=\"line\">            <span class=\"keyword\">if</span> (k == <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">                e.value = <span class=\"keyword\">null</span>; <span class=\"comment\">// Help the GC</span></div><div class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">                <span class=\"keyword\">int</span> h = k.threadLocalHashCode &amp; (newLen - <span class=\"number\">1</span>);</div><div class=\"line\">                <span class=\"keyword\">while</span> (newTab[h] != <span class=\"keyword\">null</span>)</div><div class=\"line\">                    h = nextIndex(h, newLen);</div><div class=\"line\">                newTab[h] = e;</div><div class=\"line\">                count++;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    setThreshold(newLen);</div><div class=\"line\">    size = count;</div><div class=\"line\">    table = newTab;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<ul>\n<li>newTab2</li>\n<li><p>tablenewTabtableenewTabii</p>\n<pre><code>:\n \n</code></pre></li>\n</ul>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/12/11/ThreadLocal-usage/\">http://agehua.github.io/2016/12/11/ThreadLocal-usage/</a></p>\n","readingTime":{"text":"8 min read","minutes":7.035,"time":422100,"words":1407},"excerpt":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"https://agehua.github.io/2016/09/05/ThreadLocal-HandlerThread-Lopper/\">ThreadLocalHandlerThreadLopper</a>ThreadLocalSimpleDateFormatThreadLocalThreadLocal</p>\n<p></p>\n<p>javaThreadLocalSimpleDateFormat<br><a href=\"http://blog.csdn.net/u012706811/article/details/53231598\">http://blog.csdn.net/u012706811/article/details/53231598</a></p>\n<p>SimpleDateFormat<br><a href=\"http://www.cnblogs.com/zemliu/archive/2013/08/29/3290585.html\">http://www.cnblogs.com/zemliu/archive/2013/08/29/3290585.html</a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>ThreadThreadLocal.ThreadLocalMap threadLocals</p>\n<p>mapkeyThreadLocalvalue</p>\n<p>ThreadLocalThreadLocal putThreadLocal getThreadLocalThreadmapkeyThreadmapLocalThreadThreadLocalThread</p>\n<p>ThreadLocal</p>\n<p>ThreadLocal</p>","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>ThreadLocal</p>\n<p>stackoverflow</p>\n<blockquote>\n<p><a href=\"http://stackoverflow.com/questions/817856/when-and-how-should-i-use-a-threadlocal-variable\">When and how should I use a ThreadLocal variable?</a><br>One possible (and common) use is when you have some object that is not thread-safe, but you want to avoid synchronizing access to that object (Im looking at you, SimpleDateFormat). Instead, give each thread its own instance of the object.</p>\n</blockquote>\n<h4 id=\"SimpleDateFormat\"><a href=\"#SimpleDateFormat\" class=\"headerlink\" title=\"SimpleDateFormat\"></a>SimpleDateFormat</h4><p>SimpleDateFormatCalendar</p>\n<p>SimpleDateFormatstaticthreadSimpleDateFormatCalendar</p>\n<p>SimpleDateFormat.parse():</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">protected</span> Calendar calendar;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\">Date <span class=\"title\">parse</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">  calendar.clear(); <span class=\"comment\">// calendar</span></div><div class=\"line\"></div><div class=\"line\">  ... <span class=\"comment\">// ,  calendar </span></div><div class=\"line\"></div><div class=\"line\">  calendar.getTime(); <span class=\"comment\">// calendar</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<blockquote>\n<p>calendar.clear()threadparse()</p>\n</blockquote>\n<p><a href=\"http://www.cnblogs.com/zemliu/archive/2013/08/29/3290585.html\"></a></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>staticSimpleDateFormat</p>\n<p>new SimpleDateFormatSimpleDateFormat</p>\n<p>ThreadLocalSimpleDateFormat</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> java.text.ParseException;</div><div class=\"line\"><span class=\"keyword\">import</span> java.text.SimpleDateFormat;</div><div class=\"line\"><span class=\"keyword\">import</span> java.util.Date;</div><div class=\"line\"><span class=\"keyword\">import</span> java.util.HashMap;</div><div class=\"line\"><span class=\"keyword\">import</span> java.util.Map;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DateUtil</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">/**  */</span></div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Object lockObj = <span class=\"keyword\">new</span> Object();</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">/** SimpleDateFormatMap */</span></div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Map&lt;String, ThreadLocal&lt;SimpleDateFormat&gt;&gt; sdfMap = <span class=\"keyword\">new</span> HashMap&lt;String, ThreadLocal&lt;SimpleDateFormat&gt;&gt;();</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">/**</div><div class=\"line\">     * ThreadLocalSimpleDateFormat,newSimpleDateFormat</div><div class=\"line\">     *</div><div class=\"line\">     * <span class=\"doctag\">@param</span> pattern</div><div class=\"line\">     * <span class=\"doctag\">@return</span></div><div class=\"line\">     */</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> SimpleDateFormat <span class=\"title\">getSdf</span><span class=\"params\">(<span class=\"keyword\">final</span> String pattern)</span> </span>&#123;</div><div class=\"line\">        ThreadLocal&lt;SimpleDateFormat&gt; tl = sdfMap.get(pattern);</div><div class=\"line\"></div><div class=\"line\">        <span class=\"comment\">// sdfMapputsdf</span></div><div class=\"line\">        <span class=\"keyword\">if</span> (tl == <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">synchronized</span> (lockObj) &#123;</div><div class=\"line\">                tl = sdfMap.get(pattern);</div><div class=\"line\">                <span class=\"keyword\">if</span> (tl == <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">                    <span class=\"comment\">// Mappatternsdfsdfmap</span></div><div class=\"line\">                    System.out.println(<span class=\"string\">\"put new sdf of pattern \"</span> + pattern + <span class=\"string\">\" to map\"</span>);</div><div class=\"line\"></div><div class=\"line\">                    <span class=\"comment\">// ,ThreadLocal&lt;SimpleDateFormat&gt;new SimpleDateFormat</span></div><div class=\"line\">                    tl = <span class=\"keyword\">new</span> ThreadLocal&lt;SimpleDateFormat&gt;() &#123;</div><div class=\"line\"></div><div class=\"line\">                        <span class=\"meta\">@Override</span></div><div class=\"line\">                        <span class=\"function\"><span class=\"keyword\">protected</span> SimpleDateFormat <span class=\"title\">initialValue</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">                            System.out.println(<span class=\"string\">\"thread: \"</span> + Thread.currentThread() + <span class=\"string\">\" init pattern: \"</span> + pattern);</div><div class=\"line\">                            <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> SimpleDateFormat(pattern);</div><div class=\"line\">                        &#125;</div><div class=\"line\">                    &#125;;</div><div class=\"line\">                    sdfMap.put(pattern, tl);</div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">return</span> tl.get();</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">/**</div><div class=\"line\">     * ThreadLocal&lt;SimpleDateFormat&gt;SimpleDateFormat,SimpleDateFormat</div><div class=\"line\">     *</div><div class=\"line\">     * <span class=\"doctag\">@param</span> date</div><div class=\"line\">     * <span class=\"doctag\">@param</span> pattern</div><div class=\"line\">     * <span class=\"doctag\">@return</span></div><div class=\"line\">     */</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">format</span><span class=\"params\">(Date date, String pattern)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> getSdf(pattern).format(date);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Date <span class=\"title\">parse</span><span class=\"params\">(String dateStr, String pattern)</span> <span class=\"keyword\">throws</span> ParseException </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> getSdf(pattern).parse(dateStr);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>ThreadLocal</p>\n<pre><code>http://www.jianshu.com/p/33c5579ef44f (ThreadLocal)\n</code></pre><p>ThreadThreadLocal</p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2016/ThreadLocal.png\" alt=\"ThreadLocal\"></p>\n<p>ThreadThreadLocalMapthreadLocalsThreadLocalMapTThreadLocalEntryThreadLocalMapThreadLocalMapEntry[] table</p>\n<h4 id=\"Entry\"><a href=\"#Entry\" class=\"headerlink\" title=\"Entry\"></a>Entry</h4><p>EntryWeakReferenceThreadLocalThreadLocalnulltableEntry</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Entry</span> <span class=\"keyword\">extends</span> <span class=\"title\">WeakReference</span>&lt;<span class=\"title\">ThreadLocal</span>&lt;?&gt;&gt; </span>&#123;</div><div class=\"line\">      Object value;</div><div class=\"line\">      Entry(ThreadLocal&lt;?&gt; k, Object v) &#123;</div><div class=\"line\">           <span class=\"keyword\">super</span>(k);</div><div class=\"line\">           value = v;</div><div class=\"line\">      &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h4 id=\"ThreadLocalMap\"><a href=\"#ThreadLocalMap\" class=\"headerlink\" title=\"ThreadLocalMap\"></a>ThreadLocalMap</h4><p>tableEntryINITIAL_CAPACITY(16)</p>\n<ul>\n<li><strong>size</strong>table</li>\n<li><strong>threshold</strong>table2/3size &gt;= thresholdtablekeynullsize &gt;= threshold*3/4table</li>\n</ul>\n<h4 id=\"ThreadLocal-set-\"><a href=\"#ThreadLocal-set-\" class=\"headerlink\" title=\"ThreadLocal.set()\"></a>ThreadLocal.set()</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</div><div class=\"line\"> * ThreadLocal.set()</div><div class=\"line\"> */</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">set</span><span class=\"params\">(T value)</span> </span>&#123;</div><div class=\"line\">    Thread t = Thread.currentThread();</div><div class=\"line\">    ThreadLocalMap map = getMap(t);</div><div class=\"line\">    <span class=\"keyword\">if</span> (map != <span class=\"keyword\">null</span>)</div><div class=\"line\">        map.set(<span class=\"keyword\">this</span>, value);</div><div class=\"line\">    <span class=\"keyword\">else</span></div><div class=\"line\">        createMap(t, value);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\">ThreadLocalMap <span class=\"title\">getMap</span><span class=\"params\">(Thread t)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> t.threadLocals;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li>1.ThreadThreadLocalMap</li>\n<li>2.ThreadLocalvalueEntry</li>\n</ul>\n<h4 id=\"ThreadLocal-get-\"><a href=\"#ThreadLocal-get-\" class=\"headerlink\" title=\"ThreadLocal.get() \"></a>ThreadLocal.get() </h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> T <span class=\"title\">get</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    Thread t = Thread.currentThread();</div><div class=\"line\">    ThreadLocalMap map = getMap(t);</div><div class=\"line\">    <span class=\"keyword\">if</span> (map != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">        ThreadLocalMap.Entry e = map.getEntry(<span class=\"keyword\">this</span>);</div><div class=\"line\">        <span class=\"keyword\">if</span> (e != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            <span class=\"meta\">@SuppressWarnings</span>(<span class=\"string\">\"unchecked\"</span>)</div><div class=\"line\">            T result = (T)e.value;</div><div class=\"line\">            <span class=\"keyword\">return</span> result;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> setInitialValue();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> T <span class=\"title\">setInitialValue</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        T value = initialValue();</div><div class=\"line\">        Thread t = Thread.currentThread();</div><div class=\"line\">        ThreadLocalMap map = getMap(t);</div><div class=\"line\">        <span class=\"keyword\">if</span> (map != <span class=\"keyword\">null</span>)</div><div class=\"line\">            map.set(<span class=\"keyword\">this</span>, value);</div><div class=\"line\">        <span class=\"keyword\">else</span></div><div class=\"line\">            createMap(t, value);</div><div class=\"line\">        <span class=\"keyword\">return</span> value;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\">ThreadLocalMap <span class=\"title\">getMap</span><span class=\"params\">(Thread t)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> t.threadLocals;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p></p>\n<blockquote>\n<p>ThreadLocal.get()ThreadLocalMapnull<strong>initialValue()</strong><br>ThreadLocalSimpleDateFormat</p>\n</blockquote>\n<p>SimpleDateFormat</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//ThreadLocal.get()</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> T <span class=\"title\">get</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    Thread t = Thread.currentThread();<span class=\"comment\">//</span></div><div class=\"line\">    ThreadLocalMap map = getMap(t);</div><div class=\"line\">    <span class=\"comment\">//map</span></div><div class=\"line\">    <span class=\"keyword\">if</span> (map != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">        ThreadLocalMap.Entry e = map.getEntry(<span class=\"keyword\">this</span>);</div><div class=\"line\">        <span class=\"keyword\">if</span> (e != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            <span class=\"meta\">@SuppressWarnings</span>(<span class=\"string\">\"unchecked\"</span>)</div><div class=\"line\">            T result = (T)e.value;</div><div class=\"line\">            <span class=\"keyword\">return</span> result;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> setInitialValue();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\">ThreadLocalMap <span class=\"title\">getMap</span><span class=\"params\">(Thread t)</span> </span>&#123;</div><div class=\"line\">    <span class=\"comment\">//ThreadthreadLocals</span></div><div class=\"line\">    <span class=\"keyword\">return</span> t.threadLocals;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>ThreadLocalMap.getEntry()Entrytable</p>\n<h4 id=\"Entrytable\"><a href=\"#Entrytable\" class=\"headerlink\" title=\"Entrytable\"></a>Entrytable</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</div><div class=\"line\"> * static class ThreadLocalMap.set()</div><div class=\"line\"> */</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">set</span><span class=\"params\">(ThreadLocal&lt;?&gt; key, Object value)</span> </span>&#123;</div><div class=\"line\">    Entry[] tab = table;</div><div class=\"line\">    <span class=\"keyword\">int</span> len = tab.length;</div><div class=\"line\">    <span class=\"keyword\">int</span> i = key.threadLocalHashCode &amp; (len-<span class=\"number\">1</span>);</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">for</span> (Entry e = tab[i]; e != <span class=\"keyword\">null</span>; e = tab[i = nextIndex(i, len)]) &#123;</div><div class=\"line\">        ThreadLocal&lt;?&gt; k = e.get();</div><div class=\"line\">        <span class=\"keyword\">if</span> (k == key) &#123;</div><div class=\"line\">            e.value = value;</div><div class=\"line\">            <span class=\"keyword\">return</span>;</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">if</span> (k == <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            replaceStaleEntry(key, value, i);</div><div class=\"line\">            <span class=\"keyword\">return</span>;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    tab[i] = <span class=\"keyword\">new</span> Entry(key, value);</div><div class=\"line\">    <span class=\"keyword\">int</span> sz = ++size;</div><div class=\"line\">    <span class=\"keyword\">if</span> (!cleanSomeSlots(i, sz) &amp;&amp; sz &gt;= threshold)</div><div class=\"line\">        rehash();</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<ul>\n<li>1.ThreadLocalnextHashCodehash</li>\n</ul>\n<p>threadLocalHashCodenextHashCode()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</div><div class=\"line\"> * key.threadLocalHashCode</div><div class=\"line\"> * ThreadLocal </div><div class=\"line\"> */</span></div><div class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> threadLocalHashCode = nextHashCode();</div></pre></td></tr></table></figure></p>\n<ul>\n<li>2. key.threadLocalHashCode &amp; (len -1) tableitableif</li>\n<li>3.f != nullfk<ul>\n<li>kThreadLocalvalue</li>\n<li>knullfstale()replaceStaleEntrytableentrynull</li>\n<li>nextIndexf3</li>\n</ul>\n</li>\n<li>4.f == nullEntrytablei</li>\n<li>5.cleanSomeSlotstable</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</div><div class=\"line\"> * ThreadLocal </div><div class=\"line\"> */</span></div><div class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> AtomicInteger nextHashCode = <span class=\"keyword\">new</span> AtomicInteger();</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> <span class=\"title\">nextHashCode</span><span class=\"params\">()</span> </span>&#123;    </div><div class=\"line\"> <span class=\"keyword\">return</span> nextHashCode.getAndAdd(HASH_INCREMENT);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>  nextHashCodeThreadLocalhashHASH_INCREMENT</p>\n<h4 id=\"Entrytable\"><a href=\"#Entrytable\" class=\"headerlink\" title=\"Entrytable\"></a>Entrytable</h4><p>getEntry()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</div><div class=\"line\"> * ThreadLocalMapgetEntry()</div><div class=\"line\"> */</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> Entry <span class=\"title\">getEntry</span><span class=\"params\">(ThreadLocal&lt;?&gt; key)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">int</span> i = key.threadLocalHashCode &amp; (table.length - <span class=\"number\">1</span>);</div><div class=\"line\">    Entry e = table[i];</div><div class=\"line\">    <span class=\"keyword\">if</span> (e != <span class=\"keyword\">null</span> &amp;&amp; e.get() == key)</div><div class=\"line\">        <span class=\"keyword\">return</span> e;</div><div class=\"line\">    <span class=\"keyword\">else</span></div><div class=\"line\">        <span class=\"keyword\">return</span> getEntryAfterMiss(key, i, e);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<ul>\n<li>1.key.threadLocalHashCode &amp; (len -1)tableitableig</li>\n<li>2.gnullThreadLocalEntry</li>\n</ul>\n<p><strong>ThreadLocal.get()</strong><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//ThreadLocal.get()</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> T <span class=\"title\">get</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    Thread t = Thread.currentThread();<span class=\"comment\">//</span></div><div class=\"line\">    ThreadLocalMap map = getMap(t);</div><div class=\"line\">    <span class=\"comment\">//map</span></div><div class=\"line\">    <span class=\"keyword\">if</span> (map != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">        <span class=\"comment\">//ThreadLocalEntrynull</span></div><div class=\"line\">        ThreadLocalMap.Entry e = map.getEntry(<span class=\"keyword\">this</span>);</div><div class=\"line\">        <span class=\"keyword\">if</span> (e != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            <span class=\"meta\">@SuppressWarnings</span>(<span class=\"string\">\"unchecked\"</span>)</div><div class=\"line\">            T result = (T)e.value;</div><div class=\"line\">            <span class=\"keyword\">return</span> result;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> setInitialValue();</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>ThreadLocalMapEntrynulltableresultsetInitialValue()SimpleDateFormat</p>\n</blockquote>\n<p>ThreadLocalSimpleDateFormat</p>\n<pre><code>p.s. ThreadLocal\n</code></pre><h4 id=\"threadLocals\"><a href=\"#threadLocals\" class=\"headerlink\" title=\"threadLocals\"></a>threadLocals</h4><ul>\n<li>threadLocalsnullThreadLocalMap.getEntryentrykeytable</li>\n<li>threadLocalsnullsetInitialValue<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> Entry <span class=\"title\">getEntryAfterMiss</span><span class=\"params\">(ThreadLocal&lt;?&gt; key, <span class=\"keyword\">int</span> i, Entry e)</span> </span>&#123;</div><div class=\"line\"> Entry[] tab = table;</div><div class=\"line\"> <span class=\"keyword\">int</span> len = tab.length;</div><div class=\"line\"> <span class=\"keyword\">while</span> (e != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">     ThreadLocal&lt;?&gt; k = e.get();</div><div class=\"line\">     <span class=\"keyword\">if</span> (k == key)</div><div class=\"line\">         <span class=\"keyword\">return</span> e;</div><div class=\"line\">     <span class=\"keyword\">if</span> (k == <span class=\"keyword\">null</span>)</div><div class=\"line\">         expungeStaleEntry(i);</div><div class=\"line\">     <span class=\"keyword\">else</span></div><div class=\"line\">         i = nextIndex(i, len);</div><div class=\"line\">     e = tab[i];</div><div class=\"line\"> &#125;</div><div class=\"line\"> <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<h4 id=\"table\"><a href=\"#table\" class=\"headerlink\" title=\"table\"></a>table</h4><p>tablethreshold3/4</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</div><div class=\"line\"> * ThreadLocalMap</div><div class=\"line\"> */</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">resize</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    Entry[] oldTab = table;</div><div class=\"line\">    <span class=\"keyword\">int</span> oldLen = oldTab.length;</div><div class=\"line\">    <span class=\"keyword\">int</span> newLen = oldLen * <span class=\"number\">2</span>;</div><div class=\"line\">    Entry[] newTab = <span class=\"keyword\">new</span> Entry[newLen];</div><div class=\"line\">    <span class=\"keyword\">int</span> count = <span class=\"number\">0</span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; oldLen; ++j) &#123;</div><div class=\"line\">        Entry e = oldTab[j];</div><div class=\"line\">        <span class=\"keyword\">if</span> (e != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            ThreadLocal&lt;?&gt; k = e.get();</div><div class=\"line\">            <span class=\"keyword\">if</span> (k == <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">                e.value = <span class=\"keyword\">null</span>; <span class=\"comment\">// Help the GC</span></div><div class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">                <span class=\"keyword\">int</span> h = k.threadLocalHashCode &amp; (newLen - <span class=\"number\">1</span>);</div><div class=\"line\">                <span class=\"keyword\">while</span> (newTab[h] != <span class=\"keyword\">null</span>)</div><div class=\"line\">                    h = nextIndex(h, newLen);</div><div class=\"line\">                newTab[h] = e;</div><div class=\"line\">                count++;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    setThreshold(newLen);</div><div class=\"line\">    size = count;</div><div class=\"line\">    table = newTab;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<ul>\n<li>newTab2</li>\n<li><p>tablenewTabtableenewTabii</p>\n<pre><code>:\n \n</code></pre></li>\n</ul>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/12/11/ThreadLocal-usage/\">http://agehua.github.io/2016/12/11/ThreadLocal-usage/</a></p>"},{"layout":"post","title":"IM ","keywords":"instant messaging, IM Company","banner":"http://obxk8w81b.bkt.clouddn.com/Autumn%20Landscape%20with%20Four%20Trees.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Autumn%20Landscape%20with%20Four%20Trees.jpg","toc":true,"_content":"\n### IM\n\n#### 1.1 Sinch\n https://www.sinch.com/products/instant-messaging/  \n\n![Snich_pricing](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/im_company_abroad/im_snich.png)\n\n<!--more-->\n\n#### 1.2 quickblox\n\nhttps://quickblox.com/\n\n![quickblox](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/im_company_abroad/im_quickblox.png)\n\n#### 1.3 Layer\nhttps://layer.com/use-cases\n\n\n![Layer](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/im_company_abroad/im_layer.png)\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/im_company_abroad/im_layer_email.png)\n\n#### 1.4sendbird\nhttps://sendbird.com\n\n\n![sendbird](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/im_company_abroad/im_sendbird.png)\n\n#### 1.5 applozic\nhttps://www.applozic.com/\n\n![applozic](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/im_company_abroad/im_applozic.png)\n\n### IM\n![im_comparation](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/im_company_abroad/im_comparation.png)\n\n[Which Chat SDK is better for user experience? Applozic, Sendbird, Layer or Quickblox!](https://www.applozic.com/blog/applozic-vs-sendbird-vs-layer-vs-quickblox-alternatives/)\n\n\n#### 2.1 QuickBlox vs Applozic\n\n[stackoverflow](http://stackoverflow.com/questions/37678528/comparing-layer-applozic-quickblox-sendbird-for-quick-whatsapp-like-messagin)\n\nI have recently just tested two of the solutions you have cited.\n\n**QuickBlox:**\n- protocol xmpp\n- open source\n- documentated less clearly than applozic\n- easy set up\n\n**Applozic:**\n- protocol mqtt\n- open source easy set up, if a bit laborious\n- well documented, and very easy API to use.\n- Very customizable.\n\n**Both programs:**\n- have video call/audio call/groups\n- have code bases that are constantly being updated, and from their Github pages new version have been released in the past few months\n\n> I preferred Applozic as the user interface was nicer and easier to use, and the features and pricing clearer. I also preferred the API and the setup code was easier.\n\n\n#### 2.2 Quickblox vs SendBird vsLayer\n\n[Do I need to have my own backend?](https://www.quora.com/Quickblox-vs-SendBird-vs-Layer-com-Do-I-need-to-have-my-own-backend)\n\nMy research on Quickblox vs SendBird vsLayer.comis:\n\n- 1.Backend-as-a-Service (BaaS) or Chat-as-a-Service (CaaS):\n  - Quickblox: Both, BaaS and CaaS\n  - SendBird (aka JIVER): CaaS (BaaS for Enterprise-only)\n  - Layer.com: CaaS only\n- 2.WebSocket-based:\n  - Quickblox: No (XMPP)\n  - SendBird: Yes\n  - Layer.com: Yes\n- 3.Voice and Video:\n  - Quickblox: Yes\n  - SendBird: No\n  - Layer.com: No\n- 4.Chat UI Kit:\n  - Quickblox: QMChatViewController\n  - SendBird: Open-source Sample UIs foriOS,Android,JavaScript(Web & React Native),Xamarin,Unity(You can use their Sample UI or 3rd party UI Kit like JSQMessagesViewController)\n  - Layer.com: Atlas\n- 5.Number of Members in a Group:\n  - Quickblox: Thousands (you may need to host Quickblox BaaS at a dedicated AWS infrastructure for better performance)\n  - SendBird:Thousands(no need for an extra infrastructure)\n  - Layer.com:limited to 25 per group\n- 6.The ability to host the BaaS/CaaS at your own IaaS:\n  - Quickblox: Yes (setup cost starts from $599)\n  - SendBird: Yes (limited to Enterprise plans only)\n  - Layer.com: No\n- 7.Custom Objects Backend (the need for extra infrastructure):\n  - Quickblox: Included in Quickblox BaaS\n  - SendBird: Partial support (Key/value custom object stores for channels to be released in March)\n  - Layer.com: No\n- 8.BaaS/CaaS Admin Panel/Dashboard:\n  - Quickblox: Basic with Custom Dashboard when subscribed to the enterprise plan, starts from $599/month (Classic UI)\n  - SendBird: Advanced (Modern UI)\n  - Layer.com: Basic (Modern UI)\n- 9.Attachment max file size:\n  - Quickblox: Unknown\n  - SendBird: 25MB per file (custom limit for Enterprise plans)\n  - Layer.com: 2GB (be aware that their pricing is based on the data transfer)\n- 10.Availability SLA:\n  - Quickblox: Based on AWS EC2 SLA (99.95%)\n  - SendBird: 99.9%\n  - Layer.com: 99.9%\n- 11.Pricing (per month):\n  - Quickblox: Mainly based on the number of messengers per second (/s) and monthly active users: Free-$49-$214-$599-$1,199-$2,399 (Plans)\n  - SendBird: Mainly based on the number of monthly active users (MAU): Free-$59-$179-$599-Custom (https://sendbird.com/pricing)\n  - Layer.com: Mainly based on the monthly data transfer and monthly users: Free-$599 per month-Custom (https://layer.com/plans)\n- 12.Number of freelancers atUpWork.comwho have this Baas/CaaS as one of their skill set:\n  - Quickblox: 547 (keyword: \"Quickblox\")\n  - SendBird: 0 (keyword: \"SendBird\" or \"JIVER\")  new to the market\n  - Layer: 13 (keyword: \"Layer.com\" not Layer)\n\n#### 2.3 \n\nhttps://www.quora.com/Quickblox-vs-SendBird-vs-Layer-com-Do-I-need-to-have-my-own-backend\n\nhttp://stackoverflow.com/questions/37678528/comparing-layer-applozic-quickblox-sendbird-for-quick-whatsapp-like-messagin\n\nhttps://www.applozic.com/blog/applozic-vs-sendbird-vs-layer-vs-quickblox-alternatives/\n\nhttps://siftery.com/product-comparison/sendbird-vs-quickblox-vs-layer\n\nhttps://stackshare.io/stackups/sendbird-vs-sinch-vs-layer\n\nhttps://www.quora.com/What-SDKs-APIs-are-viable-for-implementing-instant-messaging-between-clients-Android-iOS-and-web\n","source":"_posts/2017-01-13-abroad-IM-service-company.md","raw":"---\nlayout: post\ntitle:  IM \ncategory: Investigation\ntags:\n  - IM Company\nkeywords: instant messaging, IM Company\nbanner: http://obxk8w81b.bkt.clouddn.com/Autumn%20Landscape%20with%20Four%20Trees.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Autumn%20Landscape%20with%20Four%20Trees.jpg\ntoc: true\n---\n\n### IM\n\n#### 1.1 Sinch\n https://www.sinch.com/products/instant-messaging/  \n\n![Snich_pricing](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/im_company_abroad/im_snich.png)\n\n<!--more-->\n\n#### 1.2 quickblox\n\nhttps://quickblox.com/\n\n![quickblox](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/im_company_abroad/im_quickblox.png)\n\n#### 1.3 Layer\nhttps://layer.com/use-cases\n\n\n![Layer](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/im_company_abroad/im_layer.png)\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/im_company_abroad/im_layer_email.png)\n\n#### 1.4sendbird\nhttps://sendbird.com\n\n\n![sendbird](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/im_company_abroad/im_sendbird.png)\n\n#### 1.5 applozic\nhttps://www.applozic.com/\n\n![applozic](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/im_company_abroad/im_applozic.png)\n\n### IM\n![im_comparation](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/im_company_abroad/im_comparation.png)\n\n[Which Chat SDK is better for user experience? Applozic, Sendbird, Layer or Quickblox!](https://www.applozic.com/blog/applozic-vs-sendbird-vs-layer-vs-quickblox-alternatives/)\n\n\n#### 2.1 QuickBlox vs Applozic\n\n[stackoverflow](http://stackoverflow.com/questions/37678528/comparing-layer-applozic-quickblox-sendbird-for-quick-whatsapp-like-messagin)\n\nI have recently just tested two of the solutions you have cited.\n\n**QuickBlox:**\n- protocol xmpp\n- open source\n- documentated less clearly than applozic\n- easy set up\n\n**Applozic:**\n- protocol mqtt\n- open source easy set up, if a bit laborious\n- well documented, and very easy API to use.\n- Very customizable.\n\n**Both programs:**\n- have video call/audio call/groups\n- have code bases that are constantly being updated, and from their Github pages new version have been released in the past few months\n\n> I preferred Applozic as the user interface was nicer and easier to use, and the features and pricing clearer. I also preferred the API and the setup code was easier.\n\n\n#### 2.2 Quickblox vs SendBird vsLayer\n\n[Do I need to have my own backend?](https://www.quora.com/Quickblox-vs-SendBird-vs-Layer-com-Do-I-need-to-have-my-own-backend)\n\nMy research on Quickblox vs SendBird vsLayer.comis:\n\n- 1.Backend-as-a-Service (BaaS) or Chat-as-a-Service (CaaS):\n  - Quickblox: Both, BaaS and CaaS\n  - SendBird (aka JIVER): CaaS (BaaS for Enterprise-only)\n  - Layer.com: CaaS only\n- 2.WebSocket-based:\n  - Quickblox: No (XMPP)\n  - SendBird: Yes\n  - Layer.com: Yes\n- 3.Voice and Video:\n  - Quickblox: Yes\n  - SendBird: No\n  - Layer.com: No\n- 4.Chat UI Kit:\n  - Quickblox: QMChatViewController\n  - SendBird: Open-source Sample UIs foriOS,Android,JavaScript(Web & React Native),Xamarin,Unity(You can use their Sample UI or 3rd party UI Kit like JSQMessagesViewController)\n  - Layer.com: Atlas\n- 5.Number of Members in a Group:\n  - Quickblox: Thousands (you may need to host Quickblox BaaS at a dedicated AWS infrastructure for better performance)\n  - SendBird:Thousands(no need for an extra infrastructure)\n  - Layer.com:limited to 25 per group\n- 6.The ability to host the BaaS/CaaS at your own IaaS:\n  - Quickblox: Yes (setup cost starts from $599)\n  - SendBird: Yes (limited to Enterprise plans only)\n  - Layer.com: No\n- 7.Custom Objects Backend (the need for extra infrastructure):\n  - Quickblox: Included in Quickblox BaaS\n  - SendBird: Partial support (Key/value custom object stores for channels to be released in March)\n  - Layer.com: No\n- 8.BaaS/CaaS Admin Panel/Dashboard:\n  - Quickblox: Basic with Custom Dashboard when subscribed to the enterprise plan, starts from $599/month (Classic UI)\n  - SendBird: Advanced (Modern UI)\n  - Layer.com: Basic (Modern UI)\n- 9.Attachment max file size:\n  - Quickblox: Unknown\n  - SendBird: 25MB per file (custom limit for Enterprise plans)\n  - Layer.com: 2GB (be aware that their pricing is based on the data transfer)\n- 10.Availability SLA:\n  - Quickblox: Based on AWS EC2 SLA (99.95%)\n  - SendBird: 99.9%\n  - Layer.com: 99.9%\n- 11.Pricing (per month):\n  - Quickblox: Mainly based on the number of messengers per second (/s) and monthly active users: Free-$49-$214-$599-$1,199-$2,399 (Plans)\n  - SendBird: Mainly based on the number of monthly active users (MAU): Free-$59-$179-$599-Custom (https://sendbird.com/pricing)\n  - Layer.com: Mainly based on the monthly data transfer and monthly users: Free-$599 per month-Custom (https://layer.com/plans)\n- 12.Number of freelancers atUpWork.comwho have this Baas/CaaS as one of their skill set:\n  - Quickblox: 547 (keyword: \"Quickblox\")\n  - SendBird: 0 (keyword: \"SendBird\" or \"JIVER\")  new to the market\n  - Layer: 13 (keyword: \"Layer.com\" not Layer)\n\n#### 2.3 \n\nhttps://www.quora.com/Quickblox-vs-SendBird-vs-Layer-com-Do-I-need-to-have-my-own-backend\n\nhttp://stackoverflow.com/questions/37678528/comparing-layer-applozic-quickblox-sendbird-for-quick-whatsapp-like-messagin\n\nhttps://www.applozic.com/blog/applozic-vs-sendbird-vs-layer-vs-quickblox-alternatives/\n\nhttps://siftery.com/product-comparison/sendbird-vs-quickblox-vs-layer\n\nhttps://stackshare.io/stackups/sendbird-vs-sinch-vs-layer\n\nhttps://www.quora.com/What-SDKs-APIs-are-viable-for-implementing-instant-messaging-between-clients-Android-iOS-and-web\n","slug":"abroad-IM-service-company","published":1,"date":"2017-01-12T16:00:00.000Z","updated":"2017-11-23T07:12:47.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ebzv002jd6yk8xvoyg3x","content":"<h3 id=\"IM\"><a href=\"#IM\" class=\"headerlink\" title=\"IM\"></a>IM</h3><h4 id=\"1-1-Sinch\"><a href=\"#1-1-Sinch\" class=\"headerlink\" title=\"1.1 Sinch\"></a>1.1 Sinch</h4><p> <a href=\"https://www.sinch.com/products/instant-messaging/\" target=\"_blank\" rel=\"external\">https://www.sinch.com/products/instant-messaging/</a><br><br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/im_company_abroad/im_snich.png\" alt=\"Snich_pricing\"></p>\n<a id=\"more\"></a>\n<h4 id=\"1-2-quickblox\"><a href=\"#1-2-quickblox\" class=\"headerlink\" title=\"1.2 quickblox\"></a>1.2 quickblox</h4><p><a href=\"https://quickblox.com/\" target=\"_blank\" rel=\"external\">https://quickblox.com/</a><br><br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/im_company_abroad/im_quickblox.png\" alt=\"quickblox\"></p>\n<h4 id=\"1-3-Layer\"><a href=\"#1-3-Layer\" class=\"headerlink\" title=\"1.3 Layer\"></a>1.3 Layer</h4><p><a href=\"https://layer.com/use-cases\" target=\"_blank\" rel=\"external\">https://layer.com/use-cases</a></p>\n<p><br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/im_company_abroad/im_layer.png\" alt=\"Layer\"><br><br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/im_company_abroad/im_layer_email.png\" alt=\"\"></p>\n<h4 id=\"1-4sendbird\"><a href=\"#1-4sendbird\" class=\"headerlink\" title=\"1.4sendbird\"></a>1.4sendbird</h4><p><a href=\"https://sendbird.com\" target=\"_blank\" rel=\"external\">https://sendbird.com</a></p>\n<p><br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/im_company_abroad/im_sendbird.png\" alt=\"sendbird\"></p>\n<h4 id=\"1-5-applozic\"><a href=\"#1-5-applozic\" class=\"headerlink\" title=\"1.5 applozic\"></a>1.5 applozic</h4><p><a href=\"https://www.applozic.com/\" target=\"_blank\" rel=\"external\">https://www.applozic.com/</a><br><br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/im_company_abroad/im_applozic.png\" alt=\"applozic\"></p>\n<h3 id=\"IM\"><a href=\"#IM\" class=\"headerlink\" title=\"IM\"></a>IM</h3><p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/im_company_abroad/im_comparation.png\" alt=\"im_comparation\"></p>\n<p><a href=\"https://www.applozic.com/blog/applozic-vs-sendbird-vs-layer-vs-quickblox-alternatives/\" target=\"_blank\" rel=\"external\">Which Chat SDK is better for user experience? Applozic, Sendbird, Layer or Quickblox!</a></p>\n<h4 id=\"2-1-QuickBlox-vs-Applozic\"><a href=\"#2-1-QuickBlox-vs-Applozic\" class=\"headerlink\" title=\"2.1 QuickBlox vs Applozic\"></a>2.1 QuickBlox vs Applozic</h4><p><a href=\"http://stackoverflow.com/questions/37678528/comparing-layer-applozic-quickblox-sendbird-for-quick-whatsapp-like-messagin\" target=\"_blank\" rel=\"external\">stackoverflow</a></p>\n<p>I have recently just tested two of the solutions you have cited.</p>\n<p><strong>QuickBlox:</strong></p>\n<ul>\n<li>protocol xmpp</li>\n<li>open source</li>\n<li>documentated less clearly than applozic</li>\n<li>easy set up</li>\n</ul>\n<p><strong>Applozic:</strong></p>\n<ul>\n<li>protocol mqtt</li>\n<li>open source easy set up, if a bit laborious</li>\n<li>well documented, and very easy API to use.</li>\n<li>Very customizable.</li>\n</ul>\n<p><strong>Both programs:</strong></p>\n<ul>\n<li>have video call/audio call/groups</li>\n<li>have code bases that are constantly being updated, and from their Github pages new version have been released in the past few months</li>\n</ul>\n<blockquote>\n<p>I preferred Applozic as the user interface was nicer and easier to use, and the features and pricing clearer. I also preferred the API and the setup code was easier.</p>\n</blockquote>\n<h4 id=\"2-2-Quickblox-vs-SendBird-vs-Layer\"><a href=\"#2-2-Quickblox-vs-SendBird-vs-Layer\" class=\"headerlink\" title=\"2.2 Quickblox vs SendBird vs Layer\"></a>2.2 Quickblox vs SendBird vs Layer</h4><p><a href=\"https://www.quora.com/Quickblox-vs-SendBird-vs-Layer-com-Do-I-need-to-have-my-own-backend\" target=\"_blank\" rel=\"external\">Do I need to have my own backend?</a></p>\n<p>My research on Quickblox vs SendBird vs Layer.com is:</p>\n<ul>\n<li>1.Backend-as-a-Service (BaaS) or Chat-as-a-Service (CaaS):<ul>\n<li>Quickblox: Both, BaaS and CaaS</li>\n<li>SendBird (aka JIVER): CaaS (BaaS for Enterprise-only)</li>\n<li>Layer.com: CaaS only</li>\n</ul>\n</li>\n<li>2.WebSocket-based:<ul>\n<li>Quickblox: No (XMPP)</li>\n<li>SendBird: Yes</li>\n<li>Layer.com: Yes</li>\n</ul>\n</li>\n<li>3.Voice and Video:<ul>\n<li>Quickblox: Yes</li>\n<li>SendBird: No</li>\n<li>Layer.com: No</li>\n</ul>\n</li>\n<li>4.Chat UI Kit:<ul>\n<li>Quickblox: QMChatViewController</li>\n<li>SendBird: Open-source Sample UIs for iOS, Android, JavaScript (Web &amp; React Native), Xamarin, Unity (You can use their Sample UI or 3rd party UI Kit like JSQMessagesViewController)</li>\n<li>Layer.com: Atlas</li>\n</ul>\n</li>\n<li>5.Number of Members in a Group:<ul>\n<li>Quickblox: Thousands (you may need to host Quickblox BaaS at a dedicated AWS infrastructure for better performance)</li>\n<li>SendBird: Thousands (no need for an extra infrastructure)</li>\n<li>Layer.com: limited to 25 per group</li>\n</ul>\n</li>\n<li>6.The ability to host the BaaS/CaaS at your own IaaS:<ul>\n<li>Quickblox: Yes (setup cost starts from $599)</li>\n<li>SendBird: Yes (limited to Enterprise plans only)</li>\n<li>Layer.com: No</li>\n</ul>\n</li>\n<li>7.Custom Objects Backend (the need for extra infrastructure):<ul>\n<li>Quickblox: Included in Quickblox BaaS</li>\n<li>SendBird: Partial support (Key/value custom object stores for channels to be released in March)</li>\n<li>Layer.com: No</li>\n</ul>\n</li>\n<li>8.BaaS/CaaS Admin Panel/Dashboard:<ul>\n<li>Quickblox: Basic with Custom Dashboard when subscribed to the enterprise plan, starts from $599/month (Classic UI)</li>\n<li>SendBird: Advanced (Modern UI)</li>\n<li>Layer.com: Basic (Modern UI)</li>\n</ul>\n</li>\n<li>9.Attachment max file size:<ul>\n<li>Quickblox: Unknown</li>\n<li>SendBird: 25MB per file (custom limit for Enterprise plans)</li>\n<li>Layer.com: 2GB (be aware that their pricing is based on the data transfer)</li>\n</ul>\n</li>\n<li>10.Availability SLA:<ul>\n<li>Quickblox: Based on AWS EC2 SLA (99.95%)</li>\n<li>SendBird: 99.9%</li>\n<li>Layer.com: 99.9%</li>\n</ul>\n</li>\n<li>11.Pricing (per month):<ul>\n<li>Quickblox: Mainly based on the number of messengers per second (/s) and monthly active users: Free-$49-$214-$599-$1,199-$2,399 (Plans) </li>\n<li>SendBird: Mainly based on the number of monthly active users (MAU): Free-$59-$179-$599-Custom (<a href=\"https://sendbird.com/pricing\" target=\"_blank\" rel=\"external\">https://sendbird.com/pricing</a>) </li>\n<li>Layer.com: Mainly based on the monthly data transfer and monthly users: Free-$599 per month-Custom (<a href=\"https://layer.com/plans\" target=\"_blank\" rel=\"external\">https://layer.com/plans</a>)</li>\n</ul>\n</li>\n<li>12.Number of freelancers at UpWork.com who have this Baas/CaaS as one of their skill set:<ul>\n<li>Quickblox: 547 (keyword: Quickblox)</li>\n<li>SendBird: 0 (keyword: SendBird or JIVER)  new to the market</li>\n<li>Layer: 13 (keyword: Layer.com not Layer)</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"2-3-\"><a href=\"#2-3-\" class=\"headerlink\" title=\"2.3 \"></a>2.3 </h4><p><a href=\"https://www.quora.com/Quickblox-vs-SendBird-vs-Layer-com-Do-I-need-to-have-my-own-backend\" target=\"_blank\" rel=\"external\">https://www.quora.com/Quickblox-vs-SendBird-vs-Layer-com-Do-I-need-to-have-my-own-backend</a></p>\n<p><a href=\"http://stackoverflow.com/questions/37678528/comparing-layer-applozic-quickblox-sendbird-for-quick-whatsapp-like-messagin\" target=\"_blank\" rel=\"external\">http://stackoverflow.com/questions/37678528/comparing-layer-applozic-quickblox-sendbird-for-quick-whatsapp-like-messagin</a></p>\n<p><a href=\"https://www.applozic.com/blog/applozic-vs-sendbird-vs-layer-vs-quickblox-alternatives/\" target=\"_blank\" rel=\"external\">https://www.applozic.com/blog/applozic-vs-sendbird-vs-layer-vs-quickblox-alternatives/</a></p>\n<p><a href=\"https://siftery.com/product-comparison/sendbird-vs-quickblox-vs-layer\" target=\"_blank\" rel=\"external\">https://siftery.com/product-comparison/sendbird-vs-quickblox-vs-layer</a></p>\n<p><a href=\"https://stackshare.io/stackups/sendbird-vs-sinch-vs-layer\" target=\"_blank\" rel=\"external\">https://stackshare.io/stackups/sendbird-vs-sinch-vs-layer</a></p>\n<p><a href=\"https://www.quora.com/What-SDKs-APIs-are-viable-for-implementing-instant-messaging-between-clients-Android-iOS-and-web\" target=\"_blank\" rel=\"external\">https://www.quora.com/What-SDKs-APIs-are-viable-for-implementing-instant-messaging-between-clients-Android-iOS-and-web</a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/01/13/abroad-IM-service-company/\">http://agehua.github.io/2017/01/13/abroad-IM-service-company/</a></p>\n","readingTime":{"text":"3 min read","minutes":2.86,"time":171600,"words":572},"excerpt":"<h3 id=\"IM\"><a href=\"#IM\" class=\"headerlink\" title=\"IM\"></a>IM</h3><h4 id=\"1-1-Sinch\"><a href=\"#1-1-Sinch\" class=\"headerlink\" title=\"1.1 Sinch\"></a>1.1 Sinch</h4><p> <a href=\"https://www.sinch.com/products/instant-messaging/\">https://www.sinch.com/products/instant-messaging/</a><br><br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/im_company_abroad/im_snich.png\" alt=\"Snich_pricing\"></p>","more":"<h4 id=\"1-2-quickblox\"><a href=\"#1-2-quickblox\" class=\"headerlink\" title=\"1.2 quickblox\"></a>1.2 quickblox</h4><p><a href=\"https://quickblox.com/\">https://quickblox.com/</a><br><br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/im_company_abroad/im_quickblox.png\" alt=\"quickblox\"></p>\n<h4 id=\"1-3-Layer\"><a href=\"#1-3-Layer\" class=\"headerlink\" title=\"1.3 Layer\"></a>1.3 Layer</h4><p><a href=\"https://layer.com/use-cases\">https://layer.com/use-cases</a></p>\n<p><br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/im_company_abroad/im_layer.png\" alt=\"Layer\"><br><br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/im_company_abroad/im_layer_email.png\" alt=\"\"></p>\n<h4 id=\"1-4sendbird\"><a href=\"#1-4sendbird\" class=\"headerlink\" title=\"1.4sendbird\"></a>1.4sendbird</h4><p><a href=\"https://sendbird.com\">https://sendbird.com</a></p>\n<p><br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/im_company_abroad/im_sendbird.png\" alt=\"sendbird\"></p>\n<h4 id=\"1-5-applozic\"><a href=\"#1-5-applozic\" class=\"headerlink\" title=\"1.5 applozic\"></a>1.5 applozic</h4><p><a href=\"https://www.applozic.com/\">https://www.applozic.com/</a><br><br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/im_company_abroad/im_applozic.png\" alt=\"applozic\"></p>\n<h3 id=\"IM\"><a href=\"#IM\" class=\"headerlink\" title=\"IM\"></a>IM</h3><p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/im_company_abroad/im_comparation.png\" alt=\"im_comparation\"></p>\n<p><a href=\"https://www.applozic.com/blog/applozic-vs-sendbird-vs-layer-vs-quickblox-alternatives/\">Which Chat SDK is better for user experience? Applozic, Sendbird, Layer or Quickblox!</a></p>\n<h4 id=\"2-1-QuickBlox-vs-Applozic\"><a href=\"#2-1-QuickBlox-vs-Applozic\" class=\"headerlink\" title=\"2.1 QuickBlox vs Applozic\"></a>2.1 QuickBlox vs Applozic</h4><p><a href=\"http://stackoverflow.com/questions/37678528/comparing-layer-applozic-quickblox-sendbird-for-quick-whatsapp-like-messagin\">stackoverflow</a></p>\n<p>I have recently just tested two of the solutions you have cited.</p>\n<p><strong>QuickBlox:</strong></p>\n<ul>\n<li>protocol xmpp</li>\n<li>open source</li>\n<li>documentated less clearly than applozic</li>\n<li>easy set up</li>\n</ul>\n<p><strong>Applozic:</strong></p>\n<ul>\n<li>protocol mqtt</li>\n<li>open source easy set up, if a bit laborious</li>\n<li>well documented, and very easy API to use.</li>\n<li>Very customizable.</li>\n</ul>\n<p><strong>Both programs:</strong></p>\n<ul>\n<li>have video call/audio call/groups</li>\n<li>have code bases that are constantly being updated, and from their Github pages new version have been released in the past few months</li>\n</ul>\n<blockquote>\n<p>I preferred Applozic as the user interface was nicer and easier to use, and the features and pricing clearer. I also preferred the API and the setup code was easier.</p>\n</blockquote>\n<h4 id=\"2-2-Quickblox-vs-SendBird-vs-Layer\"><a href=\"#2-2-Quickblox-vs-SendBird-vs-Layer\" class=\"headerlink\" title=\"2.2 Quickblox vs SendBird vs Layer\"></a>2.2 Quickblox vs SendBird vs Layer</h4><p><a href=\"https://www.quora.com/Quickblox-vs-SendBird-vs-Layer-com-Do-I-need-to-have-my-own-backend\">Do I need to have my own backend?</a></p>\n<p>My research on Quickblox vs SendBird vs Layer.com is:</p>\n<ul>\n<li>1.Backend-as-a-Service (BaaS) or Chat-as-a-Service (CaaS):<ul>\n<li>Quickblox: Both, BaaS and CaaS</li>\n<li>SendBird (aka JIVER): CaaS (BaaS for Enterprise-only)</li>\n<li>Layer.com: CaaS only</li>\n</ul>\n</li>\n<li>2.WebSocket-based:<ul>\n<li>Quickblox: No (XMPP)</li>\n<li>SendBird: Yes</li>\n<li>Layer.com: Yes</li>\n</ul>\n</li>\n<li>3.Voice and Video:<ul>\n<li>Quickblox: Yes</li>\n<li>SendBird: No</li>\n<li>Layer.com: No</li>\n</ul>\n</li>\n<li>4.Chat UI Kit:<ul>\n<li>Quickblox: QMChatViewController</li>\n<li>SendBird: Open-source Sample UIs for iOS, Android, JavaScript (Web &amp; React Native), Xamarin, Unity (You can use their Sample UI or 3rd party UI Kit like JSQMessagesViewController)</li>\n<li>Layer.com: Atlas</li>\n</ul>\n</li>\n<li>5.Number of Members in a Group:<ul>\n<li>Quickblox: Thousands (you may need to host Quickblox BaaS at a dedicated AWS infrastructure for better performance)</li>\n<li>SendBird: Thousands (no need for an extra infrastructure)</li>\n<li>Layer.com: limited to 25 per group</li>\n</ul>\n</li>\n<li>6.The ability to host the BaaS/CaaS at your own IaaS:<ul>\n<li>Quickblox: Yes (setup cost starts from $599)</li>\n<li>SendBird: Yes (limited to Enterprise plans only)</li>\n<li>Layer.com: No</li>\n</ul>\n</li>\n<li>7.Custom Objects Backend (the need for extra infrastructure):<ul>\n<li>Quickblox: Included in Quickblox BaaS</li>\n<li>SendBird: Partial support (Key/value custom object stores for channels to be released in March)</li>\n<li>Layer.com: No</li>\n</ul>\n</li>\n<li>8.BaaS/CaaS Admin Panel/Dashboard:<ul>\n<li>Quickblox: Basic with Custom Dashboard when subscribed to the enterprise plan, starts from $599/month (Classic UI)</li>\n<li>SendBird: Advanced (Modern UI)</li>\n<li>Layer.com: Basic (Modern UI)</li>\n</ul>\n</li>\n<li>9.Attachment max file size:<ul>\n<li>Quickblox: Unknown</li>\n<li>SendBird: 25MB per file (custom limit for Enterprise plans)</li>\n<li>Layer.com: 2GB (be aware that their pricing is based on the data transfer)</li>\n</ul>\n</li>\n<li>10.Availability SLA:<ul>\n<li>Quickblox: Based on AWS EC2 SLA (99.95%)</li>\n<li>SendBird: 99.9%</li>\n<li>Layer.com: 99.9%</li>\n</ul>\n</li>\n<li>11.Pricing (per month):<ul>\n<li>Quickblox: Mainly based on the number of messengers per second (/s) and monthly active users: Free-$49-$214-$599-$1,199-$2,399 (Plans) </li>\n<li>SendBird: Mainly based on the number of monthly active users (MAU): Free-$59-$179-$599-Custom (<a href=\"https://sendbird.com/pricing\">https://sendbird.com/pricing</a>) </li>\n<li>Layer.com: Mainly based on the monthly data transfer and monthly users: Free-$599 per month-Custom (<a href=\"https://layer.com/plans\">https://layer.com/plans</a>)</li>\n</ul>\n</li>\n<li>12.Number of freelancers at UpWork.com who have this Baas/CaaS as one of their skill set:<ul>\n<li>Quickblox: 547 (keyword: Quickblox)</li>\n<li>SendBird: 0 (keyword: SendBird or JIVER)  new to the market</li>\n<li>Layer: 13 (keyword: Layer.com not Layer)</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"2-3-\"><a href=\"#2-3-\" class=\"headerlink\" title=\"2.3 \"></a>2.3 </h4><p><a href=\"https://www.quora.com/Quickblox-vs-SendBird-vs-Layer-com-Do-I-need-to-have-my-own-backend\">https://www.quora.com/Quickblox-vs-SendBird-vs-Layer-com-Do-I-need-to-have-my-own-backend</a></p>\n<p><a href=\"http://stackoverflow.com/questions/37678528/comparing-layer-applozic-quickblox-sendbird-for-quick-whatsapp-like-messagin\">http://stackoverflow.com/questions/37678528/comparing-layer-applozic-quickblox-sendbird-for-quick-whatsapp-like-messagin</a></p>\n<p><a href=\"https://www.applozic.com/blog/applozic-vs-sendbird-vs-layer-vs-quickblox-alternatives/\">https://www.applozic.com/blog/applozic-vs-sendbird-vs-layer-vs-quickblox-alternatives/</a></p>\n<p><a href=\"https://siftery.com/product-comparison/sendbird-vs-quickblox-vs-layer\">https://siftery.com/product-comparison/sendbird-vs-quickblox-vs-layer</a></p>\n<p><a href=\"https://stackshare.io/stackups/sendbird-vs-sinch-vs-layer\">https://stackshare.io/stackups/sendbird-vs-sinch-vs-layer</a></p>\n<p><a href=\"https://www.quora.com/What-SDKs-APIs-are-viable-for-implementing-instant-messaging-between-clients-Android-iOS-and-web\">https://www.quora.com/What-SDKs-APIs-are-viable-for-implementing-instant-messaging-between-clients-Android-iOS-and-web</a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/01/13/abroad-IM-service-company/\">http://agehua.github.io/2017/01/13/abroad-IM-service-company/</a></p>"},{"layout":"post","title":"Android ","keywords":"Android Patch Update","banner":"http://obxk8w81b.bkt.clouddn.com/A%20Girl%20in%20the%20Street,%20Two%20Coaches%20in%20the%20Background.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/A%20Girl%20in%20the%20Street,%20Two%20Coaches%20in%20the%20Background.jpg","toc":true,"_content":"\n### \ngoogleSmart App Update\n\napk\n\n\n### \napkroot\n\n<!--more-->\n\n### \napkapkpatchapkapkAPK\n\n\n\n- 1.apk\n- 2.old.apknew.apk\n- 3.1.old.apk\n\nAPK**/data/app/%packagename%/**\n\n\n\n~~~ JavaScript\npublic class ApkExtract {\n    public static String extract(Context context) {\n        context = context.getApplicationContext();\n        ApplicationInfo applicationInfo = context.getApplicationInfo();\n        String apkPath = applicationInfo.sourceDir;\n        Log.d(\"hongyang\", apkPath);\n        return apkPath;\n    }\n}\n~~~\n\n[](http://blog.csdn.net/lmj623565791/article/details/52761658)\n\n#### \n[bsdiff](http://www.daemonology.net/bsdiff/bsdiff-4.3.tar.gz)\n\n\n\nhttp://www.daemonology.net/bsdiff/\n\n\n\nhttp://www.daemonology.net/bsdiff/bsdiff-4.3.tar.gz\n\nbsdiffAndroid \\\\external\\\\bsdiff[bzlib](http://www.bzip.org/downloads.html)APKMD5\n\nso[](https://github.com/hongyangAndroid/BsDiff_And_Patch/tree/master/so-dist)NDK[](http://blog.csdn.net/lmj623565791/article/details/52761658)\n\n- \n~~~ JavaScript\n./bsdiff old.apk new.apk old-to-new.patch\n~~~\nold-to-new.patch\n\n#### \nAndroid\n\n- old.apkapk\n~~~ JavaScript\n./bspatch old.apk new2.apk old-to-new.patch\n~~~\nnew2.apk\n\nmd5md5\n\n\n### \n- 1Shell\n\n- 2.APKAPKAPPapksha1MD5\n\n[Android](http://blog.csdn.net/huang_cai_yuan/article/details/52927630)\n","source":"_posts/2016-12-20-Android-patch-update.md","raw":"---\nlayout: post\ntitle:  Android \ncategory: accumulation\ntags:\n  - ANDROID\n  - Patch Update\nkeywords: Android Patch Update\nbanner: http://obxk8w81b.bkt.clouddn.com/A%20Girl%20in%20the%20Street,%20Two%20Coaches%20in%20the%20Background.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/A%20Girl%20in%20the%20Street,%20Two%20Coaches%20in%20the%20Background.jpg\ntoc: true\n---\n\n### \ngoogleSmart App Update\n\napk\n\n\n### \napkroot\n\n<!--more-->\n\n### \napkapkpatchapkapkAPK\n\n\n\n- 1.apk\n- 2.old.apknew.apk\n- 3.1.old.apk\n\nAPK**/data/app/%packagename%/**\n\n\n\n~~~ JavaScript\npublic class ApkExtract {\n    public static String extract(Context context) {\n        context = context.getApplicationContext();\n        ApplicationInfo applicationInfo = context.getApplicationInfo();\n        String apkPath = applicationInfo.sourceDir;\n        Log.d(\"hongyang\", apkPath);\n        return apkPath;\n    }\n}\n~~~\n\n[](http://blog.csdn.net/lmj623565791/article/details/52761658)\n\n#### \n[bsdiff](http://www.daemonology.net/bsdiff/bsdiff-4.3.tar.gz)\n\n\n\nhttp://www.daemonology.net/bsdiff/\n\n\n\nhttp://www.daemonology.net/bsdiff/bsdiff-4.3.tar.gz\n\nbsdiffAndroid \\\\external\\\\bsdiff[bzlib](http://www.bzip.org/downloads.html)APKMD5\n\nso[](https://github.com/hongyangAndroid/BsDiff_And_Patch/tree/master/so-dist)NDK[](http://blog.csdn.net/lmj623565791/article/details/52761658)\n\n- \n~~~ JavaScript\n./bsdiff old.apk new.apk old-to-new.patch\n~~~\nold-to-new.patch\n\n#### \nAndroid\n\n- old.apkapk\n~~~ JavaScript\n./bspatch old.apk new2.apk old-to-new.patch\n~~~\nnew2.apk\n\nmd5md5\n\n\n### \n- 1Shell\n\n- 2.APKAPKAPPapksha1MD5\n\n[Android](http://blog.csdn.net/huang_cai_yuan/article/details/52927630)\n","slug":"Android-patch-update","published":1,"date":"2016-12-19T16:00:00.000Z","updated":"2017-11-23T07:25:12.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ec00002md6ykaseqnr5g","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>googleSmart App Update</p>\n<p>apk</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>apkroot</p>\n<a id=\"more\"></a>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>apkapkpatchapkapkAPK</p>\n<p></p>\n<ul>\n<li>1.apk</li>\n<li>2.old.apknew.apk</li>\n<li>3.1.old.apk</li>\n</ul>\n<p>APK<strong>/data/app/%packagename%/</strong></p>\n<p></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">public <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ApkExtract</span> </span>&#123;</div><div class=\"line\">    public <span class=\"keyword\">static</span> <span class=\"built_in\">String</span> extract(Context context) &#123;</div><div class=\"line\">        context = context.getApplicationContext();</div><div class=\"line\">        ApplicationInfo applicationInfo = context.getApplicationInfo();</div><div class=\"line\">        <span class=\"built_in\">String</span> apkPath = applicationInfo.sourceDir;</div><div class=\"line\">        Log.d(<span class=\"string\">\"hongyang\"</span>, apkPath);</div><div class=\"line\">        <span class=\"keyword\">return</span> apkPath;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p><a href=\"http://blog.csdn.net/lmj623565791/article/details/52761658\" target=\"_blank\" rel=\"external\"></a></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><a href=\"http://www.daemonology.net/bsdiff/bsdiff-4.3.tar.gz\" target=\"_blank\" rel=\"external\">bsdiff</a></p>\n<p></p>\n<p><a href=\"http://www.daemonology.net/bsdiff/\" target=\"_blank\" rel=\"external\">http://www.daemonology.net/bsdiff/</a></p>\n<p></p>\n<p><a href=\"http://www.daemonology.net/bsdiff/bsdiff-4.3.tar.gz\" target=\"_blank\" rel=\"external\">http://www.daemonology.net/bsdiff/bsdiff-4.3.tar.gz</a></p>\n<p>bsdiffAndroid \\external\\bsdiff<a href=\"http://www.bzip.org/downloads.html\" target=\"_blank\" rel=\"external\">bzlib</a>APKMD5</p>\n<p>so<a href=\"https://github.com/hongyangAndroid/BsDiff_And_Patch/tree/master/so-dist\" target=\"_blank\" rel=\"external\"></a>NDK<a href=\"http://blog.csdn.net/lmj623565791/article/details/52761658\" target=\"_blank\" rel=\"external\"></a></p>\n<ul>\n<li><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">./bsdiff old.apk <span class=\"keyword\">new</span>.apk old-to-<span class=\"keyword\">new</span>.patch</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>old-to-new.patch</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>Android</p>\n<ul>\n<li>old.apkapk<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">./bspatch old.apk new2.apk old-to-<span class=\"keyword\">new</span>.patch</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>new2.apk</p>\n<p>md5md5</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p>1Shell</p>\n</li>\n<li><p>2.APKAPKAPPapksha1MD5</p>\n</li>\n</ul>\n<p><a href=\"http://blog.csdn.net/huang_cai_yuan/article/details/52927630\" target=\"_blank\" rel=\"external\">Android</a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/12/20/Android-patch-update/\">http://agehua.github.io/2016/12/20/Android-patch-update/</a></p>\n","readingTime":{"text":"1 min read","minutes":0.66,"time":39600,"words":132},"excerpt":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>googleSmart App Update</p>\n<p>apk</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>apkroot</p>","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>apkapkpatchapkapkAPK</p>\n<p></p>\n<ul>\n<li>1.apk</li>\n<li>2.old.apknew.apk</li>\n<li>3.1.old.apk</li>\n</ul>\n<p>APK<strong>/data/app/%packagename%/</strong></p>\n<p></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">public <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ApkExtract</span> </span>&#123;</div><div class=\"line\">    public <span class=\"keyword\">static</span> <span class=\"built_in\">String</span> extract(Context context) &#123;</div><div class=\"line\">        context = context.getApplicationContext();</div><div class=\"line\">        ApplicationInfo applicationInfo = context.getApplicationInfo();</div><div class=\"line\">        <span class=\"built_in\">String</span> apkPath = applicationInfo.sourceDir;</div><div class=\"line\">        Log.d(<span class=\"string\">\"hongyang\"</span>, apkPath);</div><div class=\"line\">        <span class=\"keyword\">return</span> apkPath;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p><a href=\"http://blog.csdn.net/lmj623565791/article/details/52761658\"></a></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><a href=\"http://www.daemonology.net/bsdiff/bsdiff-4.3.tar.gz\">bsdiff</a></p>\n<p></p>\n<p><a href=\"http://www.daemonology.net/bsdiff/\">http://www.daemonology.net/bsdiff/</a></p>\n<p></p>\n<p><a href=\"http://www.daemonology.net/bsdiff/bsdiff-4.3.tar.gz\">http://www.daemonology.net/bsdiff/bsdiff-4.3.tar.gz</a></p>\n<p>bsdiffAndroid \\external\\bsdiff<a href=\"http://www.bzip.org/downloads.html\">bzlib</a>APKMD5</p>\n<p>so<a href=\"https://github.com/hongyangAndroid/BsDiff_And_Patch/tree/master/so-dist\"></a>NDK<a href=\"http://blog.csdn.net/lmj623565791/article/details/52761658\"></a></p>\n<ul>\n<li><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">./bsdiff old.apk <span class=\"keyword\">new</span>.apk old-to-<span class=\"keyword\">new</span>.patch</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>old-to-new.patch</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>Android</p>\n<ul>\n<li>old.apkapk<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">./bspatch old.apk new2.apk old-to-<span class=\"keyword\">new</span>.patch</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>new2.apk</p>\n<p>md5md5</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p>1Shell</p>\n</li>\n<li><p>2.APKAPKAPPapksha1MD5</p>\n</li>\n</ul>\n<p><a href=\"http://blog.csdn.net/huang_cai_yuan/article/details/52927630\">Android</a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/12/20/Android-patch-update/\">http://agehua.github.io/2016/12/20/Android-patch-update/</a></p>"},{"layout":"post","title":"MACiTerm2","keywords":"iterm, linux scp","banner":"http://obxk8w81b.bkt.clouddn.com/Arles%20View%20from%20the%20Wheat%20Fields.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Arles%20View%20from%20the%20Wheat%20Fields.jpg","toc":true,"_content":"\n### MACiTerm2\niTerm2MAC\niTerm2\n\n- 1.iTerm2profilesOpen ProfilesEdit ProfilesProfile\n- 2.commandssh -A -p xxx root@IPxxx\n- 3.profileNewwindow\n\n### SCP\n<!--more-->\nscpsshssh\n\n\n\n\n~~~ C++\necho hello, world > a-file.txt\n~~~\n\ncopy\n~~~ C++\nscp <local file> <remote user>@<remote machine>:<remote path>\n~~~\n\nCopy\n~~~ C++\nscp <remote user>@<remote machine>:<remote path> <local file>\n~~~\n\n\n~~~ C++\nscp -r local_folder remote_username@remote_ip:remote_folder\n~~~\n\n\n~~~ C++\nscp -r /home/space/jdk-8u121-linux-x64.tar.gz root@107.182.178.94:/home/root/others/\n~~~\n\n\n\n[root@tank test]# scp --help\nusage: scp [-1246BCpqrv] [-c cipher] [-F ssh_config] [-i identity_file] [-l limit] [-o ssh_option] [-P port] [-S program] [[user@]host1:]file1 [...] [[user@]host2:]file2  \n\n-1                        scpssh1\n-2                        scpssh2\n-4                        scpIPv4\n-6                        scpIPv6\n-B                        \n-C                        -Cssh\n-p                         \n-q                         \n-r                          \n-v                          scpssh(1)\n-c cipher              cipherssh\n-F ssh_config      sshssh\n-i identity_file      ssh\n-l limit                    Kbit/s\n-o ssh_option      ssh_config(5)\n-P port                  P, port\n-S program         ssh(1)\n\nhttp://blog.51yip.com/linux/1027.html\n\n\n#### iTermmaclinux\n\n~~~\nsudo scp -P 28547 ~/Downloads/nexus-3.2.1-01-unix.tar.gz root@107.182.178.94:/usr/local\n~~~\n-P linux\n","source":"_posts/2017-02-12-iterm2-to-linux.md","raw":"---\nlayout: post\ntitle:  MACiTerm2\ncategory: accumulation\ntags:\n  - linux\n  - iterm\n  - scp\nkeywords: iterm, linux scp\nbanner: http://obxk8w81b.bkt.clouddn.com/Arles%20View%20from%20the%20Wheat%20Fields.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Arles%20View%20from%20the%20Wheat%20Fields.jpg\ntoc: true\n---\n\n### MACiTerm2\niTerm2MAC\niTerm2\n\n- 1.iTerm2profilesOpen ProfilesEdit ProfilesProfile\n- 2.commandssh -A -p xxx root@IPxxx\n- 3.profileNewwindow\n\n### SCP\n<!--more-->\nscpsshssh\n\n\n\n\n~~~ C++\necho hello, world > a-file.txt\n~~~\n\ncopy\n~~~ C++\nscp <local file> <remote user>@<remote machine>:<remote path>\n~~~\n\nCopy\n~~~ C++\nscp <remote user>@<remote machine>:<remote path> <local file>\n~~~\n\n\n~~~ C++\nscp -r local_folder remote_username@remote_ip:remote_folder\n~~~\n\n\n~~~ C++\nscp -r /home/space/jdk-8u121-linux-x64.tar.gz root@107.182.178.94:/home/root/others/\n~~~\n\n\n\n[root@tank test]# scp --help\nusage: scp [-1246BCpqrv] [-c cipher] [-F ssh_config] [-i identity_file] [-l limit] [-o ssh_option] [-P port] [-S program] [[user@]host1:]file1 [...] [[user@]host2:]file2  \n\n-1                        scpssh1\n-2                        scpssh2\n-4                        scpIPv4\n-6                        scpIPv6\n-B                        \n-C                        -Cssh\n-p                         \n-q                         \n-r                          \n-v                          scpssh(1)\n-c cipher              cipherssh\n-F ssh_config      sshssh\n-i identity_file      ssh\n-l limit                    Kbit/s\n-o ssh_option      ssh_config(5)\n-P port                  P, port\n-S program         ssh(1)\n\nhttp://blog.51yip.com/linux/1027.html\n\n\n#### iTermmaclinux\n\n~~~\nsudo scp -P 28547 ~/Downloads/nexus-3.2.1-01-unix.tar.gz root@107.182.178.94:/usr/local\n~~~\n-P linux\n","slug":"iterm2-to-linux","published":1,"date":"2017-02-11T16:00:00.000Z","updated":"2017-11-23T07:13:09.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ec03002pd6ykce904fx8","content":"<h3 id=\"MACiTerm2\"><a href=\"#MACiTerm2\" class=\"headerlink\" title=\"MACiTerm2\"></a>MACiTerm2</h3><p>iTerm2MAC<br>iTerm2</p>\n<ul>\n<li>1.iTerm2profilesOpen ProfilesEdit ProfilesProfile</li>\n<li>2.commandssh -A -p xxx root@IPxxx</li>\n<li>3.profileNewwindow</li>\n</ul>\n<h3 id=\"SCP\"><a href=\"#SCP\" class=\"headerlink\" title=\"SCP\"></a>SCP</h3><a id=\"more\"></a>\n<p>scpsshssh</p>\n<p></p>\n<p><br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">echo hello, world &gt; a-file.txt</div></pre></td></tr></table></figure></p>\n<p>copy<br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">scp &lt;local file&gt; &lt;remote user&gt;@&lt;remote machine&gt;:&lt;remote path&gt;</div></pre></td></tr></table></figure></p>\n<p>Copy<br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">scp &lt;remote user&gt;@&lt;remote machine&gt;:&lt;remote path&gt; &lt;local file&gt;</div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">scp -r local_folder remote_username@remote_ip:remote_folder</div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">scp -r /home/space/jdk<span class=\"number\">-8</span>u121-linux-x64.tar.gz root@<span class=\"number\">107.182</span><span class=\"number\">.178</span><span class=\"number\">.94</span>:/home/root/others/</div></pre></td></tr></table></figure></p>\n<p></p>\n<p>[root@tank test]# scp help<br>usage: scp [-1246BCpqrv] [-c cipher] [-F ssh_config] [-i identity_file] [-l limit] [-o ssh_option] [-P port] [-S program] [[user@]host1:]file1 [] [[user@]host2:]file2  </p>\n<p>-1                        scpssh1<br>-2                        scpssh2<br>-4                        scpIPv4<br>-6                        scpIPv6<br>-B                        <br>-C                        -Cssh<br>-p                         <br>-q                         <br>-r                          <br>-v                          scpssh(1)<br>-c cipher              cipherssh<br>-F ssh_config      sshssh<br>-i identity_file      ssh<br>-l limit                    Kbit/s<br>-o ssh_option      ssh_config(5)<br>-P port                  P, port<br>-S program         ssh(1)</p>\n<p><a href=\"http://blog.51yip.com/linux/1027.html\" target=\"_blank\" rel=\"external\">http://blog.51yip.com/linux/1027.html</a></p>\n<h4 id=\"iTermmaclinux\"><a href=\"#iTermmaclinux\" class=\"headerlink\" title=\"iTermmaclinux\"></a>iTermmaclinux</h4><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><div class=\"line\">sudo scp -P 28547 ~/Downloads/nexus-3.2.1-01-unix.tar.gz root@107.182.178.94:/usr/local</div></pre></td></tr></table></figure>\n<p>-P linux</p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/02/12/iterm2-to-linux/\">http://agehua.github.io/2017/02/12/iterm2-to-linux/</a></p>\n","readingTime":{"text":"1 min read","minutes":0.88,"time":52800,"words":176},"excerpt":"<h3 id=\"MACiTerm2\"><a href=\"#MACiTerm2\" class=\"headerlink\" title=\"MACiTerm2\"></a>MACiTerm2</h3><p>iTerm2MAC<br>iTerm2</p>\n<ul>\n<li>1.iTerm2profilesOpen ProfilesEdit ProfilesProfile</li>\n<li>2.commandssh -A -p xxx root@IPxxx</li>\n<li>3.profileNewwindow</li>\n</ul>\n<h3 id=\"SCP\"><a href=\"#SCP\" class=\"headerlink\" title=\"SCP\"></a>SCP</h3>","more":"<p>scpsshssh</p>\n<p></p>\n<p><br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">echo hello, world &gt; a-file.txt</div></pre></td></tr></table></figure></p>\n<p>copy<br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">scp &lt;local file&gt; &lt;remote user&gt;@&lt;remote machine&gt;:&lt;remote path&gt;</div></pre></td></tr></table></figure></p>\n<p>Copy<br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">scp &lt;remote user&gt;@&lt;remote machine&gt;:&lt;remote path&gt; &lt;local file&gt;</div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">scp -r local_folder remote_username@remote_ip:remote_folder</div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">scp -r /home/space/jdk<span class=\"number\">-8</span>u121-linux-x64.tar.gz root@<span class=\"number\">107.182</span><span class=\"number\">.178</span><span class=\"number\">.94</span>:/home/root/others/</div></pre></td></tr></table></figure></p>\n<p></p>\n<p>[root@tank test]# scp help<br>usage: scp [-1246BCpqrv] [-c cipher] [-F ssh_config] [-i identity_file] [-l limit] [-o ssh_option] [-P port] [-S program] [[user@]host1:]file1 [] [[user@]host2:]file2  </p>\n<p>-1                        scpssh1<br>-2                        scpssh2<br>-4                        scpIPv4<br>-6                        scpIPv6<br>-B                        <br>-C                        -Cssh<br>-p                         <br>-q                         <br>-r                          <br>-v                          scpssh(1)<br>-c cipher              cipherssh<br>-F ssh_config      sshssh<br>-i identity_file      ssh<br>-l limit                    Kbit/s<br>-o ssh_option      ssh_config(5)<br>-P port                  P, port<br>-S program         ssh(1)</p>\n<p><a href=\"http://blog.51yip.com/linux/1027.html\">http://blog.51yip.com/linux/1027.html</a></p>\n<h4 id=\"iTermmaclinux\"><a href=\"#iTermmaclinux\" class=\"headerlink\" title=\"iTermmaclinux\"></a>iTermmaclinux</h4><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><div class=\"line\">sudo scp -P 28547 ~/Downloads/nexus-3.2.1-01-unix.tar.gz root@107.182.178.94:/usr/local</div></pre></td></tr></table></figure>\n<p>-P linux</p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/02/12/iterm2-to-linux/\">http://agehua.github.io/2017/02/12/iterm2-to-linux/</a></p>"},{"layout":"post","title":"AndroidApplication","keywords":"multi-process","banner":"http://obxk8w81b.bkt.clouddn.com/Avenue%20of%20Plane%20Trees%20near%20Arles%20Station.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Avenue%20of%20Plane%20Trees%20near%20Arles%20Station.jpg","toc":true,"_content":"\n> [Android()](http://blog.spinytech.com/2016/12/28/android_modularization/)AndroidApplication\n\n------\n\n### Android\nAndroidAndroidManifestandroid:process\n\nApplicationonCreateonCreate\n\n### ApplicationonCreate\n\n<!--more-->\n\n#### \nApplicationonCreate\n\n\n\n~~~ Java\n@Override\npublic void onCreate() {\n        super.onCreate();\n    String processName = getProcessName(this, android.os.Process.myPid());\n    if (processName != null) {\n    boolean defaultProcess = processName.equals(Constants.REAL_PACKAGE_NAME);\n    // \n    if (defaultProcess) {\n\t    initAppForMainProcess();\n    }\n    // \n    else if (processName.contains(\":webbrowser\")) {\n\n    } else if (processName.contains(\":bgmusic\")) {\n\n    }  \n}    \n~~~\n\n\n\n~~~ Java\n/**\n * @return null may be returned if the specified process not found\n */\npublic static String getProcessName(Context cxt, int pid) {\n    ActivityManager am = (ActivityManager) cxt.getSystemService(Context.ACTIVITY_SERVICE);\n    List<RunningAppP.rocessInfo> runningApps = am.getRunningAppProcesses();\n    if (runningApps == null) {\n        return null;\n    }\n    for (RunningAppProcessInfo procInfo : runningApps) {\n        if (procInfo.pid == pid) {\n            return procInfo.processName;\n        }\n    }\n    return null;\n}\n~~~\n\n#### Application\n\n[Android()](http://blog.spinytech.com/2016/12/28/android_modularization/)\n\n3\n- MaApplicationApplication\n- BaseApplicationLogicApplication\n- PriorityLogicWrapperComparableBaseApplicationLogicBaseApplicationLogic\n\nApplicationLogicMaApplication\nMaApplicationApplicationLogic\nApplicationLogic\nApplicationLogiconCreateApplicationLogicApplicationonTerminateonLowMemoryonTrimMemoryonConfigurationChangedonCreate\n\n\n![Application](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/multi-Application-flow-chart.png)\n\nBaseApplicationLogic\n\n~~~ Java\npublic class BaseApplicationLogic {\n    protected MaApplication mApplication;\n    public BaseApplicationLogic() {\n    }\n\n    public void setApplication(@NonNull MaApplication application) {\n        mApplication = application;\n    }\n\n    public void onCreate() {\n    }\n\n    public void onTerminate() {\n    }\n\n    public void onLowMemory() {\n    }\n\n    public void onTrimMemory(int level) {\n    }\n\n    public void onConfigurationChanged(Configuration newConfig) {\n    }\n}\n~~~\n\nPriorityLogicWrapperBaseApplicationLogic\n~~~ Java\npublic class PriorityLogicWrapper implements Comparable<PriorityLogicWrapper> {\n\n    public int priority = 0;\n    public Class<? extends BaseApplicationLogic> logicClass = null;\n    public BaseApplicationLogic instance;\n\n    public PriorityLogicWrapper(int priority, Class<? extends BaseApplicationLogic> logicClass) {\n        this.priority = priority;\n        this.logicClass = logicClass;\n    }\n\n    @Override\n    public int compareTo(PriorityLogicWrapper o) {\n        return o.priority - this.priority;\n    }\n}\n~~~\n\n\n\nMaApplicationPriorityLogicWrapperBaseApplicationLogic\n~~~ Java\npublic abstract class MaApplication extends Application {\n\n    //mLogicListPriorityLogicWrapper\n    private ArrayList<PriorityLogicWrapper> mLogicList;\n    //mLogicClassMapPriorityLogicWrapper\n    private HashMap<String, ArrayList<PriorityLogicWrapper>> mLogicClassMap;\n\n    @Override\n    public void onCreate() {\n        super.onCreate();\n        init();\n        initializeLogic();\n        dispatchLogic();\n        instantiateLogic();\n\n        if (null != mLogicList && mLogicList.size() > 0) {\n            for (PriorityLogicWrapper priorityLogicWrapper : mLogicList) {\n                if (null != priorityLogicWrapper && null != priorityLogicWrapper.instance) {\n                    //BaseApplicationLogiconCreate()\n                    priorityLogicWrapper.instance.onCreate();\n                }\n            }\n        }\n    }\n\n    private void init() {\n        mLogicClassMap = new HashMap<>();\n    }\n\n    public abstract boolean needMultipleProcess();\n\n    //MaApplicationregisterApplicationLogic()\n    //BaseApplicationLogic\n    protected abstract void initializeLogic();\n\n    /**\n     * BaseApplicationLogicHashMap\n     * @param processName \n     * @param priority \n     * @param logicClass BaseApplicationLogic\n     * @return\n     */\n    protected boolean registerApplicationLogic(String processName, int priority, @NonNull Class<? extends BaseApplicationLogic> logicClass) {\n        boolean result = false;\n        if (null != mLogicClassMap) {\n            ArrayList<PriorityLogicWrapper> tempList = mLogicClassMap.get(processName);\n            if (null == tempList) {\n                tempList = new ArrayList<>();\n                mLogicClassMap.put(processName, tempList);\n            }\n            if (tempList.size() > 0) {\n                for (PriorityLogicWrapper priorityLogicWrapper : tempList) {\n                    if (logicClass.getName().equals(priorityLogicWrapper.logicClass.getName())) {\n                        throw new RuntimeException(logicClass.getName() + \" has registered.\");\n                    }\n                }\n            }\n            PriorityLogicWrapper priorityLogicWrapper = new PriorityLogicWrapper(priority, logicClass);\n            tempList.add(priorityLogicWrapper);\n            //tempListmLogicClassMapvaluemLogicClassMap.put\n        }\n        return result;\n    }\n\n    /**\n     * ArrayListPriorityLogicWrapper\n     */\n    private void dispatchLogic() {\n        if (null != mLogicClassMap) {\n            //ArrayList<PriorityLogicWrapper>\n            mLogicList = mLogicClassMap.get(ProcessUtil.getProcessName(this, ProcessUtil.getMyProcessId()));\n        }\n    }\n\n    /**\n     * mLogicListPriorityLogicWrapperBaseApplicationLogic\n     */\n    private void instantiateLogic() {\n        if (null != mLogicList && mLogicList.size() > 0) {\n            if (null != mLogicList && mLogicList.size() > 0) {\n                Collections.sort(mLogicList); //\n                for (PriorityLogicWrapper priorityLogicWrapper : mLogicList) {\n                    if (null != priorityLogicWrapper) {\n                        try {\n                            /**\n                             * Class.newInstance()ClassAndroid\n                             * **/\n                            priorityLogicWrapper.instance = priorityLogicWrapper.logicClass.newInstance();\n                        } catch (InstantiationException e) {\n                            e.printStackTrace();\n                        } catch (IllegalAccessException e) {\n                            e.printStackTrace();\n                        }\n                        if (null != priorityLogicWrapper.instance) {\n                            priorityLogicWrapper.instance.setApplication(this);\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    //Application\n    @Override\n    public void onTerminate() {\n        super.onTerminate();\n        if (null != mLogicList && mLogicList.size() > 0) {\n            for (PriorityLogicWrapper priorityLogicWrapper : mLogicList) {\n                if (null != priorityLogicWrapper && null != priorityLogicWrapper.instance) {\n                    priorityLogicWrapper.instance.onTerminate();\n                }\n            }\n        }\n    }\n\n    @Override\n    public void onLowMemory() {\n        super.onLowMemory();\n        if (null != mLogicList && mLogicList.size() > 0) {\n            for (PriorityLogicWrapper priorityLogicWrapper : mLogicList) {\n                if (null != priorityLogicWrapper && null != priorityLogicWrapper.instance) {\n                    priorityLogicWrapper.instance.onLowMemory();\n                }\n            }\n        }\n    }\n\n    @Override\n    public void onTrimMemory(int level) {\n        super.onTrimMemory(level);\n        if (null != mLogicList && mLogicList.size() > 0) {\n            for (PriorityLogicWrapper priorityLogicWrapper : mLogicList) {\n                if (null != priorityLogicWrapper && null != priorityLogicWrapper.instance) {\n                    priorityLogicWrapper.instance.onTrimMemory(level);\n                }\n            }\n        }\n    }\n\n    @Override\n    public void onConfigurationChanged(Configuration newConfig) {\n        super.onConfigurationChanged(newConfig);\n        if (null != mLogicList && mLogicList.size() > 0) {\n            for (PriorityLogicWrapper priorityLogicWrapper : mLogicList) {\n                if (null != priorityLogicWrapper && null != priorityLogicWrapper.instance) {\n                    priorityLogicWrapper.instance.onConfigurationChanged(newConfig);\n                }\n            }\n        }\n    }\n\n}\n~~~\n","source":"_posts/2017-02-21-Multi-Process-Dispatch.md","raw":"---\nlayout: post\ntitle:  AndroidApplication\ncategory: accumulation\ntags:\n  - ANDROID\n  - multi-process\nkeywords: multi-process\nbanner: http://obxk8w81b.bkt.clouddn.com/Avenue%20of%20Plane%20Trees%20near%20Arles%20Station.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Avenue%20of%20Plane%20Trees%20near%20Arles%20Station.jpg\ntoc: true\n---\n\n> [Android()](http://blog.spinytech.com/2016/12/28/android_modularization/)AndroidApplication\n\n------\n\n### Android\nAndroidAndroidManifestandroid:process\n\nApplicationonCreateonCreate\n\n### ApplicationonCreate\n\n<!--more-->\n\n#### \nApplicationonCreate\n\n\n\n~~~ Java\n@Override\npublic void onCreate() {\n        super.onCreate();\n    String processName = getProcessName(this, android.os.Process.myPid());\n    if (processName != null) {\n    boolean defaultProcess = processName.equals(Constants.REAL_PACKAGE_NAME);\n    // \n    if (defaultProcess) {\n\t    initAppForMainProcess();\n    }\n    // \n    else if (processName.contains(\":webbrowser\")) {\n\n    } else if (processName.contains(\":bgmusic\")) {\n\n    }  \n}    \n~~~\n\n\n\n~~~ Java\n/**\n * @return null may be returned if the specified process not found\n */\npublic static String getProcessName(Context cxt, int pid) {\n    ActivityManager am = (ActivityManager) cxt.getSystemService(Context.ACTIVITY_SERVICE);\n    List<RunningAppP.rocessInfo> runningApps = am.getRunningAppProcesses();\n    if (runningApps == null) {\n        return null;\n    }\n    for (RunningAppProcessInfo procInfo : runningApps) {\n        if (procInfo.pid == pid) {\n            return procInfo.processName;\n        }\n    }\n    return null;\n}\n~~~\n\n#### Application\n\n[Android()](http://blog.spinytech.com/2016/12/28/android_modularization/)\n\n3\n- MaApplicationApplication\n- BaseApplicationLogicApplication\n- PriorityLogicWrapperComparableBaseApplicationLogicBaseApplicationLogic\n\nApplicationLogicMaApplication\nMaApplicationApplicationLogic\nApplicationLogic\nApplicationLogiconCreateApplicationLogicApplicationonTerminateonLowMemoryonTrimMemoryonConfigurationChangedonCreate\n\n\n![Application](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/multi-Application-flow-chart.png)\n\nBaseApplicationLogic\n\n~~~ Java\npublic class BaseApplicationLogic {\n    protected MaApplication mApplication;\n    public BaseApplicationLogic() {\n    }\n\n    public void setApplication(@NonNull MaApplication application) {\n        mApplication = application;\n    }\n\n    public void onCreate() {\n    }\n\n    public void onTerminate() {\n    }\n\n    public void onLowMemory() {\n    }\n\n    public void onTrimMemory(int level) {\n    }\n\n    public void onConfigurationChanged(Configuration newConfig) {\n    }\n}\n~~~\n\nPriorityLogicWrapperBaseApplicationLogic\n~~~ Java\npublic class PriorityLogicWrapper implements Comparable<PriorityLogicWrapper> {\n\n    public int priority = 0;\n    public Class<? extends BaseApplicationLogic> logicClass = null;\n    public BaseApplicationLogic instance;\n\n    public PriorityLogicWrapper(int priority, Class<? extends BaseApplicationLogic> logicClass) {\n        this.priority = priority;\n        this.logicClass = logicClass;\n    }\n\n    @Override\n    public int compareTo(PriorityLogicWrapper o) {\n        return o.priority - this.priority;\n    }\n}\n~~~\n\n\n\nMaApplicationPriorityLogicWrapperBaseApplicationLogic\n~~~ Java\npublic abstract class MaApplication extends Application {\n\n    //mLogicListPriorityLogicWrapper\n    private ArrayList<PriorityLogicWrapper> mLogicList;\n    //mLogicClassMapPriorityLogicWrapper\n    private HashMap<String, ArrayList<PriorityLogicWrapper>> mLogicClassMap;\n\n    @Override\n    public void onCreate() {\n        super.onCreate();\n        init();\n        initializeLogic();\n        dispatchLogic();\n        instantiateLogic();\n\n        if (null != mLogicList && mLogicList.size() > 0) {\n            for (PriorityLogicWrapper priorityLogicWrapper : mLogicList) {\n                if (null != priorityLogicWrapper && null != priorityLogicWrapper.instance) {\n                    //BaseApplicationLogiconCreate()\n                    priorityLogicWrapper.instance.onCreate();\n                }\n            }\n        }\n    }\n\n    private void init() {\n        mLogicClassMap = new HashMap<>();\n    }\n\n    public abstract boolean needMultipleProcess();\n\n    //MaApplicationregisterApplicationLogic()\n    //BaseApplicationLogic\n    protected abstract void initializeLogic();\n\n    /**\n     * BaseApplicationLogicHashMap\n     * @param processName \n     * @param priority \n     * @param logicClass BaseApplicationLogic\n     * @return\n     */\n    protected boolean registerApplicationLogic(String processName, int priority, @NonNull Class<? extends BaseApplicationLogic> logicClass) {\n        boolean result = false;\n        if (null != mLogicClassMap) {\n            ArrayList<PriorityLogicWrapper> tempList = mLogicClassMap.get(processName);\n            if (null == tempList) {\n                tempList = new ArrayList<>();\n                mLogicClassMap.put(processName, tempList);\n            }\n            if (tempList.size() > 0) {\n                for (PriorityLogicWrapper priorityLogicWrapper : tempList) {\n                    if (logicClass.getName().equals(priorityLogicWrapper.logicClass.getName())) {\n                        throw new RuntimeException(logicClass.getName() + \" has registered.\");\n                    }\n                }\n            }\n            PriorityLogicWrapper priorityLogicWrapper = new PriorityLogicWrapper(priority, logicClass);\n            tempList.add(priorityLogicWrapper);\n            //tempListmLogicClassMapvaluemLogicClassMap.put\n        }\n        return result;\n    }\n\n    /**\n     * ArrayListPriorityLogicWrapper\n     */\n    private void dispatchLogic() {\n        if (null != mLogicClassMap) {\n            //ArrayList<PriorityLogicWrapper>\n            mLogicList = mLogicClassMap.get(ProcessUtil.getProcessName(this, ProcessUtil.getMyProcessId()));\n        }\n    }\n\n    /**\n     * mLogicListPriorityLogicWrapperBaseApplicationLogic\n     */\n    private void instantiateLogic() {\n        if (null != mLogicList && mLogicList.size() > 0) {\n            if (null != mLogicList && mLogicList.size() > 0) {\n                Collections.sort(mLogicList); //\n                for (PriorityLogicWrapper priorityLogicWrapper : mLogicList) {\n                    if (null != priorityLogicWrapper) {\n                        try {\n                            /**\n                             * Class.newInstance()ClassAndroid\n                             * **/\n                            priorityLogicWrapper.instance = priorityLogicWrapper.logicClass.newInstance();\n                        } catch (InstantiationException e) {\n                            e.printStackTrace();\n                        } catch (IllegalAccessException e) {\n                            e.printStackTrace();\n                        }\n                        if (null != priorityLogicWrapper.instance) {\n                            priorityLogicWrapper.instance.setApplication(this);\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    //Application\n    @Override\n    public void onTerminate() {\n        super.onTerminate();\n        if (null != mLogicList && mLogicList.size() > 0) {\n            for (PriorityLogicWrapper priorityLogicWrapper : mLogicList) {\n                if (null != priorityLogicWrapper && null != priorityLogicWrapper.instance) {\n                    priorityLogicWrapper.instance.onTerminate();\n                }\n            }\n        }\n    }\n\n    @Override\n    public void onLowMemory() {\n        super.onLowMemory();\n        if (null != mLogicList && mLogicList.size() > 0) {\n            for (PriorityLogicWrapper priorityLogicWrapper : mLogicList) {\n                if (null != priorityLogicWrapper && null != priorityLogicWrapper.instance) {\n                    priorityLogicWrapper.instance.onLowMemory();\n                }\n            }\n        }\n    }\n\n    @Override\n    public void onTrimMemory(int level) {\n        super.onTrimMemory(level);\n        if (null != mLogicList && mLogicList.size() > 0) {\n            for (PriorityLogicWrapper priorityLogicWrapper : mLogicList) {\n                if (null != priorityLogicWrapper && null != priorityLogicWrapper.instance) {\n                    priorityLogicWrapper.instance.onTrimMemory(level);\n                }\n            }\n        }\n    }\n\n    @Override\n    public void onConfigurationChanged(Configuration newConfig) {\n        super.onConfigurationChanged(newConfig);\n        if (null != mLogicList && mLogicList.size() > 0) {\n            for (PriorityLogicWrapper priorityLogicWrapper : mLogicList) {\n                if (null != priorityLogicWrapper && null != priorityLogicWrapper.instance) {\n                    priorityLogicWrapper.instance.onConfigurationChanged(newConfig);\n                }\n            }\n        }\n    }\n\n}\n~~~\n","slug":"Multi-Process-Dispatch","published":1,"date":"2017-02-20T16:00:00.000Z","updated":"2017-11-23T07:25:19.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ec08002sd6ykjtbf1egv","content":"<blockquote>\n<p><a href=\"http://blog.spinytech.com/2016/12/28/android_modularization/\" target=\"_blank\" rel=\"external\">Android()</a>AndroidApplication</p>\n</blockquote>\n<hr>\n<h3 id=\"Android\"><a href=\"#Android\" class=\"headerlink\" title=\"Android\"></a>Android</h3><p>AndroidAndroidManifestandroid:process</p>\n<p>ApplicationonCreateonCreate</p>\n<h3 id=\"ApplicationonCreate\"><a href=\"#ApplicationonCreate\" class=\"headerlink\" title=\"ApplicationonCreate\"></a>ApplicationonCreate</h3><p><br><a id=\"more\"></a></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>ApplicationonCreate</p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onCreate</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>.onCreate();</div><div class=\"line\">    String processName = getProcessName(<span class=\"keyword\">this</span>, android.os.Process.myPid());</div><div class=\"line\">    <span class=\"keyword\">if</span> (processName != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">    <span class=\"keyword\">boolean</span> defaultProcess = processName.equals(Constants.REAL_PACKAGE_NAME);</div><div class=\"line\">    <span class=\"comment\">// </span></div><div class=\"line\">    <span class=\"keyword\">if</span> (defaultProcess) &#123;</div><div class=\"line\">\t    initAppForMainProcess();</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"comment\">// </span></div><div class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (processName.contains(<span class=\"string\">\":webbrowser\"</span>)) &#123;</div><div class=\"line\"></div><div class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (processName.contains(<span class=\"string\">\":bgmusic\"</span>)) &#123;</div><div class=\"line\"></div><div class=\"line\">    &#125;  </div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * <span class=\"doctag\">@return</span> null may be returned if the specified process not found</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">getProcessName</span><span class=\"params\">(Context cxt, <span class=\"keyword\">int</span> pid)</span> </span>&#123;</div><div class=\"line\">    ActivityManager am = (ActivityManager) cxt.getSystemService(Context.ACTIVITY_SERVICE);</div><div class=\"line\">    List&lt;RunningAppP.rocessInfo&gt; runningApps = am.getRunningAppProcesses();</div><div class=\"line\">    <span class=\"keyword\">if</span> (runningApps == <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">for</span> (RunningAppProcessInfo procInfo : runningApps) &#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (procInfo.pid == pid) &#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> procInfo.processName;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h4 id=\"Application\"><a href=\"#Application\" class=\"headerlink\" title=\"Application\"></a>Application</h4><p><a href=\"http://blog.spinytech.com/2016/12/28/android_modularization/\" target=\"_blank\" rel=\"external\">Android()</a></p>\n<p>3</p>\n<ul>\n<li>MaApplicationApplication</li>\n<li>BaseApplicationLogicApplication</li>\n<li>PriorityLogicWrapperComparableBaseApplicationLogicBaseApplicationLogic</li>\n</ul>\n<p>ApplicationLogicMaApplication<br>MaApplicationApplicationLogic<br>ApplicationLogic<br>ApplicationLogiconCreateApplicationLogicApplicationonTerminateonLowMemoryonTrimMemoryonConfigurationChangedonCreate</p>\n<p><br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/multi-Application-flow-chart.png\" alt=\"Application\"></p>\n<p>BaseApplicationLogic</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BaseApplicationLogic</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">protected</span> MaApplication mApplication;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">BaseApplicationLogic</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setApplication</span><span class=\"params\">(@NonNull MaApplication application)</span> </span>&#123;</div><div class=\"line\">        mApplication = application;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onCreate</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onTerminate</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onLowMemory</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onTrimMemory</span><span class=\"params\">(<span class=\"keyword\">int</span> level)</span> </span>&#123;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onConfigurationChanged</span><span class=\"params\">(Configuration newConfig)</span> </span>&#123;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>PriorityLogicWrapperBaseApplicationLogic<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">PriorityLogicWrapper</span> <span class=\"keyword\">implements</span> <span class=\"title\">Comparable</span>&lt;<span class=\"title\">PriorityLogicWrapper</span>&gt; </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">int</span> priority = <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"keyword\">public</span> Class&lt;? extends BaseApplicationLogic&gt; logicClass = <span class=\"keyword\">null</span>;</div><div class=\"line\">    <span class=\"keyword\">public</span> BaseApplicationLogic instance;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">PriorityLogicWrapper</span><span class=\"params\">(<span class=\"keyword\">int</span> priority, Class&lt;? extends BaseApplicationLogic&gt; logicClass)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">this</span>.priority = priority;</div><div class=\"line\">        <span class=\"keyword\">this</span>.logicClass = logicClass;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">compareTo</span><span class=\"params\">(PriorityLogicWrapper o)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> o.priority - <span class=\"keyword\">this</span>.priority;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>MaApplicationPriorityLogicWrapperBaseApplicationLogic<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MaApplication</span> <span class=\"keyword\">extends</span> <span class=\"title\">Application</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//mLogicListPriorityLogicWrapper</span></div><div class=\"line\">    <span class=\"keyword\">private</span> ArrayList&lt;PriorityLogicWrapper&gt; mLogicList;</div><div class=\"line\">    <span class=\"comment\">//mLogicClassMapPriorityLogicWrapper</span></div><div class=\"line\">    <span class=\"keyword\">private</span> HashMap&lt;String, ArrayList&lt;PriorityLogicWrapper&gt;&gt; mLogicClassMap;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onCreate</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>.onCreate();</div><div class=\"line\">        init();</div><div class=\"line\">        initializeLogic();</div><div class=\"line\">        dispatchLogic();</div><div class=\"line\">        instantiateLogic();</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != mLogicList &amp;&amp; mLogicList.size() &gt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">for</span> (PriorityLogicWrapper priorityLogicWrapper : mLogicList) &#123;</div><div class=\"line\">                <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != priorityLogicWrapper &amp;&amp; <span class=\"keyword\">null</span> != priorityLogicWrapper.instance) &#123;</div><div class=\"line\">                    <span class=\"comment\">//BaseApplicationLogiconCreate()</span></div><div class=\"line\">                    priorityLogicWrapper.instance.onCreate();</div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        mLogicClassMap = <span class=\"keyword\">new</span> HashMap&lt;&gt;();</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"keyword\">boolean</span> <span class=\"title\">needMultipleProcess</span><span class=\"params\">()</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//MaApplicationregisterApplicationLogic()</span></div><div class=\"line\">    <span class=\"comment\">//BaseApplicationLogic</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">initializeLogic</span><span class=\"params\">()</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">/**</span></div><div class=\"line\">     * BaseApplicationLogicHashMap</div><div class=\"line\">     * <span class=\"doctag\">@param</span> processName </div><div class=\"line\">     * <span class=\"doctag\">@param</span> priority </div><div class=\"line\">     * <span class=\"doctag\">@param</span> logicClass BaseApplicationLogic</div><div class=\"line\">     * <span class=\"doctag\">@return</span></div><div class=\"line\">     */</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">boolean</span> <span class=\"title\">registerApplicationLogic</span><span class=\"params\">(String processName, <span class=\"keyword\">int</span> priority, @NonNull Class&lt;? extends BaseApplicationLogic&gt; logicClass)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">boolean</span> result = <span class=\"keyword\">false</span>;</div><div class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != mLogicClassMap) &#123;</div><div class=\"line\">            ArrayList&lt;PriorityLogicWrapper&gt; tempList = mLogicClassMap.get(processName);</div><div class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> == tempList) &#123;</div><div class=\"line\">                tempList = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</div><div class=\"line\">                mLogicClassMap.put(processName, tempList);</div><div class=\"line\">            &#125;</div><div class=\"line\">            <span class=\"keyword\">if</span> (tempList.size() &gt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">                <span class=\"keyword\">for</span> (PriorityLogicWrapper priorityLogicWrapper : tempList) &#123;</div><div class=\"line\">                    <span class=\"keyword\">if</span> (logicClass.getName().equals(priorityLogicWrapper.logicClass.getName())) &#123;</div><div class=\"line\">                        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> RuntimeException(logicClass.getName() + <span class=\"string\">\" has registered.\"</span>);</div><div class=\"line\">                    &#125;</div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">            PriorityLogicWrapper priorityLogicWrapper = <span class=\"keyword\">new</span> PriorityLogicWrapper(priority, logicClass);</div><div class=\"line\">            tempList.add(priorityLogicWrapper);</div><div class=\"line\">            <span class=\"comment\">//tempListmLogicClassMapvaluemLogicClassMap.put</span></div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">return</span> result;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">/**</span></div><div class=\"line\">     * ArrayListPriorityLogicWrapper</div><div class=\"line\">     */</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">dispatchLogic</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != mLogicClassMap) &#123;</div><div class=\"line\">            <span class=\"comment\">//ArrayList&lt;PriorityLogicWrapper&gt;</span></div><div class=\"line\">            mLogicList = mLogicClassMap.get(ProcessUtil.getProcessName(<span class=\"keyword\">this</span>, ProcessUtil.getMyProcessId()));</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">/**</span></div><div class=\"line\">     * mLogicListPriorityLogicWrapperBaseApplicationLogic</div><div class=\"line\">     */</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">instantiateLogic</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != mLogicList &amp;&amp; mLogicList.size() &gt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != mLogicList &amp;&amp; mLogicList.size() &gt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">                Collections.sort(mLogicList); <span class=\"comment\">//</span></div><div class=\"line\">                <span class=\"keyword\">for</span> (PriorityLogicWrapper priorityLogicWrapper : mLogicList) &#123;</div><div class=\"line\">                    <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != priorityLogicWrapper) &#123;</div><div class=\"line\">                        <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">                            <span class=\"comment\">/**</span></div><div class=\"line\">                             * Class.newInstance()ClassAndroid</div><div class=\"line\">                             * **/</div><div class=\"line\">                            priorityLogicWrapper.instance = priorityLogicWrapper.logicClass.newInstance();</div><div class=\"line\">                        &#125; <span class=\"keyword\">catch</span> (InstantiationException e) &#123;</div><div class=\"line\">                            e.printStackTrace();</div><div class=\"line\">                        &#125; <span class=\"keyword\">catch</span> (IllegalAccessException e) &#123;</div><div class=\"line\">                            e.printStackTrace();</div><div class=\"line\">                        &#125;</div><div class=\"line\">                        <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != priorityLogicWrapper.instance) &#123;</div><div class=\"line\">                            priorityLogicWrapper.instance.setApplication(<span class=\"keyword\">this</span>);</div><div class=\"line\">                        &#125;</div><div class=\"line\">                    &#125;</div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//Application</span></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onTerminate</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>.onTerminate();</div><div class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != mLogicList &amp;&amp; mLogicList.size() &gt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">for</span> (PriorityLogicWrapper priorityLogicWrapper : mLogicList) &#123;</div><div class=\"line\">                <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != priorityLogicWrapper &amp;&amp; <span class=\"keyword\">null</span> != priorityLogicWrapper.instance) &#123;</div><div class=\"line\">                    priorityLogicWrapper.instance.onTerminate();</div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onLowMemory</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>.onLowMemory();</div><div class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != mLogicList &amp;&amp; mLogicList.size() &gt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">for</span> (PriorityLogicWrapper priorityLogicWrapper : mLogicList) &#123;</div><div class=\"line\">                <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != priorityLogicWrapper &amp;&amp; <span class=\"keyword\">null</span> != priorityLogicWrapper.instance) &#123;</div><div class=\"line\">                    priorityLogicWrapper.instance.onLowMemory();</div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onTrimMemory</span><span class=\"params\">(<span class=\"keyword\">int</span> level)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>.onTrimMemory(level);</div><div class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != mLogicList &amp;&amp; mLogicList.size() &gt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">for</span> (PriorityLogicWrapper priorityLogicWrapper : mLogicList) &#123;</div><div class=\"line\">                <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != priorityLogicWrapper &amp;&amp; <span class=\"keyword\">null</span> != priorityLogicWrapper.instance) &#123;</div><div class=\"line\">                    priorityLogicWrapper.instance.onTrimMemory(level);</div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onConfigurationChanged</span><span class=\"params\">(Configuration newConfig)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>.onConfigurationChanged(newConfig);</div><div class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != mLogicList &amp;&amp; mLogicList.size() &gt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">for</span> (PriorityLogicWrapper priorityLogicWrapper : mLogicList) &#123;</div><div class=\"line\">                <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != priorityLogicWrapper &amp;&amp; <span class=\"keyword\">null</span> != priorityLogicWrapper.instance) &#123;</div><div class=\"line\">                    priorityLogicWrapper.instance.onConfigurationChanged(newConfig);</div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/02/21/Multi-Process-Dispatch/\">http://agehua.github.io/2017/02/21/Multi-Process-Dispatch/</a></p>\n","readingTime":{"text":"6 min read","minutes":5.77,"time":346200,"words":1154},"excerpt":"<blockquote>\n<p><a href=\"http://blog.spinytech.com/2016/12/28/android_modularization/\">Android()</a>AndroidApplication</p>\n</blockquote>\n<hr>\n<h3 id=\"Android\"><a href=\"#Android\" class=\"headerlink\" title=\"Android\"></a>Android</h3><p>AndroidAndroidManifestandroid:process</p>\n<p>ApplicationonCreateonCreate</p>\n<h3 id=\"ApplicationonCreate\"><a href=\"#ApplicationonCreate\" class=\"headerlink\" title=\"ApplicationonCreate\"></a>ApplicationonCreate</h3><p><br>","more":"</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>ApplicationonCreate</p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onCreate</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>.onCreate();</div><div class=\"line\">    String processName = getProcessName(<span class=\"keyword\">this</span>, android.os.Process.myPid());</div><div class=\"line\">    <span class=\"keyword\">if</span> (processName != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">    <span class=\"keyword\">boolean</span> defaultProcess = processName.equals(Constants.REAL_PACKAGE_NAME);</div><div class=\"line\">    <span class=\"comment\">// </span></div><div class=\"line\">    <span class=\"keyword\">if</span> (defaultProcess) &#123;</div><div class=\"line\">\t    initAppForMainProcess();</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"comment\">// </span></div><div class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (processName.contains(<span class=\"string\">\":webbrowser\"</span>)) &#123;</div><div class=\"line\"></div><div class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (processName.contains(<span class=\"string\">\":bgmusic\"</span>)) &#123;</div><div class=\"line\"></div><div class=\"line\">    &#125;  </div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</div><div class=\"line\"> * <span class=\"doctag\">@return</span> null may be returned if the specified process not found</div><div class=\"line\"> */</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">getProcessName</span><span class=\"params\">(Context cxt, <span class=\"keyword\">int</span> pid)</span> </span>&#123;</div><div class=\"line\">    ActivityManager am = (ActivityManager) cxt.getSystemService(Context.ACTIVITY_SERVICE);</div><div class=\"line\">    List&lt;RunningAppP.rocessInfo&gt; runningApps = am.getRunningAppProcesses();</div><div class=\"line\">    <span class=\"keyword\">if</span> (runningApps == <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">for</span> (RunningAppProcessInfo procInfo : runningApps) &#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (procInfo.pid == pid) &#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> procInfo.processName;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h4 id=\"Application\"><a href=\"#Application\" class=\"headerlink\" title=\"Application\"></a>Application</h4><p><a href=\"http://blog.spinytech.com/2016/12/28/android_modularization/\">Android()</a></p>\n<p>3</p>\n<ul>\n<li>MaApplicationApplication</li>\n<li>BaseApplicationLogicApplication</li>\n<li>PriorityLogicWrapperComparableBaseApplicationLogicBaseApplicationLogic</li>\n</ul>\n<p>ApplicationLogicMaApplication<br>MaApplicationApplicationLogic<br>ApplicationLogic<br>ApplicationLogiconCreateApplicationLogicApplicationonTerminateonLowMemoryonTrimMemoryonConfigurationChangedonCreate</p>\n<p><br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/multi-Application-flow-chart.png\" alt=\"Application\"></p>\n<p>BaseApplicationLogic</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BaseApplicationLogic</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">protected</span> MaApplication mApplication;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">BaseApplicationLogic</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setApplication</span><span class=\"params\">(@NonNull MaApplication application)</span> </span>&#123;</div><div class=\"line\">        mApplication = application;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onCreate</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onTerminate</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onLowMemory</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onTrimMemory</span><span class=\"params\">(<span class=\"keyword\">int</span> level)</span> </span>&#123;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onConfigurationChanged</span><span class=\"params\">(Configuration newConfig)</span> </span>&#123;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>PriorityLogicWrapperBaseApplicationLogic<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">PriorityLogicWrapper</span> <span class=\"keyword\">implements</span> <span class=\"title\">Comparable</span>&lt;<span class=\"title\">PriorityLogicWrapper</span>&gt; </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">int</span> priority = <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"keyword\">public</span> Class&lt;? extends BaseApplicationLogic&gt; logicClass = <span class=\"keyword\">null</span>;</div><div class=\"line\">    <span class=\"keyword\">public</span> BaseApplicationLogic instance;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">PriorityLogicWrapper</span><span class=\"params\">(<span class=\"keyword\">int</span> priority, Class&lt;? extends BaseApplicationLogic&gt; logicClass)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">this</span>.priority = priority;</div><div class=\"line\">        <span class=\"keyword\">this</span>.logicClass = logicClass;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">compareTo</span><span class=\"params\">(PriorityLogicWrapper o)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> o.priority - <span class=\"keyword\">this</span>.priority;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>MaApplicationPriorityLogicWrapperBaseApplicationLogic<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MaApplication</span> <span class=\"keyword\">extends</span> <span class=\"title\">Application</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//mLogicListPriorityLogicWrapper</span></div><div class=\"line\">    <span class=\"keyword\">private</span> ArrayList&lt;PriorityLogicWrapper&gt; mLogicList;</div><div class=\"line\">    <span class=\"comment\">//mLogicClassMapPriorityLogicWrapper</span></div><div class=\"line\">    <span class=\"keyword\">private</span> HashMap&lt;String, ArrayList&lt;PriorityLogicWrapper&gt;&gt; mLogicClassMap;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onCreate</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>.onCreate();</div><div class=\"line\">        init();</div><div class=\"line\">        initializeLogic();</div><div class=\"line\">        dispatchLogic();</div><div class=\"line\">        instantiateLogic();</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != mLogicList &amp;&amp; mLogicList.size() &gt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">for</span> (PriorityLogicWrapper priorityLogicWrapper : mLogicList) &#123;</div><div class=\"line\">                <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != priorityLogicWrapper &amp;&amp; <span class=\"keyword\">null</span> != priorityLogicWrapper.instance) &#123;</div><div class=\"line\">                    <span class=\"comment\">//BaseApplicationLogiconCreate()</span></div><div class=\"line\">                    priorityLogicWrapper.instance.onCreate();</div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        mLogicClassMap = <span class=\"keyword\">new</span> HashMap&lt;&gt;();</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"keyword\">boolean</span> <span class=\"title\">needMultipleProcess</span><span class=\"params\">()</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//MaApplicationregisterApplicationLogic()</span></div><div class=\"line\">    <span class=\"comment\">//BaseApplicationLogic</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">initializeLogic</span><span class=\"params\">()</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">/**</div><div class=\"line\">     * BaseApplicationLogicHashMap</div><div class=\"line\">     * <span class=\"doctag\">@param</span> processName </div><div class=\"line\">     * <span class=\"doctag\">@param</span> priority </div><div class=\"line\">     * <span class=\"doctag\">@param</span> logicClass BaseApplicationLogic</div><div class=\"line\">     * <span class=\"doctag\">@return</span></div><div class=\"line\">     */</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">boolean</span> <span class=\"title\">registerApplicationLogic</span><span class=\"params\">(String processName, <span class=\"keyword\">int</span> priority, @NonNull Class&lt;? extends BaseApplicationLogic&gt; logicClass)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">boolean</span> result = <span class=\"keyword\">false</span>;</div><div class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != mLogicClassMap) &#123;</div><div class=\"line\">            ArrayList&lt;PriorityLogicWrapper&gt; tempList = mLogicClassMap.get(processName);</div><div class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> == tempList) &#123;</div><div class=\"line\">                tempList = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</div><div class=\"line\">                mLogicClassMap.put(processName, tempList);</div><div class=\"line\">            &#125;</div><div class=\"line\">            <span class=\"keyword\">if</span> (tempList.size() &gt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">                <span class=\"keyword\">for</span> (PriorityLogicWrapper priorityLogicWrapper : tempList) &#123;</div><div class=\"line\">                    <span class=\"keyword\">if</span> (logicClass.getName().equals(priorityLogicWrapper.logicClass.getName())) &#123;</div><div class=\"line\">                        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> RuntimeException(logicClass.getName() + <span class=\"string\">\" has registered.\"</span>);</div><div class=\"line\">                    &#125;</div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">            PriorityLogicWrapper priorityLogicWrapper = <span class=\"keyword\">new</span> PriorityLogicWrapper(priority, logicClass);</div><div class=\"line\">            tempList.add(priorityLogicWrapper);</div><div class=\"line\">            <span class=\"comment\">//tempListmLogicClassMapvaluemLogicClassMap.put</span></div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">return</span> result;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">/**</div><div class=\"line\">     * ArrayListPriorityLogicWrapper</div><div class=\"line\">     */</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">dispatchLogic</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != mLogicClassMap) &#123;</div><div class=\"line\">            <span class=\"comment\">//ArrayList&lt;PriorityLogicWrapper&gt;</span></div><div class=\"line\">            mLogicList = mLogicClassMap.get(ProcessUtil.getProcessName(<span class=\"keyword\">this</span>, ProcessUtil.getMyProcessId()));</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">/**</div><div class=\"line\">     * mLogicListPriorityLogicWrapperBaseApplicationLogic</div><div class=\"line\">     */</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">instantiateLogic</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != mLogicList &amp;&amp; mLogicList.size() &gt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != mLogicList &amp;&amp; mLogicList.size() &gt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">                Collections.sort(mLogicList); <span class=\"comment\">//</span></div><div class=\"line\">                <span class=\"keyword\">for</span> (PriorityLogicWrapper priorityLogicWrapper : mLogicList) &#123;</div><div class=\"line\">                    <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != priorityLogicWrapper) &#123;</div><div class=\"line\">                        <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">                            <span class=\"comment\">/**</div><div class=\"line\">                             * Class.newInstance()ClassAndroid</div><div class=\"line\">                             * **/</span></div><div class=\"line\">                            priorityLogicWrapper.instance = priorityLogicWrapper.logicClass.newInstance();</div><div class=\"line\">                        &#125; <span class=\"keyword\">catch</span> (InstantiationException e) &#123;</div><div class=\"line\">                            e.printStackTrace();</div><div class=\"line\">                        &#125; <span class=\"keyword\">catch</span> (IllegalAccessException e) &#123;</div><div class=\"line\">                            e.printStackTrace();</div><div class=\"line\">                        &#125;</div><div class=\"line\">                        <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != priorityLogicWrapper.instance) &#123;</div><div class=\"line\">                            priorityLogicWrapper.instance.setApplication(<span class=\"keyword\">this</span>);</div><div class=\"line\">                        &#125;</div><div class=\"line\">                    &#125;</div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//Application</span></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onTerminate</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>.onTerminate();</div><div class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != mLogicList &amp;&amp; mLogicList.size() &gt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">for</span> (PriorityLogicWrapper priorityLogicWrapper : mLogicList) &#123;</div><div class=\"line\">                <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != priorityLogicWrapper &amp;&amp; <span class=\"keyword\">null</span> != priorityLogicWrapper.instance) &#123;</div><div class=\"line\">                    priorityLogicWrapper.instance.onTerminate();</div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onLowMemory</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>.onLowMemory();</div><div class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != mLogicList &amp;&amp; mLogicList.size() &gt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">for</span> (PriorityLogicWrapper priorityLogicWrapper : mLogicList) &#123;</div><div class=\"line\">                <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != priorityLogicWrapper &amp;&amp; <span class=\"keyword\">null</span> != priorityLogicWrapper.instance) &#123;</div><div class=\"line\">                    priorityLogicWrapper.instance.onLowMemory();</div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onTrimMemory</span><span class=\"params\">(<span class=\"keyword\">int</span> level)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>.onTrimMemory(level);</div><div class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != mLogicList &amp;&amp; mLogicList.size() &gt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">for</span> (PriorityLogicWrapper priorityLogicWrapper : mLogicList) &#123;</div><div class=\"line\">                <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != priorityLogicWrapper &amp;&amp; <span class=\"keyword\">null</span> != priorityLogicWrapper.instance) &#123;</div><div class=\"line\">                    priorityLogicWrapper.instance.onTrimMemory(level);</div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onConfigurationChanged</span><span class=\"params\">(Configuration newConfig)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>.onConfigurationChanged(newConfig);</div><div class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != mLogicList &amp;&amp; mLogicList.size() &gt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">for</span> (PriorityLogicWrapper priorityLogicWrapper : mLogicList) &#123;</div><div class=\"line\">                <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != priorityLogicWrapper &amp;&amp; <span class=\"keyword\">null</span> != priorityLogicWrapper.instance) &#123;</div><div class=\"line\">                    priorityLogicWrapper.instance.onConfigurationChanged(newConfig);</div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/02/21/Multi-Process-Dispatch/\">http://agehua.github.io/2017/02/21/Multi-Process-Dispatch/</a></p>"},{"layout":"post","title":"linux(centos) SVN","keywords":"linux, svn","banner":"http://obxk8w81b.bkt.clouddn.com/Bank%20of%20the%20Oise%20at%20Auvers.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Bank%20of%20the%20Oise%20at%20Auvers.jpg","toc":true,"_content":"\n### linux(centos) SVN\n\n\n\n#### SVN\n~~~ Java\nyum install subversion\n~~~\n#### SVN\n~~~ Java\nmkdir -p /var/svn/svnrepos\n~~~\n#### \n<!--more-->\n~~~ Java\nsvnadmin create /var/svn/svnrepos\n~~~\n#### confSVN\n\nauthz\npasswd\nsvnserve.confSVN\n\n#### svnserve.conf\n\nvi svnserve.conf\n\n~~~ Java\nanon-access = read #\nauth-access = write #\npassword-db = passwd #\nauthz-db = authz #\nrealm = /var/svn/svnrepos # \n~~~\n\n> svnserve.confpasswdauthz\n\n#### \n~~~ Java\nvi passwd\n~~~\n[users]=binjoo = 123456\n\n~~~ Java\n[users]\nbinjoo = 123456\n~~~\n#### \n\n~~~ Java\nvi authz\n~~~\n\n\n~~~ Java\n[groups]\n[/]\nbinjoo=rw\n~~~\nbinjoo\n\n#### svn\n~~~ Java\nsvnserve -d -r /var/svn/svnrepos\n~~~\nsvn://127.0.0.1\n\n### \n svn merge svn: E220001: \n\n : SVN  : Unreadable path encountered; access denied;\n\nmerge. GOOGLE\n\n.\n\nconf/svnserve.conf ,  anon-access = none . Subversion.\n\nSVN,  ->->  .\n\n### linux svn\n- 1SVN\n~~~ Java\nsudo svnserve -d -r /var/svn/svnrepos\n~~~\n -d  -r \n/var/svn/svnrepos  svn\n\n\n- 2SVN\nlinux\n~~~ Java\nps -ef|grep svnserve\nroot      4967     1  0 Aug23 ?        00:00:00 svnserve -d -r repository/  \n~~~\n  kill -9 4967 4967\n","source":"_posts/2017-03-20-SVN-server-linux.md","raw":"---\nlayout: post\ntitle:  linux(centos) SVN\ncategory: accumulation\ntags:\n  - svn server\n  - linux\nkeywords: linux, svn\nbanner: http://obxk8w81b.bkt.clouddn.com/Bank%20of%20the%20Oise%20at%20Auvers.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Bank%20of%20the%20Oise%20at%20Auvers.jpg\ntoc: true\n---\n\n### linux(centos) SVN\n\n\n\n#### SVN\n~~~ Java\nyum install subversion\n~~~\n#### SVN\n~~~ Java\nmkdir -p /var/svn/svnrepos\n~~~\n#### \n<!--more-->\n~~~ Java\nsvnadmin create /var/svn/svnrepos\n~~~\n#### confSVN\n\nauthz\npasswd\nsvnserve.confSVN\n\n#### svnserve.conf\n\nvi svnserve.conf\n\n~~~ Java\nanon-access = read #\nauth-access = write #\npassword-db = passwd #\nauthz-db = authz #\nrealm = /var/svn/svnrepos # \n~~~\n\n> svnserve.confpasswdauthz\n\n#### \n~~~ Java\nvi passwd\n~~~\n[users]=binjoo = 123456\n\n~~~ Java\n[users]\nbinjoo = 123456\n~~~\n#### \n\n~~~ Java\nvi authz\n~~~\n\n\n~~~ Java\n[groups]\n[/]\nbinjoo=rw\n~~~\nbinjoo\n\n#### svn\n~~~ Java\nsvnserve -d -r /var/svn/svnrepos\n~~~\nsvn://127.0.0.1\n\n### \n svn merge svn: E220001: \n\n : SVN  : Unreadable path encountered; access denied;\n\nmerge. GOOGLE\n\n.\n\nconf/svnserve.conf ,  anon-access = none . Subversion.\n\nSVN,  ->->  .\n\n### linux svn\n- 1SVN\n~~~ Java\nsudo svnserve -d -r /var/svn/svnrepos\n~~~\n -d  -r \n/var/svn/svnrepos  svn\n\n\n- 2SVN\nlinux\n~~~ Java\nps -ef|grep svnserve\nroot      4967     1  0 Aug23 ?        00:00:00 svnserve -d -r repository/  \n~~~\n  kill -9 4967 4967\n","slug":"SVN-server-linux","published":1,"date":"2017-03-19T16:00:00.000Z","updated":"2017-11-23T07:14:05.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ec0e002ud6ykymgkb06s","content":"<h3 id=\"linux-centos-SVN\"><a href=\"#linux-centos-SVN\" class=\"headerlink\" title=\"linux(centos) SVN\"></a>linux(centos) SVN</h3><p></p>\n<h4 id=\"SVN\"><a href=\"#SVN\" class=\"headerlink\" title=\"SVN\"></a>SVN</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">yum install subversion</div></pre></td></tr></table></figure>\n<h4 id=\"SVN\"><a href=\"#SVN\" class=\"headerlink\" title=\"SVN\"></a>SVN</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">mkdir -p /var/svn/svnrepos</div></pre></td></tr></table></figure>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><a id=\"more\"></a>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">svnadmin create /var/svn/svnrepos</div></pre></td></tr></table></figure>\n<h4 id=\"confSVN\"><a href=\"#confSVN\" class=\"headerlink\" title=\"confSVN\"></a>confSVN</h4><p>authz<br>passwd<br>svnserve.confSVN</p>\n<h4 id=\"svnserve-conf\"><a href=\"#svnserve-conf\" class=\"headerlink\" title=\"svnserve.conf\"></a>svnserve.conf</h4><p>vi svnserve.conf</p>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><div class=\"line\">anon-access = read #</div><div class=\"line\">auth-access = write #</div><div class=\"line\">password-db = passwd #</div><div class=\"line\">authz-db = authz #</div><div class=\"line\">realm = /var/svn/svnrepos # </div></pre></td></tr></table></figure>\n<blockquote>\n<p>svnserve.confpasswdauthz</p>\n</blockquote>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">vi passwd</div></pre></td></tr></table></figure>\n<p>[users]=binjoo = 123456</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">[users]</div><div class=\"line\">binjoo = <span class=\"number\">123456</span></div></pre></td></tr></table></figure>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">vi authz</div></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">[groups]</div><div class=\"line\">[/]</div><div class=\"line\">binjoo=rw</div></pre></td></tr></table></figure>\n<p>binjoo</p>\n<h4 id=\"svn\"><a href=\"#svn\" class=\"headerlink\" title=\"svn\"></a>svn</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">svnserve -d -r /var/svn/svnrepos</div></pre></td></tr></table></figure>\n<p>svn://127.0.0.1</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> svn merge svn: E220001: </p>\n<p> : SVN  : Unreadable path encountered; access denied;</p>\n<p>merge. GOOGLE</p>\n<p>.</p>\n<p>conf/svnserve.conf ,  anon-access = none . Subversion.</p>\n<p>SVN,  -&gt;-&gt;  .</p>\n<h3 id=\"linux-svn\"><a href=\"#linux-svn\" class=\"headerlink\" title=\"linux svn\"></a>linux svn</h3><ul>\n<li>1SVN<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">sudo svnserve -d -r /var/svn/svnrepos</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<p> -d  -r <br>/var/svn/svnrepos  svn</p>\n<ul>\n<li>2SVN<br>linux<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">ps -ef|grep svnserve</div><div class=\"line\">root      <span class=\"number\">4967</span>     <span class=\"number\">1</span>  <span class=\"number\">0</span> Aug23 ?        <span class=\"number\">00</span>:<span class=\"number\">00</span>:<span class=\"number\">00</span> svnserve -d -r repository/</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>  kill -9 4967 4967</p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/03/20/SVN-server-linux/\">http://agehua.github.io/2017/03/20/SVN-server-linux/</a></p>\n","readingTime":{"text":"2 min read","minutes":1.095,"time":65700,"words":219},"excerpt":"<h3 id=\"linux-centos-SVN\"><a href=\"#linux-centos-SVN\" class=\"headerlink\" title=\"linux(centos) SVN\"></a>linux(centos) SVN</h3><p></p>\n<h4 id=\"SVN\"><a href=\"#SVN\" class=\"headerlink\" title=\"SVN\"></a>SVN</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">yum install subversion</div></pre></td></tr></table></figure>\n<h4 id=\"SVN\"><a href=\"#SVN\" class=\"headerlink\" title=\"SVN\"></a>SVN</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">mkdir -p /var/svn/svnrepos</div></pre></td></tr></table></figure>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4>","more":"<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">svnadmin create /var/svn/svnrepos</div></pre></td></tr></table></figure>\n<h4 id=\"confSVN\"><a href=\"#confSVN\" class=\"headerlink\" title=\"confSVN\"></a>confSVN</h4><p>authz<br>passwd<br>svnserve.confSVN</p>\n<h4 id=\"svnserve-conf\"><a href=\"#svnserve-conf\" class=\"headerlink\" title=\"svnserve.conf\"></a>svnserve.conf</h4><p>vi svnserve.conf</p>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><div class=\"line\">anon-access = read #</div><div class=\"line\">auth-access = write #</div><div class=\"line\">password-db = passwd #</div><div class=\"line\">authz-db = authz #</div><div class=\"line\">realm = /var/svn/svnrepos # </div></pre></td></tr></table></figure>\n<blockquote>\n<p>svnserve.confpasswdauthz</p>\n</blockquote>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">vi passwd</div></pre></td></tr></table></figure>\n<p>[users]=binjoo = 123456</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">[users]</div><div class=\"line\">binjoo = <span class=\"number\">123456</span></div></pre></td></tr></table></figure>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">vi authz</div></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">[groups]</div><div class=\"line\">[/]</div><div class=\"line\">binjoo=rw</div></pre></td></tr></table></figure>\n<p>binjoo</p>\n<h4 id=\"svn\"><a href=\"#svn\" class=\"headerlink\" title=\"svn\"></a>svn</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">svnserve -d -r /var/svn/svnrepos</div></pre></td></tr></table></figure>\n<p>svn://127.0.0.1</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> svn merge svn: E220001: </p>\n<p> : SVN  : Unreadable path encountered; access denied;</p>\n<p>merge. GOOGLE</p>\n<p>.</p>\n<p>conf/svnserve.conf ,  anon-access = none . Subversion.</p>\n<p>SVN,  -&gt;-&gt;  .</p>\n<h3 id=\"linux-svn\"><a href=\"#linux-svn\" class=\"headerlink\" title=\"linux svn\"></a>linux svn</h3><ul>\n<li>1SVN<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">sudo svnserve -d -r /var/svn/svnrepos</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<p> -d  -r <br>/var/svn/svnrepos  svn</p>\n<ul>\n<li>2SVN<br>linux<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">ps -ef|grep svnserve</div><div class=\"line\">root      <span class=\"number\">4967</span>     <span class=\"number\">1</span>  <span class=\"number\">0</span> Aug23 ?        <span class=\"number\">00</span>:<span class=\"number\">00</span>:<span class=\"number\">00</span> svnserve -d -r repository/</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>  kill -9 4967 4967</p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/03/20/SVN-server-linux/\">http://agehua.github.io/2017/03/20/SVN-server-linux/</a></p>"},{"layout":"post","title":"HTTPS","keywords":"http, https","banner":"http://obxk8w81b.bkt.clouddn.com/Auvers%20Town%20Hall%20on%2014%20July%201890.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Auvers%20Town%20Hall%20on%2014%20July%201890.jpg","toc":true,"_content":"\n> [HTTPS (: Bugly)](http://bugly.qq.com/bbs/forum.php?mod=viewthread&tid=1074)\n\n------\n\n### \n\n HTTPS \n\nHTTPSHTTPSHTTPSHTTP HTTP+S S  TLS SSLHTTP+Security HTTPS  HTTP \n\n<!--more-->\n TA  TCP/IP \n\n- \n- \n- \n- \n- \n\n\n\n\n TA HTTP  TA  TA  OK \n\n\n\n\n HTTP ****\n\n### \nHTTPS  AES\n\n key \n\nAES  key \n key  AES TA  key  key TA\n\n key  key  TA \n\n****key1  key2 key1 key1  key2  key2 key2  key1 \n\nRSA\n------\n> 210\n\n\n RSA  k1  k2\n-  k1 k1  k2  k2 \n- k1 AES key k1  key \n-  k2  key  key~\n\n\n AES  key \n------\n> \n\n\n\n\n A BM\n\n\n------\n B M B key k1  key \n B  M \nM  B  B  A \nA1->M()->B(2) M AB\n\n HTTPS \n------\n\n **CACertificate Authority**CACACA\n\nWindowsMacLinuxChromeSafari CA CA\nCACACACA\n\n\n### \n HTTP SSecurity ** +  + CA**  HTTPS  HTTPS \n HTTPS  SSL 1.0 SSL 3.0 TLS 1.0  TLS 1.3\nTLS  SSL \n","source":"_posts/2017-03-09-Https-Questions.md","raw":"---\nlayout: post\ntitle:  HTTPS\ncategory: accumulation\ntags:\n  - HTTPS\nkeywords: http, https\nbanner: http://obxk8w81b.bkt.clouddn.com/Auvers%20Town%20Hall%20on%2014%20July%201890.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Auvers%20Town%20Hall%20on%2014%20July%201890.jpg\ntoc: true\n---\n\n> [HTTPS (: Bugly)](http://bugly.qq.com/bbs/forum.php?mod=viewthread&tid=1074)\n\n------\n\n### \n\n HTTPS \n\nHTTPSHTTPSHTTPSHTTP HTTP+S S  TLS SSLHTTP+Security HTTPS  HTTP \n\n<!--more-->\n TA  TCP/IP \n\n- \n- \n- \n- \n- \n\n\n\n\n TA HTTP  TA  TA  OK \n\n\n\n\n HTTP ****\n\n### \nHTTPS  AES\n\n key \n\nAES  key \n key  AES TA  key  key TA\n\n key  key  TA \n\n****key1  key2 key1 key1  key2  key2 key2  key1 \n\nRSA\n------\n> 210\n\n\n RSA  k1  k2\n-  k1 k1  k2  k2 \n- k1 AES key k1  key \n-  k2  key  key~\n\n\n AES  key \n------\n> \n\n\n\n\n A BM\n\n\n------\n B M B key k1  key \n B  M \nM  B  B  A \nA1->M()->B(2) M AB\n\n HTTPS \n------\n\n **CACertificate Authority**CACACA\n\nWindowsMacLinuxChromeSafari CA CA\nCACACACA\n\n\n### \n HTTP SSecurity ** +  + CA**  HTTPS  HTTPS \n HTTPS  SSL 1.0 SSL 3.0 TLS 1.0  TLS 1.3\nTLS  SSL \n","slug":"Https-Questions","published":1,"date":"2017-03-08T16:00:00.000Z","updated":"2017-11-23T07:13:29.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ec0i002xd6yke6k9n32i","content":"<blockquote>\n<p><a href=\"http://bugly.qq.com/bbs/forum.php?mod=viewthread&amp;tid=1074\" target=\"_blank\" rel=\"external\">HTTPS (: Bugly)</a></p>\n</blockquote>\n<hr>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> HTTPS </p>\n<p>HTTPSHTTPSHTTPSHTTP HTTP+S S  TLS SSLHTTP+Security HTTPS  HTTP </p>\n<a id=\"more\"></a>\n<p> TA  TCP/IP </p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p></p>\n<p> TA HTTP  TA  TA  OK </p>\n<p></p>\n<p> HTTP <strong></strong></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>HTTPS  AES</p>\n<p> key </p>\n<p>AES  key <br> key  AES TA  key  key TA</p>\n<p> key  key  TA </p>\n<p><strong></strong>key1  key2 key1 key1  key2  key2 key2  key1 </p>\n<h2 id=\"RSA\"><a href=\"#RSA\" class=\"headerlink\" title=\"RSA\"></a>RSA</h2><blockquote>\n<p>210<br></p>\n</blockquote>\n<p> RSA  k1  k2</p>\n<ul>\n<li> k1 k1  k2  k2 </li>\n<li>k1 AES key k1  key </li>\n<li> k2  key  key~</li>\n</ul>\n<h2 id=\"-AES--key-\"><a href=\"#-AES--key-\" class=\"headerlink\" title=\" AES  key \"></a> AES  key </h2><blockquote>\n<p><br><br></p>\n</blockquote>\n<p> A BM</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> B M B key k1  key <br> B  M <br>M  B  B  A <br>A1-&gt;M()-&gt;B(2) M AB</p>\n<h2 id=\"-HTTPS-\"><a href=\"#-HTTPS-\" class=\"headerlink\" title=\" HTTPS \"></a> HTTPS </h2><p><br> <strong>CACertificate Authority</strong>CACACA</p>\n<p>WindowsMacLinuxChromeSafari CA CA<br>CACACACA</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> HTTP SSecurity <strong> +  + CA</strong>  HTTPS  HTTPS <br> HTTPS  SSL 1.0 SSL 3.0 TLS 1.0  TLS 1.3<br>TLS  SSL </p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/03/09/Https-Questions/\">http://agehua.github.io/2017/03/09/Https-Questions/</a></p>\n","readingTime":{"text":"2 min read","minutes":1.14,"time":68399.99999999999,"words":228},"excerpt":"<blockquote>\n<p><a href=\"http://bugly.qq.com/bbs/forum.php?mod=viewthread&amp;tid=1074\">HTTPS (: Bugly)</a></p>\n</blockquote>\n<hr>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> HTTPS </p>\n<p>HTTPSHTTPSHTTPSHTTP HTTP+S S  TLS SSLHTTP+Security HTTPS  HTTP </p>","more":"<p> TA  TCP/IP </p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p></p>\n<p> TA HTTP  TA  TA  OK </p>\n<p></p>\n<p> HTTP <strong></strong></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>HTTPS  AES</p>\n<p> key </p>\n<p>AES  key <br> key  AES TA  key  key TA</p>\n<p> key  key  TA </p>\n<p><strong></strong>key1  key2 key1 key1  key2  key2 key2  key1 </p>\n<h2 id=\"RSA\"><a href=\"#RSA\" class=\"headerlink\" title=\"RSA\"></a>RSA</h2><blockquote>\n<p>210<br></p>\n</blockquote>\n<p> RSA  k1  k2</p>\n<ul>\n<li> k1 k1  k2  k2 </li>\n<li>k1 AES key k1  key </li>\n<li> k2  key  key~</li>\n</ul>\n<h2 id=\"-AES--key-\"><a href=\"#-AES--key-\" class=\"headerlink\" title=\" AES  key \"></a> AES  key </h2><blockquote>\n<p><br><br></p>\n</blockquote>\n<p> A BM</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> B M B key k1  key <br> B  M <br>M  B  B  A <br>A1-&gt;M()-&gt;B(2) M AB</p>\n<h2 id=\"-HTTPS-\"><a href=\"#-HTTPS-\" class=\"headerlink\" title=\" HTTPS \"></a> HTTPS </h2><p><br> <strong>CACertificate Authority</strong>CACACA</p>\n<p>WindowsMacLinuxChromeSafari CA CA<br>CACACACA</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> HTTP SSecurity <strong> +  + CA</strong>  HTTPS  HTTPS <br> HTTPS  SSL 1.0 SSL 3.0 TLS 1.0  TLS 1.3<br>TLS  SSL </p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/03/09/Https-Questions/\">http://agehua.github.io/2017/03/09/Https-Questions/</a></p>"},{"layout":"post","title":"Injection(CDI)assertion()","keywords":"Injection, assert","banner":"http://obxk8w81b.bkt.clouddn.com/Blossoming%20Acacia%20Branches.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Blossoming%20Acacia%20Branches.jpg","toc":true,"_content":"\n### @InjectCDI\n[Android Support Annotation](https://developer.android.com/reference/android/support/annotation/package-summary.html)\n\nJava\n\nCDIContexts and Dependency Injection \n[Java JSR-330](http://blog.csdn.net/DL88250/article/details/4838803)javax.injectProvider@Scope@Inject@Named@Qualifier\n\n#### @Inject\n@Injectjavax.injectnew :)\n\n##### \n@Injectfinal\n\n<!--more-->\n\ndoc\n\n~~~ Java\nInjectable fields:\n\n  - are annotated with @Inject.\n  - are not final.\n  - may have any otherwise valid name.\n\n@Inject FieldModifiers(opt) Type VariableDeclarators;\n~~~\n\n     (opt)\n\n##### \n@Inject0\n\n[doc](http://docs.oracle.com/javaee/6/api/javax/inject/Inject.html)\n\n~~~ Java\nInjectable methods:\n- are annotated with @Inject.\n- are not abstract.\n- do not declare type parameters of their own.\n- may return a result\n- may have any otherwise valid name.\n- accept zero or more dependencies as arguments.\n\n\n@Inject MethodModifiers(opt) ResultType Identifier(FormalParameterList(opt)) Throws(opt) MethodBody\n~~~\n\n     (opt)\n\n\n\n~~~ Java\n@Inject\nWeatherDao weatherDao;\n~~~\n\n~~~ Java\n@Inject\nWeatherDao(Context context) {\n    this.context = context;\n}\n~~~\n@Inject\nprivate,package-private,protected,public\n\n\n**@Inject@Inject**\n\n@Inject@Named@Qualifier@Provider\n\n#### @Named\n@Named@InjectBean\n\nBean\n~~~ Java\npublic class Car {\n     @Inject @Named(\"driver\") Seat driverSeat;\n     @Inject @Named(\"passenger\") Seat passengerSeat;\n     ...\n}\n~~~\n\n#### @Qualifier\nqualifier\n- @Qualifier@Retention(RUNTIME)@Documented\n- \n- API\n- @Target\n\n[doc](http://docs.oracle.com/javaee/6/api/javax/inject/Qualifier.html)\n~~~ Java\nIdentifies qualifier annotations. Anyone can define a new qualifier. A qualifier annotation:\n\n- is annotated with @Qualifier, @Retention(RUNTIME), and typically @Documented.\n- can have attributes.\n- may be part of the public API, much like the dependency type, but unlike implementation types which needn't be part of the public API.\n- may have restricted usage if annotated with @Target. While this specification covers applying qualifiers to fields and parameters only, some injector configurations might use qualifier annotations in other places (on methods or classes for example).\n~~~\n\n[java doc@Named](http://docs.oracle.com/javaee/6/api/javax/inject/Named.html)\n~~~ Java\n@Qualifier\n@Documented\n@Retention(value=RUNTIME)\npublic @interface Named\n~~~\n\n~~~ Java\n@Documented  \n@Retention(RetentionPolicy.RUNTIME)  \n@Qualifier  \n@Target(value = {ElementType.FIELD, ElementType.PARAMETER, ElementType.TYPE})  \npublic @interface Genre {  \n    User user() default User.STUDENT;  \n    public enum User {STUDENT, TEACHER}  \n}\n~~~\n\n~~~ Java\n@Named  \n@Genre(user = User.STUDENT)  \npublic class StudentDAO implements IUserDAO{  \n    @Override  \n    public int count() {  \n        System.out.println(\"----StudentDAO----\");  \n        return 0;  \n    }  \n}  \n~~~\n\n#### @Provider\n@ProviderT@ProviderT.get()\n\n[doc](http://docs.oracle.com/javaee/6/api/javax/inject/Provider.html):\n~~~ Java\nProvides instances of T. Typically implemented by an injector. For any type T that can be injected, you can also inject Provider<T>. Compared to injecting T directly, injecting Provider<T> enables:\n\n- retrieving multiple instances.\n- lazy or optional retrieval of an instance.\n- breaking circular dependencies.\n- abstracting scope so you can look up an instance in a smaller scope from an instance in a containing scope.\n~~~\n\nFor example:\n~~~ Java\nclass Car {\n@Inject Car(Provider<Seat> seatProvider) {\n   Seat driver = seatProvider.get();\n   Seat passenger = seatProvider.get();\n   ...\n }\n}\n~~~\n\nget\n~~~ Java\nT\tget()\n    Provides a fully-constructed and injected instance of T.\n~~~\n\n#### @Singleton\n\n\n\n\n[doc](http://docs.oracle.com/javaee/6/api/javax/inject/Singleton.html):\n~~~ Java\n@Scope\n@Documented\n@Retention(value=RUNTIME)\npublic @interface Singleton\nIdentifies a type that the injector only instantiates once. Not inherited.\n~~~\n\n\n#### @Scope\n @Scope \n\n @Singleton  Log \n\n~~~ Java\n@Singleton\nclass Log {\n   void log(String message) { ... }\n}\n~~~\n\n\n\n\n\n-  @Scope@Retention(RUNTIME)  @Documented \n- \n-  @Inherited \n-  @Target \n\n @Scope \n\n[doc](http://docs.oracle.com/javaee/6/api/javax/inject/Scope.html)\n\n### assertion()\nassertionbooleanbooleantruefalse\n\n\nassertionJavaassert\n\n~~~ Java\n1.assert expression1;\n\n2.assert expression1: expression2;\n~~~\n\nexpression1booleanexpression2Object\n\n- assertion\n- assertionexpression1\n- falseAssertionError\n- expression1trueexpression2\n\nassertion[](http://blog.csdn.net/ithomer/article/details/9185125)\n","source":"_posts/2017-03-14-JAVA-CDI-Assertion.md","raw":"---\nlayout: post\ntitle:  Injection(CDI)assertion()\ncategory: accumulation\ntags:\n  - Injection\n  - assertion\nkeywords: Injection, assert\nbanner: http://obxk8w81b.bkt.clouddn.com/Blossoming%20Acacia%20Branches.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Blossoming%20Acacia%20Branches.jpg\ntoc: true\n---\n\n### @InjectCDI\n[Android Support Annotation](https://developer.android.com/reference/android/support/annotation/package-summary.html)\n\nJava\n\nCDIContexts and Dependency Injection \n[Java JSR-330](http://blog.csdn.net/DL88250/article/details/4838803)javax.injectProvider@Scope@Inject@Named@Qualifier\n\n#### @Inject\n@Injectjavax.injectnew :)\n\n##### \n@Injectfinal\n\n<!--more-->\n\ndoc\n\n~~~ Java\nInjectable fields:\n\n  - are annotated with @Inject.\n  - are not final.\n  - may have any otherwise valid name.\n\n@Inject FieldModifiers(opt) Type VariableDeclarators;\n~~~\n\n     (opt)\n\n##### \n@Inject0\n\n[doc](http://docs.oracle.com/javaee/6/api/javax/inject/Inject.html)\n\n~~~ Java\nInjectable methods:\n- are annotated with @Inject.\n- are not abstract.\n- do not declare type parameters of their own.\n- may return a result\n- may have any otherwise valid name.\n- accept zero or more dependencies as arguments.\n\n\n@Inject MethodModifiers(opt) ResultType Identifier(FormalParameterList(opt)) Throws(opt) MethodBody\n~~~\n\n     (opt)\n\n\n\n~~~ Java\n@Inject\nWeatherDao weatherDao;\n~~~\n\n~~~ Java\n@Inject\nWeatherDao(Context context) {\n    this.context = context;\n}\n~~~\n@Inject\nprivate,package-private,protected,public\n\n\n**@Inject@Inject**\n\n@Inject@Named@Qualifier@Provider\n\n#### @Named\n@Named@InjectBean\n\nBean\n~~~ Java\npublic class Car {\n     @Inject @Named(\"driver\") Seat driverSeat;\n     @Inject @Named(\"passenger\") Seat passengerSeat;\n     ...\n}\n~~~\n\n#### @Qualifier\nqualifier\n- @Qualifier@Retention(RUNTIME)@Documented\n- \n- API\n- @Target\n\n[doc](http://docs.oracle.com/javaee/6/api/javax/inject/Qualifier.html)\n~~~ Java\nIdentifies qualifier annotations. Anyone can define a new qualifier. A qualifier annotation:\n\n- is annotated with @Qualifier, @Retention(RUNTIME), and typically @Documented.\n- can have attributes.\n- may be part of the public API, much like the dependency type, but unlike implementation types which needn't be part of the public API.\n- may have restricted usage if annotated with @Target. While this specification covers applying qualifiers to fields and parameters only, some injector configurations might use qualifier annotations in other places (on methods or classes for example).\n~~~\n\n[java doc@Named](http://docs.oracle.com/javaee/6/api/javax/inject/Named.html)\n~~~ Java\n@Qualifier\n@Documented\n@Retention(value=RUNTIME)\npublic @interface Named\n~~~\n\n~~~ Java\n@Documented  \n@Retention(RetentionPolicy.RUNTIME)  \n@Qualifier  \n@Target(value = {ElementType.FIELD, ElementType.PARAMETER, ElementType.TYPE})  \npublic @interface Genre {  \n    User user() default User.STUDENT;  \n    public enum User {STUDENT, TEACHER}  \n}\n~~~\n\n~~~ Java\n@Named  \n@Genre(user = User.STUDENT)  \npublic class StudentDAO implements IUserDAO{  \n    @Override  \n    public int count() {  \n        System.out.println(\"----StudentDAO----\");  \n        return 0;  \n    }  \n}  \n~~~\n\n#### @Provider\n@ProviderT@ProviderT.get()\n\n[doc](http://docs.oracle.com/javaee/6/api/javax/inject/Provider.html):\n~~~ Java\nProvides instances of T. Typically implemented by an injector. For any type T that can be injected, you can also inject Provider<T>. Compared to injecting T directly, injecting Provider<T> enables:\n\n- retrieving multiple instances.\n- lazy or optional retrieval of an instance.\n- breaking circular dependencies.\n- abstracting scope so you can look up an instance in a smaller scope from an instance in a containing scope.\n~~~\n\nFor example:\n~~~ Java\nclass Car {\n@Inject Car(Provider<Seat> seatProvider) {\n   Seat driver = seatProvider.get();\n   Seat passenger = seatProvider.get();\n   ...\n }\n}\n~~~\n\nget\n~~~ Java\nT\tget()\n    Provides a fully-constructed and injected instance of T.\n~~~\n\n#### @Singleton\n\n\n\n\n[doc](http://docs.oracle.com/javaee/6/api/javax/inject/Singleton.html):\n~~~ Java\n@Scope\n@Documented\n@Retention(value=RUNTIME)\npublic @interface Singleton\nIdentifies a type that the injector only instantiates once. Not inherited.\n~~~\n\n\n#### @Scope\n @Scope \n\n @Singleton  Log \n\n~~~ Java\n@Singleton\nclass Log {\n   void log(String message) { ... }\n}\n~~~\n\n\n\n\n\n-  @Scope@Retention(RUNTIME)  @Documented \n- \n-  @Inherited \n-  @Target \n\n @Scope \n\n[doc](http://docs.oracle.com/javaee/6/api/javax/inject/Scope.html)\n\n### assertion()\nassertionbooleanbooleantruefalse\n\n\nassertionJavaassert\n\n~~~ Java\n1.assert expression1;\n\n2.assert expression1: expression2;\n~~~\n\nexpression1booleanexpression2Object\n\n- assertion\n- assertionexpression1\n- falseAssertionError\n- expression1trueexpression2\n\nassertion[](http://blog.csdn.net/ithomer/article/details/9185125)\n","slug":"JAVA-CDI-Assertion","published":1,"date":"2017-03-13T16:00:00.000Z","updated":"2017-11-23T07:13:55.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ec0m0030d6yk4pl8drox","content":"<h3 id=\"InjectCDI\"><a href=\"#InjectCDI\" class=\"headerlink\" title=\"@InjectCDI\"></a>@InjectCDI</h3><p><a href=\"https://developer.android.com/reference/android/support/annotation/package-summary.html\" target=\"_blank\" rel=\"external\">Android Support Annotation</a></p>\n<p>Java</p>\n<p>CDIContexts and Dependency Injection <br><a href=\"http://blog.csdn.net/DL88250/article/details/4838803\" target=\"_blank\" rel=\"external\">Java JSR-330</a>javax.injectProvider@Scope@Inject@Named@Qualifier</p>\n<h4 id=\"Inject\"><a href=\"#Inject\" class=\"headerlink\" title=\"@Inject\"></a>@Inject</h4><p>@Injectjavax.injectnew :)</p>\n<h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5><p>@Injectfinal</p>\n<a id=\"more\"></a>\n<p>doc</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Injectable fields:</div><div class=\"line\"></div><div class=\"line\">  - are annotated with <span class=\"meta\">@Inject</span>.</div><div class=\"line\">  - are not <span class=\"keyword\">final</span>.</div><div class=\"line\">  - may have any otherwise valid name.</div><div class=\"line\"></div><div class=\"line\"><span class=\"meta\">@Inject</span> FieldModifiers(opt) Type VariableDeclarators;</div></pre></td></tr></table></figure>\n<pre><code>(opt)\n</code></pre><h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5><p>@Inject0</p>\n<p><a href=\"http://docs.oracle.com/javaee/6/api/javax/inject/Inject.html\" target=\"_blank\" rel=\"external\">doc</a></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Injectable methods:</div><div class=\"line\">- are annotated with <span class=\"meta\">@Inject</span>.</div><div class=\"line\">- are not <span class=\"keyword\">abstract</span>.</div><div class=\"line\">- <span class=\"keyword\">do</span> not declare type parameters of their own.</div><div class=\"line\">- may <span class=\"keyword\">return</span> a result</div><div class=\"line\">- may have any otherwise valid name.</div><div class=\"line\">- accept zero or more dependencies as arguments.</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"meta\">@Inject</span> MethodModifiers(opt) <span class=\"function\">ResultType <span class=\"title\">Identifier</span><span class=\"params\">(FormalParameterList(opt)</span>) <span class=\"title\">Throws</span><span class=\"params\">(opt)</span> MethodBody</span></div></pre></td></tr></table></figure>\n<pre><code>(opt)\n</code></pre><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Inject</span></div><div class=\"line\">WeatherDao weatherDao;</div></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Inject</span></div><div class=\"line\">WeatherDao(Context context) &#123;</div><div class=\"line\">    <span class=\"keyword\">this</span>.context = context;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>@Inject<br>private,package-private,protected,public<br></p>\n<p><strong>@Inject@Inject</strong></p>\n<p>@Inject@Named@Qualifier@Provider</p>\n<h4 id=\"Named\"><a href=\"#Named\" class=\"headerlink\" title=\"@Named\"></a>@Named</h4><p>@Named@InjectBean</p>\n<p>Bean<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Car</span> </span>&#123;</div><div class=\"line\">     <span class=\"meta\">@Inject</span> <span class=\"meta\">@Named</span>(<span class=\"string\">\"driver\"</span>) Seat driverSeat;</div><div class=\"line\">     <span class=\"meta\">@Inject</span> <span class=\"meta\">@Named</span>(<span class=\"string\">\"passenger\"</span>) Seat passengerSeat;</div><div class=\"line\">     ...</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<h4 id=\"Qualifier\"><a href=\"#Qualifier\" class=\"headerlink\" title=\"@Qualifier\"></a>@Qualifier</h4><p>qualifier</p>\n<ul>\n<li>@Qualifier@Retention(RUNTIME)@Documented</li>\n<li></li>\n<li>API</li>\n<li>@Target</li>\n</ul>\n<p><a href=\"http://docs.oracle.com/javaee/6/api/javax/inject/Qualifier.html\" target=\"_blank\" rel=\"external\">doc</a><br><figure class=\"highlight\"><table><tr><td class=\"code\"><pre><div class=\"line\">Identifies qualifier annotations. Anyone can define a new qualifier. A qualifier annotation:</div><div class=\"line\"></div><div class=\"line\">- is annotated with @Qualifier, @Retention(RUNTIME), and typically @Documented.</div><div class=\"line\">- can have attributes.</div><div class=\"line\">- may be part of the public API, much like the dependency type, but unlike implementation types which needn't be part of the public API.</div><div class=\"line\">- may have restricted usage if annotated with @Target. While this specification covers applying qualifiers to fields and parameters only, some injector configurations might use qualifier annotations in other places (on methods or classes for example).</div></pre></td></tr></table></figure></p>\n<p><a href=\"http://docs.oracle.com/javaee/6/api/javax/inject/Named.html\" target=\"_blank\" rel=\"external\">java doc@Named</a><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Qualifier</span></div><div class=\"line\"><span class=\"meta\">@Documented</span></div><div class=\"line\"><span class=\"meta\">@Retention</span>(value=RUNTIME)</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> Named</div></pre></td></tr></table></figure></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Documented</span>  </div><div class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)  </div><div class=\"line\"><span class=\"meta\">@Qualifier</span>  </div><div class=\"line\"><span class=\"meta\">@Target</span>(value = &#123;ElementType.FIELD, ElementType.PARAMETER, ElementType.TYPE&#125;)  </div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> Genre &#123;  </div><div class=\"line\">    <span class=\"function\">User <span class=\"title\">user</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> User.STUDENT</span>;  </div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">enum</span> User &#123;STUDENT, TEACHER&#125;  </div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Named</span>  </div><div class=\"line\"><span class=\"meta\">@Genre</span>(user = User.STUDENT)  </div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">StudentDAO</span> <span class=\"keyword\">implements</span> <span class=\"title\">IUserDAO</span></span>&#123;  </div><div class=\"line\">    <span class=\"meta\">@Override</span>  </div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">count</span><span class=\"params\">()</span> </span>&#123;  </div><div class=\"line\">        System.out.println(<span class=\"string\">\"----StudentDAO----\"</span>);  </div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;  </div><div class=\"line\">    &#125;  </div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h4 id=\"Provider\"><a href=\"#Provider\" class=\"headerlink\" title=\"@Provider\"></a>@Provider</h4><p>@ProviderT@ProviderT.get()</p>\n<p><a href=\"http://docs.oracle.com/javaee/6/api/javax/inject/Provider.html\" target=\"_blank\" rel=\"external\">doc</a>:<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Provides instances of T. Typically implemented by an injector. For any type T that can be injected, you can also inject Provider&lt;T&gt;. Compared to injecting T directly, injecting Provider&lt;T&gt; enables:</div><div class=\"line\"></div><div class=\"line\">- retrieving multiple instances.</div><div class=\"line\">- lazy or optional retrieval of an instance.</div><div class=\"line\">- breaking circular dependencies.</div><div class=\"line\">- abstracting scope so you can look up an instance in a smaller scope from an instance in a containing scope.</div></pre></td></tr></table></figure></p>\n<p>For example:<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Car</span> </span>&#123;</div><div class=\"line\"><span class=\"meta\">@Inject</span> Car(Provider&lt;Seat&gt; seatProvider) &#123;</div><div class=\"line\">   Seat driver = seatProvider.get();</div><div class=\"line\">   Seat passenger = seatProvider.get();</div><div class=\"line\">   ...</div><div class=\"line\"> &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>get<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\">T\t<span class=\"title\">get</span><span class=\"params\">()</span></span></div><div class=\"line\">    Provides a fully-constructed and injected instance of T.</div></pre></td></tr></table></figure></p>\n<h4 id=\"Singleton\"><a href=\"#Singleton\" class=\"headerlink\" title=\"@Singleton\"></a>@Singleton</h4><p></p>\n<p><a href=\"http://docs.oracle.com/javaee/6/api/javax/inject/Singleton.html\" target=\"_blank\" rel=\"external\">doc</a>:<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Scope</span></div><div class=\"line\"><span class=\"meta\">@Documented</span></div><div class=\"line\"><span class=\"meta\">@Retention</span>(value=RUNTIME)</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> Singleton</div><div class=\"line\">Identifies a type that the injector only instantiates once. Not inherited.</div></pre></td></tr></table></figure></p>\n<h4 id=\"Scope\"><a href=\"#Scope\" class=\"headerlink\" title=\"@Scope\"></a>@Scope</h4><p> @Scope </p>\n<p> @Singleton  Log </p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Singleton</span></div><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Log</span> </span>&#123;</div><div class=\"line\">   <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">log</span><span class=\"params\">(String message)</span> </span>&#123; ... &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p></p>\n<p></p>\n<ul>\n<li> @Scope@Retention(RUNTIME)  @Documented </li>\n<li></li>\n<li> @Inherited </li>\n<li> @Target </li>\n</ul>\n<p> @Scope </p>\n<p><a href=\"http://docs.oracle.com/javaee/6/api/javax/inject/Scope.html\" target=\"_blank\" rel=\"external\">doc</a></p>\n<h3 id=\"assertion-\"><a href=\"#assertion-\" class=\"headerlink\" title=\"assertion()\"></a>assertion()</h3><p>assertionbooleanbooleantruefalse</p>\n<p>assertionJavaassert</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"number\">1</span>.<span class=\"keyword\">assert</span> expression1;</div><div class=\"line\"></div><div class=\"line\"><span class=\"number\">2</span>.<span class=\"keyword\">assert</span> expression1: expression2;</div></pre></td></tr></table></figure>\n<p>expression1booleanexpression2Object</p>\n<ul>\n<li>assertion</li>\n<li>assertionexpression1</li>\n<li>falseAssertionError</li>\n<li>expression1trueexpression2</li>\n</ul>\n<p>assertion<a href=\"http://blog.csdn.net/ithomer/article/details/9185125\" target=\"_blank\" rel=\"external\"></a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/03/14/JAVA-CDI-Assertion/\">http://agehua.github.io/2017/03/14/JAVA-CDI-Assertion/</a></p>\n","readingTime":{"text":"4 min read","minutes":3.325,"time":199500,"words":665},"excerpt":"<h3 id=\"InjectCDI\"><a href=\"#InjectCDI\" class=\"headerlink\" title=\"@InjectCDI\"></a>@InjectCDI</h3><p><a href=\"https://developer.android.com/reference/android/support/annotation/package-summary.html\">Android Support Annotation</a></p>\n<p>Java</p>\n<p>CDIContexts and Dependency Injection <br><a href=\"http://blog.csdn.net/DL88250/article/details/4838803\">Java JSR-330</a>javax.injectProvider@Scope@Inject@Named@Qualifier</p>\n<h4 id=\"Inject\"><a href=\"#Inject\" class=\"headerlink\" title=\"@Inject\"></a>@Inject</h4><p>@Injectjavax.injectnew :)</p>\n<h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5><p>@Injectfinal</p>","more":"<p>doc</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Injectable fields:</div><div class=\"line\"></div><div class=\"line\">  - are annotated with <span class=\"meta\">@Inject</span>.</div><div class=\"line\">  - are not <span class=\"keyword\">final</span>.</div><div class=\"line\">  - may have any otherwise valid name.</div><div class=\"line\"></div><div class=\"line\"><span class=\"meta\">@Inject</span> FieldModifiers(opt) Type VariableDeclarators;</div></pre></td></tr></table></figure>\n<pre><code>(opt)\n</code></pre><h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5><p>@Inject0</p>\n<p><a href=\"http://docs.oracle.com/javaee/6/api/javax/inject/Inject.html\">doc</a></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Injectable methods:</div><div class=\"line\">- are annotated with <span class=\"meta\">@Inject</span>.</div><div class=\"line\">- are not <span class=\"keyword\">abstract</span>.</div><div class=\"line\">- <span class=\"keyword\">do</span> not declare type parameters of their own.</div><div class=\"line\">- may <span class=\"keyword\">return</span> a result</div><div class=\"line\">- may have any otherwise valid name.</div><div class=\"line\">- accept zero or more dependencies as arguments.</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"meta\">@Inject</span> MethodModifiers(opt) <span class=\"function\">ResultType <span class=\"title\">Identifier</span><span class=\"params\">(FormalParameterList(opt)</span>) <span class=\"title\">Throws</span><span class=\"params\">(opt)</span> MethodBody</span></div></pre></td></tr></table></figure>\n<pre><code>(opt)\n</code></pre><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Inject</span></div><div class=\"line\">WeatherDao weatherDao;</div></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Inject</span></div><div class=\"line\">WeatherDao(Context context) &#123;</div><div class=\"line\">    <span class=\"keyword\">this</span>.context = context;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>@Inject<br>private,package-private,protected,public<br></p>\n<p><strong>@Inject@Inject</strong></p>\n<p>@Inject@Named@Qualifier@Provider</p>\n<h4 id=\"Named\"><a href=\"#Named\" class=\"headerlink\" title=\"@Named\"></a>@Named</h4><p>@Named@InjectBean</p>\n<p>Bean<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Car</span> </span>&#123;</div><div class=\"line\">     <span class=\"meta\">@Inject</span> <span class=\"meta\">@Named</span>(<span class=\"string\">\"driver\"</span>) Seat driverSeat;</div><div class=\"line\">     <span class=\"meta\">@Inject</span> <span class=\"meta\">@Named</span>(<span class=\"string\">\"passenger\"</span>) Seat passengerSeat;</div><div class=\"line\">     ...</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<h4 id=\"Qualifier\"><a href=\"#Qualifier\" class=\"headerlink\" title=\"@Qualifier\"></a>@Qualifier</h4><p>qualifier</p>\n<ul>\n<li>@Qualifier@Retention(RUNTIME)@Documented</li>\n<li></li>\n<li>API</li>\n<li>@Target</li>\n</ul>\n<p><a href=\"http://docs.oracle.com/javaee/6/api/javax/inject/Qualifier.html\">doc</a><br><figure class=\"highlight\"><table><tr><td class=\"code\"><pre><div class=\"line\">Identifies qualifier annotations. Anyone can define a new qualifier. A qualifier annotation:</div><div class=\"line\"></div><div class=\"line\">- is annotated with @Qualifier, @Retention(RUNTIME), and typically @Documented.</div><div class=\"line\">- can have attributes.</div><div class=\"line\">- may be part of the public API, much like the dependency type, but unlike implementation types which needn't be part of the public API.</div><div class=\"line\">- may have restricted usage if annotated with @Target. While this specification covers applying qualifiers to fields and parameters only, some injector configurations might use qualifier annotations in other places (on methods or classes for example).</div></pre></td></tr></table></figure></p>\n<p><a href=\"http://docs.oracle.com/javaee/6/api/javax/inject/Named.html\">java doc@Named</a><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Qualifier</span></div><div class=\"line\"><span class=\"meta\">@Documented</span></div><div class=\"line\"><span class=\"meta\">@Retention</span>(value=RUNTIME)</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> Named</div></pre></td></tr></table></figure></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Documented</span>  </div><div class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)  </div><div class=\"line\"><span class=\"meta\">@Qualifier</span>  </div><div class=\"line\"><span class=\"meta\">@Target</span>(value = &#123;ElementType.FIELD, ElementType.PARAMETER, ElementType.TYPE&#125;)  </div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> Genre &#123;  </div><div class=\"line\">    <span class=\"function\">User <span class=\"title\">user</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> User.STUDENT</span>;  </div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">enum</span> User &#123;STUDENT, TEACHER&#125;  </div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Named</span>  </div><div class=\"line\"><span class=\"meta\">@Genre</span>(user = User.STUDENT)  </div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">StudentDAO</span> <span class=\"keyword\">implements</span> <span class=\"title\">IUserDAO</span></span>&#123;  </div><div class=\"line\">    <span class=\"meta\">@Override</span>  </div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">count</span><span class=\"params\">()</span> </span>&#123;  </div><div class=\"line\">        System.out.println(<span class=\"string\">\"----StudentDAO----\"</span>);  </div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;  </div><div class=\"line\">    &#125;  </div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h4 id=\"Provider\"><a href=\"#Provider\" class=\"headerlink\" title=\"@Provider\"></a>@Provider</h4><p>@ProviderT@ProviderT.get()</p>\n<p><a href=\"http://docs.oracle.com/javaee/6/api/javax/inject/Provider.html\">doc</a>:<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Provides instances of T. Typically implemented by an injector. For any type T that can be injected, you can also inject Provider&lt;T&gt;. Compared to injecting T directly, injecting Provider&lt;T&gt; enables:</div><div class=\"line\"></div><div class=\"line\">- retrieving multiple instances.</div><div class=\"line\">- lazy or optional retrieval of an instance.</div><div class=\"line\">- breaking circular dependencies.</div><div class=\"line\">- abstracting scope so you can look up an instance in a smaller scope from an instance in a containing scope.</div></pre></td></tr></table></figure></p>\n<p>For example:<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Car</span> </span>&#123;</div><div class=\"line\"><span class=\"meta\">@Inject</span> Car(Provider&lt;Seat&gt; seatProvider) &#123;</div><div class=\"line\">   Seat driver = seatProvider.get();</div><div class=\"line\">   Seat passenger = seatProvider.get();</div><div class=\"line\">   ...</div><div class=\"line\"> &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>get<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\">T\t<span class=\"title\">get</span><span class=\"params\">()</span></div><div class=\"line\">    Provides a fully-constructed and injected instance of T.</span></div></pre></td></tr></table></figure></p>\n<h4 id=\"Singleton\"><a href=\"#Singleton\" class=\"headerlink\" title=\"@Singleton\"></a>@Singleton</h4><p></p>\n<p><a href=\"http://docs.oracle.com/javaee/6/api/javax/inject/Singleton.html\">doc</a>:<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Scope</span></div><div class=\"line\"><span class=\"meta\">@Documented</span></div><div class=\"line\"><span class=\"meta\">@Retention</span>(value=RUNTIME)</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> Singleton</div><div class=\"line\">Identifies a type that the injector only instantiates once. Not inherited.</div></pre></td></tr></table></figure></p>\n<h4 id=\"Scope\"><a href=\"#Scope\" class=\"headerlink\" title=\"@Scope\"></a>@Scope</h4><p> @Scope </p>\n<p> @Singleton  Log </p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Singleton</span></div><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Log</span> </span>&#123;</div><div class=\"line\">   <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">log</span><span class=\"params\">(String message)</span> </span>&#123; ... &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p></p>\n<p></p>\n<ul>\n<li> @Scope@Retention(RUNTIME)  @Documented </li>\n<li></li>\n<li> @Inherited </li>\n<li> @Target </li>\n</ul>\n<p> @Scope </p>\n<p><a href=\"http://docs.oracle.com/javaee/6/api/javax/inject/Scope.html\">doc</a></p>\n<h3 id=\"assertion-\"><a href=\"#assertion-\" class=\"headerlink\" title=\"assertion()\"></a>assertion()</h3><p>assertionbooleanbooleantruefalse</p>\n<p>assertionJavaassert</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"number\">1</span>.<span class=\"keyword\">assert</span> expression1;</div><div class=\"line\"></div><div class=\"line\"><span class=\"number\">2</span>.<span class=\"keyword\">assert</span> expression1: expression2;</div></pre></td></tr></table></figure>\n<p>expression1booleanexpression2Object</p>\n<ul>\n<li>assertion</li>\n<li>assertionexpression1</li>\n<li>falseAssertionError</li>\n<li>expression1trueexpression2</li>\n</ul>\n<p>assertion<a href=\"http://blog.csdn.net/ithomer/article/details/9185125\"></a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/03/14/JAVA-CDI-Assertion/\">http://agehua.github.io/2017/03/14/JAVA-CDI-Assertion/</a></p>"},{"layout":"post","title":"Android","keywords":"Annotation, apt, annotationProcessor","banner":"http://obxk8w81b.bkt.clouddn.com/Basket%20of%20Potatoes.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Basket%20of%20Potatoes.jpg","toc":true,"_content":"\n## Android\n\nJava @Interface \n\n[Injection(CDI)assertion()](https://agehua.github.io/2017/03/14/Android-CDI/)JavaCDIAndroid\n\nAndroidViewButterknifeBind\n\n~~~ Java\n@Retention (RetentionPolicy.Class)\n@Target (ElementType.FIELD)\npublic @interface Bind {\n   /** View ID to which the field will be found. **/\n   int[] value();\n}\n~~~\n@interface Java.class@Retention @Target \n\n### Java\n\n<!--more-->\nJava APIjava.langjava.lang.annotationjavax.annotation\n\n#### \n\n- @Override\n- @Deprecated\n- @SuppressWarnings\n- @SafeVarargs\n- @Generated@Generated\n- @FunctionalInterface\n\n#### \nJavaEEAndroid\b\n\n- @PostConstruct\n- @PreDestroy\n- @Resource\n- @Resources\n\n#### \nButterknifeBind\n\n\n- @Retention, \n  - @Retention(RetentionPolicy.SOURCE) .java .class\n  - @Retention(RetentionPolicy.CLASS) .java .classJava\n  - @Retention(RetentionPolicy.RUNTIME)Java\n  CLASS\n- @Target, ElementType\n\n|  |  |\n| :-------- | :--------|\n| ANNOTATION_TYPE  |  |  \n| CONSTRUCTOR    |   |  \n| FIELD     |    |\n| LOCAL_VARIABLE     |    |\n| METHOD     |    |\n| PACKAGE     |    |\n| PARAMETER     |    |\n| TYPE     |   enum |\n| TYPE_PARAMETER     |    |\n| TYPE_USE     |    |\n\n  > @TargetTYPE_USETYPE_PARAMETER\n\n- @Inherited, \n- @Documented, JavaDoc\n- @Repeatable, Java 8Java 5\n\n### \n @Retention(RetentionPolicy.RUNTIME)\n\n> ButterknifeView8.0.0\n\n#### \n\nDemo\n\n\n\n~~~ Java\n@Override\nprotected void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n    setContentView(R.layout.activity_home);\n}\n~~~\n\n\n~~~ Java\n@ContentView(R.layout.activity_home)\npublic class HomeActivity extends BaseActivity {\n    ...\n}\n~~~\n\n\n\n\n- \n~~~ Java\n@Retention(RetentionPolicy.RUNTIME)\n@Target({ElementType.TYPE})\npublic @interface ContentView {\n    int value();\n}\n~~~\n\n\n\n- public @interface ContentView\n\ninterfaceContentViewclassenum@interface\n\nElementTypeclassinterfaceAnnotationenumElementType.Typeinterface@interface\n\n~~~ Java\n/** Class, interface (including annotation type), or enum declaration */\nTYPE,\n~~~\n\n- int value();\n\n\n~~~ Java\n@ContentView(R.layout.activity_home)\n~~~\n\nR.layout.activity_home intid\n\n~~~ Java\n@ContentView(string)\n~~~\n[Android-](https://lizhaoxuan.github.io/2016/07/17/apt-Grammar-explanation/)\n\n#### \n\n\n~~~ Java\n@ContentView(R.layout.activity_home)\npublic class HomeActivity extends BaseActivity {\n    ...\n}\n~~~\nBaseActivityBaseActivity\n~~~ Java\npublic class BaseActivity extends AppCompatActivity {\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n    //\n    for (Class c = this.getClass(); c != Context.class; c = c.getSuperclass()) {\n        ContentView annotation = (ContentView) c.getAnnotation(ContentView.class);\n        if (annotation != null) {\n            try {\n                this.setContentView(annotation.value());\n            } catch (RuntimeException e) {\n                e.printStackTrace();\n            }\n            return;\n        }\n    }\n}\n~~~\n\n\n- \n- ContentView\n- ContentView\n- Activity\n\n>  @Retention(RetentionPolicy.RUNTIME)\n\n### \n\nJava****Java javac -processor\n\n#### \nProcessorProcessorAbstractProcessorprocessJava\n\n~~~ Java\npublic class JsonAnnotationProcessor extends AbstractProcessor {\n\n  @Override\n  public synchronized void init(ProcessingEnvironment env){\n     super.init(env);\n     //ProcessingEnvironment\n     //ElementsTypesFiler\n     elementUtils = env.getElementUtils();\n     typeUtils = env.getTypeUtils();\n     filer = env.getFiler();\n  }\n\n  @Override\n  public Set<String> getSupportedAnnotationTypes() {\n    //\n    return super.getSupportedAnnotationTypes();\n  }\n\n  @Override\n  public SourceVersion getSupportedSourceVersion() {\n    //Java\n    return SourceVersion.latestSupported();\n  }\n\n  @Override\n  public boolean process(Set<? extends TypeElement> annotations, RoundEnvironment roundEnv) {\n      //roundEnv\n      //Butterknife\n      Map<TypeElement, BindingClass> targetClassMap = findAndParseTargets(env);\n\n      for (Map.Entry<TypeElement, BindingClass> entry : targetClassMap.entrySet()) {\n        TypeElement typeElement = entry.getKey();\n        BindingClass bindingClass = entry.getValue();\n\n        try {\n          JavaFileObject jfo = filer.createSourceFile(bindingClass.getFqcn(), typeElement);\n          Writer writer = jfo.openWriter();\n          writer.write(bindingClass.brewJava());\n          writer.flush();\n          writer.close();\n        } catch (IOException e) {\n          error(typeElement, \"Unable to write view binder for type %s: %s\", typeElement,\n              e.getMessage());\n        }\n      }\n\n      //  annotations  Processor \n      //true pocessor  Annotations \n      return true;\n  }\n\n  //ButterknifeRoundEnvironment\n  private Map<TypeElement, BindingClass> findAndParseTargets(RoundEnvironment env) {\n    Map<TypeElement, BindingClass> targetClassMap = new LinkedHashMap<TypeElement, BindingClass>();\n    Set<String> erasedTargetNames = new LinkedHashSet<String>();\n\n    // Process each @Bind element.\n    for (Element element : env.getElementsAnnotatedWith(Bind.class)) {\n      //@Bind\n      try {\n        parseBind(element, targetClassMap, erasedTargetNames);\n      } catch (Exception e) {\n        logParsingError(element, Bind.class, e);\n      }\n    }\n\n    ......\n  }  \n}\n~~~\n\n> Processprocess\n\nJava7 getSupportedAnnotationTypes()getSupportedSourceVersion()\n~~~ Java\n@SupportedAnnotationTypes({\n  //\n})\n@SupportedSourceVersion(SourceVersion.RELEASE_7)\npublic class ContentViewProcessor extends AbstractProcessor {\n    ...\n}\n~~~\n\n#### Element\nElementElement@Target\n\n> ElementRepresents a program element such as a package, class, or method.\nEach element represents a static, language-level construct (and not, for example, a runtime construct of the virtual machine).\n\n\n\nElement\n\n- ExecutableElement\n@Target(ElementType.METHOD) @Target(ElementType.CONSTRUCTOR)\n\n- PackageElement\n@Target(ElementType.PACKAGE)\n\n- TypeElement\n\n@Target(ElementType.TYPE)\n\n> \n\n- TypeParameterElement\n\n@Target(ElementType.PARAMETER)\n\n- VariableElement\nenum\n@Target(ElementType.LOCAL_VARIABLE)\n\n#### Processor\nProcessor,ProcessorMessagesProcessorSystem.out\n\nProcessorLog: Messager\n~~~ Java\n//Butterknife\nprivate void error(Element element, String message, Object... args) {\n    if (args.length > 0) {\n      message = String.format(message, args);\n    }\n    processingEnv.getMessager().printMessage(Diagnostic.Kind.ERROR, message, element);\n}\n~~~\n\n### \njavac -processorjarjar**javax.annotation.processing.processor**jarjarMETA-INF/servicejar\n\n![http://blog.csdn.net/lmj623565791/article/details/43452969](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/processor_jar.png)\n\njavax.annotation.processing.Processor\n\nsrc/main/javaresourcesMETA-INF/services/javax.annotation.processing.Processor\n\n> Android StudioJava LibraryAndroid LibraryAndroid LibraryJDKjavax\n\nGoogleAutoServiceProcessor@AutoService\n\n~~~ Java\n@AutoService(Processor.class)\n@SupportedAnnotationTypes({\n  //\n})\n@SupportedSourceVersion(SourceVersion.RELEASE_7)\npublic class ContentViewProcessor extends AbstractProcessor {\n    ...\n}\n~~~\n\n### android-apt\njarbuild.gradleprovidedcompile\n\nandroid-apt\n\nAPT(Annotation Processing Tool),AnnotationAnnotation\nAnnotationAnnotation(),APTclass\n\nandroid-aptAndroid Studio\n\n- APK\n- Android Studio\n\n#### Projectapt\n\n~~~ Java\n//Projectbuild.gradle\nbuildscript {\n    repositories {\n      mavenCentral()\n    }\n    dependencies {\n        ...\n        //android-apt\n        classpath 'com.neenbedankt.gradle.plugins:android-apt:1.8'\n    }\n}\n\napply plugin: 'com.neenbedankt.android-apt'\n~~~\n\napt\n~~~ Java\ndependencies {\n   apt'com.bluelinelabs:logansquare-compiler:1.3.6'\n   compile 'com.bluelinelabs:logansquare:1.3.6'\n}\n~~~\n\n[LoganSquare](https://github.com/bluelinelabs/LoganSquare)JSONcompilerLoganSquare\n\n#### Moduleapt\nModulebuild.gradle\n\naptDaggerDagger-compilerdaggerdagger-commpilerdagger\n~~~ Java\n//Modulebuild.gradle\napply plugin: 'com.android.application'\napply plugin: 'com.neenbedankt.android-apt'\n\ndependencies {\n apt 'com.squareup.dagger:dagger-compiler:1.1.0'\n compile 'com.squareup.dagger:dagger:1.1.0'\n}\n~~~\n\n> provided vs apt\n  provided classesIDEclassesGuavaimportAndroid crash\n  provided\n  aptclassessourceIDEAndroid Studio\n\n\naptDBflowDagger2ButterKnifeActivityRouterAptPreferencesAnnotation\n\n\n### APTannotation\n**AbstractProcess+javaPoet+AutoService+apt**\n\n\n- 1.@inject\n- 2.\n- 3.Java\n- 4.\n- 5.APT\n\n![http://blog.csdn.net/xx326664162/article/details/68490059](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/apt_processor.png)\n\n### annotationProcessor\nannotationProcessorAPTgooglebuild.gradle\nButterKnifeannotationProcessor\n\n~~~ Java\ndependencies {\n     annotationProcessor project(':xx')\n     annotationProcessor 'com.jakewharton:butterknife-compiler:8.5.1'\n}\n~~~\n\n> apt vs annotationProcessor\n  android-aptapt[](https://bitbucket.org/hvisser/android-apt)Android Gradle  2.2 Android Gradle  annotationProcessor  android-apt android-apt Android GradleannotationProcessorandroid-apt  Android annotationProcessor\n  Android Nandroid Java 8Java 8Jackandroid-aptjavacannotationProcessorjavacjack\n\nannotationProcessorandroid-apt[](http://www.cnblogs.com/whoislcj/p/6148410.html)\n\n\n\n\n[Android  ](http://blog.csdn.net/lmj623565791/article/details/43452969)\n[Android APT](https://joyrun.github.io/2016/07/19/AptHelloWorld/)\n[Android1-](https://lizhaoxuan.github.io/2016/07/17/apt-wathapt/)\n[APTannotationProcessorandroid-aptProvided](http://blog.csdn.net/xx326664162/article/details/68490059)\n[AndroidAndroid](https://www.amazon.cn/%E5%9B%BE%E4%B9%A6/dp/B01MPY3VNG/ref=sr_1_1?ie=UTF8&qid=1491812168&sr=8-1)\n","source":"_posts/2017-04-10-Annotation-Android-usage.md","raw":"---\nlayout: post\ntitle:  Android\ncategory: accumulation\ntags:\n  - Annotation\n  - ANDROID\nkeywords: Annotation, apt, annotationProcessor\nbanner: http://obxk8w81b.bkt.clouddn.com/Basket%20of%20Potatoes.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Basket%20of%20Potatoes.jpg\ntoc: true\n---\n\n## Android\n\nJava @Interface \n\n[Injection(CDI)assertion()](https://agehua.github.io/2017/03/14/Android-CDI/)JavaCDIAndroid\n\nAndroidViewButterknifeBind\n\n~~~ Java\n@Retention (RetentionPolicy.Class)\n@Target (ElementType.FIELD)\npublic @interface Bind {\n   /** View ID to which the field will be found. **/\n   int[] value();\n}\n~~~\n@interface Java.class@Retention @Target \n\n### Java\n\n<!--more-->\nJava APIjava.langjava.lang.annotationjavax.annotation\n\n#### \n\n- @Override\n- @Deprecated\n- @SuppressWarnings\n- @SafeVarargs\n- @Generated@Generated\n- @FunctionalInterface\n\n#### \nJavaEEAndroid\b\n\n- @PostConstruct\n- @PreDestroy\n- @Resource\n- @Resources\n\n#### \nButterknifeBind\n\n\n- @Retention, \n  - @Retention(RetentionPolicy.SOURCE) .java .class\n  - @Retention(RetentionPolicy.CLASS) .java .classJava\n  - @Retention(RetentionPolicy.RUNTIME)Java\n  CLASS\n- @Target, ElementType\n\n|  |  |\n| :-------- | :--------|\n| ANNOTATION_TYPE  |  |  \n| CONSTRUCTOR    |   |  \n| FIELD     |    |\n| LOCAL_VARIABLE     |    |\n| METHOD     |    |\n| PACKAGE     |    |\n| PARAMETER     |    |\n| TYPE     |   enum |\n| TYPE_PARAMETER     |    |\n| TYPE_USE     |    |\n\n  > @TargetTYPE_USETYPE_PARAMETER\n\n- @Inherited, \n- @Documented, JavaDoc\n- @Repeatable, Java 8Java 5\n\n### \n @Retention(RetentionPolicy.RUNTIME)\n\n> ButterknifeView8.0.0\n\n#### \n\nDemo\n\n\n\n~~~ Java\n@Override\nprotected void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n    setContentView(R.layout.activity_home);\n}\n~~~\n\n\n~~~ Java\n@ContentView(R.layout.activity_home)\npublic class HomeActivity extends BaseActivity {\n    ...\n}\n~~~\n\n\n\n\n- \n~~~ Java\n@Retention(RetentionPolicy.RUNTIME)\n@Target({ElementType.TYPE})\npublic @interface ContentView {\n    int value();\n}\n~~~\n\n\n\n- public @interface ContentView\n\ninterfaceContentViewclassenum@interface\n\nElementTypeclassinterfaceAnnotationenumElementType.Typeinterface@interface\n\n~~~ Java\n/** Class, interface (including annotation type), or enum declaration */\nTYPE,\n~~~\n\n- int value();\n\n\n~~~ Java\n@ContentView(R.layout.activity_home)\n~~~\n\nR.layout.activity_home intid\n\n~~~ Java\n@ContentView(string)\n~~~\n[Android-](https://lizhaoxuan.github.io/2016/07/17/apt-Grammar-explanation/)\n\n#### \n\n\n~~~ Java\n@ContentView(R.layout.activity_home)\npublic class HomeActivity extends BaseActivity {\n    ...\n}\n~~~\nBaseActivityBaseActivity\n~~~ Java\npublic class BaseActivity extends AppCompatActivity {\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n    //\n    for (Class c = this.getClass(); c != Context.class; c = c.getSuperclass()) {\n        ContentView annotation = (ContentView) c.getAnnotation(ContentView.class);\n        if (annotation != null) {\n            try {\n                this.setContentView(annotation.value());\n            } catch (RuntimeException e) {\n                e.printStackTrace();\n            }\n            return;\n        }\n    }\n}\n~~~\n\n\n- \n- ContentView\n- ContentView\n- Activity\n\n>  @Retention(RetentionPolicy.RUNTIME)\n\n### \n\nJava****Java javac -processor\n\n#### \nProcessorProcessorAbstractProcessorprocessJava\n\n~~~ Java\npublic class JsonAnnotationProcessor extends AbstractProcessor {\n\n  @Override\n  public synchronized void init(ProcessingEnvironment env){\n     super.init(env);\n     //ProcessingEnvironment\n     //ElementsTypesFiler\n     elementUtils = env.getElementUtils();\n     typeUtils = env.getTypeUtils();\n     filer = env.getFiler();\n  }\n\n  @Override\n  public Set<String> getSupportedAnnotationTypes() {\n    //\n    return super.getSupportedAnnotationTypes();\n  }\n\n  @Override\n  public SourceVersion getSupportedSourceVersion() {\n    //Java\n    return SourceVersion.latestSupported();\n  }\n\n  @Override\n  public boolean process(Set<? extends TypeElement> annotations, RoundEnvironment roundEnv) {\n      //roundEnv\n      //Butterknife\n      Map<TypeElement, BindingClass> targetClassMap = findAndParseTargets(env);\n\n      for (Map.Entry<TypeElement, BindingClass> entry : targetClassMap.entrySet()) {\n        TypeElement typeElement = entry.getKey();\n        BindingClass bindingClass = entry.getValue();\n\n        try {\n          JavaFileObject jfo = filer.createSourceFile(bindingClass.getFqcn(), typeElement);\n          Writer writer = jfo.openWriter();\n          writer.write(bindingClass.brewJava());\n          writer.flush();\n          writer.close();\n        } catch (IOException e) {\n          error(typeElement, \"Unable to write view binder for type %s: %s\", typeElement,\n              e.getMessage());\n        }\n      }\n\n      //  annotations  Processor \n      //true pocessor  Annotations \n      return true;\n  }\n\n  //ButterknifeRoundEnvironment\n  private Map<TypeElement, BindingClass> findAndParseTargets(RoundEnvironment env) {\n    Map<TypeElement, BindingClass> targetClassMap = new LinkedHashMap<TypeElement, BindingClass>();\n    Set<String> erasedTargetNames = new LinkedHashSet<String>();\n\n    // Process each @Bind element.\n    for (Element element : env.getElementsAnnotatedWith(Bind.class)) {\n      //@Bind\n      try {\n        parseBind(element, targetClassMap, erasedTargetNames);\n      } catch (Exception e) {\n        logParsingError(element, Bind.class, e);\n      }\n    }\n\n    ......\n  }  \n}\n~~~\n\n> Processprocess\n\nJava7 getSupportedAnnotationTypes()getSupportedSourceVersion()\n~~~ Java\n@SupportedAnnotationTypes({\n  //\n})\n@SupportedSourceVersion(SourceVersion.RELEASE_7)\npublic class ContentViewProcessor extends AbstractProcessor {\n    ...\n}\n~~~\n\n#### Element\nElementElement@Target\n\n> ElementRepresents a program element such as a package, class, or method.\nEach element represents a static, language-level construct (and not, for example, a runtime construct of the virtual machine).\n\n\n\nElement\n\n- ExecutableElement\n@Target(ElementType.METHOD) @Target(ElementType.CONSTRUCTOR)\n\n- PackageElement\n@Target(ElementType.PACKAGE)\n\n- TypeElement\n\n@Target(ElementType.TYPE)\n\n> \n\n- TypeParameterElement\n\n@Target(ElementType.PARAMETER)\n\n- VariableElement\nenum\n@Target(ElementType.LOCAL_VARIABLE)\n\n#### Processor\nProcessor,ProcessorMessagesProcessorSystem.out\n\nProcessorLog: Messager\n~~~ Java\n//Butterknife\nprivate void error(Element element, String message, Object... args) {\n    if (args.length > 0) {\n      message = String.format(message, args);\n    }\n    processingEnv.getMessager().printMessage(Diagnostic.Kind.ERROR, message, element);\n}\n~~~\n\n### \njavac -processorjarjar**javax.annotation.processing.processor**jarjarMETA-INF/servicejar\n\n![http://blog.csdn.net/lmj623565791/article/details/43452969](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/processor_jar.png)\n\njavax.annotation.processing.Processor\n\nsrc/main/javaresourcesMETA-INF/services/javax.annotation.processing.Processor\n\n> Android StudioJava LibraryAndroid LibraryAndroid LibraryJDKjavax\n\nGoogleAutoServiceProcessor@AutoService\n\n~~~ Java\n@AutoService(Processor.class)\n@SupportedAnnotationTypes({\n  //\n})\n@SupportedSourceVersion(SourceVersion.RELEASE_7)\npublic class ContentViewProcessor extends AbstractProcessor {\n    ...\n}\n~~~\n\n### android-apt\njarbuild.gradleprovidedcompile\n\nandroid-apt\n\nAPT(Annotation Processing Tool),AnnotationAnnotation\nAnnotationAnnotation(),APTclass\n\nandroid-aptAndroid Studio\n\n- APK\n- Android Studio\n\n#### Projectapt\n\n~~~ Java\n//Projectbuild.gradle\nbuildscript {\n    repositories {\n      mavenCentral()\n    }\n    dependencies {\n        ...\n        //android-apt\n        classpath 'com.neenbedankt.gradle.plugins:android-apt:1.8'\n    }\n}\n\napply plugin: 'com.neenbedankt.android-apt'\n~~~\n\napt\n~~~ Java\ndependencies {\n   apt'com.bluelinelabs:logansquare-compiler:1.3.6'\n   compile 'com.bluelinelabs:logansquare:1.3.6'\n}\n~~~\n\n[LoganSquare](https://github.com/bluelinelabs/LoganSquare)JSONcompilerLoganSquare\n\n#### Moduleapt\nModulebuild.gradle\n\naptDaggerDagger-compilerdaggerdagger-commpilerdagger\n~~~ Java\n//Modulebuild.gradle\napply plugin: 'com.android.application'\napply plugin: 'com.neenbedankt.android-apt'\n\ndependencies {\n apt 'com.squareup.dagger:dagger-compiler:1.1.0'\n compile 'com.squareup.dagger:dagger:1.1.0'\n}\n~~~\n\n> provided vs apt\n  provided classesIDEclassesGuavaimportAndroid crash\n  provided\n  aptclassessourceIDEAndroid Studio\n\n\naptDBflowDagger2ButterKnifeActivityRouterAptPreferencesAnnotation\n\n\n### APTannotation\n**AbstractProcess+javaPoet+AutoService+apt**\n\n\n- 1.@inject\n- 2.\n- 3.Java\n- 4.\n- 5.APT\n\n![http://blog.csdn.net/xx326664162/article/details/68490059](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/apt_processor.png)\n\n### annotationProcessor\nannotationProcessorAPTgooglebuild.gradle\nButterKnifeannotationProcessor\n\n~~~ Java\ndependencies {\n     annotationProcessor project(':xx')\n     annotationProcessor 'com.jakewharton:butterknife-compiler:8.5.1'\n}\n~~~\n\n> apt vs annotationProcessor\n  android-aptapt[](https://bitbucket.org/hvisser/android-apt)Android Gradle  2.2 Android Gradle  annotationProcessor  android-apt android-apt Android GradleannotationProcessorandroid-apt  Android annotationProcessor\n  Android Nandroid Java 8Java 8Jackandroid-aptjavacannotationProcessorjavacjack\n\nannotationProcessorandroid-apt[](http://www.cnblogs.com/whoislcj/p/6148410.html)\n\n\n\n\n[Android  ](http://blog.csdn.net/lmj623565791/article/details/43452969)\n[Android APT](https://joyrun.github.io/2016/07/19/AptHelloWorld/)\n[Android1-](https://lizhaoxuan.github.io/2016/07/17/apt-wathapt/)\n[APTannotationProcessorandroid-aptProvided](http://blog.csdn.net/xx326664162/article/details/68490059)\n[AndroidAndroid](https://www.amazon.cn/%E5%9B%BE%E4%B9%A6/dp/B01MPY3VNG/ref=sr_1_1?ie=UTF8&qid=1491812168&sr=8-1)\n","slug":"Annotation-Android-usage","published":1,"date":"2017-04-09T16:00:00.000Z","updated":"2017-11-23T07:25:29.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ec0o0034d6yknst949br","content":"<h2 id=\"Android\"><a href=\"#Android\" class=\"headerlink\" title=\"Android\"></a>Android</h2><p>Java @Interface </p>\n<p><a href=\"https://agehua.github.io/2017/03/14/Android-CDI/\">Injection(CDI)assertion()</a>JavaCDIAndroid</p>\n<p>AndroidViewButterknifeBind</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Retention</span> (RetentionPolicy.Class)</div><div class=\"line\"><span class=\"meta\">@Target</span> (ElementType.FIELD)</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> Bind &#123;</div><div class=\"line\">   <span class=\"comment\">/** View ID to which the field will be found. **/</span></div><div class=\"line\">   <span class=\"keyword\">int</span>[] value();</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>@interface Java.class@Retention @Target </p>\n<h3 id=\"Java\"><a href=\"#Java\" class=\"headerlink\" title=\"Java\"></a>Java</h3><a id=\"more\"></a>\n<p>Java APIjava.langjava.lang.annotationjavax.annotation</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<ul>\n<li>@Override</li>\n<li>@Deprecated</li>\n<li>@SuppressWarnings</li>\n<li>@SafeVarargs</li>\n<li>@Generated@Generated</li>\n<li>@FunctionalInterface</li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>JavaEEAndroid\b<br></p>\n<ul>\n<li>@PostConstruct</li>\n<li>@PreDestroy</li>\n<li>@Resource</li>\n<li>@Resources</li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>ButterknifeBind</p>\n<p></p>\n<ul>\n<li>@Retention, <ul>\n<li>@Retention(RetentionPolicy.SOURCE) .java .class</li>\n<li>@Retention(RetentionPolicy.CLASS) .java .classJava</li>\n<li>@Retention(RetentionPolicy.RUNTIME)Java<br>CLASS</li>\n</ul>\n</li>\n<li>@Target, ElementType</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\"></th>\n<th style=\"text-align:left\"></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">ANNOTATION_TYPE</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">CONSTRUCTOR</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">FIELD</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">LOCAL_VARIABLE</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">METHOD</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">PACKAGE</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">PARAMETER</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">TYPE</td>\n<td style=\"text-align:left\">enum</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">TYPE_PARAMETER</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">TYPE_USE</td>\n<td style=\"text-align:left\"></td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p>@TargetTYPE_USETYPE_PARAMETER</p>\n</blockquote>\n<ul>\n<li>@Inherited, </li>\n<li>@Documented, JavaDoc</li>\n<li>@Repeatable, Java 8Java 5</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> @Retention(RetentionPolicy.RUNTIME)</p>\n<blockquote>\n<p>ButterknifeView8.0.0</p>\n</blockquote>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>Demo</p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">onCreate</span><span class=\"params\">(Bundle savedInstanceState)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">super</span>.onCreate(savedInstanceState);</div><div class=\"line\">    setContentView(R.layout.activity_home);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@ContentView</span>(R.layout.activity_home)</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">HomeActivity</span> <span class=\"keyword\">extends</span> <span class=\"title\">BaseActivity</span> </span>&#123;</div><div class=\"line\">    ...</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p></p>\n<p></p>\n<ul>\n<li><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</div><div class=\"line\"><span class=\"meta\">@Target</span>(&#123;ElementType.TYPE&#125;)</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> ContentView &#123;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">value</span><span class=\"params\">()</span></span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<p></p>\n<ul>\n<li>public @interface ContentView</li>\n</ul>\n<p>interfaceContentViewclassenum@interface</p>\n<p>ElementTypeclassinterfaceAnnotationenumElementType.Typeinterface@interface</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/** Class, interface (including annotation type), or enum declaration */</span></div><div class=\"line\">TYPE,</div></pre></td></tr></table></figure>\n<ul>\n<li>int value();</li>\n</ul>\n<p><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@ContentView</span>(R.layout.activity_home)</div></pre></td></tr></table></figure></p>\n<p>R.layout.activity_home intid</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@ContentView</span>(string)</div></pre></td></tr></table></figure>\n<p><a href=\"https://lizhaoxuan.github.io/2016/07/17/apt-Grammar-explanation/\" target=\"_blank\" rel=\"external\">Android-</a></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@ContentView</span>(R.layout.activity_home)</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">HomeActivity</span> <span class=\"keyword\">extends</span> <span class=\"title\">BaseActivity</span> </span>&#123;</div><div class=\"line\">    ...</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>BaseActivityBaseActivity<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BaseActivity</span> <span class=\"keyword\">extends</span> <span class=\"title\">AppCompatActivity</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">onCreate</span><span class=\"params\">(Bundle savedInstanceState)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">super</span>.onCreate(savedInstanceState);</div><div class=\"line\">    <span class=\"comment\">//</span></div><div class=\"line\">    <span class=\"keyword\">for</span> (Class c = <span class=\"keyword\">this</span>.getClass(); c != Context.class; c = c.getSuperclass()) &#123;</div><div class=\"line\">        ContentView annotation = (ContentView) c.getAnnotation(ContentView.class);</div><div class=\"line\">        <span class=\"keyword\">if</span> (annotation != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">                <span class=\"keyword\">this</span>.setContentView(annotation.value());</div><div class=\"line\">            &#125; <span class=\"keyword\">catch</span> (RuntimeException e) &#123;</div><div class=\"line\">                e.printStackTrace();</div><div class=\"line\">            &#125;</div><div class=\"line\">            <span class=\"keyword\">return</span>;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p></p>\n<ul>\n<li></li>\n<li>ContentView</li>\n<li>ContentView</li>\n<li>Activity</li>\n</ul>\n<blockquote>\n<p> @Retention(RetentionPolicy.RUNTIME)</p>\n</blockquote>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Java<strong></strong>Java javac -processor</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>ProcessorProcessorAbstractProcessorprocessJava</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JsonAnnotationProcessor</span> <span class=\"keyword\">extends</span> <span class=\"title\">AbstractProcessor</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"meta\">@Override</span></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">(ProcessingEnvironment env)</span></span>&#123;</div><div class=\"line\">     <span class=\"keyword\">super</span>.init(env);</div><div class=\"line\">     <span class=\"comment\">//ProcessingEnvironment</span></div><div class=\"line\">     <span class=\"comment\">//ElementsTypesFiler</span></div><div class=\"line\">     elementUtils = env.getElementUtils();</div><div class=\"line\">     typeUtils = env.getTypeUtils();</div><div class=\"line\">     filer = env.getFiler();</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"meta\">@Override</span></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> Set&lt;String&gt; <span class=\"title\">getSupportedAnnotationTypes</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    <span class=\"comment\">//</span></div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">super</span>.getSupportedAnnotationTypes();</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"meta\">@Override</span></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> SourceVersion <span class=\"title\">getSupportedSourceVersion</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    <span class=\"comment\">//Java</span></div><div class=\"line\">    <span class=\"keyword\">return</span> SourceVersion.latestSupported();</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"meta\">@Override</span></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">process</span><span class=\"params\">(Set&lt;? extends TypeElement&gt; annotations, RoundEnvironment roundEnv)</span> </span>&#123;</div><div class=\"line\">      <span class=\"comment\">//roundEnv</span></div><div class=\"line\">      <span class=\"comment\">//Butterknife</span></div><div class=\"line\">      Map&lt;TypeElement, BindingClass&gt; targetClassMap = findAndParseTargets(env);</div><div class=\"line\"></div><div class=\"line\">      <span class=\"keyword\">for</span> (Map.Entry&lt;TypeElement, BindingClass&gt; entry : targetClassMap.entrySet()) &#123;</div><div class=\"line\">        TypeElement typeElement = entry.getKey();</div><div class=\"line\">        BindingClass bindingClass = entry.getValue();</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">          JavaFileObject jfo = filer.createSourceFile(bindingClass.getFqcn(), typeElement);</div><div class=\"line\">          Writer writer = jfo.openWriter();</div><div class=\"line\">          writer.write(bindingClass.brewJava());</div><div class=\"line\">          writer.flush();</div><div class=\"line\">          writer.close();</div><div class=\"line\">        &#125; <span class=\"keyword\">catch</span> (IOException e) &#123;</div><div class=\"line\">          error(typeElement, <span class=\"string\">\"Unable to write view binder for type %s: %s\"</span>, typeElement,</div><div class=\"line\">              e.getMessage());</div><div class=\"line\">        &#125;</div><div class=\"line\">      &#125;</div><div class=\"line\"></div><div class=\"line\">      <span class=\"comment\">//  annotations  Processor </span></div><div class=\"line\">      <span class=\"comment\">//true pocessor  Annotations </span></div><div class=\"line\">      <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\">//ButterknifeRoundEnvironment</span></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">private</span> Map&lt;TypeElement, BindingClass&gt; <span class=\"title\">findAndParseTargets</span><span class=\"params\">(RoundEnvironment env)</span> </span>&#123;</div><div class=\"line\">    Map&lt;TypeElement, BindingClass&gt; targetClassMap = <span class=\"keyword\">new</span> LinkedHashMap&lt;TypeElement, BindingClass&gt;();</div><div class=\"line\">    Set&lt;String&gt; erasedTargetNames = <span class=\"keyword\">new</span> LinkedHashSet&lt;String&gt;();</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// Process each @Bind element.</span></div><div class=\"line\">    <span class=\"keyword\">for</span> (Element element : env.getElementsAnnotatedWith(Bind.class)) &#123;</div><div class=\"line\">      <span class=\"comment\">//@Bind</span></div><div class=\"line\">      <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">        parseBind(element, targetClassMap, erasedTargetNames);</div><div class=\"line\">      &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</div><div class=\"line\">        logParsingError(element, Bind.class, e);</div><div class=\"line\">      &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    ......</div><div class=\"line\">  &#125;  </div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<blockquote>\n<p>Processprocess</p>\n</blockquote>\n<p>Java7 getSupportedAnnotationTypes()getSupportedSourceVersion()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@SupportedAnnotationTypes</span>(&#123;</div><div class=\"line\">  <span class=\"comment\">//</span></div><div class=\"line\">&#125;)</div><div class=\"line\"><span class=\"meta\">@SupportedSourceVersion</span>(SourceVersion.RELEASE_7)</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ContentViewProcessor</span> <span class=\"keyword\">extends</span> <span class=\"title\">AbstractProcessor</span> </span>&#123;</div><div class=\"line\">    ...</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<h4 id=\"Element\"><a href=\"#Element\" class=\"headerlink\" title=\"Element\"></a>Element</h4><p>ElementElement@Target</p>\n<blockquote>\n<p>ElementRepresents a program element such as a package, class, or method.<br>Each element represents a static, language-level construct (and not, for example, a runtime construct of the virtual machine).</p>\n</blockquote>\n<p></p>\n<p>Element</p>\n<ul>\n<li><p>ExecutableElement<br>@Target(ElementType.METHOD) @Target(ElementType.CONSTRUCTOR)</p>\n</li>\n<li><p>PackageElement<br>@Target(ElementType.PACKAGE)</p>\n</li>\n<li><p>TypeElement<br><br>@Target(ElementType.TYPE)</p>\n</li>\n</ul>\n<blockquote>\n<p></p>\n</blockquote>\n<ul>\n<li><p>TypeParameterElement<br><br>@Target(ElementType.PARAMETER)</p>\n</li>\n<li><p>VariableElement<br>enum<br>@Target(ElementType.LOCAL_VARIABLE)</p>\n</li>\n</ul>\n<h4 id=\"Processor\"><a href=\"#Processor\" class=\"headerlink\" title=\"Processor\"></a>Processor</h4><p>Processor,ProcessorMessagesProcessorSystem.out</p>\n<p>ProcessorLog: Messager<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//Butterknife</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">error</span><span class=\"params\">(Element element, String message, Object... args)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (args.length &gt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">      message = String.format(message, args);</div><div class=\"line\">    &#125;</div><div class=\"line\">    processingEnv.getMessager().printMessage(Diagnostic.Kind.ERROR, message, element);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>javac -processorjarjar<strong>javax.annotation.processing.processor</strong>jarjarMETA-INF/servicejar</p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/processor_jar.png\" alt=\"http://blog.csdn.net/lmj623565791/article/details/43452969\"></p>\n<p>javax.annotation.processing.Processor</p>\n<p>src/main/javaresourcesMETA-INF/services/javax.annotation.processing.Processor</p>\n<blockquote>\n<p>Android StudioJava LibraryAndroid LibraryAndroid LibraryJDKjavax</p>\n</blockquote>\n<p>GoogleAutoServiceProcessor@AutoService</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@AutoService</span>(Processor.class)</div><div class=\"line\"><span class=\"meta\">@SupportedAnnotationTypes</span>(&#123;</div><div class=\"line\">  <span class=\"comment\">//</span></div><div class=\"line\">&#125;)</div><div class=\"line\"><span class=\"meta\">@SupportedSourceVersion</span>(SourceVersion.RELEASE_7)</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ContentViewProcessor</span> <span class=\"keyword\">extends</span> <span class=\"title\">AbstractProcessor</span> </span>&#123;</div><div class=\"line\">    ...</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"android-apt\"><a href=\"#android-apt\" class=\"headerlink\" title=\"android-apt\"></a>android-apt</h3><p>jarbuild.gradleprovidedcompile</p>\n<p>android-apt</p>\n<p>APT(Annotation Processing Tool),AnnotationAnnotation<br>AnnotationAnnotation(),APTclass</p>\n<p>android-aptAndroid Studio</p>\n<ul>\n<li>APK</li>\n<li>Android Studio</li>\n</ul>\n<h4 id=\"Projectapt\"><a href=\"#Projectapt\" class=\"headerlink\" title=\"Projectapt\"></a>Projectapt</h4><p><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//Projectbuild.gradle</span></div><div class=\"line\">buildscript &#123;</div><div class=\"line\">    repositories &#123;</div><div class=\"line\">      mavenCentral()</div><div class=\"line\">    &#125;</div><div class=\"line\">    dependencies &#123;</div><div class=\"line\">        ...</div><div class=\"line\">        <span class=\"comment\">//android-apt</span></div><div class=\"line\">        classpath <span class=\"string\">'com.neenbedankt.gradle.plugins:android-apt:1.8'</span></div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">apply plugin: <span class=\"string\">'com.neenbedankt.android-apt'</span></div></pre></td></tr></table></figure></p>\n<p>apt<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">dependencies &#123;</div><div class=\"line\">   apt<span class=\"string\">'com.bluelinelabs:logansquare-compiler:1.3.6'</span></div><div class=\"line\">   compile <span class=\"string\">'com.bluelinelabs:logansquare:1.3.6'</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p><a href=\"https://github.com/bluelinelabs/LoganSquare\" target=\"_blank\" rel=\"external\">LoganSquare</a>JSONcompilerLoganSquare</p>\n<h4 id=\"Moduleapt\"><a href=\"#Moduleapt\" class=\"headerlink\" title=\"Moduleapt\"></a>Moduleapt</h4><p>Modulebuild.gradle</p>\n<p>aptDaggerDagger-compilerdaggerdagger-commpilerdagger<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//Modulebuild.gradle</span></div><div class=\"line\">apply plugin: <span class=\"string\">'com.android.application'</span></div><div class=\"line\">apply plugin: <span class=\"string\">'com.neenbedankt.android-apt'</span></div><div class=\"line\"></div><div class=\"line\">dependencies &#123;</div><div class=\"line\"> apt <span class=\"string\">'com.squareup.dagger:dagger-compiler:1.1.0'</span></div><div class=\"line\"> compile <span class=\"string\">'com.squareup.dagger:dagger:1.1.0'</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>provided vs apt<br>  provided classesIDEclassesGuavaimportAndroid crash<br>  provided<br>  aptclassessourceIDEAndroid Studio</p>\n</blockquote>\n<p>aptDBflowDagger2ButterKnifeActivityRouterAptPreferencesAnnotation</p>\n<h3 id=\"APTannotation\"><a href=\"#APTannotation\" class=\"headerlink\" title=\"APTannotation\"></a>APTannotation</h3><p><strong>AbstractProcess+javaPoet+AutoService+apt</strong></p>\n<p></p>\n<ul>\n<li>1.@inject</li>\n<li>2.</li>\n<li>3.Java</li>\n<li>4.</li>\n<li>5.APT</li>\n</ul>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/apt_processor.png\" alt=\"http://blog.csdn.net/xx326664162/article/details/68490059\"></p>\n<h3 id=\"annotationProcessor\"><a href=\"#annotationProcessor\" class=\"headerlink\" title=\"annotationProcessor\"></a>annotationProcessor</h3><p>annotationProcessorAPTgooglebuild.gradle<br>ButterKnifeannotationProcessor</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">dependencies &#123;</div><div class=\"line\">     <span class=\"function\">annotationProcessor <span class=\"title\">project</span><span class=\"params\">(<span class=\"string\">':xx'</span>)</span></span></div><div class=\"line\">     annotationProcessor 'com.jakewharton:butterknife-compiler:8.5.1'</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<blockquote>\n<p>apt vs annotationProcessor<br>  android-aptapt<a href=\"https://bitbucket.org/hvisser/android-apt\" target=\"_blank\" rel=\"external\"></a>Android Gradle  2.2 Android Gradle  annotationProcessor  android-apt android-apt Android GradleannotationProcessorandroid-apt  Android annotationProcessor<br>  Android Nandroid Java 8Java 8Jackandroid-aptjavacannotationProcessorjavacjack</p>\n</blockquote>\n<p>annotationProcessorandroid-apt<a href=\"http://www.cnblogs.com/whoislcj/p/6148410.html\" target=\"_blank\" rel=\"external\"></a></p>\n<p></p>\n<p><a href=\"http://blog.csdn.net/lmj623565791/article/details/43452969\" target=\"_blank\" rel=\"external\">Android  </a><br><a href=\"https://joyrun.github.io/2016/07/19/AptHelloWorld/\" target=\"_blank\" rel=\"external\">Android APT</a><br><a href=\"https://lizhaoxuan.github.io/2016/07/17/apt-wathapt/\" target=\"_blank\" rel=\"external\">Android1-</a><br><a href=\"http://blog.csdn.net/xx326664162/article/details/68490059\" target=\"_blank\" rel=\"external\">APTannotationProcessorandroid-aptProvided</a><br><a href=\"https://www.amazon.cn/%E5%9B%BE%E4%B9%A6/dp/B01MPY3VNG/ref=sr_1_1?ie=UTF8&amp;qid=1491812168&amp;sr=8-1\" target=\"_blank\" rel=\"external\">AndroidAndroid</a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/04/10/Annotation-Android-usage/\">http://agehua.github.io/2017/04/10/Annotation-Android-usage/</a></p>\n","readingTime":{"text":"6 min read","minutes":5.51,"time":330599.99999999994,"words":1102},"excerpt":"<h2 id=\"Android\"><a href=\"#Android\" class=\"headerlink\" title=\"Android\"></a>Android</h2><p>Java @Interface </p>\n<p><a href=\"https://agehua.github.io/2017/03/14/Android-CDI/\">Injection(CDI)assertion()</a>JavaCDIAndroid</p>\n<p>AndroidViewButterknifeBind</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Retention</span> (RetentionPolicy.Class)</div><div class=\"line\"><span class=\"meta\">@Target</span> (ElementType.FIELD)</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> Bind &#123;</div><div class=\"line\">   <span class=\"comment\">/** View ID to which the field will be found. **/</span></div><div class=\"line\">   <span class=\"keyword\">int</span>[] value();</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>@interface Java.class@Retention @Target </p>\n<h3 id=\"Java\"><a href=\"#Java\" class=\"headerlink\" title=\"Java\"></a>Java</h3>","more":"<p>Java APIjava.langjava.lang.annotationjavax.annotation</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<ul>\n<li>@Override</li>\n<li>@Deprecated</li>\n<li>@SuppressWarnings</li>\n<li>@SafeVarargs</li>\n<li>@Generated@Generated</li>\n<li>@FunctionalInterface</li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>JavaEEAndroid\b<br></p>\n<ul>\n<li>@PostConstruct</li>\n<li>@PreDestroy</li>\n<li>@Resource</li>\n<li>@Resources</li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>ButterknifeBind</p>\n<p></p>\n<ul>\n<li>@Retention, <ul>\n<li>@Retention(RetentionPolicy.SOURCE) .java .class</li>\n<li>@Retention(RetentionPolicy.CLASS) .java .classJava</li>\n<li>@Retention(RetentionPolicy.RUNTIME)Java<br>CLASS</li>\n</ul>\n</li>\n<li>@Target, ElementType</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\"></th>\n<th style=\"text-align:left\"></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">ANNOTATION_TYPE</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">CONSTRUCTOR</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">FIELD</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">LOCAL_VARIABLE</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">METHOD</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">PACKAGE</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">PARAMETER</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">TYPE</td>\n<td style=\"text-align:left\">enum</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">TYPE_PARAMETER</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">TYPE_USE</td>\n<td style=\"text-align:left\"></td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p>@TargetTYPE_USETYPE_PARAMETER</p>\n</blockquote>\n<ul>\n<li>@Inherited, </li>\n<li>@Documented, JavaDoc</li>\n<li>@Repeatable, Java 8Java 5</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> @Retention(RetentionPolicy.RUNTIME)</p>\n<blockquote>\n<p>ButterknifeView8.0.0</p>\n</blockquote>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>Demo</p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">onCreate</span><span class=\"params\">(Bundle savedInstanceState)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">super</span>.onCreate(savedInstanceState);</div><div class=\"line\">    setContentView(R.layout.activity_home);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@ContentView</span>(R.layout.activity_home)</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">HomeActivity</span> <span class=\"keyword\">extends</span> <span class=\"title\">BaseActivity</span> </span>&#123;</div><div class=\"line\">    ...</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p></p>\n<p></p>\n<ul>\n<li><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</div><div class=\"line\"><span class=\"meta\">@Target</span>(&#123;ElementType.TYPE&#125;)</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> ContentView &#123;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">value</span><span class=\"params\">()</span></span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n</li>\n</ul>\n<p></p>\n<ul>\n<li>public @interface ContentView</li>\n</ul>\n<p>interfaceContentViewclassenum@interface</p>\n<p>ElementTypeclassinterfaceAnnotationenumElementType.Typeinterface@interface</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/** Class, interface (including annotation type), or enum declaration */</span></div><div class=\"line\">TYPE,</div></pre></td></tr></table></figure>\n<ul>\n<li>int value();</li>\n</ul>\n<p><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@ContentView</span>(R.layout.activity_home)</div></pre></td></tr></table></figure></p>\n<p>R.layout.activity_home intid</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@ContentView</span>(string)</div></pre></td></tr></table></figure>\n<p><a href=\"https://lizhaoxuan.github.io/2016/07/17/apt-Grammar-explanation/\">Android-</a></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@ContentView</span>(R.layout.activity_home)</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">HomeActivity</span> <span class=\"keyword\">extends</span> <span class=\"title\">BaseActivity</span> </span>&#123;</div><div class=\"line\">    ...</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>BaseActivityBaseActivity<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BaseActivity</span> <span class=\"keyword\">extends</span> <span class=\"title\">AppCompatActivity</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">onCreate</span><span class=\"params\">(Bundle savedInstanceState)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">super</span>.onCreate(savedInstanceState);</div><div class=\"line\">    <span class=\"comment\">//</span></div><div class=\"line\">    <span class=\"keyword\">for</span> (Class c = <span class=\"keyword\">this</span>.getClass(); c != Context.class; c = c.getSuperclass()) &#123;</div><div class=\"line\">        ContentView annotation = (ContentView) c.getAnnotation(ContentView.class);</div><div class=\"line\">        <span class=\"keyword\">if</span> (annotation != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">                <span class=\"keyword\">this</span>.setContentView(annotation.value());</div><div class=\"line\">            &#125; <span class=\"keyword\">catch</span> (RuntimeException e) &#123;</div><div class=\"line\">                e.printStackTrace();</div><div class=\"line\">            &#125;</div><div class=\"line\">            <span class=\"keyword\">return</span>;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p></p>\n<ul>\n<li></li>\n<li>ContentView</li>\n<li>ContentView</li>\n<li>Activity</li>\n</ul>\n<blockquote>\n<p> @Retention(RetentionPolicy.RUNTIME)</p>\n</blockquote>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Java<strong></strong>Java javac -processor</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>ProcessorProcessorAbstractProcessorprocessJava</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JsonAnnotationProcessor</span> <span class=\"keyword\">extends</span> <span class=\"title\">AbstractProcessor</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"meta\">@Override</span></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">(ProcessingEnvironment env)</span></span>&#123;</div><div class=\"line\">     <span class=\"keyword\">super</span>.init(env);</div><div class=\"line\">     <span class=\"comment\">//ProcessingEnvironment</span></div><div class=\"line\">     <span class=\"comment\">//ElementsTypesFiler</span></div><div class=\"line\">     elementUtils = env.getElementUtils();</div><div class=\"line\">     typeUtils = env.getTypeUtils();</div><div class=\"line\">     filer = env.getFiler();</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"meta\">@Override</span></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> Set&lt;String&gt; <span class=\"title\">getSupportedAnnotationTypes</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    <span class=\"comment\">//</span></div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">super</span>.getSupportedAnnotationTypes();</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"meta\">@Override</span></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> SourceVersion <span class=\"title\">getSupportedSourceVersion</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    <span class=\"comment\">//Java</span></div><div class=\"line\">    <span class=\"keyword\">return</span> SourceVersion.latestSupported();</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"meta\">@Override</span></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">process</span><span class=\"params\">(Set&lt;? extends TypeElement&gt; annotations, RoundEnvironment roundEnv)</span> </span>&#123;</div><div class=\"line\">      <span class=\"comment\">//roundEnv</span></div><div class=\"line\">      <span class=\"comment\">//Butterknife</span></div><div class=\"line\">      Map&lt;TypeElement, BindingClass&gt; targetClassMap = findAndParseTargets(env);</div><div class=\"line\"></div><div class=\"line\">      <span class=\"keyword\">for</span> (Map.Entry&lt;TypeElement, BindingClass&gt; entry : targetClassMap.entrySet()) &#123;</div><div class=\"line\">        TypeElement typeElement = entry.getKey();</div><div class=\"line\">        BindingClass bindingClass = entry.getValue();</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">          JavaFileObject jfo = filer.createSourceFile(bindingClass.getFqcn(), typeElement);</div><div class=\"line\">          Writer writer = jfo.openWriter();</div><div class=\"line\">          writer.write(bindingClass.brewJava());</div><div class=\"line\">          writer.flush();</div><div class=\"line\">          writer.close();</div><div class=\"line\">        &#125; <span class=\"keyword\">catch</span> (IOException e) &#123;</div><div class=\"line\">          error(typeElement, <span class=\"string\">\"Unable to write view binder for type %s: %s\"</span>, typeElement,</div><div class=\"line\">              e.getMessage());</div><div class=\"line\">        &#125;</div><div class=\"line\">      &#125;</div><div class=\"line\"></div><div class=\"line\">      <span class=\"comment\">//  annotations  Processor </span></div><div class=\"line\">      <span class=\"comment\">//true pocessor  Annotations </span></div><div class=\"line\">      <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\">//ButterknifeRoundEnvironment</span></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">private</span> Map&lt;TypeElement, BindingClass&gt; <span class=\"title\">findAndParseTargets</span><span class=\"params\">(RoundEnvironment env)</span> </span>&#123;</div><div class=\"line\">    Map&lt;TypeElement, BindingClass&gt; targetClassMap = <span class=\"keyword\">new</span> LinkedHashMap&lt;TypeElement, BindingClass&gt;();</div><div class=\"line\">    Set&lt;String&gt; erasedTargetNames = <span class=\"keyword\">new</span> LinkedHashSet&lt;String&gt;();</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// Process each @Bind element.</span></div><div class=\"line\">    <span class=\"keyword\">for</span> (Element element : env.getElementsAnnotatedWith(Bind.class)) &#123;</div><div class=\"line\">      <span class=\"comment\">//@Bind</span></div><div class=\"line\">      <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">        parseBind(element, targetClassMap, erasedTargetNames);</div><div class=\"line\">      &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</div><div class=\"line\">        logParsingError(element, Bind.class, e);</div><div class=\"line\">      &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    ......</div><div class=\"line\">  &#125;  </div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<blockquote>\n<p>Processprocess</p>\n</blockquote>\n<p>Java7 getSupportedAnnotationTypes()getSupportedSourceVersion()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@SupportedAnnotationTypes</span>(&#123;</div><div class=\"line\">  <span class=\"comment\">//</span></div><div class=\"line\">&#125;)</div><div class=\"line\"><span class=\"meta\">@SupportedSourceVersion</span>(SourceVersion.RELEASE_7)</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ContentViewProcessor</span> <span class=\"keyword\">extends</span> <span class=\"title\">AbstractProcessor</span> </span>&#123;</div><div class=\"line\">    ...</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<h4 id=\"Element\"><a href=\"#Element\" class=\"headerlink\" title=\"Element\"></a>Element</h4><p>ElementElement@Target</p>\n<blockquote>\n<p>ElementRepresents a program element such as a package, class, or method.<br>Each element represents a static, language-level construct (and not, for example, a runtime construct of the virtual machine).</p>\n</blockquote>\n<p></p>\n<p>Element</p>\n<ul>\n<li><p>ExecutableElement<br>@Target(ElementType.METHOD) @Target(ElementType.CONSTRUCTOR)</p>\n</li>\n<li><p>PackageElement<br>@Target(ElementType.PACKAGE)</p>\n</li>\n<li><p>TypeElement<br><br>@Target(ElementType.TYPE)</p>\n</li>\n</ul>\n<blockquote>\n<p></p>\n</blockquote>\n<ul>\n<li><p>TypeParameterElement<br><br>@Target(ElementType.PARAMETER)</p>\n</li>\n<li><p>VariableElement<br>enum<br>@Target(ElementType.LOCAL_VARIABLE)</p>\n</li>\n</ul>\n<h4 id=\"Processor\"><a href=\"#Processor\" class=\"headerlink\" title=\"Processor\"></a>Processor</h4><p>Processor,ProcessorMessagesProcessorSystem.out</p>\n<p>ProcessorLog: Messager<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//Butterknife</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">error</span><span class=\"params\">(Element element, String message, Object... args)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (args.length &gt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">      message = String.format(message, args);</div><div class=\"line\">    &#125;</div><div class=\"line\">    processingEnv.getMessager().printMessage(Diagnostic.Kind.ERROR, message, element);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>javac -processorjarjar<strong>javax.annotation.processing.processor</strong>jarjarMETA-INF/servicejar</p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/processor_jar.png\" alt=\"http://blog.csdn.net/lmj623565791/article/details/43452969\"></p>\n<p>javax.annotation.processing.Processor</p>\n<p>src/main/javaresourcesMETA-INF/services/javax.annotation.processing.Processor</p>\n<blockquote>\n<p>Android StudioJava LibraryAndroid LibraryAndroid LibraryJDKjavax</p>\n</blockquote>\n<p>GoogleAutoServiceProcessor@AutoService</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@AutoService</span>(Processor.class)</div><div class=\"line\"><span class=\"meta\">@SupportedAnnotationTypes</span>(&#123;</div><div class=\"line\">  <span class=\"comment\">//</span></div><div class=\"line\">&#125;)</div><div class=\"line\"><span class=\"meta\">@SupportedSourceVersion</span>(SourceVersion.RELEASE_7)</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ContentViewProcessor</span> <span class=\"keyword\">extends</span> <span class=\"title\">AbstractProcessor</span> </span>&#123;</div><div class=\"line\">    ...</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"android-apt\"><a href=\"#android-apt\" class=\"headerlink\" title=\"android-apt\"></a>android-apt</h3><p>jarbuild.gradleprovidedcompile</p>\n<p>android-apt</p>\n<p>APT(Annotation Processing Tool),AnnotationAnnotation<br>AnnotationAnnotation(),APTclass</p>\n<p>android-aptAndroid Studio</p>\n<ul>\n<li>APK</li>\n<li>Android Studio</li>\n</ul>\n<h4 id=\"Projectapt\"><a href=\"#Projectapt\" class=\"headerlink\" title=\"Projectapt\"></a>Projectapt</h4><p><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//Projectbuild.gradle</span></div><div class=\"line\">buildscript &#123;</div><div class=\"line\">    repositories &#123;</div><div class=\"line\">      mavenCentral()</div><div class=\"line\">    &#125;</div><div class=\"line\">    dependencies &#123;</div><div class=\"line\">        ...</div><div class=\"line\">        <span class=\"comment\">//android-apt</span></div><div class=\"line\">        classpath <span class=\"string\">'com.neenbedankt.gradle.plugins:android-apt:1.8'</span></div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">apply plugin: <span class=\"string\">'com.neenbedankt.android-apt'</span></div></pre></td></tr></table></figure></p>\n<p>apt<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">dependencies &#123;</div><div class=\"line\">   apt<span class=\"string\">'com.bluelinelabs:logansquare-compiler:1.3.6'</span></div><div class=\"line\">   compile <span class=\"string\">'com.bluelinelabs:logansquare:1.3.6'</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p><a href=\"https://github.com/bluelinelabs/LoganSquare\">LoganSquare</a>JSONcompilerLoganSquare</p>\n<h4 id=\"Moduleapt\"><a href=\"#Moduleapt\" class=\"headerlink\" title=\"Moduleapt\"></a>Moduleapt</h4><p>Modulebuild.gradle</p>\n<p>aptDaggerDagger-compilerdaggerdagger-commpilerdagger<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//Modulebuild.gradle</span></div><div class=\"line\">apply plugin: <span class=\"string\">'com.android.application'</span></div><div class=\"line\">apply plugin: <span class=\"string\">'com.neenbedankt.android-apt'</span></div><div class=\"line\"></div><div class=\"line\">dependencies &#123;</div><div class=\"line\"> apt <span class=\"string\">'com.squareup.dagger:dagger-compiler:1.1.0'</span></div><div class=\"line\"> compile <span class=\"string\">'com.squareup.dagger:dagger:1.1.0'</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>provided vs apt<br>  provided classesIDEclassesGuavaimportAndroid crash<br>  provided<br>  aptclassessourceIDEAndroid Studio</p>\n</blockquote>\n<p>aptDBflowDagger2ButterKnifeActivityRouterAptPreferencesAnnotation</p>\n<h3 id=\"APTannotation\"><a href=\"#APTannotation\" class=\"headerlink\" title=\"APTannotation\"></a>APTannotation</h3><p><strong>AbstractProcess+javaPoet+AutoService+apt</strong></p>\n<p></p>\n<ul>\n<li>1.@inject</li>\n<li>2.</li>\n<li>3.Java</li>\n<li>4.</li>\n<li>5.APT</li>\n</ul>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/apt_processor.png\" alt=\"http://blog.csdn.net/xx326664162/article/details/68490059\"></p>\n<h3 id=\"annotationProcessor\"><a href=\"#annotationProcessor\" class=\"headerlink\" title=\"annotationProcessor\"></a>annotationProcessor</h3><p>annotationProcessorAPTgooglebuild.gradle<br>ButterKnifeannotationProcessor</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">dependencies &#123;</div><div class=\"line\">     <span class=\"function\">annotationProcessor <span class=\"title\">project</span><span class=\"params\">(<span class=\"string\">':xx'</span>)</span></div><div class=\"line\">     annotationProcessor 'com.jakewharton:butterknife-compiler:8.5.1'</div><div class=\"line\">&#125;</span></div></pre></td></tr></table></figure>\n<blockquote>\n<p>apt vs annotationProcessor<br>  android-aptapt<a href=\"https://bitbucket.org/hvisser/android-apt\"></a>Android Gradle  2.2 Android Gradle  annotationProcessor  android-apt android-apt Android GradleannotationProcessorandroid-apt  Android annotationProcessor<br>  Android Nandroid Java 8Java 8Jackandroid-aptjavacannotationProcessorjavacjack</p>\n</blockquote>\n<p>annotationProcessorandroid-apt<a href=\"http://www.cnblogs.com/whoislcj/p/6148410.html\"></a></p>\n<p></p>\n<p><a href=\"http://blog.csdn.net/lmj623565791/article/details/43452969\">Android  </a><br><a href=\"https://joyrun.github.io/2016/07/19/AptHelloWorld/\">Android APT</a><br><a href=\"https://lizhaoxuan.github.io/2016/07/17/apt-wathapt/\">Android1-</a><br><a href=\"http://blog.csdn.net/xx326664162/article/details/68490059\">APTannotationProcessorandroid-aptProvided</a><br><a href=\"https://www.amazon.cn/%E5%9B%BE%E4%B9%A6/dp/B01MPY3VNG/ref=sr_1_1?ie=UTF8&amp;qid=1491812168&amp;sr=8-1\">AndroidAndroid</a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/04/10/Annotation-Android-usage/\">http://agehua.github.io/2017/04/10/Annotation-Android-usage/</a></p>"},{"layout":"post","title":"Android","keywords":"EIT, Object-oriented, Framework","banner":"http://obxk8w81b.bkt.clouddn.com/Beach%20at%20Scheveningen%20in%20Calm%20Weather.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Beach%20at%20Scheveningen%20in%20Calm%20Weather.jpg","toc":true,"_content":"\n## Android By \n-Oriented\n -Oriented \n Object-oriented\nNothing else \n\n\n-Driven; :Model-drivenUse Case-driven\n-- -driven\n-- (Driver);\n\n-Centered; :Architecture-centered Architecture-centeric\n--\n\n\n### \n (Hook)(Plug and Play, PnP)\n<!--more-->\n\n (Separate code that changes from the code that doesnt)(Hook)\n (Variant)(Invariant)(Super- class) (Subclass)\n\nJava(abstract)(overridable)\n\n### IoCDefault\n\n#### IoC\n (IoC: Inversion of Control)\n IoCOO(C++) C++IoC\n  Hook\n   \n\n#### (Default)\n :()\n (Default)()\n\n~~~ Java\ninterface IShape {\n  void template_paint(Graphics gr);\n} // \n~~~\n\n~~~ Java\n// Shape.java\nimport java.awt.*;\npublic abstract class Shape implements IShape {\n  public void template_paint(Graphics gr){ //\n    invariant_paint(gr); //\n    hook_paint(gr); //\n  }\n  private void invariant_paint(Graphics gr){\n    gr.setColor(Color.black); gr.fillRect(10,30, 200,100);\n  }\n\n  abstract protected void hook_paint(Graphics gr);\n}\n~~~\n\n~~~ Java\n// Bird.java\nimport java.awt.*;\npublic class Bird extends Shape {\n  private void hook_paint(Graphics gr){ //\n    gr.setColor(Color.cyan);\n    gr.drawArc(30,80,90,110,40,100);\n    gr.drawArc(88,93,90,100,40,80);\n    gr.setColor(Color.white);\n    gr.drawArc(30,55,90,150,35,75);\n    gr.drawArc(90,80,90,90,40,80);\n  }\n}  \n~~~\n\nAndroidActivityActivityonCreate()onCreate()IOC\n\n## EIT\n\n> <><>\n\nEITAndroid\n\n---\n\nEIT(Structure)(Concept)EIT(Form)\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/EIT-form.png)\n\n\n- &lt;E&I&gt;&lt;T&gt;\n- &lt;E&I&gt;\n\nEIT\n\n****\n<E>N&lt;T&gt;1+2+3+ ... + N1+2^2+ ... + N^2&lt;E&gt;\n\n> &lt;I&gt;:\n1.&lt;T&gt;&lt;T&gt;(IoC)&lt;T&gt;&lt;E&gt;N&lt;T&gt;\n2.&lt;T&gt;&lt;E&gt;\n3.&lt;T&gt;\n\n\n\n~~~ Java\n//Counter.java<I>\npublic abstract class Counter {\n  public int run(){\n      int N = getCount();\n      return onCal(N);\n  }\n  public int getCount() { return 6; }\n  protected abstract int onCal(int n);\n}\n~~~\n\n~~~ Java\n//myCounter.java<T>\npublic class myCounter extends Counter{\n\n  @Override\n  protected int onCal(int n) {\n    int sum = 0;\n    for(int i=1; i<=n; i++) {\n      sum += i;\n    }\n    return sum;\n  }\n}\n~~~\n\n~~~ Java\n//<E>\ncounter = new myCounter();\nint sum = counter.run();\n~~~\n\n()(Interface)&lt;E&gt;&lt;T&gt;API\n\n## IPC\n\nIPC(Inter-Process Communication) (Process)\n\n### IPC\n- (App) AndroidZygote(Fork)(Process)(App)\n- Linux()() \n- IPC\n\n- Android IPC\n- Android(Virtual MachineVM)JavaJNIJavaC/C++:\n\n![:VMMQLooper](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/process-ipc-structure.png)\n\n> \n\n(Main Thread)LooperMQ(Message Queue)Looper\n\nUI(Event)UIAndroid(Message)MQMQLooperMQ\n\n### IPCIBinder -- \n(Function Call)IPC\n\nAndroidIPCIBinderClientIBindertransact()IPC(Remote)onTransact()\n\nJavaIBinder IBinder.java\n~~~ Java\n// IBinder.java\n// .......\npublic interface IBinder {\n// ........\npublic boolean transact(int code, Parcel data, Parcel reply, int flags)\n  throws RemoteException; // ...........\n}\n~~~\n\nIBinderClient(): transact()\n\nAndroidBinderIBinder\n\n![javaBinder](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/ibinder-binder.png)\n\nBinder ServiceClient ServiceBinderBinder.java:\n~~~ Java\n// Binder.java\n// .......\npublic class Binder implements IBinder {\n  // ..........\n  private int mObject;\n  public Binder() {\n    init();\n  // ...........\n  }\n  //IBindertransact()\n  public final boolean transact(int code, Parcel data, Parcel reply, int flags)\n    throws RemoteException {\n    // ................\n    boolean r = onTransact(code, data, reply, flags); return r;\n  }\n\n  //transact()C/C++\n  private boolean execTransact(int code, int dataObj, int replyObj, int flags) {\n    Parcel data = Parcel.obtain(dataObj); Parcel reply = Parcel.obtain(replyObj);\n    boolean res;\n    res = onTransact(code, data, reply, flags);\n    // ............\n    return res;\n  }\n\n  //(Override).\n  //transact() execTransact()onTransact()(IoC, Inversion of Control)\n  protected boolean onTransact(int code, Parcel data, Parcel reply, int flags)\n    throws RemoteException {\n  }\n\n  //(Native)JNI.\n  //Binder()init()\n  private native final void init();\n}\n~~~\n\nBinderEIT&lt;E&gt;\n\nIBinderBinder(&lt;E&gt;)Client&lt;CI&gt;\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-EIT.png)\n\nonTransact()EIT&lt;I&gt;</>IoC\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-EIT-onTransact.png)\n\n\nActivityMediaPlayerMP3.\n\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-example-media.png)\n\nmyActivityIBindermyActivityJavaIBinderC/C++BinderBinderexecTransact()myBinderonTransact():\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-example-media-detail.png)\n\n### IPC\nMediaPlayerIPC:\n- **Step-1.** ActivitystartService()Service\n- **Step-2.** ActivitybindService()ServiceActivityService(Connection)\n- **Step-3.** ActivityIBindertransact() Binder DriverBinderexecTransact()  myBinderonTransact()\n","source":"_posts/2017-05-11-Object-Oriented.md","raw":"---\nlayout: post\ntitle:  Android\ncategory: accumulation\ntags:\n  - Android Framework\n  - EIT\n  - Object-oriented\nkeywords: EIT, Object-oriented, Framework\nbanner: http://obxk8w81b.bkt.clouddn.com/Beach%20at%20Scheveningen%20in%20Calm%20Weather.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Beach%20at%20Scheveningen%20in%20Calm%20Weather.jpg\ntoc: true\n---\n\n## Android By \n-Oriented\n -Oriented \n Object-oriented\nNothing else \n\n\n-Driven; :Model-drivenUse Case-driven\n-- -driven\n-- (Driver);\n\n-Centered; :Architecture-centered Architecture-centeric\n--\n\n\n### \n (Hook)(Plug and Play, PnP)\n<!--more-->\n\n (Separate code that changes from the code that doesnt)(Hook)\n (Variant)(Invariant)(Super- class) (Subclass)\n\nJava(abstract)(overridable)\n\n### IoCDefault\n\n#### IoC\n (IoC: Inversion of Control)\n IoCOO(C++) C++IoC\n  Hook\n   \n\n#### (Default)\n :()\n (Default)()\n\n~~~ Java\ninterface IShape {\n  void template_paint(Graphics gr);\n} // \n~~~\n\n~~~ Java\n// Shape.java\nimport java.awt.*;\npublic abstract class Shape implements IShape {\n  public void template_paint(Graphics gr){ //\n    invariant_paint(gr); //\n    hook_paint(gr); //\n  }\n  private void invariant_paint(Graphics gr){\n    gr.setColor(Color.black); gr.fillRect(10,30, 200,100);\n  }\n\n  abstract protected void hook_paint(Graphics gr);\n}\n~~~\n\n~~~ Java\n// Bird.java\nimport java.awt.*;\npublic class Bird extends Shape {\n  private void hook_paint(Graphics gr){ //\n    gr.setColor(Color.cyan);\n    gr.drawArc(30,80,90,110,40,100);\n    gr.drawArc(88,93,90,100,40,80);\n    gr.setColor(Color.white);\n    gr.drawArc(30,55,90,150,35,75);\n    gr.drawArc(90,80,90,90,40,80);\n  }\n}  \n~~~\n\nAndroidActivityActivityonCreate()onCreate()IOC\n\n## EIT\n\n> <><>\n\nEITAndroid\n\n---\n\nEIT(Structure)(Concept)EIT(Form)\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/EIT-form.png)\n\n\n- &lt;E&I&gt;&lt;T&gt;\n- &lt;E&I&gt;\n\nEIT\n\n****\n<E>N&lt;T&gt;1+2+3+ ... + N1+2^2+ ... + N^2&lt;E&gt;\n\n> &lt;I&gt;:\n1.&lt;T&gt;&lt;T&gt;(IoC)&lt;T&gt;&lt;E&gt;N&lt;T&gt;\n2.&lt;T&gt;&lt;E&gt;\n3.&lt;T&gt;\n\n\n\n~~~ Java\n//Counter.java<I>\npublic abstract class Counter {\n  public int run(){\n      int N = getCount();\n      return onCal(N);\n  }\n  public int getCount() { return 6; }\n  protected abstract int onCal(int n);\n}\n~~~\n\n~~~ Java\n//myCounter.java<T>\npublic class myCounter extends Counter{\n\n  @Override\n  protected int onCal(int n) {\n    int sum = 0;\n    for(int i=1; i<=n; i++) {\n      sum += i;\n    }\n    return sum;\n  }\n}\n~~~\n\n~~~ Java\n//<E>\ncounter = new myCounter();\nint sum = counter.run();\n~~~\n\n()(Interface)&lt;E&gt;&lt;T&gt;API\n\n## IPC\n\nIPC(Inter-Process Communication) (Process)\n\n### IPC\n- (App) AndroidZygote(Fork)(Process)(App)\n- Linux()() \n- IPC\n\n- Android IPC\n- Android(Virtual MachineVM)JavaJNIJavaC/C++:\n\n![:VMMQLooper](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/process-ipc-structure.png)\n\n> \n\n(Main Thread)LooperMQ(Message Queue)Looper\n\nUI(Event)UIAndroid(Message)MQMQLooperMQ\n\n### IPCIBinder -- \n(Function Call)IPC\n\nAndroidIPCIBinderClientIBindertransact()IPC(Remote)onTransact()\n\nJavaIBinder IBinder.java\n~~~ Java\n// IBinder.java\n// .......\npublic interface IBinder {\n// ........\npublic boolean transact(int code, Parcel data, Parcel reply, int flags)\n  throws RemoteException; // ...........\n}\n~~~\n\nIBinderClient(): transact()\n\nAndroidBinderIBinder\n\n![javaBinder](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/ibinder-binder.png)\n\nBinder ServiceClient ServiceBinderBinder.java:\n~~~ Java\n// Binder.java\n// .......\npublic class Binder implements IBinder {\n  // ..........\n  private int mObject;\n  public Binder() {\n    init();\n  // ...........\n  }\n  //IBindertransact()\n  public final boolean transact(int code, Parcel data, Parcel reply, int flags)\n    throws RemoteException {\n    // ................\n    boolean r = onTransact(code, data, reply, flags); return r;\n  }\n\n  //transact()C/C++\n  private boolean execTransact(int code, int dataObj, int replyObj, int flags) {\n    Parcel data = Parcel.obtain(dataObj); Parcel reply = Parcel.obtain(replyObj);\n    boolean res;\n    res = onTransact(code, data, reply, flags);\n    // ............\n    return res;\n  }\n\n  //(Override).\n  //transact() execTransact()onTransact()(IoC, Inversion of Control)\n  protected boolean onTransact(int code, Parcel data, Parcel reply, int flags)\n    throws RemoteException {\n  }\n\n  //(Native)JNI.\n  //Binder()init()\n  private native final void init();\n}\n~~~\n\nBinderEIT&lt;E&gt;\n\nIBinderBinder(&lt;E&gt;)Client&lt;CI&gt;\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-EIT.png)\n\nonTransact()EIT&lt;I&gt;</>IoC\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-EIT-onTransact.png)\n\n\nActivityMediaPlayerMP3.\n\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-example-media.png)\n\nmyActivityIBindermyActivityJavaIBinderC/C++BinderBinderexecTransact()myBinderonTransact():\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-example-media-detail.png)\n\n### IPC\nMediaPlayerIPC:\n- **Step-1.** ActivitystartService()Service\n- **Step-2.** ActivitybindService()ServiceActivityService(Connection)\n- **Step-3.** ActivityIBindertransact() Binder DriverBinderexecTransact()  myBinderonTransact()\n","slug":"Object-Oriented","published":1,"date":"2017-05-10T16:00:00.000Z","updated":"2017-11-23T07:15:17.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ec0q0037d6ykxkej7qv3","content":"<h2 id=\"Android-By-\"><a href=\"#Android-By-\" class=\"headerlink\" title=\"Android By \"></a>Android By </h2><p>-Oriented<br> -Oriented <br> Object-oriented<br>Nothing else </p>\n<p>-Driven; :Model-drivenUse Case-driven<br> -driven<br> (Driver);</p>\n<p>-Centered; :Architecture-centered Architecture-centeric<br></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> (Hook)(Plug and Play, PnP)<br><a id=\"more\"></a></p>\n<p> (Separate code that changes from the code that doesnt)(Hook)<br> (Variant)(Invariant)(Super- class) (Subclass)</p>\n<p>Java(abstract)(overridable)</p>\n<h3 id=\"IoCDefault\"><a href=\"#IoCDefault\" class=\"headerlink\" title=\"IoCDefault\"></a>IoCDefault</h3><h4 id=\"IoC\"><a href=\"#IoC\" class=\"headerlink\" title=\"IoC\"></a>IoC</h4><p> (IoC: Inversion of Control)<br> IoCOO(C++) C++IoC<br>  Hook<br>   </p>\n<h4 id=\"-Default-\"><a href=\"#-Default-\" class=\"headerlink\" title=\"(Default)\"></a>(Default)</h4><p> :()<br> (Default)()</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">IShape</span> </span>&#123;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">template_paint</span><span class=\"params\">(Graphics gr)</span></span>;</div><div class=\"line\">&#125; <span class=\"comment\">// </span></div></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// Shape.java</span></div><div class=\"line\"><span class=\"keyword\">import</span> java.awt.*;</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Shape</span> <span class=\"keyword\">implements</span> <span class=\"title\">IShape</span> </span>&#123;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">template_paint</span><span class=\"params\">(Graphics gr)</span></span>&#123; <span class=\"comment\">//</span></div><div class=\"line\">    invariant_paint(gr); <span class=\"comment\">//</span></div><div class=\"line\">    hook_paint(gr); <span class=\"comment\">//</span></div><div class=\"line\">  &#125;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">invariant_paint</span><span class=\"params\">(Graphics gr)</span></span>&#123;</div><div class=\"line\">    gr.setColor(Color.black); gr.fillRect(<span class=\"number\">10</span>,<span class=\"number\">30</span>, <span class=\"number\">200</span>,<span class=\"number\">100</span>);</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">hook_paint</span><span class=\"params\">(Graphics gr)</span></span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// Bird.java</span></div><div class=\"line\"><span class=\"keyword\">import</span> java.awt.*;</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Bird</span> <span class=\"keyword\">extends</span> <span class=\"title\">Shape</span> </span>&#123;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">hook_paint</span><span class=\"params\">(Graphics gr)</span></span>&#123; <span class=\"comment\">//</span></div><div class=\"line\">    gr.setColor(Color.cyan);</div><div class=\"line\">    gr.drawArc(<span class=\"number\">30</span>,<span class=\"number\">80</span>,<span class=\"number\">90</span>,<span class=\"number\">110</span>,<span class=\"number\">40</span>,<span class=\"number\">100</span>);</div><div class=\"line\">    gr.drawArc(<span class=\"number\">88</span>,<span class=\"number\">93</span>,<span class=\"number\">90</span>,<span class=\"number\">100</span>,<span class=\"number\">40</span>,<span class=\"number\">80</span>);</div><div class=\"line\">    gr.setColor(Color.white);</div><div class=\"line\">    gr.drawArc(<span class=\"number\">30</span>,<span class=\"number\">55</span>,<span class=\"number\">90</span>,<span class=\"number\">150</span>,<span class=\"number\">35</span>,<span class=\"number\">75</span>);</div><div class=\"line\">    gr.drawArc(<span class=\"number\">90</span>,<span class=\"number\">80</span>,<span class=\"number\">90</span>,<span class=\"number\">90</span>,<span class=\"number\">40</span>,<span class=\"number\">80</span>);</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>AndroidActivityActivityonCreate()onCreate()IOC</p>\n<h2 id=\"EIT\"><a href=\"#EIT\" class=\"headerlink\" title=\"EIT\"></a>EIT</h2><blockquote>\n<p>&lt;&gt;&lt;&gt;</p>\n</blockquote>\n<p>EITAndroid</p>\n<hr>\n<p>EIT(Structure)(Concept)EIT(Form)</p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/EIT-form.png\" alt=\"\"></p>\n<ul>\n<li>&lt;E&amp;I&gt;&lt;T&gt;</li>\n<li>&lt;E&amp;I&gt;</li>\n</ul>\n<p>EIT</p>\n<p><strong></strong><br><e>N&lt;T&gt;1+2+3+  + N1+2^2+  + N^2&lt;E&gt;</e></p>\n<blockquote>\n<p>&lt;I&gt;:<br>1.&lt;T&gt;&lt;T&gt;(IoC)&lt;T&gt;&lt;E&gt;N&lt;T&gt;<br>2.&lt;T&gt;&lt;E&gt;<br>3.&lt;T&gt;</p>\n</blockquote>\n<p><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//Counter.java&lt;I&gt;</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Counter</span> </span>&#123;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">run</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">      <span class=\"keyword\">int</span> N = getCount();</div><div class=\"line\">      <span class=\"keyword\">return</span> onCal(N);</div><div class=\"line\">  &#125;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getCount</span><span class=\"params\">()</span> </span>&#123; <span class=\"keyword\">return</span> <span class=\"number\">6</span>; &#125;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">abstract</span> <span class=\"keyword\">int</span> <span class=\"title\">onCal</span><span class=\"params\">(<span class=\"keyword\">int</span> n)</span></span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//myCounter.java&lt;T&gt;</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">myCounter</span> <span class=\"keyword\">extends</span> <span class=\"title\">Counter</span></span>&#123;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"meta\">@Override</span></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">int</span> <span class=\"title\">onCal</span><span class=\"params\">(<span class=\"keyword\">int</span> n)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">int</span> sum = <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">1</span>; i&lt;=n; i++) &#123;</div><div class=\"line\">      sum += i;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> sum;</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//&lt;E&gt;</span></div><div class=\"line\">counter = <span class=\"keyword\">new</span> myCounter();</div><div class=\"line\"><span class=\"keyword\">int</span> sum = counter.run();</div></pre></td></tr></table></figure>\n<p>()(Interface)&lt;E&gt;&lt;T&gt;API</p>\n<h2 id=\"IPC\"><a href=\"#IPC\" class=\"headerlink\" title=\"IPC\"></a>IPC</h2><p>IPC(Inter-Process Communication) (Process)</p>\n<h3 id=\"IPC\"><a href=\"#IPC\" class=\"headerlink\" title=\"IPC\"></a>IPC</h3><ul>\n<li>(App) AndroidZygote(Fork)(Process)(App)</li>\n<li>Linux()() </li>\n<li><p>IPC</p>\n</li>\n<li><p>Android IPC</p>\n</li>\n<li>Android(Virtual MachineVM)JavaJNIJavaC/C++:</li>\n</ul>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/process-ipc-structure.png\" alt=\":VMMQLooper\"></p>\n<blockquote>\n<p></p>\n</blockquote>\n<p>(Main Thread)LooperMQ(Message Queue)Looper</p>\n<p>UI(Event)UIAndroid(Message)MQMQLooperMQ</p>\n<h3 id=\"IPCIBinder--\"><a href=\"#IPCIBinder--\" class=\"headerlink\" title=\"IPCIBinder  \"></a>IPCIBinder  </h3><p>(Function Call)IPC</p>\n<p>AndroidIPCIBinderClientIBindertransact()IPC(Remote)onTransact()</p>\n<p>JavaIBinder IBinder.java<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// IBinder.java</span></div><div class=\"line\"><span class=\"comment\">// .......</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">IBinder</span> </span>&#123;</div><div class=\"line\"><span class=\"comment\">// ........</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">transact</span><span class=\"params\">(<span class=\"keyword\">int</span> code, Parcel data, Parcel reply, <span class=\"keyword\">int</span> flags)</span></span></div><div class=\"line\">  <span class=\"keyword\">throws</span> RemoteException; <span class=\"comment\">// ...........</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>IBinderClient(): transact()</p>\n<p>AndroidBinderIBinder</p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/ibinder-binder.png\" alt=\"javaBinder\"></p>\n<p>Binder ServiceClient ServiceBinderBinder.java:<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// Binder.java</span></div><div class=\"line\"><span class=\"comment\">// .......</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Binder</span> <span class=\"keyword\">implements</span> <span class=\"title\">IBinder</span> </span>&#123;</div><div class=\"line\">  <span class=\"comment\">// ..........</span></div><div class=\"line\">  <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> mObject;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Binder</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    init();</div><div class=\"line\">  <span class=\"comment\">// ...........</span></div><div class=\"line\">  &#125;</div><div class=\"line\">  <span class=\"comment\">//IBindertransact()</span></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">boolean</span> <span class=\"title\">transact</span><span class=\"params\">(<span class=\"keyword\">int</span> code, Parcel data, Parcel reply, <span class=\"keyword\">int</span> flags)</span></span></div><div class=\"line\">    <span class=\"keyword\">throws</span> RemoteException &#123;</div><div class=\"line\">    <span class=\"comment\">// ................</span></div><div class=\"line\">    <span class=\"keyword\">boolean</span> r = onTransact(code, data, reply, flags); <span class=\"keyword\">return</span> r;</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\">//transact()C/C++</span></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> <span class=\"title\">execTransact</span><span class=\"params\">(<span class=\"keyword\">int</span> code, <span class=\"keyword\">int</span> dataObj, <span class=\"keyword\">int</span> replyObj, <span class=\"keyword\">int</span> flags)</span> </span>&#123;</div><div class=\"line\">    Parcel data = Parcel.obtain(dataObj); Parcel reply = Parcel.obtain(replyObj);</div><div class=\"line\">    <span class=\"keyword\">boolean</span> res;</div><div class=\"line\">    res = onTransact(code, data, reply, flags);</div><div class=\"line\">    <span class=\"comment\">// ............</span></div><div class=\"line\">    <span class=\"keyword\">return</span> res;</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\">//(Override).</span></div><div class=\"line\">  <span class=\"comment\">//transact() execTransact()onTransact()(IoC, Inversion of Control)</span></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">boolean</span> <span class=\"title\">onTransact</span><span class=\"params\">(<span class=\"keyword\">int</span> code, Parcel data, Parcel reply, <span class=\"keyword\">int</span> flags)</span></span></div><div class=\"line\">    <span class=\"keyword\">throws</span> RemoteException &#123;</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\">//(Native)JNI.</span></div><div class=\"line\">  <span class=\"comment\">//Binder()init()</span></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">native</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">()</span></span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>BinderEIT&lt;E&gt;</p>\n<p>IBinderBinder(&lt;E&gt;)Client&lt;CI&gt;<br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-EIT.png\" alt=\"\"></p>\n<p>onTransact()EIT&lt;I&gt;&lt;/&gt;IoC<br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-EIT-onTransact.png\" alt=\"\"></p>\n<p>ActivityMediaPlayerMP3.</p>\n<p><br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-example-media.png\" alt=\"\"></p>\n<p>myActivityIBindermyActivityJavaIBinderC/C++BinderBinderexecTransact()myBinderonTransact():</p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-example-media-detail.png\" alt=\"\"></p>\n<h3 id=\"IPC\"><a href=\"#IPC\" class=\"headerlink\" title=\"IPC\"></a>IPC</h3><p>MediaPlayerIPC:</p>\n<ul>\n<li><strong>Step-1.</strong> ActivitystartService()Service</li>\n<li><strong>Step-2.</strong> ActivitybindService()ServiceActivityService(Connection)</li>\n<li><strong>Step-3.</strong> ActivityIBindertransact() Binder DriverBinderexecTransact()  myBinderonTransact()</li>\n</ul>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/05/11/Object-Oriented/\">http://agehua.github.io/2017/05/11/Object-Oriented/</a></p>\n","readingTime":{"text":"4 min read","minutes":3.795,"time":227700,"words":759},"excerpt":"<h2 id=\"Android-By-\"><a href=\"#Android-By-\" class=\"headerlink\" title=\"Android By \"></a>Android By </h2><p>-Oriented<br> -Oriented <br> Object-oriented<br>Nothing else </p>\n<p>-Driven; :Model-drivenUse Case-driven<br> -driven<br> (Driver);</p>\n<p>-Centered; :Architecture-centered Architecture-centeric<br></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> (Hook)(Plug and Play, PnP)<br>","more":"</p>\n<p> (Separate code that changes from the code that doesnt)(Hook)<br> (Variant)(Invariant)(Super- class) (Subclass)</p>\n<p>Java(abstract)(overridable)</p>\n<h3 id=\"IoCDefault\"><a href=\"#IoCDefault\" class=\"headerlink\" title=\"IoCDefault\"></a>IoCDefault</h3><h4 id=\"IoC\"><a href=\"#IoC\" class=\"headerlink\" title=\"IoC\"></a>IoC</h4><p> (IoC: Inversion of Control)<br> IoCOO(C++) C++IoC<br>  Hook<br>   </p>\n<h4 id=\"-Default-\"><a href=\"#-Default-\" class=\"headerlink\" title=\"(Default)\"></a>(Default)</h4><p> :()<br> (Default)()</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">IShape</span> </span>&#123;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">template_paint</span><span class=\"params\">(Graphics gr)</span></span>;</div><div class=\"line\">&#125; <span class=\"comment\">// </span></div></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// Shape.java</span></div><div class=\"line\"><span class=\"keyword\">import</span> java.awt.*;</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Shape</span> <span class=\"keyword\">implements</span> <span class=\"title\">IShape</span> </span>&#123;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">template_paint</span><span class=\"params\">(Graphics gr)</span></span>&#123; <span class=\"comment\">//</span></div><div class=\"line\">    invariant_paint(gr); <span class=\"comment\">//</span></div><div class=\"line\">    hook_paint(gr); <span class=\"comment\">//</span></div><div class=\"line\">  &#125;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">invariant_paint</span><span class=\"params\">(Graphics gr)</span></span>&#123;</div><div class=\"line\">    gr.setColor(Color.black); gr.fillRect(<span class=\"number\">10</span>,<span class=\"number\">30</span>, <span class=\"number\">200</span>,<span class=\"number\">100</span>);</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">hook_paint</span><span class=\"params\">(Graphics gr)</span></span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// Bird.java</span></div><div class=\"line\"><span class=\"keyword\">import</span> java.awt.*;</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Bird</span> <span class=\"keyword\">extends</span> <span class=\"title\">Shape</span> </span>&#123;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">hook_paint</span><span class=\"params\">(Graphics gr)</span></span>&#123; <span class=\"comment\">//</span></div><div class=\"line\">    gr.setColor(Color.cyan);</div><div class=\"line\">    gr.drawArc(<span class=\"number\">30</span>,<span class=\"number\">80</span>,<span class=\"number\">90</span>,<span class=\"number\">110</span>,<span class=\"number\">40</span>,<span class=\"number\">100</span>);</div><div class=\"line\">    gr.drawArc(<span class=\"number\">88</span>,<span class=\"number\">93</span>,<span class=\"number\">90</span>,<span class=\"number\">100</span>,<span class=\"number\">40</span>,<span class=\"number\">80</span>);</div><div class=\"line\">    gr.setColor(Color.white);</div><div class=\"line\">    gr.drawArc(<span class=\"number\">30</span>,<span class=\"number\">55</span>,<span class=\"number\">90</span>,<span class=\"number\">150</span>,<span class=\"number\">35</span>,<span class=\"number\">75</span>);</div><div class=\"line\">    gr.drawArc(<span class=\"number\">90</span>,<span class=\"number\">80</span>,<span class=\"number\">90</span>,<span class=\"number\">90</span>,<span class=\"number\">40</span>,<span class=\"number\">80</span>);</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>AndroidActivityActivityonCreate()onCreate()IOC</p>\n<h2 id=\"EIT\"><a href=\"#EIT\" class=\"headerlink\" title=\"EIT\"></a>EIT</h2><blockquote>\n<p>&lt;&gt;&lt;&gt;</p>\n</blockquote>\n<p>EITAndroid</p>\n<hr>\n<p>EIT(Structure)(Concept)EIT(Form)</p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/EIT-form.png\" alt=\"\"></p>\n<ul>\n<li>&lt;E&amp;I&gt;&lt;T&gt;</li>\n<li>&lt;E&amp;I&gt;</li>\n</ul>\n<p>EIT</p>\n<p><strong></strong><br><E>N&lt;T&gt;1+2+3+  + N1+2^2+  + N^2&lt;E&gt;</p>\n<blockquote>\n<p>&lt;I&gt;:<br>1.&lt;T&gt;&lt;T&gt;(IoC)&lt;T&gt;&lt;E&gt;N&lt;T&gt;<br>2.&lt;T&gt;&lt;E&gt;<br>3.&lt;T&gt;</p>\n</blockquote>\n<p><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//Counter.java&lt;I&gt;</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Counter</span> </span>&#123;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">run</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">      <span class=\"keyword\">int</span> N = getCount();</div><div class=\"line\">      <span class=\"keyword\">return</span> onCal(N);</div><div class=\"line\">  &#125;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getCount</span><span class=\"params\">()</span> </span>&#123; <span class=\"keyword\">return</span> <span class=\"number\">6</span>; &#125;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">abstract</span> <span class=\"keyword\">int</span> <span class=\"title\">onCal</span><span class=\"params\">(<span class=\"keyword\">int</span> n)</span></span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//myCounter.java&lt;T&gt;</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">myCounter</span> <span class=\"keyword\">extends</span> <span class=\"title\">Counter</span></span>&#123;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"meta\">@Override</span></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">int</span> <span class=\"title\">onCal</span><span class=\"params\">(<span class=\"keyword\">int</span> n)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">int</span> sum = <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">1</span>; i&lt;=n; i++) &#123;</div><div class=\"line\">      sum += i;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> sum;</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//&lt;E&gt;</span></div><div class=\"line\">counter = <span class=\"keyword\">new</span> myCounter();</div><div class=\"line\"><span class=\"keyword\">int</span> sum = counter.run();</div></pre></td></tr></table></figure>\n<p>()(Interface)&lt;E&gt;&lt;T&gt;API</p>\n<h2 id=\"IPC\"><a href=\"#IPC\" class=\"headerlink\" title=\"IPC\"></a>IPC</h2><p>IPC(Inter-Process Communication) (Process)</p>\n<h3 id=\"IPC\"><a href=\"#IPC\" class=\"headerlink\" title=\"IPC\"></a>IPC</h3><ul>\n<li>(App) AndroidZygote(Fork)(Process)(App)</li>\n<li>Linux()() </li>\n<li><p>IPC</p>\n</li>\n<li><p>Android IPC</p>\n</li>\n<li>Android(Virtual MachineVM)JavaJNIJavaC/C++:</li>\n</ul>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/process-ipc-structure.png\" alt=\":VMMQLooper\"></p>\n<blockquote>\n<p></p>\n</blockquote>\n<p>(Main Thread)LooperMQ(Message Queue)Looper</p>\n<p>UI(Event)UIAndroid(Message)MQMQLooperMQ</p>\n<h3 id=\"IPCIBinder--\"><a href=\"#IPCIBinder--\" class=\"headerlink\" title=\"IPCIBinder  \"></a>IPCIBinder  </h3><p>(Function Call)IPC</p>\n<p>AndroidIPCIBinderClientIBindertransact()IPC(Remote)onTransact()</p>\n<p>JavaIBinder IBinder.java<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// IBinder.java</span></div><div class=\"line\"><span class=\"comment\">// .......</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">IBinder</span> </span>&#123;</div><div class=\"line\"><span class=\"comment\">// ........</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">transact</span><span class=\"params\">(<span class=\"keyword\">int</span> code, Parcel data, Parcel reply, <span class=\"keyword\">int</span> flags)</span></div><div class=\"line\">  <span class=\"keyword\">throws</span> RemoteException</span>; <span class=\"comment\">// ...........</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>IBinderClient(): transact()</p>\n<p>AndroidBinderIBinder</p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/ibinder-binder.png\" alt=\"javaBinder\"></p>\n<p>Binder ServiceClient ServiceBinderBinder.java:<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// Binder.java</span></div><div class=\"line\"><span class=\"comment\">// .......</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Binder</span> <span class=\"keyword\">implements</span> <span class=\"title\">IBinder</span> </span>&#123;</div><div class=\"line\">  <span class=\"comment\">// ..........</span></div><div class=\"line\">  <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> mObject;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Binder</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    init();</div><div class=\"line\">  <span class=\"comment\">// ...........</span></div><div class=\"line\">  &#125;</div><div class=\"line\">  <span class=\"comment\">//IBindertransact()</span></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">boolean</span> <span class=\"title\">transact</span><span class=\"params\">(<span class=\"keyword\">int</span> code, Parcel data, Parcel reply, <span class=\"keyword\">int</span> flags)</span></div><div class=\"line\">    <span class=\"keyword\">throws</span> RemoteException </span>&#123;</div><div class=\"line\">    <span class=\"comment\">// ................</span></div><div class=\"line\">    <span class=\"keyword\">boolean</span> r = onTransact(code, data, reply, flags); <span class=\"keyword\">return</span> r;</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\">//transact()C/C++</span></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> <span class=\"title\">execTransact</span><span class=\"params\">(<span class=\"keyword\">int</span> code, <span class=\"keyword\">int</span> dataObj, <span class=\"keyword\">int</span> replyObj, <span class=\"keyword\">int</span> flags)</span> </span>&#123;</div><div class=\"line\">    Parcel data = Parcel.obtain(dataObj); Parcel reply = Parcel.obtain(replyObj);</div><div class=\"line\">    <span class=\"keyword\">boolean</span> res;</div><div class=\"line\">    res = onTransact(code, data, reply, flags);</div><div class=\"line\">    <span class=\"comment\">// ............</span></div><div class=\"line\">    <span class=\"keyword\">return</span> res;</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\">//(Override).</span></div><div class=\"line\">  <span class=\"comment\">//transact() execTransact()onTransact()(IoC, Inversion of Control)</span></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">boolean</span> <span class=\"title\">onTransact</span><span class=\"params\">(<span class=\"keyword\">int</span> code, Parcel data, Parcel reply, <span class=\"keyword\">int</span> flags)</span></div><div class=\"line\">    <span class=\"keyword\">throws</span> RemoteException </span>&#123;</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\">//(Native)JNI.</span></div><div class=\"line\">  <span class=\"comment\">//Binder()init()</span></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">native</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">()</span></span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>BinderEIT&lt;E&gt;</p>\n<p>IBinderBinder(&lt;E&gt;)Client&lt;CI&gt;<br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-EIT.png\" alt=\"\"></p>\n<p>onTransact()EIT&lt;I&gt;&lt;/&gt;IoC<br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-EIT-onTransact.png\" alt=\"\"></p>\n<p>ActivityMediaPlayerMP3.</p>\n<p><br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-example-media.png\" alt=\"\"></p>\n<p>myActivityIBindermyActivityJavaIBinderC/C++BinderBinderexecTransact()myBinderonTransact():</p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-example-media-detail.png\" alt=\"\"></p>\n<h3 id=\"IPC\"><a href=\"#IPC\" class=\"headerlink\" title=\"IPC\"></a>IPC</h3><p>MediaPlayerIPC:</p>\n<ul>\n<li><strong>Step-1.</strong> ActivitystartService()Service</li>\n<li><strong>Step-2.</strong> ActivitybindService()ServiceActivityService(Connection)</li>\n<li><strong>Step-3.</strong> ActivityIBindertransact() Binder DriverBinderexecTransact()  myBinderonTransact()</li>\n</ul>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/05/11/Object-Oriented/\">http://agehua.github.io/2017/05/11/Object-Oriented/</a></p>"},{"layout":"post","title":"Androidroothook","keywords":"hook, system service, Binder","banner":"http://obxk8w81b.bkt.clouddn.com/Blossoming%20Chestnut%20Branches.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Blossoming%20Chestnut%20Branches.jpg","toc":true,"_content":"\n[Android-rootHook](http://blog.csdn.net/jiangwei0910410003/article/details/52523679) [VirtualApk](https://github.com/didi/VirtualAPK) hook\n\n360 [Droid Plugin](https://github.com/DroidPluginTeam/DroidPlugin)360 [RePlugin](https://github.com/Qihoo360/RePlugin)\n\nhttps://www.itcodemonkey.com/article/278.html\n                https://www.itcodemonkey.com/article/277.html\n\n360RePlugin[readme](https://github.com/Qihoo360/RePlugin/blob/master/README_CN.md)\n\n**VirtualApk**hook\n\n### Androidroothook\n\n#### Binder\n<!--more-->\n AndroidBinderHookBinderServiceManagerStubasInterfaceBindersystem_serverProxy\n\n#### \nHook****\n~~~ Java\n//\nClipboardManager cm =(ClipboardManager)getSystemService(Context.CLIPBOARD_SERVICE);\n//\ncm.setPrimaryClip(ClipData.newPlainText(\"data\",\"jack\"));\n//\nClipData cd = cm.getPrimaryClip();\nString msg = cd.getItemAt(0).getText().toString();\nLog.d(\"jw\", \"msg:\"+ msg);\n~~~\n\ngetSystemServiceContextgetSystemServiceComtextImpl.java\n~~~ Java\n@Override\npublic Object getSystemService(String name) {\n   ServiceFetcher fetcher = SYSTEM_SERVICE_MAP.get(name);\n   return fetcher == null ? null : fetcher.getService(this);\n}\n~~~\nServiceFetcherMap\n~~~ Java\nprivate static void registerService(String serviceName, ServiceFetcher fetcher) {\n    if (!(fetcher instanceof StaticServiceFetcher)) {\n        fetcher.mContextCacheIndex = sNextPerContextServiceCacheIndex++;\n    }\n    SYSTEM_SERVICE_MAP.put(serviceName, fetcher);\n}\n~~~\nregisterServiceServiceFetcher:\n~~~ Java\nstatic {\n    registerService(ACCESSIBILITY_SERVICE, new ServiceFetcher() {\n            public Object getService(ContextImpl ctx) {\n                return AccessibilityManager.getInstance(ctx);\n            }});\n    //...\n    registerService(CLIPBOARD_SERVICE, new ServiceFetcher() {\n            public Object createService(ContextImpl ctx) {\n                return new ClipboardManager(ctx.getOuterContext(),\n                            ctx.mMainThread.getHandler());\n            }});        \n    //....\n\n    registerService(CONNECTIVITY_SERVICE, new ServiceFetcher() {\n            public Object createService(ContextImpl ctx) {\n                IBinder b = ServiceManager.getService(CONNECTIVITY_SERVICE);\n                return new ConnectivityManager(IConnectivityManager.Stub.asInterface(b));\n            }});\n    //....\n}\n~~~\n> ClipboardManager\n\nClipboardManagerIClipboard.StubIConnectivityManager.StubasInterfaceProxy\n\nClipboardManager.java\n~~~ Java\npublic void setPrimaryClip(ClipData clip) {\n    try {\n        if (clip != null) {\n            clip.prepareToLeaveProcess();\n        }\n        getService().setPrimaryClip(clip, mContext.getOpPackageName());\n    } catch (RemoteException e) {\n    }\n}\n~~~\ngetServicegetServiceIClipboard.StubasInterfaceProxy\n~~~ Java\nstatic private IClipboard getService() {\n    synchronized (sStaticLock) {\n        if (sService != null) {\n            return sService;\n        }\n        IBinder b = ServiceManager.getService(\"clipboard\");\n        sService = IClipboard.Stub.asInterface(b);\n        return sService;\n    }\n}\n~~~\nServiceManagerClipboardIBinderasInterfaceProxy\n\n\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/clipboard-ipc-process.png)\n\nServiceManagergetServiceIBinderStubasInterfaceProxyStubBinderAIDLProxyAIDLAIDLIInterface\n\n### Hook\nAndroidandroidHookHookHookHook\n\n- 1HookHookHook********HookstaticHookAndroid\n- 2HookJava\n  - \n  - Proxy$0\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/service-proxy-common.png)\n\nVirtualApk\n\n    DroidPlugin\n\n\nVirtualApkcom/didi/virtualapk/delegate/ProxyIContentProviderProxy.java\n~~~ Java\npublic class IContentProviderProxy implements InvocationHandler {\n\n  //.....\n  public static IContentProvider newInstance(Context context, IContentProvider iContentProvider) {\n      return (IContentProvider) Proxy.newProxyInstance(iContentProvider.getClass().getClassLoader(),\n              new Class[] { IContentProvider.class }, new IContentProviderProxy(context, iContentProvider));\n  }\n\n  @Override\n  public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {\n      Log.v(TAG, method.toGenericString() + \" : \" + Arrays.toString(args));\n      wrapperUri(method, args);\n\n      try {\n          return method.invoke(mBase, args);\n      } catch (InvocationTargetException e) {\n          throw e.getTargetException();\n      }\n  }\n\n  //...\n}\n~~~\n\njava AOPIContentProviderProxy**java.lang.ref.proxy**\n\n> ASMInvocationHandlerIBM[AOP ASM 3.0 ](https://www.ibm.com/developerworks/cn/java/j-lo-asm30/index.html)\n\n#### java\n\njava**InvocationHandler(Interface)****Proxy(Class)**\n\nIBM\nAccountAccountImpl\n~~~ Java\npublic interface Account {\n    void operation();\n}\n~~~\n~~~ Java\npublic class AccountImpl extends Account{\n    public void operation() {\n        System.out.println(\"operation...\");\n        //TODO real operation\n    }\n}\n~~~\nAccountoperation()checkSecurity()\n\nInvocationHandlerProxy\n~~~ Java\nclass SecurityProxyInvocationHandler implements InvocationHandler {\n    private Object proxyedObject;\n    public SecurityProxyInvocationHandler(Object o) {\n        proxyedObject = o;\n    }\n\n    @Override\n    public Object invoke(Object object, Method method, Object[] arguments)\n        throws Throwable {             \n        if (object instanceof Account && method.getName().equals(\"opertaion\")) {\n            SecurityChecker.checkSecurity();\n        }\n        return method.invoke(proxyedObject, arguments);\n    }\n}\n~~~\n~~~ Java\npublic static void main(String[] args) {\n    Account account = (Account) Proxy.newProxyInstance(\n        Account.class.getClassLoader(),\n        new Class[] { Account.class },\n        new SecurityProxyInvocationHandler(new AccountImpl())\n    );\n    account.function();\n}\n~~~\n\n- InvocationHandler**invoke()**\n~~~ Java\nObject invoke(Object proxy, Method method, Object[] args) throws Throwable\n~~~\n  - proxy:\n  - method:Method\n  - args:\n\nInvocationHandleraccountInvocationHandler**invoke**\n\n- Proxy**newProxyInstance**\n~~~ Java\npublic static Object newProxyInstance(ClassLoader loader, Class<?>[] interfaces, InvocationHandler h) throws IllegalArgumentException\n~~~\n  - loader:ClassLoaderClassLoader\n  - interfaces:Interface()\n  - h:InvocationHandlerInvocationHandler\n\nProxynewProxyInstance()\n\nProxy\n- Proxy  Proxy Proxy  **Proxy.newProxyInstance**  Account AccountImpl \n- Proxy 10 proxy class  invoke  proxy class \n\n> VirtualApk IContentProviderProxy Account SecurityProxyInvocationHandler IContentProviderProxy  **InvocationHandler ****invoke()**\n\nVirtualApkIContentProviderProxyinvoke()invoke() wrapperUri()\n~~~ Java\nprivate void wrapperUri(Method method, Object[] args) {\n    Uri uri = null;\n    int index = 0;\n    if (args != null) {\n        for (int i = 0; i < args.length; i++) {\n            if (args[i] instanceof Uri) {\n                uri = (Uri) args[i];\n                index = i;\n                break;\n            }\n        }\n    }\n\n    //call\n    Bundle bundleInCallMethod = null;\n    if (method.getName().equals(\"call\")) {\n        bundleInCallMethod = getBundleParameter(args);\n        if (bundleInCallMethod != null) {\n            String uriString = bundleInCallMethod.getString(KEY_WRAPPER_URI);\n            if (uriString != null) {\n                uri = Uri.parse(uriString);\n            }\n        }\n    }\n    //...\n\n    PluginManager pluginManager = PluginManager.getInstance(mContext);\n    //uriContentProvider\n    ProviderInfo info = pluginManager.resolveContentProvider(uri.getAuthority(), 0);\n    if (info != null) {\n        String pkg = info.packageName;\n        LoadedPlugin plugin = pluginManager.getLoadedPlugin(pkg);\n        String pluginUri = Uri.encode(uri.toString());\n        StringBuilder builder = new StringBuilder(PluginContentResolver.getUri(mContext));\n        builder.append(\"/?plugin=\" + plugin.getLocation());\n        builder.append(\"&pkg=\" + pkg);\n        builder.append(\"&uri=\" + pluginUri);\n        Uri wrapperUri = Uri.parse(builder.toString());\n        if (method.getName().equals(\"call\")) {\n            bundleInCallMethod.putString(KEY_WRAPPER_URI, wrapperUri.toString());\n        } else {\n            args[index] = wrapperUri;\n        }\n    }\n}\n~~~\n\n- 1.wrapperUri()Uri\n- 2.resolveContentProvider()uriContentProvider\n  ~~~ Java\n  public ProviderInfo resolveContentProvider(String name, int flags) {\n    return this.mProviders.get(name);\n  }\n  ~~~\n  ProviderInfoHolds information about a specific content provider\n- 3.StringBuilderuripkgpluginargsuri\n\n> queryproviderquery\n\n#### \nJavaHookHookHookHookAndroidServiceManagerIBinderHook\n\n~~~ Java\npublic static IBinder getService(String name) {\n   try {\n       IBinder service = sCache.get(name);\n       if (service != null) {\n           return service;\n       } else {\n           return getIServiceManager().getService(name);\n       }\n   } catch (RemoteException e) {\n       Log.e(TAG, \"error in getService\", e);\n   }\n   return null;\n}\n~~~\nServiceManager\n~~~ Java\nprivate static HashMap<String, IBinder> sCache = new HashMap<String, IBinder>();\n~~~\n> static\n\nIBinder\n\nProxy Java\n- IBinder\n- \n\n\n~~~ Java\ntry {\n  //ServiceManager.getService(\"clipboard\")\n  //ServiceManager@hide\n  Class<?> serviceManager = Class.forName(\"android.os.ServiceManager\");\n  Method getService = serviceManager.getDeclaredMethod(\"getService\", String.class);\n  //ServiceManagerclipboard binder\n  //Binder\n  IBinder rawBinder =(IBinder) getService.invoke(null, Context.CLIPBOARD_SERVICE);\n\n  //HookBinderqueryLocalInterface \n  //queryLocalInterfaceIInterfacehook\n  IBinder hookedBinder =(IBinder) Proxy.newProxyInstance(\n      serviceManager.getClassLoader,\n      new Class<?>[](IBinder.class),\n      new IClipboardHookBinderHandler(rawBinder)\n  );\n\n  //ServiceManager\n  Field cacheField = serviceManager.getDeclaredField(\"sCache\");\n  cacheField.setAccessible(true);\n  @SuppressWarnings({\"unchecked\"})\n  Map<String, IBinder> cache = (Map<String,IBinder>) cacheField.get(null);\n  cache.put(Context.CLIPBOARD_SERVICE, hookedBinder);\n}catch (Exception e){\n\n}\n~~~\n\n> Field.get()Objectnull java.lang.NullPointerException,,null\n\nServiceManagerBinderBinder\n\n\n~~~ Java\n@Override\npublic Object invoke(Object object, Method method, Object[] args)\n    throws Throwable {             \n    if (method.getName().equals(\"queryLocalInterface\")) {\n        Log.d(TAG, \"hook queryLocalInterface\");\n\n        //hookService\n        //IInterface\n        return Proxy.newProxyInstance(\n            base.getClassLoader,\n            new Class<?>[](this.iinterface),\n            new HookBinderInvocationHander(base,stub)\n            );\n    }\n    return method.invoke(base, args);\n}\n~~~\n> queryLocalInterface()\n\nsetPrimaryClipBinderIClipboardManagerProxyStubasInterfaceBinderAIDL\n~~~ Java\npublic static com.agehua.aidldemo.Demo asInterface(android.os.IBinder obj) {\n    if ((obj == null)) {\n        return null;\n    }\n    //objqueryLocalInterface()hook\n    android.os.IInterface iin = obj.queryLocalInterface(DESCRIPTOR);\n    if (((iin != null) && (iin instanceof com.agehua.aidldemo.Demo))) {\n        return ((com.agehua.aidldemo.Demo) iin);\n    }\n    return new com.agehua.aidldemo.Demo.Stub.Proxy(obj);\n}\n~~~\n\nIClipboardManagersetPrimaryClipClipboardManager$ProxyClipboardManager$Proxy\n\n- ClipboardManager$ProxyAIDL\n- IClipboardManager$StubasInterfaceIClipboardManager$Proxy\n\n~~~ Java\npublic IClipboardHookBinderHandler(IBinder base) {\n  this.base = base;\n  try {\n    this.stub =Class.forName(\"android.content.IClipboard$Stub\");\n    this.iinterface = Class.forName(\"android.content.IClipboard\");\n  }catch (ClassNotFoundException e){\n\n  }\n}\n~~~\n\n~~~ Java\npublic IClipboardHookBinderHandler(IBinder base, Class<?> stubClass) {\n  try {\n    Method asInterfaceMethod = stubClass.getDeclaredMethod(\"asInterface\", IBinder.class);\n    this.base = asInterfaceMethod.invoke(null, base);\n  }catch (Exception e){\n    throw new RuntimeException(\"hooked failed\")\n  }\n}  \n~~~\nInvocationHandlerProxy\n~~~ Java\n@Override\npublic Object invoke(Object proxy, Method method, Object[] args) throws Throwable{\n  if (\"getPrimaryClip\".equals(method.getName())) {\n      return ClipData.newPlainText(null, \"you are hooked\");\n  }\n  //\n  if (\"hasPrimaryClip\".equals(method.getName())) {\n    return true;\n  }\n  //\n  return method.invoke(base, args);\n}\n~~~\nhook\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/hook-clipboard-process.png)\n\n- 1ServiceManagerIBinderIBinder\n- 2HookBinderBinder\n  - 1) BinderIBinder\n  - 2) Binder\nqueryLocalInterfaceStubBinderHookHook\n- 3BinderqueryLocalInterfaceIClipboard$Proxy\n  - 1) AIDL()\n  - 2) IClipboard$StubasInterfaceIClipboard$Proxy\n\n\n> Hookhooksystem_serverroot\n\n### \nAndroidHookHook\nVirtualApk****[  VirtualApk ](http://blog.csdn.net/lmj623565791/article/details/75000580)\n","source":"_posts/2017-07-12-android-noroot-hook.md","raw":"---\nlayout: post\ntitle:  Androidroothook\ncategory: accumulation\ntags:\n  - HOOK\n  - Android system service\n  - Binder\nkeywords: hook, system service, Binder\nbanner: http://obxk8w81b.bkt.clouddn.com/Blossoming%20Chestnut%20Branches.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Blossoming%20Chestnut%20Branches.jpg\ntoc: true\n---\n\n[Android-rootHook](http://blog.csdn.net/jiangwei0910410003/article/details/52523679) [VirtualApk](https://github.com/didi/VirtualAPK) hook\n\n360 [Droid Plugin](https://github.com/DroidPluginTeam/DroidPlugin)360 [RePlugin](https://github.com/Qihoo360/RePlugin)\n\nhttps://www.itcodemonkey.com/article/278.html\n                https://www.itcodemonkey.com/article/277.html\n\n360RePlugin[readme](https://github.com/Qihoo360/RePlugin/blob/master/README_CN.md)\n\n**VirtualApk**hook\n\n### Androidroothook\n\n#### Binder\n<!--more-->\n AndroidBinderHookBinderServiceManagerStubasInterfaceBindersystem_serverProxy\n\n#### \nHook****\n~~~ Java\n//\nClipboardManager cm =(ClipboardManager)getSystemService(Context.CLIPBOARD_SERVICE);\n//\ncm.setPrimaryClip(ClipData.newPlainText(\"data\",\"jack\"));\n//\nClipData cd = cm.getPrimaryClip();\nString msg = cd.getItemAt(0).getText().toString();\nLog.d(\"jw\", \"msg:\"+ msg);\n~~~\n\ngetSystemServiceContextgetSystemServiceComtextImpl.java\n~~~ Java\n@Override\npublic Object getSystemService(String name) {\n   ServiceFetcher fetcher = SYSTEM_SERVICE_MAP.get(name);\n   return fetcher == null ? null : fetcher.getService(this);\n}\n~~~\nServiceFetcherMap\n~~~ Java\nprivate static void registerService(String serviceName, ServiceFetcher fetcher) {\n    if (!(fetcher instanceof StaticServiceFetcher)) {\n        fetcher.mContextCacheIndex = sNextPerContextServiceCacheIndex++;\n    }\n    SYSTEM_SERVICE_MAP.put(serviceName, fetcher);\n}\n~~~\nregisterServiceServiceFetcher:\n~~~ Java\nstatic {\n    registerService(ACCESSIBILITY_SERVICE, new ServiceFetcher() {\n            public Object getService(ContextImpl ctx) {\n                return AccessibilityManager.getInstance(ctx);\n            }});\n    //...\n    registerService(CLIPBOARD_SERVICE, new ServiceFetcher() {\n            public Object createService(ContextImpl ctx) {\n                return new ClipboardManager(ctx.getOuterContext(),\n                            ctx.mMainThread.getHandler());\n            }});        \n    //....\n\n    registerService(CONNECTIVITY_SERVICE, new ServiceFetcher() {\n            public Object createService(ContextImpl ctx) {\n                IBinder b = ServiceManager.getService(CONNECTIVITY_SERVICE);\n                return new ConnectivityManager(IConnectivityManager.Stub.asInterface(b));\n            }});\n    //....\n}\n~~~\n> ClipboardManager\n\nClipboardManagerIClipboard.StubIConnectivityManager.StubasInterfaceProxy\n\nClipboardManager.java\n~~~ Java\npublic void setPrimaryClip(ClipData clip) {\n    try {\n        if (clip != null) {\n            clip.prepareToLeaveProcess();\n        }\n        getService().setPrimaryClip(clip, mContext.getOpPackageName());\n    } catch (RemoteException e) {\n    }\n}\n~~~\ngetServicegetServiceIClipboard.StubasInterfaceProxy\n~~~ Java\nstatic private IClipboard getService() {\n    synchronized (sStaticLock) {\n        if (sService != null) {\n            return sService;\n        }\n        IBinder b = ServiceManager.getService(\"clipboard\");\n        sService = IClipboard.Stub.asInterface(b);\n        return sService;\n    }\n}\n~~~\nServiceManagerClipboardIBinderasInterfaceProxy\n\n\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/clipboard-ipc-process.png)\n\nServiceManagergetServiceIBinderStubasInterfaceProxyStubBinderAIDLProxyAIDLAIDLIInterface\n\n### Hook\nAndroidandroidHookHookHookHook\n\n- 1HookHookHook********HookstaticHookAndroid\n- 2HookJava\n  - \n  - Proxy$0\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/service-proxy-common.png)\n\nVirtualApk\n\n    DroidPlugin\n\n\nVirtualApkcom/didi/virtualapk/delegate/ProxyIContentProviderProxy.java\n~~~ Java\npublic class IContentProviderProxy implements InvocationHandler {\n\n  //.....\n  public static IContentProvider newInstance(Context context, IContentProvider iContentProvider) {\n      return (IContentProvider) Proxy.newProxyInstance(iContentProvider.getClass().getClassLoader(),\n              new Class[] { IContentProvider.class }, new IContentProviderProxy(context, iContentProvider));\n  }\n\n  @Override\n  public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {\n      Log.v(TAG, method.toGenericString() + \" : \" + Arrays.toString(args));\n      wrapperUri(method, args);\n\n      try {\n          return method.invoke(mBase, args);\n      } catch (InvocationTargetException e) {\n          throw e.getTargetException();\n      }\n  }\n\n  //...\n}\n~~~\n\njava AOPIContentProviderProxy**java.lang.ref.proxy**\n\n> ASMInvocationHandlerIBM[AOP ASM 3.0 ](https://www.ibm.com/developerworks/cn/java/j-lo-asm30/index.html)\n\n#### java\n\njava**InvocationHandler(Interface)****Proxy(Class)**\n\nIBM\nAccountAccountImpl\n~~~ Java\npublic interface Account {\n    void operation();\n}\n~~~\n~~~ Java\npublic class AccountImpl extends Account{\n    public void operation() {\n        System.out.println(\"operation...\");\n        //TODO real operation\n    }\n}\n~~~\nAccountoperation()checkSecurity()\n\nInvocationHandlerProxy\n~~~ Java\nclass SecurityProxyInvocationHandler implements InvocationHandler {\n    private Object proxyedObject;\n    public SecurityProxyInvocationHandler(Object o) {\n        proxyedObject = o;\n    }\n\n    @Override\n    public Object invoke(Object object, Method method, Object[] arguments)\n        throws Throwable {             \n        if (object instanceof Account && method.getName().equals(\"opertaion\")) {\n            SecurityChecker.checkSecurity();\n        }\n        return method.invoke(proxyedObject, arguments);\n    }\n}\n~~~\n~~~ Java\npublic static void main(String[] args) {\n    Account account = (Account) Proxy.newProxyInstance(\n        Account.class.getClassLoader(),\n        new Class[] { Account.class },\n        new SecurityProxyInvocationHandler(new AccountImpl())\n    );\n    account.function();\n}\n~~~\n\n- InvocationHandler**invoke()**\n~~~ Java\nObject invoke(Object proxy, Method method, Object[] args) throws Throwable\n~~~\n  - proxy:\n  - method:Method\n  - args:\n\nInvocationHandleraccountInvocationHandler**invoke**\n\n- Proxy**newProxyInstance**\n~~~ Java\npublic static Object newProxyInstance(ClassLoader loader, Class<?>[] interfaces, InvocationHandler h) throws IllegalArgumentException\n~~~\n  - loader:ClassLoaderClassLoader\n  - interfaces:Interface()\n  - h:InvocationHandlerInvocationHandler\n\nProxynewProxyInstance()\n\nProxy\n- Proxy  Proxy Proxy  **Proxy.newProxyInstance**  Account AccountImpl \n- Proxy 10 proxy class  invoke  proxy class \n\n> VirtualApk IContentProviderProxy Account SecurityProxyInvocationHandler IContentProviderProxy  **InvocationHandler ****invoke()**\n\nVirtualApkIContentProviderProxyinvoke()invoke() wrapperUri()\n~~~ Java\nprivate void wrapperUri(Method method, Object[] args) {\n    Uri uri = null;\n    int index = 0;\n    if (args != null) {\n        for (int i = 0; i < args.length; i++) {\n            if (args[i] instanceof Uri) {\n                uri = (Uri) args[i];\n                index = i;\n                break;\n            }\n        }\n    }\n\n    //call\n    Bundle bundleInCallMethod = null;\n    if (method.getName().equals(\"call\")) {\n        bundleInCallMethod = getBundleParameter(args);\n        if (bundleInCallMethod != null) {\n            String uriString = bundleInCallMethod.getString(KEY_WRAPPER_URI);\n            if (uriString != null) {\n                uri = Uri.parse(uriString);\n            }\n        }\n    }\n    //...\n\n    PluginManager pluginManager = PluginManager.getInstance(mContext);\n    //uriContentProvider\n    ProviderInfo info = pluginManager.resolveContentProvider(uri.getAuthority(), 0);\n    if (info != null) {\n        String pkg = info.packageName;\n        LoadedPlugin plugin = pluginManager.getLoadedPlugin(pkg);\n        String pluginUri = Uri.encode(uri.toString());\n        StringBuilder builder = new StringBuilder(PluginContentResolver.getUri(mContext));\n        builder.append(\"/?plugin=\" + plugin.getLocation());\n        builder.append(\"&pkg=\" + pkg);\n        builder.append(\"&uri=\" + pluginUri);\n        Uri wrapperUri = Uri.parse(builder.toString());\n        if (method.getName().equals(\"call\")) {\n            bundleInCallMethod.putString(KEY_WRAPPER_URI, wrapperUri.toString());\n        } else {\n            args[index] = wrapperUri;\n        }\n    }\n}\n~~~\n\n- 1.wrapperUri()Uri\n- 2.resolveContentProvider()uriContentProvider\n  ~~~ Java\n  public ProviderInfo resolveContentProvider(String name, int flags) {\n    return this.mProviders.get(name);\n  }\n  ~~~\n  ProviderInfoHolds information about a specific content provider\n- 3.StringBuilderuripkgpluginargsuri\n\n> queryproviderquery\n\n#### \nJavaHookHookHookHookAndroidServiceManagerIBinderHook\n\n~~~ Java\npublic static IBinder getService(String name) {\n   try {\n       IBinder service = sCache.get(name);\n       if (service != null) {\n           return service;\n       } else {\n           return getIServiceManager().getService(name);\n       }\n   } catch (RemoteException e) {\n       Log.e(TAG, \"error in getService\", e);\n   }\n   return null;\n}\n~~~\nServiceManager\n~~~ Java\nprivate static HashMap<String, IBinder> sCache = new HashMap<String, IBinder>();\n~~~\n> static\n\nIBinder\n\nProxy Java\n- IBinder\n- \n\n\n~~~ Java\ntry {\n  //ServiceManager.getService(\"clipboard\")\n  //ServiceManager@hide\n  Class<?> serviceManager = Class.forName(\"android.os.ServiceManager\");\n  Method getService = serviceManager.getDeclaredMethod(\"getService\", String.class);\n  //ServiceManagerclipboard binder\n  //Binder\n  IBinder rawBinder =(IBinder) getService.invoke(null, Context.CLIPBOARD_SERVICE);\n\n  //HookBinderqueryLocalInterface \n  //queryLocalInterfaceIInterfacehook\n  IBinder hookedBinder =(IBinder) Proxy.newProxyInstance(\n      serviceManager.getClassLoader,\n      new Class<?>[](IBinder.class),\n      new IClipboardHookBinderHandler(rawBinder)\n  );\n\n  //ServiceManager\n  Field cacheField = serviceManager.getDeclaredField(\"sCache\");\n  cacheField.setAccessible(true);\n  @SuppressWarnings({\"unchecked\"})\n  Map<String, IBinder> cache = (Map<String,IBinder>) cacheField.get(null);\n  cache.put(Context.CLIPBOARD_SERVICE, hookedBinder);\n}catch (Exception e){\n\n}\n~~~\n\n> Field.get()Objectnull java.lang.NullPointerException,,null\n\nServiceManagerBinderBinder\n\n\n~~~ Java\n@Override\npublic Object invoke(Object object, Method method, Object[] args)\n    throws Throwable {             \n    if (method.getName().equals(\"queryLocalInterface\")) {\n        Log.d(TAG, \"hook queryLocalInterface\");\n\n        //hookService\n        //IInterface\n        return Proxy.newProxyInstance(\n            base.getClassLoader,\n            new Class<?>[](this.iinterface),\n            new HookBinderInvocationHander(base,stub)\n            );\n    }\n    return method.invoke(base, args);\n}\n~~~\n> queryLocalInterface()\n\nsetPrimaryClipBinderIClipboardManagerProxyStubasInterfaceBinderAIDL\n~~~ Java\npublic static com.agehua.aidldemo.Demo asInterface(android.os.IBinder obj) {\n    if ((obj == null)) {\n        return null;\n    }\n    //objqueryLocalInterface()hook\n    android.os.IInterface iin = obj.queryLocalInterface(DESCRIPTOR);\n    if (((iin != null) && (iin instanceof com.agehua.aidldemo.Demo))) {\n        return ((com.agehua.aidldemo.Demo) iin);\n    }\n    return new com.agehua.aidldemo.Demo.Stub.Proxy(obj);\n}\n~~~\n\nIClipboardManagersetPrimaryClipClipboardManager$ProxyClipboardManager$Proxy\n\n- ClipboardManager$ProxyAIDL\n- IClipboardManager$StubasInterfaceIClipboardManager$Proxy\n\n~~~ Java\npublic IClipboardHookBinderHandler(IBinder base) {\n  this.base = base;\n  try {\n    this.stub =Class.forName(\"android.content.IClipboard$Stub\");\n    this.iinterface = Class.forName(\"android.content.IClipboard\");\n  }catch (ClassNotFoundException e){\n\n  }\n}\n~~~\n\n~~~ Java\npublic IClipboardHookBinderHandler(IBinder base, Class<?> stubClass) {\n  try {\n    Method asInterfaceMethod = stubClass.getDeclaredMethod(\"asInterface\", IBinder.class);\n    this.base = asInterfaceMethod.invoke(null, base);\n  }catch (Exception e){\n    throw new RuntimeException(\"hooked failed\")\n  }\n}  \n~~~\nInvocationHandlerProxy\n~~~ Java\n@Override\npublic Object invoke(Object proxy, Method method, Object[] args) throws Throwable{\n  if (\"getPrimaryClip\".equals(method.getName())) {\n      return ClipData.newPlainText(null, \"you are hooked\");\n  }\n  //\n  if (\"hasPrimaryClip\".equals(method.getName())) {\n    return true;\n  }\n  //\n  return method.invoke(base, args);\n}\n~~~\nhook\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/hook-clipboard-process.png)\n\n- 1ServiceManagerIBinderIBinder\n- 2HookBinderBinder\n  - 1) BinderIBinder\n  - 2) Binder\nqueryLocalInterfaceStubBinderHookHook\n- 3BinderqueryLocalInterfaceIClipboard$Proxy\n  - 1) AIDL()\n  - 2) IClipboard$StubasInterfaceIClipboard$Proxy\n\n\n> Hookhooksystem_serverroot\n\n### \nAndroidHookHook\nVirtualApk****[  VirtualApk ](http://blog.csdn.net/lmj623565791/article/details/75000580)\n","slug":"android-noroot-hook","published":1,"date":"2017-07-11T16:00:00.000Z","updated":"2017-11-23T07:25:44.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ec0t003bd6yk7054hrta","content":"<p><a href=\"http://blog.csdn.net/jiangwei0910410003/article/details/52523679\" target=\"_blank\" rel=\"external\">Android-rootHook</a> <a href=\"https://github.com/didi/VirtualAPK\" target=\"_blank\" rel=\"external\">VirtualApk</a> hook</p>\n<p>360 <a href=\"https://github.com/DroidPluginTeam/DroidPlugin\" target=\"_blank\" rel=\"external\">Droid Plugin</a>360 <a href=\"https://github.com/Qihoo360/RePlugin\" target=\"_blank\" rel=\"external\">RePlugin</a></p>\n<p><a href=\"https://www.itcodemonkey.com/article/278.html\" target=\"_blank\" rel=\"external\">https://www.itcodemonkey.com/article/278.html</a><br>                <a href=\"https://www.itcodemonkey.com/article/277.html\" target=\"_blank\" rel=\"external\">https://www.itcodemonkey.com/article/277.html</a></p>\n<p>360RePlugin<a href=\"https://github.com/Qihoo360/RePlugin/blob/master/README_CN.md\" target=\"_blank\" rel=\"external\">readme</a></p>\n<p><strong>VirtualApk</strong>hook</p>\n<h3 id=\"Androidroothook\"><a href=\"#Androidroothook\" class=\"headerlink\" title=\"Androidroothook\"></a>Androidroothook</h3><h4 id=\"Binder\"><a href=\"#Binder\" class=\"headerlink\" title=\"Binder\"></a>Binder</h4><a id=\"more\"></a>\n<p> AndroidBinderHookBinderServiceManagerStubasInterfaceBindersystem_serverProxy</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>Hook<strong></strong><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//</span></div><div class=\"line\">ClipboardManager cm =(ClipboardManager)getSystemService(Context.CLIPBOARD_SERVICE);</div><div class=\"line\"><span class=\"comment\">//</span></div><div class=\"line\">cm.setPrimaryClip(ClipData.newPlainText(<span class=\"string\">\"data\"</span>,<span class=\"string\">\"jack\"</span>));</div><div class=\"line\"><span class=\"comment\">//</span></div><div class=\"line\">ClipData cd = cm.getPrimaryClip();</div><div class=\"line\">String msg = cd.getItemAt(<span class=\"number\">0</span>).getText().toString();</div><div class=\"line\">Log.d(<span class=\"string\">\"jw\"</span>, <span class=\"string\">\"msg:\"</span>+ msg);</div></pre></td></tr></table></figure></p>\n<p>getSystemServiceContextgetSystemServiceComtextImpl.java<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">getSystemService</span><span class=\"params\">(String name)</span> </span>&#123;</div><div class=\"line\">   ServiceFetcher fetcher = SYSTEM_SERVICE_MAP.get(name);</div><div class=\"line\">   <span class=\"keyword\">return</span> fetcher == <span class=\"keyword\">null</span> ? <span class=\"keyword\">null</span> : fetcher.getService(<span class=\"keyword\">this</span>);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>ServiceFetcherMap<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">registerService</span><span class=\"params\">(String serviceName, ServiceFetcher fetcher)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (!(fetcher <span class=\"keyword\">instanceof</span> StaticServiceFetcher)) &#123;</div><div class=\"line\">        fetcher.mContextCacheIndex = sNextPerContextServiceCacheIndex++;</div><div class=\"line\">    &#125;</div><div class=\"line\">    SYSTEM_SERVICE_MAP.put(serviceName, fetcher);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>registerServiceServiceFetcher:<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">static</span> &#123;</div><div class=\"line\">    registerService(ACCESSIBILITY_SERVICE, <span class=\"keyword\">new</span> ServiceFetcher() &#123;</div><div class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">getService</span><span class=\"params\">(ContextImpl ctx)</span> </span>&#123;</div><div class=\"line\">                <span class=\"keyword\">return</span> AccessibilityManager.getInstance(ctx);</div><div class=\"line\">            &#125;&#125;);</div><div class=\"line\">    <span class=\"comment\">//...</span></div><div class=\"line\">    registerService(CLIPBOARD_SERVICE, <span class=\"keyword\">new</span> ServiceFetcher() &#123;</div><div class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">createService</span><span class=\"params\">(ContextImpl ctx)</span> </span>&#123;</div><div class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> ClipboardManager(ctx.getOuterContext(),</div><div class=\"line\">                            ctx.mMainThread.getHandler());</div><div class=\"line\">            &#125;&#125;);        </div><div class=\"line\">    <span class=\"comment\">//....</span></div><div class=\"line\"></div><div class=\"line\">    registerService(CONNECTIVITY_SERVICE, <span class=\"keyword\">new</span> ServiceFetcher() &#123;</div><div class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">createService</span><span class=\"params\">(ContextImpl ctx)</span> </span>&#123;</div><div class=\"line\">                IBinder b = ServiceManager.getService(CONNECTIVITY_SERVICE);</div><div class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> ConnectivityManager(IConnectivityManager.Stub.asInterface(b));</div><div class=\"line\">            &#125;&#125;);</div><div class=\"line\">    <span class=\"comment\">//....</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>ClipboardManager</p>\n</blockquote>\n<p>ClipboardManagerIClipboard.StubIConnectivityManager.StubasInterfaceProxy</p>\n<p>ClipboardManager.java<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setPrimaryClip</span><span class=\"params\">(ClipData clip)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (clip != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            clip.prepareToLeaveProcess();</div><div class=\"line\">        &#125;</div><div class=\"line\">        getService().setPrimaryClip(clip, mContext.getOpPackageName());</div><div class=\"line\">    &#125; <span class=\"keyword\">catch</span> (RemoteException e) &#123;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>getServicegetServiceIClipboard.StubasInterfaceProxy<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">private</span> IClipboard <span class=\"title\">getService</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">synchronized</span> (sStaticLock) &#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (sService != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> sService;</div><div class=\"line\">        &#125;</div><div class=\"line\">        IBinder b = ServiceManager.getService(<span class=\"string\">\"clipboard\"</span>);</div><div class=\"line\">        sService = IClipboard.Stub.asInterface(b);</div><div class=\"line\">        <span class=\"keyword\">return</span> sService;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>ServiceManagerClipboardIBinderasInterfaceProxy</p>\n<p></p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/clipboard-ipc-process.png\" alt=\"\"></p>\n<p>ServiceManagergetServiceIBinderStubasInterfaceProxyStubBinderAIDLProxyAIDLAIDLIInterface</p>\n<h3 id=\"Hook\"><a href=\"#Hook\" class=\"headerlink\" title=\"Hook\"></a>Hook</h3><p>AndroidandroidHookHookHookHook</p>\n<ul>\n<li>1HookHookHook<strong></strong><strong></strong>HookstaticHookAndroid</li>\n<li>2HookJava<ul>\n<li></li>\n<li>Proxy$0</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/service-proxy-common.png\" alt=\"\"></p>\n<p>VirtualApk</p>\n<pre><code>DroidPlugin\n</code></pre><p>VirtualApkcom/didi/virtualapk/delegate/ProxyIContentProviderProxy.java<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">IContentProviderProxy</span> <span class=\"keyword\">implements</span> <span class=\"title\">InvocationHandler</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\">//.....</span></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> IContentProvider <span class=\"title\">newInstance</span><span class=\"params\">(Context context, IContentProvider iContentProvider)</span> </span>&#123;</div><div class=\"line\">      <span class=\"keyword\">return</span> (IContentProvider) Proxy.newProxyInstance(iContentProvider.getClass().getClassLoader(),</div><div class=\"line\">              <span class=\"keyword\">new</span> Class[] &#123; IContentProvider.class &#125;, <span class=\"keyword\">new</span> IContentProviderProxy(context, iContentProvider));</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"meta\">@Override</span></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">invoke</span><span class=\"params\">(Object proxy, Method method, Object[] args)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</div><div class=\"line\">      Log.v(TAG, method.toGenericString() + <span class=\"string\">\" : \"</span> + Arrays.toString(args));</div><div class=\"line\">      wrapperUri(method, args);</div><div class=\"line\"></div><div class=\"line\">      <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">          <span class=\"keyword\">return</span> method.invoke(mBase, args);</div><div class=\"line\">      &#125; <span class=\"keyword\">catch</span> (InvocationTargetException e) &#123;</div><div class=\"line\">          <span class=\"keyword\">throw</span> e.getTargetException();</div><div class=\"line\">      &#125;</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\">//...</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>java AOPIContentProviderProxy<strong>java.lang.ref.proxy</strong></p>\n<blockquote>\n<p>ASMInvocationHandlerIBM<a href=\"https://www.ibm.com/developerworks/cn/java/j-lo-asm30/index.html\" target=\"_blank\" rel=\"external\">AOP ASM 3.0 </a></p>\n</blockquote>\n<h4 id=\"java\"><a href=\"#java\" class=\"headerlink\" title=\"java\"></a>java</h4><p>java<strong>InvocationHandler(Interface)</strong><strong>Proxy(Class)</strong></p>\n<p>IBM<br>AccountAccountImpl<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Account</span> </span>&#123;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">operation</span><span class=\"params\">()</span></span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AccountImpl</span> <span class=\"keyword\">extends</span> <span class=\"title\">Account</span></span>&#123;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">operation</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        System.out.println(<span class=\"string\">\"operation...\"</span>);</div><div class=\"line\">        <span class=\"comment\">//TODO real operation</span></div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>Accountoperation()checkSecurity()</p>\n<p>InvocationHandlerProxy<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SecurityProxyInvocationHandler</span> <span class=\"keyword\">implements</span> <span class=\"title\">InvocationHandler</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">private</span> Object proxyedObject;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">SecurityProxyInvocationHandler</span><span class=\"params\">(Object o)</span> </span>&#123;</div><div class=\"line\">        proxyedObject = o;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">invoke</span><span class=\"params\">(Object object, Method method, Object[] arguments)</span></span></div><div class=\"line\">        <span class=\"keyword\">throws</span> Throwable &#123;             </div><div class=\"line\">        <span class=\"keyword\">if</span> (object <span class=\"keyword\">instanceof</span> Account &amp;&amp; method.getName().equals(<span class=\"string\">\"opertaion\"</span>)) &#123;</div><div class=\"line\">            SecurityChecker.checkSecurity();</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">return</span> method.invoke(proxyedObject, arguments);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</div><div class=\"line\">    Account account = (Account) Proxy.newProxyInstance(</div><div class=\"line\">        Account.class.getClassLoader(),</div><div class=\"line\">        <span class=\"keyword\">new</span> Class[] &#123; Account.class &#125;,</div><div class=\"line\">        <span class=\"keyword\">new</span> SecurityProxyInvocationHandler(<span class=\"keyword\">new</span> AccountImpl())</div><div class=\"line\">    );</div><div class=\"line\">    account.function();</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li><p>InvocationHandler<strong>invoke()</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\">Object <span class=\"title\">invoke</span><span class=\"params\">(Object proxy, Method method, Object[] args)</span> <span class=\"keyword\">throws</span> Throwable</span></div></pre></td></tr></table></figure>\n<ul>\n<li>proxy:</li>\n<li>method:Method</li>\n<li>args:</li>\n</ul>\n</li>\n</ul>\n<p>InvocationHandleraccountInvocationHandler<strong>invoke</strong></p>\n<ul>\n<li><p>Proxy<strong>newProxyInstance</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Object <span class=\"title\">newProxyInstance</span><span class=\"params\">(ClassLoader loader, Class&lt;?&gt;[] interfaces, InvocationHandler h)</span> <span class=\"keyword\">throws</span> IllegalArgumentException</span></div></pre></td></tr></table></figure>\n<ul>\n<li>loader:ClassLoaderClassLoader</li>\n<li>interfaces:Interface()</li>\n<li>h:InvocationHandlerInvocationHandler</li>\n</ul>\n</li>\n</ul>\n<p>ProxynewProxyInstance()</p>\n<p>Proxy</p>\n<ul>\n<li>Proxy  Proxy Proxy  <strong>Proxy.newProxyInstance</strong>  Account AccountImpl </li>\n<li>Proxy 10 proxy class  invoke  proxy class </li>\n</ul>\n<blockquote>\n<p>VirtualApk IContentProviderProxy Account SecurityProxyInvocationHandler IContentProviderProxy  <strong>InvocationHandler </strong><strong>invoke()</strong></p>\n</blockquote>\n<p>VirtualApkIContentProviderProxyinvoke()invoke() wrapperUri()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">wrapperUri</span><span class=\"params\">(Method method, Object[] args)</span> </span>&#123;</div><div class=\"line\">    Uri uri = <span class=\"keyword\">null</span>;</div><div class=\"line\">    <span class=\"keyword\">int</span> index = <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (args != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; args.length; i++) &#123;</div><div class=\"line\">            <span class=\"keyword\">if</span> (args[i] <span class=\"keyword\">instanceof</span> Uri) &#123;</div><div class=\"line\">                uri = (Uri) args[i];</div><div class=\"line\">                index = i;</div><div class=\"line\">                <span class=\"keyword\">break</span>;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//call</span></div><div class=\"line\">    Bundle bundleInCallMethod = <span class=\"keyword\">null</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (method.getName().equals(<span class=\"string\">\"call\"</span>)) &#123;</div><div class=\"line\">        bundleInCallMethod = getBundleParameter(args);</div><div class=\"line\">        <span class=\"keyword\">if</span> (bundleInCallMethod != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            String uriString = bundleInCallMethod.getString(KEY_WRAPPER_URI);</div><div class=\"line\">            <span class=\"keyword\">if</span> (uriString != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">                uri = Uri.parse(uriString);</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"comment\">//...</span></div><div class=\"line\"></div><div class=\"line\">    PluginManager pluginManager = PluginManager.getInstance(mContext);</div><div class=\"line\">    <span class=\"comment\">//uriContentProvider</span></div><div class=\"line\">    ProviderInfo info = pluginManager.resolveContentProvider(uri.getAuthority(), <span class=\"number\">0</span>);</div><div class=\"line\">    <span class=\"keyword\">if</span> (info != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">        String pkg = info.packageName;</div><div class=\"line\">        LoadedPlugin plugin = pluginManager.getLoadedPlugin(pkg);</div><div class=\"line\">        String pluginUri = Uri.encode(uri.toString());</div><div class=\"line\">        StringBuilder builder = <span class=\"keyword\">new</span> StringBuilder(PluginContentResolver.getUri(mContext));</div><div class=\"line\">        builder.append(<span class=\"string\">\"/?plugin=\"</span> + plugin.getLocation());</div><div class=\"line\">        builder.append(<span class=\"string\">\"&amp;pkg=\"</span> + pkg);</div><div class=\"line\">        builder.append(<span class=\"string\">\"&amp;uri=\"</span> + pluginUri);</div><div class=\"line\">        Uri wrapperUri = Uri.parse(builder.toString());</div><div class=\"line\">        <span class=\"keyword\">if</span> (method.getName().equals(<span class=\"string\">\"call\"</span>)) &#123;</div><div class=\"line\">            bundleInCallMethod.putString(KEY_WRAPPER_URI, wrapperUri.toString());</div><div class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">            args[index] = wrapperUri;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<ul>\n<li>1.wrapperUri()Uri</li>\n<li><p>2.resolveContentProvider()uriContentProvider</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> ProviderInfo <span class=\"title\">resolveContentProvider</span><span class=\"params\">(String name, <span class=\"keyword\">int</span> flags)</span> </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.mProviders.get(name);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>ProviderInfoHolds information about a specific content provider</p>\n</li>\n<li>3.StringBuilderuripkgpluginargsuri</li>\n</ul>\n<blockquote>\n<p>queryproviderquery</p>\n</blockquote>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>JavaHookHookHookHookAndroidServiceManagerIBinderHook</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> IBinder <span class=\"title\">getService</span><span class=\"params\">(String name)</span> </span>&#123;</div><div class=\"line\">   <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">       IBinder service = sCache.get(name);</div><div class=\"line\">       <span class=\"keyword\">if</span> (service != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">           <span class=\"keyword\">return</span> service;</div><div class=\"line\">       &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">           <span class=\"keyword\">return</span> getIServiceManager().getService(name);</div><div class=\"line\">       &#125;</div><div class=\"line\">   &#125; <span class=\"keyword\">catch</span> (RemoteException e) &#123;</div><div class=\"line\">       Log.e(TAG, <span class=\"string\">\"error in getService\"</span>, e);</div><div class=\"line\">   &#125;</div><div class=\"line\">   <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>ServiceManager<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> HashMap&lt;String, IBinder&gt; sCache = <span class=\"keyword\">new</span> HashMap&lt;String, IBinder&gt;();</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>static</p>\n</blockquote>\n<p>IBinder</p>\n<p>Proxy Java</p>\n<ul>\n<li>IBinder</li>\n<li></li>\n</ul>\n<p><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">try</span> &#123;</div><div class=\"line\">  <span class=\"comment\">//ServiceManager.getService(\"clipboard\")</span></div><div class=\"line\">  <span class=\"comment\">//ServiceManager@hide</span></div><div class=\"line\">  Class&lt;?&gt; serviceManager = Class.forName(<span class=\"string\">\"android.os.ServiceManager\"</span>);</div><div class=\"line\">  Method getService = serviceManager.getDeclaredMethod(<span class=\"string\">\"getService\"</span>, String.class);</div><div class=\"line\">  <span class=\"comment\">//ServiceManagerclipboard binder</span></div><div class=\"line\">  <span class=\"comment\">//Binder</span></div><div class=\"line\">  IBinder rawBinder =(IBinder) getService.invoke(<span class=\"keyword\">null</span>, Context.CLIPBOARD_SERVICE);</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\">//HookBinderqueryLocalInterface </span></div><div class=\"line\">  <span class=\"comment\">//queryLocalInterfaceIInterfacehook</span></div><div class=\"line\">  IBinder hookedBinder =(IBinder) Proxy.newProxyInstance(</div><div class=\"line\">      serviceManager.getClassLoader,</div><div class=\"line\">      <span class=\"keyword\">new</span> Class&lt;?&gt;[](IBinder.class),</div><div class=\"line\">      <span class=\"keyword\">new</span> IClipboardHookBinderHandler(rawBinder)</div><div class=\"line\">  );</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\">//ServiceManager</span></div><div class=\"line\">  Field cacheField = serviceManager.getDeclaredField(<span class=\"string\">\"sCache\"</span>);</div><div class=\"line\">  cacheField.setAccessible(<span class=\"keyword\">true</span>);</div><div class=\"line\">  <span class=\"meta\">@SuppressWarnings</span>(&#123;<span class=\"string\">\"unchecked\"</span>&#125;)</div><div class=\"line\">  Map&lt;String, IBinder&gt; cache = (Map&lt;String,IBinder&gt;) cacheField.get(<span class=\"keyword\">null</span>);</div><div class=\"line\">  cache.put(Context.CLIPBOARD_SERVICE, hookedBinder);</div><div class=\"line\">&#125;<span class=\"keyword\">catch</span> (Exception e)&#123;</div><div class=\"line\"></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>Field.get()Objectnull java.lang.NullPointerException,,null</p>\n</blockquote>\n<p>ServiceManagerBinderBinder</p>\n<p><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">invoke</span><span class=\"params\">(Object object, Method method, Object[] args)</span></span></div><div class=\"line\">    <span class=\"keyword\">throws</span> Throwable &#123;             </div><div class=\"line\">    <span class=\"keyword\">if</span> (method.getName().equals(<span class=\"string\">\"queryLocalInterface\"</span>)) &#123;</div><div class=\"line\">        Log.d(TAG, <span class=\"string\">\"hook queryLocalInterface\"</span>);</div><div class=\"line\"></div><div class=\"line\">        <span class=\"comment\">//hookService</span></div><div class=\"line\">        <span class=\"comment\">//IInterface</span></div><div class=\"line\">        <span class=\"keyword\">return</span> Proxy.newProxyInstance(</div><div class=\"line\">            base.getClassLoader,</div><div class=\"line\">            <span class=\"keyword\">new</span> Class&lt;?&gt;[](<span class=\"keyword\">this</span>.iinterface),</div><div class=\"line\">            <span class=\"keyword\">new</span> HookBinderInvocationHander(base,stub)</div><div class=\"line\">            );</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> method.invoke(base, args);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>queryLocalInterface()</p>\n</blockquote>\n<p>setPrimaryClipBinderIClipboardManagerProxyStubasInterfaceBinderAIDL<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> com.agehua.aidldemo.<span class=\"function\">Demo <span class=\"title\">asInterface</span><span class=\"params\">(android.os.IBinder obj)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> ((obj == <span class=\"keyword\">null</span>)) &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"comment\">//objqueryLocalInterface()hook</span></div><div class=\"line\">    android.os.IInterface iin = obj.queryLocalInterface(DESCRIPTOR);</div><div class=\"line\">    <span class=\"keyword\">if</span> (((iin != <span class=\"keyword\">null</span>) &amp;&amp; (iin <span class=\"keyword\">instanceof</span> com.agehua.aidldemo.Demo))) &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> ((com.agehua.aidldemo.Demo) iin);</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> com.agehua.aidldemo.Demo.Stub.Proxy(obj);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>IClipboardManagersetPrimaryClipClipboardManager$ProxyClipboardManager$Proxy</p>\n<ul>\n<li>ClipboardManager$ProxyAIDL</li>\n<li>IClipboardManager$StubasInterfaceIClipboardManager$Proxy</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">IClipboardHookBinderHandler</span><span class=\"params\">(IBinder base)</span> </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">this</span>.base = base;</div><div class=\"line\">  <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">    <span class=\"keyword\">this</span>.stub =Class.forName(<span class=\"string\">\"android.content.IClipboard$Stub\"</span>);</div><div class=\"line\">    <span class=\"keyword\">this</span>.iinterface = Class.forName(<span class=\"string\">\"android.content.IClipboard\"</span>);</div><div class=\"line\">  &#125;<span class=\"keyword\">catch</span> (ClassNotFoundException e)&#123;</div><div class=\"line\"></div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">IClipboardHookBinderHandler</span><span class=\"params\">(IBinder base, Class&lt;?&gt; stubClass)</span> </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">    Method asInterfaceMethod = stubClass.getDeclaredMethod(<span class=\"string\">\"asInterface\"</span>, IBinder.class);</div><div class=\"line\">    <span class=\"keyword\">this</span>.base = asInterfaceMethod.invoke(<span class=\"keyword\">null</span>, base);</div><div class=\"line\">  &#125;<span class=\"keyword\">catch</span> (Exception e)&#123;</div><div class=\"line\">    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> RuntimeException(<span class=\"string\">\"hooked failed\"</span>)</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>InvocationHandlerProxy<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">invoke</span><span class=\"params\">(Object proxy, Method method, Object[] args)</span> <span class=\"keyword\">throws</span> Throwable</span>&#123;</div><div class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"string\">\"getPrimaryClip\"</span>.equals(method.getName())) &#123;</div><div class=\"line\">      <span class=\"keyword\">return</span> ClipData.newPlainText(<span class=\"keyword\">null</span>, <span class=\"string\">\"you are hooked\"</span>);</div><div class=\"line\">  &#125;</div><div class=\"line\">  <span class=\"comment\">//</span></div><div class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"string\">\"hasPrimaryClip\"</span>.equals(method.getName())) &#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</div><div class=\"line\">  &#125;</div><div class=\"line\">  <span class=\"comment\">//</span></div><div class=\"line\">  <span class=\"keyword\">return</span> method.invoke(base, args);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>hook<br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/hook-clipboard-process.png\" alt=\"\"></p>\n<ul>\n<li>1ServiceManagerIBinderIBinder</li>\n<li>2HookBinderBinder<ul>\n<li>1) BinderIBinder</li>\n<li>2) Binder<br>queryLocalInterfaceStubBinderHookHook</li>\n</ul>\n</li>\n<li>3BinderqueryLocalInterfaceIClipboard$Proxy<ul>\n<li>1) AIDL()</li>\n<li>2) IClipboard$StubasInterfaceIClipboard$Proxy<br></li>\n</ul>\n</li>\n</ul>\n<blockquote>\n<p>Hookhooksystem_serverroot</p>\n</blockquote>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>AndroidHookHook<br>VirtualApk<strong></strong><a href=\"http://blog.csdn.net/lmj623565791/article/details/75000580\" target=\"_blank\" rel=\"external\">  VirtualApk </a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/07/12/android-noroot-hook/\">http://agehua.github.io/2017/07/12/android-noroot-hook/</a></p>\n","readingTime":{"text":"8 min read","minutes":7.69,"time":461400.00000000006,"words":1538},"excerpt":"<p><a href=\"http://blog.csdn.net/jiangwei0910410003/article/details/52523679\">Android-rootHook</a> <a href=\"https://github.com/didi/VirtualAPK\">VirtualApk</a> hook</p>\n<p>360 <a href=\"https://github.com/DroidPluginTeam/DroidPlugin\">Droid Plugin</a>360 <a href=\"https://github.com/Qihoo360/RePlugin\">RePlugin</a></p>\n<p><a href=\"https://www.itcodemonkey.com/article/278.html\">https://www.itcodemonkey.com/article/278.html</a><br>                <a href=\"https://www.itcodemonkey.com/article/277.html\">https://www.itcodemonkey.com/article/277.html</a></p>\n<p>360RePlugin<a href=\"https://github.com/Qihoo360/RePlugin/blob/master/README_CN.md\">readme</a></p>\n<p><strong>VirtualApk</strong>hook</p>\n<h3 id=\"Androidroothook\"><a href=\"#Androidroothook\" class=\"headerlink\" title=\"Androidroothook\"></a>Androidroothook</h3><h4 id=\"Binder\"><a href=\"#Binder\" class=\"headerlink\" title=\"Binder\"></a>Binder</h4>","more":"<p> AndroidBinderHookBinderServiceManagerStubasInterfaceBindersystem_serverProxy</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>Hook<strong></strong><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//</span></div><div class=\"line\">ClipboardManager cm =(ClipboardManager)getSystemService(Context.CLIPBOARD_SERVICE);</div><div class=\"line\"><span class=\"comment\">//</span></div><div class=\"line\">cm.setPrimaryClip(ClipData.newPlainText(<span class=\"string\">\"data\"</span>,<span class=\"string\">\"jack\"</span>));</div><div class=\"line\"><span class=\"comment\">//</span></div><div class=\"line\">ClipData cd = cm.getPrimaryClip();</div><div class=\"line\">String msg = cd.getItemAt(<span class=\"number\">0</span>).getText().toString();</div><div class=\"line\">Log.d(<span class=\"string\">\"jw\"</span>, <span class=\"string\">\"msg:\"</span>+ msg);</div></pre></td></tr></table></figure></p>\n<p>getSystemServiceContextgetSystemServiceComtextImpl.java<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">getSystemService</span><span class=\"params\">(String name)</span> </span>&#123;</div><div class=\"line\">   ServiceFetcher fetcher = SYSTEM_SERVICE_MAP.get(name);</div><div class=\"line\">   <span class=\"keyword\">return</span> fetcher == <span class=\"keyword\">null</span> ? <span class=\"keyword\">null</span> : fetcher.getService(<span class=\"keyword\">this</span>);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>ServiceFetcherMap<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">registerService</span><span class=\"params\">(String serviceName, ServiceFetcher fetcher)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (!(fetcher <span class=\"keyword\">instanceof</span> StaticServiceFetcher)) &#123;</div><div class=\"line\">        fetcher.mContextCacheIndex = sNextPerContextServiceCacheIndex++;</div><div class=\"line\">    &#125;</div><div class=\"line\">    SYSTEM_SERVICE_MAP.put(serviceName, fetcher);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>registerServiceServiceFetcher:<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">static</span> &#123;</div><div class=\"line\">    registerService(ACCESSIBILITY_SERVICE, <span class=\"keyword\">new</span> ServiceFetcher() &#123;</div><div class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">getService</span><span class=\"params\">(ContextImpl ctx)</span> </span>&#123;</div><div class=\"line\">                <span class=\"keyword\">return</span> AccessibilityManager.getInstance(ctx);</div><div class=\"line\">            &#125;&#125;);</div><div class=\"line\">    <span class=\"comment\">//...</span></div><div class=\"line\">    registerService(CLIPBOARD_SERVICE, <span class=\"keyword\">new</span> ServiceFetcher() &#123;</div><div class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">createService</span><span class=\"params\">(ContextImpl ctx)</span> </span>&#123;</div><div class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> ClipboardManager(ctx.getOuterContext(),</div><div class=\"line\">                            ctx.mMainThread.getHandler());</div><div class=\"line\">            &#125;&#125;);        </div><div class=\"line\">    <span class=\"comment\">//....</span></div><div class=\"line\"></div><div class=\"line\">    registerService(CONNECTIVITY_SERVICE, <span class=\"keyword\">new</span> ServiceFetcher() &#123;</div><div class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">createService</span><span class=\"params\">(ContextImpl ctx)</span> </span>&#123;</div><div class=\"line\">                IBinder b = ServiceManager.getService(CONNECTIVITY_SERVICE);</div><div class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> ConnectivityManager(IConnectivityManager.Stub.asInterface(b));</div><div class=\"line\">            &#125;&#125;);</div><div class=\"line\">    <span class=\"comment\">//....</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>ClipboardManager</p>\n</blockquote>\n<p>ClipboardManagerIClipboard.StubIConnectivityManager.StubasInterfaceProxy</p>\n<p>ClipboardManager.java<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setPrimaryClip</span><span class=\"params\">(ClipData clip)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (clip != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            clip.prepareToLeaveProcess();</div><div class=\"line\">        &#125;</div><div class=\"line\">        getService().setPrimaryClip(clip, mContext.getOpPackageName());</div><div class=\"line\">    &#125; <span class=\"keyword\">catch</span> (RemoteException e) &#123;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>getServicegetServiceIClipboard.StubasInterfaceProxy<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">private</span> IClipboard <span class=\"title\">getService</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">synchronized</span> (sStaticLock) &#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (sService != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> sService;</div><div class=\"line\">        &#125;</div><div class=\"line\">        IBinder b = ServiceManager.getService(<span class=\"string\">\"clipboard\"</span>);</div><div class=\"line\">        sService = IClipboard.Stub.asInterface(b);</div><div class=\"line\">        <span class=\"keyword\">return</span> sService;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>ServiceManagerClipboardIBinderasInterfaceProxy</p>\n<p></p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/clipboard-ipc-process.png\" alt=\"\"></p>\n<p>ServiceManagergetServiceIBinderStubasInterfaceProxyStubBinderAIDLProxyAIDLAIDLIInterface</p>\n<h3 id=\"Hook\"><a href=\"#Hook\" class=\"headerlink\" title=\"Hook\"></a>Hook</h3><p>AndroidandroidHookHookHookHook</p>\n<ul>\n<li>1HookHookHook<strong></strong><strong></strong>HookstaticHookAndroid</li>\n<li>2HookJava<ul>\n<li></li>\n<li>Proxy$0</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/service-proxy-common.png\" alt=\"\"></p>\n<p>VirtualApk</p>\n<pre><code>DroidPlugin\n</code></pre><p>VirtualApkcom/didi/virtualapk/delegate/ProxyIContentProviderProxy.java<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">IContentProviderProxy</span> <span class=\"keyword\">implements</span> <span class=\"title\">InvocationHandler</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\">//.....</span></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> IContentProvider <span class=\"title\">newInstance</span><span class=\"params\">(Context context, IContentProvider iContentProvider)</span> </span>&#123;</div><div class=\"line\">      <span class=\"keyword\">return</span> (IContentProvider) Proxy.newProxyInstance(iContentProvider.getClass().getClassLoader(),</div><div class=\"line\">              <span class=\"keyword\">new</span> Class[] &#123; IContentProvider.class &#125;, <span class=\"keyword\">new</span> IContentProviderProxy(context, iContentProvider));</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"meta\">@Override</span></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">invoke</span><span class=\"params\">(Object proxy, Method method, Object[] args)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</div><div class=\"line\">      Log.v(TAG, method.toGenericString() + <span class=\"string\">\" : \"</span> + Arrays.toString(args));</div><div class=\"line\">      wrapperUri(method, args);</div><div class=\"line\"></div><div class=\"line\">      <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">          <span class=\"keyword\">return</span> method.invoke(mBase, args);</div><div class=\"line\">      &#125; <span class=\"keyword\">catch</span> (InvocationTargetException e) &#123;</div><div class=\"line\">          <span class=\"keyword\">throw</span> e.getTargetException();</div><div class=\"line\">      &#125;</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\">//...</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>java AOPIContentProviderProxy<strong>java.lang.ref.proxy</strong></p>\n<blockquote>\n<p>ASMInvocationHandlerIBM<a href=\"https://www.ibm.com/developerworks/cn/java/j-lo-asm30/index.html\">AOP ASM 3.0 </a></p>\n</blockquote>\n<h4 id=\"java\"><a href=\"#java\" class=\"headerlink\" title=\"java\"></a>java</h4><p>java<strong>InvocationHandler(Interface)</strong><strong>Proxy(Class)</strong></p>\n<p>IBM<br>AccountAccountImpl<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Account</span> </span>&#123;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">operation</span><span class=\"params\">()</span></span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AccountImpl</span> <span class=\"keyword\">extends</span> <span class=\"title\">Account</span></span>&#123;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">operation</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        System.out.println(<span class=\"string\">\"operation...\"</span>);</div><div class=\"line\">        <span class=\"comment\">//TODO real operation</span></div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>Accountoperation()checkSecurity()</p>\n<p>InvocationHandlerProxy<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SecurityProxyInvocationHandler</span> <span class=\"keyword\">implements</span> <span class=\"title\">InvocationHandler</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">private</span> Object proxyedObject;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">SecurityProxyInvocationHandler</span><span class=\"params\">(Object o)</span> </span>&#123;</div><div class=\"line\">        proxyedObject = o;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">invoke</span><span class=\"params\">(Object object, Method method, Object[] arguments)</span></div><div class=\"line\">        <span class=\"keyword\">throws</span> Throwable </span>&#123;             </div><div class=\"line\">        <span class=\"keyword\">if</span> (object <span class=\"keyword\">instanceof</span> Account &amp;&amp; method.getName().equals(<span class=\"string\">\"opertaion\"</span>)) &#123;</div><div class=\"line\">            SecurityChecker.checkSecurity();</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">return</span> method.invoke(proxyedObject, arguments);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</div><div class=\"line\">    Account account = (Account) Proxy.newProxyInstance(</div><div class=\"line\">        Account.class.getClassLoader(),</div><div class=\"line\">        <span class=\"keyword\">new</span> Class[] &#123; Account.class &#125;,</div><div class=\"line\">        <span class=\"keyword\">new</span> SecurityProxyInvocationHandler(<span class=\"keyword\">new</span> AccountImpl())</div><div class=\"line\">    );</div><div class=\"line\">    account.function();</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li><p>InvocationHandler<strong>invoke()</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\">Object <span class=\"title\">invoke</span><span class=\"params\">(Object proxy, Method method, Object[] args)</span> <span class=\"keyword\">throws</span> Throwable</span></div></pre></td></tr></table></figure>\n<ul>\n<li>proxy:</li>\n<li>method:Method</li>\n<li>args:</li>\n</ul>\n</li>\n</ul>\n<p>InvocationHandleraccountInvocationHandler<strong>invoke</strong></p>\n<ul>\n<li><p>Proxy<strong>newProxyInstance</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Object <span class=\"title\">newProxyInstance</span><span class=\"params\">(ClassLoader loader, Class&lt;?&gt;[] interfaces, InvocationHandler h)</span> <span class=\"keyword\">throws</span> IllegalArgumentException</span></div></pre></td></tr></table></figure>\n<ul>\n<li>loader:ClassLoaderClassLoader</li>\n<li>interfaces:Interface()</li>\n<li>h:InvocationHandlerInvocationHandler</li>\n</ul>\n</li>\n</ul>\n<p>ProxynewProxyInstance()</p>\n<p>Proxy</p>\n<ul>\n<li>Proxy  Proxy Proxy  <strong>Proxy.newProxyInstance</strong>  Account AccountImpl </li>\n<li>Proxy 10 proxy class  invoke  proxy class </li>\n</ul>\n<blockquote>\n<p>VirtualApk IContentProviderProxy Account SecurityProxyInvocationHandler IContentProviderProxy  <strong>InvocationHandler </strong><strong>invoke()</strong></p>\n</blockquote>\n<p>VirtualApkIContentProviderProxyinvoke()invoke() wrapperUri()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">wrapperUri</span><span class=\"params\">(Method method, Object[] args)</span> </span>&#123;</div><div class=\"line\">    Uri uri = <span class=\"keyword\">null</span>;</div><div class=\"line\">    <span class=\"keyword\">int</span> index = <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (args != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; args.length; i++) &#123;</div><div class=\"line\">            <span class=\"keyword\">if</span> (args[i] <span class=\"keyword\">instanceof</span> Uri) &#123;</div><div class=\"line\">                uri = (Uri) args[i];</div><div class=\"line\">                index = i;</div><div class=\"line\">                <span class=\"keyword\">break</span>;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//call</span></div><div class=\"line\">    Bundle bundleInCallMethod = <span class=\"keyword\">null</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (method.getName().equals(<span class=\"string\">\"call\"</span>)) &#123;</div><div class=\"line\">        bundleInCallMethod = getBundleParameter(args);</div><div class=\"line\">        <span class=\"keyword\">if</span> (bundleInCallMethod != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            String uriString = bundleInCallMethod.getString(KEY_WRAPPER_URI);</div><div class=\"line\">            <span class=\"keyword\">if</span> (uriString != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">                uri = Uri.parse(uriString);</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"comment\">//...</span></div><div class=\"line\"></div><div class=\"line\">    PluginManager pluginManager = PluginManager.getInstance(mContext);</div><div class=\"line\">    <span class=\"comment\">//uriContentProvider</span></div><div class=\"line\">    ProviderInfo info = pluginManager.resolveContentProvider(uri.getAuthority(), <span class=\"number\">0</span>);</div><div class=\"line\">    <span class=\"keyword\">if</span> (info != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">        String pkg = info.packageName;</div><div class=\"line\">        LoadedPlugin plugin = pluginManager.getLoadedPlugin(pkg);</div><div class=\"line\">        String pluginUri = Uri.encode(uri.toString());</div><div class=\"line\">        StringBuilder builder = <span class=\"keyword\">new</span> StringBuilder(PluginContentResolver.getUri(mContext));</div><div class=\"line\">        builder.append(<span class=\"string\">\"/?plugin=\"</span> + plugin.getLocation());</div><div class=\"line\">        builder.append(<span class=\"string\">\"&amp;pkg=\"</span> + pkg);</div><div class=\"line\">        builder.append(<span class=\"string\">\"&amp;uri=\"</span> + pluginUri);</div><div class=\"line\">        Uri wrapperUri = Uri.parse(builder.toString());</div><div class=\"line\">        <span class=\"keyword\">if</span> (method.getName().equals(<span class=\"string\">\"call\"</span>)) &#123;</div><div class=\"line\">            bundleInCallMethod.putString(KEY_WRAPPER_URI, wrapperUri.toString());</div><div class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">            args[index] = wrapperUri;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<ul>\n<li>1.wrapperUri()Uri</li>\n<li><p>2.resolveContentProvider()uriContentProvider</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> ProviderInfo <span class=\"title\">resolveContentProvider</span><span class=\"params\">(String name, <span class=\"keyword\">int</span> flags)</span> </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.mProviders.get(name);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>ProviderInfoHolds information about a specific content provider</p>\n</li>\n<li>3.StringBuilderuripkgpluginargsuri</li>\n</ul>\n<blockquote>\n<p>queryproviderquery</p>\n</blockquote>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>JavaHookHookHookHookAndroidServiceManagerIBinderHook</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> IBinder <span class=\"title\">getService</span><span class=\"params\">(String name)</span> </span>&#123;</div><div class=\"line\">   <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">       IBinder service = sCache.get(name);</div><div class=\"line\">       <span class=\"keyword\">if</span> (service != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">           <span class=\"keyword\">return</span> service;</div><div class=\"line\">       &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">           <span class=\"keyword\">return</span> getIServiceManager().getService(name);</div><div class=\"line\">       &#125;</div><div class=\"line\">   &#125; <span class=\"keyword\">catch</span> (RemoteException e) &#123;</div><div class=\"line\">       Log.e(TAG, <span class=\"string\">\"error in getService\"</span>, e);</div><div class=\"line\">   &#125;</div><div class=\"line\">   <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>ServiceManager<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> HashMap&lt;String, IBinder&gt; sCache = <span class=\"keyword\">new</span> HashMap&lt;String, IBinder&gt;();</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>static</p>\n</blockquote>\n<p>IBinder</p>\n<p>Proxy Java</p>\n<ul>\n<li>IBinder</li>\n<li></li>\n</ul>\n<p><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">try</span> &#123;</div><div class=\"line\">  <span class=\"comment\">//ServiceManager.getService(\"clipboard\")</span></div><div class=\"line\">  <span class=\"comment\">//ServiceManager@hide</span></div><div class=\"line\">  Class&lt;?&gt; serviceManager = Class.forName(<span class=\"string\">\"android.os.ServiceManager\"</span>);</div><div class=\"line\">  Method getService = serviceManager.getDeclaredMethod(<span class=\"string\">\"getService\"</span>, String.class);</div><div class=\"line\">  <span class=\"comment\">//ServiceManagerclipboard binder</span></div><div class=\"line\">  <span class=\"comment\">//Binder</span></div><div class=\"line\">  IBinder rawBinder =(IBinder) getService.invoke(<span class=\"keyword\">null</span>, Context.CLIPBOARD_SERVICE);</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\">//HookBinderqueryLocalInterface </span></div><div class=\"line\">  <span class=\"comment\">//queryLocalInterfaceIInterfacehook</span></div><div class=\"line\">  IBinder hookedBinder =(IBinder) Proxy.newProxyInstance(</div><div class=\"line\">      serviceManager.getClassLoader,</div><div class=\"line\">      <span class=\"keyword\">new</span> Class&lt;?&gt;[](IBinder.class),</div><div class=\"line\">      <span class=\"keyword\">new</span> IClipboardHookBinderHandler(rawBinder)</div><div class=\"line\">  );</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\">//ServiceManager</span></div><div class=\"line\">  Field cacheField = serviceManager.getDeclaredField(<span class=\"string\">\"sCache\"</span>);</div><div class=\"line\">  cacheField.setAccessible(<span class=\"keyword\">true</span>);</div><div class=\"line\">  <span class=\"meta\">@SuppressWarnings</span>(&#123;<span class=\"string\">\"unchecked\"</span>&#125;)</div><div class=\"line\">  Map&lt;String, IBinder&gt; cache = (Map&lt;String,IBinder&gt;) cacheField.get(<span class=\"keyword\">null</span>);</div><div class=\"line\">  cache.put(Context.CLIPBOARD_SERVICE, hookedBinder);</div><div class=\"line\">&#125;<span class=\"keyword\">catch</span> (Exception e)&#123;</div><div class=\"line\"></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>Field.get()Objectnull java.lang.NullPointerException,,null</p>\n</blockquote>\n<p>ServiceManagerBinderBinder</p>\n<p><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">invoke</span><span class=\"params\">(Object object, Method method, Object[] args)</span></div><div class=\"line\">    <span class=\"keyword\">throws</span> Throwable </span>&#123;             </div><div class=\"line\">    <span class=\"keyword\">if</span> (method.getName().equals(<span class=\"string\">\"queryLocalInterface\"</span>)) &#123;</div><div class=\"line\">        Log.d(TAG, <span class=\"string\">\"hook queryLocalInterface\"</span>);</div><div class=\"line\"></div><div class=\"line\">        <span class=\"comment\">//hookService</span></div><div class=\"line\">        <span class=\"comment\">//IInterface</span></div><div class=\"line\">        <span class=\"keyword\">return</span> Proxy.newProxyInstance(</div><div class=\"line\">            base.getClassLoader,</div><div class=\"line\">            <span class=\"keyword\">new</span> Class&lt;?&gt;[](<span class=\"keyword\">this</span>.iinterface),</div><div class=\"line\">            <span class=\"keyword\">new</span> HookBinderInvocationHander(base,stub)</div><div class=\"line\">            );</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> method.invoke(base, args);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>queryLocalInterface()</p>\n</blockquote>\n<p>setPrimaryClipBinderIClipboardManagerProxyStubasInterfaceBinderAIDL<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> com.agehua.aidldemo.<span class=\"function\">Demo <span class=\"title\">asInterface</span><span class=\"params\">(android.os.IBinder obj)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> ((obj == <span class=\"keyword\">null</span>)) &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"comment\">//objqueryLocalInterface()hook</span></div><div class=\"line\">    android.os.IInterface iin = obj.queryLocalInterface(DESCRIPTOR);</div><div class=\"line\">    <span class=\"keyword\">if</span> (((iin != <span class=\"keyword\">null</span>) &amp;&amp; (iin <span class=\"keyword\">instanceof</span> com.agehua.aidldemo.Demo))) &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> ((com.agehua.aidldemo.Demo) iin);</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> com.agehua.aidldemo.Demo.Stub.Proxy(obj);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>IClipboardManagersetPrimaryClipClipboardManager$ProxyClipboardManager$Proxy</p>\n<ul>\n<li>ClipboardManager$ProxyAIDL</li>\n<li>IClipboardManager$StubasInterfaceIClipboardManager$Proxy</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">IClipboardHookBinderHandler</span><span class=\"params\">(IBinder base)</span> </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">this</span>.base = base;</div><div class=\"line\">  <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">    <span class=\"keyword\">this</span>.stub =Class.forName(<span class=\"string\">\"android.content.IClipboard$Stub\"</span>);</div><div class=\"line\">    <span class=\"keyword\">this</span>.iinterface = Class.forName(<span class=\"string\">\"android.content.IClipboard\"</span>);</div><div class=\"line\">  &#125;<span class=\"keyword\">catch</span> (ClassNotFoundException e)&#123;</div><div class=\"line\"></div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">IClipboardHookBinderHandler</span><span class=\"params\">(IBinder base, Class&lt;?&gt; stubClass)</span> </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">    Method asInterfaceMethod = stubClass.getDeclaredMethod(<span class=\"string\">\"asInterface\"</span>, IBinder.class);</div><div class=\"line\">    <span class=\"keyword\">this</span>.base = asInterfaceMethod.invoke(<span class=\"keyword\">null</span>, base);</div><div class=\"line\">  &#125;<span class=\"keyword\">catch</span> (Exception e)&#123;</div><div class=\"line\">    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> RuntimeException(<span class=\"string\">\"hooked failed\"</span>)</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>InvocationHandlerProxy<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">invoke</span><span class=\"params\">(Object proxy, Method method, Object[] args)</span> <span class=\"keyword\">throws</span> Throwable</span>&#123;</div><div class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"string\">\"getPrimaryClip\"</span>.equals(method.getName())) &#123;</div><div class=\"line\">      <span class=\"keyword\">return</span> ClipData.newPlainText(<span class=\"keyword\">null</span>, <span class=\"string\">\"you are hooked\"</span>);</div><div class=\"line\">  &#125;</div><div class=\"line\">  <span class=\"comment\">//</span></div><div class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"string\">\"hasPrimaryClip\"</span>.equals(method.getName())) &#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</div><div class=\"line\">  &#125;</div><div class=\"line\">  <span class=\"comment\">//</span></div><div class=\"line\">  <span class=\"keyword\">return</span> method.invoke(base, args);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>hook<br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/hook-clipboard-process.png\" alt=\"\"></p>\n<ul>\n<li>1ServiceManagerIBinderIBinder</li>\n<li>2HookBinderBinder<ul>\n<li>1) BinderIBinder</li>\n<li>2) Binder<br>queryLocalInterfaceStubBinderHookHook</li>\n</ul>\n</li>\n<li>3BinderqueryLocalInterfaceIClipboard$Proxy<ul>\n<li>1) AIDL()</li>\n<li>2) IClipboard$StubasInterfaceIClipboard$Proxy<br></li>\n</ul>\n</li>\n</ul>\n<blockquote>\n<p>Hookhooksystem_serverroot</p>\n</blockquote>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>AndroidHookHook<br>VirtualApk<strong></strong><a href=\"http://blog.csdn.net/lmj623565791/article/details/75000580\">  VirtualApk </a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/07/12/android-noroot-hook/\">http://agehua.github.io/2017/07/12/android-noroot-hook/</a></p>"},{"layout":"post","title":"HandlerTimerTask","keywords":"handler, TimerTask","banner":"http://obxk8w81b.bkt.clouddn.com/Blossoming%20Almond%20Branch%20in%20a%20Glass%20with%20a%20Book.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Blossoming%20Almond%20Branch%20in%20a%20Glass%20with%20a%20Book.jpg","toc":true,"_content":"\n### HandlerTimerTask\nhttp://www.mopri.de/2010/timertask-bad-do-it-the-android-way-use-a-handler/\n\nTimerTaskGUIdebug\nhandler\n\nhandler100msRunnable:\n~~~ Java\nprivate Handler handler = new Handler();\nhandler.postDelayed(runnable, 100);\n~~~\n\n100msRunnableTimerTaskscheduleAtFixedRate():\n\n<!--more-->\n~~~ Java\nprivate Runnable runnable = new Runnable() {\n   @Override\n   public void run() {\n      /* do what you need to do */\n      foobar();\n      /* and here comes the \"trick\" */\n      handler.postDelayed(this, 100);\n   }\n};\n~~~\nRunnablehandler.removeCallback(runnable)\n\nnew Timer(Task)handlerrunnable\n","source":"_posts/2017-05-18-handler-replace-timertask.md","raw":"---\nlayout: post\ntitle:  HandlerTimerTask\ncategory: accumulation\ntags:\n  - TimerTask\n  - handler\nkeywords: handler, TimerTask\nbanner: http://obxk8w81b.bkt.clouddn.com/Blossoming%20Almond%20Branch%20in%20a%20Glass%20with%20a%20Book.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Blossoming%20Almond%20Branch%20in%20a%20Glass%20with%20a%20Book.jpg\ntoc: true\n---\n\n### HandlerTimerTask\nhttp://www.mopri.de/2010/timertask-bad-do-it-the-android-way-use-a-handler/\n\nTimerTaskGUIdebug\nhandler\n\nhandler100msRunnable:\n~~~ Java\nprivate Handler handler = new Handler();\nhandler.postDelayed(runnable, 100);\n~~~\n\n100msRunnableTimerTaskscheduleAtFixedRate():\n\n<!--more-->\n~~~ Java\nprivate Runnable runnable = new Runnable() {\n   @Override\n   public void run() {\n      /* do what you need to do */\n      foobar();\n      /* and here comes the \"trick\" */\n      handler.postDelayed(this, 100);\n   }\n};\n~~~\nRunnablehandler.removeCallback(runnable)\n\nnew Timer(Task)handlerrunnable\n","slug":"handler-replace-timertask","published":1,"date":"2017-05-17T16:00:00.000Z","updated":"2017-11-23T07:15:28.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ec0x003ed6yksf73tcd7","content":"<h3 id=\"HandlerTimerTask\"><a href=\"#HandlerTimerTask\" class=\"headerlink\" title=\"HandlerTimerTask\"></a>HandlerTimerTask</h3><p><a href=\"http://www.mopri.de/2010/timertask-bad-do-it-the-android-way-use-a-handler/\" target=\"_blank\" rel=\"external\">http://www.mopri.de/2010/timertask-bad-do-it-the-android-way-use-a-handler/</a></p>\n<p>TimerTaskGUIdebug<br>handler</p>\n<p>handler100msRunnable:<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">private</span> Handler handler = <span class=\"keyword\">new</span> Handler();</div><div class=\"line\">handler.postDelayed(runnable, <span class=\"number\">100</span>);</div></pre></td></tr></table></figure></p>\n<p>100msRunnableTimerTaskscheduleAtFixedRate():</p>\n<a id=\"more\"></a>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">private</span> Runnable runnable = <span class=\"keyword\">new</span> Runnable() &#123;</div><div class=\"line\">   <span class=\"meta\">@Override</span></div><div class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">      <span class=\"comment\">/* do what you need to do */</span></div><div class=\"line\">      foobar();</div><div class=\"line\">      <span class=\"comment\">/* and here comes the \"trick\" */</span></div><div class=\"line\">      handler.postDelayed(<span class=\"keyword\">this</span>, <span class=\"number\">100</span>);</div><div class=\"line\">   &#125;</div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure>\n<p>Runnablehandler.removeCallback(runnable)</p>\n<p>new Timer(Task)handlerrunnable</p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/05/18/handler-replace-timertask/\">http://agehua.github.io/2017/05/18/handler-replace-timertask/</a></p>\n","readingTime":{"text":"1 min read","minutes":0.49,"time":29400,"words":98},"excerpt":"<h3 id=\"HandlerTimerTask\"><a href=\"#HandlerTimerTask\" class=\"headerlink\" title=\"HandlerTimerTask\"></a>HandlerTimerTask</h3><p><a href=\"http://www.mopri.de/2010/timertask-bad-do-it-the-android-way-use-a-handler/\">http://www.mopri.de/2010/timertask-bad-do-it-the-android-way-use-a-handler/</a></p>\n<p>TimerTaskGUIdebug<br>handler</p>\n<p>handler100msRunnable:<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">private</span> Handler handler = <span class=\"keyword\">new</span> Handler();</div><div class=\"line\">handler.postDelayed(runnable, <span class=\"number\">100</span>);</div></pre></td></tr></table></figure></p>\n<p>100msRunnableTimerTaskscheduleAtFixedRate():</p>","more":"<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">private</span> Runnable runnable = <span class=\"keyword\">new</span> Runnable() &#123;</div><div class=\"line\">   <span class=\"meta\">@Override</span></div><div class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">      <span class=\"comment\">/* do what you need to do */</span></div><div class=\"line\">      foobar();</div><div class=\"line\">      <span class=\"comment\">/* and here comes the \"trick\" */</span></div><div class=\"line\">      handler.postDelayed(<span class=\"keyword\">this</span>, <span class=\"number\">100</span>);</div><div class=\"line\">   &#125;</div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure>\n<p>Runnablehandler.removeCallback(runnable)</p>\n<p>new Timer(Task)handlerrunnable</p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/05/18/handler-replace-timertask/\">http://agehua.github.io/2017/05/18/handler-replace-timertask/</a></p>"},{"layout":"post","title":"Android Binder","keywords":"AIDL, Binder","banner":"http://obxk8w81b.bkt.clouddn.com/Blossoming%20Almond%20Tree.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Blossoming%20Almond%20Tree.jpg","toc":true,"_content":"\n### \nAndroidHook\n\n630360RePluginhttps://www.itcodemonkey.com/article/278.html\n\nAndroidVirtualAPKhttps://www.itcodemonkey.com/article/277.html\n\nActivity\n\n[\nAndroid-Binder](http://www.wjdiankong.cn/android%E7%B3%BB%E7%BB%9F%E7%AF%87%E4%B9%8B-binder%E6%9C%BA%E5%88%B6%E5%92%8C%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8%E6%9C%BA%E5%88%B6%E5%88%86%E6%9E%90/)Hook\n\n\n### Android\n\n<!--more-->\n#### 1.AIDLDemo.aidl\n> AIDL\n\n~~~ Java\npackage com.agehua.aidldemo;\ninterface Demo {\n    int sendData(String data);\n    String getData();\n}\n~~~\n\n\n#### 2.\nonBindAIDLBinder\n~~~ Java\n//\npublic class DemoService extends Service {\n\n    @Override\n    public IBinder onBind(Intent intent) {\n       //Binder\n       return new Demo.Stub() {\n          @Override\n          public int sendData(String data) throws RemoteException {\n            return 0;\n          }\n\n          @Override\n          public String getData() throws RemoteException {\n            return \"\";\n          }\n       }\n    }\n}\n~~~\n\n> \n\n#### 3.\nServiceConnectionBinderonBindBinderAIDL\n\n~~~ Java\n//\npublic class DemoConnection implements ServiceConnection {\n\n    @Override\n    public void onServiceConnected(Component name, IBinder service) {\n      //Binder\n      Demo demo  =Demo.Stub.asInterface(service);\n      try {\n        demo.setData(\" \");\n        demo.getData();\n      }catch (RemoteException e) {\n        e.printStackTrace();\n      }\n    }\n    @Override\n    public void onServiceDisconnected(Component name) {\n      //\n    }\n}\n~~~\n> Binder\n\n#### 4\n\n\n~~~ Java\nIntent intent = new Intent(this, DemoService.class);\nbindService(intent, new DemoConnection(), Context.BIND_AUTO_CREATE);\n~~~\n\n### AIDL\n**Demo.Stub**\n\n> AIDLbuild/generated/source/java\n\n~~~ Java\npackage com.agehua.aidldemo;\n//IInterfaceAIDLIInterfaceasBinder()\npublic interface Demo extends android.os.IInterface {\n    /**\n     * Local-side IPC implementation stub class.\n     * StubBinderAIDL\n     */\n    public static abstract class Stub extends android.os.Binder implements com.agehua.aidldemo.Demo {\n        private static final java.lang.String DESCRIPTOR = \"com.agehua.aidldemo.Demo\";\n\n        public Stub() {\n            this.attachInterface(this, DESCRIPTOR);\n        }\n\n        /**\n         * Cast an IBinder object into an com.agehua.aidldemo.Demo interface,\n         * generating a proxy if needed.\n         * Binder\n         */\n        public static com.agehua.aidldemo.Demo asInterface(android.os.IBinder obj) {\n            if ((obj == null)) {\n                return null;\n            }\n            //IInterface\n            android.os.IInterface iin = obj.queryLocalInterface(DESCRIPTOR);\n            if (((iin != null) && (iin instanceof com.agehua.aidldemo.Demo))) {\n                return ((com.agehua.aidldemo.Demo) iin);\n            }\n            //\n            return new com.agehua.aidldemo.Demo.Stub.Proxy(obj);\n        }\n\n        @Override\n        public android.os.IBinder asBinder() {\n            return this;\n        }\n\n        //\n        @Override\n        public boolean onTransact(int code, android.os.Parcel data, android.os.Parcel reply, int flags) throws android.os.RemoteException {\n            switch (code) {\n                case INTERFACE_TRANSACTION: {\n                    reply.writeString(DESCRIPTOR);\n                    return true;\n                }\n                case TRANSACTION_sendData: {\n                    data.enforceInterface(DESCRIPTOR);\n                    java.lang.String _arg0;\n                    _arg0 = data.readString();\n                    int _result = this.sendData(_arg0);\n                    reply.writeNoException();\n                    reply.writeInt(_result);\n                    return true;\n                }\n                case TRANSACTION_getData: {\n                    data.enforceInterface(DESCRIPTOR);\n                    java.lang.String _result = this.getData();\n                    reply.writeNoException();\n                    reply.writeString(_result);\n                    return true;\n                }\n            }\n            return super.onTransact(code, data, reply, flags);\n        }\n\n        //\n        private static class Proxy implements android.app.IServiceConnection {\n          /**\n          ...\n          **/\n        }\n\n    }\n\n    //Demo.aidlProxy\n    public int sendData(java.lang.String data) throws android.os.RemoteException;\n    //Demo.aidlProxy\n    public java.lang.String getData() throws android.os.RemoteException;\n}\n~~~\n#### 1AIDLIInterface\n\nIInterfaceasBinder()AIDLIBinder\n~~~ Java\npackage android.os;\n\npublic interface IInterface\n{\n    /**\n     * Retrieve the Binder object associated with this interface.\n     * You must use this instead of a plain cast, so that proxy objects\n     * can return the correct result.\n     */\n    public IBinder asBinder();\n}\n~~~\n#### 2AIDLStub\n\nBinderAIDLBinder\n\n- 1.BinderAIDLasInterfaceasBinder\n\n- 2.onTransact\n\n- 3.queryLocalInterface()AIDL(IInterface)\n\n- 4.BinderattachInterface\n\n#### 3StubProxy\n> Proxy\n\nDemoConnectionDemoDemo.Stub.asInterface(IBinder)\nasInterface()Demo.Stub.Proxy(IBinder)\n\nDemo.aidlProxy\n\nStubBinder\n\n~~~ Java\n//aidl\nprivate static class Proxy implements com.agehua.aidldemo.Demo {\n      //mRemoteIBinder\n      private android.os.IBinder mRemote;\n\n      Proxy(android.os.IBinder remote) {\n          mRemote = remote;\n      }\n\n      @Override\n      public android.os.IBinder asBinder() {\n          return mRemote;\n      }\n\n      public java.lang.String getInterfaceDescriptor() {\n          return DESCRIPTOR;\n      }\n\n      @Override\n      public int sendData(java.lang.String data) throws android.os.RemoteException {\n          android.os.Parcel _data = android.os.Parcel.obtain();\n          android.os.Parcel _reply = android.os.Parcel.obtain();\n          int _result;\n          try {\n              _data.writeInterfaceToken(DESCRIPTOR);\n              _data.writeString(data);\n              //Bindertransact()StubonTransact\n              mRemote.transact(Stub.TRANSACTION_sendData, _data, _reply, 0);\n              _reply.readException();\n              _result = _reply.readInt();\n          } finally {\n              _reply.recycle();\n              _data.recycle();\n          }\n          return _result;\n      }\n\n      @Override\n      public java.lang.String getData() throws android.os.RemoteException {\n          android.os.Parcel _data = android.os.Parcel.obtain();\n          android.os.Parcel _reply = android.os.Parcel.obtain();\n          java.lang.String _result;\n          try {\n              _data.writeInterfaceToken(DESCRIPTOR);\n              //Bindertransact()StubonTransact\n              mRemote.transact(Stub.TRANSACTION_getData, _data, _reply, 0);\n              _reply.readException();\n              _result = _reply.readString();\n          } finally {\n              _reply.recycle();\n              _data.recycle();\n          }\n          return _result;\n      }\n}\n~~~\n> ProxyStubProxyBinder\n\nonServiceConnected()BinderasInterface()\n~~~ Java\nDemo demo = Demo.Stub.asInterface(IBinder);\n~~~\ndemo**StubasInterface()**\n\n**queryLocalInterface()**Binder\n~~~ Java\npublic IInterface queryLocalInterface(String descriptor) {\n    if (mDescriptor.equals(descriptor)) {\n        return mOwner;\n    }\n    return null;\n}\n~~~\n\nmOwnermDescriptorattachInterfaceStub\n~~~ Java\npublic void attachInterface(IInterface owner, String descriptor) {\n       mOwner = owner;\n       mDescriptor = descriptor;\n}\n~~~\n\n\nqueryLocalInterfaceStubqueryLocalInterfacenull**new Demo.Stub()****Demo.Stub.asInterface(IBinder)**********mOwnerProxy\n\nBinderBinderBinderStubProxy\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-principle.png)\n\n\n### \nPackageManagerIPackageManagerPackageManagerService\n\nPackageManagerServiceAndroidPackagePackageManagerAndroidManifest.XML\n\n![PackageManagerService](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/PackageManagerService.png)\n\n~~~Java\ninterface IPackageManager {\n  boolean isPackageAvailable(String packageName, int userId);\n  PackageInfo getPackageInfo(String packageName, int flags, int userId);\n  int getPackageUid(String packageName, int userId);\n  int[] getPackageGids(String packageName);\n\n  String[] currentToCanonicalPackageNames(String[] names);\n  String[] canonicalToCurrentPackageNames(String[] names);\n\n  PermissionInfo getPermissionInfo(String name, int flags)\n\n  ParceledListSlice<PermissionInfo> queryPermissionsByGroup(String group,\n            int flags)\n\n  //...\n}\n~~~\n[](https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/content/pm/IPackageManager.aidl)\n\nIPackageManager.javaAIDL\n~~~ Java\npublic interface IPackageManager extends android.os.IInterface {\n    //StubBinderIPackageManager\n    public static abstract class Stub extends android.os.Binder implements android.content.pm.IPackageManager {\n\n        private static final java.lang.String DESCRIPTOR = \"android.content.pm.IPackageManager\";\n        publicStub() {\n             this.attachInterface(this,DESCRIPTOR);\n        }\n\n        //......\n\n        //StubProxyIPackageManager\n        private static class Proxy implements android.content.pm.IPackageManager{\n        //mRemote\n        private android.os.IBinder mRemote;\n\n           Proxy(android.os.IBinderremote) {\n              mRemote = remote;\n           }\n           //......\n        }\n        //......\n}\n~~~\n> StubProxy\n\nPackageManagerService.java(IDE)\n~~~ Java\npublic class PackageManagerService extends IPackageManager.Stub {\n    static final String TAG = \"PackageManager\";\n    static final boolean DEBUG_SETTINGS = false;\n    static final boolean DEBUG_PREFERRED = false;\n    static final boolean DEBUG_UPGRADE = false;\n    static final boolean DEBUG_DOMAIN_VERIFICATION = false;\n    //...\n}\n~~~\n> Stub\n\nPackageManager\n~~~ Java\nPackageManager pm = getPackageManager();\n~~~\ngetPackageManagerContextImpl.java\n\n~~~ Java\n@Override\npublic PackageManager getPackageManager() {\n    if (mPackageManager != null) {\n        return mPackageManager;\n    }\n\n    IPackageManager pm = ActivityThread.getPackageManager();\n    if (pm != null) {\n        // Doesn't matter if we make more than one instance.\n        return (mPackageManager = new ApplicationPackageManager(this, pm));\n    }\n\n    return null;\n}\n~~~\nActivityThread.getPackageManager()\n~~~ Java\npublic static IPackageManager getPackageManager() {\n    if (sPackageManager != null) {\n        //Slog.v(\"PackageManager\", \"returning cur default = \" + sPackageManager);\n        return sPackageManager;\n    }\n    IBinder b = ServiceManager.getService(\"package\");\n    //Slog.v(\"PackageManager\", \"default service binder = \" + b);\n    sPackageManager = IPackageManager.Stub.asInterface(b);\n    //Slog.v(\"PackageManager\", \"default service = \" + sPackageManager);\n    return sPackageManager;\n}\n~~~\n\nIPackageManager.Stub.asInterface(b)b**ServiceManager.getService**StubasInterfacePackageManagerProxyPackageManagerPackageManagerService\n\nDemoServiceDemoConnectionServiceConnectiononServiceConnectedIBinderProxy\n\n> ServiceManager\n\nPackageManager\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-system-service.png)\n\n\n\n- 1getService(String serviceName)\n- 2getSystemServiceContextImplServiceManagergetService\n- 3ServiceManagergetServiceIBinder\n- 4IBinderStubasInterface\n- 5system_serverasInterfaceProxy\n- 6ProxymRemoteIBindermRemotetransact\n\nServiceManagerIBinder[](http://agehua.github.io/2017/07/10/android-binder-principle2/)\n\n\n\n\n\n[Android-Binder](http://www.wjdiankong.cn/android%E7%B3%BB%E7%BB%9F%E7%AF%87%E4%B9%8B-binder%E6%9C%BA%E5%88%B6%E5%92%8C%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8%E6%9C%BA%E5%88%B6%E5%88%86%E6%9E%90/)\n\nAndroidHook: http://blog.csdn.net/yzzst/article/details/47318751\n\nAndroid<>:\nhttp://blog.csdn.net/l173864930/article/details/38455951\n\nAndroid\nhttp://wiki.jikexueyuan.com/project/deep-android-v2/powermanagerservice.html\n","source":"_posts/2017-07-08-android-binder-principle.md","raw":"---\nlayout: post\ntitle:  Android Binder\ncategory: accumulation\ntags:\n  - AIDL\n  - Binder\nkeywords: AIDL, Binder\nbanner: http://obxk8w81b.bkt.clouddn.com/Blossoming%20Almond%20Tree.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Blossoming%20Almond%20Tree.jpg\ntoc: true\n---\n\n### \nAndroidHook\n\n630360RePluginhttps://www.itcodemonkey.com/article/278.html\n\nAndroidVirtualAPKhttps://www.itcodemonkey.com/article/277.html\n\nActivity\n\n[\nAndroid-Binder](http://www.wjdiankong.cn/android%E7%B3%BB%E7%BB%9F%E7%AF%87%E4%B9%8B-binder%E6%9C%BA%E5%88%B6%E5%92%8C%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8%E6%9C%BA%E5%88%B6%E5%88%86%E6%9E%90/)Hook\n\n\n### Android\n\n<!--more-->\n#### 1.AIDLDemo.aidl\n> AIDL\n\n~~~ Java\npackage com.agehua.aidldemo;\ninterface Demo {\n    int sendData(String data);\n    String getData();\n}\n~~~\n\n\n#### 2.\nonBindAIDLBinder\n~~~ Java\n//\npublic class DemoService extends Service {\n\n    @Override\n    public IBinder onBind(Intent intent) {\n       //Binder\n       return new Demo.Stub() {\n          @Override\n          public int sendData(String data) throws RemoteException {\n            return 0;\n          }\n\n          @Override\n          public String getData() throws RemoteException {\n            return \"\";\n          }\n       }\n    }\n}\n~~~\n\n> \n\n#### 3.\nServiceConnectionBinderonBindBinderAIDL\n\n~~~ Java\n//\npublic class DemoConnection implements ServiceConnection {\n\n    @Override\n    public void onServiceConnected(Component name, IBinder service) {\n      //Binder\n      Demo demo  =Demo.Stub.asInterface(service);\n      try {\n        demo.setData(\" \");\n        demo.getData();\n      }catch (RemoteException e) {\n        e.printStackTrace();\n      }\n    }\n    @Override\n    public void onServiceDisconnected(Component name) {\n      //\n    }\n}\n~~~\n> Binder\n\n#### 4\n\n\n~~~ Java\nIntent intent = new Intent(this, DemoService.class);\nbindService(intent, new DemoConnection(), Context.BIND_AUTO_CREATE);\n~~~\n\n### AIDL\n**Demo.Stub**\n\n> AIDLbuild/generated/source/java\n\n~~~ Java\npackage com.agehua.aidldemo;\n//IInterfaceAIDLIInterfaceasBinder()\npublic interface Demo extends android.os.IInterface {\n    /**\n     * Local-side IPC implementation stub class.\n     * StubBinderAIDL\n     */\n    public static abstract class Stub extends android.os.Binder implements com.agehua.aidldemo.Demo {\n        private static final java.lang.String DESCRIPTOR = \"com.agehua.aidldemo.Demo\";\n\n        public Stub() {\n            this.attachInterface(this, DESCRIPTOR);\n        }\n\n        /**\n         * Cast an IBinder object into an com.agehua.aidldemo.Demo interface,\n         * generating a proxy if needed.\n         * Binder\n         */\n        public static com.agehua.aidldemo.Demo asInterface(android.os.IBinder obj) {\n            if ((obj == null)) {\n                return null;\n            }\n            //IInterface\n            android.os.IInterface iin = obj.queryLocalInterface(DESCRIPTOR);\n            if (((iin != null) && (iin instanceof com.agehua.aidldemo.Demo))) {\n                return ((com.agehua.aidldemo.Demo) iin);\n            }\n            //\n            return new com.agehua.aidldemo.Demo.Stub.Proxy(obj);\n        }\n\n        @Override\n        public android.os.IBinder asBinder() {\n            return this;\n        }\n\n        //\n        @Override\n        public boolean onTransact(int code, android.os.Parcel data, android.os.Parcel reply, int flags) throws android.os.RemoteException {\n            switch (code) {\n                case INTERFACE_TRANSACTION: {\n                    reply.writeString(DESCRIPTOR);\n                    return true;\n                }\n                case TRANSACTION_sendData: {\n                    data.enforceInterface(DESCRIPTOR);\n                    java.lang.String _arg0;\n                    _arg0 = data.readString();\n                    int _result = this.sendData(_arg0);\n                    reply.writeNoException();\n                    reply.writeInt(_result);\n                    return true;\n                }\n                case TRANSACTION_getData: {\n                    data.enforceInterface(DESCRIPTOR);\n                    java.lang.String _result = this.getData();\n                    reply.writeNoException();\n                    reply.writeString(_result);\n                    return true;\n                }\n            }\n            return super.onTransact(code, data, reply, flags);\n        }\n\n        //\n        private static class Proxy implements android.app.IServiceConnection {\n          /**\n          ...\n          **/\n        }\n\n    }\n\n    //Demo.aidlProxy\n    public int sendData(java.lang.String data) throws android.os.RemoteException;\n    //Demo.aidlProxy\n    public java.lang.String getData() throws android.os.RemoteException;\n}\n~~~\n#### 1AIDLIInterface\n\nIInterfaceasBinder()AIDLIBinder\n~~~ Java\npackage android.os;\n\npublic interface IInterface\n{\n    /**\n     * Retrieve the Binder object associated with this interface.\n     * You must use this instead of a plain cast, so that proxy objects\n     * can return the correct result.\n     */\n    public IBinder asBinder();\n}\n~~~\n#### 2AIDLStub\n\nBinderAIDLBinder\n\n- 1.BinderAIDLasInterfaceasBinder\n\n- 2.onTransact\n\n- 3.queryLocalInterface()AIDL(IInterface)\n\n- 4.BinderattachInterface\n\n#### 3StubProxy\n> Proxy\n\nDemoConnectionDemoDemo.Stub.asInterface(IBinder)\nasInterface()Demo.Stub.Proxy(IBinder)\n\nDemo.aidlProxy\n\nStubBinder\n\n~~~ Java\n//aidl\nprivate static class Proxy implements com.agehua.aidldemo.Demo {\n      //mRemoteIBinder\n      private android.os.IBinder mRemote;\n\n      Proxy(android.os.IBinder remote) {\n          mRemote = remote;\n      }\n\n      @Override\n      public android.os.IBinder asBinder() {\n          return mRemote;\n      }\n\n      public java.lang.String getInterfaceDescriptor() {\n          return DESCRIPTOR;\n      }\n\n      @Override\n      public int sendData(java.lang.String data) throws android.os.RemoteException {\n          android.os.Parcel _data = android.os.Parcel.obtain();\n          android.os.Parcel _reply = android.os.Parcel.obtain();\n          int _result;\n          try {\n              _data.writeInterfaceToken(DESCRIPTOR);\n              _data.writeString(data);\n              //Bindertransact()StubonTransact\n              mRemote.transact(Stub.TRANSACTION_sendData, _data, _reply, 0);\n              _reply.readException();\n              _result = _reply.readInt();\n          } finally {\n              _reply.recycle();\n              _data.recycle();\n          }\n          return _result;\n      }\n\n      @Override\n      public java.lang.String getData() throws android.os.RemoteException {\n          android.os.Parcel _data = android.os.Parcel.obtain();\n          android.os.Parcel _reply = android.os.Parcel.obtain();\n          java.lang.String _result;\n          try {\n              _data.writeInterfaceToken(DESCRIPTOR);\n              //Bindertransact()StubonTransact\n              mRemote.transact(Stub.TRANSACTION_getData, _data, _reply, 0);\n              _reply.readException();\n              _result = _reply.readString();\n          } finally {\n              _reply.recycle();\n              _data.recycle();\n          }\n          return _result;\n      }\n}\n~~~\n> ProxyStubProxyBinder\n\nonServiceConnected()BinderasInterface()\n~~~ Java\nDemo demo = Demo.Stub.asInterface(IBinder);\n~~~\ndemo**StubasInterface()**\n\n**queryLocalInterface()**Binder\n~~~ Java\npublic IInterface queryLocalInterface(String descriptor) {\n    if (mDescriptor.equals(descriptor)) {\n        return mOwner;\n    }\n    return null;\n}\n~~~\n\nmOwnermDescriptorattachInterfaceStub\n~~~ Java\npublic void attachInterface(IInterface owner, String descriptor) {\n       mOwner = owner;\n       mDescriptor = descriptor;\n}\n~~~\n\n\nqueryLocalInterfaceStubqueryLocalInterfacenull**new Demo.Stub()****Demo.Stub.asInterface(IBinder)**********mOwnerProxy\n\nBinderBinderBinderStubProxy\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-principle.png)\n\n\n### \nPackageManagerIPackageManagerPackageManagerService\n\nPackageManagerServiceAndroidPackagePackageManagerAndroidManifest.XML\n\n![PackageManagerService](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/PackageManagerService.png)\n\n~~~Java\ninterface IPackageManager {\n  boolean isPackageAvailable(String packageName, int userId);\n  PackageInfo getPackageInfo(String packageName, int flags, int userId);\n  int getPackageUid(String packageName, int userId);\n  int[] getPackageGids(String packageName);\n\n  String[] currentToCanonicalPackageNames(String[] names);\n  String[] canonicalToCurrentPackageNames(String[] names);\n\n  PermissionInfo getPermissionInfo(String name, int flags)\n\n  ParceledListSlice<PermissionInfo> queryPermissionsByGroup(String group,\n            int flags)\n\n  //...\n}\n~~~\n[](https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/content/pm/IPackageManager.aidl)\n\nIPackageManager.javaAIDL\n~~~ Java\npublic interface IPackageManager extends android.os.IInterface {\n    //StubBinderIPackageManager\n    public static abstract class Stub extends android.os.Binder implements android.content.pm.IPackageManager {\n\n        private static final java.lang.String DESCRIPTOR = \"android.content.pm.IPackageManager\";\n        publicStub() {\n             this.attachInterface(this,DESCRIPTOR);\n        }\n\n        //......\n\n        //StubProxyIPackageManager\n        private static class Proxy implements android.content.pm.IPackageManager{\n        //mRemote\n        private android.os.IBinder mRemote;\n\n           Proxy(android.os.IBinderremote) {\n              mRemote = remote;\n           }\n           //......\n        }\n        //......\n}\n~~~\n> StubProxy\n\nPackageManagerService.java(IDE)\n~~~ Java\npublic class PackageManagerService extends IPackageManager.Stub {\n    static final String TAG = \"PackageManager\";\n    static final boolean DEBUG_SETTINGS = false;\n    static final boolean DEBUG_PREFERRED = false;\n    static final boolean DEBUG_UPGRADE = false;\n    static final boolean DEBUG_DOMAIN_VERIFICATION = false;\n    //...\n}\n~~~\n> Stub\n\nPackageManager\n~~~ Java\nPackageManager pm = getPackageManager();\n~~~\ngetPackageManagerContextImpl.java\n\n~~~ Java\n@Override\npublic PackageManager getPackageManager() {\n    if (mPackageManager != null) {\n        return mPackageManager;\n    }\n\n    IPackageManager pm = ActivityThread.getPackageManager();\n    if (pm != null) {\n        // Doesn't matter if we make more than one instance.\n        return (mPackageManager = new ApplicationPackageManager(this, pm));\n    }\n\n    return null;\n}\n~~~\nActivityThread.getPackageManager()\n~~~ Java\npublic static IPackageManager getPackageManager() {\n    if (sPackageManager != null) {\n        //Slog.v(\"PackageManager\", \"returning cur default = \" + sPackageManager);\n        return sPackageManager;\n    }\n    IBinder b = ServiceManager.getService(\"package\");\n    //Slog.v(\"PackageManager\", \"default service binder = \" + b);\n    sPackageManager = IPackageManager.Stub.asInterface(b);\n    //Slog.v(\"PackageManager\", \"default service = \" + sPackageManager);\n    return sPackageManager;\n}\n~~~\n\nIPackageManager.Stub.asInterface(b)b**ServiceManager.getService**StubasInterfacePackageManagerProxyPackageManagerPackageManagerService\n\nDemoServiceDemoConnectionServiceConnectiononServiceConnectedIBinderProxy\n\n> ServiceManager\n\nPackageManager\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-system-service.png)\n\n\n\n- 1getService(String serviceName)\n- 2getSystemServiceContextImplServiceManagergetService\n- 3ServiceManagergetServiceIBinder\n- 4IBinderStubasInterface\n- 5system_serverasInterfaceProxy\n- 6ProxymRemoteIBindermRemotetransact\n\nServiceManagerIBinder[](http://agehua.github.io/2017/07/10/android-binder-principle2/)\n\n\n\n\n\n[Android-Binder](http://www.wjdiankong.cn/android%E7%B3%BB%E7%BB%9F%E7%AF%87%E4%B9%8B-binder%E6%9C%BA%E5%88%B6%E5%92%8C%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8%E6%9C%BA%E5%88%B6%E5%88%86%E6%9E%90/)\n\nAndroidHook: http://blog.csdn.net/yzzst/article/details/47318751\n\nAndroid<>:\nhttp://blog.csdn.net/l173864930/article/details/38455951\n\nAndroid\nhttp://wiki.jikexueyuan.com/project/deep-android-v2/powermanagerservice.html\n","slug":"android-binder-principle","published":1,"date":"2017-07-07T16:00:00.000Z","updated":"2017-11-23T07:15:37.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ec11003hd6yk3tz2q2a5","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>AndroidHook</p>\n<p>630360RePlugin<a href=\"https://www.itcodemonkey.com/article/278.html\" target=\"_blank\" rel=\"external\">https://www.itcodemonkey.com/article/278.html</a></p>\n<p>AndroidVirtualAPK<a href=\"https://www.itcodemonkey.com/article/277.html\" target=\"_blank\" rel=\"external\">https://www.itcodemonkey.com/article/277.html</a></p>\n<p>Activity</p>\n<p><a href=\"http://www.wjdiankong.cn/android%E7%B3%BB%E7%BB%9F%E7%AF%87%E4%B9%8B-binder%E6%9C%BA%E5%88%B6%E5%92%8C%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8%E6%9C%BA%E5%88%B6%E5%88%86%E6%9E%90/\" target=\"_blank\" rel=\"external\"><br>Android-Binder</a>Hook</p>\n<h3 id=\"Android\"><a href=\"#Android\" class=\"headerlink\" title=\"Android\"></a>Android</h3><p><br><a id=\"more\"></a></p>\n<h4 id=\"1-AIDLDemo-aidl\"><a href=\"#1-AIDLDemo-aidl\" class=\"headerlink\" title=\"1.AIDLDemo.aidl\"></a>1.AIDLDemo.aidl</h4><blockquote>\n<p>AIDL</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">package</span> com.agehua.aidldemo;</div><div class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Demo</span> </span>&#123;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">sendData</span><span class=\"params\">(String data)</span></span>;</div><div class=\"line\">    <span class=\"function\">String <span class=\"title\">getData</span><span class=\"params\">()</span></span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h4 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h4><p>onBindAIDLBinder<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DemoService</span> <span class=\"keyword\">extends</span> <span class=\"title\">Service</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> IBinder <span class=\"title\">onBind</span><span class=\"params\">(Intent intent)</span> </span>&#123;</div><div class=\"line\">       <span class=\"comment\">//Binder</span></div><div class=\"line\">       <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Demo.Stub() &#123;</div><div class=\"line\">          <span class=\"meta\">@Override</span></div><div class=\"line\">          <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">sendData</span><span class=\"params\">(String data)</span> <span class=\"keyword\">throws</span> RemoteException </span>&#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</div><div class=\"line\">          &#125;</div><div class=\"line\"></div><div class=\"line\">          <span class=\"meta\">@Override</span></div><div class=\"line\">          <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getData</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> RemoteException </span>&#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">\"\"</span>;</div><div class=\"line\">          &#125;</div><div class=\"line\">       &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p></p>\n</blockquote>\n<h4 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h4><p>ServiceConnectionBinderonBindBinderAIDL</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DemoConnection</span> <span class=\"keyword\">implements</span> <span class=\"title\">ServiceConnection</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onServiceConnected</span><span class=\"params\">(Component name, IBinder service)</span> </span>&#123;</div><div class=\"line\">      <span class=\"comment\">//Binder</span></div><div class=\"line\">      Demo demo  =Demo.Stub.asInterface(service);</div><div class=\"line\">      <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">        demo.setData(<span class=\"string\">\" \"</span>);</div><div class=\"line\">        demo.getData();</div><div class=\"line\">      &#125;<span class=\"keyword\">catch</span> (RemoteException e) &#123;</div><div class=\"line\">        e.printStackTrace();</div><div class=\"line\">      &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onServiceDisconnected</span><span class=\"params\">(Component name)</span> </span>&#123;</div><div class=\"line\">      <span class=\"comment\">//</span></div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<blockquote>\n<p>Binder</p>\n</blockquote>\n<h4 id=\"4\"><a href=\"#4\" class=\"headerlink\" title=\"4\"></a>4</h4><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Intent intent = <span class=\"keyword\">new</span> Intent(<span class=\"keyword\">this</span>, DemoService.class);</div><div class=\"line\">bindService(intent, <span class=\"keyword\">new</span> DemoConnection(), Context.BIND_AUTO_CREATE);</div></pre></td></tr></table></figure>\n<h3 id=\"AIDL\"><a href=\"#AIDL\" class=\"headerlink\" title=\"AIDL\"></a>AIDL</h3><p><strong>Demo.Stub</strong></p>\n<blockquote>\n<p>AIDLbuild/generated/source/java</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">package</span> com.agehua.aidldemo;</div><div class=\"line\"><span class=\"comment\">//IInterfaceAIDLIInterfaceasBinder()</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Demo</span> <span class=\"keyword\">extends</span> <span class=\"title\">android</span>.<span class=\"title\">os</span>.<span class=\"title\">IInterface</span> </span>&#123;</div><div class=\"line\">    <span class=\"comment\">/**</span></div><div class=\"line\">     * Local-side IPC implementation stub class.</div><div class=\"line\">     * StubBinderAIDL</div><div class=\"line\">     */</div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Stub</span> <span class=\"keyword\">extends</span> <span class=\"title\">android</span>.<span class=\"title\">os</span>.<span class=\"title\">Binder</span> <span class=\"keyword\">implements</span> <span class=\"title\">com</span>.<span class=\"title\">agehua</span>.<span class=\"title\">aidldemo</span>.<span class=\"title\">Demo</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> java.lang.String DESCRIPTOR = <span class=\"string\">\"com.agehua.aidldemo.Demo\"</span>;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Stub</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">            <span class=\"keyword\">this</span>.attachInterface(<span class=\"keyword\">this</span>, DESCRIPTOR);</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"comment\">/**</span></div><div class=\"line\">         * Cast an IBinder object into an com.agehua.aidldemo.Demo interface,</div><div class=\"line\">         * generating a proxy if needed.</div><div class=\"line\">         * Binder</div><div class=\"line\">         */</div><div class=\"line\">        <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> com.agehua.aidldemo.<span class=\"function\">Demo <span class=\"title\">asInterface</span><span class=\"params\">(android.os.IBinder obj)</span> </span>&#123;</div><div class=\"line\">            <span class=\"keyword\">if</span> ((obj == <span class=\"keyword\">null</span>)) &#123;</div><div class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">            &#125;</div><div class=\"line\">            <span class=\"comment\">//IInterface</span></div><div class=\"line\">            android.os.IInterface iin = obj.queryLocalInterface(DESCRIPTOR);</div><div class=\"line\">            <span class=\"keyword\">if</span> (((iin != <span class=\"keyword\">null</span>) &amp;&amp; (iin <span class=\"keyword\">instanceof</span> com.agehua.aidldemo.Demo))) &#123;</div><div class=\"line\">                <span class=\"keyword\">return</span> ((com.agehua.aidldemo.Demo) iin);</div><div class=\"line\">            &#125;</div><div class=\"line\">            <span class=\"comment\">//</span></div><div class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> com.agehua.aidldemo.Demo.Stub.Proxy(obj);</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"meta\">@Override</span></div><div class=\"line\">        <span class=\"keyword\">public</span> android.os.<span class=\"function\">IBinder <span class=\"title\">asBinder</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"comment\">//</span></div><div class=\"line\">        <span class=\"meta\">@Override</span></div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">onTransact</span><span class=\"params\">(<span class=\"keyword\">int</span> code, android.os.Parcel data, android.os.Parcel reply, <span class=\"keyword\">int</span> flags)</span> <span class=\"keyword\">throws</span> android.os.RemoteException </span>&#123;</div><div class=\"line\">            <span class=\"keyword\">switch</span> (code) &#123;</div><div class=\"line\">                <span class=\"keyword\">case</span> INTERFACE_TRANSACTION: &#123;</div><div class=\"line\">                    reply.writeString(DESCRIPTOR);</div><div class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</div><div class=\"line\">                &#125;</div><div class=\"line\">                <span class=\"keyword\">case</span> TRANSACTION_sendData: &#123;</div><div class=\"line\">                    data.enforceInterface(DESCRIPTOR);</div><div class=\"line\">                    java.lang.String _arg0;</div><div class=\"line\">                    _arg0 = data.readString();</div><div class=\"line\">                    <span class=\"keyword\">int</span> _result = <span class=\"keyword\">this</span>.sendData(_arg0);</div><div class=\"line\">                    reply.writeNoException();</div><div class=\"line\">                    reply.writeInt(_result);</div><div class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</div><div class=\"line\">                &#125;</div><div class=\"line\">                <span class=\"keyword\">case</span> TRANSACTION_getData: &#123;</div><div class=\"line\">                    data.enforceInterface(DESCRIPTOR);</div><div class=\"line\">                    java.lang.String _result = <span class=\"keyword\">this</span>.getData();</div><div class=\"line\">                    reply.writeNoException();</div><div class=\"line\">                    reply.writeString(_result);</div><div class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">super</span>.onTransact(code, data, reply, flags);</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"comment\">//</span></div><div class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Proxy</span> <span class=\"keyword\">implements</span> <span class=\"title\">android</span>.<span class=\"title\">app</span>.<span class=\"title\">IServiceConnection</span> </span>&#123;</div><div class=\"line\">          <span class=\"comment\">/**</span></div><div class=\"line\">          ...</div><div class=\"line\">          **/</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//Demo.aidlProxy</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">sendData</span><span class=\"params\">(java.lang.String data)</span> <span class=\"keyword\">throws</span> android.os.RemoteException</span>;</div><div class=\"line\">    <span class=\"comment\">//Demo.aidlProxy</span></div><div class=\"line\">    <span class=\"keyword\">public</span> java.lang.<span class=\"function\">String <span class=\"title\">getData</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> android.os.RemoteException</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h4 id=\"1AIDLIInterface\"><a href=\"#1AIDLIInterface\" class=\"headerlink\" title=\"1AIDLIInterface\"></a>1AIDLIInterface</h4><p>IInterfaceasBinder()AIDLIBinder<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">package</span> android.os;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">IInterface</span></span></div><div class=\"line\">&#123;</div><div class=\"line\">    <span class=\"comment\">/**</span></div><div class=\"line\">     * Retrieve the Binder object associated with this interface.</div><div class=\"line\">     * You must use this instead of a plain cast, so that proxy objects</div><div class=\"line\">     * can return the correct result.</div><div class=\"line\">     */</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> IBinder <span class=\"title\">asBinder</span><span class=\"params\">()</span></span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<h4 id=\"2AIDLStub\"><a href=\"#2AIDLStub\" class=\"headerlink\" title=\"2AIDLStub\"></a>2AIDLStub</h4><p>BinderAIDLBinder</p>\n<ul>\n<li><p>1.BinderAIDLasInterfaceasBinder</p>\n</li>\n<li><p>2.onTransact</p>\n</li>\n<li><p>3.queryLocalInterface()AIDL(IInterface)</p>\n</li>\n<li><p>4.BinderattachInterface</p>\n</li>\n</ul>\n<h4 id=\"3StubProxy\"><a href=\"#3StubProxy\" class=\"headerlink\" title=\"3StubProxy\"></a>3StubProxy</h4><blockquote>\n<p>Proxy</p>\n</blockquote>\n<p>DemoConnectionDemoDemo.Stub.asInterface(IBinder)<br>asInterface()Demo.Stub.Proxy(IBinder)</p>\n<p>Demo.aidlProxy</p>\n<p>StubBinder</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//aidl</span></div><div class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Proxy</span> <span class=\"keyword\">implements</span> <span class=\"title\">com</span>.<span class=\"title\">agehua</span>.<span class=\"title\">aidldemo</span>.<span class=\"title\">Demo</span> </span>&#123;</div><div class=\"line\">      <span class=\"comment\">//mRemoteIBinder</span></div><div class=\"line\">      <span class=\"keyword\">private</span> android.os.IBinder mRemote;</div><div class=\"line\"></div><div class=\"line\">      Proxy(android.os.IBinder remote) &#123;</div><div class=\"line\">          mRemote = remote;</div><div class=\"line\">      &#125;</div><div class=\"line\"></div><div class=\"line\">      <span class=\"meta\">@Override</span></div><div class=\"line\">      <span class=\"keyword\">public</span> android.os.<span class=\"function\">IBinder <span class=\"title\">asBinder</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">          <span class=\"keyword\">return</span> mRemote;</div><div class=\"line\">      &#125;</div><div class=\"line\"></div><div class=\"line\">      <span class=\"keyword\">public</span> java.lang.<span class=\"function\">String <span class=\"title\">getInterfaceDescriptor</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">          <span class=\"keyword\">return</span> DESCRIPTOR;</div><div class=\"line\">      &#125;</div><div class=\"line\"></div><div class=\"line\">      <span class=\"meta\">@Override</span></div><div class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">sendData</span><span class=\"params\">(java.lang.String data)</span> <span class=\"keyword\">throws</span> android.os.RemoteException </span>&#123;</div><div class=\"line\">          android.os.Parcel _data = android.os.Parcel.obtain();</div><div class=\"line\">          android.os.Parcel _reply = android.os.Parcel.obtain();</div><div class=\"line\">          <span class=\"keyword\">int</span> _result;</div><div class=\"line\">          <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">              _data.writeInterfaceToken(DESCRIPTOR);</div><div class=\"line\">              _data.writeString(data);</div><div class=\"line\">              <span class=\"comment\">//Bindertransact()StubonTransact</span></div><div class=\"line\">              mRemote.transact(Stub.TRANSACTION_sendData, _data, _reply, <span class=\"number\">0</span>);</div><div class=\"line\">              _reply.readException();</div><div class=\"line\">              _result = _reply.readInt();</div><div class=\"line\">          &#125; <span class=\"keyword\">finally</span> &#123;</div><div class=\"line\">              _reply.recycle();</div><div class=\"line\">              _data.recycle();</div><div class=\"line\">          &#125;</div><div class=\"line\">          <span class=\"keyword\">return</span> _result;</div><div class=\"line\">      &#125;</div><div class=\"line\"></div><div class=\"line\">      <span class=\"meta\">@Override</span></div><div class=\"line\">      <span class=\"keyword\">public</span> java.lang.<span class=\"function\">String <span class=\"title\">getData</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> android.os.RemoteException </span>&#123;</div><div class=\"line\">          android.os.Parcel _data = android.os.Parcel.obtain();</div><div class=\"line\">          android.os.Parcel _reply = android.os.Parcel.obtain();</div><div class=\"line\">          java.lang.String _result;</div><div class=\"line\">          <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">              _data.writeInterfaceToken(DESCRIPTOR);</div><div class=\"line\">              <span class=\"comment\">//Bindertransact()StubonTransact</span></div><div class=\"line\">              mRemote.transact(Stub.TRANSACTION_getData, _data, _reply, <span class=\"number\">0</span>);</div><div class=\"line\">              _reply.readException();</div><div class=\"line\">              _result = _reply.readString();</div><div class=\"line\">          &#125; <span class=\"keyword\">finally</span> &#123;</div><div class=\"line\">              _reply.recycle();</div><div class=\"line\">              _data.recycle();</div><div class=\"line\">          &#125;</div><div class=\"line\">          <span class=\"keyword\">return</span> _result;</div><div class=\"line\">      &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<blockquote>\n<p>ProxyStubProxyBinder</p>\n</blockquote>\n<p>onServiceConnected()BinderasInterface()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Demo demo = Demo.Stub.asInterface(IBinder);</div></pre></td></tr></table></figure></p>\n<p>demo<strong>StubasInterface()</strong></p>\n<p><strong>queryLocalInterface()</strong>Binder<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> IInterface <span class=\"title\">queryLocalInterface</span><span class=\"params\">(String descriptor)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (mDescriptor.equals(descriptor)) &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> mOwner;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>mOwnermDescriptorattachInterfaceStub<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">attachInterface</span><span class=\"params\">(IInterface owner, String descriptor)</span> </span>&#123;</div><div class=\"line\">       mOwner = owner;</div><div class=\"line\">       mDescriptor = descriptor;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>queryLocalInterfaceStubqueryLocalInterfacenull<strong>new Demo.Stub()</strong><strong>Demo.Stub.asInterface(IBinder)</strong><strong></strong><strong></strong>mOwnerProxy</p>\n<p>BinderBinderBinderStubProxy<br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-principle.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>PackageManagerIPackageManagerPackageManagerService</p>\n<p>PackageManagerServiceAndroidPackagePackageManagerAndroidManifest.XML</p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/PackageManagerService.png\" alt=\"PackageManagerService\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">IPackageManager</span> </span>&#123;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">boolean</span> <span class=\"title\">isPackageAvailable</span><span class=\"params\">(String packageName, <span class=\"keyword\">int</span> userId)</span></span>;</div><div class=\"line\">  <span class=\"function\">PackageInfo <span class=\"title\">getPackageInfo</span><span class=\"params\">(String packageName, <span class=\"keyword\">int</span> flags, <span class=\"keyword\">int</span> userId)</span></span>;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">getPackageUid</span><span class=\"params\">(String packageName, <span class=\"keyword\">int</span> userId)</span></span>;</div><div class=\"line\">  <span class=\"keyword\">int</span>[] getPackageGids(String packageName);</div><div class=\"line\"></div><div class=\"line\">  String[] currentToCanonicalPackageNames(String[] names);</div><div class=\"line\">  String[] canonicalToCurrentPackageNames(String[] names);</div><div class=\"line\"></div><div class=\"line\">  <span class=\"function\">PermissionInfo <span class=\"title\">getPermissionInfo</span><span class=\"params\">(String name, <span class=\"keyword\">int</span> flags)</span></span></div><div class=\"line\"></div><div class=\"line\">  ParceledListSlice&lt;PermissionInfo&gt; <span class=\"title\">queryPermissionsByGroup</span><span class=\"params\">(String group,</span></div><div class=\"line\">            <span class=\"keyword\">int</span> flags)</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\">//...</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p><a href=\"https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/content/pm/IPackageManager.aidl\" target=\"_blank\" rel=\"external\"></a></p>\n<p>IPackageManager.javaAIDL<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">IPackageManager</span> <span class=\"keyword\">extends</span> <span class=\"title\">android</span>.<span class=\"title\">os</span>.<span class=\"title\">IInterface</span> </span>&#123;</div><div class=\"line\">    <span class=\"comment\">//StubBinderIPackageManager</span></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Stub</span> <span class=\"keyword\">extends</span> <span class=\"title\">android</span>.<span class=\"title\">os</span>.<span class=\"title\">Binder</span> <span class=\"keyword\">implements</span> <span class=\"title\">android</span>.<span class=\"title\">content</span>.<span class=\"title\">pm</span>.<span class=\"title\">IPackageManager</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> java.lang.String DESCRIPTOR = <span class=\"string\">\"android.content.pm.IPackageManager\"</span>;</div><div class=\"line\">        publicStub() &#123;</div><div class=\"line\">             <span class=\"keyword\">this</span>.attachInterface(<span class=\"keyword\">this</span>,DESCRIPTOR);</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"comment\">//......</span></div><div class=\"line\"></div><div class=\"line\">        <span class=\"comment\">//StubProxyIPackageManager</span></div><div class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Proxy</span> <span class=\"keyword\">implements</span> <span class=\"title\">android</span>.<span class=\"title\">content</span>.<span class=\"title\">pm</span>.<span class=\"title\">IPackageManager</span></span>&#123;</div><div class=\"line\">        <span class=\"comment\">//mRemote</span></div><div class=\"line\">        <span class=\"keyword\">private</span> android.os.IBinder mRemote;</div><div class=\"line\"></div><div class=\"line\">           Proxy(android.os.IBinderremote) &#123;</div><div class=\"line\">              mRemote = remote;</div><div class=\"line\">           &#125;</div><div class=\"line\">           <span class=\"comment\">//......</span></div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"comment\">//......</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>StubProxy</p>\n</blockquote>\n<p>PackageManagerService.java(IDE)<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">PackageManagerService</span> <span class=\"keyword\">extends</span> <span class=\"title\">IPackageManager</span>.<span class=\"title\">Stub</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String TAG = <span class=\"string\">\"PackageManager\"</span>;</div><div class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">boolean</span> DEBUG_SETTINGS = <span class=\"keyword\">false</span>;</div><div class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">boolean</span> DEBUG_PREFERRED = <span class=\"keyword\">false</span>;</div><div class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">boolean</span> DEBUG_UPGRADE = <span class=\"keyword\">false</span>;</div><div class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">boolean</span> DEBUG_DOMAIN_VERIFICATION = <span class=\"keyword\">false</span>;</div><div class=\"line\">    <span class=\"comment\">//...</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>Stub</p>\n</blockquote>\n<p>PackageManager<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">PackageManager pm = getPackageManager();</div></pre></td></tr></table></figure></p>\n<p>getPackageManagerContextImpl.java</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> PackageManager <span class=\"title\">getPackageManager</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (mPackageManager != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> mPackageManager;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    IPackageManager pm = ActivityThread.getPackageManager();</div><div class=\"line\">    <span class=\"keyword\">if</span> (pm != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">        <span class=\"comment\">// Doesn't matter if we make more than one instance.</span></div><div class=\"line\">        <span class=\"keyword\">return</span> (mPackageManager = <span class=\"keyword\">new</span> ApplicationPackageManager(<span class=\"keyword\">this</span>, pm));</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>ActivityThread.getPackageManager()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> IPackageManager <span class=\"title\">getPackageManager</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (sPackageManager != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">        <span class=\"comment\">//Slog.v(\"PackageManager\", \"returning cur default = \" + sPackageManager);</span></div><div class=\"line\">        <span class=\"keyword\">return</span> sPackageManager;</div><div class=\"line\">    &#125;</div><div class=\"line\">    IBinder b = ServiceManager.getService(<span class=\"string\">\"package\"</span>);</div><div class=\"line\">    <span class=\"comment\">//Slog.v(\"PackageManager\", \"default service binder = \" + b);</span></div><div class=\"line\">    sPackageManager = IPackageManager.Stub.asInterface(b);</div><div class=\"line\">    <span class=\"comment\">//Slog.v(\"PackageManager\", \"default service = \" + sPackageManager);</span></div><div class=\"line\">    <span class=\"keyword\">return</span> sPackageManager;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>IPackageManager.Stub.asInterface(b)b<strong>ServiceManager.getService</strong>StubasInterfacePackageManagerProxyPackageManagerPackageManagerService</p>\n<p>DemoServiceDemoConnectionServiceConnectiononServiceConnectedIBinderProxy</p>\n<blockquote>\n<p>ServiceManager</p>\n</blockquote>\n<p>PackageManager</p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-system-service.png\" alt=\"\"></p>\n<p></p>\n<ul>\n<li>1getService(String serviceName)</li>\n<li>2getSystemServiceContextImplServiceManagergetService</li>\n<li>3ServiceManagergetServiceIBinder</li>\n<li>4IBinderStubasInterface</li>\n<li>5system_serverasInterfaceProxy</li>\n<li>6ProxymRemoteIBindermRemotetransact</li>\n</ul>\n<p>ServiceManagerIBinder<a href=\"http://agehua.github.io/2017/07/10/android-binder-principle2/\"></a></p>\n<p></p>\n<p><a href=\"http://www.wjdiankong.cn/android%E7%B3%BB%E7%BB%9F%E7%AF%87%E4%B9%8B-binder%E6%9C%BA%E5%88%B6%E5%92%8C%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8%E6%9C%BA%E5%88%B6%E5%88%86%E6%9E%90/\" target=\"_blank\" rel=\"external\">Android-Binder</a></p>\n<p>AndroidHook: <a href=\"http://blog.csdn.net/yzzst/article/details/47318751\" target=\"_blank\" rel=\"external\">http://blog.csdn.net/yzzst/article/details/47318751</a></p>\n<p>Android&lt;&gt;:<br><a href=\"http://blog.csdn.net/l173864930/article/details/38455951\" target=\"_blank\" rel=\"external\">http://blog.csdn.net/l173864930/article/details/38455951</a></p>\n<p>Android<br><a href=\"http://wiki.jikexueyuan.com/project/deep-android-v2/powermanagerservice.html\" target=\"_blank\" rel=\"external\">http://wiki.jikexueyuan.com/project/deep-android-v2/powermanagerservice.html</a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/07/08/android-binder-principle/\">http://agehua.github.io/2017/07/08/android-binder-principle/</a></p>\n","readingTime":{"text":"8 min read","minutes":7.56,"time":453599.99999999994,"words":1512},"excerpt":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>AndroidHook</p>\n<p>630360RePlugin<a href=\"https://www.itcodemonkey.com/article/278.html\">https://www.itcodemonkey.com/article/278.html</a></p>\n<p>AndroidVirtualAPK<a href=\"https://www.itcodemonkey.com/article/277.html\">https://www.itcodemonkey.com/article/277.html</a></p>\n<p>Activity</p>\n<p><a href=\"http://www.wjdiankong.cn/android%E7%B3%BB%E7%BB%9F%E7%AF%87%E4%B9%8B-binder%E6%9C%BA%E5%88%B6%E5%92%8C%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8%E6%9C%BA%E5%88%B6%E5%88%86%E6%9E%90/\"><br>Android-Binder</a>Hook</p>\n<h3 id=\"Android\"><a href=\"#Android\" class=\"headerlink\" title=\"Android\"></a>Android</h3><p><br>","more":"</p>\n<h4 id=\"1-AIDLDemo-aidl\"><a href=\"#1-AIDLDemo-aidl\" class=\"headerlink\" title=\"1.AIDLDemo.aidl\"></a>1.AIDLDemo.aidl</h4><blockquote>\n<p>AIDL</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">package</span> com.agehua.aidldemo;</div><div class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Demo</span> </span>&#123;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">sendData</span><span class=\"params\">(String data)</span></span>;</div><div class=\"line\">    <span class=\"function\">String <span class=\"title\">getData</span><span class=\"params\">()</span></span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h4 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h4><p>onBindAIDLBinder<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DemoService</span> <span class=\"keyword\">extends</span> <span class=\"title\">Service</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> IBinder <span class=\"title\">onBind</span><span class=\"params\">(Intent intent)</span> </span>&#123;</div><div class=\"line\">       <span class=\"comment\">//Binder</span></div><div class=\"line\">       <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Demo.Stub() &#123;</div><div class=\"line\">          <span class=\"meta\">@Override</span></div><div class=\"line\">          <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">sendData</span><span class=\"params\">(String data)</span> <span class=\"keyword\">throws</span> RemoteException </span>&#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</div><div class=\"line\">          &#125;</div><div class=\"line\"></div><div class=\"line\">          <span class=\"meta\">@Override</span></div><div class=\"line\">          <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getData</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> RemoteException </span>&#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">\"\"</span>;</div><div class=\"line\">          &#125;</div><div class=\"line\">       &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p></p>\n</blockquote>\n<h4 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h4><p>ServiceConnectionBinderonBindBinderAIDL</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DemoConnection</span> <span class=\"keyword\">implements</span> <span class=\"title\">ServiceConnection</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onServiceConnected</span><span class=\"params\">(Component name, IBinder service)</span> </span>&#123;</div><div class=\"line\">      <span class=\"comment\">//Binder</span></div><div class=\"line\">      Demo demo  =Demo.Stub.asInterface(service);</div><div class=\"line\">      <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">        demo.setData(<span class=\"string\">\" \"</span>);</div><div class=\"line\">        demo.getData();</div><div class=\"line\">      &#125;<span class=\"keyword\">catch</span> (RemoteException e) &#123;</div><div class=\"line\">        e.printStackTrace();</div><div class=\"line\">      &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onServiceDisconnected</span><span class=\"params\">(Component name)</span> </span>&#123;</div><div class=\"line\">      <span class=\"comment\">//</span></div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<blockquote>\n<p>Binder</p>\n</blockquote>\n<h4 id=\"4\"><a href=\"#4\" class=\"headerlink\" title=\"4\"></a>4</h4><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Intent intent = <span class=\"keyword\">new</span> Intent(<span class=\"keyword\">this</span>, DemoService.class);</div><div class=\"line\">bindService(intent, <span class=\"keyword\">new</span> DemoConnection(), Context.BIND_AUTO_CREATE);</div></pre></td></tr></table></figure>\n<h3 id=\"AIDL\"><a href=\"#AIDL\" class=\"headerlink\" title=\"AIDL\"></a>AIDL</h3><p><strong>Demo.Stub</strong></p>\n<blockquote>\n<p>AIDLbuild/generated/source/java</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">package</span> com.agehua.aidldemo;</div><div class=\"line\"><span class=\"comment\">//IInterfaceAIDLIInterfaceasBinder()</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Demo</span> <span class=\"keyword\">extends</span> <span class=\"title\">android</span>.<span class=\"title\">os</span>.<span class=\"title\">IInterface</span> </span>&#123;</div><div class=\"line\">    <span class=\"comment\">/**</div><div class=\"line\">     * Local-side IPC implementation stub class.</div><div class=\"line\">     * StubBinderAIDL</div><div class=\"line\">     */</span></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Stub</span> <span class=\"keyword\">extends</span> <span class=\"title\">android</span>.<span class=\"title\">os</span>.<span class=\"title\">Binder</span> <span class=\"keyword\">implements</span> <span class=\"title\">com</span>.<span class=\"title\">agehua</span>.<span class=\"title\">aidldemo</span>.<span class=\"title\">Demo</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> java.lang.String DESCRIPTOR = <span class=\"string\">\"com.agehua.aidldemo.Demo\"</span>;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Stub</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">            <span class=\"keyword\">this</span>.attachInterface(<span class=\"keyword\">this</span>, DESCRIPTOR);</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"comment\">/**</div><div class=\"line\">         * Cast an IBinder object into an com.agehua.aidldemo.Demo interface,</div><div class=\"line\">         * generating a proxy if needed.</div><div class=\"line\">         * Binder</div><div class=\"line\">         */</span></div><div class=\"line\">        <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> com.agehua.aidldemo.<span class=\"function\">Demo <span class=\"title\">asInterface</span><span class=\"params\">(android.os.IBinder obj)</span> </span>&#123;</div><div class=\"line\">            <span class=\"keyword\">if</span> ((obj == <span class=\"keyword\">null</span>)) &#123;</div><div class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">            &#125;</div><div class=\"line\">            <span class=\"comment\">//IInterface</span></div><div class=\"line\">            android.os.IInterface iin = obj.queryLocalInterface(DESCRIPTOR);</div><div class=\"line\">            <span class=\"keyword\">if</span> (((iin != <span class=\"keyword\">null</span>) &amp;&amp; (iin <span class=\"keyword\">instanceof</span> com.agehua.aidldemo.Demo))) &#123;</div><div class=\"line\">                <span class=\"keyword\">return</span> ((com.agehua.aidldemo.Demo) iin);</div><div class=\"line\">            &#125;</div><div class=\"line\">            <span class=\"comment\">//</span></div><div class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> com.agehua.aidldemo.Demo.Stub.Proxy(obj);</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"meta\">@Override</span></div><div class=\"line\">        <span class=\"keyword\">public</span> android.os.<span class=\"function\">IBinder <span class=\"title\">asBinder</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"comment\">//</span></div><div class=\"line\">        <span class=\"meta\">@Override</span></div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">onTransact</span><span class=\"params\">(<span class=\"keyword\">int</span> code, android.os.Parcel data, android.os.Parcel reply, <span class=\"keyword\">int</span> flags)</span> <span class=\"keyword\">throws</span> android.os.RemoteException </span>&#123;</div><div class=\"line\">            <span class=\"keyword\">switch</span> (code) &#123;</div><div class=\"line\">                <span class=\"keyword\">case</span> INTERFACE_TRANSACTION: &#123;</div><div class=\"line\">                    reply.writeString(DESCRIPTOR);</div><div class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</div><div class=\"line\">                &#125;</div><div class=\"line\">                <span class=\"keyword\">case</span> TRANSACTION_sendData: &#123;</div><div class=\"line\">                    data.enforceInterface(DESCRIPTOR);</div><div class=\"line\">                    java.lang.String _arg0;</div><div class=\"line\">                    _arg0 = data.readString();</div><div class=\"line\">                    <span class=\"keyword\">int</span> _result = <span class=\"keyword\">this</span>.sendData(_arg0);</div><div class=\"line\">                    reply.writeNoException();</div><div class=\"line\">                    reply.writeInt(_result);</div><div class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</div><div class=\"line\">                &#125;</div><div class=\"line\">                <span class=\"keyword\">case</span> TRANSACTION_getData: &#123;</div><div class=\"line\">                    data.enforceInterface(DESCRIPTOR);</div><div class=\"line\">                    java.lang.String _result = <span class=\"keyword\">this</span>.getData();</div><div class=\"line\">                    reply.writeNoException();</div><div class=\"line\">                    reply.writeString(_result);</div><div class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">super</span>.onTransact(code, data, reply, flags);</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"comment\">//</span></div><div class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Proxy</span> <span class=\"keyword\">implements</span> <span class=\"title\">android</span>.<span class=\"title\">app</span>.<span class=\"title\">IServiceConnection</span> </span>&#123;</div><div class=\"line\">          <span class=\"comment\">/**</div><div class=\"line\">          ...</div><div class=\"line\">          **/</span></div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//Demo.aidlProxy</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">sendData</span><span class=\"params\">(java.lang.String data)</span> <span class=\"keyword\">throws</span> android.os.RemoteException</span>;</div><div class=\"line\">    <span class=\"comment\">//Demo.aidlProxy</span></div><div class=\"line\">    <span class=\"keyword\">public</span> java.lang.<span class=\"function\">String <span class=\"title\">getData</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> android.os.RemoteException</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h4 id=\"1AIDLIInterface\"><a href=\"#1AIDLIInterface\" class=\"headerlink\" title=\"1AIDLIInterface\"></a>1AIDLIInterface</h4><p>IInterfaceasBinder()AIDLIBinder<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">package</span> android.os;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">IInterface</span></div><div class=\"line\"></span>&#123;</div><div class=\"line\">    <span class=\"comment\">/**</div><div class=\"line\">     * Retrieve the Binder object associated with this interface.</div><div class=\"line\">     * You must use this instead of a plain cast, so that proxy objects</div><div class=\"line\">     * can return the correct result.</div><div class=\"line\">     */</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> IBinder <span class=\"title\">asBinder</span><span class=\"params\">()</span></span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<h4 id=\"2AIDLStub\"><a href=\"#2AIDLStub\" class=\"headerlink\" title=\"2AIDLStub\"></a>2AIDLStub</h4><p>BinderAIDLBinder</p>\n<ul>\n<li><p>1.BinderAIDLasInterfaceasBinder</p>\n</li>\n<li><p>2.onTransact</p>\n</li>\n<li><p>3.queryLocalInterface()AIDL(IInterface)</p>\n</li>\n<li><p>4.BinderattachInterface</p>\n</li>\n</ul>\n<h4 id=\"3StubProxy\"><a href=\"#3StubProxy\" class=\"headerlink\" title=\"3StubProxy\"></a>3StubProxy</h4><blockquote>\n<p>Proxy</p>\n</blockquote>\n<p>DemoConnectionDemoDemo.Stub.asInterface(IBinder)<br>asInterface()Demo.Stub.Proxy(IBinder)</p>\n<p>Demo.aidlProxy</p>\n<p>StubBinder</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//aidl</span></div><div class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Proxy</span> <span class=\"keyword\">implements</span> <span class=\"title\">com</span>.<span class=\"title\">agehua</span>.<span class=\"title\">aidldemo</span>.<span class=\"title\">Demo</span> </span>&#123;</div><div class=\"line\">      <span class=\"comment\">//mRemoteIBinder</span></div><div class=\"line\">      <span class=\"keyword\">private</span> android.os.IBinder mRemote;</div><div class=\"line\"></div><div class=\"line\">      Proxy(android.os.IBinder remote) &#123;</div><div class=\"line\">          mRemote = remote;</div><div class=\"line\">      &#125;</div><div class=\"line\"></div><div class=\"line\">      <span class=\"meta\">@Override</span></div><div class=\"line\">      <span class=\"keyword\">public</span> android.os.<span class=\"function\">IBinder <span class=\"title\">asBinder</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">          <span class=\"keyword\">return</span> mRemote;</div><div class=\"line\">      &#125;</div><div class=\"line\"></div><div class=\"line\">      <span class=\"keyword\">public</span> java.lang.<span class=\"function\">String <span class=\"title\">getInterfaceDescriptor</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">          <span class=\"keyword\">return</span> DESCRIPTOR;</div><div class=\"line\">      &#125;</div><div class=\"line\"></div><div class=\"line\">      <span class=\"meta\">@Override</span></div><div class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">sendData</span><span class=\"params\">(java.lang.String data)</span> <span class=\"keyword\">throws</span> android.os.RemoteException </span>&#123;</div><div class=\"line\">          android.os.Parcel _data = android.os.Parcel.obtain();</div><div class=\"line\">          android.os.Parcel _reply = android.os.Parcel.obtain();</div><div class=\"line\">          <span class=\"keyword\">int</span> _result;</div><div class=\"line\">          <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">              _data.writeInterfaceToken(DESCRIPTOR);</div><div class=\"line\">              _data.writeString(data);</div><div class=\"line\">              <span class=\"comment\">//Bindertransact()StubonTransact</span></div><div class=\"line\">              mRemote.transact(Stub.TRANSACTION_sendData, _data, _reply, <span class=\"number\">0</span>);</div><div class=\"line\">              _reply.readException();</div><div class=\"line\">              _result = _reply.readInt();</div><div class=\"line\">          &#125; <span class=\"keyword\">finally</span> &#123;</div><div class=\"line\">              _reply.recycle();</div><div class=\"line\">              _data.recycle();</div><div class=\"line\">          &#125;</div><div class=\"line\">          <span class=\"keyword\">return</span> _result;</div><div class=\"line\">      &#125;</div><div class=\"line\"></div><div class=\"line\">      <span class=\"meta\">@Override</span></div><div class=\"line\">      <span class=\"keyword\">public</span> java.lang.<span class=\"function\">String <span class=\"title\">getData</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> android.os.RemoteException </span>&#123;</div><div class=\"line\">          android.os.Parcel _data = android.os.Parcel.obtain();</div><div class=\"line\">          android.os.Parcel _reply = android.os.Parcel.obtain();</div><div class=\"line\">          java.lang.String _result;</div><div class=\"line\">          <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">              _data.writeInterfaceToken(DESCRIPTOR);</div><div class=\"line\">              <span class=\"comment\">//Bindertransact()StubonTransact</span></div><div class=\"line\">              mRemote.transact(Stub.TRANSACTION_getData, _data, _reply, <span class=\"number\">0</span>);</div><div class=\"line\">              _reply.readException();</div><div class=\"line\">              _result = _reply.readString();</div><div class=\"line\">          &#125; <span class=\"keyword\">finally</span> &#123;</div><div class=\"line\">              _reply.recycle();</div><div class=\"line\">              _data.recycle();</div><div class=\"line\">          &#125;</div><div class=\"line\">          <span class=\"keyword\">return</span> _result;</div><div class=\"line\">      &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<blockquote>\n<p>ProxyStubProxyBinder</p>\n</blockquote>\n<p>onServiceConnected()BinderasInterface()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Demo demo = Demo.Stub.asInterface(IBinder);</div></pre></td></tr></table></figure></p>\n<p>demo<strong>StubasInterface()</strong></p>\n<p><strong>queryLocalInterface()</strong>Binder<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> IInterface <span class=\"title\">queryLocalInterface</span><span class=\"params\">(String descriptor)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (mDescriptor.equals(descriptor)) &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> mOwner;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>mOwnermDescriptorattachInterfaceStub<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">attachInterface</span><span class=\"params\">(IInterface owner, String descriptor)</span> </span>&#123;</div><div class=\"line\">       mOwner = owner;</div><div class=\"line\">       mDescriptor = descriptor;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>queryLocalInterfaceStubqueryLocalInterfacenull<strong>new Demo.Stub()</strong><strong>Demo.Stub.asInterface(IBinder)</strong><strong></strong><strong></strong>mOwnerProxy</p>\n<p>BinderBinderBinderStubProxy<br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-principle.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>PackageManagerIPackageManagerPackageManagerService</p>\n<p>PackageManagerServiceAndroidPackagePackageManagerAndroidManifest.XML</p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/PackageManagerService.png\" alt=\"PackageManagerService\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">IPackageManager</span> </span>&#123;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">boolean</span> <span class=\"title\">isPackageAvailable</span><span class=\"params\">(String packageName, <span class=\"keyword\">int</span> userId)</span></span>;</div><div class=\"line\">  <span class=\"function\">PackageInfo <span class=\"title\">getPackageInfo</span><span class=\"params\">(String packageName, <span class=\"keyword\">int</span> flags, <span class=\"keyword\">int</span> userId)</span></span>;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">getPackageUid</span><span class=\"params\">(String packageName, <span class=\"keyword\">int</span> userId)</span></span>;</div><div class=\"line\">  <span class=\"keyword\">int</span>[] getPackageGids(String packageName);</div><div class=\"line\"></div><div class=\"line\">  String[] currentToCanonicalPackageNames(String[] names);</div><div class=\"line\">  String[] canonicalToCurrentPackageNames(String[] names);</div><div class=\"line\"></div><div class=\"line\">  <span class=\"function\">PermissionInfo <span class=\"title\">getPermissionInfo</span><span class=\"params\">(String name, <span class=\"keyword\">int</span> flags)</span></div><div class=\"line\"></div><div class=\"line\">  ParceledListSlice&lt;PermissionInfo&gt; <span class=\"title\">queryPermissionsByGroup</span><span class=\"params\">(String group,</div><div class=\"line\">            <span class=\"keyword\">int</span> flags)</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\">//...</span></div><div class=\"line\">&#125;</span></div></pre></td></tr></table></figure>\n<p><a href=\"https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/content/pm/IPackageManager.aidl\"></a></p>\n<p>IPackageManager.javaAIDL<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">IPackageManager</span> <span class=\"keyword\">extends</span> <span class=\"title\">android</span>.<span class=\"title\">os</span>.<span class=\"title\">IInterface</span> </span>&#123;</div><div class=\"line\">    <span class=\"comment\">//StubBinderIPackageManager</span></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Stub</span> <span class=\"keyword\">extends</span> <span class=\"title\">android</span>.<span class=\"title\">os</span>.<span class=\"title\">Binder</span> <span class=\"keyword\">implements</span> <span class=\"title\">android</span>.<span class=\"title\">content</span>.<span class=\"title\">pm</span>.<span class=\"title\">IPackageManager</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> java.lang.String DESCRIPTOR = <span class=\"string\">\"android.content.pm.IPackageManager\"</span>;</div><div class=\"line\">        publicStub() &#123;</div><div class=\"line\">             <span class=\"keyword\">this</span>.attachInterface(<span class=\"keyword\">this</span>,DESCRIPTOR);</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"comment\">//......</span></div><div class=\"line\"></div><div class=\"line\">        <span class=\"comment\">//StubProxyIPackageManager</span></div><div class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Proxy</span> <span class=\"keyword\">implements</span> <span class=\"title\">android</span>.<span class=\"title\">content</span>.<span class=\"title\">pm</span>.<span class=\"title\">IPackageManager</span></span>&#123;</div><div class=\"line\">        <span class=\"comment\">//mRemote</span></div><div class=\"line\">        <span class=\"keyword\">private</span> android.os.IBinder mRemote;</div><div class=\"line\"></div><div class=\"line\">           Proxy(android.os.IBinderremote) &#123;</div><div class=\"line\">              mRemote = remote;</div><div class=\"line\">           &#125;</div><div class=\"line\">           <span class=\"comment\">//......</span></div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"comment\">//......</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>StubProxy</p>\n</blockquote>\n<p>PackageManagerService.java(IDE)<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">PackageManagerService</span> <span class=\"keyword\">extends</span> <span class=\"title\">IPackageManager</span>.<span class=\"title\">Stub</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String TAG = <span class=\"string\">\"PackageManager\"</span>;</div><div class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">boolean</span> DEBUG_SETTINGS = <span class=\"keyword\">false</span>;</div><div class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">boolean</span> DEBUG_PREFERRED = <span class=\"keyword\">false</span>;</div><div class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">boolean</span> DEBUG_UPGRADE = <span class=\"keyword\">false</span>;</div><div class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">boolean</span> DEBUG_DOMAIN_VERIFICATION = <span class=\"keyword\">false</span>;</div><div class=\"line\">    <span class=\"comment\">//...</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>Stub</p>\n</blockquote>\n<p>PackageManager<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">PackageManager pm = getPackageManager();</div></pre></td></tr></table></figure></p>\n<p>getPackageManagerContextImpl.java</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> PackageManager <span class=\"title\">getPackageManager</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (mPackageManager != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> mPackageManager;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    IPackageManager pm = ActivityThread.getPackageManager();</div><div class=\"line\">    <span class=\"keyword\">if</span> (pm != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">        <span class=\"comment\">// Doesn't matter if we make more than one instance.</span></div><div class=\"line\">        <span class=\"keyword\">return</span> (mPackageManager = <span class=\"keyword\">new</span> ApplicationPackageManager(<span class=\"keyword\">this</span>, pm));</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>ActivityThread.getPackageManager()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> IPackageManager <span class=\"title\">getPackageManager</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (sPackageManager != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">        <span class=\"comment\">//Slog.v(\"PackageManager\", \"returning cur default = \" + sPackageManager);</span></div><div class=\"line\">        <span class=\"keyword\">return</span> sPackageManager;</div><div class=\"line\">    &#125;</div><div class=\"line\">    IBinder b = ServiceManager.getService(<span class=\"string\">\"package\"</span>);</div><div class=\"line\">    <span class=\"comment\">//Slog.v(\"PackageManager\", \"default service binder = \" + b);</span></div><div class=\"line\">    sPackageManager = IPackageManager.Stub.asInterface(b);</div><div class=\"line\">    <span class=\"comment\">//Slog.v(\"PackageManager\", \"default service = \" + sPackageManager);</span></div><div class=\"line\">    <span class=\"keyword\">return</span> sPackageManager;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>IPackageManager.Stub.asInterface(b)b<strong>ServiceManager.getService</strong>StubasInterfacePackageManagerProxyPackageManagerPackageManagerService</p>\n<p>DemoServiceDemoConnectionServiceConnectiononServiceConnectedIBinderProxy</p>\n<blockquote>\n<p>ServiceManager</p>\n</blockquote>\n<p>PackageManager</p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-system-service.png\" alt=\"\"></p>\n<p></p>\n<ul>\n<li>1getService(String serviceName)</li>\n<li>2getSystemServiceContextImplServiceManagergetService</li>\n<li>3ServiceManagergetServiceIBinder</li>\n<li>4IBinderStubasInterface</li>\n<li>5system_serverasInterfaceProxy</li>\n<li>6ProxymRemoteIBindermRemotetransact</li>\n</ul>\n<p>ServiceManagerIBinder<a href=\"http://agehua.github.io/2017/07/10/android-binder-principle2/\"></a></p>\n<p></p>\n<p><a href=\"http://www.wjdiankong.cn/android%E7%B3%BB%E7%BB%9F%E7%AF%87%E4%B9%8B-binder%E6%9C%BA%E5%88%B6%E5%92%8C%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8%E6%9C%BA%E5%88%B6%E5%88%86%E6%9E%90/\">Android-Binder</a></p>\n<p>AndroidHook: <a href=\"http://blog.csdn.net/yzzst/article/details/47318751\">http://blog.csdn.net/yzzst/article/details/47318751</a></p>\n<p>Android&lt;&gt;:<br><a href=\"http://blog.csdn.net/l173864930/article/details/38455951\">http://blog.csdn.net/l173864930/article/details/38455951</a></p>\n<p>Android<br><a href=\"http://wiki.jikexueyuan.com/project/deep-android-v2/powermanagerservice.html\">http://wiki.jikexueyuan.com/project/deep-android-v2/powermanagerservice.html</a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/07/08/android-binder-principle/\">http://agehua.github.io/2017/07/08/android-binder-principle/</a></p>"},{"layout":"post","title":"MacAndroidAOSP","keywords":"aosp, sdk compile","banner":"http://obxk8w81b.bkt.clouddn.com/Child%20with%20Orange.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Child%20with%20Orange.jpg","toc":true,"_content":"\n\n### Android\n\nMac\n[AndroidSDK](http://blog.csdn.net/dd864140130/article/details/51718187)\n[](https://source.android.com/source/downloading)\n\nMac\n~~~ C++\nhdiutil resize -size 100g ~/android.dmg.sparseimage\n~~~\n7.1.1100G\n\n\n### Android Build\n<!--more-->\nAndroid BuildIBM[Android Build](https://www.ibm.com/developerworks/cn/opensource/os-cn-android-build/index.html)\n\n\nAndroid Build  Android Android SDK  Make Shell  Python  Make \n\n#### \n\n~~~ C++\nsource build/envsetup.sh\n~~~\nbuild/envsetup.sh Shell  lunch \n~~~ C++\nlunch\n~~~\nlunch\n~~~ C++\nYou're building on Darwin\n\nLunch menu... pick a combo:\n     1. aosp_arm-eng\n     2. aosp_arm64-eng\n     3. aosp_mips-eng\n     4. aosp_mips64-eng\n     5. aosp_x86-eng\n     6. aosp_x86_64-eng\n     7. full_fugu-userdebug\n     8. aosp_fugu-userdebug\n     9. mini_emulator_arm64-userdebug\n     10. m_e_arm-userdebug\n     11. m_e_mips-userdebug\n     12. m_e_mips64-eng\n     13. mini_emulator_x86-userdebug\n     14. mini_emulator_x86_64-userdebug\n     15. aosp_dragon-userdebug\n     16. aosp_dragon-eng\n     17. aosp_marlin-userdebug\n     18. aosp_sailfish-userdebug\n     19. aosp_flounder-userdebug\n     20. aosp_angler-userdebug\n     21. aosp_bullhead-userdebug\n     22. hikey-userdebug\n     23. aosp_shamu-userdebug\n\nWhich would you like? [aosp_arm-eng]\n~~~\nlunch\n> :\n  :BUILD-BUILDTYPE,aosp_arm-engBUILDaosp_arm,BUILDTYPEeng.\n\n\n[StackOverflow](https://stackoverflow.com/questions/27572817/aosp-build-with-fastest-emulator-boot)**aosp_x86-userdebug** with HAXM installed\n\nlunch\n\nlunchchoosecombo\n\n        envsetup.sh\n~~~ C++\nchoosecombo\nBuild type choices are:\n     1. release\n     2. debug\n\nWhich would you like? [1]\n//2\n\n\nWhich product would you like? [aosp_arm]\n//BUILDaosp_x86\n\nVariant choices are:\n     1. user\n     2. userdebug\n     3. eng\n//2\n~~~\nTerminal\nmake -j4\n> make -j Job  CPU  1  2  4  CPU  make -j8  make -j16\n\n\n\n~~~ C++\nsudo ncdu //\n~~~\n\nmakeBUILD\n~~~ C++\nmake clobber //out\n~~~\n\n### Android\n[Android](http://blog.csdn.net/dd864140130/article/details/51815253)\n\nAndroidAndroid Studio\n~~~ C++\nsource build/envsetup.sh\nmmm development/tools/idegen/\nsudo ./development/tools/idegen/idegen.sh\n~~~\nIEDA: android.ipr,android.imlandroid.iws.\nandroid.iprAndroid Studio\n\n> Android StudioIntelliJDebugAndroid[ IntelliJ  Android ](http://www.jianshu.com/p/1d1b8d0de1ed)\n\n\n#### Android\nAndroid/packages/experimentalGoogleAndroid BUILDapk\n\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/aosp_make_single_module.png)\n\nMultiPackageApk\n~~~ C++\nsource build/envsetup.sh\nmmm packages/experimental/MultiPackageApk    \nmake snod  \n~~~\n\n\n\n\n~~~ C++\nninja: error: 'out/target/common/obj/JAVA_LIBRARIES/core-junit_intermediates/classes.dex.toc', needed by 'out/target/common/obj/APPS/MultiPackageApk_intermediates/with-local/classes.dex', missing and no known rule to make it\nmake: *** [ninja_wrapper] Error 1\n~~~\nlunchchoosecombo**make snod**\n\n\n#### make failed to build some targets (4 seconds) ####\n\n####  IntelliJ Debug Android \n[ IntelliJ Debug Android ](http://www.jianshu.com/p/7c2ab3d9498c)\n\n\n####  monitor  debug \nmonitormonitor.app\n/Library/Android_sdk/tools/lib/monitor-x86_64/monitor.app\n\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/aosp_monitor_position.png)\n\nAndroidAndroid**Activity**\n","source":"_posts/2017-08-01-aosp-compile.md","raw":"---\nlayout: post\ntitle:  MacAndroidAOSP\ncategory: accumulation\ntags:\n  - AOSP\n  - sdk compile\nkeywords: aosp, sdk compile\nbanner: http://obxk8w81b.bkt.clouddn.com/Child%20with%20Orange.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Child%20with%20Orange.jpg\ntoc: true\n---\n\n\n### Android\n\nMac\n[AndroidSDK](http://blog.csdn.net/dd864140130/article/details/51718187)\n[](https://source.android.com/source/downloading)\n\nMac\n~~~ C++\nhdiutil resize -size 100g ~/android.dmg.sparseimage\n~~~\n7.1.1100G\n\n\n### Android Build\n<!--more-->\nAndroid BuildIBM[Android Build](https://www.ibm.com/developerworks/cn/opensource/os-cn-android-build/index.html)\n\n\nAndroid Build  Android Android SDK  Make Shell  Python  Make \n\n#### \n\n~~~ C++\nsource build/envsetup.sh\n~~~\nbuild/envsetup.sh Shell  lunch \n~~~ C++\nlunch\n~~~\nlunch\n~~~ C++\nYou're building on Darwin\n\nLunch menu... pick a combo:\n     1. aosp_arm-eng\n     2. aosp_arm64-eng\n     3. aosp_mips-eng\n     4. aosp_mips64-eng\n     5. aosp_x86-eng\n     6. aosp_x86_64-eng\n     7. full_fugu-userdebug\n     8. aosp_fugu-userdebug\n     9. mini_emulator_arm64-userdebug\n     10. m_e_arm-userdebug\n     11. m_e_mips-userdebug\n     12. m_e_mips64-eng\n     13. mini_emulator_x86-userdebug\n     14. mini_emulator_x86_64-userdebug\n     15. aosp_dragon-userdebug\n     16. aosp_dragon-eng\n     17. aosp_marlin-userdebug\n     18. aosp_sailfish-userdebug\n     19. aosp_flounder-userdebug\n     20. aosp_angler-userdebug\n     21. aosp_bullhead-userdebug\n     22. hikey-userdebug\n     23. aosp_shamu-userdebug\n\nWhich would you like? [aosp_arm-eng]\n~~~\nlunch\n> :\n  :BUILD-BUILDTYPE,aosp_arm-engBUILDaosp_arm,BUILDTYPEeng.\n\n\n[StackOverflow](https://stackoverflow.com/questions/27572817/aosp-build-with-fastest-emulator-boot)**aosp_x86-userdebug** with HAXM installed\n\nlunch\n\nlunchchoosecombo\n\n        envsetup.sh\n~~~ C++\nchoosecombo\nBuild type choices are:\n     1. release\n     2. debug\n\nWhich would you like? [1]\n//2\n\n\nWhich product would you like? [aosp_arm]\n//BUILDaosp_x86\n\nVariant choices are:\n     1. user\n     2. userdebug\n     3. eng\n//2\n~~~\nTerminal\nmake -j4\n> make -j Job  CPU  1  2  4  CPU  make -j8  make -j16\n\n\n\n~~~ C++\nsudo ncdu //\n~~~\n\nmakeBUILD\n~~~ C++\nmake clobber //out\n~~~\n\n### Android\n[Android](http://blog.csdn.net/dd864140130/article/details/51815253)\n\nAndroidAndroid Studio\n~~~ C++\nsource build/envsetup.sh\nmmm development/tools/idegen/\nsudo ./development/tools/idegen/idegen.sh\n~~~\nIEDA: android.ipr,android.imlandroid.iws.\nandroid.iprAndroid Studio\n\n> Android StudioIntelliJDebugAndroid[ IntelliJ  Android ](http://www.jianshu.com/p/1d1b8d0de1ed)\n\n\n#### Android\nAndroid/packages/experimentalGoogleAndroid BUILDapk\n\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/aosp_make_single_module.png)\n\nMultiPackageApk\n~~~ C++\nsource build/envsetup.sh\nmmm packages/experimental/MultiPackageApk    \nmake snod  \n~~~\n\n\n\n\n~~~ C++\nninja: error: 'out/target/common/obj/JAVA_LIBRARIES/core-junit_intermediates/classes.dex.toc', needed by 'out/target/common/obj/APPS/MultiPackageApk_intermediates/with-local/classes.dex', missing and no known rule to make it\nmake: *** [ninja_wrapper] Error 1\n~~~\nlunchchoosecombo**make snod**\n\n\n#### make failed to build some targets (4 seconds) ####\n\n####  IntelliJ Debug Android \n[ IntelliJ Debug Android ](http://www.jianshu.com/p/7c2ab3d9498c)\n\n\n####  monitor  debug \nmonitormonitor.app\n/Library/Android_sdk/tools/lib/monitor-x86_64/monitor.app\n\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/aosp_monitor_position.png)\n\nAndroidAndroid**Activity**\n","slug":"aosp-compile","published":1,"date":"2017-07-31T16:00:00.000Z","updated":"2017-12-05T06:21:19.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ec14003ld6ykrwk00nbd","content":"<h3 id=\"Android\"><a href=\"#Android\" class=\"headerlink\" title=\"Android\"></a>Android</h3><p>Mac<br><a href=\"http://blog.csdn.net/dd864140130/article/details/51718187\" target=\"_blank\" rel=\"external\">AndroidSDK</a><br><a href=\"https://source.android.com/source/downloading\" target=\"_blank\" rel=\"external\"></a></p>\n<p>Mac<br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">hdiutil resize -size <span class=\"number\">100</span>g ~/android.dmg.sparseimage</div></pre></td></tr></table></figure></p>\n<p>7.1.1100G</p>\n<h3 id=\"Android-Build\"><a href=\"#Android-Build\" class=\"headerlink\" title=\"Android Build\"></a>Android Build</h3><a id=\"more\"></a>\n<p>Android BuildIBM<a href=\"https://www.ibm.com/developerworks/cn/opensource/os-cn-android-build/index.html\" target=\"_blank\" rel=\"external\">Android Build</a></p>\n<p>Android Build  Android Android SDK  Make Shell  Python  Make </p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">source build/envsetup.sh</div></pre></td></tr></table></figure></p>\n<p>build/envsetup.sh Shell  lunch <br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">lunch</div></pre></td></tr></table></figure></p>\n<p>lunch<br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">You're building on Darwin</div><div class=\"line\"></div><div class=\"line\">Lunch menu... pick a combo:</div><div class=\"line\">     <span class=\"number\">1.</span> aosp_arm-eng</div><div class=\"line\">     <span class=\"number\">2.</span> aosp_arm64-eng</div><div class=\"line\">     <span class=\"number\">3.</span> aosp_mips-eng</div><div class=\"line\">     <span class=\"number\">4.</span> aosp_mips64-eng</div><div class=\"line\">     <span class=\"number\">5.</span> aosp_x86-eng</div><div class=\"line\">     <span class=\"number\">6.</span> aosp_x86_64-eng</div><div class=\"line\">     <span class=\"number\">7.</span> full_fugu-userdebug</div><div class=\"line\">     <span class=\"number\">8.</span> aosp_fugu-userdebug</div><div class=\"line\">     <span class=\"number\">9.</span> mini_emulator_arm64-userdebug</div><div class=\"line\">     <span class=\"number\">10.</span> m_e_arm-userdebug</div><div class=\"line\">     <span class=\"number\">11.</span> m_e_mips-userdebug</div><div class=\"line\">     <span class=\"number\">12.</span> m_e_mips64-eng</div><div class=\"line\">     <span class=\"number\">13.</span> mini_emulator_x86-userdebug</div><div class=\"line\">     <span class=\"number\">14.</span> mini_emulator_x86_64-userdebug</div><div class=\"line\">     <span class=\"number\">15.</span> aosp_dragon-userdebug</div><div class=\"line\">     <span class=\"number\">16.</span> aosp_dragon-eng</div><div class=\"line\">     <span class=\"number\">17.</span> aosp_marlin-userdebug</div><div class=\"line\">     <span class=\"number\">18.</span> aosp_sailfish-userdebug</div><div class=\"line\">     <span class=\"number\">19.</span> aosp_flounder-userdebug</div><div class=\"line\">     <span class=\"number\">20.</span> aosp_angler-userdebug</div><div class=\"line\">     <span class=\"number\">21.</span> aosp_bullhead-userdebug</div><div class=\"line\">     <span class=\"number\">22.</span> hikey-userdebug</div><div class=\"line\">     <span class=\"number\">23.</span> aosp_shamu-userdebug</div><div class=\"line\"></div><div class=\"line\">Which would you like? [aosp_arm-eng]</div></pre></td></tr></table></figure></p>\n<p>lunch</p>\n<blockquote>\n<p>:<br>  :BUILD-BUILDTYPE,aosp_arm-engBUILDaosp_arm,BUILDTYPEeng.</p>\n</blockquote>\n<p><br><a href=\"https://stackoverflow.com/questions/27572817/aosp-build-with-fastest-emulator-boot\" target=\"_blank\" rel=\"external\">StackOverflow</a><strong>aosp_x86-userdebug</strong> with HAXM installed</p>\n<p>lunch</p>\n<p>lunchchoosecombo</p>\n<pre><code>envsetup.sh\n</code></pre><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">choosecombo</div><div class=\"line\">Build type choices are:</div><div class=\"line\">     <span class=\"number\">1.</span> release</div><div class=\"line\">     <span class=\"number\">2.</span> debug</div><div class=\"line\"></div><div class=\"line\">Which would you like? [<span class=\"number\">1</span>]</div><div class=\"line\"><span class=\"comment\">//2</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Which product would you like? [aosp_arm]</div><div class=\"line\"><span class=\"comment\">//BUILDaosp_x86</span></div><div class=\"line\"></div><div class=\"line\">Variant choices are:</div><div class=\"line\">     <span class=\"number\">1.</span> user</div><div class=\"line\">     <span class=\"number\">2.</span> userdebug</div><div class=\"line\">     <span class=\"number\">3.</span> eng</div><div class=\"line\"><span class=\"comment\">//2</span></div></pre></td></tr></table></figure>\n<p>Terminal<br>make -j4</p>\n<blockquote>\n<p>make -j Job  CPU  1  2  4  CPU  make -j8  make -j16</p>\n</blockquote>\n<p><br><br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">sudo ncdu <span class=\"comment\">//</span></div></pre></td></tr></table></figure></p>\n<p>makeBUILD<br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">make clobber <span class=\"comment\">//out</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"Android\"><a href=\"#Android\" class=\"headerlink\" title=\"Android\"></a>Android</h3><p><a href=\"http://blog.csdn.net/dd864140130/article/details/51815253\" target=\"_blank\" rel=\"external\">Android</a></p>\n<p>AndroidAndroid Studio<br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">source build/envsetup.sh</div><div class=\"line\">mmm development/tools/idegen/</div><div class=\"line\">sudo ./development/tools/idegen/idegen.sh</div></pre></td></tr></table></figure></p>\n<p>IEDA: android.ipr,android.imlandroid.iws.<br>android.iprAndroid Studio</p>\n<blockquote>\n<p>Android StudioIntelliJDebugAndroid<a href=\"http://www.jianshu.com/p/1d1b8d0de1ed\" target=\"_blank\" rel=\"external\"> IntelliJ  Android </a></p>\n</blockquote>\n<h4 id=\"Android\"><a href=\"#Android\" class=\"headerlink\" title=\"Android\"></a>Android</h4><p>Android/packages/experimentalGoogleAndroid BUILDapk<br></p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/aosp_make_single_module.png\" alt=\"\"></p>\n<p>MultiPackageApk<br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">source build/envsetup.sh</div><div class=\"line\">mmm packages/experimental/MultiPackageApk    </div><div class=\"line\">make snod</div></pre></td></tr></table></figure></p>\n<p></p>\n<p></p>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><div class=\"line\">ninja: error: 'out/target/common/obj/JAVA_LIBRARIES/core-junit_intermediates/classes.dex.toc', needed by 'out/target/common/obj/APPS/MultiPackageApk_intermediates/with-local/classes.dex', missing and no known rule to make it</div><div class=\"line\">make: *** [ninja_wrapper] Error 1</div></pre></td></tr></table></figure>\n<p>lunchchoosecombo<strong>make snod</strong></p>\n<h4 id=\"make-failed-to-build-some-targets-4-seconds\"><a href=\"#make-failed-to-build-some-targets-4-seconds\" class=\"headerlink\" title=\"make failed to build some targets (4 seconds)\"></a>make failed to build some targets (4 seconds)</h4><h4 id=\"-IntelliJ-Debug-Android-\"><a href=\"#-IntelliJ-Debug-Android-\" class=\"headerlink\" title=\" IntelliJ Debug Android \"></a> IntelliJ Debug Android </h4><p><a href=\"http://www.jianshu.com/p/7c2ab3d9498c\" target=\"_blank\" rel=\"external\"> IntelliJ Debug Android </a></p>\n<p></p>\n<h4 id=\"-monitor--debug-\"><a href=\"#-monitor--debug-\" class=\"headerlink\" title=\" monitor  debug \"></a> monitor  debug </h4><p>monitormonitor.app<br>/Library/Android_sdk/tools/lib/monitor-x86_64/monitor.app<br></p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/aosp_monitor_position.png\" alt=\"\"></p>\n<p>AndroidAndroid<strong>Activity</strong></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/08/01/aosp-compile/\">http://agehua.github.io/2017/08/01/aosp-compile/</a></p>\n","readingTime":{"text":"2 min read","minutes":1.99,"time":119400,"words":398},"excerpt":"<h3 id=\"Android\"><a href=\"#Android\" class=\"headerlink\" title=\"Android\"></a>Android</h3><p>Mac<br><a href=\"http://blog.csdn.net/dd864140130/article/details/51718187\">AndroidSDK</a><br><a href=\"https://source.android.com/source/downloading\"></a></p>\n<p>Mac<br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">hdiutil resize -size <span class=\"number\">100</span>g ~/android.dmg.sparseimage</div></pre></td></tr></table></figure></p>\n<p>7.1.1100G</p>\n<h3 id=\"Android-Build\"><a href=\"#Android-Build\" class=\"headerlink\" title=\"Android Build\"></a>Android Build</h3>","more":"<p>Android BuildIBM<a href=\"https://www.ibm.com/developerworks/cn/opensource/os-cn-android-build/index.html\">Android Build</a></p>\n<p>Android Build  Android Android SDK  Make Shell  Python  Make </p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">source build/envsetup.sh</div></pre></td></tr></table></figure></p>\n<p>build/envsetup.sh Shell  lunch <br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">lunch</div></pre></td></tr></table></figure></p>\n<p>lunch<br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">You're building on Darwin</div><div class=\"line\"></div><div class=\"line\">Lunch menu... pick a combo:</div><div class=\"line\">     <span class=\"number\">1.</span> aosp_arm-eng</div><div class=\"line\">     <span class=\"number\">2.</span> aosp_arm64-eng</div><div class=\"line\">     <span class=\"number\">3.</span> aosp_mips-eng</div><div class=\"line\">     <span class=\"number\">4.</span> aosp_mips64-eng</div><div class=\"line\">     <span class=\"number\">5.</span> aosp_x86-eng</div><div class=\"line\">     <span class=\"number\">6.</span> aosp_x86_64-eng</div><div class=\"line\">     <span class=\"number\">7.</span> full_fugu-userdebug</div><div class=\"line\">     <span class=\"number\">8.</span> aosp_fugu-userdebug</div><div class=\"line\">     <span class=\"number\">9.</span> mini_emulator_arm64-userdebug</div><div class=\"line\">     <span class=\"number\">10.</span> m_e_arm-userdebug</div><div class=\"line\">     <span class=\"number\">11.</span> m_e_mips-userdebug</div><div class=\"line\">     <span class=\"number\">12.</span> m_e_mips64-eng</div><div class=\"line\">     <span class=\"number\">13.</span> mini_emulator_x86-userdebug</div><div class=\"line\">     <span class=\"number\">14.</span> mini_emulator_x86_64-userdebug</div><div class=\"line\">     <span class=\"number\">15.</span> aosp_dragon-userdebug</div><div class=\"line\">     <span class=\"number\">16.</span> aosp_dragon-eng</div><div class=\"line\">     <span class=\"number\">17.</span> aosp_marlin-userdebug</div><div class=\"line\">     <span class=\"number\">18.</span> aosp_sailfish-userdebug</div><div class=\"line\">     <span class=\"number\">19.</span> aosp_flounder-userdebug</div><div class=\"line\">     <span class=\"number\">20.</span> aosp_angler-userdebug</div><div class=\"line\">     <span class=\"number\">21.</span> aosp_bullhead-userdebug</div><div class=\"line\">     <span class=\"number\">22.</span> hikey-userdebug</div><div class=\"line\">     <span class=\"number\">23.</span> aosp_shamu-userdebug</div><div class=\"line\"></div><div class=\"line\">Which would you like? [aosp_arm-eng]</div></pre></td></tr></table></figure></p>\n<p>lunch</p>\n<blockquote>\n<p>:<br>  :BUILD-BUILDTYPE,aosp_arm-engBUILDaosp_arm,BUILDTYPEeng.</p>\n</blockquote>\n<p><br><a href=\"https://stackoverflow.com/questions/27572817/aosp-build-with-fastest-emulator-boot\">StackOverflow</a><strong>aosp_x86-userdebug</strong> with HAXM installed</p>\n<p>lunch</p>\n<p>lunchchoosecombo</p>\n<pre><code>envsetup.sh\n</code></pre><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">choosecombo</div><div class=\"line\">Build type choices are:</div><div class=\"line\">     <span class=\"number\">1.</span> release</div><div class=\"line\">     <span class=\"number\">2.</span> debug</div><div class=\"line\"></div><div class=\"line\">Which would you like? [<span class=\"number\">1</span>]</div><div class=\"line\"><span class=\"comment\">//2</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">Which product would you like? [aosp_arm]</div><div class=\"line\"><span class=\"comment\">//BUILDaosp_x86</span></div><div class=\"line\"></div><div class=\"line\">Variant choices are:</div><div class=\"line\">     <span class=\"number\">1.</span> user</div><div class=\"line\">     <span class=\"number\">2.</span> userdebug</div><div class=\"line\">     <span class=\"number\">3.</span> eng</div><div class=\"line\"><span class=\"comment\">//2</span></div></pre></td></tr></table></figure>\n<p>Terminal<br>make -j4</p>\n<blockquote>\n<p>make -j Job  CPU  1  2  4  CPU  make -j8  make -j16</p>\n</blockquote>\n<p><br><br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">sudo ncdu <span class=\"comment\">//</span></div></pre></td></tr></table></figure></p>\n<p>makeBUILD<br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">make clobber <span class=\"comment\">//out</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"Android\"><a href=\"#Android\" class=\"headerlink\" title=\"Android\"></a>Android</h3><p><a href=\"http://blog.csdn.net/dd864140130/article/details/51815253\">Android</a></p>\n<p>AndroidAndroid Studio<br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">source build/envsetup.sh</div><div class=\"line\">mmm development/tools/idegen/</div><div class=\"line\">sudo ./development/tools/idegen/idegen.sh</div></pre></td></tr></table></figure></p>\n<p>IEDA: android.ipr,android.imlandroid.iws.<br>android.iprAndroid Studio</p>\n<blockquote>\n<p>Android StudioIntelliJDebugAndroid<a href=\"http://www.jianshu.com/p/1d1b8d0de1ed\"> IntelliJ  Android </a></p>\n</blockquote>\n<h4 id=\"Android\"><a href=\"#Android\" class=\"headerlink\" title=\"Android\"></a>Android</h4><p>Android/packages/experimentalGoogleAndroid BUILDapk<br></p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/aosp_make_single_module.png\" alt=\"\"></p>\n<p>MultiPackageApk<br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">source build/envsetup.sh</div><div class=\"line\">mmm packages/experimental/MultiPackageApk    </div><div class=\"line\">make snod</div></pre></td></tr></table></figure></p>\n<p></p>\n<p></p>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><div class=\"line\">ninja: error: 'out/target/common/obj/JAVA_LIBRARIES/core-junit_intermediates/classes.dex.toc', needed by 'out/target/common/obj/APPS/MultiPackageApk_intermediates/with-local/classes.dex', missing and no known rule to make it</div><div class=\"line\">make: *** [ninja_wrapper] Error 1</div></pre></td></tr></table></figure>\n<p>lunchchoosecombo<strong>make snod</strong></p>\n<h4 id=\"make-failed-to-build-some-targets-4-seconds\"><a href=\"#make-failed-to-build-some-targets-4-seconds\" class=\"headerlink\" title=\"make failed to build some targets (4 seconds)\"></a>make failed to build some targets (4 seconds)</h4><h4 id=\"-IntelliJ-Debug-Android-\"><a href=\"#-IntelliJ-Debug-Android-\" class=\"headerlink\" title=\" IntelliJ Debug Android \"></a> IntelliJ Debug Android </h4><p><a href=\"http://www.jianshu.com/p/7c2ab3d9498c\"> IntelliJ Debug Android </a></p>\n<p></p>\n<h4 id=\"-monitor--debug-\"><a href=\"#-monitor--debug-\" class=\"headerlink\" title=\" monitor  debug \"></a> monitor  debug </h4><p>monitormonitor.app<br>/Library/Android_sdk/tools/lib/monitor-x86_64/monitor.app<br></p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/aosp_monitor_position.png\" alt=\"\"></p>\n<p>AndroidAndroid<strong>Activity</strong></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/08/01/aosp-compile/\">http://agehua.github.io/2017/08/01/aosp-compile/</a></p>"},{"layout":"post","title":"Android Binder","keywords":"AIDL, Binder","banner":"http://obxk8w81b.bkt.clouddn.com/Blossoming%20Branches.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Blossoming%20Branches.jpg","toc":true,"_content":"\n### \n[](http://agehua.github.io/2017/07/08/android-binder-principle/\n)BinderAIDL\nServiceManagerBinder\n\n\n> [](http://www.wjdiankong.cn/android%E7%B3%BB%E7%BB%9F%E7%AF%87%E4%B9%8B-binder%E6%9C%BA%E5%88%B6%E5%92%8C%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8%E6%9C%BA%E5%88%B6%E5%88%86%E6%9E%90/)\n\n### ServiceManager\n> ServiceManager.java[](https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/os/ServiceManager.java)\n\n[](http://agehua.github.io/2017/07/08/android-binder-principle/\n)IBinderServiceManagerServiceManager.getService:\n<!--more-->\n~~~ Java\n/**\n * Returns a reference to a service with the given name.\n *\n * @param name the name of the service to get\n * @return a reference to the service, or <code>null</code> if the service doesn't exist\n */\npublic static IBinder getService(String name) {\n   try {\n       IBinder service = sCache.get(name);\n       if (service != null) {\n           return service;\n       } else {\n           return getIServiceManager().getService(name);\n       }\n   } catch (RemoteException e) {\n       Log.e(TAG, \"error in getService\", e);\n   }\n   return null;\n}\n~~~\n\nsCacheMap\n~~~ Java\nprivate static HashMap<String, IBinder> sCache = new HashMap<String, IBinder>();\n~~~\n> ServiceManagerIBinder\n\ngetIServiceManager\n~~~ Java\nprivate static IServiceManager getIServiceManager() {\n    if (sServiceManager != null) {\n        return sServiceManager;\n    }\n    // Find the service manager\n    sServiceManager = ServiceManagerNative.asInterface(BinderInternal.getContextObject());\n    return sServiceManager;\n}\n~~~\n> ServiceManagerNative.asInterface()ServiceManager\n\nServiceManagerNative.java\n~~~ Java\npublic abstract class ServiceManagerNative extends Binder implements IServiceManager\n{\n    /**\n     * Cast a Binder object into a service manager interface, generating\n     * a proxy if needed.\n     */\n    static public IServiceManager asInterface(IBinder obj)\n    {\n        if (obj == null) {\n            return null;\n        }\n        IServiceManager in =\n            (IServiceManager)obj.queryLocalInterface(descriptor);\n        if (in != null) {\n            return in;\n        }\n\n        return new ServiceManagerProxy(obj);\n    }\n\n    //....\n}    \n~~~\n\n> ServiceManagerServiceManagerNativeServiceManagerService\n\nServiceManagerIBinderServiceManagerServiceManagerIBinderinit.rc\n\n~~~ C++\nservice servicemanager /system/bin/servicemanager\n    class core\n    user system\n    group system\n    critical\n    onrestart restart healthd\n    onrestart restart zygote\n    onrestart restart media\n    onrestart restart surfaceflinger\n    onrestart restart drm\n~~~\n\nservicemanager**service_manager.c**\n\n![service_manager](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/servicemanager-init.png)\n\nBinder\n\n- 1BinderBinder\n- 2binder**BINDER_SET_CONTEXT_MGR**binder\n- 3ServiceManager\n\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-service-manager.png)\n\nservicemanagerbinderbinderbinderServiceManager\n\nServiceManager\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/servicemanager-add-service.png)\n\nbinder\n\nServiceManager\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/servicemanager-find-service.png)\n\nbinder\n\n- 1Service Manager\n- 2Service ManagerService\n- 3ServerService ManagerClientService ManagerServer\n\n### \n[AndroidBinder](http://www.cnblogs.com/innost/archive/2011/01/09/1931456.html)\n\nMediaService\n\nMediaServiceinit.rc\n~~~ C++\nservice media /system/bin/mediaserver\n  class main\n  user media\n  group audio camera inet net_bt net_bt_admin net_bw_acct drmrpc mediadrm\n  ioprio rt 4\n~~~\nMain_mediaserver.cppmain\n~~~ C++\nint main(int argc, char** argv)\n{\n  //ProcessState\n  sp<ProcessState> proc(ProcessState::self());\n\n  //ServiceManager\n  sp<IServiceManager> sm = defaultServiceManager();\n  MediaPlayerService::instantiate();//MediaPlayerService\n  ProcessState::self()->startThreadPool();\n  IPCThreadState::self()->joinThreadPool();\n}\n~~~\n> spgoogleC/C++sp&lt;XXX&gt;XXX*\n\nMediaPlayerService\n~~~ C++\nvoid MediaPlayerService::instantiate() {\n  defaultServiceManager()->addService(\n    String16(\"media.player\"), new MediaPlayerService());\n  )\n}\n~~~\n\nServiceManagerServiceManager\n~~~ C++\nsp<IServiceManager> defaultServiceManager() {\n  if (gDefaultServiceManager != NULL) return gDefaultServiceManager;\n\n  {\n    AutoMutex _l(gDefaultServiceManagerLock); //--->\n    while (gDefaultServiceManager == NULL) {\n      gDefaultServiceManager = interface_cast<IServiceManager> (\n        ProcessState::self()->getContextObject(NULL));\n      if (gDefaultServiceManager == NULL)\n        sleep(1);\n    }\n  }\n  return gDefaultServiceManager;\n}\n~~~\nProcessState.cpp\n~~~ C++\nsp<IBinder> ProcessState::getContextObject(const sp<IBinder>& caller) {\n  return getStrongProxyForHandle(0);\n}\n~~~\ngetStrongProxyForHandle\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/getStrongProxyForHandle.png)\n\nIPCThreadStatetransactBinderhandleBpBinderBpBindernativeBinderBpJavaProxyBnnativeJavaStub\n\nservicemanagerbinderbinderhandlebinderservicemanagerhandle0IPCParcelreadStrongBinderParcelBinderBinder\n~~~ Java\npublic final IBinder readStrongBinder() {\n  return nativeReadStronBinder(mNativePtr);\n}\n~~~\n\nmediaserver\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/media-server-process.png)\n\nAndroidServiceManager:\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/service-manager-activity.png)\n\n- 1ProxyStub\n- 2ProxyBinderStubBinder\n- 3AndroidgetSystemServiceStubBindersystem_serverBinderProxy\n- 4system_server\n- 5ServiceManagerBinder\n\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/system-service-register-process.png)\n\nServiceManagerBinderBinderAndroidBinderBinder\n\n### Binder\n#### AndroidIPCBinder\n\nBinderAndroid(IPC)LinuxIPC(Internet Process Connection)(Pipe)(Signal)(Trace)(Socket)(Message)(Share Memory)(Semaphore)\n\nBinderClient-ServerUID,PIDBinderBinderBinderBinderServer ClientServerClientBinderServerServer\n\n#### AndroidBinder\n\nAndroidBinder/dev/binderbinder****miscdevice\n\n(10)miscdevice:LED/dev/binder\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/device-number.png)\n\n#### AndroidBinder\n\nBinder\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-drive-principle.png)\n\nbinderIPC\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/IPC-data-format.png)\n\nServiceManagerbinder.c\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-open-drive.png)\n\nIPCTreadState.cppbinder\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/transact-binder.png)\n\nIPCThreadState\n\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/communication-timing.png)\n\nBinderBinderIPC\n\n### \n#### \n\nBinderStubBinderBinderasInterfaceIXXXAIDLProxyIXXXBinderStubProxy\n\n#### \n\nAndroidgetSystemServiceBinderBinderServiceManager\n\n#### ServiceManager\n\nBinderServiceManageraddServicegetServicebinderbinderhandle\n\n#### Binder\n\nBinder/dev/binder\n\n### \n\nAndroidBinderapiActivityActivityActivityManagerServiceBinderBinder\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-summary.png)\n\nAndroidAndroidbinder\n\n\n[Android-Binder](http://www.wjdiankong.cn/android%E7%B3%BB%E7%BB%9F%E7%AF%87%E4%B9%8B-binder%E6%9C%BA%E5%88%B6%E5%92%8C%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8%E6%9C%BA%E5%88%B6%E5%88%86%E6%9E%90/)\n\n[Android](http://blog.csdn.net/L173864930/article/details/38468433)\n\n[AndroidBinder](http://www.cnblogs.com/innost/archive/2011/01/09/1931456.html)\n","source":"_posts/2017-07-10-android-binder-principle2.md","raw":"---\nlayout: post\ntitle:  Android Binder\ncategory: accumulation\ntags:\n  - AIDL\n  - Binder\nkeywords: AIDL, Binder\nbanner: http://obxk8w81b.bkt.clouddn.com/Blossoming%20Branches.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Blossoming%20Branches.jpg\ntoc: true\n---\n\n### \n[](http://agehua.github.io/2017/07/08/android-binder-principle/\n)BinderAIDL\nServiceManagerBinder\n\n\n> [](http://www.wjdiankong.cn/android%E7%B3%BB%E7%BB%9F%E7%AF%87%E4%B9%8B-binder%E6%9C%BA%E5%88%B6%E5%92%8C%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8%E6%9C%BA%E5%88%B6%E5%88%86%E6%9E%90/)\n\n### ServiceManager\n> ServiceManager.java[](https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/os/ServiceManager.java)\n\n[](http://agehua.github.io/2017/07/08/android-binder-principle/\n)IBinderServiceManagerServiceManager.getService:\n<!--more-->\n~~~ Java\n/**\n * Returns a reference to a service with the given name.\n *\n * @param name the name of the service to get\n * @return a reference to the service, or <code>null</code> if the service doesn't exist\n */\npublic static IBinder getService(String name) {\n   try {\n       IBinder service = sCache.get(name);\n       if (service != null) {\n           return service;\n       } else {\n           return getIServiceManager().getService(name);\n       }\n   } catch (RemoteException e) {\n       Log.e(TAG, \"error in getService\", e);\n   }\n   return null;\n}\n~~~\n\nsCacheMap\n~~~ Java\nprivate static HashMap<String, IBinder> sCache = new HashMap<String, IBinder>();\n~~~\n> ServiceManagerIBinder\n\ngetIServiceManager\n~~~ Java\nprivate static IServiceManager getIServiceManager() {\n    if (sServiceManager != null) {\n        return sServiceManager;\n    }\n    // Find the service manager\n    sServiceManager = ServiceManagerNative.asInterface(BinderInternal.getContextObject());\n    return sServiceManager;\n}\n~~~\n> ServiceManagerNative.asInterface()ServiceManager\n\nServiceManagerNative.java\n~~~ Java\npublic abstract class ServiceManagerNative extends Binder implements IServiceManager\n{\n    /**\n     * Cast a Binder object into a service manager interface, generating\n     * a proxy if needed.\n     */\n    static public IServiceManager asInterface(IBinder obj)\n    {\n        if (obj == null) {\n            return null;\n        }\n        IServiceManager in =\n            (IServiceManager)obj.queryLocalInterface(descriptor);\n        if (in != null) {\n            return in;\n        }\n\n        return new ServiceManagerProxy(obj);\n    }\n\n    //....\n}    \n~~~\n\n> ServiceManagerServiceManagerNativeServiceManagerService\n\nServiceManagerIBinderServiceManagerServiceManagerIBinderinit.rc\n\n~~~ C++\nservice servicemanager /system/bin/servicemanager\n    class core\n    user system\n    group system\n    critical\n    onrestart restart healthd\n    onrestart restart zygote\n    onrestart restart media\n    onrestart restart surfaceflinger\n    onrestart restart drm\n~~~\n\nservicemanager**service_manager.c**\n\n![service_manager](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/servicemanager-init.png)\n\nBinder\n\n- 1BinderBinder\n- 2binder**BINDER_SET_CONTEXT_MGR**binder\n- 3ServiceManager\n\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-service-manager.png)\n\nservicemanagerbinderbinderbinderServiceManager\n\nServiceManager\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/servicemanager-add-service.png)\n\nbinder\n\nServiceManager\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/servicemanager-find-service.png)\n\nbinder\n\n- 1Service Manager\n- 2Service ManagerService\n- 3ServerService ManagerClientService ManagerServer\n\n### \n[AndroidBinder](http://www.cnblogs.com/innost/archive/2011/01/09/1931456.html)\n\nMediaService\n\nMediaServiceinit.rc\n~~~ C++\nservice media /system/bin/mediaserver\n  class main\n  user media\n  group audio camera inet net_bt net_bt_admin net_bw_acct drmrpc mediadrm\n  ioprio rt 4\n~~~\nMain_mediaserver.cppmain\n~~~ C++\nint main(int argc, char** argv)\n{\n  //ProcessState\n  sp<ProcessState> proc(ProcessState::self());\n\n  //ServiceManager\n  sp<IServiceManager> sm = defaultServiceManager();\n  MediaPlayerService::instantiate();//MediaPlayerService\n  ProcessState::self()->startThreadPool();\n  IPCThreadState::self()->joinThreadPool();\n}\n~~~\n> spgoogleC/C++sp&lt;XXX&gt;XXX*\n\nMediaPlayerService\n~~~ C++\nvoid MediaPlayerService::instantiate() {\n  defaultServiceManager()->addService(\n    String16(\"media.player\"), new MediaPlayerService());\n  )\n}\n~~~\n\nServiceManagerServiceManager\n~~~ C++\nsp<IServiceManager> defaultServiceManager() {\n  if (gDefaultServiceManager != NULL) return gDefaultServiceManager;\n\n  {\n    AutoMutex _l(gDefaultServiceManagerLock); //--->\n    while (gDefaultServiceManager == NULL) {\n      gDefaultServiceManager = interface_cast<IServiceManager> (\n        ProcessState::self()->getContextObject(NULL));\n      if (gDefaultServiceManager == NULL)\n        sleep(1);\n    }\n  }\n  return gDefaultServiceManager;\n}\n~~~\nProcessState.cpp\n~~~ C++\nsp<IBinder> ProcessState::getContextObject(const sp<IBinder>& caller) {\n  return getStrongProxyForHandle(0);\n}\n~~~\ngetStrongProxyForHandle\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/getStrongProxyForHandle.png)\n\nIPCThreadStatetransactBinderhandleBpBinderBpBindernativeBinderBpJavaProxyBnnativeJavaStub\n\nservicemanagerbinderbinderhandlebinderservicemanagerhandle0IPCParcelreadStrongBinderParcelBinderBinder\n~~~ Java\npublic final IBinder readStrongBinder() {\n  return nativeReadStronBinder(mNativePtr);\n}\n~~~\n\nmediaserver\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/media-server-process.png)\n\nAndroidServiceManager:\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/service-manager-activity.png)\n\n- 1ProxyStub\n- 2ProxyBinderStubBinder\n- 3AndroidgetSystemServiceStubBindersystem_serverBinderProxy\n- 4system_server\n- 5ServiceManagerBinder\n\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/system-service-register-process.png)\n\nServiceManagerBinderBinderAndroidBinderBinder\n\n### Binder\n#### AndroidIPCBinder\n\nBinderAndroid(IPC)LinuxIPC(Internet Process Connection)(Pipe)(Signal)(Trace)(Socket)(Message)(Share Memory)(Semaphore)\n\nBinderClient-ServerUID,PIDBinderBinderBinderBinderServer ClientServerClientBinderServerServer\n\n#### AndroidBinder\n\nAndroidBinder/dev/binderbinder****miscdevice\n\n(10)miscdevice:LED/dev/binder\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/device-number.png)\n\n#### AndroidBinder\n\nBinder\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-drive-principle.png)\n\nbinderIPC\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/IPC-data-format.png)\n\nServiceManagerbinder.c\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-open-drive.png)\n\nIPCTreadState.cppbinder\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/transact-binder.png)\n\nIPCThreadState\n\n\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/communication-timing.png)\n\nBinderBinderIPC\n\n### \n#### \n\nBinderStubBinderBinderasInterfaceIXXXAIDLProxyIXXXBinderStubProxy\n\n#### \n\nAndroidgetSystemServiceBinderBinderServiceManager\n\n#### ServiceManager\n\nBinderServiceManageraddServicegetServicebinderbinderhandle\n\n#### Binder\n\nBinder/dev/binder\n\n### \n\nAndroidBinderapiActivityActivityActivityManagerServiceBinderBinder\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-summary.png)\n\nAndroidAndroidbinder\n\n\n[Android-Binder](http://www.wjdiankong.cn/android%E7%B3%BB%E7%BB%9F%E7%AF%87%E4%B9%8B-binder%E6%9C%BA%E5%88%B6%E5%92%8C%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8%E6%9C%BA%E5%88%B6%E5%88%86%E6%9E%90/)\n\n[Android](http://blog.csdn.net/L173864930/article/details/38468433)\n\n[AndroidBinder](http://www.cnblogs.com/innost/archive/2011/01/09/1931456.html)\n","slug":"android-binder-principle2","published":1,"date":"2017-07-09T16:00:00.000Z","updated":"2017-11-23T07:15:48.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ec18003od6ykbkgy2aq7","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"http://agehua.github.io/2017/07/08/android-binder-principle/\"></a>BinderAIDL<br>ServiceManagerBinder</p>\n<blockquote>\n<p><a href=\"http://www.wjdiankong.cn/android%E7%B3%BB%E7%BB%9F%E7%AF%87%E4%B9%8B-binder%E6%9C%BA%E5%88%B6%E5%92%8C%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8%E6%9C%BA%E5%88%B6%E5%88%86%E6%9E%90/\" target=\"_blank\" rel=\"external\"></a></p>\n</blockquote>\n<h3 id=\"ServiceManager\"><a href=\"#ServiceManager\" class=\"headerlink\" title=\"ServiceManager\"></a>ServiceManager</h3><blockquote>\n<p>ServiceManager.java<a href=\"https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/os/ServiceManager.java\" target=\"_blank\" rel=\"external\"></a></p>\n</blockquote>\n<p><a href=\"http://agehua.github.io/2017/07/08/android-binder-principle/\"></a>IBinderServiceManagerServiceManager.getService:<br><a id=\"more\"></a><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * Returns a reference to a service with the given name.</div><div class=\"line\"> *</div><div class=\"line\"> * <span class=\"doctag\">@param</span> name the name of the service to get</div><div class=\"line\"> * <span class=\"doctag\">@return</span> a reference to the service, or &lt;code&gt;null&lt;/code&gt; if the service doesn't exist</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> IBinder <span class=\"title\">getService</span><span class=\"params\">(String name)</span> </span>&#123;</div><div class=\"line\">   <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">       IBinder service = sCache.get(name);</div><div class=\"line\">       <span class=\"keyword\">if</span> (service != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">           <span class=\"keyword\">return</span> service;</div><div class=\"line\">       &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">           <span class=\"keyword\">return</span> getIServiceManager().getService(name);</div><div class=\"line\">       &#125;</div><div class=\"line\">   &#125; <span class=\"keyword\">catch</span> (RemoteException e) &#123;</div><div class=\"line\">       Log.e(TAG, <span class=\"string\">\"error in getService\"</span>, e);</div><div class=\"line\">   &#125;</div><div class=\"line\">   <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>sCacheMap<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> HashMap&lt;String, IBinder&gt; sCache = <span class=\"keyword\">new</span> HashMap&lt;String, IBinder&gt;();</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>ServiceManagerIBinder</p>\n</blockquote>\n<p>getIServiceManager<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> IServiceManager <span class=\"title\">getIServiceManager</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (sServiceManager != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> sServiceManager;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"comment\">// Find the service manager</span></div><div class=\"line\">    sServiceManager = ServiceManagerNative.asInterface(BinderInternal.getContextObject());</div><div class=\"line\">    <span class=\"keyword\">return</span> sServiceManager;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>ServiceManagerNative.asInterface()ServiceManager</p>\n</blockquote>\n<p>ServiceManagerNative.java<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ServiceManagerNative</span> <span class=\"keyword\">extends</span> <span class=\"title\">Binder</span> <span class=\"keyword\">implements</span> <span class=\"title\">IServiceManager</span></span></div><div class=\"line\">&#123;</div><div class=\"line\">    <span class=\"comment\">/**</span></div><div class=\"line\">     * Cast a Binder object into a service manager interface, generating</div><div class=\"line\">     * a proxy if needed.</div><div class=\"line\">     */</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">public</span> IServiceManager <span class=\"title\">asInterface</span><span class=\"params\">(IBinder obj)</span></span></div><div class=\"line\">    &#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (obj == <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">        &#125;</div><div class=\"line\">        IServiceManager in =</div><div class=\"line\">            (IServiceManager)obj.queryLocalInterface(descriptor);</div><div class=\"line\">        <span class=\"keyword\">if</span> (in != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> in;</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> ServiceManagerProxy(obj);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//....</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>ServiceManagerServiceManagerNativeServiceManagerService</p>\n</blockquote>\n<p>ServiceManagerIBinderServiceManagerServiceManagerIBinderinit.rc</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">service servicemanager /system/bin/servicemanager</div><div class=\"line\">    <span class=\"keyword\">class</span> core</div><div class=\"line\">    user system</div><div class=\"line\">    group system</div><div class=\"line\">    critical</div><div class=\"line\">    onrestart restart healthd</div><div class=\"line\">    onrestart restart zygote</div><div class=\"line\">    onrestart restart media</div><div class=\"line\">    onrestart restart surfaceflinger</div><div class=\"line\">    onrestart restart drm</div></pre></td></tr></table></figure>\n<p>servicemanager<strong>service_manager.c</strong></p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/servicemanager-init.png\" alt=\"service_manager\"></p>\n<p>Binder</p>\n<ul>\n<li>1BinderBinder</li>\n<li>2binder<strong>BINDER_SET_CONTEXT_MGR</strong>binder</li>\n<li>3ServiceManager</li>\n</ul>\n<p><br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-service-manager.png\" alt=\"\"></p>\n<p>servicemanagerbinderbinderbinderServiceManager</p>\n<p>ServiceManager<br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/servicemanager-add-service.png\" alt=\"\"></p>\n<p>binder</p>\n<p>ServiceManager<br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/servicemanager-find-service.png\" alt=\"\"></p>\n<p>binder</p>\n<ul>\n<li>1Service Manager</li>\n<li>2Service ManagerService</li>\n<li>3ServerService ManagerClientService ManagerServer</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"http://www.cnblogs.com/innost/archive/2011/01/09/1931456.html\" target=\"_blank\" rel=\"external\">AndroidBinder</a></p>\n<p>MediaService</p>\n<p>MediaServiceinit.rc<br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">service media /system/bin/mediaserver</div><div class=\"line\">  <span class=\"keyword\">class</span> main</div><div class=\"line\">  user media</div><div class=\"line\">  group audio camera inet net_bt net_bt_admin net_bw_acct drmrpc mediadrm</div><div class=\"line\">  ioprio rt <span class=\"number\">4</span></div></pre></td></tr></table></figure></p>\n<p>Main_mediaserver.cppmain<br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span>** argv)</span></span></div><div class=\"line\">&#123;</div><div class=\"line\">  <span class=\"comment\">//ProcessState</span></div><div class=\"line\">  sp&lt;ProcessState&gt; proc(ProcessState::self());</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\">//ServiceManager</span></div><div class=\"line\">  sp&lt;IServiceManager&gt; sm = defaultServiceManager();</div><div class=\"line\">  MediaPlayerService::instantiate();<span class=\"comment\">//MediaPlayerService</span></div><div class=\"line\">  ProcessState::self()-&gt;startThreadPool();</div><div class=\"line\">  IPCThreadState::self()-&gt;joinThreadPool();</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>spgoogleC/C++sp&lt;XXX&gt;XXX*</p>\n</blockquote>\n<p>MediaPlayerService<br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">void</span> MediaPlayerService::instantiate() &#123;</div><div class=\"line\">  defaultServiceManager()-&gt;addService(</div><div class=\"line\">    String16(<span class=\"string\">\"media.player\"</span>), <span class=\"keyword\">new</span> MediaPlayerService());</div><div class=\"line\">  )</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>ServiceManagerServiceManager<br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">sp&lt;IServiceManager&gt; defaultServiceManager() &#123;</div><div class=\"line\">  <span class=\"keyword\">if</span> (gDefaultServiceManager != <span class=\"literal\">NULL</span>) <span class=\"keyword\">return</span> gDefaultServiceManager;</div><div class=\"line\"></div><div class=\"line\">  &#123;</div><div class=\"line\">    AutoMutex _l(gDefaultServiceManagerLock); <span class=\"comment\">//---&gt;</span></div><div class=\"line\">    <span class=\"keyword\">while</span> (gDefaultServiceManager == <span class=\"literal\">NULL</span>) &#123;</div><div class=\"line\">      gDefaultServiceManager = interface_cast&lt;IServiceManager&gt; (</div><div class=\"line\">        ProcessState::self()-&gt;getContextObject(<span class=\"literal\">NULL</span>));</div><div class=\"line\">      <span class=\"keyword\">if</span> (gDefaultServiceManager == <span class=\"literal\">NULL</span>)</div><div class=\"line\">        sleep(<span class=\"number\">1</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\">  &#125;</div><div class=\"line\">  <span class=\"keyword\">return</span> gDefaultServiceManager;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>ProcessState.cpp<br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">sp&lt;IBinder&gt; ProcessState::getContextObject(<span class=\"keyword\">const</span> sp&lt;IBinder&gt;&amp; caller) &#123;</div><div class=\"line\">  <span class=\"keyword\">return</span> getStrongProxyForHandle(<span class=\"number\">0</span>);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>getStrongProxyForHandle</p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/getStrongProxyForHandle.png\" alt=\"\"></p>\n<p>IPCThreadStatetransactBinderhandleBpBinderBpBindernativeBinderBpJavaProxyBnnativeJavaStub</p>\n<p>servicemanagerbinderbinderhandlebinderservicemanagerhandle0IPCParcelreadStrongBinderParcelBinderBinder<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> IBinder <span class=\"title\">readStrongBinder</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">return</span> nativeReadStronBinder(mNativePtr);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>mediaserver</p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/media-server-process.png\" alt=\"\"></p>\n<p>AndroidServiceManager:</p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/service-manager-activity.png\" alt=\"\"></p>\n<ul>\n<li>1ProxyStub</li>\n<li>2ProxyBinderStubBinder</li>\n<li>3AndroidgetSystemServiceStubBindersystem_serverBinderProxy</li>\n<li>4system_server</li>\n<li>5ServiceManagerBinder</li>\n</ul>\n<p><br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/system-service-register-process.png\" alt=\"\"></p>\n<p>ServiceManagerBinderBinderAndroidBinderBinder</p>\n<h3 id=\"Binder\"><a href=\"#Binder\" class=\"headerlink\" title=\"Binder\"></a>Binder</h3><h4 id=\"AndroidIPCBinder\"><a href=\"#AndroidIPCBinder\" class=\"headerlink\" title=\"AndroidIPCBinder\"></a>AndroidIPCBinder</h4><p>BinderAndroid(IPC)LinuxIPC(Internet Process Connection)(Pipe)(Signal)(Trace)(Socket)(Message)(Share Memory)(Semaphore)</p>\n<p>BinderClient-ServerUID,PIDBinderBinderBinderBinderServer ClientServerClientBinderServerServer</p>\n<h4 id=\"AndroidBinder\"><a href=\"#AndroidBinder\" class=\"headerlink\" title=\"AndroidBinder\"></a>AndroidBinder</h4><p>AndroidBinder/dev/binderbinder<strong></strong>miscdevice</p>\n<p>(10)miscdevice:LED/dev/binder<br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/device-number.png\" alt=\"\"></p>\n<h4 id=\"AndroidBinder\"><a href=\"#AndroidBinder\" class=\"headerlink\" title=\"AndroidBinder\"></a>AndroidBinder</h4><p>Binder</p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-drive-principle.png\" alt=\"\"></p>\n<p>binderIPC<br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/IPC-data-format.png\" alt=\"\"></p>\n<p>ServiceManagerbinder.c<br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-open-drive.png\" alt=\"\"></p>\n<p>IPCTreadState.cppbinder<br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/transact-binder.png\" alt=\"\"></p>\n<p>IPCThreadState</p>\n<p><br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/communication-timing.png\" alt=\"\"></p>\n<p>BinderBinderIPC</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>BinderStubBinderBinderasInterfaceIXXXAIDLProxyIXXXBinderStubProxy</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>AndroidgetSystemServiceBinderBinderServiceManager</p>\n<h4 id=\"ServiceManager-1\"><a href=\"#ServiceManager-1\" class=\"headerlink\" title=\"ServiceManager\"></a>ServiceManager</h4><p>BinderServiceManageraddServicegetServicebinderbinderhandle</p>\n<h4 id=\"Binder\"><a href=\"#Binder\" class=\"headerlink\" title=\"Binder\"></a>Binder</h4><p>Binder/dev/binder</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>AndroidBinderapiActivityActivityActivityManagerServiceBinderBinder<br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-summary.png\" alt=\"\"></p>\n<p>AndroidAndroidbinder</p>\n<p><br><a href=\"http://www.wjdiankong.cn/android%E7%B3%BB%E7%BB%9F%E7%AF%87%E4%B9%8B-binder%E6%9C%BA%E5%88%B6%E5%92%8C%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8%E6%9C%BA%E5%88%B6%E5%88%86%E6%9E%90/\" target=\"_blank\" rel=\"external\">Android-Binder</a></p>\n<p><a href=\"http://blog.csdn.net/L173864930/article/details/38468433\" target=\"_blank\" rel=\"external\">Android</a></p>\n<p><a href=\"http://www.cnblogs.com/innost/archive/2011/01/09/1931456.html\" target=\"_blank\" rel=\"external\">AndroidBinder</a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/07/10/android-binder-principle2/\">http://agehua.github.io/2017/07/10/android-binder-principle2/</a></p>\n","readingTime":{"text":"4 min read","minutes":3.28,"time":196799.99999999997,"words":656},"excerpt":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"http://agehua.github.io/2017/07/08/android-binder-principle/\"></a>BinderAIDL<br>ServiceManagerBinder</p>\n<blockquote>\n<p><a href=\"http://www.wjdiankong.cn/android%E7%B3%BB%E7%BB%9F%E7%AF%87%E4%B9%8B-binder%E6%9C%BA%E5%88%B6%E5%92%8C%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8%E6%9C%BA%E5%88%B6%E5%88%86%E6%9E%90/\"></a></p>\n</blockquote>\n<h3 id=\"ServiceManager\"><a href=\"#ServiceManager\" class=\"headerlink\" title=\"ServiceManager\"></a>ServiceManager</h3><blockquote>\n<p>ServiceManager.java<a href=\"https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/os/ServiceManager.java\"></a></p>\n</blockquote>\n<p><a href=\"http://agehua.github.io/2017/07/08/android-binder-principle/\"></a>IBinderServiceManagerServiceManager.getService:<br>","more":"<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</div><div class=\"line\"> * Returns a reference to a service with the given name.</div><div class=\"line\"> *</div><div class=\"line\"> * <span class=\"doctag\">@param</span> name the name of the service to get</div><div class=\"line\"> * <span class=\"doctag\">@return</span> a reference to the service, or &lt;code&gt;null&lt;/code&gt; if the service doesn't exist</div><div class=\"line\"> */</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> IBinder <span class=\"title\">getService</span><span class=\"params\">(String name)</span> </span>&#123;</div><div class=\"line\">   <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">       IBinder service = sCache.get(name);</div><div class=\"line\">       <span class=\"keyword\">if</span> (service != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">           <span class=\"keyword\">return</span> service;</div><div class=\"line\">       &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">           <span class=\"keyword\">return</span> getIServiceManager().getService(name);</div><div class=\"line\">       &#125;</div><div class=\"line\">   &#125; <span class=\"keyword\">catch</span> (RemoteException e) &#123;</div><div class=\"line\">       Log.e(TAG, <span class=\"string\">\"error in getService\"</span>, e);</div><div class=\"line\">   &#125;</div><div class=\"line\">   <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>sCacheMap<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> HashMap&lt;String, IBinder&gt; sCache = <span class=\"keyword\">new</span> HashMap&lt;String, IBinder&gt;();</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>ServiceManagerIBinder</p>\n</blockquote>\n<p>getIServiceManager<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> IServiceManager <span class=\"title\">getIServiceManager</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (sServiceManager != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> sServiceManager;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"comment\">// Find the service manager</span></div><div class=\"line\">    sServiceManager = ServiceManagerNative.asInterface(BinderInternal.getContextObject());</div><div class=\"line\">    <span class=\"keyword\">return</span> sServiceManager;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>ServiceManagerNative.asInterface()ServiceManager</p>\n</blockquote>\n<p>ServiceManagerNative.java<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ServiceManagerNative</span> <span class=\"keyword\">extends</span> <span class=\"title\">Binder</span> <span class=\"keyword\">implements</span> <span class=\"title\">IServiceManager</span></div><div class=\"line\"></span>&#123;</div><div class=\"line\">    <span class=\"comment\">/**</div><div class=\"line\">     * Cast a Binder object into a service manager interface, generating</div><div class=\"line\">     * a proxy if needed.</div><div class=\"line\">     */</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">public</span> IServiceManager <span class=\"title\">asInterface</span><span class=\"params\">(IBinder obj)</span></div><div class=\"line\">    </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (obj == <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">        &#125;</div><div class=\"line\">        IServiceManager in =</div><div class=\"line\">            (IServiceManager)obj.queryLocalInterface(descriptor);</div><div class=\"line\">        <span class=\"keyword\">if</span> (in != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> in;</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> ServiceManagerProxy(obj);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//....</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>ServiceManagerServiceManagerNativeServiceManagerService</p>\n</blockquote>\n<p>ServiceManagerIBinderServiceManagerServiceManagerIBinderinit.rc</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">service servicemanager /system/bin/servicemanager</div><div class=\"line\">    <span class=\"keyword\">class</span> core</div><div class=\"line\">    user system</div><div class=\"line\">    group system</div><div class=\"line\">    critical</div><div class=\"line\">    onrestart restart healthd</div><div class=\"line\">    onrestart restart zygote</div><div class=\"line\">    onrestart restart media</div><div class=\"line\">    onrestart restart surfaceflinger</div><div class=\"line\">    onrestart restart drm</div></pre></td></tr></table></figure>\n<p>servicemanager<strong>service_manager.c</strong></p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/servicemanager-init.png\" alt=\"service_manager\"></p>\n<p>Binder</p>\n<ul>\n<li>1BinderBinder</li>\n<li>2binder<strong>BINDER_SET_CONTEXT_MGR</strong>binder</li>\n<li>3ServiceManager</li>\n</ul>\n<p><br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-service-manager.png\" alt=\"\"></p>\n<p>servicemanagerbinderbinderbinderServiceManager</p>\n<p>ServiceManager<br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/servicemanager-add-service.png\" alt=\"\"></p>\n<p>binder</p>\n<p>ServiceManager<br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/servicemanager-find-service.png\" alt=\"\"></p>\n<p>binder</p>\n<ul>\n<li>1Service Manager</li>\n<li>2Service ManagerService</li>\n<li>3ServerService ManagerClientService ManagerServer</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"http://www.cnblogs.com/innost/archive/2011/01/09/1931456.html\">AndroidBinder</a></p>\n<p>MediaService</p>\n<p>MediaServiceinit.rc<br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">service media /system/bin/mediaserver</div><div class=\"line\">  <span class=\"keyword\">class</span> main</div><div class=\"line\">  user media</div><div class=\"line\">  group audio camera inet net_bt net_bt_admin net_bw_acct drmrpc mediadrm</div><div class=\"line\">  ioprio rt <span class=\"number\">4</span></div></pre></td></tr></table></figure></p>\n<p>Main_mediaserver.cppmain<br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span>** argv)</span></div><div class=\"line\"></span>&#123;</div><div class=\"line\">  <span class=\"comment\">//ProcessState</span></div><div class=\"line\">  sp&lt;ProcessState&gt; proc(ProcessState::self());</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\">//ServiceManager</span></div><div class=\"line\">  sp&lt;IServiceManager&gt; sm = defaultServiceManager();</div><div class=\"line\">  MediaPlayerService::instantiate();<span class=\"comment\">//MediaPlayerService</span></div><div class=\"line\">  ProcessState::self()-&gt;startThreadPool();</div><div class=\"line\">  IPCThreadState::self()-&gt;joinThreadPool();</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>spgoogleC/C++sp&lt;XXX&gt;XXX*</p>\n</blockquote>\n<p>MediaPlayerService<br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">void</span> MediaPlayerService::instantiate() &#123;</div><div class=\"line\">  defaultServiceManager()-&gt;addService(</div><div class=\"line\">    String16(<span class=\"string\">\"media.player\"</span>), <span class=\"keyword\">new</span> MediaPlayerService());</div><div class=\"line\">  )</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>ServiceManagerServiceManager<br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">sp&lt;IServiceManager&gt; defaultServiceManager() &#123;</div><div class=\"line\">  <span class=\"keyword\">if</span> (gDefaultServiceManager != <span class=\"literal\">NULL</span>) <span class=\"keyword\">return</span> gDefaultServiceManager;</div><div class=\"line\"></div><div class=\"line\">  &#123;</div><div class=\"line\">    AutoMutex _l(gDefaultServiceManagerLock); <span class=\"comment\">//---&gt;</span></div><div class=\"line\">    <span class=\"keyword\">while</span> (gDefaultServiceManager == <span class=\"literal\">NULL</span>) &#123;</div><div class=\"line\">      gDefaultServiceManager = interface_cast&lt;IServiceManager&gt; (</div><div class=\"line\">        ProcessState::self()-&gt;getContextObject(<span class=\"literal\">NULL</span>));</div><div class=\"line\">      <span class=\"keyword\">if</span> (gDefaultServiceManager == <span class=\"literal\">NULL</span>)</div><div class=\"line\">        sleep(<span class=\"number\">1</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\">  &#125;</div><div class=\"line\">  <span class=\"keyword\">return</span> gDefaultServiceManager;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>ProcessState.cpp<br><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><div class=\"line\">sp&lt;IBinder&gt; ProcessState::getContextObject(<span class=\"keyword\">const</span> sp&lt;IBinder&gt;&amp; caller) &#123;</div><div class=\"line\">  <span class=\"keyword\">return</span> getStrongProxyForHandle(<span class=\"number\">0</span>);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>getStrongProxyForHandle</p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/getStrongProxyForHandle.png\" alt=\"\"></p>\n<p>IPCThreadStatetransactBinderhandleBpBinderBpBindernativeBinderBpJavaProxyBnnativeJavaStub</p>\n<p>servicemanagerbinderbinderhandlebinderservicemanagerhandle0IPCParcelreadStrongBinderParcelBinderBinder<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> IBinder <span class=\"title\">readStrongBinder</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">return</span> nativeReadStronBinder(mNativePtr);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>mediaserver</p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/media-server-process.png\" alt=\"\"></p>\n<p>AndroidServiceManager:</p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/service-manager-activity.png\" alt=\"\"></p>\n<ul>\n<li>1ProxyStub</li>\n<li>2ProxyBinderStubBinder</li>\n<li>3AndroidgetSystemServiceStubBindersystem_serverBinderProxy</li>\n<li>4system_server</li>\n<li>5ServiceManagerBinder</li>\n</ul>\n<p><br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/system-service-register-process.png\" alt=\"\"></p>\n<p>ServiceManagerBinderBinderAndroidBinderBinder</p>\n<h3 id=\"Binder\"><a href=\"#Binder\" class=\"headerlink\" title=\"Binder\"></a>Binder</h3><h4 id=\"AndroidIPCBinder\"><a href=\"#AndroidIPCBinder\" class=\"headerlink\" title=\"AndroidIPCBinder\"></a>AndroidIPCBinder</h4><p>BinderAndroid(IPC)LinuxIPC(Internet Process Connection)(Pipe)(Signal)(Trace)(Socket)(Message)(Share Memory)(Semaphore)</p>\n<p>BinderClient-ServerUID,PIDBinderBinderBinderBinderServer ClientServerClientBinderServerServer</p>\n<h4 id=\"AndroidBinder\"><a href=\"#AndroidBinder\" class=\"headerlink\" title=\"AndroidBinder\"></a>AndroidBinder</h4><p>AndroidBinder/dev/binderbinder<strong></strong>miscdevice</p>\n<p>(10)miscdevice:LED/dev/binder<br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/device-number.png\" alt=\"\"></p>\n<h4 id=\"AndroidBinder\"><a href=\"#AndroidBinder\" class=\"headerlink\" title=\"AndroidBinder\"></a>AndroidBinder</h4><p>Binder</p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-drive-principle.png\" alt=\"\"></p>\n<p>binderIPC<br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/IPC-data-format.png\" alt=\"\"></p>\n<p>ServiceManagerbinder.c<br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-open-drive.png\" alt=\"\"></p>\n<p>IPCTreadState.cppbinder<br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/transact-binder.png\" alt=\"\"></p>\n<p>IPCThreadState</p>\n<p><br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/communication-timing.png\" alt=\"\"></p>\n<p>BinderBinderIPC</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>BinderStubBinderBinderasInterfaceIXXXAIDLProxyIXXXBinderStubProxy</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>AndroidgetSystemServiceBinderBinderServiceManager</p>\n<h4 id=\"ServiceManager-1\"><a href=\"#ServiceManager-1\" class=\"headerlink\" title=\"ServiceManager\"></a>ServiceManager</h4><p>BinderServiceManageraddServicegetServicebinderbinderhandle</p>\n<h4 id=\"Binder\"><a href=\"#Binder\" class=\"headerlink\" title=\"Binder\"></a>Binder</h4><p>Binder/dev/binder</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>AndroidBinderapiActivityActivityActivityManagerServiceBinderBinder<br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/binder-summary.png\" alt=\"\"></p>\n<p>AndroidAndroidbinder</p>\n<p><br><a href=\"http://www.wjdiankong.cn/android%E7%B3%BB%E7%BB%9F%E7%AF%87%E4%B9%8B-binder%E6%9C%BA%E5%88%B6%E5%92%8C%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8%E6%9C%BA%E5%88%B6%E5%88%86%E6%9E%90/\">Android-Binder</a></p>\n<p><a href=\"http://blog.csdn.net/L173864930/article/details/38468433\">Android</a></p>\n<p><a href=\"http://www.cnblogs.com/innost/archive/2011/01/09/1931456.html\">AndroidBinder</a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/07/10/android-binder-principle2/\">http://agehua.github.io/2017/07/10/android-binder-principle2/</a></p>"},{"layout":"post","title":"Activity","keywords":"AOSP, AMS, Binder","banner":"http://obxk8w81b.bkt.clouddn.com/Cottages%20Reminiscence%20of%20the%20North.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Cottages%20Reminiscence%20of%20the%20North.jpg","toc":true,"_content":"\n## Activity\n\nActivityAndroid[android.googlesource](https://android.googlesource.com/platform/frameworks/base/+/master/)\n\n### \n\n#### zygoteSystemServer\nandroidLinuxlinuxinitfork**zygote** \n\n> App\n- dalvik\n- \n\nAndroidfork**zygote** zygotezygote\n<!--more-->\n\n**SystemServer** zygotefork\nSystemServerActivityManagerServicePackageManagerServiceWindowManagerService\n\n> AppAMS(SystemServer)zygote\nAppAMSBinderIPCAMS(SystemServer)zygoteSocketIPC\n\n\n#### Activity\n\n\n- **ActivityManagerServices**AMSActivity[](https://android.googlesource.com/platform/frameworks/base/services/java/com/android/server/am/ActivityManagerService.java)\n\n- **ActivityThread**AppAppmain()UIActivityManagerServicesActivity\n\n- **ApplicationThread**ActivityManagerServiceActivityThreadActivityManagerServiceApplicationActivityApplicationThreadActivityThread\n\n- **ApplicationThreadProxy**ApplicationThreadApplicationThreadAMSActivityThread\n\n- **Instrumentation**InstrumentationActivityInstrumentationActivityThreadActivityInstrumentation\n\n- **ActivityStack**ActivityAMSActivityActivityStack\n\n- **ActivityRecord**ActivityStackActivityAMSActivityRecordActivityProcessStateCurentStateActivity\n\n- **TaskRecord**AMSActivityRecordTaskActivityRecordAMSTaskRecordActivityActivity4launchMode\n\n- **ProcessRecord**\n\n#### App\nActivityActivity.startActivity():\n\n> appfoo.bar.multisystem_processapp\n\n~~~ Java\n@Override\npublic void startActivity(Intent intent) {\n    this.startActivity(intent, null);\n}\n\n@Override\npublic void startActivity(Intent intent, @Nullable Bundle options) {\n    if (options != null) { //optionsnull\n        startActivityForResult(intent, -1, options);\n    } else {\n        // Note we want to go through this call for compatibility with\n        // applications that may have overridden the method.\n        startActivityForResult(intent, -1);\n    }\n}\n\npublic void startActivityForResult(@RequiresPermission Intent intent, int requestCode,\n        @Nullable Bundle options) {\n    if (mParent == null) { //mParent\n        options = transferSpringboardActivityOptions(options);\n        Instrumentation.ActivityResult ar =\n            mInstrumentation.execStartActivity(\n                this, mMainThread.getApplicationThread(), mToken, this,\n                intent, requestCode, options);\n        if (ar != null) {\n            mMainThread.sendActivityResult(\n                mToken, mEmbeddedID, requestCode, ar.getResultCode(),\n                ar.getResultData());\n        }\n\n        // ....\n    } else {\n        // ....\n    }\n}\n~~~\nmMainThreadActivityThreadActivityThreadmain\n\n~~~ Java\npublic static void main(String[] args) {\n    //...\n}\n~~~\nAndroid[android.googlesource](https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/app/ActivityThread.java)main\n\nmInstrumentationActivityattach()\n\n#### InstrumentationActivityThread\n\nmInstrumentation.execStartActivity()\n~~~ Java\npublic ActivityResult execStartActivity(\n          Context who, IBinder contextThread, IBinder token, Activity target,\n          Intent intent, int requestCode, Bundle options)\n\n\npublic ActivityResult execStartActivity(\n         Context who, IBinder contextThread, IBinder token, String target,\n         Intent intent, int requestCode, Bundle options)\n\npublic ActivityResult execStartActivity(\n         Context who, IBinder contextThread, IBinder token, Activity target,\n         Intent intent, int requestCode, Bundle options, UserHandle user)\n~~~\nmInstrumentation.execStartActivity()\n~~~ Java\npublic ActivityResult execStartActivity(Context who, IBinder contextThread, IBinder token, Activity target,\n        Intent intent, int requestCode, Bundle options) {\n    IApplicationThread whoThread = (IApplicationThread) contextThread;\n        //...ignore some code...\n  try {\n        intent.migrateExtraStreamToClipData();\n        intent.prepareToLeaveProcess();\n        int result = ActivityManagerNative.getDefault()\n            .startActivity(whoThread, who.getBasePackageName(), intent,\n                    intent.resolveTypeIfNeeded(who.getContentResolver()),\n                    token, target != null ? target.mEmbeddedID : null,\n                    requestCode, 0, null, options);\n        checkStartActivityResult(result, intent);\n    } catch (RemoteException e) {\n    }\n    return null;\n}\n~~~\nexecStartActivity()ActivityManagerNativestartActivity()ActivityManagerNative[Android Binder](https://agehua.github.io/2017/07/10/android-binder-principle2/)ServiceManagerNativeBinder\n\nActivityManagerNativeInstrumentation\n\nInstrumentationActivityInstrumentationInstrumentation\n\nInstrumentationApplicationActivityApplicationActivity\n\ncallActivityOnCreate()\n~~~ Java\npublic void callActivityOnCreate(Activity activity, Bundle icicle) {\n    prePerformCreate(activity);\n    activity.performCreate(icicle);\n    postPerformCreate(activity);\n}\n~~~\nactivity.performCreate(icicle);ActivityonCreate()Activity.performCreate()\n~~~ Java\nfinal void performCreate(Bundle icicle) {\n    onCreate(icicle);\n    mActivityTransitionState.readState(icicle);\n    performCreateCommon();\n}\n~~~\nonCreateInstrumentation\n\nInstrumentationActivityActivity\nActivityActivityThread\n\nActivityThreadUIUIAppAMSBinderActivityThreadAMSInstrumentationActivityThread\n\nAMSActivityThreadAMSInstrumentationActivityThread\n\n#### AMSActivityThreadBinder\n[Android Binder](https://agehua.github.io/2017/07/08/android-binder-principle/)[Android Binder](https://agehua.github.io/2017/07/10/android-binder-principle2/)AndroidBinderActivityThreadAppAMS\n\nActivity.startActivity()\n**mInstrumentation.execStartActivity()**\n\n~~~ Java\nActivityManagerNative.getDefault().startActivity()\n~~~\n> startActivity()IActivityManagerIActivityManagerIInterfaceAIDL\n\nActivityManagerNative.getDefault()ActivityManagerServiceActivityManagerProxy\n~~~ Java\npublic abstract class ActivityManagerNative extends Binder implements IActivityManager\n{\n\n //ActivityManagerNativeBinderIActivityManager\n static public IActivityManager getDefault() {\n        return gDefault.get();\n }\n\n//ActivityManagerProxy\nstatic public IActivityManager asInterface(IBinder obj) {\n        if (obj == null) {\n            return null;\n        }\n        IActivityManager in =\n            (IActivityManager)obj.queryLocalInterface(descriptor);\n        if (in != null) {\n            return in;\n        }\n\n        //BinderobjActivityManagerProxymRemoteIPC\n        return new ActivityManagerProxy(obj);\n    }\n}\n~~~\n\nActivityManagerNativeStubStubBinderAIDLStubasInterface\n~~~ Java\n//IActivityManagerasInterface(b)\nprivate static final Singleton<IActivityManager> gDefault = new Singleton<IActivityManager>() {\n       protected IActivityManager create() {\n           IBinder b = ServiceManager.getService(\"activity\");\n           if (false) {\n               Log.v(\"ActivityManager\", \"default service binder = \" + b);\n           }\n           IActivityManager am = asInterface(b);\n           if (false) {\n               Log.v(\"ActivityManager\", \"default service = \" + am);\n           }\n           return am;\n       }\n   };\n}\n~~~\ngDefalutSingletonServiceManagerAMSBinderasInterfaceActivityManagerProxyActivityManagerNativestartActivityActivityManagerProxy\n\nIPCBindertransact()ParcelAMS\n\n> startActivity()ActivityManagerProxyAppfoo.bar.multi\n\n~~~ Java\npublic int startActivity(IApplicationThread caller, String callingPackage, Intent intent,\n        String resolvedType, IBinder resultTo, String resultWho, int requestCode,\n        int startFlags, ProfilerInfo profilerInfo, Bundle options) throws RemoteException {\n    Parcel data = Parcel.obtain();\n    Parcel reply = Parcel.obtain();\n    data.writeInterfaceToken(IActivityManager.descriptor);\n    data.writeStrongBinder(caller != null ? caller.asBinder() : null);\n    data.writeString(callingPackage);\n    intent.writeToParcel(data, 0);\n    //...\n    mRemote.transact(START_ACTIVITY_TRANSACTION, data, reply, 0);\n    reply.readException();\n    int result = reply.readInt();\n    reply.recycle();\n    data.recycle();\n    return result;\n}\n~~~\n      \n\n> BinderServerClientProxyServerClientServerClient\n\nActivityManagerProxy =====>Binder=====> ActivityManagerService\n\nBinderActivityManagerServicesstartActivity()START_ACTIVITY_TRANSACTION\n\ntransact()mRemote.transact()ActivityManagerNativeonTransact\n>  ActivityManagerNativeonTransactsystem_processdebugmonitor\n\n~~~ Java\n@Override\npublic boolean onTransact(int code, Parcel data, Parcel reply, int flags)\n        throws RemoteException {\n    switch (code) {\n    case START_ACTIVITY_TRANSACTION:\n    {   //case\n        data.enforceInterface(IActivityManager.descriptor);\n        IBinder b = data.readStrongBinder();\n        IApplicationThread app = ApplicationThreadNative.asInterface(b);\n        String callingPackage = data.readString();\n        Intent intent = Intent.CREATOR.createFromParcel(data);\n        String resolvedType = data.readString();\n        IBinder resultTo = data.readStrongBinder();\n        String resultWho = data.readString();\n        int requestCode = data.readInt();\n        int startFlags = data.readInt();\n        ProfilerInfo profilerInfo = data.readInt() != 0\n                ? ProfilerInfo.CREATOR.createFromParcel(data) : null;\n        Bundle options = data.readInt() != 0\n                ? Bundle.CREATOR.createFromParcel(data) : null;\n        int result = startActivity(app, callingPackage, intent, resolvedType,\n                resultTo, resultWho, requestCode, startFlags, profilerInfo, options);\n        reply.writeNoException();\n        reply.writeInt(result);\n        return true;\n    }\n    //...\n}\n~~~\nstartActivityIActivityManagerActivityManagerProxyActivityManagerService[android.googlesource](https://android.googlesource.com/platform/frameworks/base/+/master/services/core/java/com/android/server/am/ActivityManagerService.java)\n\nstartActivity()\n~~~ Java\nfinal int startActivity(Intent intent, ActivityStackSupervisor.ActivityContainer container)\n\n@Override\npublic int startActivity(IBinder whoThread, String callingPackage,\n        Intent intent, String resolvedType, Bundle bOptions)\n\n@Override\npublic final int startActivity(IApplicationThread caller, String callingPackage,\n        Intent intent, String resolvedType, IBinder resultTo, String resultWho, int requestCode,\n        int startFlags, ProfilerInfo profilerInfo, Bundle bOptions)\n~~~\n\nstartActivityAsUser()\n~~~ Java\n@Override\npublic final int startActivityAsUser(IApplicationThread caller, String callingPackage,\n        Intent intent, String resolvedType, IBinder resultTo, String resultWho, int requestCode,\n        int startFlags, ProfilerInfo profilerInfo, Bundle bOptions, int userId) {\n    enforceNotIsolatedCaller(\"startActivity\");\n    userId = mUserController.handleIncomingUser(Binder.getCallingPid(), Binder.getCallingUid(),\n            userId, false, ALLOW_FULL_ONLY, \"startActivity\", null);\n    // TODO: Switch to user app stacks here.\n    return mActivityStarter.startActivityMayWait(caller, -1, callingPackage, intent,\n            resolvedType, null, null, resultTo, resultWho, requestCode, startFlags,\n            profilerInfo, null, null, bOptions, false, userId, null, null);\n}\n~~~\n\nmActivityStarterActivityManagerService\n~~~ Java\npublic ActivityManagerService(Context systemContext) {\n    //...\n    mStackSupervisor = new ActivityStackSupervisor(this);\n    mActivityStarter = new ActivityStarter(this, mStackSupervisor);\n    //...\n}\n~~~\nActiviStarterActivityStackActivityStackSupervisor\n\nActivityStarter.startActivityMayWait()-> ActivityStarter.startActivityLocked()-> ActivityStarter.startActivityUnchecked()-> ActivityStackSupervisor.resumeFocusedStackTopActivityLocked()\n\nActivityStackSupervisor\n\nresumeFocusedStackTopActivityLocked()-> resumeFocusedStackTopActivityLocked()-> resumeTopActivityUncheckedLocked()\n-> resumeTopActivityInnerLocked()-> startSpecificActivityLocked()-> realStartActivityLocked()\n\n\n#### IApplicationThread\n\nrealStartActivityLocked()**app.thread.scheduleLaunchActivity()**\n~~~ Java\nfinal boolean realStartActivityLocked(ActivityRecord r, ProcessRecord app,\n            boolean andResume, boolean checkConfig) throws RemoteException {\n\n    //...\n\n    final ActivityStack stack = task.stack;\n    try {\n        //...\n\n        app.forceProcessStateUpTo(mService.mTopProcessState);\n        app.thread.scheduleLaunchActivity(new Intent(r.intent), r.appToken,\n                System.identityHashCode(r), r.info, new Configuration(mService.mConfiguration),\n                new Configuration(task.mOverrideConfig), r.compat, r.launchedFromPackage,\n                task.voiceInteractor, app.repProcState, r.icicle, r.persistentState, results,\n                newIntents, !andResume, mService.isNextTransitionForward(), profilerInfo);\n\n        //...\n    } catch (RemoteException e) {\n\n    }\n\n    return true;\n}\n~~~\nscheduleLaunchActivity()IApplicationThread\n\nIApplicationThread\n~~~ Java\nprivate class ApplicationThread extends ApplicationThreadNative {}\n\npublic abstract class ApplicationThreadNative extends Binder implements IApplicationThread{}\n\nclass ApplicationThreadProxy implements IApplicationThread {}\n\npublic interface IApplicationThread extends IInterface {}\n~~~\nIApplicationThread[android.googlesource](https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/app/IApplicationThread.java)\n\n> IApplicationThreadIInterfaceBindersystem_process\nApplicationThreadProxyApplicationThreadNative\n\nApplicationThreadProxyscheduleLaunchActivity()\n~~~ Java\npublic final void scheduleLaunchActivity(Intent intent, IBinder token, int ident,\n        ActivityInfo info, Configuration curConfig, Configuration overrideConfig,\n        CompatibilityInfo compatInfo, String referrer, IVoiceInteractor voiceInteractor,\n        int procState, Bundle state, PersistableBundle persistentState,\n        List<ResultInfo> pendingResults, List<ReferrerIntent> pendingNewIntents,\n        boolean notResumed, boolean isForward, ProfilerInfo profilerInfo) throws RemoteException {\n    Parcel data = Parcel.obtain();\n    data.writeInterfaceToken(IApplicationThread.descriptor);\n\n    //....\n\n    mRemote.transact(SCHEDULE_LAUNCH_ACTIVITY_TRANSACTION, data, null,\n            IBinder.FLAG_ONEWAY);\n    data.recycle();\n}\n~~~\nSCHEDULE_LAUNCH_ACTIVITY_TRANSACTIONApplicationThreadNativeonTransact()\n\n> mRemote.transact()onTransact()system_processAppfoo.bar.multi\n\n~~~ Java\n//onTransact()\ncase SCHEDULE_LAUNCH_ACTIVITY_TRANSACTION:\n    {\n        data.enforceInterface(IApplicationThread.descriptor);\n        // \n        scheduleLaunchActivity(intent, b, ident, info, curConfig, overrideConfig, compatInfo,\n                referrer, voiceInteractor, procState, state, persistentState, ri, pi,\n                notResumed, isForward, profilerInfo);\n        return true;\n    }\n~~~\nscheduleLaunchActivity()\n\n> cheduleLaunchActivity()ApplicationThreadServiceApplicationThreadXXXServiceApplicationThreadNativeActivityThread\n\nIApplicationThreadBinder\n\nApplicationThread <=====Binder<===== ApplicationThreadProxy\nIActivityManager\nActivityManagerProxy =====>Binder=====> ActivityManagerService\n**Binder**\n\nBinder\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/ams_binder_process.png)\n\nApplicationThreadscheduleLaunchActivity()\n~~~ Java\n// we use token to identify this activity without having to send the\n// activity itself back to the activity manager. (matters more with ipc)\n@Override\npublic final void scheduleLaunchActivity(Intent intent, IBinder token, int ident,\n        ActivityInfo info, Configuration curConfig, Configuration overrideConfig,\n        CompatibilityInfo compatInfo, String referrer, IVoiceInteractor voiceInteractor,\n        int procState, Bundle state, PersistableBundle persistentState,\n        List<ResultInfo> pendingResults, List<ReferrerIntent> pendingNewIntents,\n        boolean notResumed, boolean isForward, ProfilerInfo profilerInfo) {\n\n    updateProcessState(procState, false);\n    ActivityClientRecord r = new ActivityClientRecord();\n\n    r.token = token;\n    r.ident = ident;\n    r.intent = intent;\n    r.referrer = referrer;\n    r.voiceInteractor = voiceInteractor;\n    r.activityInfo = info;\n    r.compatInfo = compatInfo;\n    r.state = state;\n    r.persistentState = persistentState;\n\n    r.pendingResults = pendingResults;\n    r.pendingIntents = pendingNewIntents;\n\n    r.startsNotResumed = notResumed;\n    r.isForward = isForward;\n\n    r.profilerInfo = profilerInfo;\n\n    r.overrideConfig = overrideConfig;\n    updatePendingConfiguration(curConfig);\n\n    sendMessage(H.LAUNCH_ACTIVITY, r);\n}\n~~~\n\n\nHHHandler\n~~~ Java\npublic void handleMessage(Message msg) {\n    if (DEBUG_MESSAGES) Slog.v(TAG, \">>> handling: \" + codeToString(msg.what));\n    switch (msg.what) {\n        case LAUNCH_ACTIVITY: {\n            Trace.traceBegin(Trace.TRACE_TAG_ACTIVITY_MANAGER, \"activityStart\");\n            final ActivityClientRecord r = (ActivityClientRecord) msg.obj;\n\n            r.packageInfo = getPackageInfoNoCheck(\n                  r.activityInfo.applicationInfo, r.compatInfo);\n            handleLaunchActivity(r, null, \"LAUNCH_ACTIVITY\");\n            Trace.traceEnd(Trace.TRACE_TAG_ACTIVITY_MANAGER);\n        } break;\n\n    //....\n~~~\nhandleLaunchActivity()->performLaunchActivity()\n\nperformLaunchActivity()ClassLoaderActivity\n~~~ Java\n    Activity activity = null;\n    try {\n        //ClassLoaderfoo.bar.multi.XXXActivity\n        java.lang.ClassLoader cl = r.packageInfo.getClassLoader();\n        activity = mInstrumentation.newActivity(\n                cl, component.getClassName(), r.intent);\n        StrictMode.incrementExpectedActivityCount(activity.getClass());\n        r.intent.setExtrasClassLoader(cl);\n        r.intent.prepareToEnterProcess();\n        if (r.state != null) {\n            r.state.setClassLoader(cl);\n        }\n    } catch (Exception e) {\n        if (!mInstrumentation.onException(activity, e)) {\n            throw new RuntimeException(\n                \"Unable to instantiate activity \" + component\n                + \": \" + e.toString(), e);\n\n\n    try {\n        //ApplicationAndroidManifest.xmlApplication\n        Application app = r.packageInfo.makeApplication(false, mInstrumentation);\n\n        //ActivityattachXXXActivity\n        if (activity != null) {\n          activity.attach(appContext, this, getInstrumentation(), r.token,\n          r.ident, app, r.intent, r.activityInfo, title, r.parent,\n          r.embeddedID, r.lastNonConfigurationInstances, config,\n          r.referrer, r.voiceInteractor, window);\n\n        //activityonCreate\n        mInstrumentation.callActivityOnCreate(activity, r.state);\n\n~~~\n\n\nActivityActivitystartActivityActivityActivityManagerServiceAndroidActivityManagerServiceActivityServiceActivityService\n\nAndroidActivityManagerServiceActivity\n\n![http://blog.csdn.net/luoshengyang/article/details/6685853](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/activity-start-process.png)\n\nActivityManagerServiceActivityStackApplicationThreadActivityThreadActivityManagerServiceActivityActivityManagerServiceActivityStackActivityActivityThreadActivityThreadApplicationThreadBinder\n\n\n\n- Step 1. LauncherActivityActivitystartActivityActivityBinderActivityManagerServiceActivityManagerService.startActivity\n- Step 2. ActivityManagerServiceActivityStack.startActivityMayWaitActivity\n- Step 3. ActivityStackApplicationThreadActivityApplicationThreadActivityManagerService.startActivityLauncherActivitystartActivityActivity\n- Step 4. ApplicationThreadActivityManagerService.activityPausedActivityManagerServiceActivity\n- Step 5. ActivityActivityManagerServicestartProcessLockedActivitystartActivityActivityActivityActivity\n- Step 6. ActivityManagerServicApplicationThread.scheduleLaunchActivityActivity\n- Step 7. ApplicationThreadActivityActivityThreadActivityThreadClassLoaderActivity\n\n\n### LauncherActivity\nAndroidLauncherActivity.startActivity()ActivityStackSupervisor.startSpecificActivityLocked()\n~~~ Java\nvoid startSpecificActivityLocked(ActivityRecord r,\n        boolean andResume, boolean checkConfig) {\n    // Is this activity's application already running?\n    ProcessRecord app = mService.getProcessRecordLocked(r.processName,\n            r.info.applicationInfo.uid, true);\n\n    r.task.stack.setLaunchTime(r);\n\n    //Launcherappnullappnull\n    if (app != null && app.thread != null) {\n        try {\n            if ((r.info.flags&ActivityInfo.FLAG_MULTIPROCESS) == 0\n                    || !\"android\".equals(r.info.packageName)) {\n                // Don't add this if it is a platform component that is marked\n                // to run in multiple processes, because this is actually\n                // part of the framework so doesn't make sense to track as a\n                // separate apk in the process.\n                app.addPackage(r.info.packageName, r.info.applicationInfo.versionCode,\n                        mService.mProcessStats);\n            }\n            realStartActivityLocked(r, app, andResume, checkConfig);\n            return;\n        } catch (RemoteException e) {\n            Slog.w(TAG, \"Exception when starting activity \"\n                    + r.intent.getComponent().flattenToShortString(), e);\n        }\n          // If a dead object exception was thrown -- fall through to\n        // restart the application.\n    }\n    //ActivityServiceManager\n    mService.startProcessLocked(r.processName, r.info.applicationInfo, true, 0,\n            \"activity\", r.intent.getComponent(), false, false, true);\n}\n~~~\n> uiduid + processProcessRecorduidpackageAndroidManifest.xml applicationactivityprocessActivity\n\nmService.startProcessLocked()\n~~~ Java\nProcess.ProcessStartResult startResult = Process.start(entryPoint,\n                app.processName, uid, uid, gids, debugFlags, mountExternal,\n                app.info.targetSdkVersion, app.info.seinfo, requiredAbi, instructionSet,\n                app.info.dataDir, entryPointArgs);\n~~~\nandroid.app.ActivityThread mainmainActivityThread\n\nmainattachattach\n~~~ Java\nprivate void attach(boolean system) {\n    //...\n    final IActivityManager mgr = ActivityManagerNative.getDefault();\n    try {\n        mgr.attachApplication(mAppThread);\n    } catch (RemoteException ex) {\n        throw ex.rethrowFromSystemServer();\n    }\n    //...\n}\n~~~\n\nActivityManagerServiceattachApplication()ttachApplicationLocked()\n~~~ Java\nprivate final boolean attachApplicationLocked(IApplicationThread thread,\n        int pid) {\n    //...\n    // See if the top visible activity is waiting to run in this process...\n    if (normalMode) {\n        try {\n            if (mStackSupervisor.attachApplicationLocked(app)) {\n                didSomething = true;\n            }\n        } catch (Exception e) {\n            Slog.wtf(TAG, \"Exception thrown launching activities in \" + app, e);\n            badApp = true;\n        }\n    }\n    // Find any services that should be running in this process...\n    if (!badApp) {\n        try {\n            didSomething |= mServices.attachApplicationLocked(app, processName);\n        } catch (Exception e) {\n            Slog.wtf(TAG, \"Exception thrown starting services in \" + app, e);\n            badApp = true;\n        }\n    }\n    // Check if a next-broadcast receiver is in this process...\n    if (!badApp && isPendingBroadcastProcessLocked(pid)) {\n        try {\n            didSomething |= sendPendingBroadcastsLocked(app);\n        } catch (Exception e) {\n            // If the app died trying to launch the receiver we declare it 'bad'\n            Slog.wtf(TAG, \"Exception thrown dispatching broadcasts in \" + app, e);\n            badApp = true;\n        }\n    }\n    //...\n~~~\nActivityStackSupervisorattachApplicationLocked()attachApplicationLocked()realStartActivityLocked()\n\nActivity\n\n\n### \n[Android-Activity](http://blog.csdn.net/singwhatiwanna/article/details/18154335)\n\n[AndroidActivity](http://blog.csdn.net/luoshengyang/article/details/6685853) [Android](http://blog.csdn.net/luoshengyang/article/details/6689748)\n\n[FrameworkActivity](http://blog.csdn.net/zhaokaiqiang1992/article/details/49428287)\n\n[Android-AMSActivity](\nhttp://www.wjdiankong.cn/android%E7%B3%BB%E7%BB%9F%E7%AF%87%E4%B9%8B-%E8%A7%A3%E8%AF%BBams%E8%BF%9C%E7%AB%AF%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8%E6%9C%BA%E5%88%B6%E4%BB%A5%E5%8F%8Aactivity%E7%9A%84%E5%90%AF%E5%8A%A8/)\n","source":"_posts/2017-08-02-activity-start-process.md","raw":"---\nlayout: post\ntitle:  Activity\ncategory: accumulation\ntags:\n  - AMS\n  - AOSP\n  - Binder\nkeywords: AOSP, AMS, Binder\nbanner: http://obxk8w81b.bkt.clouddn.com/Cottages%20Reminiscence%20of%20the%20North.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Cottages%20Reminiscence%20of%20the%20North.jpg\ntoc: true\n---\n\n## Activity\n\nActivityAndroid[android.googlesource](https://android.googlesource.com/platform/frameworks/base/+/master/)\n\n### \n\n#### zygoteSystemServer\nandroidLinuxlinuxinitfork**zygote** \n\n> App\n- dalvik\n- \n\nAndroidfork**zygote** zygotezygote\n<!--more-->\n\n**SystemServer** zygotefork\nSystemServerActivityManagerServicePackageManagerServiceWindowManagerService\n\n> AppAMS(SystemServer)zygote\nAppAMSBinderIPCAMS(SystemServer)zygoteSocketIPC\n\n\n#### Activity\n\n\n- **ActivityManagerServices**AMSActivity[](https://android.googlesource.com/platform/frameworks/base/services/java/com/android/server/am/ActivityManagerService.java)\n\n- **ActivityThread**AppAppmain()UIActivityManagerServicesActivity\n\n- **ApplicationThread**ActivityManagerServiceActivityThreadActivityManagerServiceApplicationActivityApplicationThreadActivityThread\n\n- **ApplicationThreadProxy**ApplicationThreadApplicationThreadAMSActivityThread\n\n- **Instrumentation**InstrumentationActivityInstrumentationActivityThreadActivityInstrumentation\n\n- **ActivityStack**ActivityAMSActivityActivityStack\n\n- **ActivityRecord**ActivityStackActivityAMSActivityRecordActivityProcessStateCurentStateActivity\n\n- **TaskRecord**AMSActivityRecordTaskActivityRecordAMSTaskRecordActivityActivity4launchMode\n\n- **ProcessRecord**\n\n#### App\nActivityActivity.startActivity():\n\n> appfoo.bar.multisystem_processapp\n\n~~~ Java\n@Override\npublic void startActivity(Intent intent) {\n    this.startActivity(intent, null);\n}\n\n@Override\npublic void startActivity(Intent intent, @Nullable Bundle options) {\n    if (options != null) { //optionsnull\n        startActivityForResult(intent, -1, options);\n    } else {\n        // Note we want to go through this call for compatibility with\n        // applications that may have overridden the method.\n        startActivityForResult(intent, -1);\n    }\n}\n\npublic void startActivityForResult(@RequiresPermission Intent intent, int requestCode,\n        @Nullable Bundle options) {\n    if (mParent == null) { //mParent\n        options = transferSpringboardActivityOptions(options);\n        Instrumentation.ActivityResult ar =\n            mInstrumentation.execStartActivity(\n                this, mMainThread.getApplicationThread(), mToken, this,\n                intent, requestCode, options);\n        if (ar != null) {\n            mMainThread.sendActivityResult(\n                mToken, mEmbeddedID, requestCode, ar.getResultCode(),\n                ar.getResultData());\n        }\n\n        // ....\n    } else {\n        // ....\n    }\n}\n~~~\nmMainThreadActivityThreadActivityThreadmain\n\n~~~ Java\npublic static void main(String[] args) {\n    //...\n}\n~~~\nAndroid[android.googlesource](https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/app/ActivityThread.java)main\n\nmInstrumentationActivityattach()\n\n#### InstrumentationActivityThread\n\nmInstrumentation.execStartActivity()\n~~~ Java\npublic ActivityResult execStartActivity(\n          Context who, IBinder contextThread, IBinder token, Activity target,\n          Intent intent, int requestCode, Bundle options)\n\n\npublic ActivityResult execStartActivity(\n         Context who, IBinder contextThread, IBinder token, String target,\n         Intent intent, int requestCode, Bundle options)\n\npublic ActivityResult execStartActivity(\n         Context who, IBinder contextThread, IBinder token, Activity target,\n         Intent intent, int requestCode, Bundle options, UserHandle user)\n~~~\nmInstrumentation.execStartActivity()\n~~~ Java\npublic ActivityResult execStartActivity(Context who, IBinder contextThread, IBinder token, Activity target,\n        Intent intent, int requestCode, Bundle options) {\n    IApplicationThread whoThread = (IApplicationThread) contextThread;\n        //...ignore some code...\n  try {\n        intent.migrateExtraStreamToClipData();\n        intent.prepareToLeaveProcess();\n        int result = ActivityManagerNative.getDefault()\n            .startActivity(whoThread, who.getBasePackageName(), intent,\n                    intent.resolveTypeIfNeeded(who.getContentResolver()),\n                    token, target != null ? target.mEmbeddedID : null,\n                    requestCode, 0, null, options);\n        checkStartActivityResult(result, intent);\n    } catch (RemoteException e) {\n    }\n    return null;\n}\n~~~\nexecStartActivity()ActivityManagerNativestartActivity()ActivityManagerNative[Android Binder](https://agehua.github.io/2017/07/10/android-binder-principle2/)ServiceManagerNativeBinder\n\nActivityManagerNativeInstrumentation\n\nInstrumentationActivityInstrumentationInstrumentation\n\nInstrumentationApplicationActivityApplicationActivity\n\ncallActivityOnCreate()\n~~~ Java\npublic void callActivityOnCreate(Activity activity, Bundle icicle) {\n    prePerformCreate(activity);\n    activity.performCreate(icicle);\n    postPerformCreate(activity);\n}\n~~~\nactivity.performCreate(icicle);ActivityonCreate()Activity.performCreate()\n~~~ Java\nfinal void performCreate(Bundle icicle) {\n    onCreate(icicle);\n    mActivityTransitionState.readState(icicle);\n    performCreateCommon();\n}\n~~~\nonCreateInstrumentation\n\nInstrumentationActivityActivity\nActivityActivityThread\n\nActivityThreadUIUIAppAMSBinderActivityThreadAMSInstrumentationActivityThread\n\nAMSActivityThreadAMSInstrumentationActivityThread\n\n#### AMSActivityThreadBinder\n[Android Binder](https://agehua.github.io/2017/07/08/android-binder-principle/)[Android Binder](https://agehua.github.io/2017/07/10/android-binder-principle2/)AndroidBinderActivityThreadAppAMS\n\nActivity.startActivity()\n**mInstrumentation.execStartActivity()**\n\n~~~ Java\nActivityManagerNative.getDefault().startActivity()\n~~~\n> startActivity()IActivityManagerIActivityManagerIInterfaceAIDL\n\nActivityManagerNative.getDefault()ActivityManagerServiceActivityManagerProxy\n~~~ Java\npublic abstract class ActivityManagerNative extends Binder implements IActivityManager\n{\n\n //ActivityManagerNativeBinderIActivityManager\n static public IActivityManager getDefault() {\n        return gDefault.get();\n }\n\n//ActivityManagerProxy\nstatic public IActivityManager asInterface(IBinder obj) {\n        if (obj == null) {\n            return null;\n        }\n        IActivityManager in =\n            (IActivityManager)obj.queryLocalInterface(descriptor);\n        if (in != null) {\n            return in;\n        }\n\n        //BinderobjActivityManagerProxymRemoteIPC\n        return new ActivityManagerProxy(obj);\n    }\n}\n~~~\n\nActivityManagerNativeStubStubBinderAIDLStubasInterface\n~~~ Java\n//IActivityManagerasInterface(b)\nprivate static final Singleton<IActivityManager> gDefault = new Singleton<IActivityManager>() {\n       protected IActivityManager create() {\n           IBinder b = ServiceManager.getService(\"activity\");\n           if (false) {\n               Log.v(\"ActivityManager\", \"default service binder = \" + b);\n           }\n           IActivityManager am = asInterface(b);\n           if (false) {\n               Log.v(\"ActivityManager\", \"default service = \" + am);\n           }\n           return am;\n       }\n   };\n}\n~~~\ngDefalutSingletonServiceManagerAMSBinderasInterfaceActivityManagerProxyActivityManagerNativestartActivityActivityManagerProxy\n\nIPCBindertransact()ParcelAMS\n\n> startActivity()ActivityManagerProxyAppfoo.bar.multi\n\n~~~ Java\npublic int startActivity(IApplicationThread caller, String callingPackage, Intent intent,\n        String resolvedType, IBinder resultTo, String resultWho, int requestCode,\n        int startFlags, ProfilerInfo profilerInfo, Bundle options) throws RemoteException {\n    Parcel data = Parcel.obtain();\n    Parcel reply = Parcel.obtain();\n    data.writeInterfaceToken(IActivityManager.descriptor);\n    data.writeStrongBinder(caller != null ? caller.asBinder() : null);\n    data.writeString(callingPackage);\n    intent.writeToParcel(data, 0);\n    //...\n    mRemote.transact(START_ACTIVITY_TRANSACTION, data, reply, 0);\n    reply.readException();\n    int result = reply.readInt();\n    reply.recycle();\n    data.recycle();\n    return result;\n}\n~~~\n      \n\n> BinderServerClientProxyServerClientServerClient\n\nActivityManagerProxy =====>Binder=====> ActivityManagerService\n\nBinderActivityManagerServicesstartActivity()START_ACTIVITY_TRANSACTION\n\ntransact()mRemote.transact()ActivityManagerNativeonTransact\n>  ActivityManagerNativeonTransactsystem_processdebugmonitor\n\n~~~ Java\n@Override\npublic boolean onTransact(int code, Parcel data, Parcel reply, int flags)\n        throws RemoteException {\n    switch (code) {\n    case START_ACTIVITY_TRANSACTION:\n    {   //case\n        data.enforceInterface(IActivityManager.descriptor);\n        IBinder b = data.readStrongBinder();\n        IApplicationThread app = ApplicationThreadNative.asInterface(b);\n        String callingPackage = data.readString();\n        Intent intent = Intent.CREATOR.createFromParcel(data);\n        String resolvedType = data.readString();\n        IBinder resultTo = data.readStrongBinder();\n        String resultWho = data.readString();\n        int requestCode = data.readInt();\n        int startFlags = data.readInt();\n        ProfilerInfo profilerInfo = data.readInt() != 0\n                ? ProfilerInfo.CREATOR.createFromParcel(data) : null;\n        Bundle options = data.readInt() != 0\n                ? Bundle.CREATOR.createFromParcel(data) : null;\n        int result = startActivity(app, callingPackage, intent, resolvedType,\n                resultTo, resultWho, requestCode, startFlags, profilerInfo, options);\n        reply.writeNoException();\n        reply.writeInt(result);\n        return true;\n    }\n    //...\n}\n~~~\nstartActivityIActivityManagerActivityManagerProxyActivityManagerService[android.googlesource](https://android.googlesource.com/platform/frameworks/base/+/master/services/core/java/com/android/server/am/ActivityManagerService.java)\n\nstartActivity()\n~~~ Java\nfinal int startActivity(Intent intent, ActivityStackSupervisor.ActivityContainer container)\n\n@Override\npublic int startActivity(IBinder whoThread, String callingPackage,\n        Intent intent, String resolvedType, Bundle bOptions)\n\n@Override\npublic final int startActivity(IApplicationThread caller, String callingPackage,\n        Intent intent, String resolvedType, IBinder resultTo, String resultWho, int requestCode,\n        int startFlags, ProfilerInfo profilerInfo, Bundle bOptions)\n~~~\n\nstartActivityAsUser()\n~~~ Java\n@Override\npublic final int startActivityAsUser(IApplicationThread caller, String callingPackage,\n        Intent intent, String resolvedType, IBinder resultTo, String resultWho, int requestCode,\n        int startFlags, ProfilerInfo profilerInfo, Bundle bOptions, int userId) {\n    enforceNotIsolatedCaller(\"startActivity\");\n    userId = mUserController.handleIncomingUser(Binder.getCallingPid(), Binder.getCallingUid(),\n            userId, false, ALLOW_FULL_ONLY, \"startActivity\", null);\n    // TODO: Switch to user app stacks here.\n    return mActivityStarter.startActivityMayWait(caller, -1, callingPackage, intent,\n            resolvedType, null, null, resultTo, resultWho, requestCode, startFlags,\n            profilerInfo, null, null, bOptions, false, userId, null, null);\n}\n~~~\n\nmActivityStarterActivityManagerService\n~~~ Java\npublic ActivityManagerService(Context systemContext) {\n    //...\n    mStackSupervisor = new ActivityStackSupervisor(this);\n    mActivityStarter = new ActivityStarter(this, mStackSupervisor);\n    //...\n}\n~~~\nActiviStarterActivityStackActivityStackSupervisor\n\nActivityStarter.startActivityMayWait()-> ActivityStarter.startActivityLocked()-> ActivityStarter.startActivityUnchecked()-> ActivityStackSupervisor.resumeFocusedStackTopActivityLocked()\n\nActivityStackSupervisor\n\nresumeFocusedStackTopActivityLocked()-> resumeFocusedStackTopActivityLocked()-> resumeTopActivityUncheckedLocked()\n-> resumeTopActivityInnerLocked()-> startSpecificActivityLocked()-> realStartActivityLocked()\n\n\n#### IApplicationThread\n\nrealStartActivityLocked()**app.thread.scheduleLaunchActivity()**\n~~~ Java\nfinal boolean realStartActivityLocked(ActivityRecord r, ProcessRecord app,\n            boolean andResume, boolean checkConfig) throws RemoteException {\n\n    //...\n\n    final ActivityStack stack = task.stack;\n    try {\n        //...\n\n        app.forceProcessStateUpTo(mService.mTopProcessState);\n        app.thread.scheduleLaunchActivity(new Intent(r.intent), r.appToken,\n                System.identityHashCode(r), r.info, new Configuration(mService.mConfiguration),\n                new Configuration(task.mOverrideConfig), r.compat, r.launchedFromPackage,\n                task.voiceInteractor, app.repProcState, r.icicle, r.persistentState, results,\n                newIntents, !andResume, mService.isNextTransitionForward(), profilerInfo);\n\n        //...\n    } catch (RemoteException e) {\n\n    }\n\n    return true;\n}\n~~~\nscheduleLaunchActivity()IApplicationThread\n\nIApplicationThread\n~~~ Java\nprivate class ApplicationThread extends ApplicationThreadNative {}\n\npublic abstract class ApplicationThreadNative extends Binder implements IApplicationThread{}\n\nclass ApplicationThreadProxy implements IApplicationThread {}\n\npublic interface IApplicationThread extends IInterface {}\n~~~\nIApplicationThread[android.googlesource](https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/app/IApplicationThread.java)\n\n> IApplicationThreadIInterfaceBindersystem_process\nApplicationThreadProxyApplicationThreadNative\n\nApplicationThreadProxyscheduleLaunchActivity()\n~~~ Java\npublic final void scheduleLaunchActivity(Intent intent, IBinder token, int ident,\n        ActivityInfo info, Configuration curConfig, Configuration overrideConfig,\n        CompatibilityInfo compatInfo, String referrer, IVoiceInteractor voiceInteractor,\n        int procState, Bundle state, PersistableBundle persistentState,\n        List<ResultInfo> pendingResults, List<ReferrerIntent> pendingNewIntents,\n        boolean notResumed, boolean isForward, ProfilerInfo profilerInfo) throws RemoteException {\n    Parcel data = Parcel.obtain();\n    data.writeInterfaceToken(IApplicationThread.descriptor);\n\n    //....\n\n    mRemote.transact(SCHEDULE_LAUNCH_ACTIVITY_TRANSACTION, data, null,\n            IBinder.FLAG_ONEWAY);\n    data.recycle();\n}\n~~~\nSCHEDULE_LAUNCH_ACTIVITY_TRANSACTIONApplicationThreadNativeonTransact()\n\n> mRemote.transact()onTransact()system_processAppfoo.bar.multi\n\n~~~ Java\n//onTransact()\ncase SCHEDULE_LAUNCH_ACTIVITY_TRANSACTION:\n    {\n        data.enforceInterface(IApplicationThread.descriptor);\n        // \n        scheduleLaunchActivity(intent, b, ident, info, curConfig, overrideConfig, compatInfo,\n                referrer, voiceInteractor, procState, state, persistentState, ri, pi,\n                notResumed, isForward, profilerInfo);\n        return true;\n    }\n~~~\nscheduleLaunchActivity()\n\n> cheduleLaunchActivity()ApplicationThreadServiceApplicationThreadXXXServiceApplicationThreadNativeActivityThread\n\nIApplicationThreadBinder\n\nApplicationThread <=====Binder<===== ApplicationThreadProxy\nIActivityManager\nActivityManagerProxy =====>Binder=====> ActivityManagerService\n**Binder**\n\nBinder\n![](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/ams_binder_process.png)\n\nApplicationThreadscheduleLaunchActivity()\n~~~ Java\n// we use token to identify this activity without having to send the\n// activity itself back to the activity manager. (matters more with ipc)\n@Override\npublic final void scheduleLaunchActivity(Intent intent, IBinder token, int ident,\n        ActivityInfo info, Configuration curConfig, Configuration overrideConfig,\n        CompatibilityInfo compatInfo, String referrer, IVoiceInteractor voiceInteractor,\n        int procState, Bundle state, PersistableBundle persistentState,\n        List<ResultInfo> pendingResults, List<ReferrerIntent> pendingNewIntents,\n        boolean notResumed, boolean isForward, ProfilerInfo profilerInfo) {\n\n    updateProcessState(procState, false);\n    ActivityClientRecord r = new ActivityClientRecord();\n\n    r.token = token;\n    r.ident = ident;\n    r.intent = intent;\n    r.referrer = referrer;\n    r.voiceInteractor = voiceInteractor;\n    r.activityInfo = info;\n    r.compatInfo = compatInfo;\n    r.state = state;\n    r.persistentState = persistentState;\n\n    r.pendingResults = pendingResults;\n    r.pendingIntents = pendingNewIntents;\n\n    r.startsNotResumed = notResumed;\n    r.isForward = isForward;\n\n    r.profilerInfo = profilerInfo;\n\n    r.overrideConfig = overrideConfig;\n    updatePendingConfiguration(curConfig);\n\n    sendMessage(H.LAUNCH_ACTIVITY, r);\n}\n~~~\n\n\nHHHandler\n~~~ Java\npublic void handleMessage(Message msg) {\n    if (DEBUG_MESSAGES) Slog.v(TAG, \">>> handling: \" + codeToString(msg.what));\n    switch (msg.what) {\n        case LAUNCH_ACTIVITY: {\n            Trace.traceBegin(Trace.TRACE_TAG_ACTIVITY_MANAGER, \"activityStart\");\n            final ActivityClientRecord r = (ActivityClientRecord) msg.obj;\n\n            r.packageInfo = getPackageInfoNoCheck(\n                  r.activityInfo.applicationInfo, r.compatInfo);\n            handleLaunchActivity(r, null, \"LAUNCH_ACTIVITY\");\n            Trace.traceEnd(Trace.TRACE_TAG_ACTIVITY_MANAGER);\n        } break;\n\n    //....\n~~~\nhandleLaunchActivity()->performLaunchActivity()\n\nperformLaunchActivity()ClassLoaderActivity\n~~~ Java\n    Activity activity = null;\n    try {\n        //ClassLoaderfoo.bar.multi.XXXActivity\n        java.lang.ClassLoader cl = r.packageInfo.getClassLoader();\n        activity = mInstrumentation.newActivity(\n                cl, component.getClassName(), r.intent);\n        StrictMode.incrementExpectedActivityCount(activity.getClass());\n        r.intent.setExtrasClassLoader(cl);\n        r.intent.prepareToEnterProcess();\n        if (r.state != null) {\n            r.state.setClassLoader(cl);\n        }\n    } catch (Exception e) {\n        if (!mInstrumentation.onException(activity, e)) {\n            throw new RuntimeException(\n                \"Unable to instantiate activity \" + component\n                + \": \" + e.toString(), e);\n\n\n    try {\n        //ApplicationAndroidManifest.xmlApplication\n        Application app = r.packageInfo.makeApplication(false, mInstrumentation);\n\n        //ActivityattachXXXActivity\n        if (activity != null) {\n          activity.attach(appContext, this, getInstrumentation(), r.token,\n          r.ident, app, r.intent, r.activityInfo, title, r.parent,\n          r.embeddedID, r.lastNonConfigurationInstances, config,\n          r.referrer, r.voiceInteractor, window);\n\n        //activityonCreate\n        mInstrumentation.callActivityOnCreate(activity, r.state);\n\n~~~\n\n\nActivityActivitystartActivityActivityActivityManagerServiceAndroidActivityManagerServiceActivityServiceActivityService\n\nAndroidActivityManagerServiceActivity\n\n![http://blog.csdn.net/luoshengyang/article/details/6685853](http://oui2w5whj.bkt.clouddn.com/blogimages/2017/activity-start-process.png)\n\nActivityManagerServiceActivityStackApplicationThreadActivityThreadActivityManagerServiceActivityActivityManagerServiceActivityStackActivityActivityThreadActivityThreadApplicationThreadBinder\n\n\n\n- Step 1. LauncherActivityActivitystartActivityActivityBinderActivityManagerServiceActivityManagerService.startActivity\n- Step 2. ActivityManagerServiceActivityStack.startActivityMayWaitActivity\n- Step 3. ActivityStackApplicationThreadActivityApplicationThreadActivityManagerService.startActivityLauncherActivitystartActivityActivity\n- Step 4. ApplicationThreadActivityManagerService.activityPausedActivityManagerServiceActivity\n- Step 5. ActivityActivityManagerServicestartProcessLockedActivitystartActivityActivityActivityActivity\n- Step 6. ActivityManagerServicApplicationThread.scheduleLaunchActivityActivity\n- Step 7. ApplicationThreadActivityActivityThreadActivityThreadClassLoaderActivity\n\n\n### LauncherActivity\nAndroidLauncherActivity.startActivity()ActivityStackSupervisor.startSpecificActivityLocked()\n~~~ Java\nvoid startSpecificActivityLocked(ActivityRecord r,\n        boolean andResume, boolean checkConfig) {\n    // Is this activity's application already running?\n    ProcessRecord app = mService.getProcessRecordLocked(r.processName,\n            r.info.applicationInfo.uid, true);\n\n    r.task.stack.setLaunchTime(r);\n\n    //Launcherappnullappnull\n    if (app != null && app.thread != null) {\n        try {\n            if ((r.info.flags&ActivityInfo.FLAG_MULTIPROCESS) == 0\n                    || !\"android\".equals(r.info.packageName)) {\n                // Don't add this if it is a platform component that is marked\n                // to run in multiple processes, because this is actually\n                // part of the framework so doesn't make sense to track as a\n                // separate apk in the process.\n                app.addPackage(r.info.packageName, r.info.applicationInfo.versionCode,\n                        mService.mProcessStats);\n            }\n            realStartActivityLocked(r, app, andResume, checkConfig);\n            return;\n        } catch (RemoteException e) {\n            Slog.w(TAG, \"Exception when starting activity \"\n                    + r.intent.getComponent().flattenToShortString(), e);\n        }\n          // If a dead object exception was thrown -- fall through to\n        // restart the application.\n    }\n    //ActivityServiceManager\n    mService.startProcessLocked(r.processName, r.info.applicationInfo, true, 0,\n            \"activity\", r.intent.getComponent(), false, false, true);\n}\n~~~\n> uiduid + processProcessRecorduidpackageAndroidManifest.xml applicationactivityprocessActivity\n\nmService.startProcessLocked()\n~~~ Java\nProcess.ProcessStartResult startResult = Process.start(entryPoint,\n                app.processName, uid, uid, gids, debugFlags, mountExternal,\n                app.info.targetSdkVersion, app.info.seinfo, requiredAbi, instructionSet,\n                app.info.dataDir, entryPointArgs);\n~~~\nandroid.app.ActivityThread mainmainActivityThread\n\nmainattachattach\n~~~ Java\nprivate void attach(boolean system) {\n    //...\n    final IActivityManager mgr = ActivityManagerNative.getDefault();\n    try {\n        mgr.attachApplication(mAppThread);\n    } catch (RemoteException ex) {\n        throw ex.rethrowFromSystemServer();\n    }\n    //...\n}\n~~~\n\nActivityManagerServiceattachApplication()ttachApplicationLocked()\n~~~ Java\nprivate final boolean attachApplicationLocked(IApplicationThread thread,\n        int pid) {\n    //...\n    // See if the top visible activity is waiting to run in this process...\n    if (normalMode) {\n        try {\n            if (mStackSupervisor.attachApplicationLocked(app)) {\n                didSomething = true;\n            }\n        } catch (Exception e) {\n            Slog.wtf(TAG, \"Exception thrown launching activities in \" + app, e);\n            badApp = true;\n        }\n    }\n    // Find any services that should be running in this process...\n    if (!badApp) {\n        try {\n            didSomething |= mServices.attachApplicationLocked(app, processName);\n        } catch (Exception e) {\n            Slog.wtf(TAG, \"Exception thrown starting services in \" + app, e);\n            badApp = true;\n        }\n    }\n    // Check if a next-broadcast receiver is in this process...\n    if (!badApp && isPendingBroadcastProcessLocked(pid)) {\n        try {\n            didSomething |= sendPendingBroadcastsLocked(app);\n        } catch (Exception e) {\n            // If the app died trying to launch the receiver we declare it 'bad'\n            Slog.wtf(TAG, \"Exception thrown dispatching broadcasts in \" + app, e);\n            badApp = true;\n        }\n    }\n    //...\n~~~\nActivityStackSupervisorattachApplicationLocked()attachApplicationLocked()realStartActivityLocked()\n\nActivity\n\n\n### \n[Android-Activity](http://blog.csdn.net/singwhatiwanna/article/details/18154335)\n\n[AndroidActivity](http://blog.csdn.net/luoshengyang/article/details/6685853) [Android](http://blog.csdn.net/luoshengyang/article/details/6689748)\n\n[FrameworkActivity](http://blog.csdn.net/zhaokaiqiang1992/article/details/49428287)\n\n[Android-AMSActivity](\nhttp://www.wjdiankong.cn/android%E7%B3%BB%E7%BB%9F%E7%AF%87%E4%B9%8B-%E8%A7%A3%E8%AF%BBams%E8%BF%9C%E7%AB%AF%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8%E6%9C%BA%E5%88%B6%E4%BB%A5%E5%8F%8Aactivity%E7%9A%84%E5%90%AF%E5%8A%A8/)\n","slug":"activity-start-process","published":1,"date":"2017-08-01T16:00:00.000Z","updated":"2017-11-23T07:20:01.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ec1f003rd6ykwzl0gdfa","content":"<h2 id=\"Activity\"><a href=\"#Activity\" class=\"headerlink\" title=\"Activity\"></a>Activity</h2><p>ActivityAndroid<a href=\"https://android.googlesource.com/platform/frameworks/base/+/master/\" target=\"_blank\" rel=\"external\">android.googlesource</a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"zygoteSystemServer\"><a href=\"#zygoteSystemServer\" class=\"headerlink\" title=\"zygoteSystemServer\"></a>zygoteSystemServer</h4><p>androidLinuxlinuxinitfork<strong>zygote</strong> </p>\n<blockquote>\n<p>App</p>\n<ul>\n<li>dalvik</li>\n<li></li>\n</ul>\n</blockquote>\n<p>Androidfork<strong>zygote</strong> zygotezygote<br><a id=\"more\"></a></p>\n<p><strong>SystemServer</strong> zygotefork<br>SystemServerActivityManagerServicePackageManagerServiceWindowManagerService</p>\n<blockquote>\n<p>AppAMS(SystemServer)zygote<br>AppAMSBinderIPCAMS(SystemServer)zygoteSocketIPC</p>\n</blockquote>\n<h4 id=\"Activity\"><a href=\"#Activity\" class=\"headerlink\" title=\"Activity\"></a>Activity</h4><p></p>\n<ul>\n<li><p><strong>ActivityManagerServices</strong>AMSActivity<a href=\"https://android.googlesource.com/platform/frameworks/base/services/java/com/android/server/am/ActivityManagerService.java\" target=\"_blank\" rel=\"external\"></a></p>\n</li>\n<li><p><strong>ActivityThread</strong>AppAppmain()UIActivityManagerServicesActivity</p>\n</li>\n<li><p><strong>ApplicationThread</strong>ActivityManagerServiceActivityThreadActivityManagerServiceApplicationActivityApplicationThreadActivityThread</p>\n</li>\n<li><p><strong>ApplicationThreadProxy</strong>ApplicationThreadApplicationThreadAMSActivityThread</p>\n</li>\n<li><p><strong>Instrumentation</strong>InstrumentationActivityInstrumentationActivityThreadActivityInstrumentation</p>\n</li>\n<li><p><strong>ActivityStack</strong>ActivityAMSActivityActivityStack</p>\n</li>\n<li><p><strong>ActivityRecord</strong>ActivityStackActivityAMSActivityRecordActivityProcessStateCurentStateActivity</p>\n</li>\n<li><p><strong>TaskRecord</strong>AMSActivityRecordTaskActivityRecordAMSTaskRecordActivityActivity4launchMode</p>\n</li>\n<li><p><strong>ProcessRecord</strong></p>\n</li>\n</ul>\n<h4 id=\"App\"><a href=\"#App\" class=\"headerlink\" title=\"App\"></a>App</h4><p>ActivityActivity.startActivity():</p>\n<blockquote>\n<p>appfoo.bar.multisystem_processapp</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">startActivity</span><span class=\"params\">(Intent intent)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">this</span>.startActivity(intent, <span class=\"keyword\">null</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">startActivity</span><span class=\"params\">(Intent intent, @Nullable Bundle options)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (options != <span class=\"keyword\">null</span>) &#123; <span class=\"comment\">//optionsnull</span></div><div class=\"line\">        startActivityForResult(intent, -<span class=\"number\">1</span>, options);</div><div class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">        <span class=\"comment\">// Note we want to go through this call for compatibility with</span></div><div class=\"line\">        <span class=\"comment\">// applications that may have overridden the method.</span></div><div class=\"line\">        startActivityForResult(intent, -<span class=\"number\">1</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">startActivityForResult</span><span class=\"params\">(@RequiresPermission Intent intent, <span class=\"keyword\">int</span> requestCode,</span></span></div><div class=\"line\">        @Nullable Bundle options) &#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (mParent == <span class=\"keyword\">null</span>) &#123; <span class=\"comment\">//mParent</span></div><div class=\"line\">        options = transferSpringboardActivityOptions(options);</div><div class=\"line\">        Instrumentation.ActivityResult ar =</div><div class=\"line\">            mInstrumentation.execStartActivity(</div><div class=\"line\">                <span class=\"keyword\">this</span>, mMainThread.getApplicationThread(), mToken, <span class=\"keyword\">this</span>,</div><div class=\"line\">                intent, requestCode, options);</div><div class=\"line\">        <span class=\"keyword\">if</span> (ar != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            mMainThread.sendActivityResult(</div><div class=\"line\">                mToken, mEmbeddedID, requestCode, ar.getResultCode(),</div><div class=\"line\">                ar.getResultData());</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"comment\">// ....</span></div><div class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">        <span class=\"comment\">// ....</span></div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>mMainThreadActivityThreadActivityThreadmain</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</div><div class=\"line\">    <span class=\"comment\">//...</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>Android<a href=\"https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/app/ActivityThread.java\" target=\"_blank\" rel=\"external\">android.googlesource</a>main</p>\n<p>mInstrumentationActivityattach()</p>\n<h4 id=\"InstrumentationActivityThread\"><a href=\"#InstrumentationActivityThread\" class=\"headerlink\" title=\"InstrumentationActivityThread\"></a>InstrumentationActivityThread</h4><p>mInstrumentation.execStartActivity()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> ActivityResult <span class=\"title\">execStartActivity</span><span class=\"params\">(</span></span></div><div class=\"line\">          Context who, IBinder contextThread, IBinder token, Activity target,</div><div class=\"line\">          Intent intent, <span class=\"keyword\">int</span> requestCode, Bundle options)</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">public</span> ActivityResult <span class=\"title\">execStartActivity</span><span class=\"params\">(</span></div><div class=\"line\">         Context who, IBinder contextThread, IBinder token, String target,</div><div class=\"line\">         Intent intent, <span class=\"keyword\">int</span> requestCode, Bundle options)</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">public</span> ActivityResult <span class=\"title\">execStartActivity</span><span class=\"params\">(</span></div><div class=\"line\">         Context who, IBinder contextThread, IBinder token, Activity target,</div><div class=\"line\">         Intent intent, <span class=\"keyword\">int</span> requestCode, Bundle options, UserHandle user)</div></pre></td></tr></table></figure></p>\n<p>mInstrumentation.execStartActivity()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> ActivityResult <span class=\"title\">execStartActivity</span><span class=\"params\">(Context who, IBinder contextThread, IBinder token, Activity target,</span></span></div><div class=\"line\">        Intent intent, <span class=\"keyword\">int</span> requestCode, Bundle options) &#123;</div><div class=\"line\">    IApplicationThread whoThread = (IApplicationThread) contextThread;</div><div class=\"line\">        <span class=\"comment\">//...ignore some code...</span></div><div class=\"line\">  <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">        intent.migrateExtraStreamToClipData();</div><div class=\"line\">        intent.prepareToLeaveProcess();</div><div class=\"line\">        <span class=\"keyword\">int</span> result = ActivityManagerNative.getDefault()</div><div class=\"line\">            .startActivity(whoThread, who.getBasePackageName(), intent,</div><div class=\"line\">                    intent.resolveTypeIfNeeded(who.getContentResolver()),</div><div class=\"line\">                    token, target != <span class=\"keyword\">null</span> ? target.mEmbeddedID : <span class=\"keyword\">null</span>,</div><div class=\"line\">                    requestCode, <span class=\"number\">0</span>, <span class=\"keyword\">null</span>, options);</div><div class=\"line\">        checkStartActivityResult(result, intent);</div><div class=\"line\">    &#125; <span class=\"keyword\">catch</span> (RemoteException e) &#123;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>execStartActivity()ActivityManagerNativestartActivity()ActivityManagerNative<a href=\"https://agehua.github.io/2017/07/10/android-binder-principle2/\">Android Binder</a>ServiceManagerNativeBinder</p>\n<p>ActivityManagerNativeInstrumentation</p>\n<p>InstrumentationActivityInstrumentationInstrumentation</p>\n<p>InstrumentationApplicationActivityApplicationActivity</p>\n<p>callActivityOnCreate()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">callActivityOnCreate</span><span class=\"params\">(Activity activity, Bundle icicle)</span> </span>&#123;</div><div class=\"line\">    prePerformCreate(activity);</div><div class=\"line\">    activity.performCreate(icicle);</div><div class=\"line\">    postPerformCreate(activity);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>activity.performCreate(icicle);ActivityonCreate()Activity.performCreate()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title\">performCreate</span><span class=\"params\">(Bundle icicle)</span> </span>&#123;</div><div class=\"line\">    onCreate(icicle);</div><div class=\"line\">    mActivityTransitionState.readState(icicle);</div><div class=\"line\">    performCreateCommon();</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>onCreateInstrumentation</p>\n<p>InstrumentationActivityActivity<br>ActivityActivityThread</p>\n<p>ActivityThreadUIUIAppAMSBinderActivityThreadAMSInstrumentationActivityThread</p>\n<p>AMSActivityThreadAMSInstrumentationActivityThread</p>\n<h4 id=\"AMSActivityThreadBinder\"><a href=\"#AMSActivityThreadBinder\" class=\"headerlink\" title=\"AMSActivityThreadBinder\"></a>AMSActivityThreadBinder</h4><p><a href=\"https://agehua.github.io/2017/07/08/android-binder-principle/\">Android Binder</a><a href=\"https://agehua.github.io/2017/07/10/android-binder-principle2/\">Android Binder</a>AndroidBinderActivityThreadAppAMS</p>\n<p>Activity.startActivity()<br><strong>mInstrumentation.execStartActivity()</strong><br><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">ActivityManagerNative.getDefault().startActivity()</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>startActivity()IActivityManagerIActivityManagerIInterfaceAIDL</p>\n</blockquote>\n<p>ActivityManagerNative.getDefault()ActivityManagerServiceActivityManagerProxy<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ActivityManagerNative</span> <span class=\"keyword\">extends</span> <span class=\"title\">Binder</span> <span class=\"keyword\">implements</span> <span class=\"title\">IActivityManager</span></span></div><div class=\"line\">&#123;</div><div class=\"line\"></div><div class=\"line\"> <span class=\"comment\">//ActivityManagerNativeBinderIActivityManager</span></div><div class=\"line\"> <span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">public</span> IActivityManager <span class=\"title\">getDefault</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> gDefault.get();</div><div class=\"line\"> &#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">//ActivityManagerProxy</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">public</span> IActivityManager <span class=\"title\">asInterface</span><span class=\"params\">(IBinder obj)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (obj == <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">        &#125;</div><div class=\"line\">        IActivityManager in =</div><div class=\"line\">            (IActivityManager)obj.queryLocalInterface(descriptor);</div><div class=\"line\">        <span class=\"keyword\">if</span> (in != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> in;</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"comment\">//BinderobjActivityManagerProxymRemoteIPC</span></div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> ActivityManagerProxy(obj);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>ActivityManagerNativeStubStubBinderAIDLStubasInterface<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//IActivityManagerasInterface(b)</span></div><div class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Singleton&lt;IActivityManager&gt; gDefault = <span class=\"keyword\">new</span> Singleton&lt;IActivityManager&gt;() &#123;</div><div class=\"line\">       <span class=\"function\"><span class=\"keyword\">protected</span> IActivityManager <span class=\"title\">create</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">           IBinder b = ServiceManager.getService(<span class=\"string\">\"activity\"</span>);</div><div class=\"line\">           <span class=\"keyword\">if</span> (<span class=\"keyword\">false</span>) &#123;</div><div class=\"line\">               Log.v(<span class=\"string\">\"ActivityManager\"</span>, <span class=\"string\">\"default service binder = \"</span> + b);</div><div class=\"line\">           &#125;</div><div class=\"line\">           IActivityManager am = asInterface(b);</div><div class=\"line\">           <span class=\"keyword\">if</span> (<span class=\"keyword\">false</span>) &#123;</div><div class=\"line\">               Log.v(<span class=\"string\">\"ActivityManager\"</span>, <span class=\"string\">\"default service = \"</span> + am);</div><div class=\"line\">           &#125;</div><div class=\"line\">           <span class=\"keyword\">return</span> am;</div><div class=\"line\">       &#125;</div><div class=\"line\">   &#125;;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>gDefalutSingletonServiceManagerAMSBinderasInterfaceActivityManagerProxyActivityManagerNativestartActivityActivityManagerProxy</p>\n<p>IPCBindertransact()ParcelAMS</p>\n<blockquote>\n<p>startActivity()ActivityManagerProxyAppfoo.bar.multi</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">startActivity</span><span class=\"params\">(IApplicationThread caller, String callingPackage, Intent intent,</span></span></div><div class=\"line\">        String resolvedType, IBinder resultTo, String resultWho, <span class=\"keyword\">int</span> requestCode,</div><div class=\"line\">        <span class=\"keyword\">int</span> startFlags, ProfilerInfo profilerInfo, Bundle options) <span class=\"keyword\">throws</span> RemoteException &#123;</div><div class=\"line\">    Parcel data = Parcel.obtain();</div><div class=\"line\">    Parcel reply = Parcel.obtain();</div><div class=\"line\">    data.writeInterfaceToken(IActivityManager.descriptor);</div><div class=\"line\">    data.writeStrongBinder(caller != <span class=\"keyword\">null</span> ? caller.asBinder() : <span class=\"keyword\">null</span>);</div><div class=\"line\">    data.writeString(callingPackage);</div><div class=\"line\">    intent.writeToParcel(data, <span class=\"number\">0</span>);</div><div class=\"line\">    <span class=\"comment\">//...</span></div><div class=\"line\">    mRemote.transact(START_ACTIVITY_TRANSACTION, data, reply, <span class=\"number\">0</span>);</div><div class=\"line\">    reply.readException();</div><div class=\"line\">    <span class=\"keyword\">int</span> result = reply.readInt();</div><div class=\"line\">    reply.recycle();</div><div class=\"line\">    data.recycle();</div><div class=\"line\">    <span class=\"keyword\">return</span> result;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<pre><code>\n</code></pre><blockquote>\n<p>BinderServerClientProxyServerClientServerClient</p>\n</blockquote>\n<p>ActivityManagerProxy =====&gt;Binder=====&gt; ActivityManagerService</p>\n<p>BinderActivityManagerServicesstartActivity()START_ACTIVITY_TRANSACTION</p>\n<p>transact()mRemote.transact()ActivityManagerNativeonTransact</p>\n<blockquote>\n<p> ActivityManagerNativeonTransactsystem_processdebugmonitor</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">onTransact</span><span class=\"params\">(<span class=\"keyword\">int</span> code, Parcel data, Parcel reply, <span class=\"keyword\">int</span> flags)</span></span></div><div class=\"line\">        <span class=\"keyword\">throws</span> RemoteException &#123;</div><div class=\"line\">    <span class=\"keyword\">switch</span> (code) &#123;</div><div class=\"line\">    <span class=\"keyword\">case</span> START_ACTIVITY_TRANSACTION:</div><div class=\"line\">    &#123;   <span class=\"comment\">//case</span></div><div class=\"line\">        data.enforceInterface(IActivityManager.descriptor);</div><div class=\"line\">        IBinder b = data.readStrongBinder();</div><div class=\"line\">        IApplicationThread app = ApplicationThreadNative.asInterface(b);</div><div class=\"line\">        String callingPackage = data.readString();</div><div class=\"line\">        Intent intent = Intent.CREATOR.createFromParcel(data);</div><div class=\"line\">        String resolvedType = data.readString();</div><div class=\"line\">        IBinder resultTo = data.readStrongBinder();</div><div class=\"line\">        String resultWho = data.readString();</div><div class=\"line\">        <span class=\"keyword\">int</span> requestCode = data.readInt();</div><div class=\"line\">        <span class=\"keyword\">int</span> startFlags = data.readInt();</div><div class=\"line\">        ProfilerInfo profilerInfo = data.readInt() != <span class=\"number\">0</span></div><div class=\"line\">                ? ProfilerInfo.CREATOR.createFromParcel(data) : <span class=\"keyword\">null</span>;</div><div class=\"line\">        Bundle options = data.readInt() != <span class=\"number\">0</span></div><div class=\"line\">                ? Bundle.CREATOR.createFromParcel(data) : <span class=\"keyword\">null</span>;</div><div class=\"line\">        <span class=\"keyword\">int</span> result = startActivity(app, callingPackage, intent, resolvedType,</div><div class=\"line\">                resultTo, resultWho, requestCode, startFlags, profilerInfo, options);</div><div class=\"line\">        reply.writeNoException();</div><div class=\"line\">        reply.writeInt(result);</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"comment\">//...</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>startActivityIActivityManagerActivityManagerProxyActivityManagerService<a href=\"https://android.googlesource.com/platform/frameworks/base/+/master/services/core/java/com/android/server/am/ActivityManagerService.java\" target=\"_blank\" rel=\"external\">android.googlesource</a></p>\n<p>startActivity()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">final</span> <span class=\"keyword\">int</span> <span class=\"title\">startActivity</span><span class=\"params\">(Intent intent, ActivityStackSupervisor.ActivityContainer container)</span></span></div><div class=\"line\"></div><div class=\"line\">@Override</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">startActivity</span><span class=\"params\">(IBinder whoThread, String callingPackage,</span></div><div class=\"line\">        Intent intent, String resolvedType, Bundle bOptions)</div><div class=\"line\"></div><div class=\"line\">@Override</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> <span class=\"title\">startActivity</span><span class=\"params\">(IApplicationThread caller, String callingPackage,</span></div><div class=\"line\">        Intent intent, String resolvedType, IBinder resultTo, String resultWho, <span class=\"keyword\">int</span> requestCode,</div><div class=\"line\">        <span class=\"keyword\">int</span> startFlags, ProfilerInfo profilerInfo, Bundle bOptions)</div></pre></td></tr></table></figure></p>\n<p>startActivityAsUser()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> <span class=\"title\">startActivityAsUser</span><span class=\"params\">(IApplicationThread caller, String callingPackage,</span></span></div><div class=\"line\">        Intent intent, String resolvedType, IBinder resultTo, String resultWho, <span class=\"keyword\">int</span> requestCode,</div><div class=\"line\">        <span class=\"keyword\">int</span> startFlags, ProfilerInfo profilerInfo, Bundle bOptions, <span class=\"keyword\">int</span> userId) &#123;</div><div class=\"line\">    enforceNotIsolatedCaller(<span class=\"string\">\"startActivity\"</span>);</div><div class=\"line\">    userId = mUserController.handleIncomingUser(Binder.getCallingPid(), Binder.getCallingUid(),</div><div class=\"line\">            userId, <span class=\"keyword\">false</span>, ALLOW_FULL_ONLY, <span class=\"string\">\"startActivity\"</span>, <span class=\"keyword\">null</span>);</div><div class=\"line\">    <span class=\"comment\">// <span class=\"doctag\">TODO:</span> Switch to user app stacks here.</span></div><div class=\"line\">    <span class=\"keyword\">return</span> mActivityStarter.startActivityMayWait(caller, -<span class=\"number\">1</span>, callingPackage, intent,</div><div class=\"line\">            resolvedType, <span class=\"keyword\">null</span>, <span class=\"keyword\">null</span>, resultTo, resultWho, requestCode, startFlags,</div><div class=\"line\">            profilerInfo, <span class=\"keyword\">null</span>, <span class=\"keyword\">null</span>, bOptions, <span class=\"keyword\">false</span>, userId, <span class=\"keyword\">null</span>, <span class=\"keyword\">null</span>);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>mActivityStarterActivityManagerService<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">ActivityManagerService</span><span class=\"params\">(Context systemContext)</span> </span>&#123;</div><div class=\"line\">    <span class=\"comment\">//...</span></div><div class=\"line\">    mStackSupervisor = <span class=\"keyword\">new</span> ActivityStackSupervisor(<span class=\"keyword\">this</span>);</div><div class=\"line\">    mActivityStarter = <span class=\"keyword\">new</span> ActivityStarter(<span class=\"keyword\">this</span>, mStackSupervisor);</div><div class=\"line\">    <span class=\"comment\">//...</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>ActiviStarterActivityStackActivityStackSupervisor</p>\n<p>ActivityStarter.startActivityMayWait()-&gt; ActivityStarter.startActivityLocked()-&gt; ActivityStarter.startActivityUnchecked()-&gt; ActivityStackSupervisor.resumeFocusedStackTopActivityLocked()</p>\n<p>ActivityStackSupervisor</p>\n<p>resumeFocusedStackTopActivityLocked()-&gt; resumeFocusedStackTopActivityLocked()-&gt; resumeTopActivityUncheckedLocked()<br>-&gt; resumeTopActivityInnerLocked()-&gt; startSpecificActivityLocked()-&gt; realStartActivityLocked()</p>\n<h4 id=\"IApplicationThread\"><a href=\"#IApplicationThread\" class=\"headerlink\" title=\"IApplicationThread\"></a>IApplicationThread</h4><p>realStartActivityLocked()<strong>app.thread.scheduleLaunchActivity()</strong><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">final</span> <span class=\"keyword\">boolean</span> <span class=\"title\">realStartActivityLocked</span><span class=\"params\">(ActivityRecord r, ProcessRecord app,</span></span></div><div class=\"line\">            <span class=\"keyword\">boolean</span> andResume, <span class=\"keyword\">boolean</span> checkConfig) <span class=\"keyword\">throws</span> RemoteException &#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//...</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">final</span> ActivityStack stack = task.stack;</div><div class=\"line\">    <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">        <span class=\"comment\">//...</span></div><div class=\"line\"></div><div class=\"line\">        app.forceProcessStateUpTo(mService.mTopProcessState);</div><div class=\"line\">        app.thread.scheduleLaunchActivity(<span class=\"keyword\">new</span> Intent(r.intent), r.appToken,</div><div class=\"line\">                System.identityHashCode(r), r.info, <span class=\"keyword\">new</span> Configuration(mService.mConfiguration),</div><div class=\"line\">                <span class=\"keyword\">new</span> Configuration(task.mOverrideConfig), r.compat, r.launchedFromPackage,</div><div class=\"line\">                task.voiceInteractor, app.repProcState, r.icicle, r.persistentState, results,</div><div class=\"line\">                newIntents, !andResume, mService.isNextTransitionForward(), profilerInfo);</div><div class=\"line\"></div><div class=\"line\">        <span class=\"comment\">//...</span></div><div class=\"line\">    &#125; <span class=\"keyword\">catch</span> (RemoteException e) &#123;</div><div class=\"line\"></div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>scheduleLaunchActivity()IApplicationThread</p>\n<p>IApplicationThread<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">private</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ApplicationThread</span> <span class=\"keyword\">extends</span> <span class=\"title\">ApplicationThreadNative</span> </span>&#123;&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ApplicationThreadNative</span> <span class=\"keyword\">extends</span> <span class=\"title\">Binder</span> <span class=\"keyword\">implements</span> <span class=\"title\">IApplicationThread</span></span>&#123;&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ApplicationThreadProxy</span> <span class=\"keyword\">implements</span> <span class=\"title\">IApplicationThread</span> </span>&#123;&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">IApplicationThread</span> <span class=\"keyword\">extends</span> <span class=\"title\">IInterface</span> </span>&#123;&#125;</div></pre></td></tr></table></figure></p>\n<p>IApplicationThread<a href=\"https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/app/IApplicationThread.java\" target=\"_blank\" rel=\"external\">android.googlesource</a></p>\n<blockquote>\n<p>IApplicationThreadIInterfaceBindersystem_process<br>ApplicationThreadProxyApplicationThreadNative</p>\n</blockquote>\n<p>ApplicationThreadProxyscheduleLaunchActivity()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title\">scheduleLaunchActivity</span><span class=\"params\">(Intent intent, IBinder token, <span class=\"keyword\">int</span> ident,</span></span></div><div class=\"line\">        ActivityInfo info, Configuration curConfig, Configuration overrideConfig,</div><div class=\"line\">        CompatibilityInfo compatInfo, String referrer, IVoiceInteractor voiceInteractor,</div><div class=\"line\">        <span class=\"keyword\">int</span> procState, Bundle state, PersistableBundle persistentState,</div><div class=\"line\">        List&lt;ResultInfo&gt; pendingResults, List&lt;ReferrerIntent&gt; pendingNewIntents,</div><div class=\"line\">        <span class=\"keyword\">boolean</span> notResumed, <span class=\"keyword\">boolean</span> isForward, ProfilerInfo profilerInfo) <span class=\"keyword\">throws</span> RemoteException &#123;</div><div class=\"line\">    Parcel data = Parcel.obtain();</div><div class=\"line\">    data.writeInterfaceToken(IApplicationThread.descriptor);</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//....</span></div><div class=\"line\"></div><div class=\"line\">    mRemote.transact(SCHEDULE_LAUNCH_ACTIVITY_TRANSACTION, data, <span class=\"keyword\">null</span>,</div><div class=\"line\">            IBinder.FLAG_ONEWAY);</div><div class=\"line\">    data.recycle();</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>SCHEDULE_LAUNCH_ACTIVITY_TRANSACTIONApplicationThreadNativeonTransact()</p>\n<blockquote>\n<p>mRemote.transact()onTransact()system_processAppfoo.bar.multi</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//onTransact()</span></div><div class=\"line\"><span class=\"keyword\">case</span> SCHEDULE_LAUNCH_ACTIVITY_TRANSACTION:</div><div class=\"line\">    &#123;</div><div class=\"line\">        data.enforceInterface(IApplicationThread.descriptor);</div><div class=\"line\">        <span class=\"comment\">// </span></div><div class=\"line\">        scheduleLaunchActivity(intent, b, ident, info, curConfig, overrideConfig, compatInfo,</div><div class=\"line\">                referrer, voiceInteractor, procState, state, persistentState, ri, pi,</div><div class=\"line\">                notResumed, isForward, profilerInfo);</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</div><div class=\"line\">    &#125;</div></pre></td></tr></table></figure>\n<p>scheduleLaunchActivity()</p>\n<blockquote>\n<p>cheduleLaunchActivity()ApplicationThreadServiceApplicationThreadXXXServiceApplicationThreadNativeActivityThread</p>\n</blockquote>\n<p>IApplicationThreadBinder</p>\n<p>ApplicationThread &lt;=====Binder&lt;===== ApplicationThreadProxy<br>IActivityManager<br>ActivityManagerProxy =====&gt;Binder=====&gt; ActivityManagerService<br><strong>Binder</strong></p>\n<p>Binder<br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/ams_binder_process.png\" alt=\"\"></p>\n<p>ApplicationThreadscheduleLaunchActivity()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// we use token to identify this activity without having to send the</span></div><div class=\"line\"><span class=\"comment\">// activity itself back to the activity manager. (matters more with ipc)</span></div><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title\">scheduleLaunchActivity</span><span class=\"params\">(Intent intent, IBinder token, <span class=\"keyword\">int</span> ident,</span></span></div><div class=\"line\">        ActivityInfo info, Configuration curConfig, Configuration overrideConfig,</div><div class=\"line\">        CompatibilityInfo compatInfo, String referrer, IVoiceInteractor voiceInteractor,</div><div class=\"line\">        <span class=\"keyword\">int</span> procState, Bundle state, PersistableBundle persistentState,</div><div class=\"line\">        List&lt;ResultInfo&gt; pendingResults, List&lt;ReferrerIntent&gt; pendingNewIntents,</div><div class=\"line\">        <span class=\"keyword\">boolean</span> notResumed, <span class=\"keyword\">boolean</span> isForward, ProfilerInfo profilerInfo) &#123;</div><div class=\"line\"></div><div class=\"line\">    updateProcessState(procState, <span class=\"keyword\">false</span>);</div><div class=\"line\">    ActivityClientRecord r = <span class=\"keyword\">new</span> ActivityClientRecord();</div><div class=\"line\"></div><div class=\"line\">    r.token = token;</div><div class=\"line\">    r.ident = ident;</div><div class=\"line\">    r.intent = intent;</div><div class=\"line\">    r.referrer = referrer;</div><div class=\"line\">    r.voiceInteractor = voiceInteractor;</div><div class=\"line\">    r.activityInfo = info;</div><div class=\"line\">    r.compatInfo = compatInfo;</div><div class=\"line\">    r.state = state;</div><div class=\"line\">    r.persistentState = persistentState;</div><div class=\"line\"></div><div class=\"line\">    r.pendingResults = pendingResults;</div><div class=\"line\">    r.pendingIntents = pendingNewIntents;</div><div class=\"line\"></div><div class=\"line\">    r.startsNotResumed = notResumed;</div><div class=\"line\">    r.isForward = isForward;</div><div class=\"line\"></div><div class=\"line\">    r.profilerInfo = profilerInfo;</div><div class=\"line\"></div><div class=\"line\">    r.overrideConfig = overrideConfig;</div><div class=\"line\">    updatePendingConfiguration(curConfig);</div><div class=\"line\"></div><div class=\"line\">    sendMessage(H.LAUNCH_ACTIVITY, r);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>HHHandler<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">handleMessage</span><span class=\"params\">(Message msg)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (DEBUG_MESSAGES) Slog.v(TAG, <span class=\"string\">\"&gt;&gt;&gt; handling: \"</span> + codeToString(msg.what));</div><div class=\"line\">    <span class=\"keyword\">switch</span> (msg.what) &#123;</div><div class=\"line\">        <span class=\"keyword\">case</span> LAUNCH_ACTIVITY: &#123;</div><div class=\"line\">            Trace.traceBegin(Trace.TRACE_TAG_ACTIVITY_MANAGER, <span class=\"string\">\"activityStart\"</span>);</div><div class=\"line\">            <span class=\"keyword\">final</span> ActivityClientRecord r = (ActivityClientRecord) msg.obj;</div><div class=\"line\"></div><div class=\"line\">            r.packageInfo = getPackageInfoNoCheck(</div><div class=\"line\">                  r.activityInfo.applicationInfo, r.compatInfo);</div><div class=\"line\">            handleLaunchActivity(r, <span class=\"keyword\">null</span>, <span class=\"string\">\"LAUNCH_ACTIVITY\"</span>);</div><div class=\"line\">            Trace.traceEnd(Trace.TRACE_TAG_ACTIVITY_MANAGER);</div><div class=\"line\">        &#125; <span class=\"keyword\">break</span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//....</span></div></pre></td></tr></table></figure></p>\n<p>handleLaunchActivity()-&gt;performLaunchActivity()</p>\n<p>performLaunchActivity()ClassLoaderActivity<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Activity activity = <span class=\"keyword\">null</span>;</div><div class=\"line\"><span class=\"keyword\">try</span> &#123;</div><div class=\"line\">    <span class=\"comment\">//ClassLoaderfoo.bar.multi.XXXActivity</span></div><div class=\"line\">    java.lang.ClassLoader cl = r.packageInfo.getClassLoader();</div><div class=\"line\">    activity = mInstrumentation.newActivity(</div><div class=\"line\">            cl, component.getClassName(), r.intent);</div><div class=\"line\">    StrictMode.incrementExpectedActivityCount(activity.getClass());</div><div class=\"line\">    r.intent.setExtrasClassLoader(cl);</div><div class=\"line\">    r.intent.prepareToEnterProcess();</div><div class=\"line\">    <span class=\"keyword\">if</span> (r.state != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">        r.state.setClassLoader(cl);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (!mInstrumentation.onException(activity, e)) &#123;</div><div class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> RuntimeException(</div><div class=\"line\">            <span class=\"string\">\"Unable to instantiate activity \"</span> + component</div><div class=\"line\">            + <span class=\"string\">\": \"</span> + e.toString(), e);</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">try</span> &#123;</div><div class=\"line\">    <span class=\"comment\">//ApplicationAndroidManifest.xmlApplication</span></div><div class=\"line\">    Application app = r.packageInfo.makeApplication(<span class=\"keyword\">false</span>, mInstrumentation);</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//ActivityattachXXXActivity</span></div><div class=\"line\">    <span class=\"keyword\">if</span> (activity != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">      activity.attach(appContext, <span class=\"keyword\">this</span>, getInstrumentation(), r.token,</div><div class=\"line\">      r.ident, app, r.intent, r.activityInfo, title, r.parent,</div><div class=\"line\">      r.embeddedID, r.lastNonConfigurationInstances, config,</div><div class=\"line\">      r.referrer, r.voiceInteractor, window);</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//activityonCreate</span></div><div class=\"line\">    mInstrumentation.callActivityOnCreate(activity, r.state);</div></pre></td></tr></table></figure></p>\n<p>ActivityActivitystartActivityActivityActivityManagerServiceAndroidActivityManagerServiceActivityServiceActivityService</p>\n<p>AndroidActivityManagerServiceActivity</p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/activity-start-process.png\" alt=\"http://blog.csdn.net/luoshengyang/article/details/6685853\"></p>\n<p>ActivityManagerServiceActivityStackApplicationThreadActivityThreadActivityManagerServiceActivityActivityManagerServiceActivityStackActivityActivityThreadActivityThreadApplicationThreadBinder</p>\n<p></p>\n<ul>\n<li>Step 1. LauncherActivityActivitystartActivityActivityBinderActivityManagerServiceActivityManagerService.startActivity</li>\n<li>Step 2. ActivityManagerServiceActivityStack.startActivityMayWaitActivity</li>\n<li>Step 3. ActivityStackApplicationThreadActivityApplicationThreadActivityManagerService.startActivityLauncherActivitystartActivityActivity</li>\n<li>Step 4. ApplicationThreadActivityManagerService.activityPausedActivityManagerServiceActivity</li>\n<li>Step 5. ActivityActivityManagerServicestartProcessLockedActivitystartActivityActivityActivityActivity</li>\n<li>Step 6. ActivityManagerServicApplicationThread.scheduleLaunchActivityActivity</li>\n<li>Step 7. ApplicationThreadActivityActivityThreadActivityThreadClassLoaderActivity</li>\n</ul>\n<h3 id=\"LauncherActivity\"><a href=\"#LauncherActivity\" class=\"headerlink\" title=\"LauncherActivity\"></a>LauncherActivity</h3><p>AndroidLauncherActivity.startActivity()ActivityStackSupervisor.startSpecificActivityLocked()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">startSpecificActivityLocked</span><span class=\"params\">(ActivityRecord r,</span></span></div><div class=\"line\">        <span class=\"keyword\">boolean</span> andResume, <span class=\"keyword\">boolean</span> checkConfig) &#123;</div><div class=\"line\">    <span class=\"comment\">// Is this activity's application already running?</span></div><div class=\"line\">    ProcessRecord app = mService.getProcessRecordLocked(r.processName,</div><div class=\"line\">            r.info.applicationInfo.uid, <span class=\"keyword\">true</span>);</div><div class=\"line\"></div><div class=\"line\">    r.task.stack.setLaunchTime(r);</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//Launcherappnullappnull</span></div><div class=\"line\">    <span class=\"keyword\">if</span> (app != <span class=\"keyword\">null</span> &amp;&amp; app.thread != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">        <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">            <span class=\"keyword\">if</span> ((r.info.flags&amp;ActivityInfo.FLAG_MULTIPROCESS) == <span class=\"number\">0</span></div><div class=\"line\">                    || !<span class=\"string\">\"android\"</span>.equals(r.info.packageName)) &#123;</div><div class=\"line\">                <span class=\"comment\">// Don't add this if it is a platform component that is marked</span></div><div class=\"line\">                <span class=\"comment\">// to run in multiple processes, because this is actually</span></div><div class=\"line\">                <span class=\"comment\">// part of the framework so doesn't make sense to track as a</span></div><div class=\"line\">                <span class=\"comment\">// separate apk in the process.</span></div><div class=\"line\">                app.addPackage(r.info.packageName, r.info.applicationInfo.versionCode,</div><div class=\"line\">                        mService.mProcessStats);</div><div class=\"line\">            &#125;</div><div class=\"line\">            realStartActivityLocked(r, app, andResume, checkConfig);</div><div class=\"line\">            <span class=\"keyword\">return</span>;</div><div class=\"line\">        &#125; <span class=\"keyword\">catch</span> (RemoteException e) &#123;</div><div class=\"line\">            Slog.w(TAG, <span class=\"string\">\"Exception when starting activity \"</span></div><div class=\"line\">                    + r.intent.getComponent().flattenToShortString(), e);</div><div class=\"line\">        &#125;</div><div class=\"line\">          <span class=\"comment\">// If a dead object exception was thrown -- fall through to</span></div><div class=\"line\">        <span class=\"comment\">// restart the application.</span></div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"comment\">//ActivityServiceManager</span></div><div class=\"line\">    mService.startProcessLocked(r.processName, r.info.applicationInfo, <span class=\"keyword\">true</span>, <span class=\"number\">0</span>,</div><div class=\"line\">            <span class=\"string\">\"activity\"</span>, r.intent.getComponent(), <span class=\"keyword\">false</span>, <span class=\"keyword\">false</span>, <span class=\"keyword\">true</span>);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>uiduid + processProcessRecorduidpackageAndroidManifest.xml applicationactivityprocessActivity</p>\n</blockquote>\n<p>mService.startProcessLocked()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Process.ProcessStartResult startResult = Process.start(entryPoint,</div><div class=\"line\">                app.processName, uid, uid, gids, debugFlags, mountExternal,</div><div class=\"line\">                app.info.targetSdkVersion, app.info.seinfo, requiredAbi, instructionSet,</div><div class=\"line\">                app.info.dataDir, entryPointArgs);</div></pre></td></tr></table></figure></p>\n<p>android.app.ActivityThread mainmainActivityThread</p>\n<p>mainattachattach<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">attach</span><span class=\"params\">(<span class=\"keyword\">boolean</span> system)</span> </span>&#123;</div><div class=\"line\">    <span class=\"comment\">//...</span></div><div class=\"line\">    <span class=\"keyword\">final</span> IActivityManager mgr = ActivityManagerNative.getDefault();</div><div class=\"line\">    <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">        mgr.attachApplication(mAppThread);</div><div class=\"line\">    &#125; <span class=\"keyword\">catch</span> (RemoteException ex) &#123;</div><div class=\"line\">        <span class=\"keyword\">throw</span> ex.rethrowFromSystemServer();</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"comment\">//...</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>ActivityManagerServiceattachApplication()ttachApplicationLocked()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">boolean</span> <span class=\"title\">attachApplicationLocked</span><span class=\"params\">(IApplicationThread thread,</span></span></div><div class=\"line\">        <span class=\"keyword\">int</span> pid) &#123;</div><div class=\"line\">    <span class=\"comment\">//...</span></div><div class=\"line\">    <span class=\"comment\">// See if the top visible activity is waiting to run in this process...</span></div><div class=\"line\">    <span class=\"keyword\">if</span> (normalMode) &#123;</div><div class=\"line\">        <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">            <span class=\"keyword\">if</span> (mStackSupervisor.attachApplicationLocked(app)) &#123;</div><div class=\"line\">                didSomething = <span class=\"keyword\">true</span>;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</div><div class=\"line\">            Slog.wtf(TAG, <span class=\"string\">\"Exception thrown launching activities in \"</span> + app, e);</div><div class=\"line\">            badApp = <span class=\"keyword\">true</span>;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"comment\">// Find any services that should be running in this process...</span></div><div class=\"line\">    <span class=\"keyword\">if</span> (!badApp) &#123;</div><div class=\"line\">        <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">            didSomething |= mServices.attachApplicationLocked(app, processName);</div><div class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</div><div class=\"line\">            Slog.wtf(TAG, <span class=\"string\">\"Exception thrown starting services in \"</span> + app, e);</div><div class=\"line\">            badApp = <span class=\"keyword\">true</span>;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"comment\">// Check if a next-broadcast receiver is in this process...</span></div><div class=\"line\">    <span class=\"keyword\">if</span> (!badApp &amp;&amp; isPendingBroadcastProcessLocked(pid)) &#123;</div><div class=\"line\">        <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">            didSomething |= sendPendingBroadcastsLocked(app);</div><div class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</div><div class=\"line\">            <span class=\"comment\">// If the app died trying to launch the receiver we declare it 'bad'</span></div><div class=\"line\">            Slog.wtf(TAG, <span class=\"string\">\"Exception thrown dispatching broadcasts in \"</span> + app, e);</div><div class=\"line\">            badApp = <span class=\"keyword\">true</span>;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"comment\">//...</span></div></pre></td></tr></table></figure></p>\n<p>ActivityStackSupervisorattachApplicationLocked()attachApplicationLocked()realStartActivityLocked()</p>\n<p>Activity</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"http://blog.csdn.net/singwhatiwanna/article/details/18154335\" target=\"_blank\" rel=\"external\">Android-Activity</a></p>\n<p><a href=\"http://blog.csdn.net/luoshengyang/article/details/6685853\" target=\"_blank\" rel=\"external\">AndroidActivity</a> <a href=\"http://blog.csdn.net/luoshengyang/article/details/6689748\" target=\"_blank\" rel=\"external\">Android</a></p>\n<p><a href=\"http://blog.csdn.net/zhaokaiqiang1992/article/details/49428287\" target=\"_blank\" rel=\"external\">FrameworkActivity</a></p>\n<p><a href=\"http://www.wjdiankong.cn/android%E7%B3%BB%E7%BB%9F%E7%AF%87%E4%B9%8B-%E8%A7%A3%E8%AF%BBams%E8%BF%9C%E7%AB%AF%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8%E6%9C%BA%E5%88%B6%E4%BB%A5%E5%8F%8Aactivity%E7%9A%84%E5%90%AF%E5%8A%A8/\" target=\"_blank\" rel=\"external\">Android-AMSActivity</a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/08/02/activity-start-process/\">http://agehua.github.io/2017/08/02/activity-start-process/</a></p>\n","readingTime":{"text":"13 min read","minutes":12.095,"time":725700,"words":2419},"excerpt":"<h2 id=\"Activity\"><a href=\"#Activity\" class=\"headerlink\" title=\"Activity\"></a>Activity</h2><p>ActivityAndroid<a href=\"https://android.googlesource.com/platform/frameworks/base/+/master/\">android.googlesource</a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"zygoteSystemServer\"><a href=\"#zygoteSystemServer\" class=\"headerlink\" title=\"zygoteSystemServer\"></a>zygoteSystemServer</h4><p>androidLinuxlinuxinitfork<strong>zygote</strong> </p>\n<blockquote>\n<p>App</p>\n<ul>\n<li>dalvik</li>\n<li></li>\n</ul>\n</blockquote>\n<p>Androidfork<strong>zygote</strong> zygotezygote<br>","more":"</p>\n<p><strong>SystemServer</strong> zygotefork<br>SystemServerActivityManagerServicePackageManagerServiceWindowManagerService</p>\n<blockquote>\n<p>AppAMS(SystemServer)zygote<br>AppAMSBinderIPCAMS(SystemServer)zygoteSocketIPC</p>\n</blockquote>\n<h4 id=\"Activity\"><a href=\"#Activity\" class=\"headerlink\" title=\"Activity\"></a>Activity</h4><p></p>\n<ul>\n<li><p><strong>ActivityManagerServices</strong>AMSActivity<a href=\"https://android.googlesource.com/platform/frameworks/base/services/java/com/android/server/am/ActivityManagerService.java\"></a></p>\n</li>\n<li><p><strong>ActivityThread</strong>AppAppmain()UIActivityManagerServicesActivity</p>\n</li>\n<li><p><strong>ApplicationThread</strong>ActivityManagerServiceActivityThreadActivityManagerServiceApplicationActivityApplicationThreadActivityThread</p>\n</li>\n<li><p><strong>ApplicationThreadProxy</strong>ApplicationThreadApplicationThreadAMSActivityThread</p>\n</li>\n<li><p><strong>Instrumentation</strong>InstrumentationActivityInstrumentationActivityThreadActivityInstrumentation</p>\n</li>\n<li><p><strong>ActivityStack</strong>ActivityAMSActivityActivityStack</p>\n</li>\n<li><p><strong>ActivityRecord</strong>ActivityStackActivityAMSActivityRecordActivityProcessStateCurentStateActivity</p>\n</li>\n<li><p><strong>TaskRecord</strong>AMSActivityRecordTaskActivityRecordAMSTaskRecordActivityActivity4launchMode</p>\n</li>\n<li><p><strong>ProcessRecord</strong></p>\n</li>\n</ul>\n<h4 id=\"App\"><a href=\"#App\" class=\"headerlink\" title=\"App\"></a>App</h4><p>ActivityActivity.startActivity():</p>\n<blockquote>\n<p>appfoo.bar.multisystem_processapp</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">startActivity</span><span class=\"params\">(Intent intent)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">this</span>.startActivity(intent, <span class=\"keyword\">null</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">startActivity</span><span class=\"params\">(Intent intent, @Nullable Bundle options)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (options != <span class=\"keyword\">null</span>) &#123; <span class=\"comment\">//optionsnull</span></div><div class=\"line\">        startActivityForResult(intent, -<span class=\"number\">1</span>, options);</div><div class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">        <span class=\"comment\">// Note we want to go through this call for compatibility with</span></div><div class=\"line\">        <span class=\"comment\">// applications that may have overridden the method.</span></div><div class=\"line\">        startActivityForResult(intent, -<span class=\"number\">1</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">startActivityForResult</span><span class=\"params\">(@RequiresPermission Intent intent, <span class=\"keyword\">int</span> requestCode,</div><div class=\"line\">        @Nullable Bundle options)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (mParent == <span class=\"keyword\">null</span>) &#123; <span class=\"comment\">//mParent</span></div><div class=\"line\">        options = transferSpringboardActivityOptions(options);</div><div class=\"line\">        Instrumentation.ActivityResult ar =</div><div class=\"line\">            mInstrumentation.execStartActivity(</div><div class=\"line\">                <span class=\"keyword\">this</span>, mMainThread.getApplicationThread(), mToken, <span class=\"keyword\">this</span>,</div><div class=\"line\">                intent, requestCode, options);</div><div class=\"line\">        <span class=\"keyword\">if</span> (ar != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            mMainThread.sendActivityResult(</div><div class=\"line\">                mToken, mEmbeddedID, requestCode, ar.getResultCode(),</div><div class=\"line\">                ar.getResultData());</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"comment\">// ....</span></div><div class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">        <span class=\"comment\">// ....</span></div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>mMainThreadActivityThreadActivityThreadmain</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</div><div class=\"line\">    <span class=\"comment\">//...</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>Android<a href=\"https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/app/ActivityThread.java\">android.googlesource</a>main</p>\n<p>mInstrumentationActivityattach()</p>\n<h4 id=\"InstrumentationActivityThread\"><a href=\"#InstrumentationActivityThread\" class=\"headerlink\" title=\"InstrumentationActivityThread\"></a>InstrumentationActivityThread</h4><p>mInstrumentation.execStartActivity()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> ActivityResult <span class=\"title\">execStartActivity</span><span class=\"params\">(</div><div class=\"line\">          Context who, IBinder contextThread, IBinder token, Activity target,</div><div class=\"line\">          Intent intent, <span class=\"keyword\">int</span> requestCode, Bundle options)</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">public</span> ActivityResult <span class=\"title\">execStartActivity</span><span class=\"params\">(</div><div class=\"line\">         Context who, IBinder contextThread, IBinder token, String target,</div><div class=\"line\">         Intent intent, <span class=\"keyword\">int</span> requestCode, Bundle options)</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">public</span> ActivityResult <span class=\"title\">execStartActivity</span><span class=\"params\">(</div><div class=\"line\">         Context who, IBinder contextThread, IBinder token, Activity target,</div><div class=\"line\">         Intent intent, <span class=\"keyword\">int</span> requestCode, Bundle options, UserHandle user)</span></span></div></pre></td></tr></table></figure></p>\n<p>mInstrumentation.execStartActivity()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> ActivityResult <span class=\"title\">execStartActivity</span><span class=\"params\">(Context who, IBinder contextThread, IBinder token, Activity target,</div><div class=\"line\">        Intent intent, <span class=\"keyword\">int</span> requestCode, Bundle options)</span> </span>&#123;</div><div class=\"line\">    IApplicationThread whoThread = (IApplicationThread) contextThread;</div><div class=\"line\">        <span class=\"comment\">//...ignore some code...</span></div><div class=\"line\">  <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">        intent.migrateExtraStreamToClipData();</div><div class=\"line\">        intent.prepareToLeaveProcess();</div><div class=\"line\">        <span class=\"keyword\">int</span> result = ActivityManagerNative.getDefault()</div><div class=\"line\">            .startActivity(whoThread, who.getBasePackageName(), intent,</div><div class=\"line\">                    intent.resolveTypeIfNeeded(who.getContentResolver()),</div><div class=\"line\">                    token, target != <span class=\"keyword\">null</span> ? target.mEmbeddedID : <span class=\"keyword\">null</span>,</div><div class=\"line\">                    requestCode, <span class=\"number\">0</span>, <span class=\"keyword\">null</span>, options);</div><div class=\"line\">        checkStartActivityResult(result, intent);</div><div class=\"line\">    &#125; <span class=\"keyword\">catch</span> (RemoteException e) &#123;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>execStartActivity()ActivityManagerNativestartActivity()ActivityManagerNative<a href=\"https://agehua.github.io/2017/07/10/android-binder-principle2/\">Android Binder</a>ServiceManagerNativeBinder</p>\n<p>ActivityManagerNativeInstrumentation</p>\n<p>InstrumentationActivityInstrumentationInstrumentation</p>\n<p>InstrumentationApplicationActivityApplicationActivity</p>\n<p>callActivityOnCreate()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">callActivityOnCreate</span><span class=\"params\">(Activity activity, Bundle icicle)</span> </span>&#123;</div><div class=\"line\">    prePerformCreate(activity);</div><div class=\"line\">    activity.performCreate(icicle);</div><div class=\"line\">    postPerformCreate(activity);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>activity.performCreate(icicle);ActivityonCreate()Activity.performCreate()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title\">performCreate</span><span class=\"params\">(Bundle icicle)</span> </span>&#123;</div><div class=\"line\">    onCreate(icicle);</div><div class=\"line\">    mActivityTransitionState.readState(icicle);</div><div class=\"line\">    performCreateCommon();</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>onCreateInstrumentation</p>\n<p>InstrumentationActivityActivity<br>ActivityActivityThread</p>\n<p>ActivityThreadUIUIAppAMSBinderActivityThreadAMSInstrumentationActivityThread</p>\n<p>AMSActivityThreadAMSInstrumentationActivityThread</p>\n<h4 id=\"AMSActivityThreadBinder\"><a href=\"#AMSActivityThreadBinder\" class=\"headerlink\" title=\"AMSActivityThreadBinder\"></a>AMSActivityThreadBinder</h4><p><a href=\"https://agehua.github.io/2017/07/08/android-binder-principle/\">Android Binder</a><a href=\"https://agehua.github.io/2017/07/10/android-binder-principle2/\">Android Binder</a>AndroidBinderActivityThreadAppAMS</p>\n<p>Activity.startActivity()<br><strong>mInstrumentation.execStartActivity()</strong><br><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">ActivityManagerNative.getDefault().startActivity()</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>startActivity()IActivityManagerIActivityManagerIInterfaceAIDL</p>\n</blockquote>\n<p>ActivityManagerNative.getDefault()ActivityManagerServiceActivityManagerProxy<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ActivityManagerNative</span> <span class=\"keyword\">extends</span> <span class=\"title\">Binder</span> <span class=\"keyword\">implements</span> <span class=\"title\">IActivityManager</span></div><div class=\"line\"></span>&#123;</div><div class=\"line\"></div><div class=\"line\"> <span class=\"comment\">//ActivityManagerNativeBinderIActivityManager</span></div><div class=\"line\"> <span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">public</span> IActivityManager <span class=\"title\">getDefault</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> gDefault.get();</div><div class=\"line\"> &#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">//ActivityManagerProxy</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">public</span> IActivityManager <span class=\"title\">asInterface</span><span class=\"params\">(IBinder obj)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (obj == <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">        &#125;</div><div class=\"line\">        IActivityManager in =</div><div class=\"line\">            (IActivityManager)obj.queryLocalInterface(descriptor);</div><div class=\"line\">        <span class=\"keyword\">if</span> (in != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> in;</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"comment\">//BinderobjActivityManagerProxymRemoteIPC</span></div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> ActivityManagerProxy(obj);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>ActivityManagerNativeStubStubBinderAIDLStubasInterface<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//IActivityManagerasInterface(b)</span></div><div class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Singleton&lt;IActivityManager&gt; gDefault = <span class=\"keyword\">new</span> Singleton&lt;IActivityManager&gt;() &#123;</div><div class=\"line\">       <span class=\"function\"><span class=\"keyword\">protected</span> IActivityManager <span class=\"title\">create</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">           IBinder b = ServiceManager.getService(<span class=\"string\">\"activity\"</span>);</div><div class=\"line\">           <span class=\"keyword\">if</span> (<span class=\"keyword\">false</span>) &#123;</div><div class=\"line\">               Log.v(<span class=\"string\">\"ActivityManager\"</span>, <span class=\"string\">\"default service binder = \"</span> + b);</div><div class=\"line\">           &#125;</div><div class=\"line\">           IActivityManager am = asInterface(b);</div><div class=\"line\">           <span class=\"keyword\">if</span> (<span class=\"keyword\">false</span>) &#123;</div><div class=\"line\">               Log.v(<span class=\"string\">\"ActivityManager\"</span>, <span class=\"string\">\"default service = \"</span> + am);</div><div class=\"line\">           &#125;</div><div class=\"line\">           <span class=\"keyword\">return</span> am;</div><div class=\"line\">       &#125;</div><div class=\"line\">   &#125;;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>gDefalutSingletonServiceManagerAMSBinderasInterfaceActivityManagerProxyActivityManagerNativestartActivityActivityManagerProxy</p>\n<p>IPCBindertransact()ParcelAMS</p>\n<blockquote>\n<p>startActivity()ActivityManagerProxyAppfoo.bar.multi</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">startActivity</span><span class=\"params\">(IApplicationThread caller, String callingPackage, Intent intent,</div><div class=\"line\">        String resolvedType, IBinder resultTo, String resultWho, <span class=\"keyword\">int</span> requestCode,</div><div class=\"line\">        <span class=\"keyword\">int</span> startFlags, ProfilerInfo profilerInfo, Bundle options)</span> <span class=\"keyword\">throws</span> RemoteException </span>&#123;</div><div class=\"line\">    Parcel data = Parcel.obtain();</div><div class=\"line\">    Parcel reply = Parcel.obtain();</div><div class=\"line\">    data.writeInterfaceToken(IActivityManager.descriptor);</div><div class=\"line\">    data.writeStrongBinder(caller != <span class=\"keyword\">null</span> ? caller.asBinder() : <span class=\"keyword\">null</span>);</div><div class=\"line\">    data.writeString(callingPackage);</div><div class=\"line\">    intent.writeToParcel(data, <span class=\"number\">0</span>);</div><div class=\"line\">    <span class=\"comment\">//...</span></div><div class=\"line\">    mRemote.transact(START_ACTIVITY_TRANSACTION, data, reply, <span class=\"number\">0</span>);</div><div class=\"line\">    reply.readException();</div><div class=\"line\">    <span class=\"keyword\">int</span> result = reply.readInt();</div><div class=\"line\">    reply.recycle();</div><div class=\"line\">    data.recycle();</div><div class=\"line\">    <span class=\"keyword\">return</span> result;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<pre><code>\n</code></pre><blockquote>\n<p>BinderServerClientProxyServerClientServerClient</p>\n</blockquote>\n<p>ActivityManagerProxy =====&gt;Binder=====&gt; ActivityManagerService</p>\n<p>BinderActivityManagerServicesstartActivity()START_ACTIVITY_TRANSACTION</p>\n<p>transact()mRemote.transact()ActivityManagerNativeonTransact</p>\n<blockquote>\n<p> ActivityManagerNativeonTransactsystem_processdebugmonitor</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">onTransact</span><span class=\"params\">(<span class=\"keyword\">int</span> code, Parcel data, Parcel reply, <span class=\"keyword\">int</span> flags)</span></div><div class=\"line\">        <span class=\"keyword\">throws</span> RemoteException </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">switch</span> (code) &#123;</div><div class=\"line\">    <span class=\"keyword\">case</span> START_ACTIVITY_TRANSACTION:</div><div class=\"line\">    &#123;   <span class=\"comment\">//case</span></div><div class=\"line\">        data.enforceInterface(IActivityManager.descriptor);</div><div class=\"line\">        IBinder b = data.readStrongBinder();</div><div class=\"line\">        IApplicationThread app = ApplicationThreadNative.asInterface(b);</div><div class=\"line\">        String callingPackage = data.readString();</div><div class=\"line\">        Intent intent = Intent.CREATOR.createFromParcel(data);</div><div class=\"line\">        String resolvedType = data.readString();</div><div class=\"line\">        IBinder resultTo = data.readStrongBinder();</div><div class=\"line\">        String resultWho = data.readString();</div><div class=\"line\">        <span class=\"keyword\">int</span> requestCode = data.readInt();</div><div class=\"line\">        <span class=\"keyword\">int</span> startFlags = data.readInt();</div><div class=\"line\">        ProfilerInfo profilerInfo = data.readInt() != <span class=\"number\">0</span></div><div class=\"line\">                ? ProfilerInfo.CREATOR.createFromParcel(data) : <span class=\"keyword\">null</span>;</div><div class=\"line\">        Bundle options = data.readInt() != <span class=\"number\">0</span></div><div class=\"line\">                ? Bundle.CREATOR.createFromParcel(data) : <span class=\"keyword\">null</span>;</div><div class=\"line\">        <span class=\"keyword\">int</span> result = startActivity(app, callingPackage, intent, resolvedType,</div><div class=\"line\">                resultTo, resultWho, requestCode, startFlags, profilerInfo, options);</div><div class=\"line\">        reply.writeNoException();</div><div class=\"line\">        reply.writeInt(result);</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"comment\">//...</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>startActivityIActivityManagerActivityManagerProxyActivityManagerService<a href=\"https://android.googlesource.com/platform/frameworks/base/+/master/services/core/java/com/android/server/am/ActivityManagerService.java\">android.googlesource</a></p>\n<p>startActivity()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">final</span> <span class=\"keyword\">int</span> <span class=\"title\">startActivity</span><span class=\"params\">(Intent intent, ActivityStackSupervisor.ActivityContainer container)</span></div><div class=\"line\"></div><div class=\"line\">@Override</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">startActivity</span><span class=\"params\">(IBinder whoThread, String callingPackage,</div><div class=\"line\">        Intent intent, String resolvedType, Bundle bOptions)</span></div><div class=\"line\"></div><div class=\"line\">@Override</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> <span class=\"title\">startActivity</span><span class=\"params\">(IApplicationThread caller, String callingPackage,</div><div class=\"line\">        Intent intent, String resolvedType, IBinder resultTo, String resultWho, <span class=\"keyword\">int</span> requestCode,</div><div class=\"line\">        <span class=\"keyword\">int</span> startFlags, ProfilerInfo profilerInfo, Bundle bOptions)</span></span></div></pre></td></tr></table></figure></p>\n<p>startActivityAsUser()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> <span class=\"title\">startActivityAsUser</span><span class=\"params\">(IApplicationThread caller, String callingPackage,</div><div class=\"line\">        Intent intent, String resolvedType, IBinder resultTo, String resultWho, <span class=\"keyword\">int</span> requestCode,</div><div class=\"line\">        <span class=\"keyword\">int</span> startFlags, ProfilerInfo profilerInfo, Bundle bOptions, <span class=\"keyword\">int</span> userId)</span> </span>&#123;</div><div class=\"line\">    enforceNotIsolatedCaller(<span class=\"string\">\"startActivity\"</span>);</div><div class=\"line\">    userId = mUserController.handleIncomingUser(Binder.getCallingPid(), Binder.getCallingUid(),</div><div class=\"line\">            userId, <span class=\"keyword\">false</span>, ALLOW_FULL_ONLY, <span class=\"string\">\"startActivity\"</span>, <span class=\"keyword\">null</span>);</div><div class=\"line\">    <span class=\"comment\">// <span class=\"doctag\">TODO:</span> Switch to user app stacks here.</span></div><div class=\"line\">    <span class=\"keyword\">return</span> mActivityStarter.startActivityMayWait(caller, -<span class=\"number\">1</span>, callingPackage, intent,</div><div class=\"line\">            resolvedType, <span class=\"keyword\">null</span>, <span class=\"keyword\">null</span>, resultTo, resultWho, requestCode, startFlags,</div><div class=\"line\">            profilerInfo, <span class=\"keyword\">null</span>, <span class=\"keyword\">null</span>, bOptions, <span class=\"keyword\">false</span>, userId, <span class=\"keyword\">null</span>, <span class=\"keyword\">null</span>);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>mActivityStarterActivityManagerService<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">ActivityManagerService</span><span class=\"params\">(Context systemContext)</span> </span>&#123;</div><div class=\"line\">    <span class=\"comment\">//...</span></div><div class=\"line\">    mStackSupervisor = <span class=\"keyword\">new</span> ActivityStackSupervisor(<span class=\"keyword\">this</span>);</div><div class=\"line\">    mActivityStarter = <span class=\"keyword\">new</span> ActivityStarter(<span class=\"keyword\">this</span>, mStackSupervisor);</div><div class=\"line\">    <span class=\"comment\">//...</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>ActiviStarterActivityStackActivityStackSupervisor</p>\n<p>ActivityStarter.startActivityMayWait()-&gt; ActivityStarter.startActivityLocked()-&gt; ActivityStarter.startActivityUnchecked()-&gt; ActivityStackSupervisor.resumeFocusedStackTopActivityLocked()</p>\n<p>ActivityStackSupervisor</p>\n<p>resumeFocusedStackTopActivityLocked()-&gt; resumeFocusedStackTopActivityLocked()-&gt; resumeTopActivityUncheckedLocked()<br>-&gt; resumeTopActivityInnerLocked()-&gt; startSpecificActivityLocked()-&gt; realStartActivityLocked()</p>\n<h4 id=\"IApplicationThread\"><a href=\"#IApplicationThread\" class=\"headerlink\" title=\"IApplicationThread\"></a>IApplicationThread</h4><p>realStartActivityLocked()<strong>app.thread.scheduleLaunchActivity()</strong><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">final</span> <span class=\"keyword\">boolean</span> <span class=\"title\">realStartActivityLocked</span><span class=\"params\">(ActivityRecord r, ProcessRecord app,</div><div class=\"line\">            <span class=\"keyword\">boolean</span> andResume, <span class=\"keyword\">boolean</span> checkConfig)</span> <span class=\"keyword\">throws</span> RemoteException </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//...</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">final</span> ActivityStack stack = task.stack;</div><div class=\"line\">    <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">        <span class=\"comment\">//...</span></div><div class=\"line\"></div><div class=\"line\">        app.forceProcessStateUpTo(mService.mTopProcessState);</div><div class=\"line\">        app.thread.scheduleLaunchActivity(<span class=\"keyword\">new</span> Intent(r.intent), r.appToken,</div><div class=\"line\">                System.identityHashCode(r), r.info, <span class=\"keyword\">new</span> Configuration(mService.mConfiguration),</div><div class=\"line\">                <span class=\"keyword\">new</span> Configuration(task.mOverrideConfig), r.compat, r.launchedFromPackage,</div><div class=\"line\">                task.voiceInteractor, app.repProcState, r.icicle, r.persistentState, results,</div><div class=\"line\">                newIntents, !andResume, mService.isNextTransitionForward(), profilerInfo);</div><div class=\"line\"></div><div class=\"line\">        <span class=\"comment\">//...</span></div><div class=\"line\">    &#125; <span class=\"keyword\">catch</span> (RemoteException e) &#123;</div><div class=\"line\"></div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>scheduleLaunchActivity()IApplicationThread</p>\n<p>IApplicationThread<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">private</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ApplicationThread</span> <span class=\"keyword\">extends</span> <span class=\"title\">ApplicationThreadNative</span> </span>&#123;&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ApplicationThreadNative</span> <span class=\"keyword\">extends</span> <span class=\"title\">Binder</span> <span class=\"keyword\">implements</span> <span class=\"title\">IApplicationThread</span></span>&#123;&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ApplicationThreadProxy</span> <span class=\"keyword\">implements</span> <span class=\"title\">IApplicationThread</span> </span>&#123;&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">IApplicationThread</span> <span class=\"keyword\">extends</span> <span class=\"title\">IInterface</span> </span>&#123;&#125;</div></pre></td></tr></table></figure></p>\n<p>IApplicationThread<a href=\"https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/app/IApplicationThread.java\">android.googlesource</a></p>\n<blockquote>\n<p>IApplicationThreadIInterfaceBindersystem_process<br>ApplicationThreadProxyApplicationThreadNative</p>\n</blockquote>\n<p>ApplicationThreadProxyscheduleLaunchActivity()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title\">scheduleLaunchActivity</span><span class=\"params\">(Intent intent, IBinder token, <span class=\"keyword\">int</span> ident,</div><div class=\"line\">        ActivityInfo info, Configuration curConfig, Configuration overrideConfig,</div><div class=\"line\">        CompatibilityInfo compatInfo, String referrer, IVoiceInteractor voiceInteractor,</div><div class=\"line\">        <span class=\"keyword\">int</span> procState, Bundle state, PersistableBundle persistentState,</div><div class=\"line\">        List&lt;ResultInfo&gt; pendingResults, List&lt;ReferrerIntent&gt; pendingNewIntents,</div><div class=\"line\">        <span class=\"keyword\">boolean</span> notResumed, <span class=\"keyword\">boolean</span> isForward, ProfilerInfo profilerInfo)</span> <span class=\"keyword\">throws</span> RemoteException </span>&#123;</div><div class=\"line\">    Parcel data = Parcel.obtain();</div><div class=\"line\">    data.writeInterfaceToken(IApplicationThread.descriptor);</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//....</span></div><div class=\"line\"></div><div class=\"line\">    mRemote.transact(SCHEDULE_LAUNCH_ACTIVITY_TRANSACTION, data, <span class=\"keyword\">null</span>,</div><div class=\"line\">            IBinder.FLAG_ONEWAY);</div><div class=\"line\">    data.recycle();</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>SCHEDULE_LAUNCH_ACTIVITY_TRANSACTIONApplicationThreadNativeonTransact()</p>\n<blockquote>\n<p>mRemote.transact()onTransact()system_processAppfoo.bar.multi</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//onTransact()</span></div><div class=\"line\"><span class=\"keyword\">case</span> SCHEDULE_LAUNCH_ACTIVITY_TRANSACTION:</div><div class=\"line\">    &#123;</div><div class=\"line\">        data.enforceInterface(IApplicationThread.descriptor);</div><div class=\"line\">        <span class=\"comment\">// </span></div><div class=\"line\">        scheduleLaunchActivity(intent, b, ident, info, curConfig, overrideConfig, compatInfo,</div><div class=\"line\">                referrer, voiceInteractor, procState, state, persistentState, ri, pi,</div><div class=\"line\">                notResumed, isForward, profilerInfo);</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</div><div class=\"line\">    &#125;</div></pre></td></tr></table></figure>\n<p>scheduleLaunchActivity()</p>\n<blockquote>\n<p>cheduleLaunchActivity()ApplicationThreadServiceApplicationThreadXXXServiceApplicationThreadNativeActivityThread</p>\n</blockquote>\n<p>IApplicationThreadBinder</p>\n<p>ApplicationThread &lt;=====Binder&lt;===== ApplicationThreadProxy<br>IActivityManager<br>ActivityManagerProxy =====&gt;Binder=====&gt; ActivityManagerService<br><strong>Binder</strong></p>\n<p>Binder<br><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/ams_binder_process.png\" alt=\"\"></p>\n<p>ApplicationThreadscheduleLaunchActivity()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// we use token to identify this activity without having to send the</span></div><div class=\"line\"><span class=\"comment\">// activity itself back to the activity manager. (matters more with ipc)</span></div><div class=\"line\"><span class=\"meta\">@Override</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title\">scheduleLaunchActivity</span><span class=\"params\">(Intent intent, IBinder token, <span class=\"keyword\">int</span> ident,</div><div class=\"line\">        ActivityInfo info, Configuration curConfig, Configuration overrideConfig,</div><div class=\"line\">        CompatibilityInfo compatInfo, String referrer, IVoiceInteractor voiceInteractor,</div><div class=\"line\">        <span class=\"keyword\">int</span> procState, Bundle state, PersistableBundle persistentState,</div><div class=\"line\">        List&lt;ResultInfo&gt; pendingResults, List&lt;ReferrerIntent&gt; pendingNewIntents,</div><div class=\"line\">        <span class=\"keyword\">boolean</span> notResumed, <span class=\"keyword\">boolean</span> isForward, ProfilerInfo profilerInfo)</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    updateProcessState(procState, <span class=\"keyword\">false</span>);</div><div class=\"line\">    ActivityClientRecord r = <span class=\"keyword\">new</span> ActivityClientRecord();</div><div class=\"line\"></div><div class=\"line\">    r.token = token;</div><div class=\"line\">    r.ident = ident;</div><div class=\"line\">    r.intent = intent;</div><div class=\"line\">    r.referrer = referrer;</div><div class=\"line\">    r.voiceInteractor = voiceInteractor;</div><div class=\"line\">    r.activityInfo = info;</div><div class=\"line\">    r.compatInfo = compatInfo;</div><div class=\"line\">    r.state = state;</div><div class=\"line\">    r.persistentState = persistentState;</div><div class=\"line\"></div><div class=\"line\">    r.pendingResults = pendingResults;</div><div class=\"line\">    r.pendingIntents = pendingNewIntents;</div><div class=\"line\"></div><div class=\"line\">    r.startsNotResumed = notResumed;</div><div class=\"line\">    r.isForward = isForward;</div><div class=\"line\"></div><div class=\"line\">    r.profilerInfo = profilerInfo;</div><div class=\"line\"></div><div class=\"line\">    r.overrideConfig = overrideConfig;</div><div class=\"line\">    updatePendingConfiguration(curConfig);</div><div class=\"line\"></div><div class=\"line\">    sendMessage(H.LAUNCH_ACTIVITY, r);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>HHHandler<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">handleMessage</span><span class=\"params\">(Message msg)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (DEBUG_MESSAGES) Slog.v(TAG, <span class=\"string\">\"&gt;&gt;&gt; handling: \"</span> + codeToString(msg.what));</div><div class=\"line\">    <span class=\"keyword\">switch</span> (msg.what) &#123;</div><div class=\"line\">        <span class=\"keyword\">case</span> LAUNCH_ACTIVITY: &#123;</div><div class=\"line\">            Trace.traceBegin(Trace.TRACE_TAG_ACTIVITY_MANAGER, <span class=\"string\">\"activityStart\"</span>);</div><div class=\"line\">            <span class=\"keyword\">final</span> ActivityClientRecord r = (ActivityClientRecord) msg.obj;</div><div class=\"line\"></div><div class=\"line\">            r.packageInfo = getPackageInfoNoCheck(</div><div class=\"line\">                  r.activityInfo.applicationInfo, r.compatInfo);</div><div class=\"line\">            handleLaunchActivity(r, <span class=\"keyword\">null</span>, <span class=\"string\">\"LAUNCH_ACTIVITY\"</span>);</div><div class=\"line\">            Trace.traceEnd(Trace.TRACE_TAG_ACTIVITY_MANAGER);</div><div class=\"line\">        &#125; <span class=\"keyword\">break</span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//....</span></div></pre></td></tr></table></figure></p>\n<p>handleLaunchActivity()-&gt;performLaunchActivity()</p>\n<p>performLaunchActivity()ClassLoaderActivity<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Activity activity = <span class=\"keyword\">null</span>;</div><div class=\"line\"><span class=\"keyword\">try</span> &#123;</div><div class=\"line\">    <span class=\"comment\">//ClassLoaderfoo.bar.multi.XXXActivity</span></div><div class=\"line\">    java.lang.ClassLoader cl = r.packageInfo.getClassLoader();</div><div class=\"line\">    activity = mInstrumentation.newActivity(</div><div class=\"line\">            cl, component.getClassName(), r.intent);</div><div class=\"line\">    StrictMode.incrementExpectedActivityCount(activity.getClass());</div><div class=\"line\">    r.intent.setExtrasClassLoader(cl);</div><div class=\"line\">    r.intent.prepareToEnterProcess();</div><div class=\"line\">    <span class=\"keyword\">if</span> (r.state != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">        r.state.setClassLoader(cl);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (!mInstrumentation.onException(activity, e)) &#123;</div><div class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> RuntimeException(</div><div class=\"line\">            <span class=\"string\">\"Unable to instantiate activity \"</span> + component</div><div class=\"line\">            + <span class=\"string\">\": \"</span> + e.toString(), e);</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">try</span> &#123;</div><div class=\"line\">    <span class=\"comment\">//ApplicationAndroidManifest.xmlApplication</span></div><div class=\"line\">    Application app = r.packageInfo.makeApplication(<span class=\"keyword\">false</span>, mInstrumentation);</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//ActivityattachXXXActivity</span></div><div class=\"line\">    <span class=\"keyword\">if</span> (activity != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">      activity.attach(appContext, <span class=\"keyword\">this</span>, getInstrumentation(), r.token,</div><div class=\"line\">      r.ident, app, r.intent, r.activityInfo, title, r.parent,</div><div class=\"line\">      r.embeddedID, r.lastNonConfigurationInstances, config,</div><div class=\"line\">      r.referrer, r.voiceInteractor, window);</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//activityonCreate</span></div><div class=\"line\">    mInstrumentation.callActivityOnCreate(activity, r.state);</div></pre></td></tr></table></figure></p>\n<p>ActivityActivitystartActivityActivityActivityManagerServiceAndroidActivityManagerServiceActivityServiceActivityService</p>\n<p>AndroidActivityManagerServiceActivity</p>\n<p><img src=\"http://oui2w5whj.bkt.clouddn.com/blogimages/2017/activity-start-process.png\" alt=\"http://blog.csdn.net/luoshengyang/article/details/6685853\"></p>\n<p>ActivityManagerServiceActivityStackApplicationThreadActivityThreadActivityManagerServiceActivityActivityManagerServiceActivityStackActivityActivityThreadActivityThreadApplicationThreadBinder</p>\n<p></p>\n<ul>\n<li>Step 1. LauncherActivityActivitystartActivityActivityBinderActivityManagerServiceActivityManagerService.startActivity</li>\n<li>Step 2. ActivityManagerServiceActivityStack.startActivityMayWaitActivity</li>\n<li>Step 3. ActivityStackApplicationThreadActivityApplicationThreadActivityManagerService.startActivityLauncherActivitystartActivityActivity</li>\n<li>Step 4. ApplicationThreadActivityManagerService.activityPausedActivityManagerServiceActivity</li>\n<li>Step 5. ActivityActivityManagerServicestartProcessLockedActivitystartActivityActivityActivityActivity</li>\n<li>Step 6. ActivityManagerServicApplicationThread.scheduleLaunchActivityActivity</li>\n<li>Step 7. ApplicationThreadActivityActivityThreadActivityThreadClassLoaderActivity</li>\n</ul>\n<h3 id=\"LauncherActivity\"><a href=\"#LauncherActivity\" class=\"headerlink\" title=\"LauncherActivity\"></a>LauncherActivity</h3><p>AndroidLauncherActivity.startActivity()ActivityStackSupervisor.startSpecificActivityLocked()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">startSpecificActivityLocked</span><span class=\"params\">(ActivityRecord r,</div><div class=\"line\">        <span class=\"keyword\">boolean</span> andResume, <span class=\"keyword\">boolean</span> checkConfig)</span> </span>&#123;</div><div class=\"line\">    <span class=\"comment\">// Is this activity's application already running?</span></div><div class=\"line\">    ProcessRecord app = mService.getProcessRecordLocked(r.processName,</div><div class=\"line\">            r.info.applicationInfo.uid, <span class=\"keyword\">true</span>);</div><div class=\"line\"></div><div class=\"line\">    r.task.stack.setLaunchTime(r);</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//Launcherappnullappnull</span></div><div class=\"line\">    <span class=\"keyword\">if</span> (app != <span class=\"keyword\">null</span> &amp;&amp; app.thread != <span class=\"keyword\">null</span>) &#123;</div><div class=\"line\">        <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">            <span class=\"keyword\">if</span> ((r.info.flags&amp;ActivityInfo.FLAG_MULTIPROCESS) == <span class=\"number\">0</span></div><div class=\"line\">                    || !<span class=\"string\">\"android\"</span>.equals(r.info.packageName)) &#123;</div><div class=\"line\">                <span class=\"comment\">// Don't add this if it is a platform component that is marked</span></div><div class=\"line\">                <span class=\"comment\">// to run in multiple processes, because this is actually</span></div><div class=\"line\">                <span class=\"comment\">// part of the framework so doesn't make sense to track as a</span></div><div class=\"line\">                <span class=\"comment\">// separate apk in the process.</span></div><div class=\"line\">                app.addPackage(r.info.packageName, r.info.applicationInfo.versionCode,</div><div class=\"line\">                        mService.mProcessStats);</div><div class=\"line\">            &#125;</div><div class=\"line\">            realStartActivityLocked(r, app, andResume, checkConfig);</div><div class=\"line\">            <span class=\"keyword\">return</span>;</div><div class=\"line\">        &#125; <span class=\"keyword\">catch</span> (RemoteException e) &#123;</div><div class=\"line\">            Slog.w(TAG, <span class=\"string\">\"Exception when starting activity \"</span></div><div class=\"line\">                    + r.intent.getComponent().flattenToShortString(), e);</div><div class=\"line\">        &#125;</div><div class=\"line\">          <span class=\"comment\">// If a dead object exception was thrown -- fall through to</span></div><div class=\"line\">        <span class=\"comment\">// restart the application.</span></div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"comment\">//ActivityServiceManager</span></div><div class=\"line\">    mService.startProcessLocked(r.processName, r.info.applicationInfo, <span class=\"keyword\">true</span>, <span class=\"number\">0</span>,</div><div class=\"line\">            <span class=\"string\">\"activity\"</span>, r.intent.getComponent(), <span class=\"keyword\">false</span>, <span class=\"keyword\">false</span>, <span class=\"keyword\">true</span>);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>uiduid + processProcessRecorduidpackageAndroidManifest.xml applicationactivityprocessActivity</p>\n</blockquote>\n<p>mService.startProcessLocked()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">Process.ProcessStartResult startResult = Process.start(entryPoint,</div><div class=\"line\">                app.processName, uid, uid, gids, debugFlags, mountExternal,</div><div class=\"line\">                app.info.targetSdkVersion, app.info.seinfo, requiredAbi, instructionSet,</div><div class=\"line\">                app.info.dataDir, entryPointArgs);</div></pre></td></tr></table></figure></p>\n<p>android.app.ActivityThread mainmainActivityThread</p>\n<p>mainattachattach<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">attach</span><span class=\"params\">(<span class=\"keyword\">boolean</span> system)</span> </span>&#123;</div><div class=\"line\">    <span class=\"comment\">//...</span></div><div class=\"line\">    <span class=\"keyword\">final</span> IActivityManager mgr = ActivityManagerNative.getDefault();</div><div class=\"line\">    <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">        mgr.attachApplication(mAppThread);</div><div class=\"line\">    &#125; <span class=\"keyword\">catch</span> (RemoteException ex) &#123;</div><div class=\"line\">        <span class=\"keyword\">throw</span> ex.rethrowFromSystemServer();</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"comment\">//...</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>ActivityManagerServiceattachApplication()ttachApplicationLocked()<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">boolean</span> <span class=\"title\">attachApplicationLocked</span><span class=\"params\">(IApplicationThread thread,</div><div class=\"line\">        <span class=\"keyword\">int</span> pid)</span> </span>&#123;</div><div class=\"line\">    <span class=\"comment\">//...</span></div><div class=\"line\">    <span class=\"comment\">// See if the top visible activity is waiting to run in this process...</span></div><div class=\"line\">    <span class=\"keyword\">if</span> (normalMode) &#123;</div><div class=\"line\">        <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">            <span class=\"keyword\">if</span> (mStackSupervisor.attachApplicationLocked(app)) &#123;</div><div class=\"line\">                didSomething = <span class=\"keyword\">true</span>;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</div><div class=\"line\">            Slog.wtf(TAG, <span class=\"string\">\"Exception thrown launching activities in \"</span> + app, e);</div><div class=\"line\">            badApp = <span class=\"keyword\">true</span>;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"comment\">// Find any services that should be running in this process...</span></div><div class=\"line\">    <span class=\"keyword\">if</span> (!badApp) &#123;</div><div class=\"line\">        <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">            didSomething |= mServices.attachApplicationLocked(app, processName);</div><div class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</div><div class=\"line\">            Slog.wtf(TAG, <span class=\"string\">\"Exception thrown starting services in \"</span> + app, e);</div><div class=\"line\">            badApp = <span class=\"keyword\">true</span>;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"comment\">// Check if a next-broadcast receiver is in this process...</span></div><div class=\"line\">    <span class=\"keyword\">if</span> (!badApp &amp;&amp; isPendingBroadcastProcessLocked(pid)) &#123;</div><div class=\"line\">        <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">            didSomething |= sendPendingBroadcastsLocked(app);</div><div class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</div><div class=\"line\">            <span class=\"comment\">// If the app died trying to launch the receiver we declare it 'bad'</span></div><div class=\"line\">            Slog.wtf(TAG, <span class=\"string\">\"Exception thrown dispatching broadcasts in \"</span> + app, e);</div><div class=\"line\">            badApp = <span class=\"keyword\">true</span>;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"comment\">//...</span></div></pre></td></tr></table></figure></p>\n<p>ActivityStackSupervisorattachApplicationLocked()attachApplicationLocked()realStartActivityLocked()</p>\n<p>Activity</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"http://blog.csdn.net/singwhatiwanna/article/details/18154335\">Android-Activity</a></p>\n<p><a href=\"http://blog.csdn.net/luoshengyang/article/details/6685853\">AndroidActivity</a> <a href=\"http://blog.csdn.net/luoshengyang/article/details/6689748\">Android</a></p>\n<p><a href=\"http://blog.csdn.net/zhaokaiqiang1992/article/details/49428287\">FrameworkActivity</a></p>\n<p><a href=\"http://www.wjdiankong.cn/android%E7%B3%BB%E7%BB%9F%E7%AF%87%E4%B9%8B-%E8%A7%A3%E8%AF%BBams%E8%BF%9C%E7%AB%AF%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8%E6%9C%BA%E5%88%B6%E4%BB%A5%E5%8F%8Aactivity%E7%9A%84%E5%90%AF%E5%8A%A8/\">Android-AMSActivity</a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/08/02/activity-start-process/\">http://agehua.github.io/2017/08/02/activity-start-process/</a></p>"},{"layout":"post","title":"Android","keywords":"Basic Knowledge, Interview","banner":"http://obxk8w81b.bkt.clouddn.com/Daubigny%20s%20Garden%202.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Daubigny%20s%20Garden%202.jpg","toc":true,"_content":"\n### 1Activity\n\n1Activity\nActivityActivity\n\n2Activity\nruning\npaused\nstopped\nkilled\n\n3Activity\nonCreate()\nonStart()\nonResume()\nonPause()\nonStop()\nonDestroy()\nonRestart()\n\n4\n\n\n\n\n\n\n5Activity\n\n<!--more-->\n6Activity\nstandard\nsingletop\nsingletask: Activity A.\n> startActivityForResultstartActivityForResultapi: if the activity you are launching uses the singleTask launch mode, it will not run in your task and thus you will immediately receive a cancel result\nstartActivityForResultsingleTaskActivityActivityRESULT_CANCELED\n\nsingleinstance: singleInstanceactivitytaskactivitysingleTaskactivity\n> singleInstanceactivityactivitysingleInstanceactivitysingleInstance\n\n7scheme\nAndroidschemeschemeapp\napp\nAppApp\nH5DeepLink\n~~~\n<a href=\"[scheme]://[host]/[path]?[query]\"></a>\n~~~\n~~~ Java\n<intent-filter>\n    <data android:scheme=\"http\" />\n    <!-- or you can use deep linking like  -->\n    <data android:scheme=\"http\" android:host=\"xyz.abc.com\"/>\n    <action android:name=\"android.intent.action.VIEW\"/>\n    <category android:name=\"android.intent.category.BROWSABLE\"/>\n    <category android:name=\"android.intent.category.DEFAULT\"/>\n</intent-filter>\n~~~\n\n### 2Fragment\n\n1Fragment\nFragmentActivityActivity\n\n2ActivityFragment\nactivityfragment\nactivity_main.xml\n<fragment\n    android:name=\"com.example.myfragment.MyFragment\"\n    android:id=\"@+id/myfragment_1\"\n    android:layout_width=\"wrap_content\"\n    android:layout_height=\"wrap_content\"\n/>\n\njavafragmentViewGroup\nfragment = new MyFragment();\nfragmentStack.push(fragment);\ntransaction = manager.beginTransaction();\ntransaction.add(R.id.fragments, fragment);\ntransaction.commit();\n\n\n3FragmentPageAdapterFragmentPageStateAdapter\nFragmentPageAdapterFragmentFragment\nFragmentPageStateAdapterFragmentFragment\n\n4Fragment\nonAttach()\nonCreate()\nonCreateView()\nonActivityCreated()\nonStart()\nonResume()\nonPause()\nonStop()\nonDestroyView()\nonDestroy()\nonDetach()\n\n5Fragment\nFragmentActivitygetActivity\nActivityFragment\nFragmentFragmentFragmentManager.findFragmentById\n\n6Fragmentreplaceaddremove\nreplaceFragment\naddFragment\nremoveFragment\n\n\n### 3Service\n\n1Service\nService\n\n2ServiceThread\nServiceANRThreadCPU\nServiceActivityServiceThreadActivityActivityThread\n\n3Service\nstartService\nbindService\n\n4Service\nstartService\nonCreate()\nonStartCommand()\nonDestroy()\nbindService\nonCreate()\nonBind()\nonUnbind()\nonDestroy()\n\n\n### 4Broadcast Receiver\n\n1Broadcast Receiver\nBroadcastIntent\n\n2Broadcast Receiver\nApp\nApp\n\n3Broadcast Receiver\n\n Context.sendOrderedBroadcast\n LocalBroadcastManager.getInstance(context).sendBroadcast(intent) BroadcastReceiverContextBroadcastReceiver\nSticky sendStickyBroadcast(Intent)<uses-permission android:name=\"android.permission.BROADCAST_STICKY\"/>\nContextremoveStickyBroadcast(Intent intent)\nsticky StickyOrderedBroadcast\n\n\n4Broadcast Receiver\nActivityApp\nActivity\n\n5Broadcast Receiver\nBroadcastReceiveronReceiver()\nBinderAMS\nBinderAMS\nAMSBroadcastReceiver\nBroadcastReceiveronReceiver()\n\n6LocalBroadcastManager\nApp\nAppApp\n\nHandler\n\n\n### 5WebView\n\n1WebView\nAPI16WebView.addJavascriptInterfaceJavaJava\n\n2WebView\nWebViewLinearLayoutActivityonDestroy()WebViewWebView.destroy()\n\n3WebViewjsbridge\nJavascript\n\n4WebViewClientonPageFinished\nWebViewClientonPageFinishedWebChromeClient.onProgressChanged\n\n5WebView\nWebViewonDestroySystem.exit(0)java\n\n6WebView\nAndroid3.0WebViewWebView\n\n7WebView\nWebViewActivityActivityWebViewWebViewActivity\n\nWebViewWebViewContext\n\n\n### 6Binder\n\n1Linux\n\n![](/images/blogimages/2017/binder-01.png)\n/\nLinux\nbinderbinder\n\nBinder  \n\n2Binder\nSocket\n\n\n3Binder\n![](/images/blogimages/2017/binder-02.png)\n> \n\n1ClientServer & Service Manager Binder open  ioctl\n\n\n1. ClientServer & Service Manager\n2. Binder    & \n\n2 Binder & Service Manager  AndroidClient   Server  Android\n\nClient & Server   3 Android\n\n[ Android Binder ](http://blog.csdn.net/carson_ho/article/details/73560642)\n\n Linux Androidlinux////SocketBinder \n\n- \nBinderSocket2\n\n- \nBinder  UID/PID  Binder  UID/PID \n\nSocket ip\n- \nClient/Server \n  Binder\n\n\n4AIDL\naidlStub.asInterface()Proxy\nProxytransact()\ntransact()onTransact()\nonTransact()\n\n### 7Handler\n\n1Handler\nHandlerMessageRunnableMessageQueue\n\n2Handler\npost(runnable)\nsendMessage(message)\n\n3Handler\n[AndroidAndroidLooperHandlerMessageQueen](http://blog.csdn.net/qq_30379689/article/details/53394061)\n\n4Handler\nActivity\n\nHandlerActivity\nHandler\nHandler.removeCallback()\n\n\n### 8AsyncTask\n\n1AsyncTask\nHandler\n\n2AsyncTask\n\nParamsAysncTask **doInBackground()** \nProgress **onProgressUpdate()** \nResult **onPostExecute()** \n\nonPreExecute()\ndoInBackground()\nonProgressUpdate()doInBackgroundpublishProgress\nonPostExecute()\nonCancelled()\n\n3AsyncTask\nAndroidAsyncTask\nhttp://blog.csdn.net/qq_30379689/article/details/53203556\n\n4AsyncTask\nActivity\n\nAsyncTaskActivity\nAsyncTask\nAsyncTask.cancel()\n\n5AsyncTask\nActivityAsyncTask\n\n6AsyncTask\nActivityActivityAsyncTaskActivityAsyncTask **onPostExecute()UI**\n\n7AsyncTaskor\nAsyncTaskAndroid 2.3AsyncTaskAndroid 2.3\nAndroid 2.3AsyncTaskexecuteOnExecutor()\n\n\n### 9HandlerThread\n\n1HandlerThread\nGoogleHandlerThreadHandlerThreadLooperLooper\n\n2HanlderThread\nHandlerThreadThread\nHandlerThreadLooperLooperHandler\nHandlerThreadHandlerhandlerMessage\nHandlerThread\nHandlerThread\nHandlerThreadHandlerThread\n\n\n### 10IntentService\n\n1IntentService\nIntentServiceServiceHandlerThreadHandlerIntentServiceServiceIntentServicestopSelf()IntentServiceIntentService **onHandlerIntent()** \n\n2IntentService\nServiceIntentService\nonHandlerIntent()\nonHandlerIntent()\n\n### 11\n\n[AndroidAndroidmeasurelayoutdraw](http://blog.csdn.net/qq_30379689/article/details/54588736)\n\n[AndroiddispatchTouchEventonInterceptTouchEventonTouchEvent](http://blog.csdn.net/qq_30379689/article/details/53967177)\n\n### 12ListView\n\n1ListView\nListViewView\n\n2ListViewRecycleBin\n\n![](/images/blogimages/2017/listview_recyclebin.png)\n\n3ListView\nconvertView\nViewHolder\n\n\nView\n\n\n\n### 13Android\n\n1android\n\n![](/images/blogimages/2017/android_build_process.png)\n\n2jenkins\n[](http://www.pgyer.com/doc/view/jenkins)\n\n3Git\ngit init\ngit status\ngit diff\ngit add\ngit commit\ngit clone\ngit bransh\ngit checkout\n\n4git\nfork/clone\nforkfork\nclone\nupdatecommit\npush\npull request\nclone\n\n5proguard\nProGuard\n\n6proguard\n\n\n\n\n\n7proguard\nEntryPointEntryPoint\n\n8\nJavaclassclassJava\n\n\n### 14ANR\n\n1ANR\nApplication Not Responding\n\n2ANR\nActivityManagerWindowManagerANRANR\nActivity5\nBroadcastReceiver10\nService20\n\n3ANR\nIO\nActivity\nService\nBoardcastReceiveronReceive()\nAsyncTaskdoInBackground\nLooperHandlerhandlerMessagepost(Runnable)\n\n4ANR\nAsyncTaskIO\nThreadHandlerThread\nHandler\nActivityonCreateonResume\n\n\n### 15OOM\n\n1OOM\nOOMOut of memoryDalvikOut of memory\n\n2OOM\n\n\n\n\n3OOM\nBitmap\n\n\n\nBitmap\ninBitmap\n\n\nlistviewconvertViewLruCache\nonDraw\n\n\n\n### 16Bitmap\n\n1recycle\n3.0Bitmap\n3.0BitmapnativeJava\n3.0recycleBitmap\nrecycleBitmapnativeJavaBitmapdead\nrecyclegetPixels()\n\n2LruCache\nLruCacheLinkedHashMapgetputtrimToSize\n\n3inSampleSize\n~~~ Java\npublic static int calculateInSampleSize(BitmapFactory.Options options, int reqWidth, int reqHeight) {\n    final int height = options.outHeight;\n    final int width = options.outWidth;\n    int inSampleSize = 1;\n\n    if (height > reqHeight || width > reqWidth) {\n        if (width > height) {\n            inSampleSize = Math.round((float)height / (float)reqHeight);\n        } else {\n            inSampleSize = Math.round((float)width / (float)reqWidth);\n        }\n    }\n    return inSampleSize;\n}\n~~~\n\n4\n~~~ Java\npublic static Bitmap thumbnail(String path,int maxWidth, int maxHeight, boolean autoRotate) {\n    BitmapFactory.Options options = new BitmapFactory.Options();\n    options.inJustDecodeBounds = true;\n    Bitmap bitmap = BitmapFactory.decodeFile(path, options);\n    options.inJustDecodeBounds = false;\n    int sampleSize = calculateInSampleSize(options, maxWidth, maxHeight);\n    options.inSampleSize = sampleSize;\n    options.inPreferredConfig = Bitmap.Config.RGB_565;\n    options.inPurgeable = true;\n    options.inInputShareable = true;\n    if (bitmap != null && !bitmap.isRecycled()) {\n        bitmap.recycle();\n    }\n    bitmap = BitmapFactory.decodeFile(path, options);\n    return bitmap;\n}\n~~~\n\n\n5Bitmap\n~~~ Java\npublic static String save(Bitmap bitmap,Bitmap.CompressFormat format, int quality, File destFile) {\n    try {\n        FileOutputStream out = new FileOutputStream(destFile);\n        if (bitmap.compress(format, quality, out)) {\n            out.flush();\n            out.close();\n        }\n        if (bitmap != null && !bitmap.isRecycled()) {\n            bitmap.recycle();\n        }\n        return destFile.getAbsolutePath();\n    } catch (FileNotFoundException e) {\n        e.printStackTrace();\n    } catch (IOException e) {\n        e.printStackTrace();\n    }\n    return null;\n}\n~~~\n\n\n6SD\n\n~~~ Java\npublic static String save(Bitmap bitmap,Bitmap.CompressFormat format, int quality, Context context) {\n    if (!Environment.getExternalStorageState()\n            .equals(Environment.MEDIA_MOUNTED)) {\n        return null;\n    }\n    File dir = new File(Environment.getExternalStorageDirectory()\n            + \"/\" + context.getPackageName() + \"/save/\");\n    if (!dir.exists()) {\n        dir.mkdirs();\n    }\n    File destFile = new File(dir, UUID.randomUUID().toString());\n    return save(bitmap, format, quality, destFile);\n}\n~~~\n\n7\n\n\n\n\n### 17UI\n\n1UI\nView60fps16ms1000/6016ms\n\n2UI\nUIUI\nLayout16ms\nCPUGPU\noverDrawCPUGPU\nViewmeasurelayoutmeasurelayoutView\nGC16ms\n\nANR\n\n3UI\n\nincludeViewStubmerge\n\nViewView\nListView\nconvertView\n\n\n\n\nANR\nUI\n\n### 18\n\n1Java\n\n\n2Java\n\n\nnewJava\n\n3Android\ncontext.getApplicationContext()context\nstatic\nHandlerstaticHandlerContext\nstaticstaticActivityActivitystaticstatic\nSocketBroadcastCursorBitmapListView\nAsyncTaskAsyncTaskActivityonDestroy()AsyncTask.cancel()\n\n\n### 19\n\n1Android\n\n\n\n2\n\n\n\n\n\n3\nServiceIntentServiceService\nUIUI\n\nBitmap\n\n\nZIPAPK\n\n\n### 20\n\n1\n\n\n\n2\nApplicationMainActivity\nMainActivity\n\n3\n\n\n4\nZygotefork\nApplicationMainActivity\ninflateonCreate/onStart/onResume\ncontentViewmeasure/layout/draw\nApplication->attachBaseContext()->onCreate()->Activity->onCreate()->->onStart()->onResume()->\n\n5\nonCreate()\nApplication\nApplication\nApplication\n\nmainThread\nSDK\n\n\n### 21\n\n1Android\n\n/sp/contentProvider\n\n2SharePreference\n\n\n\n3\nSerializeblejavaSerializebleGC\nParcelableAndroidSerializebleParcelable\n\n4UI\n\n### 22\n\nAndroidMVC\nhttp://blog.csdn.net/qq_30379689/article/details/52909656\nAndroidMVP\nhttp://blog.csdn.net/qq_30379689/article/details/52910567\nAndroidMVVMDataBinding\nhttp://blog.csdn.net/qq_30379689/article/details/53037430\n\n\n### 23\n\n1\nAPK\nAssetManager\n\n\n2Java\nDexClassLoaderjar/apk/dex\nPathClassLoaderapk\n\n\n### 24\n\n1\nCrash\nBugfixCrash\njenkins\napp\nBugfixmaster\n\n2\nDexposed\nAndFix\nNuwa\nTinker\n\n3\nClassLoaderdexElements\ndexdexElements\nClassLoaderdexElementsdex\n\n\n### 25\n\n1\n\n\n\n\n\n\n2Android\nLow memory Killerbad\nOOM_ODJ\n\n3Android\n\nService\nNative\nJobScheduler\n\n\n### 26Lint\n\n1Android Lint\nAndroid LintAndroidBug\n\n2Lint\n![](/images/blogimages/2017/android_lint.png)\n\n3Lint\nLint.xmlLint\nJava@suppressLint(NewApi)Lint\nxmltool:ignore(UnusedResources)Lint\nLintDetectorJavaPsiScanner\n\n### 27Kotlin\n\n1Kotlin\nKotlinJVM\nJavaJava\nKotlin\nKotlinJava\n\n2Kotlin\nPluginKotlin\nKotlin\n","source":"_posts/2017-08-17-IntervieweeQuestions.md","raw":"---\nlayout: post\ntitle:  Android\ncategory: accumulation\ntags:\n  - Interview Knowledge\n  - ANDROID\nkeywords: Basic Knowledge, Interview\nbanner: http://obxk8w81b.bkt.clouddn.com/Daubigny%20s%20Garden%202.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Daubigny%20s%20Garden%202.jpg\ntoc: true\n---\n\n### 1Activity\n\n1Activity\nActivityActivity\n\n2Activity\nruning\npaused\nstopped\nkilled\n\n3Activity\nonCreate()\nonStart()\nonResume()\nonPause()\nonStop()\nonDestroy()\nonRestart()\n\n4\n\n\n\n\n\n\n5Activity\n\n<!--more-->\n6Activity\nstandard\nsingletop\nsingletask: Activity A.\n> startActivityForResultstartActivityForResultapi: if the activity you are launching uses the singleTask launch mode, it will not run in your task and thus you will immediately receive a cancel result\nstartActivityForResultsingleTaskActivityActivityRESULT_CANCELED\n\nsingleinstance: singleInstanceactivitytaskactivitysingleTaskactivity\n> singleInstanceactivityactivitysingleInstanceactivitysingleInstance\n\n7scheme\nAndroidschemeschemeapp\napp\nAppApp\nH5DeepLink\n~~~\n<a href=\"[scheme]://[host]/[path]?[query]\"></a>\n~~~\n~~~ Java\n<intent-filter>\n    <data android:scheme=\"http\" />\n    <!-- or you can use deep linking like  -->\n    <data android:scheme=\"http\" android:host=\"xyz.abc.com\"/>\n    <action android:name=\"android.intent.action.VIEW\"/>\n    <category android:name=\"android.intent.category.BROWSABLE\"/>\n    <category android:name=\"android.intent.category.DEFAULT\"/>\n</intent-filter>\n~~~\n\n### 2Fragment\n\n1Fragment\nFragmentActivityActivity\n\n2ActivityFragment\nactivityfragment\nactivity_main.xml\n<fragment\n    android:name=\"com.example.myfragment.MyFragment\"\n    android:id=\"@+id/myfragment_1\"\n    android:layout_width=\"wrap_content\"\n    android:layout_height=\"wrap_content\"\n/>\n\njavafragmentViewGroup\nfragment = new MyFragment();\nfragmentStack.push(fragment);\ntransaction = manager.beginTransaction();\ntransaction.add(R.id.fragments, fragment);\ntransaction.commit();\n\n\n3FragmentPageAdapterFragmentPageStateAdapter\nFragmentPageAdapterFragmentFragment\nFragmentPageStateAdapterFragmentFragment\n\n4Fragment\nonAttach()\nonCreate()\nonCreateView()\nonActivityCreated()\nonStart()\nonResume()\nonPause()\nonStop()\nonDestroyView()\nonDestroy()\nonDetach()\n\n5Fragment\nFragmentActivitygetActivity\nActivityFragment\nFragmentFragmentFragmentManager.findFragmentById\n\n6Fragmentreplaceaddremove\nreplaceFragment\naddFragment\nremoveFragment\n\n\n### 3Service\n\n1Service\nService\n\n2ServiceThread\nServiceANRThreadCPU\nServiceActivityServiceThreadActivityActivityThread\n\n3Service\nstartService\nbindService\n\n4Service\nstartService\nonCreate()\nonStartCommand()\nonDestroy()\nbindService\nonCreate()\nonBind()\nonUnbind()\nonDestroy()\n\n\n### 4Broadcast Receiver\n\n1Broadcast Receiver\nBroadcastIntent\n\n2Broadcast Receiver\nApp\nApp\n\n3Broadcast Receiver\n\n Context.sendOrderedBroadcast\n LocalBroadcastManager.getInstance(context).sendBroadcast(intent) BroadcastReceiverContextBroadcastReceiver\nSticky sendStickyBroadcast(Intent)<uses-permission android:name=\"android.permission.BROADCAST_STICKY\"/>\nContextremoveStickyBroadcast(Intent intent)\nsticky StickyOrderedBroadcast\n\n\n4Broadcast Receiver\nActivityApp\nActivity\n\n5Broadcast Receiver\nBroadcastReceiveronReceiver()\nBinderAMS\nBinderAMS\nAMSBroadcastReceiver\nBroadcastReceiveronReceiver()\n\n6LocalBroadcastManager\nApp\nAppApp\n\nHandler\n\n\n### 5WebView\n\n1WebView\nAPI16WebView.addJavascriptInterfaceJavaJava\n\n2WebView\nWebViewLinearLayoutActivityonDestroy()WebViewWebView.destroy()\n\n3WebViewjsbridge\nJavascript\n\n4WebViewClientonPageFinished\nWebViewClientonPageFinishedWebChromeClient.onProgressChanged\n\n5WebView\nWebViewonDestroySystem.exit(0)java\n\n6WebView\nAndroid3.0WebViewWebView\n\n7WebView\nWebViewActivityActivityWebViewWebViewActivity\n\nWebViewWebViewContext\n\n\n### 6Binder\n\n1Linux\n\n![](/images/blogimages/2017/binder-01.png)\n/\nLinux\nbinderbinder\n\nBinder  \n\n2Binder\nSocket\n\n\n3Binder\n![](/images/blogimages/2017/binder-02.png)\n> \n\n1ClientServer & Service Manager Binder open  ioctl\n\n\n1. ClientServer & Service Manager\n2. Binder    & \n\n2 Binder & Service Manager  AndroidClient   Server  Android\n\nClient & Server   3 Android\n\n[ Android Binder ](http://blog.csdn.net/carson_ho/article/details/73560642)\n\n Linux Androidlinux////SocketBinder \n\n- \nBinderSocket2\n\n- \nBinder  UID/PID  Binder  UID/PID \n\nSocket ip\n- \nClient/Server \n  Binder\n\n\n4AIDL\naidlStub.asInterface()Proxy\nProxytransact()\ntransact()onTransact()\nonTransact()\n\n### 7Handler\n\n1Handler\nHandlerMessageRunnableMessageQueue\n\n2Handler\npost(runnable)\nsendMessage(message)\n\n3Handler\n[AndroidAndroidLooperHandlerMessageQueen](http://blog.csdn.net/qq_30379689/article/details/53394061)\n\n4Handler\nActivity\n\nHandlerActivity\nHandler\nHandler.removeCallback()\n\n\n### 8AsyncTask\n\n1AsyncTask\nHandler\n\n2AsyncTask\n\nParamsAysncTask **doInBackground()** \nProgress **onProgressUpdate()** \nResult **onPostExecute()** \n\nonPreExecute()\ndoInBackground()\nonProgressUpdate()doInBackgroundpublishProgress\nonPostExecute()\nonCancelled()\n\n3AsyncTask\nAndroidAsyncTask\nhttp://blog.csdn.net/qq_30379689/article/details/53203556\n\n4AsyncTask\nActivity\n\nAsyncTaskActivity\nAsyncTask\nAsyncTask.cancel()\n\n5AsyncTask\nActivityAsyncTask\n\n6AsyncTask\nActivityActivityAsyncTaskActivityAsyncTask **onPostExecute()UI**\n\n7AsyncTaskor\nAsyncTaskAndroid 2.3AsyncTaskAndroid 2.3\nAndroid 2.3AsyncTaskexecuteOnExecutor()\n\n\n### 9HandlerThread\n\n1HandlerThread\nGoogleHandlerThreadHandlerThreadLooperLooper\n\n2HanlderThread\nHandlerThreadThread\nHandlerThreadLooperLooperHandler\nHandlerThreadHandlerhandlerMessage\nHandlerThread\nHandlerThread\nHandlerThreadHandlerThread\n\n\n### 10IntentService\n\n1IntentService\nIntentServiceServiceHandlerThreadHandlerIntentServiceServiceIntentServicestopSelf()IntentServiceIntentService **onHandlerIntent()** \n\n2IntentService\nServiceIntentService\nonHandlerIntent()\nonHandlerIntent()\n\n### 11\n\n[AndroidAndroidmeasurelayoutdraw](http://blog.csdn.net/qq_30379689/article/details/54588736)\n\n[AndroiddispatchTouchEventonInterceptTouchEventonTouchEvent](http://blog.csdn.net/qq_30379689/article/details/53967177)\n\n### 12ListView\n\n1ListView\nListViewView\n\n2ListViewRecycleBin\n\n![](/images/blogimages/2017/listview_recyclebin.png)\n\n3ListView\nconvertView\nViewHolder\n\n\nView\n\n\n\n### 13Android\n\n1android\n\n![](/images/blogimages/2017/android_build_process.png)\n\n2jenkins\n[](http://www.pgyer.com/doc/view/jenkins)\n\n3Git\ngit init\ngit status\ngit diff\ngit add\ngit commit\ngit clone\ngit bransh\ngit checkout\n\n4git\nfork/clone\nforkfork\nclone\nupdatecommit\npush\npull request\nclone\n\n5proguard\nProGuard\n\n6proguard\n\n\n\n\n\n7proguard\nEntryPointEntryPoint\n\n8\nJavaclassclassJava\n\n\n### 14ANR\n\n1ANR\nApplication Not Responding\n\n2ANR\nActivityManagerWindowManagerANRANR\nActivity5\nBroadcastReceiver10\nService20\n\n3ANR\nIO\nActivity\nService\nBoardcastReceiveronReceive()\nAsyncTaskdoInBackground\nLooperHandlerhandlerMessagepost(Runnable)\n\n4ANR\nAsyncTaskIO\nThreadHandlerThread\nHandler\nActivityonCreateonResume\n\n\n### 15OOM\n\n1OOM\nOOMOut of memoryDalvikOut of memory\n\n2OOM\n\n\n\n\n3OOM\nBitmap\n\n\n\nBitmap\ninBitmap\n\n\nlistviewconvertViewLruCache\nonDraw\n\n\n\n### 16Bitmap\n\n1recycle\n3.0Bitmap\n3.0BitmapnativeJava\n3.0recycleBitmap\nrecycleBitmapnativeJavaBitmapdead\nrecyclegetPixels()\n\n2LruCache\nLruCacheLinkedHashMapgetputtrimToSize\n\n3inSampleSize\n~~~ Java\npublic static int calculateInSampleSize(BitmapFactory.Options options, int reqWidth, int reqHeight) {\n    final int height = options.outHeight;\n    final int width = options.outWidth;\n    int inSampleSize = 1;\n\n    if (height > reqHeight || width > reqWidth) {\n        if (width > height) {\n            inSampleSize = Math.round((float)height / (float)reqHeight);\n        } else {\n            inSampleSize = Math.round((float)width / (float)reqWidth);\n        }\n    }\n    return inSampleSize;\n}\n~~~\n\n4\n~~~ Java\npublic static Bitmap thumbnail(String path,int maxWidth, int maxHeight, boolean autoRotate) {\n    BitmapFactory.Options options = new BitmapFactory.Options();\n    options.inJustDecodeBounds = true;\n    Bitmap bitmap = BitmapFactory.decodeFile(path, options);\n    options.inJustDecodeBounds = false;\n    int sampleSize = calculateInSampleSize(options, maxWidth, maxHeight);\n    options.inSampleSize = sampleSize;\n    options.inPreferredConfig = Bitmap.Config.RGB_565;\n    options.inPurgeable = true;\n    options.inInputShareable = true;\n    if (bitmap != null && !bitmap.isRecycled()) {\n        bitmap.recycle();\n    }\n    bitmap = BitmapFactory.decodeFile(path, options);\n    return bitmap;\n}\n~~~\n\n\n5Bitmap\n~~~ Java\npublic static String save(Bitmap bitmap,Bitmap.CompressFormat format, int quality, File destFile) {\n    try {\n        FileOutputStream out = new FileOutputStream(destFile);\n        if (bitmap.compress(format, quality, out)) {\n            out.flush();\n            out.close();\n        }\n        if (bitmap != null && !bitmap.isRecycled()) {\n            bitmap.recycle();\n        }\n        return destFile.getAbsolutePath();\n    } catch (FileNotFoundException e) {\n        e.printStackTrace();\n    } catch (IOException e) {\n        e.printStackTrace();\n    }\n    return null;\n}\n~~~\n\n\n6SD\n\n~~~ Java\npublic static String save(Bitmap bitmap,Bitmap.CompressFormat format, int quality, Context context) {\n    if (!Environment.getExternalStorageState()\n            .equals(Environment.MEDIA_MOUNTED)) {\n        return null;\n    }\n    File dir = new File(Environment.getExternalStorageDirectory()\n            + \"/\" + context.getPackageName() + \"/save/\");\n    if (!dir.exists()) {\n        dir.mkdirs();\n    }\n    File destFile = new File(dir, UUID.randomUUID().toString());\n    return save(bitmap, format, quality, destFile);\n}\n~~~\n\n7\n\n\n\n\n### 17UI\n\n1UI\nView60fps16ms1000/6016ms\n\n2UI\nUIUI\nLayout16ms\nCPUGPU\noverDrawCPUGPU\nViewmeasurelayoutmeasurelayoutView\nGC16ms\n\nANR\n\n3UI\n\nincludeViewStubmerge\n\nViewView\nListView\nconvertView\n\n\n\n\nANR\nUI\n\n### 18\n\n1Java\n\n\n2Java\n\n\nnewJava\n\n3Android\ncontext.getApplicationContext()context\nstatic\nHandlerstaticHandlerContext\nstaticstaticActivityActivitystaticstatic\nSocketBroadcastCursorBitmapListView\nAsyncTaskAsyncTaskActivityonDestroy()AsyncTask.cancel()\n\n\n### 19\n\n1Android\n\n\n\n2\n\n\n\n\n\n3\nServiceIntentServiceService\nUIUI\n\nBitmap\n\n\nZIPAPK\n\n\n### 20\n\n1\n\n\n\n2\nApplicationMainActivity\nMainActivity\n\n3\n\n\n4\nZygotefork\nApplicationMainActivity\ninflateonCreate/onStart/onResume\ncontentViewmeasure/layout/draw\nApplication->attachBaseContext()->onCreate()->Activity->onCreate()->->onStart()->onResume()->\n\n5\nonCreate()\nApplication\nApplication\nApplication\n\nmainThread\nSDK\n\n\n### 21\n\n1Android\n\n/sp/contentProvider\n\n2SharePreference\n\n\n\n3\nSerializeblejavaSerializebleGC\nParcelableAndroidSerializebleParcelable\n\n4UI\n\n### 22\n\nAndroidMVC\nhttp://blog.csdn.net/qq_30379689/article/details/52909656\nAndroidMVP\nhttp://blog.csdn.net/qq_30379689/article/details/52910567\nAndroidMVVMDataBinding\nhttp://blog.csdn.net/qq_30379689/article/details/53037430\n\n\n### 23\n\n1\nAPK\nAssetManager\n\n\n2Java\nDexClassLoaderjar/apk/dex\nPathClassLoaderapk\n\n\n### 24\n\n1\nCrash\nBugfixCrash\njenkins\napp\nBugfixmaster\n\n2\nDexposed\nAndFix\nNuwa\nTinker\n\n3\nClassLoaderdexElements\ndexdexElements\nClassLoaderdexElementsdex\n\n\n### 25\n\n1\n\n\n\n\n\n\n2Android\nLow memory Killerbad\nOOM_ODJ\n\n3Android\n\nService\nNative\nJobScheduler\n\n\n### 26Lint\n\n1Android Lint\nAndroid LintAndroidBug\n\n2Lint\n![](/images/blogimages/2017/android_lint.png)\n\n3Lint\nLint.xmlLint\nJava@suppressLint(NewApi)Lint\nxmltool:ignore(UnusedResources)Lint\nLintDetectorJavaPsiScanner\n\n### 27Kotlin\n\n1Kotlin\nKotlinJVM\nJavaJava\nKotlin\nKotlinJava\n\n2Kotlin\nPluginKotlin\nKotlin\n","slug":"IntervieweeQuestions","published":1,"date":"2017-08-16T16:00:00.000Z","updated":"2017-11-24T03:01:55.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ec1j003td6ykynv0l9r3","content":"<h3 id=\"1Activity\"><a href=\"#1Activity\" class=\"headerlink\" title=\"1Activity\"></a>1Activity</h3><p>1Activity<br>ActivityActivity</p>\n<p>2Activity<br>runing<br>paused<br>stopped<br>killed</p>\n<p>3Activity<br>onCreate()<br>onStart()<br>onResume()<br>onPause()<br>onStop()<br>onDestroy()<br>onRestart()</p>\n<p>4<br><br><br><br><br></p>\n<p>5Activity<br><br><a id=\"more\"></a><br>6Activity<br>standard<br>singletop<br>singletask: Activity A.</p>\n<blockquote>\n<p>startActivityForResultstartActivityForResultapi: if the activity you are launching uses the singleTask launch mode, it will not run in your task and thus you will immediately receive a cancel result<br>startActivityForResultsingleTaskActivityActivityRESULT_CANCELED</p>\n</blockquote>\n<p>singleinstance: singleInstanceactivitytaskactivitysingleTaskactivity</p>\n<blockquote>\n<p>singleInstanceactivityactivitysingleInstanceactivitysingleInstance</p>\n</blockquote>\n<p>7scheme<br>Androidschemeschemeapp<br>app<br>AppApp<br>H5DeepLink<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;a href=&quot;[scheme]://[host]/[path]?[query]&quot;&gt;&lt;/a&gt;</div></pre></td></tr></table></figure></p>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;intent-filter&gt;</div><div class=\"line\">    &lt;data android:scheme=\"http\" /&gt;</div><div class=\"line\">    &lt;!-- or you can use deep linking like  --&gt;</div><div class=\"line\">    &lt;data android:scheme=\"http\" android:host=\"xyz.abc.com\"/&gt;</div><div class=\"line\">    &lt;action android:name=\"android.intent.action.VIEW\"/&gt;</div><div class=\"line\">    &lt;category android:name=\"android.intent.category.BROWSABLE\"/&gt;</div><div class=\"line\">    &lt;category android:name=\"android.intent.category.DEFAULT\"/&gt;</div><div class=\"line\">&lt;/intent-filter&gt;</div></pre></td></tr></table></figure>\n<h3 id=\"2Fragment\"><a href=\"#2Fragment\" class=\"headerlink\" title=\"2Fragment\"></a>2Fragment</h3><p>1Fragment<br>FragmentActivityActivity</p>\n<p>2ActivityFragment<br>activityfragment<br>activity_main.xml</p>\n<fragment android:name=\"com.example.myfragment.MyFragment\" android:id=\"@+id/myfragment_1\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\">\n\n<p>javafragmentViewGroup<br>fragment = new MyFragment();<br>fragmentStack.push(fragment);<br>transaction = manager.beginTransaction();<br>transaction.add(R.id.fragments, fragment);<br>transaction.commit();</p>\n<p>3FragmentPageAdapterFragmentPageStateAdapter<br>FragmentPageAdapterFragmentFragment<br>FragmentPageStateAdapterFragmentFragment</p>\n<p>4Fragment<br>onAttach()<br>onCreate()<br>onCreateView()<br>onActivityCreated()<br>onStart()<br>onResume()<br>onPause()<br>onStop()<br>onDestroyView()<br>onDestroy()<br>onDetach()</p>\n<p>5Fragment<br>FragmentActivitygetActivity<br>ActivityFragment<br>FragmentFragmentFragmentManager.findFragmentById</p>\n<p>6Fragmentreplaceaddremove<br>replaceFragment<br>addFragment<br>removeFragment</p>\n<h3 id=\"3Service\"><a href=\"#3Service\" class=\"headerlink\" title=\"3Service\"></a>3Service</h3><p>1Service<br>Service</p>\n<p>2ServiceThread<br>ServiceANRThreadCPU<br>ServiceActivityServiceThreadActivityActivityThread</p>\n<p>3Service<br>startService<br>bindService</p>\n<p>4Service<br>startService<br>onCreate()<br>onStartCommand()<br>onDestroy()<br>bindService<br>onCreate()<br>onBind()<br>onUnbind()<br>onDestroy()</p>\n<h3 id=\"4Broadcast-Receiver\"><a href=\"#4Broadcast-Receiver\" class=\"headerlink\" title=\"4Broadcast Receiver\"></a>4Broadcast Receiver</h3><p>1Broadcast Receiver<br>BroadcastIntent</p>\n<p>2Broadcast Receiver<br>App<br>App</p>\n<p>3Broadcast Receiver<br><br> Context.sendOrderedBroadcast<br> LocalBroadcastManager.getInstance(context).sendBroadcast(intent) BroadcastReceiverContextBroadcastReceiver<br>Sticky sendStickyBroadcast(Intent)<uses-permission android:name=\"android.permission.BROADCAST_STICKY\"><br>ContextremoveStickyBroadcast(Intent intent)<br>sticky StickyOrderedBroadcast</uses-permission></p>\n<p>4Broadcast Receiver<br>ActivityApp<br>Activity</p>\n<p>5Broadcast Receiver<br>BroadcastReceiveronReceiver()<br>BinderAMS<br>BinderAMS<br>AMSBroadcastReceiver<br>BroadcastReceiveronReceiver()</p>\n<p>6LocalBroadcastManager<br>App<br>AppApp<br><br>Handler</p>\n<h3 id=\"5WebView\"><a href=\"#5WebView\" class=\"headerlink\" title=\"5WebView\"></a>5WebView</h3><p>1WebView<br>API16WebView.addJavascriptInterfaceJavaJava</p>\n<p>2WebView<br>WebViewLinearLayoutActivityonDestroy()WebViewWebView.destroy()</p>\n<p>3WebViewjsbridge<br>Javascript</p>\n<p>4WebViewClientonPageFinished<br>WebViewClientonPageFinishedWebChromeClient.onProgressChanged</p>\n<p>5WebView<br>WebViewonDestroySystem.exit(0)java</p>\n<p>6WebView<br>Android3.0WebViewWebView</p>\n<p>7WebView<br>WebViewActivityActivityWebViewWebViewActivity<br><br>WebViewWebViewContext</p>\n<h3 id=\"6Binder\"><a href=\"#6Binder\" class=\"headerlink\" title=\"6Binder\"></a>6Binder</h3><p>1Linux</p>\n<p><img src=\"/images/blogimages/2017/binder-01.png\" alt=\"\"><br>/<br>Linux<br>binderbinder</p>\n<p>Binder  </p>\n<p>2Binder<br>Socket<br></p>\n<p>3Binder<br><img src=\"/images/blogimages/2017/binder-02.png\" alt=\"\"></p>\n<blockquote>\n<p></p>\n</blockquote>\n<p>1ClientServer &amp; Service Manager Binder open  ioctl</p>\n<p></p>\n<ol>\n<li>ClientServer &amp; Service Manager</li>\n<li>Binder    &amp; </li>\n</ol>\n<p>2 Binder &amp; Service Manager  AndroidClient   Server  Android</p>\n<p>Client &amp; Server   3 Android</p>\n<p><a href=\"http://blog.csdn.net/carson_ho/article/details/73560642\" target=\"_blank\" rel=\"external\"> Android Binder </a></p>\n<p> Linux Androidlinux////SocketBinder </p>\n<ul>\n<li><br>BinderSocket2<br></li>\n<li><br>Binder  UID/PID  Binder  UID/PID <br><br>Socket ip</li>\n<li><br>Client/Server <br>  Binder</li>\n</ul>\n<p>4AIDL<br>aidlStub.asInterface()Proxy<br>Proxytransact()<br>transact()onTransact()<br>onTransact()</p>\n<h3 id=\"7Handler\"><a href=\"#7Handler\" class=\"headerlink\" title=\"7Handler\"></a>7Handler</h3><p>1Handler<br>HandlerMessageRunnableMessageQueue</p>\n<p>2Handler<br>post(runnable)<br>sendMessage(message)</p>\n<p>3Handler<br><a href=\"http://blog.csdn.net/qq_30379689/article/details/53394061\" target=\"_blank\" rel=\"external\">AndroidAndroidLooperHandlerMessageQueen</a></p>\n<p>4Handler<br>Activity<br><br>HandlerActivity<br>Handler<br>Handler.removeCallback()</p>\n<h3 id=\"8AsyncTask\"><a href=\"#8AsyncTask\" class=\"headerlink\" title=\"8AsyncTask\"></a>8AsyncTask</h3><p>1AsyncTask<br>Handler</p>\n<p>2AsyncTask<br><br>ParamsAysncTask <strong>doInBackground()</strong> <br>Progress <strong>onProgressUpdate()</strong> <br>Result <strong>onPostExecute()</strong> <br><br>onPreExecute()<br>doInBackground()<br>onProgressUpdate()doInBackgroundpublishProgress<br>onPostExecute()<br>onCancelled()</p>\n<p>3AsyncTask<br>AndroidAsyncTask<br><a href=\"http://blog.csdn.net/qq_30379689/article/details/53203556\" target=\"_blank\" rel=\"external\">http://blog.csdn.net/qq_30379689/article/details/53203556</a></p>\n<p>4AsyncTask<br>Activity<br><br>AsyncTaskActivity<br>AsyncTask<br>AsyncTask.cancel()</p>\n<p>5AsyncTask<br>ActivityAsyncTask</p>\n<p>6AsyncTask<br>ActivityActivityAsyncTaskActivityAsyncTask <strong>onPostExecute()UI</strong></p>\n<p>7AsyncTaskor<br>AsyncTaskAndroid 2.3AsyncTaskAndroid 2.3<br>Android 2.3AsyncTaskexecuteOnExecutor()</p>\n<h3 id=\"9HandlerThread\"><a href=\"#9HandlerThread\" class=\"headerlink\" title=\"9HandlerThread\"></a>9HandlerThread</h3><p>1HandlerThread<br>GoogleHandlerThreadHandlerThreadLooperLooper</p>\n<p>2HanlderThread<br>HandlerThreadThread<br>HandlerThreadLooperLooperHandler<br>HandlerThreadHandlerhandlerMessage<br>HandlerThread<br>HandlerThread<br>HandlerThreadHandlerThread</p>\n<h3 id=\"10IntentService\"><a href=\"#10IntentService\" class=\"headerlink\" title=\"10IntentService\"></a>10IntentService</h3><p>1IntentService<br>IntentServiceServiceHandlerThreadHandlerIntentServiceServiceIntentServicestopSelf()IntentServiceIntentService <strong>onHandlerIntent()</strong> </p>\n<p>2IntentService<br>ServiceIntentService<br>onHandlerIntent()<br>onHandlerIntent()</p>\n<h3 id=\"11\"><a href=\"#11\" class=\"headerlink\" title=\"11\"></a>11</h3><p><a href=\"http://blog.csdn.net/qq_30379689/article/details/54588736\" target=\"_blank\" rel=\"external\">AndroidAndroidmeasurelayoutdraw</a></p>\n<p><a href=\"http://blog.csdn.net/qq_30379689/article/details/53967177\" target=\"_blank\" rel=\"external\">AndroiddispatchTouchEventonInterceptTouchEventonTouchEvent</a></p>\n<h3 id=\"12ListView\"><a href=\"#12ListView\" class=\"headerlink\" title=\"12ListView\"></a>12ListView</h3><p>1ListView<br>ListViewView</p>\n<p>2ListViewRecycleBin</p>\n<p><img src=\"/images/blogimages/2017/listview_recyclebin.png\" alt=\"\"></p>\n<p>3ListView<br>convertView<br>ViewHolder<br><br><br>View<br></p>\n<h3 id=\"13Android\"><a href=\"#13Android\" class=\"headerlink\" title=\"13Android\"></a>13Android</h3><p>1android</p>\n<p><img src=\"/images/blogimages/2017/android_build_process.png\" alt=\"\"></p>\n<p>2jenkins<br><a href=\"http://www.pgyer.com/doc/view/jenkins\" target=\"_blank\" rel=\"external\"></a></p>\n<p>3Git<br>git init<br>git status<br>git diff<br>git add<br>git commit<br>git clone<br>git bransh<br>git checkout</p>\n<p>4git<br>fork/clone<br>forkfork<br>clone<br>updatecommit<br>push<br>pull request<br>clone</p>\n<p>5proguard<br>ProGuard</p>\n<p>6proguard<br><br><br><br></p>\n<p>7proguard<br>EntryPointEntryPoint</p>\n<p>8<br>JavaclassclassJava</p>\n<h3 id=\"14ANR\"><a href=\"#14ANR\" class=\"headerlink\" title=\"14ANR\"></a>14ANR</h3><p>1ANR<br>Application Not Responding</p>\n<p>2ANR<br>ActivityManagerWindowManagerANRANR<br>Activity5<br>BroadcastReceiver10<br>Service20</p>\n<p>3ANR<br>IO<br>Activity<br>Service<br>BoardcastReceiveronReceive()<br>AsyncTaskdoInBackground<br>LooperHandlerhandlerMessagepost(Runnable)</p>\n<p>4ANR<br>AsyncTaskIO<br>ThreadHandlerThread<br>Handler<br>ActivityonCreateonResume</p>\n<h3 id=\"15OOM\"><a href=\"#15OOM\" class=\"headerlink\" title=\"15OOM\"></a>15OOM</h3><p>1OOM<br>OOMOut of memoryDalvikOut of memory</p>\n<p>2OOM<br><br><br></p>\n<p>3OOM<br>Bitmap<br><br><br><br>Bitmap<br>inBitmap<br><br><br>listviewconvertViewLruCache<br>onDraw<br></p>\n<h3 id=\"16Bitmap\"><a href=\"#16Bitmap\" class=\"headerlink\" title=\"16Bitmap\"></a>16Bitmap</h3><p>1recycle<br>3.0Bitmap<br>3.0BitmapnativeJava<br>3.0recycleBitmap<br>recycleBitmapnativeJavaBitmapdead<br>recyclegetPixels()</p>\n<p>2LruCache<br>LruCacheLinkedHashMapgetputtrimToSize</p>\n<p>3inSampleSize<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> <span class=\"title\">calculateInSampleSize</span><span class=\"params\">(BitmapFactory.Options options, <span class=\"keyword\">int</span> reqWidth, <span class=\"keyword\">int</span> reqHeight)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> height = options.outHeight;</div><div class=\"line\">    <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> width = options.outWidth;</div><div class=\"line\">    <span class=\"keyword\">int</span> inSampleSize = <span class=\"number\">1</span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">if</span> (height &gt; reqHeight || width &gt; reqWidth) &#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (width &gt; height) &#123;</div><div class=\"line\">            inSampleSize = Math.round((<span class=\"keyword\">float</span>)height / (<span class=\"keyword\">float</span>)reqHeight);</div><div class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">            inSampleSize = Math.round((<span class=\"keyword\">float</span>)width / (<span class=\"keyword\">float</span>)reqWidth);</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> inSampleSize;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>4<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Bitmap <span class=\"title\">thumbnail</span><span class=\"params\">(String path,<span class=\"keyword\">int</span> maxWidth, <span class=\"keyword\">int</span> maxHeight, <span class=\"keyword\">boolean</span> autoRotate)</span> </span>&#123;</div><div class=\"line\">    BitmapFactory.Options options = <span class=\"keyword\">new</span> BitmapFactory.Options();</div><div class=\"line\">    options.inJustDecodeBounds = <span class=\"keyword\">true</span>;</div><div class=\"line\">    Bitmap bitmap = BitmapFactory.decodeFile(path, options);</div><div class=\"line\">    options.inJustDecodeBounds = <span class=\"keyword\">false</span>;</div><div class=\"line\">    <span class=\"keyword\">int</span> sampleSize = calculateInSampleSize(options, maxWidth, maxHeight);</div><div class=\"line\">    options.inSampleSize = sampleSize;</div><div class=\"line\">    options.inPreferredConfig = Bitmap.Config.RGB_565;</div><div class=\"line\">    options.inPurgeable = <span class=\"keyword\">true</span>;</div><div class=\"line\">    options.inInputShareable = <span class=\"keyword\">true</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (bitmap != <span class=\"keyword\">null</span> &amp;&amp; !bitmap.isRecycled()) &#123;</div><div class=\"line\">        bitmap.recycle();</div><div class=\"line\">    &#125;</div><div class=\"line\">    bitmap = BitmapFactory.decodeFile(path, options);</div><div class=\"line\">    <span class=\"keyword\">return</span> bitmap;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>5Bitmap<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">save</span><span class=\"params\">(Bitmap bitmap,Bitmap.CompressFormat format, <span class=\"keyword\">int</span> quality, File destFile)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">        FileOutputStream out = <span class=\"keyword\">new</span> FileOutputStream(destFile);</div><div class=\"line\">        <span class=\"keyword\">if</span> (bitmap.compress(format, quality, out)) &#123;</div><div class=\"line\">            out.flush();</div><div class=\"line\">            out.close();</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">if</span> (bitmap != <span class=\"keyword\">null</span> &amp;&amp; !bitmap.isRecycled()) &#123;</div><div class=\"line\">            bitmap.recycle();</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">return</span> destFile.getAbsolutePath();</div><div class=\"line\">    &#125; <span class=\"keyword\">catch</span> (FileNotFoundException e) &#123;</div><div class=\"line\">        e.printStackTrace();</div><div class=\"line\">    &#125; <span class=\"keyword\">catch</span> (IOException e) &#123;</div><div class=\"line\">        e.printStackTrace();</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>6SD</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">save</span><span class=\"params\">(Bitmap bitmap,Bitmap.CompressFormat format, <span class=\"keyword\">int</span> quality, Context context)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (!Environment.getExternalStorageState()</div><div class=\"line\">            .equals(Environment.MEDIA_MOUNTED)) &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\">    File dir = <span class=\"keyword\">new</span> File(Environment.getExternalStorageDirectory()</div><div class=\"line\">            + <span class=\"string\">\"/\"</span> + context.getPackageName() + <span class=\"string\">\"/save/\"</span>);</div><div class=\"line\">    <span class=\"keyword\">if</span> (!dir.exists()) &#123;</div><div class=\"line\">        dir.mkdirs();</div><div class=\"line\">    &#125;</div><div class=\"line\">    File destFile = <span class=\"keyword\">new</span> File(dir, UUID.randomUUID().toString());</div><div class=\"line\">    <span class=\"keyword\">return</span> save(bitmap, format, quality, destFile);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>7<br><br><br></p>\n<h3 id=\"17UI\"><a href=\"#17UI\" class=\"headerlink\" title=\"17UI\"></a>17UI</h3><p>1UI<br>View60fps16ms1000/6016ms</p>\n<p>2UI<br>UIUI<br>Layout16ms<br>CPUGPU<br>overDrawCPUGPU<br>ViewmeasurelayoutmeasurelayoutView<br>GC16ms<br><br>ANR</p>\n<p>3UI<br><br>includeViewStubmerge<br><br>ViewView<br>ListView<br>convertView<br><br><br><br><br>ANR<br>UI</p>\n<h3 id=\"18\"><a href=\"#18\" class=\"headerlink\" title=\"18\"></a>18</h3><p>1Java<br></p>\n<p>2Java<br><br><br>newJava</p>\n<p>3Android<br>context.getApplicationContext()context<br>static<br>HandlerstaticHandlerContext<br>staticstaticActivityActivitystaticstatic<br>SocketBroadcastCursorBitmapListView<br>AsyncTaskAsyncTaskActivityonDestroy()AsyncTask.cancel()</p>\n<h3 id=\"19\"><a href=\"#19\" class=\"headerlink\" title=\"19\"></a>19</h3><p>1Android<br><br></p>\n<p>2<br><br><br><br></p>\n<p>3<br>ServiceIntentServiceService<br>UIUI<br><br>Bitmap<br><br><br>ZIPAPK<br></p>\n<h3 id=\"20\"><a href=\"#20\" class=\"headerlink\" title=\"20\"></a>20</h3><p>1<br><br></p>\n<p>2<br>ApplicationMainActivity<br>MainActivity</p>\n<p>3<br></p>\n<p>4<br>Zygotefork<br>ApplicationMainActivity<br>inflateonCreate/onStart/onResume<br>contentViewmeasure/layout/draw<br>Application-&gt;attachBaseContext()-&gt;onCreate()-&gt;Activity-&gt;onCreate()-&gt;-&gt;onStart()-&gt;onResume()-&gt;</p>\n<p>5<br>onCreate()<br>Application<br>Application<br>Application<br><br>mainThread<br>SDK</p>\n<h3 id=\"21\"><a href=\"#21\" class=\"headerlink\" title=\"21\"></a>21</h3><p>1Android<br><br>/sp/contentProvider</p>\n<p>2SharePreference<br><br></p>\n<p>3<br>SerializeblejavaSerializebleGC<br>ParcelableAndroidSerializebleParcelable</p>\n<p>4UI</p>\n<h3 id=\"22\"><a href=\"#22\" class=\"headerlink\" title=\"22\"></a>22</h3><p>AndroidMVC<br><a href=\"http://blog.csdn.net/qq_30379689/article/details/52909656\" target=\"_blank\" rel=\"external\">http://blog.csdn.net/qq_30379689/article/details/52909656</a><br>AndroidMVP<br><a href=\"http://blog.csdn.net/qq_30379689/article/details/52910567\" target=\"_blank\" rel=\"external\">http://blog.csdn.net/qq_30379689/article/details/52910567</a><br>AndroidMVVMDataBinding<br><a href=\"http://blog.csdn.net/qq_30379689/article/details/53037430\" target=\"_blank\" rel=\"external\">http://blog.csdn.net/qq_30379689/article/details/53037430</a></p>\n<h3 id=\"23\"><a href=\"#23\" class=\"headerlink\" title=\"23\"></a>23</h3><p>1<br>APK<br>AssetManager<br></p>\n<p>2Java<br>DexClassLoaderjar/apk/dex<br>PathClassLoaderapk</p>\n<h3 id=\"24\"><a href=\"#24\" class=\"headerlink\" title=\"24\"></a>24</h3><p>1<br>Crash<br>BugfixCrash<br>jenkins<br>app<br>Bugfixmaster</p>\n<p>2<br>Dexposed<br>AndFix<br>Nuwa<br>Tinker</p>\n<p>3<br>ClassLoaderdexElements<br>dexdexElements<br>ClassLoaderdexElementsdex</p>\n<h3 id=\"25\"><a href=\"#25\" class=\"headerlink\" title=\"25\"></a>25</h3><p>1<br><br><br><br><br></p>\n<p>2Android<br>Low memory Killerbad<br>OOM_ODJ</p>\n<p>3Android<br><br>Service<br>Native<br>JobScheduler<br></p>\n<h3 id=\"26Lint\"><a href=\"#26Lint\" class=\"headerlink\" title=\"26Lint\"></a>26Lint</h3><p>1Android Lint<br>Android LintAndroidBug</p>\n<p>2Lint<br><img src=\"/images/blogimages/2017/android_lint.png\" alt=\"\"></p>\n<p>3Lint<br>Lint.xmlLint<br>Java@suppressLint(NewApi)Lint<br>xmltool:ignore(UnusedResources)Lint<br>LintDetectorJavaPsiScanner</p>\n<h3 id=\"27Kotlin\"><a href=\"#27Kotlin\" class=\"headerlink\" title=\"27Kotlin\"></a>27Kotlin</h3><p>1Kotlin<br>KotlinJVM<br>JavaJava<br>Kotlin<br>KotlinJava</p>\n<p>2Kotlin<br>PluginKotlin<br>Kotlin</p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/08/17/IntervieweeQuestions/\">http://agehua.github.io/2017/08/17/IntervieweeQuestions/</a></p>\n</fragment>","readingTime":{"text":"6 min read","minutes":5.38,"time":322800,"words":1076},"excerpt":"<h3 id=\"1Activity\"><a href=\"#1Activity\" class=\"headerlink\" title=\"1Activity\"></a>1Activity</h3><p>1Activity<br>ActivityActivity</p>\n<p>2Activity<br>runing<br>paused<br>stopped<br>killed</p>\n<p>3Activity<br>onCreate()<br>onStart()<br>onResume()<br>onPause()<br>onStop()<br>onDestroy()<br>onRestart()</p>\n<p>4<br><br><br><br><br></p>\n<p>5Activity<br><br>","more":"<br>6Activity<br>standard<br>singletop<br>singletask: Activity A.</p>\n<blockquote>\n<p>startActivityForResultstartActivityForResultapi: if the activity you are launching uses the singleTask launch mode, it will not run in your task and thus you will immediately receive a cancel result<br>startActivityForResultsingleTaskActivityActivityRESULT_CANCELED</p>\n</blockquote>\n<p>singleinstance: singleInstanceactivitytaskactivitysingleTaskactivity</p>\n<blockquote>\n<p>singleInstanceactivityactivitysingleInstanceactivitysingleInstance</p>\n</blockquote>\n<p>7scheme<br>Androidschemeschemeapp<br>app<br>AppApp<br>H5DeepLink<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;a href=&quot;[scheme]://[host]/[path]?[query]&quot;&gt;&lt;/a&gt;</div></pre></td></tr></table></figure></p>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><div class=\"line\">&lt;intent-filter&gt;</div><div class=\"line\">    &lt;data android:scheme=\"http\" /&gt;</div><div class=\"line\">    &lt;!-- or you can use deep linking like  --&gt;</div><div class=\"line\">    &lt;data android:scheme=\"http\" android:host=\"xyz.abc.com\"/&gt;</div><div class=\"line\">    &lt;action android:name=\"android.intent.action.VIEW\"/&gt;</div><div class=\"line\">    &lt;category android:name=\"android.intent.category.BROWSABLE\"/&gt;</div><div class=\"line\">    &lt;category android:name=\"android.intent.category.DEFAULT\"/&gt;</div><div class=\"line\">&lt;/intent-filter&gt;</div></pre></td></tr></table></figure>\n<h3 id=\"2Fragment\"><a href=\"#2Fragment\" class=\"headerlink\" title=\"2Fragment\"></a>2Fragment</h3><p>1Fragment<br>FragmentActivityActivity</p>\n<p>2ActivityFragment<br>activityfragment<br>activity_main.xml</p>\n<fragment\n    android:name=\"com.example.myfragment.MyFragment\"\n    android:id=\"@+id/myfragment_1\"\n    android:layout_width=\"wrap_content\"\n    android:layout_height=\"wrap_content\"\n/>\n\n<p>javafragmentViewGroup<br>fragment = new MyFragment();<br>fragmentStack.push(fragment);<br>transaction = manager.beginTransaction();<br>transaction.add(R.id.fragments, fragment);<br>transaction.commit();</p>\n<p>3FragmentPageAdapterFragmentPageStateAdapter<br>FragmentPageAdapterFragmentFragment<br>FragmentPageStateAdapterFragmentFragment</p>\n<p>4Fragment<br>onAttach()<br>onCreate()<br>onCreateView()<br>onActivityCreated()<br>onStart()<br>onResume()<br>onPause()<br>onStop()<br>onDestroyView()<br>onDestroy()<br>onDetach()</p>\n<p>5Fragment<br>FragmentActivitygetActivity<br>ActivityFragment<br>FragmentFragmentFragmentManager.findFragmentById</p>\n<p>6Fragmentreplaceaddremove<br>replaceFragment<br>addFragment<br>removeFragment</p>\n<h3 id=\"3Service\"><a href=\"#3Service\" class=\"headerlink\" title=\"3Service\"></a>3Service</h3><p>1Service<br>Service</p>\n<p>2ServiceThread<br>ServiceANRThreadCPU<br>ServiceActivityServiceThreadActivityActivityThread</p>\n<p>3Service<br>startService<br>bindService</p>\n<p>4Service<br>startService<br>onCreate()<br>onStartCommand()<br>onDestroy()<br>bindService<br>onCreate()<br>onBind()<br>onUnbind()<br>onDestroy()</p>\n<h3 id=\"4Broadcast-Receiver\"><a href=\"#4Broadcast-Receiver\" class=\"headerlink\" title=\"4Broadcast Receiver\"></a>4Broadcast Receiver</h3><p>1Broadcast Receiver<br>BroadcastIntent</p>\n<p>2Broadcast Receiver<br>App<br>App</p>\n<p>3Broadcast Receiver<br><br> Context.sendOrderedBroadcast<br> LocalBroadcastManager.getInstance(context).sendBroadcast(intent) BroadcastReceiverContextBroadcastReceiver<br>Sticky sendStickyBroadcast(Intent)<uses-permission android:name=\"android.permission.BROADCAST_STICKY\"/><br>ContextremoveStickyBroadcast(Intent intent)<br>sticky StickyOrderedBroadcast</p>\n<p>4Broadcast Receiver<br>ActivityApp<br>Activity</p>\n<p>5Broadcast Receiver<br>BroadcastReceiveronReceiver()<br>BinderAMS<br>BinderAMS<br>AMSBroadcastReceiver<br>BroadcastReceiveronReceiver()</p>\n<p>6LocalBroadcastManager<br>App<br>AppApp<br><br>Handler</p>\n<h3 id=\"5WebView\"><a href=\"#5WebView\" class=\"headerlink\" title=\"5WebView\"></a>5WebView</h3><p>1WebView<br>API16WebView.addJavascriptInterfaceJavaJava</p>\n<p>2WebView<br>WebViewLinearLayoutActivityonDestroy()WebViewWebView.destroy()</p>\n<p>3WebViewjsbridge<br>Javascript</p>\n<p>4WebViewClientonPageFinished<br>WebViewClientonPageFinishedWebChromeClient.onProgressChanged</p>\n<p>5WebView<br>WebViewonDestroySystem.exit(0)java</p>\n<p>6WebView<br>Android3.0WebViewWebView</p>\n<p>7WebView<br>WebViewActivityActivityWebViewWebViewActivity<br><br>WebViewWebViewContext</p>\n<h3 id=\"6Binder\"><a href=\"#6Binder\" class=\"headerlink\" title=\"6Binder\"></a>6Binder</h3><p>1Linux</p>\n<p><img src=\"/images/blogimages/2017/binder-01.png\" alt=\"\"><br>/<br>Linux<br>binderbinder</p>\n<p>Binder  </p>\n<p>2Binder<br>Socket<br></p>\n<p>3Binder<br><img src=\"/images/blogimages/2017/binder-02.png\" alt=\"\"></p>\n<blockquote>\n<p></p>\n</blockquote>\n<p>1ClientServer &amp; Service Manager Binder open  ioctl</p>\n<p></p>\n<ol>\n<li>ClientServer &amp; Service Manager</li>\n<li>Binder    &amp; </li>\n</ol>\n<p>2 Binder &amp; Service Manager  AndroidClient   Server  Android</p>\n<p>Client &amp; Server   3 Android</p>\n<p><a href=\"http://blog.csdn.net/carson_ho/article/details/73560642\"> Android Binder </a></p>\n<p> Linux Androidlinux////SocketBinder </p>\n<ul>\n<li><br>BinderSocket2<br></li>\n<li><br>Binder  UID/PID  Binder  UID/PID <br><br>Socket ip</li>\n<li><br>Client/Server <br>  Binder</li>\n</ul>\n<p>4AIDL<br>aidlStub.asInterface()Proxy<br>Proxytransact()<br>transact()onTransact()<br>onTransact()</p>\n<h3 id=\"7Handler\"><a href=\"#7Handler\" class=\"headerlink\" title=\"7Handler\"></a>7Handler</h3><p>1Handler<br>HandlerMessageRunnableMessageQueue</p>\n<p>2Handler<br>post(runnable)<br>sendMessage(message)</p>\n<p>3Handler<br><a href=\"http://blog.csdn.net/qq_30379689/article/details/53394061\">AndroidAndroidLooperHandlerMessageQueen</a></p>\n<p>4Handler<br>Activity<br><br>HandlerActivity<br>Handler<br>Handler.removeCallback()</p>\n<h3 id=\"8AsyncTask\"><a href=\"#8AsyncTask\" class=\"headerlink\" title=\"8AsyncTask\"></a>8AsyncTask</h3><p>1AsyncTask<br>Handler</p>\n<p>2AsyncTask<br><br>ParamsAysncTask <strong>doInBackground()</strong> <br>Progress <strong>onProgressUpdate()</strong> <br>Result <strong>onPostExecute()</strong> <br><br>onPreExecute()<br>doInBackground()<br>onProgressUpdate()doInBackgroundpublishProgress<br>onPostExecute()<br>onCancelled()</p>\n<p>3AsyncTask<br>AndroidAsyncTask<br><a href=\"http://blog.csdn.net/qq_30379689/article/details/53203556\">http://blog.csdn.net/qq_30379689/article/details/53203556</a></p>\n<p>4AsyncTask<br>Activity<br><br>AsyncTaskActivity<br>AsyncTask<br>AsyncTask.cancel()</p>\n<p>5AsyncTask<br>ActivityAsyncTask</p>\n<p>6AsyncTask<br>ActivityActivityAsyncTaskActivityAsyncTask <strong>onPostExecute()UI</strong></p>\n<p>7AsyncTaskor<br>AsyncTaskAndroid 2.3AsyncTaskAndroid 2.3<br>Android 2.3AsyncTaskexecuteOnExecutor()</p>\n<h3 id=\"9HandlerThread\"><a href=\"#9HandlerThread\" class=\"headerlink\" title=\"9HandlerThread\"></a>9HandlerThread</h3><p>1HandlerThread<br>GoogleHandlerThreadHandlerThreadLooperLooper</p>\n<p>2HanlderThread<br>HandlerThreadThread<br>HandlerThreadLooperLooperHandler<br>HandlerThreadHandlerhandlerMessage<br>HandlerThread<br>HandlerThread<br>HandlerThreadHandlerThread</p>\n<h3 id=\"10IntentService\"><a href=\"#10IntentService\" class=\"headerlink\" title=\"10IntentService\"></a>10IntentService</h3><p>1IntentService<br>IntentServiceServiceHandlerThreadHandlerIntentServiceServiceIntentServicestopSelf()IntentServiceIntentService <strong>onHandlerIntent()</strong> </p>\n<p>2IntentService<br>ServiceIntentService<br>onHandlerIntent()<br>onHandlerIntent()</p>\n<h3 id=\"11\"><a href=\"#11\" class=\"headerlink\" title=\"11\"></a>11</h3><p><a href=\"http://blog.csdn.net/qq_30379689/article/details/54588736\">AndroidAndroidmeasurelayoutdraw</a></p>\n<p><a href=\"http://blog.csdn.net/qq_30379689/article/details/53967177\">AndroiddispatchTouchEventonInterceptTouchEventonTouchEvent</a></p>\n<h3 id=\"12ListView\"><a href=\"#12ListView\" class=\"headerlink\" title=\"12ListView\"></a>12ListView</h3><p>1ListView<br>ListViewView</p>\n<p>2ListViewRecycleBin</p>\n<p><img src=\"/images/blogimages/2017/listview_recyclebin.png\" alt=\"\"></p>\n<p>3ListView<br>convertView<br>ViewHolder<br><br><br>View<br></p>\n<h3 id=\"13Android\"><a href=\"#13Android\" class=\"headerlink\" title=\"13Android\"></a>13Android</h3><p>1android</p>\n<p><img src=\"/images/blogimages/2017/android_build_process.png\" alt=\"\"></p>\n<p>2jenkins<br><a href=\"http://www.pgyer.com/doc/view/jenkins\"></a></p>\n<p>3Git<br>git init<br>git status<br>git diff<br>git add<br>git commit<br>git clone<br>git bransh<br>git checkout</p>\n<p>4git<br>fork/clone<br>forkfork<br>clone<br>updatecommit<br>push<br>pull request<br>clone</p>\n<p>5proguard<br>ProGuard</p>\n<p>6proguard<br><br><br><br></p>\n<p>7proguard<br>EntryPointEntryPoint</p>\n<p>8<br>JavaclassclassJava</p>\n<h3 id=\"14ANR\"><a href=\"#14ANR\" class=\"headerlink\" title=\"14ANR\"></a>14ANR</h3><p>1ANR<br>Application Not Responding</p>\n<p>2ANR<br>ActivityManagerWindowManagerANRANR<br>Activity5<br>BroadcastReceiver10<br>Service20</p>\n<p>3ANR<br>IO<br>Activity<br>Service<br>BoardcastReceiveronReceive()<br>AsyncTaskdoInBackground<br>LooperHandlerhandlerMessagepost(Runnable)</p>\n<p>4ANR<br>AsyncTaskIO<br>ThreadHandlerThread<br>Handler<br>ActivityonCreateonResume</p>\n<h3 id=\"15OOM\"><a href=\"#15OOM\" class=\"headerlink\" title=\"15OOM\"></a>15OOM</h3><p>1OOM<br>OOMOut of memoryDalvikOut of memory</p>\n<p>2OOM<br><br><br></p>\n<p>3OOM<br>Bitmap<br><br><br><br>Bitmap<br>inBitmap<br><br><br>listviewconvertViewLruCache<br>onDraw<br></p>\n<h3 id=\"16Bitmap\"><a href=\"#16Bitmap\" class=\"headerlink\" title=\"16Bitmap\"></a>16Bitmap</h3><p>1recycle<br>3.0Bitmap<br>3.0BitmapnativeJava<br>3.0recycleBitmap<br>recycleBitmapnativeJavaBitmapdead<br>recyclegetPixels()</p>\n<p>2LruCache<br>LruCacheLinkedHashMapgetputtrimToSize</p>\n<p>3inSampleSize<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> <span class=\"title\">calculateInSampleSize</span><span class=\"params\">(BitmapFactory.Options options, <span class=\"keyword\">int</span> reqWidth, <span class=\"keyword\">int</span> reqHeight)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> height = options.outHeight;</div><div class=\"line\">    <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> width = options.outWidth;</div><div class=\"line\">    <span class=\"keyword\">int</span> inSampleSize = <span class=\"number\">1</span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">if</span> (height &gt; reqHeight || width &gt; reqWidth) &#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (width &gt; height) &#123;</div><div class=\"line\">            inSampleSize = Math.round((<span class=\"keyword\">float</span>)height / (<span class=\"keyword\">float</span>)reqHeight);</div><div class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">            inSampleSize = Math.round((<span class=\"keyword\">float</span>)width / (<span class=\"keyword\">float</span>)reqWidth);</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> inSampleSize;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>4<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Bitmap <span class=\"title\">thumbnail</span><span class=\"params\">(String path,<span class=\"keyword\">int</span> maxWidth, <span class=\"keyword\">int</span> maxHeight, <span class=\"keyword\">boolean</span> autoRotate)</span> </span>&#123;</div><div class=\"line\">    BitmapFactory.Options options = <span class=\"keyword\">new</span> BitmapFactory.Options();</div><div class=\"line\">    options.inJustDecodeBounds = <span class=\"keyword\">true</span>;</div><div class=\"line\">    Bitmap bitmap = BitmapFactory.decodeFile(path, options);</div><div class=\"line\">    options.inJustDecodeBounds = <span class=\"keyword\">false</span>;</div><div class=\"line\">    <span class=\"keyword\">int</span> sampleSize = calculateInSampleSize(options, maxWidth, maxHeight);</div><div class=\"line\">    options.inSampleSize = sampleSize;</div><div class=\"line\">    options.inPreferredConfig = Bitmap.Config.RGB_565;</div><div class=\"line\">    options.inPurgeable = <span class=\"keyword\">true</span>;</div><div class=\"line\">    options.inInputShareable = <span class=\"keyword\">true</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (bitmap != <span class=\"keyword\">null</span> &amp;&amp; !bitmap.isRecycled()) &#123;</div><div class=\"line\">        bitmap.recycle();</div><div class=\"line\">    &#125;</div><div class=\"line\">    bitmap = BitmapFactory.decodeFile(path, options);</div><div class=\"line\">    <span class=\"keyword\">return</span> bitmap;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>5Bitmap<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">save</span><span class=\"params\">(Bitmap bitmap,Bitmap.CompressFormat format, <span class=\"keyword\">int</span> quality, File destFile)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">        FileOutputStream out = <span class=\"keyword\">new</span> FileOutputStream(destFile);</div><div class=\"line\">        <span class=\"keyword\">if</span> (bitmap.compress(format, quality, out)) &#123;</div><div class=\"line\">            out.flush();</div><div class=\"line\">            out.close();</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">if</span> (bitmap != <span class=\"keyword\">null</span> &amp;&amp; !bitmap.isRecycled()) &#123;</div><div class=\"line\">            bitmap.recycle();</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">return</span> destFile.getAbsolutePath();</div><div class=\"line\">    &#125; <span class=\"keyword\">catch</span> (FileNotFoundException e) &#123;</div><div class=\"line\">        e.printStackTrace();</div><div class=\"line\">    &#125; <span class=\"keyword\">catch</span> (IOException e) &#123;</div><div class=\"line\">        e.printStackTrace();</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>6SD</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">save</span><span class=\"params\">(Bitmap bitmap,Bitmap.CompressFormat format, <span class=\"keyword\">int</span> quality, Context context)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (!Environment.getExternalStorageState()</div><div class=\"line\">            .equals(Environment.MEDIA_MOUNTED)) &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\">    File dir = <span class=\"keyword\">new</span> File(Environment.getExternalStorageDirectory()</div><div class=\"line\">            + <span class=\"string\">\"/\"</span> + context.getPackageName() + <span class=\"string\">\"/save/\"</span>);</div><div class=\"line\">    <span class=\"keyword\">if</span> (!dir.exists()) &#123;</div><div class=\"line\">        dir.mkdirs();</div><div class=\"line\">    &#125;</div><div class=\"line\">    File destFile = <span class=\"keyword\">new</span> File(dir, UUID.randomUUID().toString());</div><div class=\"line\">    <span class=\"keyword\">return</span> save(bitmap, format, quality, destFile);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>7<br><br><br></p>\n<h3 id=\"17UI\"><a href=\"#17UI\" class=\"headerlink\" title=\"17UI\"></a>17UI</h3><p>1UI<br>View60fps16ms1000/6016ms</p>\n<p>2UI<br>UIUI<br>Layout16ms<br>CPUGPU<br>overDrawCPUGPU<br>ViewmeasurelayoutmeasurelayoutView<br>GC16ms<br><br>ANR</p>\n<p>3UI<br><br>includeViewStubmerge<br><br>ViewView<br>ListView<br>convertView<br><br><br><br><br>ANR<br>UI</p>\n<h3 id=\"18\"><a href=\"#18\" class=\"headerlink\" title=\"18\"></a>18</h3><p>1Java<br></p>\n<p>2Java<br><br><br>newJava</p>\n<p>3Android<br>context.getApplicationContext()context<br>static<br>HandlerstaticHandlerContext<br>staticstaticActivityActivitystaticstatic<br>SocketBroadcastCursorBitmapListView<br>AsyncTaskAsyncTaskActivityonDestroy()AsyncTask.cancel()</p>\n<h3 id=\"19\"><a href=\"#19\" class=\"headerlink\" title=\"19\"></a>19</h3><p>1Android<br><br></p>\n<p>2<br><br><br><br></p>\n<p>3<br>ServiceIntentServiceService<br>UIUI<br><br>Bitmap<br><br><br>ZIPAPK<br></p>\n<h3 id=\"20\"><a href=\"#20\" class=\"headerlink\" title=\"20\"></a>20</h3><p>1<br><br></p>\n<p>2<br>ApplicationMainActivity<br>MainActivity</p>\n<p>3<br></p>\n<p>4<br>Zygotefork<br>ApplicationMainActivity<br>inflateonCreate/onStart/onResume<br>contentViewmeasure/layout/draw<br>Application-&gt;attachBaseContext()-&gt;onCreate()-&gt;Activity-&gt;onCreate()-&gt;-&gt;onStart()-&gt;onResume()-&gt;</p>\n<p>5<br>onCreate()<br>Application<br>Application<br>Application<br><br>mainThread<br>SDK</p>\n<h3 id=\"21\"><a href=\"#21\" class=\"headerlink\" title=\"21\"></a>21</h3><p>1Android<br><br>/sp/contentProvider</p>\n<p>2SharePreference<br><br></p>\n<p>3<br>SerializeblejavaSerializebleGC<br>ParcelableAndroidSerializebleParcelable</p>\n<p>4UI</p>\n<h3 id=\"22\"><a href=\"#22\" class=\"headerlink\" title=\"22\"></a>22</h3><p>AndroidMVC<br><a href=\"http://blog.csdn.net/qq_30379689/article/details/52909656\">http://blog.csdn.net/qq_30379689/article/details/52909656</a><br>AndroidMVP<br><a href=\"http://blog.csdn.net/qq_30379689/article/details/52910567\">http://blog.csdn.net/qq_30379689/article/details/52910567</a><br>AndroidMVVMDataBinding<br><a href=\"http://blog.csdn.net/qq_30379689/article/details/53037430\">http://blog.csdn.net/qq_30379689/article/details/53037430</a></p>\n<h3 id=\"23\"><a href=\"#23\" class=\"headerlink\" title=\"23\"></a>23</h3><p>1<br>APK<br>AssetManager<br></p>\n<p>2Java<br>DexClassLoaderjar/apk/dex<br>PathClassLoaderapk</p>\n<h3 id=\"24\"><a href=\"#24\" class=\"headerlink\" title=\"24\"></a>24</h3><p>1<br>Crash<br>BugfixCrash<br>jenkins<br>app<br>Bugfixmaster</p>\n<p>2<br>Dexposed<br>AndFix<br>Nuwa<br>Tinker</p>\n<p>3<br>ClassLoaderdexElements<br>dexdexElements<br>ClassLoaderdexElementsdex</p>\n<h3 id=\"25\"><a href=\"#25\" class=\"headerlink\" title=\"25\"></a>25</h3><p>1<br><br><br><br><br></p>\n<p>2Android<br>Low memory Killerbad<br>OOM_ODJ</p>\n<p>3Android<br><br>Service<br>Native<br>JobScheduler<br></p>\n<h3 id=\"26Lint\"><a href=\"#26Lint\" class=\"headerlink\" title=\"26Lint\"></a>26Lint</h3><p>1Android Lint<br>Android LintAndroidBug</p>\n<p>2Lint<br><img src=\"/images/blogimages/2017/android_lint.png\" alt=\"\"></p>\n<p>3Lint<br>Lint.xmlLint<br>Java@suppressLint(NewApi)Lint<br>xmltool:ignore(UnusedResources)Lint<br>LintDetectorJavaPsiScanner</p>\n<h3 id=\"27Kotlin\"><a href=\"#27Kotlin\" class=\"headerlink\" title=\"27Kotlin\"></a>27Kotlin</h3><p>1Kotlin<br>KotlinJVM<br>JavaJava<br>Kotlin<br>KotlinJava</p>\n<p>2Kotlin<br>PluginKotlin<br>Kotlin</p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/08/17/IntervieweeQuestions/\">http://agehua.github.io/2017/08/17/IntervieweeQuestions/</a></p>"},{"layout":"post","title":"PBOC","keywords":"pboc, pboc2.0","banner":"http://obxk8w81b.bkt.clouddn.com/Daubigny%20s%20Garden.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Daubigny%20s%20Garden.jpg","toc":true,"_content":"\n## PBOC\nIC2\n### \n(POS)(PIN)\n\n#### (INITIALIZE FOR PURCHASE)\n\n\n<!--more-->\n~~~ Java\n                               CLA  INS   P1   P2\n(INITIALIZE FOR PURCHASE) 80 50 01 0X\n~~~\n> APDUApplication Protocol data unit), \n\nAPDU**CLA    INS  P1  P2  Lc  Data  Le**\nCLAINSP1P2LcDataLe0\n\nCOS4\n 1CLA INS P1 P2 00\n 2CLA INS P1 P2 Le\n 3CLA INS P1 P2 Lc Data\n 4CLA INS P1 P2 Lc Data Le\n\n\n\n![](/images/blogimages/2017/Initialize_for_purchase.png)\n![](/images/blogimages/2017/Initialize_for_purchase_data.png)\n\n\n\n~~~ Java\n  \nData      SW1 SW1\n~~~\nDATA \nSW1SW2 \n> SW1SW2900061 xxxxGET REPONSEIC\n\nLe 0F15\n\n![](/images/blogimages/2017/Initialize_for_purchase_responce.png)\n\n> 8bit4bit160-9 A-F16\n\n#### VERIFY \n\nVERIFY\nPINPIN;PINMF PIN\n\n\n\n|**|**|\n|:--------:|:-------:|\n|CLA|00|\n|INS|20|\n|P1|00|\n|P2|00|\n|Lc||\n|Data||\n|Le||\n\nP2=00ICVERIFY\n> PIN4122-6\n\n9000\nIC SW2=Cxx;C0 VERIFYSW1 SW2=6983\n\nIC48\n![](/images/blogimages/2017/pin_verify.png)\n\n### \n\n~~~ Java\n/**\n  * 16\n  *\n  * @param hex\n  * @return\n  */\npublic static byte[] hexStringToByte(String hex) {\n    int len = (hex.length() / 2);\n    byte[] result = new byte[len];\n    char[] achar = hex.toCharArray();\n    for (int i = 0; i < len; i++) {\n        int pos = i * 2;\n        result[i] = (byte) (toByte(achar[pos]) << 4 | toByte(achar[pos + 1]));\n    }\n    return result;\n}\n\nprivate static byte toByte(char c) {\n    byte b = (byte) \"0123456789ABCDEF\".indexOf(c);\n    return b;\n}\n\n/**\n * 16\n *\n * @param bArray\n * @return\n */\npublic static final String bytesToHexString(byte[] bArray) {\n    if(bArray == null )\n    {\n        return \"\";\n    }\n    StringBuffer sb = new StringBuffer(bArray.length);\n    String sTemp;\n    for (int i = 0; i < bArray.length; i++) {\n        sTemp = Integer.toHexString(0xFF & bArray[i]);\n        if (sTemp.length() < 2)\n            sb.append(0);\n        sb.append(sTemp.toUpperCase());\n    }\n    return sb.toString();\n}\n~~~\n\nIC****byte[]\n~~~ Java\npublic static String IntToHex(int n){\n  char[] ch = new char[20];\n  int nIndex = 0;\n    while ( true ){\n        int m = n/16;\n        int k = n%16;\n        if ( k == 15 )\n            ch[nIndex] = 'F';\n        else if ( k == 14 )\n            ch[nIndex] = 'E';\n        else if ( k == 13 )\n            ch[nIndex] = 'D';\n        else if ( k == 12 )\n            ch[nIndex] = 'C';\n        else if ( k == 11 )\n            ch[nIndex] = 'B';\n        else if ( k == 10 )\n            ch[nIndex] = 'A';\n        else\n            ch[nIndex] = (char)('0' + k);\n        nIndex++;\n        if ( m == 0 )\n            break;\n        n = m;\n    }\n    StringBuffer sb = new StringBuffer();\n    sb.append(ch, 0, nIndex);\n    sb.reverse();\n    String strHex = new String(\"\");\n    strHex += sb.toString();\n    return strHex;\n}\n\npublic static byte[] hexStringToByteArray(String s) {\n    if (TextUtils.isEmpty(s))\n        return null;\n    int len = s.length();\n    String append= \"\";\n    switch (len){\n        case 1:\n            s = \"0000000\"+s;\n            break;\n        case 2:\n            s = \"000000\"+s;\n            break;\n        case 3:\n            s = \"00000\"+s;\n            break;\n        case 4:\n            s = \"0000\"+s;\n            break;\n        case 5:\n            s = \"000\"+s;\n            break;\n        case 6:\n            s = \"00\"+s;\n            break;\n        case 7:\n            s = \"0\"+s;\n            break;\n        case 8:\n            break;\n    }\n    len = s.length();\n    byte[] b = new byte[len / 2];\n    for (int i = 0; i < len; i += 2) {\n        // ,16\n        b[i / 2] = (byte) ((Character.digit(s.charAt(i), 16) << 4) + Character\n                .digit(s.charAt(i + 1), 16));\n    }\n    return b;\n}\n\n/**\n * \n */\npublic static byte[] intTo4HexByte(int num){\n    return hexStringToByteArray(IntToHex(num));\n}\n~~~\n\nHexGBK\n~~~ Java\npublic static String decode(String hexStr) throws UnsupportedEncodingException {\n    if (null == hexStr || \"\".equals(hexStr) || (hexStr.length()) % 2 != 0) {\n        return null;\n    }\n\n    int byteLength = hexStr.length() / 2;\n    byte[] bytes = new byte[byteLength];\n\n    int temp = 0;\n    for (int i = 0; i < byteLength; i++) {\n        temp = hex2Dec(hexStr.charAt(2 * i)) * 16 + hex2Dec(hexStr.charAt(2 * i + 1));\n        bytes[i] = (byte) (temp < 128 ? temp : temp - 256);\n    }\n    return new String(bytes,\"GBK\");\n}\n\nprivate static int hex2Dec(char ch) {\n    if (ch == '0')\n        return 0;\n    if (ch == '1')\n        return 1;\n    if (ch == '2')\n        return 2;\n    if (ch == '3')\n        return 3;\n    if (ch == '4')\n        return 4;\n    if (ch == '5')\n        return 5;\n    if (ch == '6')\n        return 6;\n    if (ch == '7')\n        return 7;\n    if (ch == '8')\n        return 8;\n    if (ch == '9')\n        return 9;\n    if (ch == 'a')\n        return 10;\n    if (ch == 'A')\n        return 10;\n    if (ch == 'B')\n        return 11;\n    if (ch == 'b')\n        return 11;\n    if (ch == 'C')\n        return 12;\n    if (ch == 'c')\n        return 12;\n    if (ch == 'D')\n        return 13;\n    if (ch == 'd')\n        return 13;\n    if (ch == 'E')\n        return 14;\n    if (ch == 'e')\n        return 14;\n    if (ch == 'F')\n        return 15;\n    if (ch == 'f')\n        return 15;\n    else\n        return -1;\n\n}\n~~~\n","source":"_posts/2017-09-21-PBOCKonwledgeCode.md","raw":"---\nlayout: post\ntitle:  PBOC\ncategory: accumulation\ntags:\n    - PBOC\n    - PBOC 2.0\n    - Basic Knowledge\nkeywords: pboc, pboc2.0\nbanner: http://obxk8w81b.bkt.clouddn.com/Daubigny%20s%20Garden.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Daubigny%20s%20Garden.jpg\ntoc: true\n---\n\n## PBOC\nIC2\n### \n(POS)(PIN)\n\n#### (INITIALIZE FOR PURCHASE)\n\n\n<!--more-->\n~~~ Java\n                               CLA  INS   P1   P2\n(INITIALIZE FOR PURCHASE) 80 50 01 0X\n~~~\n> APDUApplication Protocol data unit), \n\nAPDU**CLA    INS  P1  P2  Lc  Data  Le**\nCLAINSP1P2LcDataLe0\n\nCOS4\n 1CLA INS P1 P2 00\n 2CLA INS P1 P2 Le\n 3CLA INS P1 P2 Lc Data\n 4CLA INS P1 P2 Lc Data Le\n\n\n\n![](/images/blogimages/2017/Initialize_for_purchase.png)\n![](/images/blogimages/2017/Initialize_for_purchase_data.png)\n\n\n\n~~~ Java\n  \nData      SW1 SW1\n~~~\nDATA \nSW1SW2 \n> SW1SW2900061 xxxxGET REPONSEIC\n\nLe 0F15\n\n![](/images/blogimages/2017/Initialize_for_purchase_responce.png)\n\n> 8bit4bit160-9 A-F16\n\n#### VERIFY \n\nVERIFY\nPINPIN;PINMF PIN\n\n\n\n|**|**|\n|:--------:|:-------:|\n|CLA|00|\n|INS|20|\n|P1|00|\n|P2|00|\n|Lc||\n|Data||\n|Le||\n\nP2=00ICVERIFY\n> PIN4122-6\n\n9000\nIC SW2=Cxx;C0 VERIFYSW1 SW2=6983\n\nIC48\n![](/images/blogimages/2017/pin_verify.png)\n\n### \n\n~~~ Java\n/**\n  * 16\n  *\n  * @param hex\n  * @return\n  */\npublic static byte[] hexStringToByte(String hex) {\n    int len = (hex.length() / 2);\n    byte[] result = new byte[len];\n    char[] achar = hex.toCharArray();\n    for (int i = 0; i < len; i++) {\n        int pos = i * 2;\n        result[i] = (byte) (toByte(achar[pos]) << 4 | toByte(achar[pos + 1]));\n    }\n    return result;\n}\n\nprivate static byte toByte(char c) {\n    byte b = (byte) \"0123456789ABCDEF\".indexOf(c);\n    return b;\n}\n\n/**\n * 16\n *\n * @param bArray\n * @return\n */\npublic static final String bytesToHexString(byte[] bArray) {\n    if(bArray == null )\n    {\n        return \"\";\n    }\n    StringBuffer sb = new StringBuffer(bArray.length);\n    String sTemp;\n    for (int i = 0; i < bArray.length; i++) {\n        sTemp = Integer.toHexString(0xFF & bArray[i]);\n        if (sTemp.length() < 2)\n            sb.append(0);\n        sb.append(sTemp.toUpperCase());\n    }\n    return sb.toString();\n}\n~~~\n\nIC****byte[]\n~~~ Java\npublic static String IntToHex(int n){\n  char[] ch = new char[20];\n  int nIndex = 0;\n    while ( true ){\n        int m = n/16;\n        int k = n%16;\n        if ( k == 15 )\n            ch[nIndex] = 'F';\n        else if ( k == 14 )\n            ch[nIndex] = 'E';\n        else if ( k == 13 )\n            ch[nIndex] = 'D';\n        else if ( k == 12 )\n            ch[nIndex] = 'C';\n        else if ( k == 11 )\n            ch[nIndex] = 'B';\n        else if ( k == 10 )\n            ch[nIndex] = 'A';\n        else\n            ch[nIndex] = (char)('0' + k);\n        nIndex++;\n        if ( m == 0 )\n            break;\n        n = m;\n    }\n    StringBuffer sb = new StringBuffer();\n    sb.append(ch, 0, nIndex);\n    sb.reverse();\n    String strHex = new String(\"\");\n    strHex += sb.toString();\n    return strHex;\n}\n\npublic static byte[] hexStringToByteArray(String s) {\n    if (TextUtils.isEmpty(s))\n        return null;\n    int len = s.length();\n    String append= \"\";\n    switch (len){\n        case 1:\n            s = \"0000000\"+s;\n            break;\n        case 2:\n            s = \"000000\"+s;\n            break;\n        case 3:\n            s = \"00000\"+s;\n            break;\n        case 4:\n            s = \"0000\"+s;\n            break;\n        case 5:\n            s = \"000\"+s;\n            break;\n        case 6:\n            s = \"00\"+s;\n            break;\n        case 7:\n            s = \"0\"+s;\n            break;\n        case 8:\n            break;\n    }\n    len = s.length();\n    byte[] b = new byte[len / 2];\n    for (int i = 0; i < len; i += 2) {\n        // ,16\n        b[i / 2] = (byte) ((Character.digit(s.charAt(i), 16) << 4) + Character\n                .digit(s.charAt(i + 1), 16));\n    }\n    return b;\n}\n\n/**\n * \n */\npublic static byte[] intTo4HexByte(int num){\n    return hexStringToByteArray(IntToHex(num));\n}\n~~~\n\nHexGBK\n~~~ Java\npublic static String decode(String hexStr) throws UnsupportedEncodingException {\n    if (null == hexStr || \"\".equals(hexStr) || (hexStr.length()) % 2 != 0) {\n        return null;\n    }\n\n    int byteLength = hexStr.length() / 2;\n    byte[] bytes = new byte[byteLength];\n\n    int temp = 0;\n    for (int i = 0; i < byteLength; i++) {\n        temp = hex2Dec(hexStr.charAt(2 * i)) * 16 + hex2Dec(hexStr.charAt(2 * i + 1));\n        bytes[i] = (byte) (temp < 128 ? temp : temp - 256);\n    }\n    return new String(bytes,\"GBK\");\n}\n\nprivate static int hex2Dec(char ch) {\n    if (ch == '0')\n        return 0;\n    if (ch == '1')\n        return 1;\n    if (ch == '2')\n        return 2;\n    if (ch == '3')\n        return 3;\n    if (ch == '4')\n        return 4;\n    if (ch == '5')\n        return 5;\n    if (ch == '6')\n        return 6;\n    if (ch == '7')\n        return 7;\n    if (ch == '8')\n        return 8;\n    if (ch == '9')\n        return 9;\n    if (ch == 'a')\n        return 10;\n    if (ch == 'A')\n        return 10;\n    if (ch == 'B')\n        return 11;\n    if (ch == 'b')\n        return 11;\n    if (ch == 'C')\n        return 12;\n    if (ch == 'c')\n        return 12;\n    if (ch == 'D')\n        return 13;\n    if (ch == 'd')\n        return 13;\n    if (ch == 'E')\n        return 14;\n    if (ch == 'e')\n        return 14;\n    if (ch == 'F')\n        return 15;\n    if (ch == 'f')\n        return 15;\n    else\n        return -1;\n\n}\n~~~\n","slug":"PBOCKonwledgeCode","published":1,"date":"2017-09-20T16:00:00.000Z","updated":"2017-12-07T06:34:43.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ec1m003wd6ykyl2lev0o","content":"<h2 id=\"PBOC\"><a href=\"#PBOC\" class=\"headerlink\" title=\"PBOC\"></a>PBOC</h2><p>IC2</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>(POS)(PIN)</p>\n<h4 id=\"-INITIALIZE-FOR-PURCHASE-\"><a href=\"#-INITIALIZE-FOR-PURCHASE-\" class=\"headerlink\" title=\"(INITIALIZE FOR PURCHASE)\"></a>(INITIALIZE FOR PURCHASE)</h4><p></p>\n<a id=\"more\"></a>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">                               CLA  INS   P1   P2</div><div class=\"line\">(INITIALIZE FOR PURCHASE) <span class=\"number\">80</span> <span class=\"number\">50</span> <span class=\"number\">01</span> <span class=\"number\">0</span>X</div></pre></td></tr></table></figure>\n<blockquote>\n<p>APDUApplication Protocol data unit), </p>\n</blockquote>\n<p>APDU<strong>CLA    INS  P1  P2  Lc  Data  Le</strong><br>CLAINSP1P2LcDataLe0</p>\n<p>COS4<br> 1CLA INS P1 P2 00<br> 2CLA INS P1 P2 Le<br> 3CLA INS P1 P2 Lc Data<br> 4CLA INS P1 P2 Lc Data Le</p>\n<p></p>\n<p><img src=\"/images/blogimages/2017/Initialize_for_purchase.png\" alt=\"\"><br><img src=\"/images/blogimages/2017/Initialize_for_purchase_data.png\" alt=\"\"></p>\n<p><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">  </div><div class=\"line\">Data      SW1 SW1</div></pre></td></tr></table></figure></p>\n<p>DATA <br>SW1SW2 </p>\n<blockquote>\n<p>SW1SW2900061 xxxxGET REPONSEIC</p>\n</blockquote>\n<p>Le 0F15</p>\n<p><img src=\"/images/blogimages/2017/Initialize_for_purchase_responce.png\" alt=\"\"></p>\n<blockquote>\n<p>8bit4bit160-9 A-F16</p>\n</blockquote>\n<h4 id=\"VERIFY-\"><a href=\"#VERIFY-\" class=\"headerlink\" title=\"VERIFY \"></a>VERIFY </h4><p><br>VERIFY<br>PINPIN;PINMF PIN</p>\n<p></p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\"><em></em></th>\n<th style=\"text-align:center\"><em></em></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">CLA</td>\n<td style=\"text-align:center\">00</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">INS</td>\n<td style=\"text-align:center\">20</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">P1</td>\n<td style=\"text-align:center\">00</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">P2</td>\n<td style=\"text-align:center\">00</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Lc</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Data</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Le</td>\n<td style=\"text-align:center\"></td>\n</tr>\n</tbody>\n</table>\n<p>P2=00ICVERIFY</p>\n<blockquote>\n<p>PIN4122-6</p>\n</blockquote>\n<p>9000<br>IC SW2=Cxx;C0 VERIFYSW1 SW2=6983</p>\n<p>IC48<br><img src=\"/images/blogimages/2017/pin_verify.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\">  * 16</div><div class=\"line\">  *</div><div class=\"line\">  * <span class=\"doctag\">@param</span> hex</div><div class=\"line\">  * <span class=\"doctag\">@return</span></div><div class=\"line\">  */</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">byte</span>[] hexStringToByte(String hex) &#123;</div><div class=\"line\">    <span class=\"keyword\">int</span> len = (hex.length() / <span class=\"number\">2</span>);</div><div class=\"line\">    <span class=\"keyword\">byte</span>[] result = <span class=\"keyword\">new</span> <span class=\"keyword\">byte</span>[len];</div><div class=\"line\">    <span class=\"keyword\">char</span>[] achar = hex.toCharArray();</div><div class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; len; i++) &#123;</div><div class=\"line\">        <span class=\"keyword\">int</span> pos = i * <span class=\"number\">2</span>;</div><div class=\"line\">        result[i] = (<span class=\"keyword\">byte</span>) (toByte(achar[pos]) &lt;&lt; <span class=\"number\">4</span> | toByte(achar[pos + <span class=\"number\">1</span>]));</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> result;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">byte</span> <span class=\"title\">toByte</span><span class=\"params\">(<span class=\"keyword\">char</span> c)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">byte</span> b = (<span class=\"keyword\">byte</span>) <span class=\"string\">\"0123456789ABCDEF\"</span>.indexOf(c);</div><div class=\"line\">    <span class=\"keyword\">return</span> b;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * 16</div><div class=\"line\"> *</div><div class=\"line\"> * <span class=\"doctag\">@param</span> bArray</div><div class=\"line\"> * <span class=\"doctag\">@return</span></div><div class=\"line\"> */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String <span class=\"title\">bytesToHexString</span><span class=\"params\">(<span class=\"keyword\">byte</span>[] bArray)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span>(bArray == <span class=\"keyword\">null</span> )</div><div class=\"line\">    &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"\"</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\">    StringBuffer sb = <span class=\"keyword\">new</span> StringBuffer(bArray.length);</div><div class=\"line\">    String sTemp;</div><div class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; bArray.length; i++) &#123;</div><div class=\"line\">        sTemp = Integer.toHexString(<span class=\"number\">0xFF</span> &amp; bArray[i]);</div><div class=\"line\">        <span class=\"keyword\">if</span> (sTemp.length() &lt; <span class=\"number\">2</span>)</div><div class=\"line\">            sb.append(<span class=\"number\">0</span>);</div><div class=\"line\">        sb.append(sTemp.toUpperCase());</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> sb.toString();</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>IC<strong></strong>byte[]<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">IntToHex</span><span class=\"params\">(<span class=\"keyword\">int</span> n)</span></span>&#123;</div><div class=\"line\">  <span class=\"keyword\">char</span>[] ch = <span class=\"keyword\">new</span> <span class=\"keyword\">char</span>[<span class=\"number\">20</span>];</div><div class=\"line\">  <span class=\"keyword\">int</span> nIndex = <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"keyword\">while</span> ( <span class=\"keyword\">true</span> )&#123;</div><div class=\"line\">        <span class=\"keyword\">int</span> m = n/<span class=\"number\">16</span>;</div><div class=\"line\">        <span class=\"keyword\">int</span> k = n%<span class=\"number\">16</span>;</div><div class=\"line\">        <span class=\"keyword\">if</span> ( k == <span class=\"number\">15</span> )</div><div class=\"line\">            ch[nIndex] = <span class=\"string\">'F'</span>;</div><div class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> ( k == <span class=\"number\">14</span> )</div><div class=\"line\">            ch[nIndex] = <span class=\"string\">'E'</span>;</div><div class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> ( k == <span class=\"number\">13</span> )</div><div class=\"line\">            ch[nIndex] = <span class=\"string\">'D'</span>;</div><div class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> ( k == <span class=\"number\">12</span> )</div><div class=\"line\">            ch[nIndex] = <span class=\"string\">'C'</span>;</div><div class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> ( k == <span class=\"number\">11</span> )</div><div class=\"line\">            ch[nIndex] = <span class=\"string\">'B'</span>;</div><div class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> ( k == <span class=\"number\">10</span> )</div><div class=\"line\">            ch[nIndex] = <span class=\"string\">'A'</span>;</div><div class=\"line\">        <span class=\"keyword\">else</span></div><div class=\"line\">            ch[nIndex] = (<span class=\"keyword\">char</span>)(<span class=\"string\">'0'</span> + k);</div><div class=\"line\">        nIndex++;</div><div class=\"line\">        <span class=\"keyword\">if</span> ( m == <span class=\"number\">0</span> )</div><div class=\"line\">            <span class=\"keyword\">break</span>;</div><div class=\"line\">        n = m;</div><div class=\"line\">    &#125;</div><div class=\"line\">    StringBuffer sb = <span class=\"keyword\">new</span> StringBuffer();</div><div class=\"line\">    sb.append(ch, <span class=\"number\">0</span>, nIndex);</div><div class=\"line\">    sb.reverse();</div><div class=\"line\">    String strHex = <span class=\"keyword\">new</span> String(<span class=\"string\">\"\"</span>);</div><div class=\"line\">    strHex += sb.toString();</div><div class=\"line\">    <span class=\"keyword\">return</span> strHex;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">byte</span>[] hexStringToByteArray(String s) &#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (TextUtils.isEmpty(s))</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">    <span class=\"keyword\">int</span> len = s.length();</div><div class=\"line\">    String append= <span class=\"string\">\"\"</span>;</div><div class=\"line\">    <span class=\"keyword\">switch</span> (len)&#123;</div><div class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">1</span>:</div><div class=\"line\">            s = <span class=\"string\">\"0000000\"</span>+s;</div><div class=\"line\">            <span class=\"keyword\">break</span>;</div><div class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">2</span>:</div><div class=\"line\">            s = <span class=\"string\">\"000000\"</span>+s;</div><div class=\"line\">            <span class=\"keyword\">break</span>;</div><div class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">3</span>:</div><div class=\"line\">            s = <span class=\"string\">\"00000\"</span>+s;</div><div class=\"line\">            <span class=\"keyword\">break</span>;</div><div class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">4</span>:</div><div class=\"line\">            s = <span class=\"string\">\"0000\"</span>+s;</div><div class=\"line\">            <span class=\"keyword\">break</span>;</div><div class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">5</span>:</div><div class=\"line\">            s = <span class=\"string\">\"000\"</span>+s;</div><div class=\"line\">            <span class=\"keyword\">break</span>;</div><div class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">6</span>:</div><div class=\"line\">            s = <span class=\"string\">\"00\"</span>+s;</div><div class=\"line\">            <span class=\"keyword\">break</span>;</div><div class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">7</span>:</div><div class=\"line\">            s = <span class=\"string\">\"0\"</span>+s;</div><div class=\"line\">            <span class=\"keyword\">break</span>;</div><div class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">8</span>:</div><div class=\"line\">            <span class=\"keyword\">break</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\">    len = s.length();</div><div class=\"line\">    <span class=\"keyword\">byte</span>[] b = <span class=\"keyword\">new</span> <span class=\"keyword\">byte</span>[len / <span class=\"number\">2</span>];</div><div class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; len; i += <span class=\"number\">2</span>) &#123;</div><div class=\"line\">        <span class=\"comment\">// ,16</span></div><div class=\"line\">        b[i / <span class=\"number\">2</span>] = (<span class=\"keyword\">byte</span>) ((Character.digit(s.charAt(i), <span class=\"number\">16</span>) &lt;&lt; <span class=\"number\">4</span>) + Character</div><div class=\"line\">                .digit(s.charAt(i + <span class=\"number\">1</span>), <span class=\"number\">16</span>));</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> b;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * </div><div class=\"line\"> */</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">byte</span>[] intTo4HexByte(<span class=\"keyword\">int</span> num)&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> hexStringToByteArray(IntToHex(num));</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>HexGBK<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">decode</span><span class=\"params\">(String hexStr)</span> <span class=\"keyword\">throws</span> UnsupportedEncodingException </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> == hexStr || <span class=\"string\">\"\"</span>.equals(hexStr) || (hexStr.length()) % <span class=\"number\">2</span> != <span class=\"number\">0</span>) &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">int</span> byteLength = hexStr.length() / <span class=\"number\">2</span>;</div><div class=\"line\">    <span class=\"keyword\">byte</span>[] bytes = <span class=\"keyword\">new</span> <span class=\"keyword\">byte</span>[byteLength];</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">int</span> temp = <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; byteLength; i++) &#123;</div><div class=\"line\">        temp = hex2Dec(hexStr.charAt(<span class=\"number\">2</span> * i)) * <span class=\"number\">16</span> + hex2Dec(hexStr.charAt(<span class=\"number\">2</span> * i + <span class=\"number\">1</span>));</div><div class=\"line\">        bytes[i] = (<span class=\"keyword\">byte</span>) (temp &lt; <span class=\"number\">128</span> ? temp : temp - <span class=\"number\">256</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> String(bytes,<span class=\"string\">\"GBK\"</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> <span class=\"title\">hex2Dec</span><span class=\"params\">(<span class=\"keyword\">char</span> ch)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'0'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'1'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'2'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">2</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'3'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">3</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'4'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">4</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'5'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">5</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'6'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">6</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'7'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">7</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'8'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">8</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'9'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">9</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'a'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">10</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'A'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">10</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'B'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">11</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'b'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">11</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'C'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">12</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'c'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">12</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'D'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">13</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'d'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">13</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'E'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">14</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'e'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">14</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'F'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">15</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'f'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">15</span>;</div><div class=\"line\">    <span class=\"keyword\">else</span></div><div class=\"line\">        <span class=\"keyword\">return</span> -<span class=\"number\">1</span>;</div><div class=\"line\"></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/09/21/PBOCKonwledgeCode/\">http://agehua.github.io/2017/09/21/PBOCKonwledgeCode/</a></p>\n","readingTime":{"text":"7 min read","minutes":6.135,"time":368099.99999999994,"words":1227},"excerpt":"<h2 id=\"PBOC\"><a href=\"#PBOC\" class=\"headerlink\" title=\"PBOC\"></a>PBOC</h2><p>IC2</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>(POS)(PIN)</p>\n<h4 id=\"-INITIALIZE-FOR-PURCHASE-\"><a href=\"#-INITIALIZE-FOR-PURCHASE-\" class=\"headerlink\" title=\"(INITIALIZE FOR PURCHASE)\"></a>(INITIALIZE FOR PURCHASE)</h4><p></p>","more":"<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">                               CLA  INS   P1   P2</div><div class=\"line\">(INITIALIZE FOR PURCHASE) <span class=\"number\">80</span> <span class=\"number\">50</span> <span class=\"number\">01</span> <span class=\"number\">0</span>X</div></pre></td></tr></table></figure>\n<blockquote>\n<p>APDUApplication Protocol data unit), </p>\n</blockquote>\n<p>APDU<strong>CLA    INS  P1  P2  Lc  Data  Le</strong><br>CLAINSP1P2LcDataLe0</p>\n<p>COS4<br> 1CLA INS P1 P2 00<br> 2CLA INS P1 P2 Le<br> 3CLA INS P1 P2 Lc Data<br> 4CLA INS P1 P2 Lc Data Le</p>\n<p></p>\n<p><img src=\"/images/blogimages/2017/Initialize_for_purchase.png\" alt=\"\"><br><img src=\"/images/blogimages/2017/Initialize_for_purchase_data.png\" alt=\"\"></p>\n<p><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\">  </div><div class=\"line\">Data      SW1 SW1</div></pre></td></tr></table></figure></p>\n<p>DATA <br>SW1SW2 </p>\n<blockquote>\n<p>SW1SW2900061 xxxxGET REPONSEIC</p>\n</blockquote>\n<p>Le 0F15</p>\n<p><img src=\"/images/blogimages/2017/Initialize_for_purchase_responce.png\" alt=\"\"></p>\n<blockquote>\n<p>8bit4bit160-9 A-F16</p>\n</blockquote>\n<h4 id=\"VERIFY-\"><a href=\"#VERIFY-\" class=\"headerlink\" title=\"VERIFY \"></a>VERIFY </h4><p><br>VERIFY<br>PINPIN;PINMF PIN</p>\n<p></p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\"><em></em></th>\n<th style=\"text-align:center\"><em></em></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">CLA</td>\n<td style=\"text-align:center\">00</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">INS</td>\n<td style=\"text-align:center\">20</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">P1</td>\n<td style=\"text-align:center\">00</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">P2</td>\n<td style=\"text-align:center\">00</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Lc</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Data</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Le</td>\n<td style=\"text-align:center\"></td>\n</tr>\n</tbody>\n</table>\n<p>P2=00ICVERIFY</p>\n<blockquote>\n<p>PIN4122-6</p>\n</blockquote>\n<p>9000<br>IC SW2=Cxx;C0 VERIFYSW1 SW2=6983</p>\n<p>IC48<br><img src=\"/images/blogimages/2017/pin_verify.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</div><div class=\"line\">  * 16</div><div class=\"line\">  *</div><div class=\"line\">  * <span class=\"doctag\">@param</span> hex</div><div class=\"line\">  * <span class=\"doctag\">@return</span></div><div class=\"line\">  */</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">byte</span>[] hexStringToByte(String hex) &#123;</div><div class=\"line\">    <span class=\"keyword\">int</span> len = (hex.length() / <span class=\"number\">2</span>);</div><div class=\"line\">    <span class=\"keyword\">byte</span>[] result = <span class=\"keyword\">new</span> <span class=\"keyword\">byte</span>[len];</div><div class=\"line\">    <span class=\"keyword\">char</span>[] achar = hex.toCharArray();</div><div class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; len; i++) &#123;</div><div class=\"line\">        <span class=\"keyword\">int</span> pos = i * <span class=\"number\">2</span>;</div><div class=\"line\">        result[i] = (<span class=\"keyword\">byte</span>) (toByte(achar[pos]) &lt;&lt; <span class=\"number\">4</span> | toByte(achar[pos + <span class=\"number\">1</span>]));</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> result;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">byte</span> <span class=\"title\">toByte</span><span class=\"params\">(<span class=\"keyword\">char</span> c)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">byte</span> b = (<span class=\"keyword\">byte</span>) <span class=\"string\">\"0123456789ABCDEF\"</span>.indexOf(c);</div><div class=\"line\">    <span class=\"keyword\">return</span> b;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">/**</div><div class=\"line\"> * 16</div><div class=\"line\"> *</div><div class=\"line\"> * <span class=\"doctag\">@param</span> bArray</div><div class=\"line\"> * <span class=\"doctag\">@return</span></div><div class=\"line\"> */</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String <span class=\"title\">bytesToHexString</span><span class=\"params\">(<span class=\"keyword\">byte</span>[] bArray)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span>(bArray == <span class=\"keyword\">null</span> )</div><div class=\"line\">    &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"\"</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\">    StringBuffer sb = <span class=\"keyword\">new</span> StringBuffer(bArray.length);</div><div class=\"line\">    String sTemp;</div><div class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; bArray.length; i++) &#123;</div><div class=\"line\">        sTemp = Integer.toHexString(<span class=\"number\">0xFF</span> &amp; bArray[i]);</div><div class=\"line\">        <span class=\"keyword\">if</span> (sTemp.length() &lt; <span class=\"number\">2</span>)</div><div class=\"line\">            sb.append(<span class=\"number\">0</span>);</div><div class=\"line\">        sb.append(sTemp.toUpperCase());</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> sb.toString();</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>IC<strong></strong>byte[]<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">IntToHex</span><span class=\"params\">(<span class=\"keyword\">int</span> n)</span></span>&#123;</div><div class=\"line\">  <span class=\"keyword\">char</span>[] ch = <span class=\"keyword\">new</span> <span class=\"keyword\">char</span>[<span class=\"number\">20</span>];</div><div class=\"line\">  <span class=\"keyword\">int</span> nIndex = <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"keyword\">while</span> ( <span class=\"keyword\">true</span> )&#123;</div><div class=\"line\">        <span class=\"keyword\">int</span> m = n/<span class=\"number\">16</span>;</div><div class=\"line\">        <span class=\"keyword\">int</span> k = n%<span class=\"number\">16</span>;</div><div class=\"line\">        <span class=\"keyword\">if</span> ( k == <span class=\"number\">15</span> )</div><div class=\"line\">            ch[nIndex] = <span class=\"string\">'F'</span>;</div><div class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> ( k == <span class=\"number\">14</span> )</div><div class=\"line\">            ch[nIndex] = <span class=\"string\">'E'</span>;</div><div class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> ( k == <span class=\"number\">13</span> )</div><div class=\"line\">            ch[nIndex] = <span class=\"string\">'D'</span>;</div><div class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> ( k == <span class=\"number\">12</span> )</div><div class=\"line\">            ch[nIndex] = <span class=\"string\">'C'</span>;</div><div class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> ( k == <span class=\"number\">11</span> )</div><div class=\"line\">            ch[nIndex] = <span class=\"string\">'B'</span>;</div><div class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> ( k == <span class=\"number\">10</span> )</div><div class=\"line\">            ch[nIndex] = <span class=\"string\">'A'</span>;</div><div class=\"line\">        <span class=\"keyword\">else</span></div><div class=\"line\">            ch[nIndex] = (<span class=\"keyword\">char</span>)(<span class=\"string\">'0'</span> + k);</div><div class=\"line\">        nIndex++;</div><div class=\"line\">        <span class=\"keyword\">if</span> ( m == <span class=\"number\">0</span> )</div><div class=\"line\">            <span class=\"keyword\">break</span>;</div><div class=\"line\">        n = m;</div><div class=\"line\">    &#125;</div><div class=\"line\">    StringBuffer sb = <span class=\"keyword\">new</span> StringBuffer();</div><div class=\"line\">    sb.append(ch, <span class=\"number\">0</span>, nIndex);</div><div class=\"line\">    sb.reverse();</div><div class=\"line\">    String strHex = <span class=\"keyword\">new</span> String(<span class=\"string\">\"\"</span>);</div><div class=\"line\">    strHex += sb.toString();</div><div class=\"line\">    <span class=\"keyword\">return</span> strHex;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">byte</span>[] hexStringToByteArray(String s) &#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (TextUtils.isEmpty(s))</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">    <span class=\"keyword\">int</span> len = s.length();</div><div class=\"line\">    String append= <span class=\"string\">\"\"</span>;</div><div class=\"line\">    <span class=\"keyword\">switch</span> (len)&#123;</div><div class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">1</span>:</div><div class=\"line\">            s = <span class=\"string\">\"0000000\"</span>+s;</div><div class=\"line\">            <span class=\"keyword\">break</span>;</div><div class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">2</span>:</div><div class=\"line\">            s = <span class=\"string\">\"000000\"</span>+s;</div><div class=\"line\">            <span class=\"keyword\">break</span>;</div><div class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">3</span>:</div><div class=\"line\">            s = <span class=\"string\">\"00000\"</span>+s;</div><div class=\"line\">            <span class=\"keyword\">break</span>;</div><div class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">4</span>:</div><div class=\"line\">            s = <span class=\"string\">\"0000\"</span>+s;</div><div class=\"line\">            <span class=\"keyword\">break</span>;</div><div class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">5</span>:</div><div class=\"line\">            s = <span class=\"string\">\"000\"</span>+s;</div><div class=\"line\">            <span class=\"keyword\">break</span>;</div><div class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">6</span>:</div><div class=\"line\">            s = <span class=\"string\">\"00\"</span>+s;</div><div class=\"line\">            <span class=\"keyword\">break</span>;</div><div class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">7</span>:</div><div class=\"line\">            s = <span class=\"string\">\"0\"</span>+s;</div><div class=\"line\">            <span class=\"keyword\">break</span>;</div><div class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">8</span>:</div><div class=\"line\">            <span class=\"keyword\">break</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\">    len = s.length();</div><div class=\"line\">    <span class=\"keyword\">byte</span>[] b = <span class=\"keyword\">new</span> <span class=\"keyword\">byte</span>[len / <span class=\"number\">2</span>];</div><div class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; len; i += <span class=\"number\">2</span>) &#123;</div><div class=\"line\">        <span class=\"comment\">// ,16</span></div><div class=\"line\">        b[i / <span class=\"number\">2</span>] = (<span class=\"keyword\">byte</span>) ((Character.digit(s.charAt(i), <span class=\"number\">16</span>) &lt;&lt; <span class=\"number\">4</span>) + Character</div><div class=\"line\">                .digit(s.charAt(i + <span class=\"number\">1</span>), <span class=\"number\">16</span>));</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> b;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">/**</div><div class=\"line\"> * </div><div class=\"line\"> */</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">byte</span>[] intTo4HexByte(<span class=\"keyword\">int</span> num)&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> hexStringToByteArray(IntToHex(num));</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>HexGBK<br><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">decode</span><span class=\"params\">(String hexStr)</span> <span class=\"keyword\">throws</span> UnsupportedEncodingException </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> == hexStr || <span class=\"string\">\"\"</span>.equals(hexStr) || (hexStr.length()) % <span class=\"number\">2</span> != <span class=\"number\">0</span>) &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">int</span> byteLength = hexStr.length() / <span class=\"number\">2</span>;</div><div class=\"line\">    <span class=\"keyword\">byte</span>[] bytes = <span class=\"keyword\">new</span> <span class=\"keyword\">byte</span>[byteLength];</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">int</span> temp = <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; byteLength; i++) &#123;</div><div class=\"line\">        temp = hex2Dec(hexStr.charAt(<span class=\"number\">2</span> * i)) * <span class=\"number\">16</span> + hex2Dec(hexStr.charAt(<span class=\"number\">2</span> * i + <span class=\"number\">1</span>));</div><div class=\"line\">        bytes[i] = (<span class=\"keyword\">byte</span>) (temp &lt; <span class=\"number\">128</span> ? temp : temp - <span class=\"number\">256</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> String(bytes,<span class=\"string\">\"GBK\"</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> <span class=\"title\">hex2Dec</span><span class=\"params\">(<span class=\"keyword\">char</span> ch)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'0'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'1'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'2'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">2</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'3'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">3</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'4'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">4</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'5'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">5</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'6'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">6</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'7'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">7</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'8'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">8</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'9'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">9</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'a'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">10</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'A'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">10</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'B'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">11</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'b'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">11</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'C'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">12</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'c'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">12</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'D'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">13</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'d'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">13</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'E'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">14</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'e'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">14</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'F'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">15</span>;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ch == <span class=\"string\">'f'</span>)</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">15</span>;</div><div class=\"line\">    <span class=\"keyword\">else</span></div><div class=\"line\">        <span class=\"keyword\">return</span> -<span class=\"number\">1</span>;</div><div class=\"line\"></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/09/21/PBOCKonwledgeCode/\">http://agehua.github.io/2017/09/21/PBOCKonwledgeCode/</a></p>"},{"layout":"post","title":"PBOC","keywords":"pboc, pboc2.0","banner":"http://obxk8w81b.bkt.clouddn.com/Cottages%20in%20Saintes-Maries.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Cottages%20in%20Saintes-Maries.jpg","toc":true,"_content":"\n\n## PBOC\n\n### \n-  integrated circuit (IC) /\n- (IC ) integrated circuit(s) card (ICC) \n-  electronic deposit (PIN)IC\n-  electronic purse IC(PIN)\n<!--more-->\n-  load\n  \n \n-  unload\n   2\n\n### \n JR/T 0025 \n- AID (Application Identifier)\n- an (Alphanumeric)\n- ans (Alphanumeric Special)\n- ATI (Application Type Identifier)\n- b (Binary)\n- CLA (Class Byte of the Command Message)\n- cn (Compressed Numeric)\n- DEA (Data Encryption Algorithm)\n- DF (Dedicated File)\n- ED (Electronic Deposit)\n- EF (Elementary File)\n- EP (Electronic Purse)\n- FCI (File Control Information)\n- INS (Instruction Byte of Command Message)\n- ISO (International Organization for Standardization)\n- Lc (Exact Length of Data Sent)\n- Le (Maximum Length of Data Expected)\n- MAC (Message Authentication Code)\n- MF (Master File)\n- n (Numeric)\n- P1  1(Parameter 1)\n- P2  2(Parameter 2)\n- PIN (Personal Identification Number)\n- POS (Point of Service)\n- PSAM (Purchase Secure Access Module)\n- PSE (Payment System Environment)\n- PVN PIN (PIN Verification Number)\n- SFI (Short File Identifier)\n- SW1  1(Status Word One)\n- SW2  2(Status Word Two)\n- TAC (Transaction Authorization Crypogram)\n- TTI (Transaction Type Identifier)\n- YYYYMMDD (Year, Month, Day)\n\nIC(Integrated circuit Card),CPUCPUCPU(Chip Operating System, COS) ,, , ,,IC\n\n### \n#### 2.1 \nCOS,ICISO7816-4,COS : (Master File, MF) (Dedicated File, DF)(Elementary File,EF) MFDFEFDFDDFADFDDFADF, ADF\n\nMFICDDFDF, ADF, DFEF, \n\n(DF):\nMF: MF  EF()SF ()DDF()ADF();\nDDF: DDFADFDDF EFSF\nADF: ADFEFSF\n\n#### 2.2 \n,: MF,DF0,0FAC0,AC1AC0 ,AC1 ,AC, ,COSAC0AC1,,\n\n### \n|**|* CLA*|* INS *|*P1*|* P2*|\n|:--------|:-------:|:--------:|:--------:|:--------:|\n|(CHANGE PIN)|80|5E|01|00|\n|(CREDIT FOR LOAD)|80|52|00|00|\n|/(DEBIT FOR PURCHASE/CASH WITHDRAW)|80|54|01|00|\n|(DEBIT FOR UNLOAD)|80|54|03|00|\n|(GET BALANCE)|80|5C|00|0X|\n|(GET TRANSACTION PROVE)|80|5A|00|XX|\n|(INITIALIZE FOR CASH WITHDRAW)|80|50|02|01|\n|(INITIALIZE FOR LOAD)|80|50|00|0X|\n|(INITIALIZE FOR PURCHASE)|80|50|01|0X|\n|(INITIALIZE FOR UNLOAD)|80|50|05|01|\n|(INITIALIZE FOR UPDATE)|80|50|04|01|\n|(RELOAD PIN)|80|5E|00|00|\n|(UPDATE OVERDRAW LIMIT)|80|58|00| 00|\n\n### ICM1CPUSAMPSAM\n-  IC\n  - 1 EEPROM\n  - 2 CPUCPUEEPROM(ROM)ROM(COS)\n  - 3 CPU\n  - 4 CPUICCPU\n\n-  IC\n  - 1 IC\n  - 2 CPUICCOSCPUIC CPUCPUIC\n\n#### CPU\n\nKey Management SystemKMSICIC\n\n1 KEYAKEYBKEYAKEYBKEYAKEYBKEYAKEYBKEYAKEYBIDM1IDM1FPGAM180%ICIDIDIDMifareIDICID\n\n2 CPUCPUCPUPSAMISAMPSAMSAMASAMCPUTAC\n\n### SAM(Secure Access Module)\n#### SAM\nSAMPSAMSAMICICICPSAM PSAMSIMPSAMPSAMPurchase Secure Access Module\n\n ICICPSAMPPurchaseSAMSecure Access ModuleSAMSAMICISO/IEC 7810ID-000DIP8SOP8/16ICSAM\n\nCPU(SAM)\n- 1SAM\n- 2CPUSAM\n- 3ISAMCPU\n- 4PSAMCPU\n- 5CPU\n- 6CPUSAMMAC1SAMCPUMAC2CPUTACMAC1MAC2TACCPUCPU\n\n#### SAM\n- PSAMSAMID-000\n\n- ISAMISAMIInputIncrease ISAM\n\n- ESAMESAMESOPDIPSAMSAMESAMESAMPSAMISAMESAMESAM\n\n- USAM SAM10%UUSBUSBSAMSAMISO/IEC 7816USAMSAMSAMSAM\n\n#### SAM\n\nSAM\n- 1COSCPU\n- 2\n- 3\n- 4SAM\n- 5SAM\n\nICIC\n\nUSAM12\n\nUSAMUSBICSAM\n\nUSAM\n\n### \nPSAM SAM\nhttps://www.bbsmax.com/A/lk5aGpwPz1/\n\nICM1CPUSAMPSAM:\nhttps://www.bbsmax.com/A/8Bz8BRpx5x/\n","source":"_posts/2017-09-12-PBOCKonwledge.md","raw":"---\nlayout: post\ntitle:  PBOC\ncategory: accumulation\ntags:\n  - PBOC\n  - PBOC 2.0\n  - Basic Knowledge\nkeywords: pboc, pboc2.0\nbanner: http://obxk8w81b.bkt.clouddn.com/Cottages%20in%20Saintes-Maries.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Cottages%20in%20Saintes-Maries.jpg\ntoc: true\n---\n\n\n## PBOC\n\n### \n-  integrated circuit (IC) /\n- (IC ) integrated circuit(s) card (ICC) \n-  electronic deposit (PIN)IC\n-  electronic purse IC(PIN)\n<!--more-->\n-  load\n  \n \n-  unload\n   2\n\n### \n JR/T 0025 \n- AID (Application Identifier)\n- an (Alphanumeric)\n- ans (Alphanumeric Special)\n- ATI (Application Type Identifier)\n- b (Binary)\n- CLA (Class Byte of the Command Message)\n- cn (Compressed Numeric)\n- DEA (Data Encryption Algorithm)\n- DF (Dedicated File)\n- ED (Electronic Deposit)\n- EF (Elementary File)\n- EP (Electronic Purse)\n- FCI (File Control Information)\n- INS (Instruction Byte of Command Message)\n- ISO (International Organization for Standardization)\n- Lc (Exact Length of Data Sent)\n- Le (Maximum Length of Data Expected)\n- MAC (Message Authentication Code)\n- MF (Master File)\n- n (Numeric)\n- P1  1(Parameter 1)\n- P2  2(Parameter 2)\n- PIN (Personal Identification Number)\n- POS (Point of Service)\n- PSAM (Purchase Secure Access Module)\n- PSE (Payment System Environment)\n- PVN PIN (PIN Verification Number)\n- SFI (Short File Identifier)\n- SW1  1(Status Word One)\n- SW2  2(Status Word Two)\n- TAC (Transaction Authorization Crypogram)\n- TTI (Transaction Type Identifier)\n- YYYYMMDD (Year, Month, Day)\n\nIC(Integrated circuit Card),CPUCPUCPU(Chip Operating System, COS) ,, , ,,IC\n\n### \n#### 2.1 \nCOS,ICISO7816-4,COS : (Master File, MF) (Dedicated File, DF)(Elementary File,EF) MFDFEFDFDDFADFDDFADF, ADF\n\nMFICDDFDF, ADF, DFEF, \n\n(DF):\nMF: MF  EF()SF ()DDF()ADF();\nDDF: DDFADFDDF EFSF\nADF: ADFEFSF\n\n#### 2.2 \n,: MF,DF0,0FAC0,AC1AC0 ,AC1 ,AC, ,COSAC0AC1,,\n\n### \n|**|* CLA*|* INS *|*P1*|* P2*|\n|:--------|:-------:|:--------:|:--------:|:--------:|\n|(CHANGE PIN)|80|5E|01|00|\n|(CREDIT FOR LOAD)|80|52|00|00|\n|/(DEBIT FOR PURCHASE/CASH WITHDRAW)|80|54|01|00|\n|(DEBIT FOR UNLOAD)|80|54|03|00|\n|(GET BALANCE)|80|5C|00|0X|\n|(GET TRANSACTION PROVE)|80|5A|00|XX|\n|(INITIALIZE FOR CASH WITHDRAW)|80|50|02|01|\n|(INITIALIZE FOR LOAD)|80|50|00|0X|\n|(INITIALIZE FOR PURCHASE)|80|50|01|0X|\n|(INITIALIZE FOR UNLOAD)|80|50|05|01|\n|(INITIALIZE FOR UPDATE)|80|50|04|01|\n|(RELOAD PIN)|80|5E|00|00|\n|(UPDATE OVERDRAW LIMIT)|80|58|00| 00|\n\n### ICM1CPUSAMPSAM\n-  IC\n  - 1 EEPROM\n  - 2 CPUCPUEEPROM(ROM)ROM(COS)\n  - 3 CPU\n  - 4 CPUICCPU\n\n-  IC\n  - 1 IC\n  - 2 CPUICCOSCPUIC CPUCPUIC\n\n#### CPU\n\nKey Management SystemKMSICIC\n\n1 KEYAKEYBKEYAKEYBKEYAKEYBKEYAKEYBKEYAKEYBIDM1IDM1FPGAM180%ICIDIDIDMifareIDICID\n\n2 CPUCPUCPUPSAMISAMPSAMSAMASAMCPUTAC\n\n### SAM(Secure Access Module)\n#### SAM\nSAMPSAMSAMICICICPSAM PSAMSIMPSAMPSAMPurchase Secure Access Module\n\n ICICPSAMPPurchaseSAMSecure Access ModuleSAMSAMICISO/IEC 7810ID-000DIP8SOP8/16ICSAM\n\nCPU(SAM)\n- 1SAM\n- 2CPUSAM\n- 3ISAMCPU\n- 4PSAMCPU\n- 5CPU\n- 6CPUSAMMAC1SAMCPUMAC2CPUTACMAC1MAC2TACCPUCPU\n\n#### SAM\n- PSAMSAMID-000\n\n- ISAMISAMIInputIncrease ISAM\n\n- ESAMESAMESOPDIPSAMSAMESAMESAMPSAMISAMESAMESAM\n\n- USAM SAM10%UUSBUSBSAMSAMISO/IEC 7816USAMSAMSAMSAM\n\n#### SAM\n\nSAM\n- 1COSCPU\n- 2\n- 3\n- 4SAM\n- 5SAM\n\nICIC\n\nUSAM12\n\nUSAMUSBICSAM\n\nUSAM\n\n### \nPSAM SAM\nhttps://www.bbsmax.com/A/lk5aGpwPz1/\n\nICM1CPUSAMPSAM:\nhttps://www.bbsmax.com/A/8Bz8BRpx5x/\n","slug":"PBOCKonwledge","published":1,"date":"2017-09-11T16:00:00.000Z","updated":"2017-12-07T06:35:03.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ec1o003zd6ykp21mdh1s","content":"<h2 id=\"PBOC\"><a href=\"#PBOC\" class=\"headerlink\" title=\"PBOC\"></a>PBOC</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li> integrated circuit (IC) /</li>\n<li>(IC ) integrated circuit(s) card (ICC) </li>\n<li> electronic deposit (PIN)IC</li>\n<li> electronic purse IC(PIN)<a id=\"more\"></a></li>\n<li> load<br><br> </li>\n<li> unload<br> 2</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> JR/T 0025 </p>\n<ul>\n<li>AID (Application Identifier)</li>\n<li>an (Alphanumeric)</li>\n<li>ans (Alphanumeric Special)</li>\n<li>ATI (Application Type Identifier)</li>\n<li>b (Binary)</li>\n<li>CLA (Class Byte of the Command Message)</li>\n<li>cn (Compressed Numeric)</li>\n<li>DEA (Data Encryption Algorithm)</li>\n<li>DF (Dedicated File)</li>\n<li>ED (Electronic Deposit)</li>\n<li>EF (Elementary File)</li>\n<li>EP (Electronic Purse)</li>\n<li>FCI (File Control Information)</li>\n<li>INS (Instruction Byte of Command Message)</li>\n<li>ISO (International Organization for Standardization)</li>\n<li>Lc (Exact Length of Data Sent)</li>\n<li>Le (Maximum Length of Data Expected)</li>\n<li>MAC (Message Authentication Code)</li>\n<li>MF (Master File)</li>\n<li>n (Numeric)</li>\n<li>P1  1(Parameter 1)</li>\n<li>P2  2(Parameter 2)</li>\n<li>PIN (Personal Identification Number)</li>\n<li>POS (Point of Service)</li>\n<li>PSAM (Purchase Secure Access Module)</li>\n<li>PSE (Payment System Environment)</li>\n<li>PVN PIN (PIN Verification Number)</li>\n<li>SFI (Short File Identifier)</li>\n<li>SW1  1(Status Word One)</li>\n<li>SW2  2(Status Word Two)</li>\n<li>TAC (Transaction Authorization Crypogram)</li>\n<li>TTI (Transaction Type Identifier)</li>\n<li>YYYYMMDD (Year, Month, Day)</li>\n</ul>\n<p>IC(Integrated circuit Card),CPUCPUCPU(Chip Operating System, COS) ,, , ,,IC</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"2-1-\"><a href=\"#2-1-\" class=\"headerlink\" title=\"2.1 \"></a>2.1 </h4><p>COS,ICISO7816-4,COS : (Master File, MF) (Dedicated File, DF)(Elementary File,EF) MFDFEFDFDDFADFDDFADF, ADF</p>\n<p>MFICDDFDF, ADF, DFEF, </p>\n<p>(DF):<br>MF: MF  EF()SF ()DDF()ADF();<br>DDF: DDFADFDDF EFSF<br>ADF: ADFEFSF</p>\n<h4 id=\"2-2-\"><a href=\"#2-2-\" class=\"headerlink\" title=\"2.2 \"></a>2.2 </h4><p>,: MF,DF0,0FAC0,AC1AC0 ,AC1 ,AC, ,COSAC0AC1,,</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><table>\n<thead>\n<tr>\n<th style=\"text-align:left\"><em></em></th>\n<th style=\"text-align:center\"><em> CLA</em></th>\n<th style=\"text-align:center\"><em> INS </em></th>\n<th style=\"text-align:center\"><em>P1</em></th>\n<th style=\"text-align:center\"><em> P2</em></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">(CHANGE PIN)</td>\n<td style=\"text-align:center\">80</td>\n<td style=\"text-align:center\">5E</td>\n<td style=\"text-align:center\">01</td>\n<td style=\"text-align:center\">00</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">(CREDIT FOR LOAD)</td>\n<td style=\"text-align:center\">80</td>\n<td style=\"text-align:center\">52</td>\n<td style=\"text-align:center\">00</td>\n<td style=\"text-align:center\">00</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">/(DEBIT FOR PURCHASE/CASH WITHDRAW)</td>\n<td style=\"text-align:center\">80</td>\n<td style=\"text-align:center\">54</td>\n<td style=\"text-align:center\">01</td>\n<td style=\"text-align:center\">00</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">(DEBIT FOR UNLOAD)</td>\n<td style=\"text-align:center\">80</td>\n<td style=\"text-align:center\">54</td>\n<td style=\"text-align:center\">03</td>\n<td style=\"text-align:center\">00</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">(GET BALANCE)</td>\n<td style=\"text-align:center\">80</td>\n<td style=\"text-align:center\">5C</td>\n<td style=\"text-align:center\">00</td>\n<td style=\"text-align:center\">0X</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">(GET TRANSACTION PROVE)</td>\n<td style=\"text-align:center\">80</td>\n<td style=\"text-align:center\">5A</td>\n<td style=\"text-align:center\">00</td>\n<td style=\"text-align:center\">XX</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">(INITIALIZE FOR CASH WITHDRAW)</td>\n<td style=\"text-align:center\">80</td>\n<td style=\"text-align:center\">50</td>\n<td style=\"text-align:center\">02</td>\n<td style=\"text-align:center\">01</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">(INITIALIZE FOR LOAD)</td>\n<td style=\"text-align:center\">80</td>\n<td style=\"text-align:center\">50</td>\n<td style=\"text-align:center\">00</td>\n<td style=\"text-align:center\">0X</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">(INITIALIZE FOR PURCHASE)</td>\n<td style=\"text-align:center\">80</td>\n<td style=\"text-align:center\">50</td>\n<td style=\"text-align:center\">01</td>\n<td style=\"text-align:center\">0X</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">(INITIALIZE FOR UNLOAD)</td>\n<td style=\"text-align:center\">80</td>\n<td style=\"text-align:center\">50</td>\n<td style=\"text-align:center\">05</td>\n<td style=\"text-align:center\">01</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">(INITIALIZE FOR UPDATE)</td>\n<td style=\"text-align:center\">80</td>\n<td style=\"text-align:center\">50</td>\n<td style=\"text-align:center\">04</td>\n<td style=\"text-align:center\">01</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">(RELOAD PIN)</td>\n<td style=\"text-align:center\">80</td>\n<td style=\"text-align:center\">5E</td>\n<td style=\"text-align:center\">00</td>\n<td style=\"text-align:center\">00</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">(UPDATE OVERDRAW LIMIT)</td>\n<td style=\"text-align:center\">80</td>\n<td style=\"text-align:center\">58</td>\n<td style=\"text-align:center\">00</td>\n<td style=\"text-align:center\">00</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"ICM1CPUSAMPSAM\"><a href=\"#ICM1CPUSAMPSAM\" class=\"headerlink\" title=\"ICM1CPUSAMPSAM\"></a>ICM1CPUSAMPSAM</h3><ul>\n<li><p> IC</p>\n<ul>\n<li>1 EEPROM</li>\n<li>2 CPUCPUEEPROM(ROM)ROM(COS)</li>\n<li>3 CPU</li>\n<li>4 CPUICCPU</li>\n</ul>\n</li>\n<li><p> IC</p>\n<ul>\n<li>1 IC</li>\n<li>2 CPUICCOSCPUIC CPUCPUIC</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"CPU\"><a href=\"#CPU\" class=\"headerlink\" title=\"CPU\"></a>CPU</h4><p>Key Management SystemKMSICIC</p>\n<p>1 KEYAKEYBKEYAKEYBKEYAKEYBKEYAKEYBKEYAKEYBIDM1IDM1FPGAM180%ICIDIDIDMifareIDICID</p>\n<p>2 CPUCPUCPUPSAMISAMPSAMSAMASAMCPUTAC</p>\n<h3 id=\"SAM-Secure-Access-Module-\"><a href=\"#SAM-Secure-Access-Module-\" class=\"headerlink\" title=\"SAM(Secure Access Module)\"></a>SAM(Secure Access Module)</h3><h4 id=\"SAM\"><a href=\"#SAM\" class=\"headerlink\" title=\"SAM\"></a>SAM</h4><p>SAMPSAMSAMICICICPSAM PSAMSIMPSAMPSAMPurchase Secure Access Module</p>\n<p> ICICPSAMPPurchaseSAMSecure Access ModuleSAMSAMICISO/IEC 7810ID-000DIP8SOP8/16ICSAM</p>\n<p>CPU(SAM)</p>\n<ul>\n<li>1SAM</li>\n<li>2CPUSAM</li>\n<li>3ISAMCPU</li>\n<li>4PSAMCPU</li>\n<li>5CPU</li>\n<li>6CPUSAMMAC1SAMCPUMAC2CPUTACMAC1MAC2TACCPUCPU</li>\n</ul>\n<h4 id=\"SAM\"><a href=\"#SAM\" class=\"headerlink\" title=\"SAM\"></a>SAM</h4><ul>\n<li><p>PSAMSAMID-000</p>\n</li>\n<li><p>ISAMISAMIInputIncrease ISAM</p>\n</li>\n<li><p>ESAMESAMESOPDIPSAMSAMESAMESAMPSAMISAMESAMESAM</p>\n</li>\n<li><p>USAM SAM10%UUSBUSBSAMSAMISO/IEC 7816USAMSAMSAMSAM</p>\n</li>\n</ul>\n<h4 id=\"SAM\"><a href=\"#SAM\" class=\"headerlink\" title=\"SAM\"></a>SAM</h4><p>SAM</p>\n<ul>\n<li>1COSCPU</li>\n<li>2</li>\n<li>3</li>\n<li>4SAM</li>\n<li>5SAM</li>\n</ul>\n<p>ICIC</p>\n<p>USAM12</p>\n<p>USAMUSBICSAM</p>\n<p>USAM</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>PSAM SAM<br><a href=\"https://www.bbsmax.com/A/lk5aGpwPz1/\" target=\"_blank\" rel=\"external\">https://www.bbsmax.com/A/lk5aGpwPz1/</a></p>\n<p>ICM1CPUSAMPSAM:<br><a href=\"https://www.bbsmax.com/A/8Bz8BRpx5x/\" target=\"_blank\" rel=\"external\">https://www.bbsmax.com/A/8Bz8BRpx5x/</a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/09/12/PBOCKonwledge/\">http://agehua.github.io/2017/09/12/PBOCKonwledge/</a></p>\n","readingTime":{"text":"3 min read","minutes":2.125,"time":127500,"words":425},"excerpt":"<h2 id=\"PBOC\"><a href=\"#PBOC\" class=\"headerlink\" title=\"PBOC\"></a>PBOC</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li> integrated circuit (IC) /</li>\n<li>(IC ) integrated circuit(s) card (ICC) </li>\n<li> electronic deposit (PIN)IC</li>\n<li> electronic purse IC(PIN)","more":"</li>\n<li> load<br><br> </li>\n<li> unload<br> 2</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> JR/T 0025 </p>\n<ul>\n<li>AID (Application Identifier)</li>\n<li>an (Alphanumeric)</li>\n<li>ans (Alphanumeric Special)</li>\n<li>ATI (Application Type Identifier)</li>\n<li>b (Binary)</li>\n<li>CLA (Class Byte of the Command Message)</li>\n<li>cn (Compressed Numeric)</li>\n<li>DEA (Data Encryption Algorithm)</li>\n<li>DF (Dedicated File)</li>\n<li>ED (Electronic Deposit)</li>\n<li>EF (Elementary File)</li>\n<li>EP (Electronic Purse)</li>\n<li>FCI (File Control Information)</li>\n<li>INS (Instruction Byte of Command Message)</li>\n<li>ISO (International Organization for Standardization)</li>\n<li>Lc (Exact Length of Data Sent)</li>\n<li>Le (Maximum Length of Data Expected)</li>\n<li>MAC (Message Authentication Code)</li>\n<li>MF (Master File)</li>\n<li>n (Numeric)</li>\n<li>P1  1(Parameter 1)</li>\n<li>P2  2(Parameter 2)</li>\n<li>PIN (Personal Identification Number)</li>\n<li>POS (Point of Service)</li>\n<li>PSAM (Purchase Secure Access Module)</li>\n<li>PSE (Payment System Environment)</li>\n<li>PVN PIN (PIN Verification Number)</li>\n<li>SFI (Short File Identifier)</li>\n<li>SW1  1(Status Word One)</li>\n<li>SW2  2(Status Word Two)</li>\n<li>TAC (Transaction Authorization Crypogram)</li>\n<li>TTI (Transaction Type Identifier)</li>\n<li>YYYYMMDD (Year, Month, Day)</li>\n</ul>\n<p>IC(Integrated circuit Card),CPUCPUCPU(Chip Operating System, COS) ,, , ,,IC</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"2-1-\"><a href=\"#2-1-\" class=\"headerlink\" title=\"2.1 \"></a>2.1 </h4><p>COS,ICISO7816-4,COS : (Master File, MF) (Dedicated File, DF)(Elementary File,EF) MFDFEFDFDDFADFDDFADF, ADF</p>\n<p>MFICDDFDF, ADF, DFEF, </p>\n<p>(DF):<br>MF: MF  EF()SF ()DDF()ADF();<br>DDF: DDFADFDDF EFSF<br>ADF: ADFEFSF</p>\n<h4 id=\"2-2-\"><a href=\"#2-2-\" class=\"headerlink\" title=\"2.2 \"></a>2.2 </h4><p>,: MF,DF0,0FAC0,AC1AC0 ,AC1 ,AC, ,COSAC0AC1,,</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><table>\n<thead>\n<tr>\n<th style=\"text-align:left\"><em></em></th>\n<th style=\"text-align:center\"><em> CLA</em></th>\n<th style=\"text-align:center\"><em> INS </em></th>\n<th style=\"text-align:center\"><em>P1</em></th>\n<th style=\"text-align:center\"><em> P2</em></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">(CHANGE PIN)</td>\n<td style=\"text-align:center\">80</td>\n<td style=\"text-align:center\">5E</td>\n<td style=\"text-align:center\">01</td>\n<td style=\"text-align:center\">00</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">(CREDIT FOR LOAD)</td>\n<td style=\"text-align:center\">80</td>\n<td style=\"text-align:center\">52</td>\n<td style=\"text-align:center\">00</td>\n<td style=\"text-align:center\">00</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">/(DEBIT FOR PURCHASE/CASH WITHDRAW)</td>\n<td style=\"text-align:center\">80</td>\n<td style=\"text-align:center\">54</td>\n<td style=\"text-align:center\">01</td>\n<td style=\"text-align:center\">00</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">(DEBIT FOR UNLOAD)</td>\n<td style=\"text-align:center\">80</td>\n<td style=\"text-align:center\">54</td>\n<td style=\"text-align:center\">03</td>\n<td style=\"text-align:center\">00</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">(GET BALANCE)</td>\n<td style=\"text-align:center\">80</td>\n<td style=\"text-align:center\">5C</td>\n<td style=\"text-align:center\">00</td>\n<td style=\"text-align:center\">0X</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">(GET TRANSACTION PROVE)</td>\n<td style=\"text-align:center\">80</td>\n<td style=\"text-align:center\">5A</td>\n<td style=\"text-align:center\">00</td>\n<td style=\"text-align:center\">XX</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">(INITIALIZE FOR CASH WITHDRAW)</td>\n<td style=\"text-align:center\">80</td>\n<td style=\"text-align:center\">50</td>\n<td style=\"text-align:center\">02</td>\n<td style=\"text-align:center\">01</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">(INITIALIZE FOR LOAD)</td>\n<td style=\"text-align:center\">80</td>\n<td style=\"text-align:center\">50</td>\n<td style=\"text-align:center\">00</td>\n<td style=\"text-align:center\">0X</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">(INITIALIZE FOR PURCHASE)</td>\n<td style=\"text-align:center\">80</td>\n<td style=\"text-align:center\">50</td>\n<td style=\"text-align:center\">01</td>\n<td style=\"text-align:center\">0X</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">(INITIALIZE FOR UNLOAD)</td>\n<td style=\"text-align:center\">80</td>\n<td style=\"text-align:center\">50</td>\n<td style=\"text-align:center\">05</td>\n<td style=\"text-align:center\">01</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">(INITIALIZE FOR UPDATE)</td>\n<td style=\"text-align:center\">80</td>\n<td style=\"text-align:center\">50</td>\n<td style=\"text-align:center\">04</td>\n<td style=\"text-align:center\">01</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">(RELOAD PIN)</td>\n<td style=\"text-align:center\">80</td>\n<td style=\"text-align:center\">5E</td>\n<td style=\"text-align:center\">00</td>\n<td style=\"text-align:center\">00</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">(UPDATE OVERDRAW LIMIT)</td>\n<td style=\"text-align:center\">80</td>\n<td style=\"text-align:center\">58</td>\n<td style=\"text-align:center\">00</td>\n<td style=\"text-align:center\">00</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"ICM1CPUSAMPSAM\"><a href=\"#ICM1CPUSAMPSAM\" class=\"headerlink\" title=\"ICM1CPUSAMPSAM\"></a>ICM1CPUSAMPSAM</h3><ul>\n<li><p> IC</p>\n<ul>\n<li>1 EEPROM</li>\n<li>2 CPUCPUEEPROM(ROM)ROM(COS)</li>\n<li>3 CPU</li>\n<li>4 CPUICCPU</li>\n</ul>\n</li>\n<li><p> IC</p>\n<ul>\n<li>1 IC</li>\n<li>2 CPUICCOSCPUIC CPUCPUIC</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"CPU\"><a href=\"#CPU\" class=\"headerlink\" title=\"CPU\"></a>CPU</h4><p>Key Management SystemKMSICIC</p>\n<p>1 KEYAKEYBKEYAKEYBKEYAKEYBKEYAKEYBKEYAKEYBIDM1IDM1FPGAM180%ICIDIDIDMifareIDICID</p>\n<p>2 CPUCPUCPUPSAMISAMPSAMSAMASAMCPUTAC</p>\n<h3 id=\"SAM-Secure-Access-Module-\"><a href=\"#SAM-Secure-Access-Module-\" class=\"headerlink\" title=\"SAM(Secure Access Module)\"></a>SAM(Secure Access Module)</h3><h4 id=\"SAM\"><a href=\"#SAM\" class=\"headerlink\" title=\"SAM\"></a>SAM</h4><p>SAMPSAMSAMICICICPSAM PSAMSIMPSAMPSAMPurchase Secure Access Module</p>\n<p> ICICPSAMPPurchaseSAMSecure Access ModuleSAMSAMICISO/IEC 7810ID-000DIP8SOP8/16ICSAM</p>\n<p>CPU(SAM)</p>\n<ul>\n<li>1SAM</li>\n<li>2CPUSAM</li>\n<li>3ISAMCPU</li>\n<li>4PSAMCPU</li>\n<li>5CPU</li>\n<li>6CPUSAMMAC1SAMCPUMAC2CPUTACMAC1MAC2TACCPUCPU</li>\n</ul>\n<h4 id=\"SAM\"><a href=\"#SAM\" class=\"headerlink\" title=\"SAM\"></a>SAM</h4><ul>\n<li><p>PSAMSAMID-000</p>\n</li>\n<li><p>ISAMISAMIInputIncrease ISAM</p>\n</li>\n<li><p>ESAMESAMESOPDIPSAMSAMESAMESAMPSAMISAMESAMESAM</p>\n</li>\n<li><p>USAM SAM10%UUSBUSBSAMSAMISO/IEC 7816USAMSAMSAMSAM</p>\n</li>\n</ul>\n<h4 id=\"SAM\"><a href=\"#SAM\" class=\"headerlink\" title=\"SAM\"></a>SAM</h4><p>SAM</p>\n<ul>\n<li>1COSCPU</li>\n<li>2</li>\n<li>3</li>\n<li>4SAM</li>\n<li>5SAM</li>\n</ul>\n<p>ICIC</p>\n<p>USAM12</p>\n<p>USAMUSBICSAM</p>\n<p>USAM</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>PSAM SAM<br><a href=\"https://www.bbsmax.com/A/lk5aGpwPz1/\">https://www.bbsmax.com/A/lk5aGpwPz1/</a></p>\n<p>ICM1CPUSAMPSAM:<br><a href=\"https://www.bbsmax.com/A/8Bz8BRpx5x/\">https://www.bbsmax.com/A/8Bz8BRpx5x/</a></p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/09/12/PBOCKonwledge/\">http://agehua.github.io/2017/09/12/PBOCKonwledge/</a></p>"},{"layout":"post","title":"","keywords":"Electron, JavaScript","banner":"http://obxk8w81b.bkt.clouddn.com/Digger%203.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Digger%203.jpg","toc":true,"_content":"\n## \n\nAlfred \n[Youdao Alfred Workflow](https://github.com/kaiye/workflows-youdao/)\n\n\u001d[](https://github.com/kaiye/kaiye.github.com/issues/5)Alfred\n\n<!--more-->\n\n>  HTML5 API  Node.js   \n   - Chrome App  Github  chrome app sample  API  \n   - npm npm  node  package.json bin  makefont \n   - [NW.js](https://nwjs.io/)  webkit  node  Mac node + webkit  Adobe AIR  HTML5  Flash \n   - [Electron](http://electron.atom.io/)  Visual Studio Code  Github  Atom  NW.js  \n   \n     \n\n\n[Visual Studio Code ](https://github.com/kaiye/kaiye.github.com/issues/14)\n\nVisual Studio CodeAtomElectron\n\n###  Electron\n\nElectronhttps://electronjs.org/\n>  Electron  JavaScript, HTML  CSS  Web \n\nElectronAtom Shell[3]GitHubNode.jsChromiumGUIElectronWebGitHubAtomVisual Studio Code\n\n\n[Electron W3C](https://www.w3cschool.cn/electronmanual/)\n[Github: electron-cn-docs](https://github.com/amhoho/electron-cn-docs)\n\nElectronNode.jsNode.js.\n\n### Electron\n\n****\n\n Electron  package.json  main  web  GUI\n****\n\n Electron  Chromium  Chromium  Electron \nElectron  io.js  APIs \n\n****\n\n BrowserWindow  BrowserWindow  BrowserWindow \n\n GUI  GUI  APIs  GUI  GUI \n Electron ipc  remote\n\n\n","source":"_posts/2017-10-22-Buildcross-platform-desktop-apps.md","raw":"---\nlayout: post\ntitle:  \ncategory: accumulation\ntags:\n    - Alfred Workflow\n    - Electron\n    - JavaScript\nkeywords: Electron, JavaScript\nbanner: http://obxk8w81b.bkt.clouddn.com/Digger%203.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Digger%203.jpg\ntoc: true\n---\n\n## \n\nAlfred \n[Youdao Alfred Workflow](https://github.com/kaiye/workflows-youdao/)\n\n\u001d[](https://github.com/kaiye/kaiye.github.com/issues/5)Alfred\n\n<!--more-->\n\n>  HTML5 API  Node.js   \n   - Chrome App  Github  chrome app sample  API  \n   - npm npm  node  package.json bin  makefont \n   - [NW.js](https://nwjs.io/)  webkit  node  Mac node + webkit  Adobe AIR  HTML5  Flash \n   - [Electron](http://electron.atom.io/)  Visual Studio Code  Github  Atom  NW.js  \n   \n     \n\n\n[Visual Studio Code ](https://github.com/kaiye/kaiye.github.com/issues/14)\n\nVisual Studio CodeAtomElectron\n\n###  Electron\n\nElectronhttps://electronjs.org/\n>  Electron  JavaScript, HTML  CSS  Web \n\nElectronAtom Shell[3]GitHubNode.jsChromiumGUIElectronWebGitHubAtomVisual Studio Code\n\n\n[Electron W3C](https://www.w3cschool.cn/electronmanual/)\n[Github: electron-cn-docs](https://github.com/amhoho/electron-cn-docs)\n\nElectronNode.jsNode.js.\n\n### Electron\n\n****\n\n Electron  package.json  main  web  GUI\n****\n\n Electron  Chromium  Chromium  Electron \nElectron  io.js  APIs \n\n****\n\n BrowserWindow  BrowserWindow  BrowserWindow \n\n GUI  GUI  APIs  GUI  GUI \n Electron ipc  remote\n\n\n","slug":"Buildcross-platform-desktop-apps","published":1,"date":"2017-10-21T16:00:00.000Z","updated":"2017-12-07T06:46:19.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ec1s0043d6ykty4o8w4q","content":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Alfred <br><a href=\"https://github.com/kaiye/workflows-youdao/\" target=\"_blank\" rel=\"external\">Youdao Alfred Workflow</a></p>\n<p>\u001d<a href=\"https://github.com/kaiye/kaiye.github.com/issues/5\" target=\"_blank\" rel=\"external\"></a>Alfred</p>\n<a id=\"more\"></a>\n<p></p>\n<blockquote>\n<p> HTML5 API  Node.js   </p>\n<ul>\n<li>Chrome App  Github  chrome app sample  API  </li>\n<li>npm npm  node  package.json bin  makefont </li>\n<li><a href=\"https://nwjs.io/\" target=\"_blank\" rel=\"external\">NW.js</a>  webkit  node  Mac node + webkit  Adobe AIR  HTML5  Flash </li>\n<li><a href=\"http://electron.atom.io/\" target=\"_blank\" rel=\"external\">Electron</a>  Visual Studio Code  Github  Atom  NW.js  </li>\n</ul>\n</blockquote>\n<pre><code>\n</code></pre><p><a href=\"https://github.com/kaiye/kaiye.github.com/issues/14\" target=\"_blank\" rel=\"external\">Visual Studio Code </a></p>\n<p>Visual Studio CodeAtomElectron</p>\n<h3 id=\"-Electron\"><a href=\"#-Electron\" class=\"headerlink\" title=\" Electron\"></a> Electron</h3><p>Electron<a href=\"https://electronjs.org/\" target=\"_blank\" rel=\"external\">https://electronjs.org/</a></p>\n<blockquote>\n<p> Electron  JavaScript, HTML  CSS  Web </p>\n</blockquote>\n<p>ElectronAtom Shell[3]GitHubNode.jsChromiumGUIElectronWebGitHubAtomVisual Studio Code</p>\n<p><br><a href=\"https://www.w3cschool.cn/electronmanual/\" target=\"_blank\" rel=\"external\">Electron W3C</a><br><a href=\"https://github.com/amhoho/electron-cn-docs\" target=\"_blank\" rel=\"external\">Github: electron-cn-docs</a></p>\n<p>ElectronNode.jsNode.js.</p>\n<h3 id=\"Electron\"><a href=\"#Electron\" class=\"headerlink\" title=\"Electron\"></a>Electron</h3><p><strong></strong></p>\n<p> Electron  package.json  main  web  GUI<br><strong></strong></p>\n<p> Electron  Chromium  Chromium  Electron <br>Electron  io.js  APIs </p>\n<p><strong></strong></p>\n<p> BrowserWindow  BrowserWindow  BrowserWindow <br><br> GUI  GUI  APIs  GUI  GUI <br> Electron ipc  remote</p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/10/22/Buildcross-platform-desktop-apps/\">http://agehua.github.io/2017/10/22/Buildcross-platform-desktop-apps/</a></p>\n","readingTime":{"text":"1 min read","minutes":0.89,"time":53400,"words":178},"excerpt":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Alfred <br><a href=\"https://github.com/kaiye/workflows-youdao/\">Youdao Alfred Workflow</a></p>\n<p>\u001d<a href=\"https://github.com/kaiye/kaiye.github.com/issues/5\"></a>Alfred</p>","more":"<p></p>\n<blockquote>\n<p> HTML5 API  Node.js   </p>\n<ul>\n<li>Chrome App  Github  chrome app sample  API  </li>\n<li>npm npm  node  package.json bin  makefont </li>\n<li><a href=\"https://nwjs.io/\">NW.js</a>  webkit  node  Mac node + webkit  Adobe AIR  HTML5  Flash </li>\n<li><a href=\"http://electron.atom.io/\">Electron</a>  Visual Studio Code  Github  Atom  NW.js  </li>\n</ul>\n</blockquote>\n<pre><code>\n</code></pre><p><a href=\"https://github.com/kaiye/kaiye.github.com/issues/14\">Visual Studio Code </a></p>\n<p>Visual Studio CodeAtomElectron</p>\n<h3 id=\"-Electron\"><a href=\"#-Electron\" class=\"headerlink\" title=\" Electron\"></a> Electron</h3><p>Electron<a href=\"https://electronjs.org/\">https://electronjs.org/</a></p>\n<blockquote>\n<p> Electron  JavaScript, HTML  CSS  Web </p>\n</blockquote>\n<p>ElectronAtom Shell[3]GitHubNode.jsChromiumGUIElectronWebGitHubAtomVisual Studio Code</p>\n<p><br><a href=\"https://www.w3cschool.cn/electronmanual/\">Electron W3C</a><br><a href=\"https://github.com/amhoho/electron-cn-docs\">Github: electron-cn-docs</a></p>\n<p>ElectronNode.jsNode.js.</p>\n<h3 id=\"Electron\"><a href=\"#Electron\" class=\"headerlink\" title=\"Electron\"></a>Electron</h3><p><strong></strong></p>\n<p> Electron  package.json  main  web  GUI<br><strong></strong></p>\n<p> Electron  Chromium  Chromium  Electron <br>Electron  io.js  APIs </p>\n<p><strong></strong></p>\n<p> BrowserWindow  BrowserWindow  BrowserWindow <br><br> GUI  GUI  APIs  GUI  GUI <br> Electron ipc  remote</p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/10/22/Buildcross-platform-desktop-apps/\">http://agehua.github.io/2017/10/22/Buildcross-platform-desktop-apps/</a></p>"},{"layout":"post","title":"JavaScript","keywords":"JavaScript","banner":"http://obxk8w81b.bkt.clouddn.com/Bridge%20and%20Houses%20on%20the%20Corner%20of%20Herengracht-Prinsessegracht,%20The%20Hague.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Bridge%20and%20Houses%20on%20the%20Corner%20of%20Herengracht-Prinsessegracht,%20The%20Hague.jpg","toc":true,"_content":"\n## JavaScript\n\n> : [--JavaScript](https://www.liaoxuefeng.com/wiki/001434446689867b27157e896e74d51a89c25cc8b43bdb3000)\n\n### for ... of\nES6for ... offor ... offor ... in\n\nfor ... inArray\n\n<!--more-->\nArrayfor ... in\n~~~ JavaScript\nvar a = ['A', 'B', 'C'];\na.name = 'Hello';\nfor (var x in a) {\n    console.log(x); // '0', '1', '2', 'name'\n}\n~~~\nfor ... innameArraylength\n\nfor ... of\n~~~ JavaScript\nvar a = ['A', 'B', 'C'];\na.name = 'Hello';\nfor (var x of a) {\n    console.log(x); // 'A', 'B', 'C'\n}\n~~~\nfor ... of\n\niterableforEachArray\n\n~~~ JavaScript\n'use strict';\nvar a = ['A', 'B', 'C'];\na.forEach(function (element, index, array) {\n    // element: \n    // index: \n    // array: Array\n    console.log(element + ', index = ' + index);\n});\n~~~\n> forEach()ES5.1\n\nSetArraySet\n~~~ JavaScript\nvar s = new Set(['A', 'B', 'C']);\ns.forEach(function (element, sameElement, set) {\n    console.log(element);\n});\n~~~\nMapvaluekeymap\n~~~ JavaScript\nvar m = new Map([[1, 'x'], [2, 'y'], [3, 'z']]);\nm.forEach(function (value, key, map) {\n    console.log(value);\n});\n~~~\nJavaScriptArrayelement\n~~~ JavaScript\nvar a = ['A', 'B', 'C'];\na.forEach(function (element) {\n    console.log(element);\n});\n~~~\n\n### rest\nJavaScriptargumentsargumentsArrayArray.\nJavaScriptarguments\n~~~ JavaScript\nfunction foo(a, b) {\n    var i, rest = [];\n    if (arguments.length > 2) {\n        for (i = 2; i<arguments.length; i++) {\n            rest.push(arguments[i]);\n        }\n    }\n    console.log('a = ' + a);\n    console.log('b = ' + b);\n    console.log(rest);\n}\n~~~\n\nabarguments2rest\n\nES6rest\n~~~ JavaScript\nfunction foo(a, b, ...rest) {\n    console.log('a = ' + a);\n    console.log('b = ' + b);\n    console.log(rest);\n}\n\nfoo(1, 2, 3, 4, 5);\n// :\n// a = 1\n// b = 2\n// Array [ 3, 4, 5 ]\n\nfoo(1);\n// :\n// a = 1\n// b = undefined\n// Array []\n~~~\nrest...abrestarguments\n\nrestundefined\n\n### \nJavaScriptwindowwindow\n\nvar foo = function () {}window\n~~~ JavaScript\n'use strict';\n\nfunction foo() {\n    alert('foo');\n}\n\nfoo(); // foo()\nwindow.foo(); // window.foo()\n~~~\n\n### \n\nwindowJavaScript\n\n\n~~~ JavaScript\n// MYAPP:\nvar MYAPP = {};\n\n// :\nMYAPP.name = 'myapp';\nMYAPP.version = 1.0;\n\n// :\nMYAPP.foo = function () {\n    return 'foo';\n};\n~~~\nMYAPP\n\nJavaScriptjQueryYUIunderscore\n### \n\nJavaScriptfor\n~~~ JavaScript\n'use strict';\n\nfunction foo() {\n    for (var i=0; i<100; i++) {\n        //\n    }\n    i += 100; // i\n}\n~~~\nES6letletvar\n~~~ JavaScript\n'use strict';\n\nfunction foo() {\n    var sum = 0;\n    for (let i=0; i<100; i++) {\n        sum += i;\n    }\n    // SyntaxError:\n    i += 1;\n}\n~~~\nES6constconstlet.\n\n### \n\nES6JavaScript****\n\n~~~ JavaScript\nlet [x, [y, z]] = ['hello', ['JavaScript', 'ES6']];\nx; // 'hello'\ny; // 'JavaScript'\nz; // 'ES6'\n~~~\n\n~~~ JavaScript\nlet [, , z] = ['hello', 'JavaScript', 'ES6']; // z\nz; // 'ES6'\n~~~\n\n~~~ JavaScript\nvar person = {\n    name: '',\n    age: 20,\n    gender: 'male',\n    passport: 'G-12345678',\n    school: 'No.4 middle school',\n    address: {\n        city: 'Beijing',\n        street: 'No.1 Road',\n        zipcode: '100001'\n    }\n};\nvar {name, address: {city, zip}} = person;\nname; // ''\ncity; // 'Beijing'\nzip; // undefined, zipcodezip\n// : addresscityzipaddress:\naddress; // Uncaught ReferenceError: address is not defined\n~~~\nundefinedundefined\n~~~ JavaScript\nvar person = {\n    name: '',\n    age: 20,\n    gender: 'male',\n    passport: 'G-12345678',\n    school: 'No.4 middle school'\n};\n\n// passportid:\nlet {name, passport:id} = person;\nname; // ''\nid; // 'G-12345678'\n// : passportidpassport:\npassport; // Uncaught ReferenceError: passport is not defined\n~~~\nundefined\n~~~ JavaScript\nvar person = {\n    name: '',\n    age: 20,\n    gender: 'male',\n    passport: 'G-12345678'\n};\n~~~\n// personsingletrue:\n~~~ JavaScript\nvar {name, single=true} = person;\nname; // ''\nsingle; // true\n~~~\n\n~~~ JavaScript\n// :\nvar x, y;\n// :\n{x, y} = { name: '', x: 100, y: 200};\n// : Uncaught SyntaxError: Unexpected token =\n~~~\nJavaScript{=\n~~~ JavaScript\n({x, y} = { name: '', x: 100, y: 200});\n~~~\n****\n\nxy\n~~~ JavaScript\nvar x=1, y=2;\n[x, y] = [y, x]\n~~~\n\n~~~ JavaScript\nvar {hostname:domain, pathname:path} = location;\n~~~\nDate\n~~~ JavaScript\nfunction buildDate({year, month, day, hour=0, minute=0, second=0}) {\n    return new Date(year + '-' + month + '-' + day + ' ' + hour + ':' + minute + ':' + second);\n}\n~~~\nyearmonthday\n~~~ JavaScript\nbuildDate({ year: 2017, month: 1, day: 1 });\n// Sun Jan 01 2017 00:00:00 GMT+0800 (CST)\n~~~\nhourminutesecond\n~~~ JavaScript\nbuildDate({ year: 2017, month: 1, day: 1, hour: 20, minute: 15 });\n// Sun Jan 01 2017 20:15:00 GMT+0800 (CST)\n~~~\nES6ChromeFirefoxEdge\n\n### thisapplycall\nthis\n~~~ JavaScript\n'use strict';\n\nvar xiaoming = {\n    name: '',\n    birth: 1990,\n    age: function () {\n        var y = new Date().getFullYear();\n        return y - this.birth;\n    }\n};\n\nvar fn = xiaoming.age;\nfn(); // Uncaught TypeError: Cannot read property 'birth' of undefined\n~~~\nthisagexiaomingthisundefinedstrictwindow\n\n~~~ JavaScript\n'use strict';\n\nvar xiaoming = {\n    name: '',\n    birth: 1990,\n    age: function () {\n        var that = this; // this\n        function getAgeFromBirth() {\n            var y = new Date().getFullYear();\n            return y - that.birth; // thatthis\n        }\n        return getAgeFromBirth();\n    }\n};\n\nxiaoming.age(); // 25\n~~~\nvar that = this;\n\nstrictthisundefinedwindowthis\n\nthis****applythisArray\n\napplygetAge()\n~~~ JavaScript\nfunction getAge() {\n    var y = new Date().getFullYear();\n    return y - this.birth;\n}\n\nvar xiaoming = {\n    name: '',\n    birth: 1990,\n    age: getAge\n};\n\nxiaoming.age(); // 25\ngetAge.apply(xiaoming, []); // 25, thisxiaoming, \n~~~\napply()call()\n\n- apply()Array\n- call()\n\nMath.max(3, 5, 4)apply()call()\n~~~ JavaScript\nMath.max.apply(null, [3, 5, 4]); // 5\nMath.max.call(null, 3, 5, 4); // 5\n~~~\nthisnull\n\n### \n\napply()\n\nJavaScript\n\nparseInt()count += 1parseInt()\n~~~ JavaScript\n'use strict';\n\nvar count = 0;\nvar oldParseInt = parseInt; // \n\nwindow.parseInt = function () {\n    count += 1;\n    return oldParseInt.apply(null, arguments); // \n};\n~~~\n\n### \nJavaScript\n\n**map**\nmap()JavaScriptArrayArraymap()Array\n~~~ JavaScript\n'use strict';\n\nfunction pow(x) {\n    return x * x;\n}\nvar arr = [1, 2, 3, 4, 5, 6, 7, 8, 9];\nvar results = arr.map(pow); // [1, 4, 9, 16, 25, 36, 49, 64, 81]\nconsole.log(results);\n~~~\n> map()pow\n\nArray\n~~~ JavaScript\nvar arr = [1, 2, 3, 4, 5, 6, 7, 8, 9];\narr.map(String); // ['1', '2', '3', '4', '5', '6', '7', '8', '9']\n~~~\n\n\n**reduce**\nArrayreduce()Array[x1, x2, x3...]reduce()\n~~~ JavaScript\n[x1, x2, x3, x4].reduce(f) = f(f(f(x1, x2), x3), x4)\n~~~\n\n[1, 3, 5, 7, 9]13579reduce()\n~~~ JavaScript\nvar arr = [1, 3, 5, 7, 9];\narr.reduce(function (x, y) {\n    return x * 10 + y;\n}); // 13579\n~~~\n**filter**\nfilterArray\n\nmap()Arrayfilter()map()filter()truefalse\n\nArray\n~~~ JavaScript\nvar arr = ['A', '', 'B', null, undefined, 'C', '  '];\nvar r = arr.filter(function (s) {\n    return s && s.trim(); // IE9trim()\n});\nr; // ['A', 'B', 'C']\n~~~\n\nfilter()Array\n~~~ JavaScript\nvar arr = ['A', 'B', 'C'];\nvar r = arr.filter(function (element, index, self) {\n    console.log(element); // 'A', 'B', 'C'\n    console.log(index); // 0, 1, 2\n    console.log(self); // selfarr\n    return true;\n});\n~~~\nfilterArray\n~~~ JavaScript\n'use strict';\n\nvar\n    r,\n    arr = ['apple', 'strawberry', 'banana', 'pear', 'apple', 'orange', 'orange', 'strawberry'];\n\nr = arr.filter(function (element, index, self) {\n    return self.indexOf(element) === index;\n});\nconsole.log(r.toString());\n~~~\n> indexOfindexOffilter\n\n**sort()**\nsort()ArrayArray\n~~~ JavaScript\nvar a1 = ['B', 'A', 'C'];\nvar a2 = a1.sort();\na1; // ['A', 'B', 'C']\na2; // ['A', 'B', 'C']\na1 === a2; // true, a1a2\n~~~\n\n### \n\n\n****\n\n~~~ JavaScript\nfunction count() {\n    var arr = [];\n    for (var i=1; i<=3; i++) {\n        arr.push((function (n) {\n            return function () {\n                return n * n;\n            }\n        })(i));\n    }\n    return arr;\n}\n\nvar results = count();\nvar f1 = results[0];\nvar f2 = results[1];\nvar f3 = results[2];\n\nf1(); // 1\nf2(); // 4\nf3(); // 9\n~~~\n\n\n~~~ JavaScript\n(function (x) {\n    return x * x;\n})(3); // 9\n~~~\n\n~~~ JavaScript\nfunction (x) { return x * x } (3);\n~~~\nJavaScriptSyntaxError\n~~~ JavaScript\n(function (x) { return x * x }) (3);\n~~~\n\n~~~ JavaScript\n(function (x) {\n    return x * x;\n})(3)\n~~~\n\n\n\nJavaC++private\n\nclassJavaScript\n~~~ JavaScript\n'use strict';\n\nfunction create_counter(initial) {\n    var x = initial || 0;\n    return {\n        inc: function () {\n            x += 1;\n            return x;\n        }\n    }\n}\n~~~\n\n~~~ JavaScript\nvar c1 = create_counter();\nc1.inc(); // 1\nc1.inc(); // 2\nc1.inc(); // 3\n\nvar c2 = create_counter(10);\nc2.inc(); // 11\nc2.inc(); // 12\nc2.inc(); // 13\n~~~\nxx\n\nxyMath.pow(x, y)x2x3pow2pow3\n~~~ JavaScript\n'use strict';\n\nfunction make_pow(n) {\n    return function (x) {\n        return Math.pow(x, n);\n    }\n}\n\n// :\nvar pow2 = make_pow(2);\nvar pow3 = make_pow(3);\n\nconsole.log(pow2(5)); // 25\nconsole.log(pow3(7)); // 343\n~~~\n****\n- 1IE\n- 2objectPublic Methodprivate value\n\n### \n[JavascriptClosure](http://www.ruanyifeng.com/blog/2009/08/learning_javascript_closures.html)\n\n\n\n\n~~~ JavaScript\nvar name = \"The Window\";\nvar object = {\nname : \"My Object\",\ngetNameFunc : function(){\nreturn function(){\nreturn this.name;\n};\n}\n};\nalert(object.getNameFunc()());\n~~~\n\n~~~ JavaScript\nvar name = \"The Window\";\nvar object = {\nname : \"My Object\",\ngetNameFunc : function(){\nvar that = this;\nreturn function(){\nreturn that.name;\n};\n}\n};\nalert(object.getNameFunc()());\n~~~\n\n\nThe WindowMy Object\n\nthis. \n> In JavaScript this always refers to the owner of the function we're executing, or rather, to the object that a function is a method of. \n\n[The this keyword](http://www.quirksmode.org/js/this.html)\n\n**thisownerfunctionobjectmethodobject**\n\nobject.getNameFunc()functionf:\n**alert(object.getNameFunc()());  === alert(f());**\nf()objectthiswindowname\"The Window\"\n\nobject.getNameFunc()thisobject**thatthat**functionthat\n**alert(object.getNameFunc()());  === alert(f(that));**\nnameMy Object\n\n#### \nES6Arrow Function\n{ ... }return{ ... }return()\n~~~ JavaScript\n// :\n(x, y) => x * x + y * y\n\n// :\n() => 3.14\n\n// :\n(x, y, ...rest) => {\n    var i, sum = x + y;\n    for (i=0; i<rest.length; i++) {\n        sum += rest[i];\n    }\n    return sum;\n}\n~~~\n\n~~~ JavaScript\n// SyntaxError:\nx => { foo: x }\n~~~\n{ ... }\n~~~ JavaScript\n// ok:\nx => ({ foo: x })\n~~~\n\n**this**\n\n**this**\n\nJavaScriptthis\n~~~ JavaScript\nvar obj = {\n    birth: 1990,\n    getAge: function () {\n        var b = this.birth; // 1990\n        var fn = function () {\n            return new Date().getFullYear() - this.birth; // thiswindowundefined\n        };\n        return fn();\n    }\n};\n~~~\nthisthisobj\n~~~ JavaScript\nvar obj = {\n    birth: 1990,\n    getAge: function () {\n        var b = this.birth; // 1990\n        var fn = () => new Date().getFullYear() - this.birth; // thisobj\n        return fn();\n    }\n};\nobj.getAge(); // 25\n~~~\nhack\n~~~ JavaScript\nvar that = this;\n~~~\n\nthiscall()apply()this\n~~~ JavaScript\nvar obj = {\n    birth: 1990,\n    getAge: function (year) {\n        var b = this.birth; // 1990\n        var fn = (y) => y - this.birth; // this.birth1990\n        return fn.call({birth:2000}, year);\n    }\n};\nobj.getAge(2015); // 25\n~~~\n\nthis[this](https://github.com/zhengweikeng/blog/blob/master/posts/2016/%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0%E4%B8%ADthis%E7%9A%84%E7%94%A8%E6%B3%95.md)\n[ES6 Arrow Functions](http://www.infoq.com/cn/articles/es6-in-depth-arrow-functions)\n\n### \n\n\n\n- new Number()new Boolean()new String()\n- parseInt()parseFloat()number\n- String()stringtoString()\n- booleanif (myVar) {...}\n- typeofnumberbooleanstringfunctionundefined\n- ArrayArray.isArray(arr)\n- nullmyVar === null\n- typeof window.myVar === 'undefined'\n- typeof myVar === 'undefined'\n\ntoString()nullundefinednullobject\n\nnumbertoString()SyntaxError\n~~~ JavaScript\n123.toString(); // SyntaxError\n~~~\n\n~~~ JavaScript\n123..toString(); // '123', \n(123).toString(); // '123'\n~~~\n\n**Date**\n\nDate\n~~~ JavaScript\nvar d = new Date(2015, 5, 19, 20, 15, 30, 123);\n~~~\n> JavaScriptDate00=11=22=311=12\n\n~~~ JavaScript\nvar d = Date.parse('2015-06-24T19:49:22.875+08:00');\nd; // 1435146562875\n~~~\n~~~ JavaScript\nvar d = new Date(1435146562875);\nd; // Wed Jun 24 2015 19:49:22 GMT+0800 (CST)\nd.getMonth(); // 5\n~~~\n> Date.parse()01~12DategetMonth()0~11\n\n\n~~~ JavaScript\n'use strict';\n\nif (Date.now) {\n    console.log(Date.now()); // IEnow()\n} else {\n    console.log(new Date().getTime());\n}\n~~~\n\n**RegExp**\n\n[-RegExp](https://www.liaoxuefeng.com/wiki/001434446689867b27157e896e74d51a89c25cc8b43bdb3000/001434499503920bb7b42ff6627420da2ceae4babf6c4f2000)\n\n\n### \n{ ... }JavaScript\n~~~ JavaScript\nfunction Student(name) {\n    this.name = name;\n    this.hello = function () {\n        alert('Hello, ' + this.name + '!');\n    }\n}\n~~~\n\n\nJavaScriptnew\n~~~ JavaScript\nvar xiaoming = new Student('');\nxiaoming.name; // ''\nxiaoming.hello(); // Hello, !\n~~~\n> newundefinednewthisthisreturn this;\n\nxiaoming\n~~~ JavaScript\nxiaoming ----> Student.prototype ----> Object.prototype ----> null\n~~~\n\nxiaomingStudentxiaohongxiaojunxiaoming\n~~~ JavaScript\nxiaoming \nxiaohong - Student.prototype ----> Object.prototype ----> null\nxiaojun  \n~~~\n\nnew Student()constructorStudent\n~~~ JavaScript\nxiaoming.constructor === Student.prototype.constructor; // true\nStudent.prototype.constructor === Student; // true\nObject.getPrototypeOf(xiaoming) === Student.prototype; // true\nxiaoming instanceof Student; // true\n~~~\n\n\n![](/images/blogimages/2017/js/js_function_construction.png)\n\n\n~~~ JavaScript\nxiaoming.name; // ''\nxiaohong.name; // ''\nxiaoming.hello; // function: Student.hello()\nxiaohong.hello; // function: Student.hello()\nxiaoming.hello === xiaohong.hello; // false\n~~~\nxiaomingxiaohongname\n\nxiaomingxiaohonghello\n\nnew Student()hello\n\nhellohelloxiaomingxiaohongStudent.prototype\n\n![](/images/blogimages/2017/js/js_function_construction_1.png)\n\n\n~~~ JavaScript\nfunction Student(name) {\n    this.name = name;\n}\n\nStudent.prototype.hello = function () {\n    alert('Hello, ' + this.name + '!');\n};\n~~~\n\n**new**\n\nnew\n\nstrictthis.name = namethisundefinedstrictthis.name = namethiswindownameundefined\n\nnewjslintnew\n\ncreateStudent()new\n~~~ JavaScript\nfunction Student(props) {\n    this.name = props.name || ''; // ''\n    this.grade = props.grade || 1; // 1\n}\n\nStudent.prototype.hello = function () {\n    alert('Hello, ' + this.name + '!');\n};\n\nfunction createStudent(props) {\n    return new Student(props || {})\n}\n~~~\ncreateStudent()new\n~~~ JavaScript\nvar xiaoming = createStudent({\n    name: ''\n});\n\nxiaoming.grade; // 1\n~~~\nObjectJSONxiaoming\n\n****\nClassJavaC++ClassSubclass\nJavaScriptClassClass\n\nStudentStudentPrimaryStudentPrimaryStudent\n~~~ JavaScript\nfunction PrimaryStudent(props) {\n    // Studentthis:\n    Student.call(this, props);\n    this.grade = props.grade || 1;\n}\n~~~\nStudentStudentPrimaryStudent\n~~~ JavaScript\nnew PrimaryStudent() ----> PrimaryStudent.prototype ----> Object.prototype ----> null\n~~~\n\n~~~ JavaScript\nnew PrimaryStudent() ----> PrimaryStudent.prototype ----> Student.prototype ----> Object.prototype ----> null\n~~~\n\nStudent.prototypeJSONF\n~~~ JavaScript\n// PrimaryStudent:\nfunction PrimaryStudent(props) {\n    Student.call(this, props);\n    this.grade = props.grade || 1;\n}\n\n// F:\nfunction F() {\n}\n\n// FStudent.prototype:\nF.prototype = Student.prototype;\n\n// PrimaryStudentFFStudent.prototype:\nPrimaryStudent.prototype = new F();\n\n// PrimaryStudentPrimaryStudent:\nPrimaryStudent.prototype.constructor = PrimaryStudent;\n\n// PrimaryStudentnew F()\nPrimaryStudent.prototype.getGrade = function () {\n    return this.grade;\n};\n\n// xiaoming:\nvar xiaoming = new PrimaryStudent({\n    name: '',\n    grade: 2\n});\nxiaoming.name; // ''\nxiaoming.grade; // 2\n\n// :\nxiaoming.__proto__ === PrimaryStudent.prototype; // true\nxiaoming.__proto__.__proto__ === Student.prototype; // true\n\n// :\nxiaoming instanceof PrimaryStudent; // true\nxiaoming instanceof Student; // true\n~~~\n\n\n![](/images/blogimages/2017/js/js_function_construction_2.png)\n\n> Fnew F()Student\n\ninherits()F\n~~~ JavaScript\nfunction inherits(Child, Parent) {\n    var F = function () {};\n    F.prototype = Parent.prototype;\n    Child.prototype = new F();\n    Child.prototype.constructor = Child;\n}\n~~~\ninherits()\n~~~ JavaScript\nfunction Student(props) {\n    this.name = props.name || 'Unnamed';\n}\n\nStudent.prototype.hello = function () {\n    alert('Hello, ' + this.name + '!');\n}\n\nfunction PrimaryStudent(props) {\n    Student.call(this, props);\n    this.grade = props.grade || 1;\n}\n\n// :\ninherits(PrimaryStudent, Student);\n\n// PrimaryStudent:\nPrimaryStudent.prototype.getGrade = function () {\n    return this.grade;\n};\n~~~\n\nJavaScript\n\n- call()this\n- Finherits\n- \n\n### class\nJavaScript\n\nclassES6JavaScriptclass\n\nclassStudent\n~~~ JavaScript\nclass Student {\n    constructor(name) {\n        this.name = name;\n    }\n\n    hello() {\n        alert('Hello, ' + this.name + '!');\n    }\n}\n~~~\nclassconstructorhello()functionStudent.prototype.hello = function () {...}\n\nStudent\n~~~ JavaScript\nvar xiaoming = new Student('');\nxiaoming.hello();\n~~~\n\n**class**\nextends\n~~~ JavaScript\nclass PrimaryStudent extends Student {\n    constructor(name, grade) {\n        super(name); // super!\n        this.grade = grade;\n    }\n\n    myGrade() {\n        alert('I am at grade ' + this.grade);\n    }\n}\n~~~\nPrimaryStudentclassextendsStudentPrimaryStudentnamegrade**super(name)**name\n\nPrimaryStudentStudenthellomyGrade\n\nES6classJavaScriptclassJavaScriptclass\n\nclass\n\nES6classclassprototype[Babel](https://babeljs.io/)\n\n### DOM\nHTMLDOMHTMLJavaScriptDOM\n\nDOMDOM\n- DOMDOMHTML\n- DOM\n- DOMHTML\n- HTMLDOM\n\nDOMDOM**document.getElementById()****document.getElementsByTagName()**CSS**document.getElementsByClassName()**\n\nIDHTMLdocument.getElementById()DOMdocument.getElementsByTagName()document.getElementsByClassName()DOMDOM\n\n\n~~~ JavaScript\n// ID'test'\nvar test = document.getElementById('test');\n\n// ID'test-table'tr\nvar trs = document.getElementById('test-table').getElementsByTagName('tr');\n\n// ID'test-div'classred\nvar reds = document.getElementById('test-div').getElementsByClassName('red');\n\n// test:\nvar cs = test.children;\n\n// test\nvar first = test.firstElementChild;\nvar last = test.lastElementChild;\n~~~\nquerySelector()querySelectorAll()selector\n~~~ JavaScript\n// querySelectorIDq1\nvar q1 = document.querySelector('#q1');\n\n// querySelectorAllq1\nvar ps = q1.querySelectorAll('div.highlighted > p');\n~~~\n> IE<8querySelectorquerySelectorAllIE8\n\nDOMElementDOMNodeHTMLNodeElementCommentCDATA_SECTIONDocumentElementNodeNodeDocumentdocument\n\n","source":"_posts/2017-10-22-JavaScript-knowledge.md","raw":"---\nlayout: post\ntitle:  JavaScript\ncategory: accumulation\ntags:\n    - JavaScript\n    - Basic Knowledge\nkeywords: JavaScript\nbanner: http://obxk8w81b.bkt.clouddn.com/Bridge%20and%20Houses%20on%20the%20Corner%20of%20Herengracht-Prinsessegracht,%20The%20Hague.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Bridge%20and%20Houses%20on%20the%20Corner%20of%20Herengracht-Prinsessegracht,%20The%20Hague.jpg\ntoc: true\n---\n\n## JavaScript\n\n> : [--JavaScript](https://www.liaoxuefeng.com/wiki/001434446689867b27157e896e74d51a89c25cc8b43bdb3000)\n\n### for ... of\nES6for ... offor ... offor ... in\n\nfor ... inArray\n\n<!--more-->\nArrayfor ... in\n~~~ JavaScript\nvar a = ['A', 'B', 'C'];\na.name = 'Hello';\nfor (var x in a) {\n    console.log(x); // '0', '1', '2', 'name'\n}\n~~~\nfor ... innameArraylength\n\nfor ... of\n~~~ JavaScript\nvar a = ['A', 'B', 'C'];\na.name = 'Hello';\nfor (var x of a) {\n    console.log(x); // 'A', 'B', 'C'\n}\n~~~\nfor ... of\n\niterableforEachArray\n\n~~~ JavaScript\n'use strict';\nvar a = ['A', 'B', 'C'];\na.forEach(function (element, index, array) {\n    // element: \n    // index: \n    // array: Array\n    console.log(element + ', index = ' + index);\n});\n~~~\n> forEach()ES5.1\n\nSetArraySet\n~~~ JavaScript\nvar s = new Set(['A', 'B', 'C']);\ns.forEach(function (element, sameElement, set) {\n    console.log(element);\n});\n~~~\nMapvaluekeymap\n~~~ JavaScript\nvar m = new Map([[1, 'x'], [2, 'y'], [3, 'z']]);\nm.forEach(function (value, key, map) {\n    console.log(value);\n});\n~~~\nJavaScriptArrayelement\n~~~ JavaScript\nvar a = ['A', 'B', 'C'];\na.forEach(function (element) {\n    console.log(element);\n});\n~~~\n\n### rest\nJavaScriptargumentsargumentsArrayArray.\nJavaScriptarguments\n~~~ JavaScript\nfunction foo(a, b) {\n    var i, rest = [];\n    if (arguments.length > 2) {\n        for (i = 2; i<arguments.length; i++) {\n            rest.push(arguments[i]);\n        }\n    }\n    console.log('a = ' + a);\n    console.log('b = ' + b);\n    console.log(rest);\n}\n~~~\n\nabarguments2rest\n\nES6rest\n~~~ JavaScript\nfunction foo(a, b, ...rest) {\n    console.log('a = ' + a);\n    console.log('b = ' + b);\n    console.log(rest);\n}\n\nfoo(1, 2, 3, 4, 5);\n// :\n// a = 1\n// b = 2\n// Array [ 3, 4, 5 ]\n\nfoo(1);\n// :\n// a = 1\n// b = undefined\n// Array []\n~~~\nrest...abrestarguments\n\nrestundefined\n\n### \nJavaScriptwindowwindow\n\nvar foo = function () {}window\n~~~ JavaScript\n'use strict';\n\nfunction foo() {\n    alert('foo');\n}\n\nfoo(); // foo()\nwindow.foo(); // window.foo()\n~~~\n\n### \n\nwindowJavaScript\n\n\n~~~ JavaScript\n// MYAPP:\nvar MYAPP = {};\n\n// :\nMYAPP.name = 'myapp';\nMYAPP.version = 1.0;\n\n// :\nMYAPP.foo = function () {\n    return 'foo';\n};\n~~~\nMYAPP\n\nJavaScriptjQueryYUIunderscore\n### \n\nJavaScriptfor\n~~~ JavaScript\n'use strict';\n\nfunction foo() {\n    for (var i=0; i<100; i++) {\n        //\n    }\n    i += 100; // i\n}\n~~~\nES6letletvar\n~~~ JavaScript\n'use strict';\n\nfunction foo() {\n    var sum = 0;\n    for (let i=0; i<100; i++) {\n        sum += i;\n    }\n    // SyntaxError:\n    i += 1;\n}\n~~~\nES6constconstlet.\n\n### \n\nES6JavaScript****\n\n~~~ JavaScript\nlet [x, [y, z]] = ['hello', ['JavaScript', 'ES6']];\nx; // 'hello'\ny; // 'JavaScript'\nz; // 'ES6'\n~~~\n\n~~~ JavaScript\nlet [, , z] = ['hello', 'JavaScript', 'ES6']; // z\nz; // 'ES6'\n~~~\n\n~~~ JavaScript\nvar person = {\n    name: '',\n    age: 20,\n    gender: 'male',\n    passport: 'G-12345678',\n    school: 'No.4 middle school',\n    address: {\n        city: 'Beijing',\n        street: 'No.1 Road',\n        zipcode: '100001'\n    }\n};\nvar {name, address: {city, zip}} = person;\nname; // ''\ncity; // 'Beijing'\nzip; // undefined, zipcodezip\n// : addresscityzipaddress:\naddress; // Uncaught ReferenceError: address is not defined\n~~~\nundefinedundefined\n~~~ JavaScript\nvar person = {\n    name: '',\n    age: 20,\n    gender: 'male',\n    passport: 'G-12345678',\n    school: 'No.4 middle school'\n};\n\n// passportid:\nlet {name, passport:id} = person;\nname; // ''\nid; // 'G-12345678'\n// : passportidpassport:\npassport; // Uncaught ReferenceError: passport is not defined\n~~~\nundefined\n~~~ JavaScript\nvar person = {\n    name: '',\n    age: 20,\n    gender: 'male',\n    passport: 'G-12345678'\n};\n~~~\n// personsingletrue:\n~~~ JavaScript\nvar {name, single=true} = person;\nname; // ''\nsingle; // true\n~~~\n\n~~~ JavaScript\n// :\nvar x, y;\n// :\n{x, y} = { name: '', x: 100, y: 200};\n// : Uncaught SyntaxError: Unexpected token =\n~~~\nJavaScript{=\n~~~ JavaScript\n({x, y} = { name: '', x: 100, y: 200});\n~~~\n****\n\nxy\n~~~ JavaScript\nvar x=1, y=2;\n[x, y] = [y, x]\n~~~\n\n~~~ JavaScript\nvar {hostname:domain, pathname:path} = location;\n~~~\nDate\n~~~ JavaScript\nfunction buildDate({year, month, day, hour=0, minute=0, second=0}) {\n    return new Date(year + '-' + month + '-' + day + ' ' + hour + ':' + minute + ':' + second);\n}\n~~~\nyearmonthday\n~~~ JavaScript\nbuildDate({ year: 2017, month: 1, day: 1 });\n// Sun Jan 01 2017 00:00:00 GMT+0800 (CST)\n~~~\nhourminutesecond\n~~~ JavaScript\nbuildDate({ year: 2017, month: 1, day: 1, hour: 20, minute: 15 });\n// Sun Jan 01 2017 20:15:00 GMT+0800 (CST)\n~~~\nES6ChromeFirefoxEdge\n\n### thisapplycall\nthis\n~~~ JavaScript\n'use strict';\n\nvar xiaoming = {\n    name: '',\n    birth: 1990,\n    age: function () {\n        var y = new Date().getFullYear();\n        return y - this.birth;\n    }\n};\n\nvar fn = xiaoming.age;\nfn(); // Uncaught TypeError: Cannot read property 'birth' of undefined\n~~~\nthisagexiaomingthisundefinedstrictwindow\n\n~~~ JavaScript\n'use strict';\n\nvar xiaoming = {\n    name: '',\n    birth: 1990,\n    age: function () {\n        var that = this; // this\n        function getAgeFromBirth() {\n            var y = new Date().getFullYear();\n            return y - that.birth; // thatthis\n        }\n        return getAgeFromBirth();\n    }\n};\n\nxiaoming.age(); // 25\n~~~\nvar that = this;\n\nstrictthisundefinedwindowthis\n\nthis****applythisArray\n\napplygetAge()\n~~~ JavaScript\nfunction getAge() {\n    var y = new Date().getFullYear();\n    return y - this.birth;\n}\n\nvar xiaoming = {\n    name: '',\n    birth: 1990,\n    age: getAge\n};\n\nxiaoming.age(); // 25\ngetAge.apply(xiaoming, []); // 25, thisxiaoming, \n~~~\napply()call()\n\n- apply()Array\n- call()\n\nMath.max(3, 5, 4)apply()call()\n~~~ JavaScript\nMath.max.apply(null, [3, 5, 4]); // 5\nMath.max.call(null, 3, 5, 4); // 5\n~~~\nthisnull\n\n### \n\napply()\n\nJavaScript\n\nparseInt()count += 1parseInt()\n~~~ JavaScript\n'use strict';\n\nvar count = 0;\nvar oldParseInt = parseInt; // \n\nwindow.parseInt = function () {\n    count += 1;\n    return oldParseInt.apply(null, arguments); // \n};\n~~~\n\n### \nJavaScript\n\n**map**\nmap()JavaScriptArrayArraymap()Array\n~~~ JavaScript\n'use strict';\n\nfunction pow(x) {\n    return x * x;\n}\nvar arr = [1, 2, 3, 4, 5, 6, 7, 8, 9];\nvar results = arr.map(pow); // [1, 4, 9, 16, 25, 36, 49, 64, 81]\nconsole.log(results);\n~~~\n> map()pow\n\nArray\n~~~ JavaScript\nvar arr = [1, 2, 3, 4, 5, 6, 7, 8, 9];\narr.map(String); // ['1', '2', '3', '4', '5', '6', '7', '8', '9']\n~~~\n\n\n**reduce**\nArrayreduce()Array[x1, x2, x3...]reduce()\n~~~ JavaScript\n[x1, x2, x3, x4].reduce(f) = f(f(f(x1, x2), x3), x4)\n~~~\n\n[1, 3, 5, 7, 9]13579reduce()\n~~~ JavaScript\nvar arr = [1, 3, 5, 7, 9];\narr.reduce(function (x, y) {\n    return x * 10 + y;\n}); // 13579\n~~~\n**filter**\nfilterArray\n\nmap()Arrayfilter()map()filter()truefalse\n\nArray\n~~~ JavaScript\nvar arr = ['A', '', 'B', null, undefined, 'C', '  '];\nvar r = arr.filter(function (s) {\n    return s && s.trim(); // IE9trim()\n});\nr; // ['A', 'B', 'C']\n~~~\n\nfilter()Array\n~~~ JavaScript\nvar arr = ['A', 'B', 'C'];\nvar r = arr.filter(function (element, index, self) {\n    console.log(element); // 'A', 'B', 'C'\n    console.log(index); // 0, 1, 2\n    console.log(self); // selfarr\n    return true;\n});\n~~~\nfilterArray\n~~~ JavaScript\n'use strict';\n\nvar\n    r,\n    arr = ['apple', 'strawberry', 'banana', 'pear', 'apple', 'orange', 'orange', 'strawberry'];\n\nr = arr.filter(function (element, index, self) {\n    return self.indexOf(element) === index;\n});\nconsole.log(r.toString());\n~~~\n> indexOfindexOffilter\n\n**sort()**\nsort()ArrayArray\n~~~ JavaScript\nvar a1 = ['B', 'A', 'C'];\nvar a2 = a1.sort();\na1; // ['A', 'B', 'C']\na2; // ['A', 'B', 'C']\na1 === a2; // true, a1a2\n~~~\n\n### \n\n\n****\n\n~~~ JavaScript\nfunction count() {\n    var arr = [];\n    for (var i=1; i<=3; i++) {\n        arr.push((function (n) {\n            return function () {\n                return n * n;\n            }\n        })(i));\n    }\n    return arr;\n}\n\nvar results = count();\nvar f1 = results[0];\nvar f2 = results[1];\nvar f3 = results[2];\n\nf1(); // 1\nf2(); // 4\nf3(); // 9\n~~~\n\n\n~~~ JavaScript\n(function (x) {\n    return x * x;\n})(3); // 9\n~~~\n\n~~~ JavaScript\nfunction (x) { return x * x } (3);\n~~~\nJavaScriptSyntaxError\n~~~ JavaScript\n(function (x) { return x * x }) (3);\n~~~\n\n~~~ JavaScript\n(function (x) {\n    return x * x;\n})(3)\n~~~\n\n\n\nJavaC++private\n\nclassJavaScript\n~~~ JavaScript\n'use strict';\n\nfunction create_counter(initial) {\n    var x = initial || 0;\n    return {\n        inc: function () {\n            x += 1;\n            return x;\n        }\n    }\n}\n~~~\n\n~~~ JavaScript\nvar c1 = create_counter();\nc1.inc(); // 1\nc1.inc(); // 2\nc1.inc(); // 3\n\nvar c2 = create_counter(10);\nc2.inc(); // 11\nc2.inc(); // 12\nc2.inc(); // 13\n~~~\nxx\n\nxyMath.pow(x, y)x2x3pow2pow3\n~~~ JavaScript\n'use strict';\n\nfunction make_pow(n) {\n    return function (x) {\n        return Math.pow(x, n);\n    }\n}\n\n// :\nvar pow2 = make_pow(2);\nvar pow3 = make_pow(3);\n\nconsole.log(pow2(5)); // 25\nconsole.log(pow3(7)); // 343\n~~~\n****\n- 1IE\n- 2objectPublic Methodprivate value\n\n### \n[JavascriptClosure](http://www.ruanyifeng.com/blog/2009/08/learning_javascript_closures.html)\n\n\n\n\n~~~ JavaScript\nvar name = \"The Window\";\nvar object = {\nname : \"My Object\",\ngetNameFunc : function(){\nreturn function(){\nreturn this.name;\n};\n}\n};\nalert(object.getNameFunc()());\n~~~\n\n~~~ JavaScript\nvar name = \"The Window\";\nvar object = {\nname : \"My Object\",\ngetNameFunc : function(){\nvar that = this;\nreturn function(){\nreturn that.name;\n};\n}\n};\nalert(object.getNameFunc()());\n~~~\n\n\nThe WindowMy Object\n\nthis. \n> In JavaScript this always refers to the owner of the function we're executing, or rather, to the object that a function is a method of. \n\n[The this keyword](http://www.quirksmode.org/js/this.html)\n\n**thisownerfunctionobjectmethodobject**\n\nobject.getNameFunc()functionf:\n**alert(object.getNameFunc()());  === alert(f());**\nf()objectthiswindowname\"The Window\"\n\nobject.getNameFunc()thisobject**thatthat**functionthat\n**alert(object.getNameFunc()());  === alert(f(that));**\nnameMy Object\n\n#### \nES6Arrow Function\n{ ... }return{ ... }return()\n~~~ JavaScript\n// :\n(x, y) => x * x + y * y\n\n// :\n() => 3.14\n\n// :\n(x, y, ...rest) => {\n    var i, sum = x + y;\n    for (i=0; i<rest.length; i++) {\n        sum += rest[i];\n    }\n    return sum;\n}\n~~~\n\n~~~ JavaScript\n// SyntaxError:\nx => { foo: x }\n~~~\n{ ... }\n~~~ JavaScript\n// ok:\nx => ({ foo: x })\n~~~\n\n**this**\n\n**this**\n\nJavaScriptthis\n~~~ JavaScript\nvar obj = {\n    birth: 1990,\n    getAge: function () {\n        var b = this.birth; // 1990\n        var fn = function () {\n            return new Date().getFullYear() - this.birth; // thiswindowundefined\n        };\n        return fn();\n    }\n};\n~~~\nthisthisobj\n~~~ JavaScript\nvar obj = {\n    birth: 1990,\n    getAge: function () {\n        var b = this.birth; // 1990\n        var fn = () => new Date().getFullYear() - this.birth; // thisobj\n        return fn();\n    }\n};\nobj.getAge(); // 25\n~~~\nhack\n~~~ JavaScript\nvar that = this;\n~~~\n\nthiscall()apply()this\n~~~ JavaScript\nvar obj = {\n    birth: 1990,\n    getAge: function (year) {\n        var b = this.birth; // 1990\n        var fn = (y) => y - this.birth; // this.birth1990\n        return fn.call({birth:2000}, year);\n    }\n};\nobj.getAge(2015); // 25\n~~~\n\nthis[this](https://github.com/zhengweikeng/blog/blob/master/posts/2016/%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0%E4%B8%ADthis%E7%9A%84%E7%94%A8%E6%B3%95.md)\n[ES6 Arrow Functions](http://www.infoq.com/cn/articles/es6-in-depth-arrow-functions)\n\n### \n\n\n\n- new Number()new Boolean()new String()\n- parseInt()parseFloat()number\n- String()stringtoString()\n- booleanif (myVar) {...}\n- typeofnumberbooleanstringfunctionundefined\n- ArrayArray.isArray(arr)\n- nullmyVar === null\n- typeof window.myVar === 'undefined'\n- typeof myVar === 'undefined'\n\ntoString()nullundefinednullobject\n\nnumbertoString()SyntaxError\n~~~ JavaScript\n123.toString(); // SyntaxError\n~~~\n\n~~~ JavaScript\n123..toString(); // '123', \n(123).toString(); // '123'\n~~~\n\n**Date**\n\nDate\n~~~ JavaScript\nvar d = new Date(2015, 5, 19, 20, 15, 30, 123);\n~~~\n> JavaScriptDate00=11=22=311=12\n\n~~~ JavaScript\nvar d = Date.parse('2015-06-24T19:49:22.875+08:00');\nd; // 1435146562875\n~~~\n~~~ JavaScript\nvar d = new Date(1435146562875);\nd; // Wed Jun 24 2015 19:49:22 GMT+0800 (CST)\nd.getMonth(); // 5\n~~~\n> Date.parse()01~12DategetMonth()0~11\n\n\n~~~ JavaScript\n'use strict';\n\nif (Date.now) {\n    console.log(Date.now()); // IEnow()\n} else {\n    console.log(new Date().getTime());\n}\n~~~\n\n**RegExp**\n\n[-RegExp](https://www.liaoxuefeng.com/wiki/001434446689867b27157e896e74d51a89c25cc8b43bdb3000/001434499503920bb7b42ff6627420da2ceae4babf6c4f2000)\n\n\n### \n{ ... }JavaScript\n~~~ JavaScript\nfunction Student(name) {\n    this.name = name;\n    this.hello = function () {\n        alert('Hello, ' + this.name + '!');\n    }\n}\n~~~\n\n\nJavaScriptnew\n~~~ JavaScript\nvar xiaoming = new Student('');\nxiaoming.name; // ''\nxiaoming.hello(); // Hello, !\n~~~\n> newundefinednewthisthisreturn this;\n\nxiaoming\n~~~ JavaScript\nxiaoming ----> Student.prototype ----> Object.prototype ----> null\n~~~\n\nxiaomingStudentxiaohongxiaojunxiaoming\n~~~ JavaScript\nxiaoming \nxiaohong - Student.prototype ----> Object.prototype ----> null\nxiaojun  \n~~~\n\nnew Student()constructorStudent\n~~~ JavaScript\nxiaoming.constructor === Student.prototype.constructor; // true\nStudent.prototype.constructor === Student; // true\nObject.getPrototypeOf(xiaoming) === Student.prototype; // true\nxiaoming instanceof Student; // true\n~~~\n\n\n![](/images/blogimages/2017/js/js_function_construction.png)\n\n\n~~~ JavaScript\nxiaoming.name; // ''\nxiaohong.name; // ''\nxiaoming.hello; // function: Student.hello()\nxiaohong.hello; // function: Student.hello()\nxiaoming.hello === xiaohong.hello; // false\n~~~\nxiaomingxiaohongname\n\nxiaomingxiaohonghello\n\nnew Student()hello\n\nhellohelloxiaomingxiaohongStudent.prototype\n\n![](/images/blogimages/2017/js/js_function_construction_1.png)\n\n\n~~~ JavaScript\nfunction Student(name) {\n    this.name = name;\n}\n\nStudent.prototype.hello = function () {\n    alert('Hello, ' + this.name + '!');\n};\n~~~\n\n**new**\n\nnew\n\nstrictthis.name = namethisundefinedstrictthis.name = namethiswindownameundefined\n\nnewjslintnew\n\ncreateStudent()new\n~~~ JavaScript\nfunction Student(props) {\n    this.name = props.name || ''; // ''\n    this.grade = props.grade || 1; // 1\n}\n\nStudent.prototype.hello = function () {\n    alert('Hello, ' + this.name + '!');\n};\n\nfunction createStudent(props) {\n    return new Student(props || {})\n}\n~~~\ncreateStudent()new\n~~~ JavaScript\nvar xiaoming = createStudent({\n    name: ''\n});\n\nxiaoming.grade; // 1\n~~~\nObjectJSONxiaoming\n\n****\nClassJavaC++ClassSubclass\nJavaScriptClassClass\n\nStudentStudentPrimaryStudentPrimaryStudent\n~~~ JavaScript\nfunction PrimaryStudent(props) {\n    // Studentthis:\n    Student.call(this, props);\n    this.grade = props.grade || 1;\n}\n~~~\nStudentStudentPrimaryStudent\n~~~ JavaScript\nnew PrimaryStudent() ----> PrimaryStudent.prototype ----> Object.prototype ----> null\n~~~\n\n~~~ JavaScript\nnew PrimaryStudent() ----> PrimaryStudent.prototype ----> Student.prototype ----> Object.prototype ----> null\n~~~\n\nStudent.prototypeJSONF\n~~~ JavaScript\n// PrimaryStudent:\nfunction PrimaryStudent(props) {\n    Student.call(this, props);\n    this.grade = props.grade || 1;\n}\n\n// F:\nfunction F() {\n}\n\n// FStudent.prototype:\nF.prototype = Student.prototype;\n\n// PrimaryStudentFFStudent.prototype:\nPrimaryStudent.prototype = new F();\n\n// PrimaryStudentPrimaryStudent:\nPrimaryStudent.prototype.constructor = PrimaryStudent;\n\n// PrimaryStudentnew F()\nPrimaryStudent.prototype.getGrade = function () {\n    return this.grade;\n};\n\n// xiaoming:\nvar xiaoming = new PrimaryStudent({\n    name: '',\n    grade: 2\n});\nxiaoming.name; // ''\nxiaoming.grade; // 2\n\n// :\nxiaoming.__proto__ === PrimaryStudent.prototype; // true\nxiaoming.__proto__.__proto__ === Student.prototype; // true\n\n// :\nxiaoming instanceof PrimaryStudent; // true\nxiaoming instanceof Student; // true\n~~~\n\n\n![](/images/blogimages/2017/js/js_function_construction_2.png)\n\n> Fnew F()Student\n\ninherits()F\n~~~ JavaScript\nfunction inherits(Child, Parent) {\n    var F = function () {};\n    F.prototype = Parent.prototype;\n    Child.prototype = new F();\n    Child.prototype.constructor = Child;\n}\n~~~\ninherits()\n~~~ JavaScript\nfunction Student(props) {\n    this.name = props.name || 'Unnamed';\n}\n\nStudent.prototype.hello = function () {\n    alert('Hello, ' + this.name + '!');\n}\n\nfunction PrimaryStudent(props) {\n    Student.call(this, props);\n    this.grade = props.grade || 1;\n}\n\n// :\ninherits(PrimaryStudent, Student);\n\n// PrimaryStudent:\nPrimaryStudent.prototype.getGrade = function () {\n    return this.grade;\n};\n~~~\n\nJavaScript\n\n- call()this\n- Finherits\n- \n\n### class\nJavaScript\n\nclassES6JavaScriptclass\n\nclassStudent\n~~~ JavaScript\nclass Student {\n    constructor(name) {\n        this.name = name;\n    }\n\n    hello() {\n        alert('Hello, ' + this.name + '!');\n    }\n}\n~~~\nclassconstructorhello()functionStudent.prototype.hello = function () {...}\n\nStudent\n~~~ JavaScript\nvar xiaoming = new Student('');\nxiaoming.hello();\n~~~\n\n**class**\nextends\n~~~ JavaScript\nclass PrimaryStudent extends Student {\n    constructor(name, grade) {\n        super(name); // super!\n        this.grade = grade;\n    }\n\n    myGrade() {\n        alert('I am at grade ' + this.grade);\n    }\n}\n~~~\nPrimaryStudentclassextendsStudentPrimaryStudentnamegrade**super(name)**name\n\nPrimaryStudentStudenthellomyGrade\n\nES6classJavaScriptclassJavaScriptclass\n\nclass\n\nES6classclassprototype[Babel](https://babeljs.io/)\n\n### DOM\nHTMLDOMHTMLJavaScriptDOM\n\nDOMDOM\n- DOMDOMHTML\n- DOM\n- DOMHTML\n- HTMLDOM\n\nDOMDOM**document.getElementById()****document.getElementsByTagName()**CSS**document.getElementsByClassName()**\n\nIDHTMLdocument.getElementById()DOMdocument.getElementsByTagName()document.getElementsByClassName()DOMDOM\n\n\n~~~ JavaScript\n// ID'test'\nvar test = document.getElementById('test');\n\n// ID'test-table'tr\nvar trs = document.getElementById('test-table').getElementsByTagName('tr');\n\n// ID'test-div'classred\nvar reds = document.getElementById('test-div').getElementsByClassName('red');\n\n// test:\nvar cs = test.children;\n\n// test\nvar first = test.firstElementChild;\nvar last = test.lastElementChild;\n~~~\nquerySelector()querySelectorAll()selector\n~~~ JavaScript\n// querySelectorIDq1\nvar q1 = document.querySelector('#q1');\n\n// querySelectorAllq1\nvar ps = q1.querySelectorAll('div.highlighted > p');\n~~~\n> IE<8querySelectorquerySelectorAllIE8\n\nDOMElementDOMNodeHTMLNodeElementCommentCDATA_SECTIONDocumentElementNodeNodeDocumentdocument\n\n","slug":"JavaScript-knowledge","published":1,"date":"2017-10-21T16:00:00.000Z","updated":"2017-12-07T07:06:00.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ec220046d6yklxnf7lh1","content":"<h2 id=\"JavaScript\"><a href=\"#JavaScript\" class=\"headerlink\" title=\"JavaScript\"></a>JavaScript</h2><blockquote>\n<p>: <a href=\"https://www.liaoxuefeng.com/wiki/001434446689867b27157e896e74d51a89c25cc8b43bdb3000\" target=\"_blank\" rel=\"external\">JavaScript</a></p>\n</blockquote>\n<h3 id=\"for--of\"><a href=\"#for--of\" class=\"headerlink\" title=\"for  of\"></a>for  of</h3><p>ES6for  offor  offor  in</p>\n<p>for  inArray</p>\n<a id=\"more\"></a>\n<p>Arrayfor  in<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> a = [<span class=\"string\">'A'</span>, <span class=\"string\">'B'</span>, <span class=\"string\">'C'</span>];</div><div class=\"line\">a.name = <span class=\"string\">'Hello'</span>;</div><div class=\"line\"><span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> x <span class=\"keyword\">in</span> a) &#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(x); <span class=\"comment\">// '0', '1', '2', 'name'</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>for  innameArraylength</p>\n<p>for  of<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> a = [<span class=\"string\">'A'</span>, <span class=\"string\">'B'</span>, <span class=\"string\">'C'</span>];</div><div class=\"line\">a.name = <span class=\"string\">'Hello'</span>;</div><div class=\"line\"><span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> x <span class=\"keyword\">of</span> a) &#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(x); <span class=\"comment\">// 'A', 'B', 'C'</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>for  of</p>\n<p>iterableforEachArray</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">'use strict'</span>;</div><div class=\"line\"><span class=\"keyword\">var</span> a = [<span class=\"string\">'A'</span>, <span class=\"string\">'B'</span>, <span class=\"string\">'C'</span>];</div><div class=\"line\">a.forEach(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">element, index, array</span>) </span>&#123;</div><div class=\"line\">    <span class=\"comment\">// element: </span></div><div class=\"line\">    <span class=\"comment\">// index: </span></div><div class=\"line\">    <span class=\"comment\">// array: Array</span></div><div class=\"line\">    <span class=\"built_in\">console</span>.log(element + <span class=\"string\">', index = '</span> + index);</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure>\n<blockquote>\n<p>forEach()ES5.1</p>\n</blockquote>\n<p>SetArraySet<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> s = <span class=\"keyword\">new</span> <span class=\"built_in\">Set</span>([<span class=\"string\">'A'</span>, <span class=\"string\">'B'</span>, <span class=\"string\">'C'</span>]);</div><div class=\"line\">s.forEach(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">element, sameElement, set</span>) </span>&#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(element);</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure></p>\n<p>Mapvaluekeymap<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> m = <span class=\"keyword\">new</span> <span class=\"built_in\">Map</span>([[<span class=\"number\">1</span>, <span class=\"string\">'x'</span>], [<span class=\"number\">2</span>, <span class=\"string\">'y'</span>], [<span class=\"number\">3</span>, <span class=\"string\">'z'</span>]]);</div><div class=\"line\">m.forEach(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">value, key, map</span>) </span>&#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(value);</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure></p>\n<p>JavaScriptArrayelement<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> a = [<span class=\"string\">'A'</span>, <span class=\"string\">'B'</span>, <span class=\"string\">'C'</span>];</div><div class=\"line\">a.forEach(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">element</span>) </span>&#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(element);</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure></p>\n<h3 id=\"rest\"><a href=\"#rest\" class=\"headerlink\" title=\"rest\"></a>rest</h3><p>JavaScriptargumentsargumentsArrayArray.<br>JavaScriptarguments<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">foo</span>(<span class=\"params\">a, b</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> i, rest = [];</div><div class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">arguments</span>.length &gt; <span class=\"number\">2</span>) &#123;</div><div class=\"line\">        <span class=\"keyword\">for</span> (i = <span class=\"number\">2</span>; i&lt;<span class=\"built_in\">arguments</span>.length; i++) &#123;</div><div class=\"line\">            rest.push(<span class=\"built_in\">arguments</span>[i]);</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'a = '</span> + a);</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'b = '</span> + b);</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(rest);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>abarguments2rest</p>\n<p>ES6rest<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">foo</span>(<span class=\"params\">a, b, ...rest</span>) </span>&#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'a = '</span> + a);</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'b = '</span> + b);</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(rest);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">foo(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>);</div><div class=\"line\"><span class=\"comment\">// :</span></div><div class=\"line\"><span class=\"comment\">// a = 1</span></div><div class=\"line\"><span class=\"comment\">// b = 2</span></div><div class=\"line\"><span class=\"comment\">// Array [ 3, 4, 5 ]</span></div><div class=\"line\"></div><div class=\"line\">foo(<span class=\"number\">1</span>);</div><div class=\"line\"><span class=\"comment\">// :</span></div><div class=\"line\"><span class=\"comment\">// a = 1</span></div><div class=\"line\"><span class=\"comment\">// b = undefined</span></div><div class=\"line\"><span class=\"comment\">// Array []</span></div></pre></td></tr></table></figure></p>\n<p>restabrestarguments</p>\n<p>restundefined</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>JavaScriptwindowwindow</p>\n<p>var foo = function () {}window<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">'use strict'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">foo</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    alert(<span class=\"string\">'foo'</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">foo(); <span class=\"comment\">// foo()</span></div><div class=\"line\"><span class=\"built_in\">window</span>.foo(); <span class=\"comment\">// window.foo()</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>windowJavaScript</p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// MYAPP:</span></div><div class=\"line\"><span class=\"keyword\">var</span> MYAPP = &#123;&#125;;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// :</span></div><div class=\"line\">MYAPP.name = <span class=\"string\">'myapp'</span>;</div><div class=\"line\">MYAPP.version = <span class=\"number\">1.0</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// :</span></div><div class=\"line\">MYAPP.foo = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">'foo'</span>;</div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure></p>\n<p>MYAPP</p>\n<p>JavaScriptjQueryYUIunderscore</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>JavaScriptfor<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">'use strict'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">foo</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i=<span class=\"number\">0</span>; i&lt;<span class=\"number\">100</span>; i++) &#123;</div><div class=\"line\">        <span class=\"comment\">//</span></div><div class=\"line\">    &#125;</div><div class=\"line\">    i += <span class=\"number\">100</span>; <span class=\"comment\">// i</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>ES6letletvar<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">'use strict'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">foo</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> sum = <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i=<span class=\"number\">0</span>; i&lt;<span class=\"number\">100</span>; i++) &#123;</div><div class=\"line\">        sum += i;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"comment\">// SyntaxError:</span></div><div class=\"line\">    i += <span class=\"number\">1</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>ES6constconstlet.</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>ES6JavaScript<strong></strong><br><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">let</span> [x, [y, z]] = [<span class=\"string\">'hello'</span>, [<span class=\"string\">'JavaScript'</span>, <span class=\"string\">'ES6'</span>]];</div><div class=\"line\">x; <span class=\"comment\">// 'hello'</span></div><div class=\"line\">y; <span class=\"comment\">// 'JavaScript'</span></div><div class=\"line\">z; <span class=\"comment\">// 'ES6'</span></div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">let</span> [, , z] = [<span class=\"string\">'hello'</span>, <span class=\"string\">'JavaScript'</span>, <span class=\"string\">'ES6'</span>]; <span class=\"comment\">// z</span></div><div class=\"line\">z; <span class=\"comment\">// 'ES6'</span></div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> person = &#123;</div><div class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">''</span>,</div><div class=\"line\">    <span class=\"attr\">age</span>: <span class=\"number\">20</span>,</div><div class=\"line\">    <span class=\"attr\">gender</span>: <span class=\"string\">'male'</span>,</div><div class=\"line\">    <span class=\"attr\">passport</span>: <span class=\"string\">'G-12345678'</span>,</div><div class=\"line\">    <span class=\"attr\">school</span>: <span class=\"string\">'No.4 middle school'</span>,</div><div class=\"line\">    <span class=\"attr\">address</span>: &#123;</div><div class=\"line\">        <span class=\"attr\">city</span>: <span class=\"string\">'Beijing'</span>,</div><div class=\"line\">        <span class=\"attr\">street</span>: <span class=\"string\">'No.1 Road'</span>,</div><div class=\"line\">        <span class=\"attr\">zipcode</span>: <span class=\"string\">'100001'</span></div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;;</div><div class=\"line\"><span class=\"keyword\">var</span> &#123;name, <span class=\"attr\">address</span>: &#123;city, zip&#125;&#125; = person;</div><div class=\"line\">name; <span class=\"comment\">// ''</span></div><div class=\"line\">city; <span class=\"comment\">// 'Beijing'</span></div><div class=\"line\">zip; <span class=\"comment\">// undefined, zipcodezip</span></div><div class=\"line\"><span class=\"comment\">// : addresscityzipaddress:</span></div><div class=\"line\">address; <span class=\"comment\">// Uncaught ReferenceError: address is not defined</span></div></pre></td></tr></table></figure></p>\n<p>undefinedundefined<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> person = &#123;</div><div class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">''</span>,</div><div class=\"line\">    <span class=\"attr\">age</span>: <span class=\"number\">20</span>,</div><div class=\"line\">    <span class=\"attr\">gender</span>: <span class=\"string\">'male'</span>,</div><div class=\"line\">    <span class=\"attr\">passport</span>: <span class=\"string\">'G-12345678'</span>,</div><div class=\"line\">    <span class=\"attr\">school</span>: <span class=\"string\">'No.4 middle school'</span></div><div class=\"line\">&#125;;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// passportid:</span></div><div class=\"line\"><span class=\"keyword\">let</span> &#123;name, <span class=\"attr\">passport</span>:id&#125; = person;</div><div class=\"line\">name; <span class=\"comment\">// ''</span></div><div class=\"line\">id; <span class=\"comment\">// 'G-12345678'</span></div><div class=\"line\"><span class=\"comment\">// : passportidpassport:</span></div><div class=\"line\">passport; <span class=\"comment\">// Uncaught ReferenceError: passport is not defined</span></div></pre></td></tr></table></figure></p>\n<p>undefined<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> person = &#123;</div><div class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">''</span>,</div><div class=\"line\">    <span class=\"attr\">age</span>: <span class=\"number\">20</span>,</div><div class=\"line\">    <span class=\"attr\">gender</span>: <span class=\"string\">'male'</span>,</div><div class=\"line\">    <span class=\"attr\">passport</span>: <span class=\"string\">'G-12345678'</span></div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure></p>\n<p>// personsingletrue:<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> &#123;name, single=<span class=\"literal\">true</span>&#125; = person;</div><div class=\"line\">name; <span class=\"comment\">// ''</span></div><div class=\"line\">single; <span class=\"comment\">// true</span></div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// :</span></div><div class=\"line\"><span class=\"keyword\">var</span> x, y;</div><div class=\"line\"><span class=\"comment\">// :</span></div><div class=\"line\">&#123;x, y&#125; = &#123; <span class=\"attr\">name</span>: <span class=\"string\">''</span>, <span class=\"attr\">x</span>: <span class=\"number\">100</span>, <span class=\"attr\">y</span>: <span class=\"number\">200</span>&#125;;</div><div class=\"line\"><span class=\"comment\">// : Uncaught SyntaxError: Unexpected token =</span></div></pre></td></tr></table></figure></p>\n<p>JavaScript{=<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">(&#123;x, y&#125; = &#123; <span class=\"attr\">name</span>: <span class=\"string\">''</span>, <span class=\"attr\">x</span>: <span class=\"number\">100</span>, <span class=\"attr\">y</span>: <span class=\"number\">200</span>&#125;);</div></pre></td></tr></table></figure></p>\n<p><strong></strong></p>\n<p>xy<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> x=<span class=\"number\">1</span>, y=<span class=\"number\">2</span>;</div><div class=\"line\">[x, y] = [y, x]</div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> &#123;<span class=\"attr\">hostname</span>:domain, <span class=\"attr\">pathname</span>:path&#125; = location;</div></pre></td></tr></table></figure></p>\n<p>Date<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">buildDate</span>(<span class=\"params\">&#123;year, month, day, hour=<span class=\"number\">0</span>, minute=<span class=\"number\">0</span>, second=<span class=\"number\">0</span>&#125;</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>(year + <span class=\"string\">'-'</span> + month + <span class=\"string\">'-'</span> + day + <span class=\"string\">' '</span> + hour + <span class=\"string\">':'</span> + minute + <span class=\"string\">':'</span> + second);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>yearmonthday<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">buildDate(&#123; <span class=\"attr\">year</span>: <span class=\"number\">2017</span>, <span class=\"attr\">month</span>: <span class=\"number\">1</span>, <span class=\"attr\">day</span>: <span class=\"number\">1</span> &#125;);</div><div class=\"line\"><span class=\"comment\">// Sun Jan 01 2017 00:00:00 GMT+0800 (CST)</span></div></pre></td></tr></table></figure></p>\n<p>hourminutesecond<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">buildDate(&#123; <span class=\"attr\">year</span>: <span class=\"number\">2017</span>, <span class=\"attr\">month</span>: <span class=\"number\">1</span>, <span class=\"attr\">day</span>: <span class=\"number\">1</span>, <span class=\"attr\">hour</span>: <span class=\"number\">20</span>, <span class=\"attr\">minute</span>: <span class=\"number\">15</span> &#125;);</div><div class=\"line\"><span class=\"comment\">// Sun Jan 01 2017 20:15:00 GMT+0800 (CST)</span></div></pre></td></tr></table></figure></p>\n<p>ES6ChromeFirefoxEdge</p>\n<h3 id=\"thisapplycall\"><a href=\"#thisapplycall\" class=\"headerlink\" title=\"thisapplycall\"></a>thisapplycall</h3><p>this<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">'use strict'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> xiaoming = &#123;</div><div class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">''</span>,</div><div class=\"line\">    <span class=\"attr\">birth</span>: <span class=\"number\">1990</span>,</div><div class=\"line\">    <span class=\"attr\">age</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">var</span> y = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().getFullYear();</div><div class=\"line\">        <span class=\"keyword\">return</span> y - <span class=\"keyword\">this</span>.birth;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> fn = xiaoming.age;</div><div class=\"line\">fn(); <span class=\"comment\">// Uncaught TypeError: Cannot read property 'birth' of undefined</span></div></pre></td></tr></table></figure></p>\n<p>thisagexiaomingthisundefinedstrictwindow</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">'use strict'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> xiaoming = &#123;</div><div class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">''</span>,</div><div class=\"line\">    <span class=\"attr\">birth</span>: <span class=\"number\">1990</span>,</div><div class=\"line\">    <span class=\"attr\">age</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">var</span> that = <span class=\"keyword\">this</span>; <span class=\"comment\">// this</span></div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getAgeFromBirth</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">            <span class=\"keyword\">var</span> y = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().getFullYear();</div><div class=\"line\">            <span class=\"keyword\">return</span> y - that.birth; <span class=\"comment\">// thatthis</span></div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">return</span> getAgeFromBirth();</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;;</div><div class=\"line\"></div><div class=\"line\">xiaoming.age(); <span class=\"comment\">// 25</span></div></pre></td></tr></table></figure>\n<p>var that = this;</p>\n<p>strictthisundefinedwindowthis</p>\n<p>this<strong></strong>applythisArray</p>\n<p>applygetAge()<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getAge</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> y = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().getFullYear();</div><div class=\"line\">    <span class=\"keyword\">return</span> y - <span class=\"keyword\">this</span>.birth;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> xiaoming = &#123;</div><div class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">''</span>,</div><div class=\"line\">    <span class=\"attr\">birth</span>: <span class=\"number\">1990</span>,</div><div class=\"line\">    <span class=\"attr\">age</span>: getAge</div><div class=\"line\">&#125;;</div><div class=\"line\"></div><div class=\"line\">xiaoming.age(); <span class=\"comment\">// 25</span></div><div class=\"line\">getAge.apply(xiaoming, []); <span class=\"comment\">// 25, thisxiaoming, </span></div></pre></td></tr></table></figure></p>\n<p>apply()call()</p>\n<ul>\n<li>apply()Array</li>\n<li>call()</li>\n</ul>\n<p>Math.max(3, 5, 4)apply()call()<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">Math</span>.max.apply(<span class=\"literal\">null</span>, [<span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">4</span>]); <span class=\"comment\">// 5</span></div><div class=\"line\"><span class=\"built_in\">Math</span>.max.call(<span class=\"literal\">null</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">4</span>); <span class=\"comment\">// 5</span></div></pre></td></tr></table></figure></p>\n<p>thisnull</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>apply()</p>\n<p>JavaScript</p>\n<p>parseInt()count += 1parseInt()<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">'use strict'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> count = <span class=\"number\">0</span>;</div><div class=\"line\"><span class=\"keyword\">var</span> oldParseInt = <span class=\"built_in\">parseInt</span>; <span class=\"comment\">// </span></div><div class=\"line\"></div><div class=\"line\"><span class=\"built_in\">window</span>.parseInt = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    count += <span class=\"number\">1</span>;</div><div class=\"line\">    <span class=\"keyword\">return</span> oldParseInt.apply(<span class=\"literal\">null</span>, <span class=\"built_in\">arguments</span>); <span class=\"comment\">// </span></div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>JavaScript</p>\n<p><strong>map</strong><br>map()JavaScriptArrayArraymap()Array<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">'use strict'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">pow</span>(<span class=\"params\">x</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> x * x;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"keyword\">var</span> arr = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>, <span class=\"number\">8</span>, <span class=\"number\">9</span>];</div><div class=\"line\"><span class=\"keyword\">var</span> results = arr.map(pow); <span class=\"comment\">// [1, 4, 9, 16, 25, 36, 49, 64, 81]</span></div><div class=\"line\"><span class=\"built_in\">console</span>.log(results);</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>map()pow</p>\n</blockquote>\n<p>Array<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> arr = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>, <span class=\"number\">8</span>, <span class=\"number\">9</span>];</div><div class=\"line\">arr.map(<span class=\"built_in\">String</span>); <span class=\"comment\">// ['1', '2', '3', '4', '5', '6', '7', '8', '9']</span></div></pre></td></tr></table></figure></p>\n<p></p>\n<p><strong>reduce</strong><br>Arrayreduce()Array[x1, x2, x3]reduce()<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">[x1, x2, x3, x4].reduce(f) = f(f(f(x1, x2), x3), x4)</div></pre></td></tr></table></figure></p>\n<p>[1, 3, 5, 7, 9]13579reduce()<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> arr = [<span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">7</span>, <span class=\"number\">9</span>];</div><div class=\"line\">arr.reduce(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">x, y</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> x * <span class=\"number\">10</span> + y;</div><div class=\"line\">&#125;); <span class=\"comment\">// 13579</span></div></pre></td></tr></table></figure></p>\n<p><strong>filter</strong><br>filterArray</p>\n<p>map()Arrayfilter()map()filter()truefalse</p>\n<p>Array<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> arr = [<span class=\"string\">'A'</span>, <span class=\"string\">''</span>, <span class=\"string\">'B'</span>, <span class=\"literal\">null</span>, <span class=\"literal\">undefined</span>, <span class=\"string\">'C'</span>, <span class=\"string\">'  '</span>];</div><div class=\"line\"><span class=\"keyword\">var</span> r = arr.filter(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">s</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> s &amp;&amp; s.trim(); <span class=\"comment\">// IE9trim()</span></div><div class=\"line\">&#125;);</div><div class=\"line\">r; <span class=\"comment\">// ['A', 'B', 'C']</span></div></pre></td></tr></table></figure></p>\n<p>filter()Array<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> arr = [<span class=\"string\">'A'</span>, <span class=\"string\">'B'</span>, <span class=\"string\">'C'</span>];</div><div class=\"line\"><span class=\"keyword\">var</span> r = arr.filter(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">element, index, self</span>) </span>&#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(element); <span class=\"comment\">// 'A', 'B', 'C'</span></div><div class=\"line\">    <span class=\"built_in\">console</span>.log(index); <span class=\"comment\">// 0, 1, 2</span></div><div class=\"line\">    <span class=\"built_in\">console</span>.log(self); <span class=\"comment\">// selfarr</span></div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure></p>\n<p>filterArray<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">'use strict'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span></div><div class=\"line\">    r,</div><div class=\"line\">    arr = [<span class=\"string\">'apple'</span>, <span class=\"string\">'strawberry'</span>, <span class=\"string\">'banana'</span>, <span class=\"string\">'pear'</span>, <span class=\"string\">'apple'</span>, <span class=\"string\">'orange'</span>, <span class=\"string\">'orange'</span>, <span class=\"string\">'strawberry'</span>];</div><div class=\"line\"></div><div class=\"line\">r = arr.filter(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">element, index, self</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> self.indexOf(element) === index;</div><div class=\"line\">&#125;);</div><div class=\"line\"><span class=\"built_in\">console</span>.log(r.toString());</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>indexOfindexOffilter</p>\n</blockquote>\n<p><strong>sort()</strong><br>sort()ArrayArray<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> a1 = [<span class=\"string\">'B'</span>, <span class=\"string\">'A'</span>, <span class=\"string\">'C'</span>];</div><div class=\"line\"><span class=\"keyword\">var</span> a2 = a1.sort();</div><div class=\"line\">a1; <span class=\"comment\">// ['A', 'B', 'C']</span></div><div class=\"line\">a2; <span class=\"comment\">// ['A', 'B', 'C']</span></div><div class=\"line\">a1 === a2; <span class=\"comment\">// true, a1a2</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p><strong></strong><br><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">count</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> arr = [];</div><div class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i=<span class=\"number\">1</span>; i&lt;=<span class=\"number\">3</span>; i++) &#123;</div><div class=\"line\">        arr.push((<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">n</span>) </span>&#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">                <span class=\"keyword\">return</span> n * n;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;)(i));</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> arr;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> results = count();</div><div class=\"line\"><span class=\"keyword\">var</span> f1 = results[<span class=\"number\">0</span>];</div><div class=\"line\"><span class=\"keyword\">var</span> f2 = results[<span class=\"number\">1</span>];</div><div class=\"line\"><span class=\"keyword\">var</span> f3 = results[<span class=\"number\">2</span>];</div><div class=\"line\"></div><div class=\"line\">f1(); <span class=\"comment\">// 1</span></div><div class=\"line\">f2(); <span class=\"comment\">// 4</span></div><div class=\"line\">f3(); <span class=\"comment\">// 9</span></div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">x</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> x * x;</div><div class=\"line\">&#125;)(<span class=\"number\">3</span>); <span class=\"comment\">// 9</span></div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">x</span>) </span>&#123; <span class=\"keyword\">return</span> x * x &#125; (<span class=\"number\">3</span>);</div></pre></td></tr></table></figure></p>\n<p>JavaScriptSyntaxError<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">x</span>) </span>&#123; <span class=\"keyword\">return</span> x * x &#125;) (<span class=\"number\">3</span>);</div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">x</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> x * x;</div><div class=\"line\">&#125;)(<span class=\"number\">3</span>)</div></pre></td></tr></table></figure></p>\n<p></p>\n<p>JavaC++private</p>\n<p>classJavaScript<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">'use strict'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">create_counter</span>(<span class=\"params\">initial</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> x = initial || <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"keyword\">return</span> &#123;</div><div class=\"line\">        <span class=\"attr\">inc</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">            x += <span class=\"number\">1</span>;</div><div class=\"line\">            <span class=\"keyword\">return</span> x;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> c1 = create_counter();</div><div class=\"line\">c1.inc(); <span class=\"comment\">// 1</span></div><div class=\"line\">c1.inc(); <span class=\"comment\">// 2</span></div><div class=\"line\">c1.inc(); <span class=\"comment\">// 3</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> c2 = create_counter(<span class=\"number\">10</span>);</div><div class=\"line\">c2.inc(); <span class=\"comment\">// 11</span></div><div class=\"line\">c2.inc(); <span class=\"comment\">// 12</span></div><div class=\"line\">c2.inc(); <span class=\"comment\">// 13</span></div></pre></td></tr></table></figure></p>\n<p>xx</p>\n<p>xyMath.pow(x, y)x2x3pow2pow3<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">'use strict'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">make_pow</span>(<span class=\"params\">n</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">x</span>) </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">Math</span>.pow(x, n);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// :</span></div><div class=\"line\"><span class=\"keyword\">var</span> pow2 = make_pow(<span class=\"number\">2</span>);</div><div class=\"line\"><span class=\"keyword\">var</span> pow3 = make_pow(<span class=\"number\">3</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"built_in\">console</span>.log(pow2(<span class=\"number\">5</span>)); <span class=\"comment\">// 25</span></div><div class=\"line\"><span class=\"built_in\">console</span>.log(pow3(<span class=\"number\">7</span>)); <span class=\"comment\">// 343</span></div></pre></td></tr></table></figure></p>\n<p><strong></strong></p>\n<ul>\n<li>1IE</li>\n<li>2objectPublic Methodprivate value</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"http://www.ruanyifeng.com/blog/2009/08/learning_javascript_closures.html\" target=\"_blank\" rel=\"external\">JavascriptClosure</a></p>\n<p><br><br><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> name = <span class=\"string\">\"The Window\"</span>;</div><div class=\"line\"><span class=\"keyword\">var</span> object = &#123;</div><div class=\"line\"><span class=\"attr\">name</span> : <span class=\"string\">\"My Object\"</span>,</div><div class=\"line\"><span class=\"attr\">getNameFunc</span> : <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</div><div class=\"line\"><span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</div><div class=\"line\"><span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.name;</div><div class=\"line\">&#125;;</div><div class=\"line\">&#125;</div><div class=\"line\">&#125;;</div><div class=\"line\">alert(object.getNameFunc()());</div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> name = <span class=\"string\">\"The Window\"</span>;</div><div class=\"line\"><span class=\"keyword\">var</span> object = &#123;</div><div class=\"line\"><span class=\"attr\">name</span> : <span class=\"string\">\"My Object\"</span>,</div><div class=\"line\"><span class=\"attr\">getNameFunc</span> : <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</div><div class=\"line\"><span class=\"keyword\">var</span> that = <span class=\"keyword\">this</span>;</div><div class=\"line\"><span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</div><div class=\"line\"><span class=\"keyword\">return</span> that.name;</div><div class=\"line\">&#125;;</div><div class=\"line\">&#125;</div><div class=\"line\">&#125;;</div><div class=\"line\">alert(object.getNameFunc()());</div></pre></td></tr></table></figure></p>\n<p>The WindowMy Object</p>\n<p>this. </p>\n<blockquote>\n<p>In JavaScript this always refers to the owner of the function were executing, or rather, to the object that a function is a method of. </p>\n</blockquote>\n<p><a href=\"http://www.quirksmode.org/js/this.html\" target=\"_blank\" rel=\"external\">The this keyword</a></p>\n<p><strong>thisownerfunctionobjectmethodobject</strong></p>\n<p>object.getNameFunc()functionf:<br><strong>alert(object.getNameFunc()());  === alert(f());</strong><br>f()objectthiswindownameThe Window</p>\n<p>object.getNameFunc()thisobject<strong>thatthat</strong>functionthat<br><strong>alert(object.getNameFunc()());  === alert(f(that));</strong><br>nameMy Object</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>ES6Arrow Function<br>{  }return{  }return()<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// :</span></div><div class=\"line\">(x, y) =&gt; x * x + y * y</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// :</span></div><div class=\"line\">() =&gt; <span class=\"number\">3.14</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// :</span></div><div class=\"line\">(x, y, ...rest) =&gt; &#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> i, sum = x + y;</div><div class=\"line\">    <span class=\"keyword\">for</span> (i=<span class=\"number\">0</span>; i&lt;rest.length; i++) &#123;</div><div class=\"line\">        sum += rest[i];</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> sum;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// SyntaxError:</span></div><div class=\"line\">x =&gt; &#123; <span class=\"attr\">foo</span>: x &#125;</div></pre></td></tr></table></figure></p>\n<p>{  }<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// ok:</span></div><div class=\"line\">x =&gt; (&#123; <span class=\"attr\">foo</span>: x &#125;)</div></pre></td></tr></table></figure></p>\n<p><strong>this</strong></p>\n<p><strong>this</strong></p>\n<p>JavaScriptthis<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> obj = &#123;</div><div class=\"line\">    <span class=\"attr\">birth</span>: <span class=\"number\">1990</span>,</div><div class=\"line\">    <span class=\"attr\">getAge</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">var</span> b = <span class=\"keyword\">this</span>.birth; <span class=\"comment\">// 1990</span></div><div class=\"line\">        <span class=\"keyword\">var</span> fn = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().getFullYear() - <span class=\"keyword\">this</span>.birth; <span class=\"comment\">// thiswindowundefined</span></div><div class=\"line\">        &#125;;</div><div class=\"line\">        <span class=\"keyword\">return</span> fn();</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure></p>\n<p>thisthisobj<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> obj = &#123;</div><div class=\"line\">    <span class=\"attr\">birth</span>: <span class=\"number\">1990</span>,</div><div class=\"line\">    <span class=\"attr\">getAge</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">var</span> b = <span class=\"keyword\">this</span>.birth; <span class=\"comment\">// 1990</span></div><div class=\"line\">        <span class=\"keyword\">var</span> fn = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().getFullYear() - <span class=\"keyword\">this</span>.birth; <span class=\"comment\">// thisobj</span></div><div class=\"line\">        <span class=\"keyword\">return</span> fn();</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;;</div><div class=\"line\">obj.getAge(); <span class=\"comment\">// 25</span></div></pre></td></tr></table></figure></p>\n<p>hack<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> that = <span class=\"keyword\">this</span>;</div></pre></td></tr></table></figure></p>\n<p><br>thiscall()apply()this<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> obj = &#123;</div><div class=\"line\">    <span class=\"attr\">birth</span>: <span class=\"number\">1990</span>,</div><div class=\"line\">    <span class=\"attr\">getAge</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">year</span>) </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">var</span> b = <span class=\"keyword\">this</span>.birth; <span class=\"comment\">// 1990</span></div><div class=\"line\">        <span class=\"keyword\">var</span> fn = <span class=\"function\">(<span class=\"params\">y</span>) =&gt;</span> y - <span class=\"keyword\">this</span>.birth; <span class=\"comment\">// this.birth1990</span></div><div class=\"line\">        <span class=\"keyword\">return</span> fn.call(&#123;<span class=\"attr\">birth</span>:<span class=\"number\">2000</span>&#125;, year);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;;</div><div class=\"line\">obj.getAge(<span class=\"number\">2015</span>); <span class=\"comment\">// 25</span></div></pre></td></tr></table></figure></p>\n<p>this<a href=\"https://github.com/zhengweikeng/blog/blob/master/posts/2016/%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0%E4%B8%ADthis%E7%9A%84%E7%94%A8%E6%B3%95.md\" target=\"_blank\" rel=\"external\">this</a><br><a href=\"http://www.infoq.com/cn/articles/es6-in-depth-arrow-functions\" target=\"_blank\" rel=\"external\">ES6 Arrow Functions</a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<ul>\n<li>new Number()new Boolean()new String()</li>\n<li>parseInt()parseFloat()number</li>\n<li>String()stringtoString()</li>\n<li>booleanif (myVar) {}</li>\n<li>typeofnumberbooleanstringfunctionundefined</li>\n<li>ArrayArray.isArray(arr)</li>\n<li>nullmyVar === null</li>\n<li>typeof window.myVar === undefined</li>\n<li>typeof myVar === undefined</li>\n</ul>\n<p>toString()nullundefinednullobject</p>\n<p>numbertoString()SyntaxError<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"number\">123.</span>toString(); <span class=\"comment\">// SyntaxError</span></div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"number\">123.</span>.toString(); <span class=\"comment\">// '123', </span></div><div class=\"line\">(<span class=\"number\">123</span>).toString(); <span class=\"comment\">// '123'</span></div></pre></td></tr></table></figure></p>\n<p><strong>Date</strong></p>\n<p>Date<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> d = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>(<span class=\"number\">2015</span>, <span class=\"number\">5</span>, <span class=\"number\">19</span>, <span class=\"number\">20</span>, <span class=\"number\">15</span>, <span class=\"number\">30</span>, <span class=\"number\">123</span>);</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>JavaScriptDate00=11=22=311=12</p>\n</blockquote>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> d = <span class=\"built_in\">Date</span>.parse(<span class=\"string\">'2015-06-24T19:49:22.875+08:00'</span>);</div><div class=\"line\">d; <span class=\"comment\">// 1435146562875</span></div></pre></td></tr></table></figure>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> d = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>(<span class=\"number\">1435146562875</span>);</div><div class=\"line\">d; <span class=\"comment\">// Wed Jun 24 2015 19:49:22 GMT+0800 (CST)</span></div><div class=\"line\">d.getMonth(); <span class=\"comment\">// 5</span></div></pre></td></tr></table></figure>\n<blockquote>\n<p>Date.parse()01~12DategetMonth()0~11</p>\n</blockquote>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">'use strict'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> (<span class=\"built_in\">Date</span>.now) &#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"built_in\">Date</span>.now()); <span class=\"comment\">// IEnow()</span></div><div class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().getTime());</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p><strong>RegExp</strong></p>\n<p><a href=\"https://www.liaoxuefeng.com/wiki/001434446689867b27157e896e74d51a89c25cc8b43bdb3000/001434499503920bb7b42ff6627420da2ceae4babf6c4f2000\" target=\"_blank\" rel=\"external\">-RegExp</a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>{  }JavaScript<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Student</span>(<span class=\"params\">name</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">this</span>.name = name;</div><div class=\"line\">    <span class=\"keyword\">this</span>.hello = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">        alert(<span class=\"string\">'Hello, '</span> + <span class=\"keyword\">this</span>.name + <span class=\"string\">'!'</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p></p>\n<p>JavaScriptnew<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> xiaoming = <span class=\"keyword\">new</span> Student(<span class=\"string\">''</span>);</div><div class=\"line\">xiaoming.name; <span class=\"comment\">// ''</span></div><div class=\"line\">xiaoming.hello(); <span class=\"comment\">// Hello, !</span></div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>newundefinednewthisthisreturn this;</p>\n</blockquote>\n<p>xiaoming<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">xiaoming ----&gt; Student.prototype ----&gt; <span class=\"built_in\">Object</span>.prototype ----&gt; <span class=\"literal\">null</span></div></pre></td></tr></table></figure></p>\n<p>xiaomingStudentxiaohongxiaojunxiaoming<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">xiaoming </div><div class=\"line\">xiaohong - Student.prototype ----&gt; <span class=\"built_in\">Object</span>.prototype ----&gt; <span class=\"literal\">null</span></div><div class=\"line\">xiaojun  </div></pre></td></tr></table></figure></p>\n<p>new Student()constructorStudent<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">xiaoming.constructor === Student.prototype.constructor; <span class=\"comment\">// true</span></div><div class=\"line\">Student.prototype.constructor === Student; <span class=\"comment\">// true</span></div><div class=\"line\"><span class=\"built_in\">Object</span>.getPrototypeOf(xiaoming) === Student.prototype; <span class=\"comment\">// true</span></div><div class=\"line\">xiaoming <span class=\"keyword\">instanceof</span> Student; <span class=\"comment\">// true</span></div></pre></td></tr></table></figure></p>\n<p></p>\n<p><img src=\"/images/blogimages/2017/js/js_function_construction.png\" alt=\"\"></p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">xiaoming.name; <span class=\"comment\">// ''</span></div><div class=\"line\">xiaohong.name; <span class=\"comment\">// ''</span></div><div class=\"line\">xiaoming.hello; <span class=\"comment\">// function: Student.hello()</span></div><div class=\"line\">xiaohong.hello; <span class=\"comment\">// function: Student.hello()</span></div><div class=\"line\">xiaoming.hello === xiaohong.hello; <span class=\"comment\">// false</span></div></pre></td></tr></table></figure></p>\n<p>xiaomingxiaohongname</p>\n<p>xiaomingxiaohonghello</p>\n<p>new Student()hello</p>\n<p>hellohelloxiaomingxiaohongStudent.prototype</p>\n<p><img src=\"/images/blogimages/2017/js/js_function_construction_1.png\" alt=\"\"></p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Student</span>(<span class=\"params\">name</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">this</span>.name = name;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">Student.prototype.hello = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    alert(<span class=\"string\">'Hello, '</span> + <span class=\"keyword\">this</span>.name + <span class=\"string\">'!'</span>);</div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure></p>\n<p><strong>new</strong></p>\n<p>new</p>\n<p>strictthis.name = namethisundefinedstrictthis.name = namethiswindownameundefined</p>\n<p>newjslintnew</p>\n<p>createStudent()new<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Student</span>(<span class=\"params\">props</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">this</span>.name = props.name || <span class=\"string\">''</span>; <span class=\"comment\">// ''</span></div><div class=\"line\">    <span class=\"keyword\">this</span>.grade = props.grade || <span class=\"number\">1</span>; <span class=\"comment\">// 1</span></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">Student.prototype.hello = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    alert(<span class=\"string\">'Hello, '</span> + <span class=\"keyword\">this</span>.name + <span class=\"string\">'!'</span>);</div><div class=\"line\">&#125;;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">createStudent</span>(<span class=\"params\">props</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Student(props || &#123;&#125;)</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>createStudent()new<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> xiaoming = createStudent(&#123;</div><div class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">''</span></div><div class=\"line\">&#125;);</div><div class=\"line\"></div><div class=\"line\">xiaoming.grade; <span class=\"comment\">// 1</span></div></pre></td></tr></table></figure></p>\n<p>ObjectJSONxiaoming</p>\n<p><strong></strong><br>ClassJavaC++ClassSubclass<br>JavaScriptClassClass</p>\n<p>StudentStudentPrimaryStudentPrimaryStudent<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">PrimaryStudent</span>(<span class=\"params\">props</span>) </span>&#123;</div><div class=\"line\">    <span class=\"comment\">// Studentthis:</span></div><div class=\"line\">    Student.call(<span class=\"keyword\">this</span>, props);</div><div class=\"line\">    <span class=\"keyword\">this</span>.grade = props.grade || <span class=\"number\">1</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>StudentStudentPrimaryStudent<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">new</span> PrimaryStudent() ----&gt; PrimaryStudent.prototype ----&gt; <span class=\"built_in\">Object</span>.prototype ----&gt; <span class=\"literal\">null</span></div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">new</span> PrimaryStudent() ----&gt; PrimaryStudent.prototype ----&gt; Student.prototype ----&gt; <span class=\"built_in\">Object</span>.prototype ----&gt; <span class=\"literal\">null</span></div></pre></td></tr></table></figure></p>\n<p>Student.prototypeJSONF<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// PrimaryStudent:</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">PrimaryStudent</span>(<span class=\"params\">props</span>) </span>&#123;</div><div class=\"line\">    Student.call(<span class=\"keyword\">this</span>, props);</div><div class=\"line\">    <span class=\"keyword\">this</span>.grade = props.grade || <span class=\"number\">1</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// F:</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">F</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// FStudent.prototype:</span></div><div class=\"line\">F.prototype = Student.prototype;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// PrimaryStudentFFStudent.prototype:</span></div><div class=\"line\">PrimaryStudent.prototype = <span class=\"keyword\">new</span> F();</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// PrimaryStudentPrimaryStudent:</span></div><div class=\"line\">PrimaryStudent.prototype.constructor = PrimaryStudent;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// PrimaryStudentnew F()</span></div><div class=\"line\">PrimaryStudent.prototype.getGrade = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.grade;</div><div class=\"line\">&#125;;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// xiaoming:</span></div><div class=\"line\"><span class=\"keyword\">var</span> xiaoming = <span class=\"keyword\">new</span> PrimaryStudent(&#123;</div><div class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">''</span>,</div><div class=\"line\">    <span class=\"attr\">grade</span>: <span class=\"number\">2</span></div><div class=\"line\">&#125;);</div><div class=\"line\">xiaoming.name; <span class=\"comment\">// ''</span></div><div class=\"line\">xiaoming.grade; <span class=\"comment\">// 2</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// :</span></div><div class=\"line\">xiaoming.__proto__ === PrimaryStudent.prototype; <span class=\"comment\">// true</span></div><div class=\"line\">xiaoming.__proto__.__proto__ === Student.prototype; <span class=\"comment\">// true</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// :</span></div><div class=\"line\">xiaoming <span class=\"keyword\">instanceof</span> PrimaryStudent; <span class=\"comment\">// true</span></div><div class=\"line\">xiaoming <span class=\"keyword\">instanceof</span> Student; <span class=\"comment\">// true</span></div></pre></td></tr></table></figure></p>\n<p></p>\n<p><img src=\"/images/blogimages/2017/js/js_function_construction_2.png\" alt=\"\"></p>\n<blockquote>\n<p>Fnew F()Student</p>\n</blockquote>\n<p>inherits()F<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">inherits</span>(<span class=\"params\">Child, Parent</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> F = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;&#125;;</div><div class=\"line\">    F.prototype = Parent.prototype;</div><div class=\"line\">    Child.prototype = <span class=\"keyword\">new</span> F();</div><div class=\"line\">    Child.prototype.constructor = Child;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>inherits()<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Student</span>(<span class=\"params\">props</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">this</span>.name = props.name || <span class=\"string\">'Unnamed'</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">Student.prototype.hello = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    alert(<span class=\"string\">'Hello, '</span> + <span class=\"keyword\">this</span>.name + <span class=\"string\">'!'</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">PrimaryStudent</span>(<span class=\"params\">props</span>) </span>&#123;</div><div class=\"line\">    Student.call(<span class=\"keyword\">this</span>, props);</div><div class=\"line\">    <span class=\"keyword\">this</span>.grade = props.grade || <span class=\"number\">1</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// :</span></div><div class=\"line\">inherits(PrimaryStudent, Student);</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// PrimaryStudent:</span></div><div class=\"line\">PrimaryStudent.prototype.getGrade = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.grade;</div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure></p>\n<p>JavaScript</p>\n<ul>\n<li>call()this</li>\n<li>Finherits</li>\n<li></li>\n</ul>\n<h3 id=\"class\"><a href=\"#class\" class=\"headerlink\" title=\"class\"></a>class</h3><p>JavaScript</p>\n<p>classES6JavaScriptclass</p>\n<p>classStudent<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Student</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">constructor</span>(name) &#123;</div><div class=\"line\">        <span class=\"keyword\">this</span>.name = name;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    hello() &#123;</div><div class=\"line\">        alert(<span class=\"string\">'Hello, '</span> + <span class=\"keyword\">this</span>.name + <span class=\"string\">'!'</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>classconstructorhello()functionStudent.prototype.hello = function () {}</p>\n<p>Student<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> xiaoming = <span class=\"keyword\">new</span> Student(<span class=\"string\">''</span>);</div><div class=\"line\">xiaoming.hello();</div></pre></td></tr></table></figure></p>\n<p><strong>class</strong><br>extends<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">PrimaryStudent</span> <span class=\"keyword\">extends</span> <span class=\"title\">Student</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">constructor</span>(name, grade) &#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>(name); <span class=\"comment\">// super!</span></div><div class=\"line\">        <span class=\"keyword\">this</span>.grade = grade;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    myGrade() &#123;</div><div class=\"line\">        alert(<span class=\"string\">'I am at grade '</span> + <span class=\"keyword\">this</span>.grade);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>PrimaryStudentclassextendsStudentPrimaryStudentnamegrade<strong>super(name)</strong>name</p>\n<p>PrimaryStudentStudenthellomyGrade</p>\n<p>ES6classJavaScriptclassJavaScriptclass</p>\n<p>class</p>\n<p>ES6classclassprototype<a href=\"https://babeljs.io/\" target=\"_blank\" rel=\"external\">Babel</a></p>\n<h3 id=\"DOM\"><a href=\"#DOM\" class=\"headerlink\" title=\"DOM\"></a>DOM</h3><p>HTMLDOMHTMLJavaScriptDOM</p>\n<p>DOMDOM</p>\n<ul>\n<li>DOMDOMHTML</li>\n<li>DOM</li>\n<li>DOMHTML</li>\n<li>HTMLDOM</li>\n</ul>\n<p>DOMDOM<strong>document.getElementById()</strong><strong>document.getElementsByTagName()</strong>CSS<strong>document.getElementsByClassName()</strong></p>\n<p>IDHTMLdocument.getElementById()DOMdocument.getElementsByTagName()document.getElementsByClassName()DOMDOM</p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// ID'test'</span></div><div class=\"line\"><span class=\"keyword\">var</span> test = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'test'</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// ID'test-table'tr</span></div><div class=\"line\"><span class=\"keyword\">var</span> trs = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'test-table'</span>).getElementsByTagName(<span class=\"string\">'tr'</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// ID'test-div'classred</span></div><div class=\"line\"><span class=\"keyword\">var</span> reds = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'test-div'</span>).getElementsByClassName(<span class=\"string\">'red'</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// test:</span></div><div class=\"line\"><span class=\"keyword\">var</span> cs = test.children;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// test</span></div><div class=\"line\"><span class=\"keyword\">var</span> first = test.firstElementChild;</div><div class=\"line\"><span class=\"keyword\">var</span> last = test.lastElementChild;</div></pre></td></tr></table></figure></p>\n<p>querySelector()querySelectorAll()selector<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// querySelectorIDq1</span></div><div class=\"line\"><span class=\"keyword\">var</span> q1 = <span class=\"built_in\">document</span>.querySelector(<span class=\"string\">'#q1'</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// querySelectorAllq1</span></div><div class=\"line\"><span class=\"keyword\">var</span> ps = q1.querySelectorAll(<span class=\"string\">'div.highlighted &gt; p'</span>);</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>IE&lt;8querySelectorquerySelectorAllIE8</p>\n</blockquote>\n<p>DOMElementDOMNodeHTMLNodeElementCommentCDATA_SECTIONDocumentElementNodeNodeDocumentdocument</p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/10/22/JavaScript-knowledge/\">http://agehua.github.io/2017/10/22/JavaScript-knowledge/</a></p>\n","readingTime":{"text":"19 min read","minutes":18.19,"time":1091400,"words":3638},"excerpt":"<h2 id=\"JavaScript\"><a href=\"#JavaScript\" class=\"headerlink\" title=\"JavaScript\"></a>JavaScript</h2><blockquote>\n<p>: <a href=\"https://www.liaoxuefeng.com/wiki/001434446689867b27157e896e74d51a89c25cc8b43bdb3000\">JavaScript</a></p>\n</blockquote>\n<h3 id=\"for--of\"><a href=\"#for--of\" class=\"headerlink\" title=\"for  of\"></a>for  of</h3><p>ES6for  offor  offor  in</p>\n<p>for  inArray</p>","more":"<p>Arrayfor  in<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> a = [<span class=\"string\">'A'</span>, <span class=\"string\">'B'</span>, <span class=\"string\">'C'</span>];</div><div class=\"line\">a.name = <span class=\"string\">'Hello'</span>;</div><div class=\"line\"><span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> x <span class=\"keyword\">in</span> a) &#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(x); <span class=\"comment\">// '0', '1', '2', 'name'</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>for  innameArraylength</p>\n<p>for  of<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> a = [<span class=\"string\">'A'</span>, <span class=\"string\">'B'</span>, <span class=\"string\">'C'</span>];</div><div class=\"line\">a.name = <span class=\"string\">'Hello'</span>;</div><div class=\"line\"><span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> x <span class=\"keyword\">of</span> a) &#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(x); <span class=\"comment\">// 'A', 'B', 'C'</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>for  of</p>\n<p>iterableforEachArray</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">'use strict'</span>;</div><div class=\"line\"><span class=\"keyword\">var</span> a = [<span class=\"string\">'A'</span>, <span class=\"string\">'B'</span>, <span class=\"string\">'C'</span>];</div><div class=\"line\">a.forEach(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">element, index, array</span>) </span>&#123;</div><div class=\"line\">    <span class=\"comment\">// element: </span></div><div class=\"line\">    <span class=\"comment\">// index: </span></div><div class=\"line\">    <span class=\"comment\">// array: Array</span></div><div class=\"line\">    <span class=\"built_in\">console</span>.log(element + <span class=\"string\">', index = '</span> + index);</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure>\n<blockquote>\n<p>forEach()ES5.1</p>\n</blockquote>\n<p>SetArraySet<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> s = <span class=\"keyword\">new</span> <span class=\"built_in\">Set</span>([<span class=\"string\">'A'</span>, <span class=\"string\">'B'</span>, <span class=\"string\">'C'</span>]);</div><div class=\"line\">s.forEach(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">element, sameElement, set</span>) </span>&#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(element);</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure></p>\n<p>Mapvaluekeymap<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> m = <span class=\"keyword\">new</span> <span class=\"built_in\">Map</span>([[<span class=\"number\">1</span>, <span class=\"string\">'x'</span>], [<span class=\"number\">2</span>, <span class=\"string\">'y'</span>], [<span class=\"number\">3</span>, <span class=\"string\">'z'</span>]]);</div><div class=\"line\">m.forEach(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">value, key, map</span>) </span>&#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(value);</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure></p>\n<p>JavaScriptArrayelement<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> a = [<span class=\"string\">'A'</span>, <span class=\"string\">'B'</span>, <span class=\"string\">'C'</span>];</div><div class=\"line\">a.forEach(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">element</span>) </span>&#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(element);</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure></p>\n<h3 id=\"rest\"><a href=\"#rest\" class=\"headerlink\" title=\"rest\"></a>rest</h3><p>JavaScriptargumentsargumentsArrayArray.<br>JavaScriptarguments<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">foo</span>(<span class=\"params\">a, b</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> i, rest = [];</div><div class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">arguments</span>.length &gt; <span class=\"number\">2</span>) &#123;</div><div class=\"line\">        <span class=\"keyword\">for</span> (i = <span class=\"number\">2</span>; i&lt;<span class=\"built_in\">arguments</span>.length; i++) &#123;</div><div class=\"line\">            rest.push(<span class=\"built_in\">arguments</span>[i]);</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'a = '</span> + a);</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'b = '</span> + b);</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(rest);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>abarguments2rest</p>\n<p>ES6rest<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">foo</span>(<span class=\"params\">a, b, ...rest</span>) </span>&#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'a = '</span> + a);</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'b = '</span> + b);</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(rest);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">foo(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>);</div><div class=\"line\"><span class=\"comment\">// :</span></div><div class=\"line\"><span class=\"comment\">// a = 1</span></div><div class=\"line\"><span class=\"comment\">// b = 2</span></div><div class=\"line\"><span class=\"comment\">// Array [ 3, 4, 5 ]</span></div><div class=\"line\"></div><div class=\"line\">foo(<span class=\"number\">1</span>);</div><div class=\"line\"><span class=\"comment\">// :</span></div><div class=\"line\"><span class=\"comment\">// a = 1</span></div><div class=\"line\"><span class=\"comment\">// b = undefined</span></div><div class=\"line\"><span class=\"comment\">// Array []</span></div></pre></td></tr></table></figure></p>\n<p>restabrestarguments</p>\n<p>restundefined</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>JavaScriptwindowwindow</p>\n<p>var foo = function () {}window<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">'use strict'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">foo</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    alert(<span class=\"string\">'foo'</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">foo(); <span class=\"comment\">// foo()</span></div><div class=\"line\"><span class=\"built_in\">window</span>.foo(); <span class=\"comment\">// window.foo()</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>windowJavaScript</p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// MYAPP:</span></div><div class=\"line\"><span class=\"keyword\">var</span> MYAPP = &#123;&#125;;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// :</span></div><div class=\"line\">MYAPP.name = <span class=\"string\">'myapp'</span>;</div><div class=\"line\">MYAPP.version = <span class=\"number\">1.0</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// :</span></div><div class=\"line\">MYAPP.foo = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">'foo'</span>;</div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure></p>\n<p>MYAPP</p>\n<p>JavaScriptjQueryYUIunderscore</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>JavaScriptfor<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">'use strict'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">foo</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i=<span class=\"number\">0</span>; i&lt;<span class=\"number\">100</span>; i++) &#123;</div><div class=\"line\">        <span class=\"comment\">//</span></div><div class=\"line\">    &#125;</div><div class=\"line\">    i += <span class=\"number\">100</span>; <span class=\"comment\">// i</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>ES6letletvar<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">'use strict'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">foo</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> sum = <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i=<span class=\"number\">0</span>; i&lt;<span class=\"number\">100</span>; i++) &#123;</div><div class=\"line\">        sum += i;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"comment\">// SyntaxError:</span></div><div class=\"line\">    i += <span class=\"number\">1</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>ES6constconstlet.</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>ES6JavaScript<strong></strong><br><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">let</span> [x, [y, z]] = [<span class=\"string\">'hello'</span>, [<span class=\"string\">'JavaScript'</span>, <span class=\"string\">'ES6'</span>]];</div><div class=\"line\">x; <span class=\"comment\">// 'hello'</span></div><div class=\"line\">y; <span class=\"comment\">// 'JavaScript'</span></div><div class=\"line\">z; <span class=\"comment\">// 'ES6'</span></div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">let</span> [, , z] = [<span class=\"string\">'hello'</span>, <span class=\"string\">'JavaScript'</span>, <span class=\"string\">'ES6'</span>]; <span class=\"comment\">// z</span></div><div class=\"line\">z; <span class=\"comment\">// 'ES6'</span></div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> person = &#123;</div><div class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">''</span>,</div><div class=\"line\">    <span class=\"attr\">age</span>: <span class=\"number\">20</span>,</div><div class=\"line\">    <span class=\"attr\">gender</span>: <span class=\"string\">'male'</span>,</div><div class=\"line\">    <span class=\"attr\">passport</span>: <span class=\"string\">'G-12345678'</span>,</div><div class=\"line\">    <span class=\"attr\">school</span>: <span class=\"string\">'No.4 middle school'</span>,</div><div class=\"line\">    <span class=\"attr\">address</span>: &#123;</div><div class=\"line\">        <span class=\"attr\">city</span>: <span class=\"string\">'Beijing'</span>,</div><div class=\"line\">        <span class=\"attr\">street</span>: <span class=\"string\">'No.1 Road'</span>,</div><div class=\"line\">        <span class=\"attr\">zipcode</span>: <span class=\"string\">'100001'</span></div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;;</div><div class=\"line\"><span class=\"keyword\">var</span> &#123;name, <span class=\"attr\">address</span>: &#123;city, zip&#125;&#125; = person;</div><div class=\"line\">name; <span class=\"comment\">// ''</span></div><div class=\"line\">city; <span class=\"comment\">// 'Beijing'</span></div><div class=\"line\">zip; <span class=\"comment\">// undefined, zipcodezip</span></div><div class=\"line\"><span class=\"comment\">// : addresscityzipaddress:</span></div><div class=\"line\">address; <span class=\"comment\">// Uncaught ReferenceError: address is not defined</span></div></pre></td></tr></table></figure></p>\n<p>undefinedundefined<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> person = &#123;</div><div class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">''</span>,</div><div class=\"line\">    <span class=\"attr\">age</span>: <span class=\"number\">20</span>,</div><div class=\"line\">    <span class=\"attr\">gender</span>: <span class=\"string\">'male'</span>,</div><div class=\"line\">    <span class=\"attr\">passport</span>: <span class=\"string\">'G-12345678'</span>,</div><div class=\"line\">    <span class=\"attr\">school</span>: <span class=\"string\">'No.4 middle school'</span></div><div class=\"line\">&#125;;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// passportid:</span></div><div class=\"line\"><span class=\"keyword\">let</span> &#123;name, <span class=\"attr\">passport</span>:id&#125; = person;</div><div class=\"line\">name; <span class=\"comment\">// ''</span></div><div class=\"line\">id; <span class=\"comment\">// 'G-12345678'</span></div><div class=\"line\"><span class=\"comment\">// : passportidpassport:</span></div><div class=\"line\">passport; <span class=\"comment\">// Uncaught ReferenceError: passport is not defined</span></div></pre></td></tr></table></figure></p>\n<p>undefined<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> person = &#123;</div><div class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">''</span>,</div><div class=\"line\">    <span class=\"attr\">age</span>: <span class=\"number\">20</span>,</div><div class=\"line\">    <span class=\"attr\">gender</span>: <span class=\"string\">'male'</span>,</div><div class=\"line\">    <span class=\"attr\">passport</span>: <span class=\"string\">'G-12345678'</span></div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure></p>\n<p>// personsingletrue:<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> &#123;name, single=<span class=\"literal\">true</span>&#125; = person;</div><div class=\"line\">name; <span class=\"comment\">// ''</span></div><div class=\"line\">single; <span class=\"comment\">// true</span></div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// :</span></div><div class=\"line\"><span class=\"keyword\">var</span> x, y;</div><div class=\"line\"><span class=\"comment\">// :</span></div><div class=\"line\">&#123;x, y&#125; = &#123; <span class=\"attr\">name</span>: <span class=\"string\">''</span>, <span class=\"attr\">x</span>: <span class=\"number\">100</span>, <span class=\"attr\">y</span>: <span class=\"number\">200</span>&#125;;</div><div class=\"line\"><span class=\"comment\">// : Uncaught SyntaxError: Unexpected token =</span></div></pre></td></tr></table></figure></p>\n<p>JavaScript{=<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">(&#123;x, y&#125; = &#123; <span class=\"attr\">name</span>: <span class=\"string\">''</span>, <span class=\"attr\">x</span>: <span class=\"number\">100</span>, <span class=\"attr\">y</span>: <span class=\"number\">200</span>&#125;);</div></pre></td></tr></table></figure></p>\n<p><strong></strong></p>\n<p>xy<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> x=<span class=\"number\">1</span>, y=<span class=\"number\">2</span>;</div><div class=\"line\">[x, y] = [y, x]</div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> &#123;<span class=\"attr\">hostname</span>:domain, <span class=\"attr\">pathname</span>:path&#125; = location;</div></pre></td></tr></table></figure></p>\n<p>Date<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">buildDate</span>(<span class=\"params\">&#123;year, month, day, hour=<span class=\"number\">0</span>, minute=<span class=\"number\">0</span>, second=<span class=\"number\">0</span>&#125;</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>(year + <span class=\"string\">'-'</span> + month + <span class=\"string\">'-'</span> + day + <span class=\"string\">' '</span> + hour + <span class=\"string\">':'</span> + minute + <span class=\"string\">':'</span> + second);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>yearmonthday<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">buildDate(&#123; <span class=\"attr\">year</span>: <span class=\"number\">2017</span>, <span class=\"attr\">month</span>: <span class=\"number\">1</span>, <span class=\"attr\">day</span>: <span class=\"number\">1</span> &#125;);</div><div class=\"line\"><span class=\"comment\">// Sun Jan 01 2017 00:00:00 GMT+0800 (CST)</span></div></pre></td></tr></table></figure></p>\n<p>hourminutesecond<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">buildDate(&#123; <span class=\"attr\">year</span>: <span class=\"number\">2017</span>, <span class=\"attr\">month</span>: <span class=\"number\">1</span>, <span class=\"attr\">day</span>: <span class=\"number\">1</span>, <span class=\"attr\">hour</span>: <span class=\"number\">20</span>, <span class=\"attr\">minute</span>: <span class=\"number\">15</span> &#125;);</div><div class=\"line\"><span class=\"comment\">// Sun Jan 01 2017 20:15:00 GMT+0800 (CST)</span></div></pre></td></tr></table></figure></p>\n<p>ES6ChromeFirefoxEdge</p>\n<h3 id=\"thisapplycall\"><a href=\"#thisapplycall\" class=\"headerlink\" title=\"thisapplycall\"></a>thisapplycall</h3><p>this<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">'use strict'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> xiaoming = &#123;</div><div class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">''</span>,</div><div class=\"line\">    <span class=\"attr\">birth</span>: <span class=\"number\">1990</span>,</div><div class=\"line\">    <span class=\"attr\">age</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">var</span> y = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().getFullYear();</div><div class=\"line\">        <span class=\"keyword\">return</span> y - <span class=\"keyword\">this</span>.birth;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> fn = xiaoming.age;</div><div class=\"line\">fn(); <span class=\"comment\">// Uncaught TypeError: Cannot read property 'birth' of undefined</span></div></pre></td></tr></table></figure></p>\n<p>thisagexiaomingthisundefinedstrictwindow</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">'use strict'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> xiaoming = &#123;</div><div class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">''</span>,</div><div class=\"line\">    <span class=\"attr\">birth</span>: <span class=\"number\">1990</span>,</div><div class=\"line\">    <span class=\"attr\">age</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">var</span> that = <span class=\"keyword\">this</span>; <span class=\"comment\">// this</span></div><div class=\"line\">        <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getAgeFromBirth</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">            <span class=\"keyword\">var</span> y = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().getFullYear();</div><div class=\"line\">            <span class=\"keyword\">return</span> y - that.birth; <span class=\"comment\">// thatthis</span></div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">return</span> getAgeFromBirth();</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;;</div><div class=\"line\"></div><div class=\"line\">xiaoming.age(); <span class=\"comment\">// 25</span></div></pre></td></tr></table></figure>\n<p>var that = this;</p>\n<p>strictthisundefinedwindowthis</p>\n<p>this<strong></strong>applythisArray</p>\n<p>applygetAge()<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getAge</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> y = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().getFullYear();</div><div class=\"line\">    <span class=\"keyword\">return</span> y - <span class=\"keyword\">this</span>.birth;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> xiaoming = &#123;</div><div class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">''</span>,</div><div class=\"line\">    <span class=\"attr\">birth</span>: <span class=\"number\">1990</span>,</div><div class=\"line\">    <span class=\"attr\">age</span>: getAge</div><div class=\"line\">&#125;;</div><div class=\"line\"></div><div class=\"line\">xiaoming.age(); <span class=\"comment\">// 25</span></div><div class=\"line\">getAge.apply(xiaoming, []); <span class=\"comment\">// 25, thisxiaoming, </span></div></pre></td></tr></table></figure></p>\n<p>apply()call()</p>\n<ul>\n<li>apply()Array</li>\n<li>call()</li>\n</ul>\n<p>Math.max(3, 5, 4)apply()call()<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">Math</span>.max.apply(<span class=\"literal\">null</span>, [<span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">4</span>]); <span class=\"comment\">// 5</span></div><div class=\"line\"><span class=\"built_in\">Math</span>.max.call(<span class=\"literal\">null</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">4</span>); <span class=\"comment\">// 5</span></div></pre></td></tr></table></figure></p>\n<p>thisnull</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>apply()</p>\n<p>JavaScript</p>\n<p>parseInt()count += 1parseInt()<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">'use strict'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> count = <span class=\"number\">0</span>;</div><div class=\"line\"><span class=\"keyword\">var</span> oldParseInt = <span class=\"built_in\">parseInt</span>; <span class=\"comment\">// </span></div><div class=\"line\"></div><div class=\"line\"><span class=\"built_in\">window</span>.parseInt = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    count += <span class=\"number\">1</span>;</div><div class=\"line\">    <span class=\"keyword\">return</span> oldParseInt.apply(<span class=\"literal\">null</span>, <span class=\"built_in\">arguments</span>); <span class=\"comment\">// </span></div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>JavaScript</p>\n<p><strong>map</strong><br>map()JavaScriptArrayArraymap()Array<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">'use strict'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">pow</span>(<span class=\"params\">x</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> x * x;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"keyword\">var</span> arr = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>, <span class=\"number\">8</span>, <span class=\"number\">9</span>];</div><div class=\"line\"><span class=\"keyword\">var</span> results = arr.map(pow); <span class=\"comment\">// [1, 4, 9, 16, 25, 36, 49, 64, 81]</span></div><div class=\"line\"><span class=\"built_in\">console</span>.log(results);</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>map()pow</p>\n</blockquote>\n<p>Array<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> arr = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>, <span class=\"number\">8</span>, <span class=\"number\">9</span>];</div><div class=\"line\">arr.map(<span class=\"built_in\">String</span>); <span class=\"comment\">// ['1', '2', '3', '4', '5', '6', '7', '8', '9']</span></div></pre></td></tr></table></figure></p>\n<p></p>\n<p><strong>reduce</strong><br>Arrayreduce()Array[x1, x2, x3]reduce()<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">[x1, x2, x3, x4].reduce(f) = f(f(f(x1, x2), x3), x4)</div></pre></td></tr></table></figure></p>\n<p>[1, 3, 5, 7, 9]13579reduce()<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> arr = [<span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">7</span>, <span class=\"number\">9</span>];</div><div class=\"line\">arr.reduce(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">x, y</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> x * <span class=\"number\">10</span> + y;</div><div class=\"line\">&#125;); <span class=\"comment\">// 13579</span></div></pre></td></tr></table></figure></p>\n<p><strong>filter</strong><br>filterArray</p>\n<p>map()Arrayfilter()map()filter()truefalse</p>\n<p>Array<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> arr = [<span class=\"string\">'A'</span>, <span class=\"string\">''</span>, <span class=\"string\">'B'</span>, <span class=\"literal\">null</span>, <span class=\"literal\">undefined</span>, <span class=\"string\">'C'</span>, <span class=\"string\">'  '</span>];</div><div class=\"line\"><span class=\"keyword\">var</span> r = arr.filter(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">s</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> s &amp;&amp; s.trim(); <span class=\"comment\">// IE9trim()</span></div><div class=\"line\">&#125;);</div><div class=\"line\">r; <span class=\"comment\">// ['A', 'B', 'C']</span></div></pre></td></tr></table></figure></p>\n<p>filter()Array<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> arr = [<span class=\"string\">'A'</span>, <span class=\"string\">'B'</span>, <span class=\"string\">'C'</span>];</div><div class=\"line\"><span class=\"keyword\">var</span> r = arr.filter(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">element, index, self</span>) </span>&#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(element); <span class=\"comment\">// 'A', 'B', 'C'</span></div><div class=\"line\">    <span class=\"built_in\">console</span>.log(index); <span class=\"comment\">// 0, 1, 2</span></div><div class=\"line\">    <span class=\"built_in\">console</span>.log(self); <span class=\"comment\">// selfarr</span></div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure></p>\n<p>filterArray<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">'use strict'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span></div><div class=\"line\">    r,</div><div class=\"line\">    arr = [<span class=\"string\">'apple'</span>, <span class=\"string\">'strawberry'</span>, <span class=\"string\">'banana'</span>, <span class=\"string\">'pear'</span>, <span class=\"string\">'apple'</span>, <span class=\"string\">'orange'</span>, <span class=\"string\">'orange'</span>, <span class=\"string\">'strawberry'</span>];</div><div class=\"line\"></div><div class=\"line\">r = arr.filter(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">element, index, self</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> self.indexOf(element) === index;</div><div class=\"line\">&#125;);</div><div class=\"line\"><span class=\"built_in\">console</span>.log(r.toString());</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>indexOfindexOffilter</p>\n</blockquote>\n<p><strong>sort()</strong><br>sort()ArrayArray<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> a1 = [<span class=\"string\">'B'</span>, <span class=\"string\">'A'</span>, <span class=\"string\">'C'</span>];</div><div class=\"line\"><span class=\"keyword\">var</span> a2 = a1.sort();</div><div class=\"line\">a1; <span class=\"comment\">// ['A', 'B', 'C']</span></div><div class=\"line\">a2; <span class=\"comment\">// ['A', 'B', 'C']</span></div><div class=\"line\">a1 === a2; <span class=\"comment\">// true, a1a2</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p><strong></strong><br><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">count</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> arr = [];</div><div class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i=<span class=\"number\">1</span>; i&lt;=<span class=\"number\">3</span>; i++) &#123;</div><div class=\"line\">        arr.push((<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">n</span>) </span>&#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">                <span class=\"keyword\">return</span> n * n;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;)(i));</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> arr;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> results = count();</div><div class=\"line\"><span class=\"keyword\">var</span> f1 = results[<span class=\"number\">0</span>];</div><div class=\"line\"><span class=\"keyword\">var</span> f2 = results[<span class=\"number\">1</span>];</div><div class=\"line\"><span class=\"keyword\">var</span> f3 = results[<span class=\"number\">2</span>];</div><div class=\"line\"></div><div class=\"line\">f1(); <span class=\"comment\">// 1</span></div><div class=\"line\">f2(); <span class=\"comment\">// 4</span></div><div class=\"line\">f3(); <span class=\"comment\">// 9</span></div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">x</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> x * x;</div><div class=\"line\">&#125;)(<span class=\"number\">3</span>); <span class=\"comment\">// 9</span></div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">x</span>) </span>&#123; <span class=\"keyword\">return</span> x * x &#125; (<span class=\"number\">3</span>);</div></pre></td></tr></table></figure></p>\n<p>JavaScriptSyntaxError<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">x</span>) </span>&#123; <span class=\"keyword\">return</span> x * x &#125;) (<span class=\"number\">3</span>);</div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">x</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> x * x;</div><div class=\"line\">&#125;)(<span class=\"number\">3</span>)</div></pre></td></tr></table></figure></p>\n<p></p>\n<p>JavaC++private</p>\n<p>classJavaScript<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">'use strict'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">create_counter</span>(<span class=\"params\">initial</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> x = initial || <span class=\"number\">0</span>;</div><div class=\"line\">    <span class=\"keyword\">return</span> &#123;</div><div class=\"line\">        <span class=\"attr\">inc</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">            x += <span class=\"number\">1</span>;</div><div class=\"line\">            <span class=\"keyword\">return</span> x;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> c1 = create_counter();</div><div class=\"line\">c1.inc(); <span class=\"comment\">// 1</span></div><div class=\"line\">c1.inc(); <span class=\"comment\">// 2</span></div><div class=\"line\">c1.inc(); <span class=\"comment\">// 3</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> c2 = create_counter(<span class=\"number\">10</span>);</div><div class=\"line\">c2.inc(); <span class=\"comment\">// 11</span></div><div class=\"line\">c2.inc(); <span class=\"comment\">// 12</span></div><div class=\"line\">c2.inc(); <span class=\"comment\">// 13</span></div></pre></td></tr></table></figure></p>\n<p>xx</p>\n<p>xyMath.pow(x, y)x2x3pow2pow3<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">'use strict'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">make_pow</span>(<span class=\"params\">n</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">x</span>) </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">Math</span>.pow(x, n);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// :</span></div><div class=\"line\"><span class=\"keyword\">var</span> pow2 = make_pow(<span class=\"number\">2</span>);</div><div class=\"line\"><span class=\"keyword\">var</span> pow3 = make_pow(<span class=\"number\">3</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"built_in\">console</span>.log(pow2(<span class=\"number\">5</span>)); <span class=\"comment\">// 25</span></div><div class=\"line\"><span class=\"built_in\">console</span>.log(pow3(<span class=\"number\">7</span>)); <span class=\"comment\">// 343</span></div></pre></td></tr></table></figure></p>\n<p><strong></strong></p>\n<ul>\n<li>1IE</li>\n<li>2objectPublic Methodprivate value</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"http://www.ruanyifeng.com/blog/2009/08/learning_javascript_closures.html\">JavascriptClosure</a></p>\n<p><br><br><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> name = <span class=\"string\">\"The Window\"</span>;</div><div class=\"line\"><span class=\"keyword\">var</span> object = &#123;</div><div class=\"line\"><span class=\"attr\">name</span> : <span class=\"string\">\"My Object\"</span>,</div><div class=\"line\"><span class=\"attr\">getNameFunc</span> : <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</div><div class=\"line\"><span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</div><div class=\"line\"><span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.name;</div><div class=\"line\">&#125;;</div><div class=\"line\">&#125;</div><div class=\"line\">&#125;;</div><div class=\"line\">alert(object.getNameFunc()());</div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> name = <span class=\"string\">\"The Window\"</span>;</div><div class=\"line\"><span class=\"keyword\">var</span> object = &#123;</div><div class=\"line\"><span class=\"attr\">name</span> : <span class=\"string\">\"My Object\"</span>,</div><div class=\"line\"><span class=\"attr\">getNameFunc</span> : <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</div><div class=\"line\"><span class=\"keyword\">var</span> that = <span class=\"keyword\">this</span>;</div><div class=\"line\"><span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</div><div class=\"line\"><span class=\"keyword\">return</span> that.name;</div><div class=\"line\">&#125;;</div><div class=\"line\">&#125;</div><div class=\"line\">&#125;;</div><div class=\"line\">alert(object.getNameFunc()());</div></pre></td></tr></table></figure></p>\n<p>The WindowMy Object</p>\n<p>this. </p>\n<blockquote>\n<p>In JavaScript this always refers to the owner of the function were executing, or rather, to the object that a function is a method of. </p>\n</blockquote>\n<p><a href=\"http://www.quirksmode.org/js/this.html\">The this keyword</a></p>\n<p><strong>thisownerfunctionobjectmethodobject</strong></p>\n<p>object.getNameFunc()functionf:<br><strong>alert(object.getNameFunc()());  === alert(f());</strong><br>f()objectthiswindownameThe Window</p>\n<p>object.getNameFunc()thisobject<strong>thatthat</strong>functionthat<br><strong>alert(object.getNameFunc()());  === alert(f(that));</strong><br>nameMy Object</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>ES6Arrow Function<br>{  }return{  }return()<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// :</span></div><div class=\"line\">(x, y) =&gt; x * x + y * y</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// :</span></div><div class=\"line\">() =&gt; <span class=\"number\">3.14</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// :</span></div><div class=\"line\">(x, y, ...rest) =&gt; &#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> i, sum = x + y;</div><div class=\"line\">    <span class=\"keyword\">for</span> (i=<span class=\"number\">0</span>; i&lt;rest.length; i++) &#123;</div><div class=\"line\">        sum += rest[i];</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> sum;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// SyntaxError:</span></div><div class=\"line\">x =&gt; &#123; <span class=\"attr\">foo</span>: x &#125;</div></pre></td></tr></table></figure></p>\n<p>{  }<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// ok:</span></div><div class=\"line\">x =&gt; (&#123; <span class=\"attr\">foo</span>: x &#125;)</div></pre></td></tr></table></figure></p>\n<p><strong>this</strong></p>\n<p><strong>this</strong></p>\n<p>JavaScriptthis<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> obj = &#123;</div><div class=\"line\">    <span class=\"attr\">birth</span>: <span class=\"number\">1990</span>,</div><div class=\"line\">    <span class=\"attr\">getAge</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">var</span> b = <span class=\"keyword\">this</span>.birth; <span class=\"comment\">// 1990</span></div><div class=\"line\">        <span class=\"keyword\">var</span> fn = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().getFullYear() - <span class=\"keyword\">this</span>.birth; <span class=\"comment\">// thiswindowundefined</span></div><div class=\"line\">        &#125;;</div><div class=\"line\">        <span class=\"keyword\">return</span> fn();</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure></p>\n<p>thisthisobj<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> obj = &#123;</div><div class=\"line\">    <span class=\"attr\">birth</span>: <span class=\"number\">1990</span>,</div><div class=\"line\">    <span class=\"attr\">getAge</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">var</span> b = <span class=\"keyword\">this</span>.birth; <span class=\"comment\">// 1990</span></div><div class=\"line\">        <span class=\"keyword\">var</span> fn = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().getFullYear() - <span class=\"keyword\">this</span>.birth; <span class=\"comment\">// thisobj</span></div><div class=\"line\">        <span class=\"keyword\">return</span> fn();</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;;</div><div class=\"line\">obj.getAge(); <span class=\"comment\">// 25</span></div></pre></td></tr></table></figure></p>\n<p>hack<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> that = <span class=\"keyword\">this</span>;</div></pre></td></tr></table></figure></p>\n<p><br>thiscall()apply()this<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> obj = &#123;</div><div class=\"line\">    <span class=\"attr\">birth</span>: <span class=\"number\">1990</span>,</div><div class=\"line\">    <span class=\"attr\">getAge</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">year</span>) </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">var</span> b = <span class=\"keyword\">this</span>.birth; <span class=\"comment\">// 1990</span></div><div class=\"line\">        <span class=\"keyword\">var</span> fn = <span class=\"function\">(<span class=\"params\">y</span>) =&gt;</span> y - <span class=\"keyword\">this</span>.birth; <span class=\"comment\">// this.birth1990</span></div><div class=\"line\">        <span class=\"keyword\">return</span> fn.call(&#123;<span class=\"attr\">birth</span>:<span class=\"number\">2000</span>&#125;, year);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;;</div><div class=\"line\">obj.getAge(<span class=\"number\">2015</span>); <span class=\"comment\">// 25</span></div></pre></td></tr></table></figure></p>\n<p>this<a href=\"https://github.com/zhengweikeng/blog/blob/master/posts/2016/%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0%E4%B8%ADthis%E7%9A%84%E7%94%A8%E6%B3%95.md\">this</a><br><a href=\"http://www.infoq.com/cn/articles/es6-in-depth-arrow-functions\">ES6 Arrow Functions</a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<ul>\n<li>new Number()new Boolean()new String()</li>\n<li>parseInt()parseFloat()number</li>\n<li>String()stringtoString()</li>\n<li>booleanif (myVar) {}</li>\n<li>typeofnumberbooleanstringfunctionundefined</li>\n<li>ArrayArray.isArray(arr)</li>\n<li>nullmyVar === null</li>\n<li>typeof window.myVar === undefined</li>\n<li>typeof myVar === undefined</li>\n</ul>\n<p>toString()nullundefinednullobject</p>\n<p>numbertoString()SyntaxError<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"number\">123.</span>toString(); <span class=\"comment\">// SyntaxError</span></div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"number\">123.</span>.toString(); <span class=\"comment\">// '123', </span></div><div class=\"line\">(<span class=\"number\">123</span>).toString(); <span class=\"comment\">// '123'</span></div></pre></td></tr></table></figure></p>\n<p><strong>Date</strong></p>\n<p>Date<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> d = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>(<span class=\"number\">2015</span>, <span class=\"number\">5</span>, <span class=\"number\">19</span>, <span class=\"number\">20</span>, <span class=\"number\">15</span>, <span class=\"number\">30</span>, <span class=\"number\">123</span>);</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>JavaScriptDate00=11=22=311=12</p>\n</blockquote>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> d = <span class=\"built_in\">Date</span>.parse(<span class=\"string\">'2015-06-24T19:49:22.875+08:00'</span>);</div><div class=\"line\">d; <span class=\"comment\">// 1435146562875</span></div></pre></td></tr></table></figure>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> d = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>(<span class=\"number\">1435146562875</span>);</div><div class=\"line\">d; <span class=\"comment\">// Wed Jun 24 2015 19:49:22 GMT+0800 (CST)</span></div><div class=\"line\">d.getMonth(); <span class=\"comment\">// 5</span></div></pre></td></tr></table></figure>\n<blockquote>\n<p>Date.parse()01~12DategetMonth()0~11</p>\n</blockquote>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">'use strict'</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> (<span class=\"built_in\">Date</span>.now) &#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"built_in\">Date</span>.now()); <span class=\"comment\">// IEnow()</span></div><div class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().getTime());</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p><strong>RegExp</strong></p>\n<p><a href=\"https://www.liaoxuefeng.com/wiki/001434446689867b27157e896e74d51a89c25cc8b43bdb3000/001434499503920bb7b42ff6627420da2ceae4babf6c4f2000\">-RegExp</a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>{  }JavaScript<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Student</span>(<span class=\"params\">name</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">this</span>.name = name;</div><div class=\"line\">    <span class=\"keyword\">this</span>.hello = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">        alert(<span class=\"string\">'Hello, '</span> + <span class=\"keyword\">this</span>.name + <span class=\"string\">'!'</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p></p>\n<p>JavaScriptnew<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> xiaoming = <span class=\"keyword\">new</span> Student(<span class=\"string\">''</span>);</div><div class=\"line\">xiaoming.name; <span class=\"comment\">// ''</span></div><div class=\"line\">xiaoming.hello(); <span class=\"comment\">// Hello, !</span></div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>newundefinednewthisthisreturn this;</p>\n</blockquote>\n<p>xiaoming<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">xiaoming ----&gt; Student.prototype ----&gt; <span class=\"built_in\">Object</span>.prototype ----&gt; <span class=\"literal\">null</span></div></pre></td></tr></table></figure></p>\n<p>xiaomingStudentxiaohongxiaojunxiaoming<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">xiaoming </div><div class=\"line\">xiaohong - Student.prototype ----&gt; <span class=\"built_in\">Object</span>.prototype ----&gt; <span class=\"literal\">null</span></div><div class=\"line\">xiaojun  </div></pre></td></tr></table></figure></p>\n<p>new Student()constructorStudent<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">xiaoming.constructor === Student.prototype.constructor; <span class=\"comment\">// true</span></div><div class=\"line\">Student.prototype.constructor === Student; <span class=\"comment\">// true</span></div><div class=\"line\"><span class=\"built_in\">Object</span>.getPrototypeOf(xiaoming) === Student.prototype; <span class=\"comment\">// true</span></div><div class=\"line\">xiaoming <span class=\"keyword\">instanceof</span> Student; <span class=\"comment\">// true</span></div></pre></td></tr></table></figure></p>\n<p></p>\n<p><img src=\"/images/blogimages/2017/js/js_function_construction.png\" alt=\"\"></p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">xiaoming.name; <span class=\"comment\">// ''</span></div><div class=\"line\">xiaohong.name; <span class=\"comment\">// ''</span></div><div class=\"line\">xiaoming.hello; <span class=\"comment\">// function: Student.hello()</span></div><div class=\"line\">xiaohong.hello; <span class=\"comment\">// function: Student.hello()</span></div><div class=\"line\">xiaoming.hello === xiaohong.hello; <span class=\"comment\">// false</span></div></pre></td></tr></table></figure></p>\n<p>xiaomingxiaohongname</p>\n<p>xiaomingxiaohonghello</p>\n<p>new Student()hello</p>\n<p>hellohelloxiaomingxiaohongStudent.prototype</p>\n<p><img src=\"/images/blogimages/2017/js/js_function_construction_1.png\" alt=\"\"></p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Student</span>(<span class=\"params\">name</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">this</span>.name = name;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">Student.prototype.hello = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    alert(<span class=\"string\">'Hello, '</span> + <span class=\"keyword\">this</span>.name + <span class=\"string\">'!'</span>);</div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure></p>\n<p><strong>new</strong></p>\n<p>new</p>\n<p>strictthis.name = namethisundefinedstrictthis.name = namethiswindownameundefined</p>\n<p>newjslintnew</p>\n<p>createStudent()new<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Student</span>(<span class=\"params\">props</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">this</span>.name = props.name || <span class=\"string\">''</span>; <span class=\"comment\">// ''</span></div><div class=\"line\">    <span class=\"keyword\">this</span>.grade = props.grade || <span class=\"number\">1</span>; <span class=\"comment\">// 1</span></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">Student.prototype.hello = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    alert(<span class=\"string\">'Hello, '</span> + <span class=\"keyword\">this</span>.name + <span class=\"string\">'!'</span>);</div><div class=\"line\">&#125;;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">createStudent</span>(<span class=\"params\">props</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Student(props || &#123;&#125;)</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>createStudent()new<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> xiaoming = createStudent(&#123;</div><div class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">''</span></div><div class=\"line\">&#125;);</div><div class=\"line\"></div><div class=\"line\">xiaoming.grade; <span class=\"comment\">// 1</span></div></pre></td></tr></table></figure></p>\n<p>ObjectJSONxiaoming</p>\n<p><strong></strong><br>ClassJavaC++ClassSubclass<br>JavaScriptClassClass</p>\n<p>StudentStudentPrimaryStudentPrimaryStudent<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">PrimaryStudent</span>(<span class=\"params\">props</span>) </span>&#123;</div><div class=\"line\">    <span class=\"comment\">// Studentthis:</span></div><div class=\"line\">    Student.call(<span class=\"keyword\">this</span>, props);</div><div class=\"line\">    <span class=\"keyword\">this</span>.grade = props.grade || <span class=\"number\">1</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>StudentStudentPrimaryStudent<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">new</span> PrimaryStudent() ----&gt; PrimaryStudent.prototype ----&gt; <span class=\"built_in\">Object</span>.prototype ----&gt; <span class=\"literal\">null</span></div></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">new</span> PrimaryStudent() ----&gt; PrimaryStudent.prototype ----&gt; Student.prototype ----&gt; <span class=\"built_in\">Object</span>.prototype ----&gt; <span class=\"literal\">null</span></div></pre></td></tr></table></figure></p>\n<p>Student.prototypeJSONF<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// PrimaryStudent:</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">PrimaryStudent</span>(<span class=\"params\">props</span>) </span>&#123;</div><div class=\"line\">    Student.call(<span class=\"keyword\">this</span>, props);</div><div class=\"line\">    <span class=\"keyword\">this</span>.grade = props.grade || <span class=\"number\">1</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// F:</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">F</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// FStudent.prototype:</span></div><div class=\"line\">F.prototype = Student.prototype;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// PrimaryStudentFFStudent.prototype:</span></div><div class=\"line\">PrimaryStudent.prototype = <span class=\"keyword\">new</span> F();</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// PrimaryStudentPrimaryStudent:</span></div><div class=\"line\">PrimaryStudent.prototype.constructor = PrimaryStudent;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// PrimaryStudentnew F()</span></div><div class=\"line\">PrimaryStudent.prototype.getGrade = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.grade;</div><div class=\"line\">&#125;;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// xiaoming:</span></div><div class=\"line\"><span class=\"keyword\">var</span> xiaoming = <span class=\"keyword\">new</span> PrimaryStudent(&#123;</div><div class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">''</span>,</div><div class=\"line\">    <span class=\"attr\">grade</span>: <span class=\"number\">2</span></div><div class=\"line\">&#125;);</div><div class=\"line\">xiaoming.name; <span class=\"comment\">// ''</span></div><div class=\"line\">xiaoming.grade; <span class=\"comment\">// 2</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// :</span></div><div class=\"line\">xiaoming.__proto__ === PrimaryStudent.prototype; <span class=\"comment\">// true</span></div><div class=\"line\">xiaoming.__proto__.__proto__ === Student.prototype; <span class=\"comment\">// true</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// :</span></div><div class=\"line\">xiaoming <span class=\"keyword\">instanceof</span> PrimaryStudent; <span class=\"comment\">// true</span></div><div class=\"line\">xiaoming <span class=\"keyword\">instanceof</span> Student; <span class=\"comment\">// true</span></div></pre></td></tr></table></figure></p>\n<p></p>\n<p><img src=\"/images/blogimages/2017/js/js_function_construction_2.png\" alt=\"\"></p>\n<blockquote>\n<p>Fnew F()Student</p>\n</blockquote>\n<p>inherits()F<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">inherits</span>(<span class=\"params\">Child, Parent</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> F = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;&#125;;</div><div class=\"line\">    F.prototype = Parent.prototype;</div><div class=\"line\">    Child.prototype = <span class=\"keyword\">new</span> F();</div><div class=\"line\">    Child.prototype.constructor = Child;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>inherits()<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Student</span>(<span class=\"params\">props</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">this</span>.name = props.name || <span class=\"string\">'Unnamed'</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">Student.prototype.hello = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    alert(<span class=\"string\">'Hello, '</span> + <span class=\"keyword\">this</span>.name + <span class=\"string\">'!'</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">PrimaryStudent</span>(<span class=\"params\">props</span>) </span>&#123;</div><div class=\"line\">    Student.call(<span class=\"keyword\">this</span>, props);</div><div class=\"line\">    <span class=\"keyword\">this</span>.grade = props.grade || <span class=\"number\">1</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// :</span></div><div class=\"line\">inherits(PrimaryStudent, Student);</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// PrimaryStudent:</span></div><div class=\"line\">PrimaryStudent.prototype.getGrade = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.grade;</div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure></p>\n<p>JavaScript</p>\n<ul>\n<li>call()this</li>\n<li>Finherits</li>\n<li></li>\n</ul>\n<h3 id=\"class\"><a href=\"#class\" class=\"headerlink\" title=\"class\"></a>class</h3><p>JavaScript</p>\n<p>classES6JavaScriptclass</p>\n<p>classStudent<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Student</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">constructor</span>(name) &#123;</div><div class=\"line\">        <span class=\"keyword\">this</span>.name = name;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    hello() &#123;</div><div class=\"line\">        alert(<span class=\"string\">'Hello, '</span> + <span class=\"keyword\">this</span>.name + <span class=\"string\">'!'</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>classconstructorhello()functionStudent.prototype.hello = function () {}</p>\n<p>Student<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> xiaoming = <span class=\"keyword\">new</span> Student(<span class=\"string\">''</span>);</div><div class=\"line\">xiaoming.hello();</div></pre></td></tr></table></figure></p>\n<p><strong>class</strong><br>extends<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">PrimaryStudent</span> <span class=\"keyword\">extends</span> <span class=\"title\">Student</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">constructor</span>(name, grade) &#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>(name); <span class=\"comment\">// super!</span></div><div class=\"line\">        <span class=\"keyword\">this</span>.grade = grade;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    myGrade() &#123;</div><div class=\"line\">        alert(<span class=\"string\">'I am at grade '</span> + <span class=\"keyword\">this</span>.grade);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>PrimaryStudentclassextendsStudentPrimaryStudentnamegrade<strong>super(name)</strong>name</p>\n<p>PrimaryStudentStudenthellomyGrade</p>\n<p>ES6classJavaScriptclassJavaScriptclass</p>\n<p>class</p>\n<p>ES6classclassprototype<a href=\"https://babeljs.io/\">Babel</a></p>\n<h3 id=\"DOM\"><a href=\"#DOM\" class=\"headerlink\" title=\"DOM\"></a>DOM</h3><p>HTMLDOMHTMLJavaScriptDOM</p>\n<p>DOMDOM</p>\n<ul>\n<li>DOMDOMHTML</li>\n<li>DOM</li>\n<li>DOMHTML</li>\n<li>HTMLDOM</li>\n</ul>\n<p>DOMDOM<strong>document.getElementById()</strong><strong>document.getElementsByTagName()</strong>CSS<strong>document.getElementsByClassName()</strong></p>\n<p>IDHTMLdocument.getElementById()DOMdocument.getElementsByTagName()document.getElementsByClassName()DOMDOM</p>\n<p><br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// ID'test'</span></div><div class=\"line\"><span class=\"keyword\">var</span> test = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'test'</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// ID'test-table'tr</span></div><div class=\"line\"><span class=\"keyword\">var</span> trs = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'test-table'</span>).getElementsByTagName(<span class=\"string\">'tr'</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// ID'test-div'classred</span></div><div class=\"line\"><span class=\"keyword\">var</span> reds = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'test-div'</span>).getElementsByClassName(<span class=\"string\">'red'</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// test:</span></div><div class=\"line\"><span class=\"keyword\">var</span> cs = test.children;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// test</span></div><div class=\"line\"><span class=\"keyword\">var</span> first = test.firstElementChild;</div><div class=\"line\"><span class=\"keyword\">var</span> last = test.lastElementChild;</div></pre></td></tr></table></figure></p>\n<p>querySelector()querySelectorAll()selector<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// querySelectorIDq1</span></div><div class=\"line\"><span class=\"keyword\">var</span> q1 = <span class=\"built_in\">document</span>.querySelector(<span class=\"string\">'#q1'</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// querySelectorAllq1</span></div><div class=\"line\"><span class=\"keyword\">var</span> ps = q1.querySelectorAll(<span class=\"string\">'div.highlighted &gt; p'</span>);</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>IE&lt;8querySelectorquerySelectorAllIE8</p>\n</blockquote>\n<p>DOMElementDOMNodeHTMLNodeElementCommentCDATA_SECTIONDocumentElementNodeNodeDocumentdocument</p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2017/10/22/JavaScript-knowledge/\">http://agehua.github.io/2017/10/22/JavaScript-knowledge/</a></p>"},{"layout":"post","title":"nodejs","keywords":"nodejs","banner":"http://obxk8w81b.bkt.clouddn.com/Daubigny%20s%20Garden%202.jpg","thumbnail":"http://obxk8w81b.bkt.clouddn.com/Daubigny%20s%20Garden%202.jpg","_content":"\n> [Node](http://www.nodebeginner.org/index-zh-cn.html)\n\n## Node\n\n Manuel Kiessling\n goddyzhao & GrayZhang & MondayChen\n\n\nNode.jsJavaScriptHello World\n\n\n### JavaScript\n\nJavaScriptJavaScriptJavaScriptJavaScript \n\nNode.jsJavaScript\n\n<!--more-->\n\nJavaScriptNode.jsGoogleV8GoogleChromeJavaScriptJavaScript\n\nNode.js\n\nNode.js\n\nNode.js,Node.js[](https://github.com/joyent/node/wiki/Installation)\n\n#### Hello World\n\nNode.jsHello World\n\nhelloworld.jsSTDOUTHello World\n\n~~~ JavaScript\nconsole.log(\"Hello World\");\n~~~\nNode.js\n~~~ JavaScript\nnode helloworld.js\n~~~\nHello World \n\n\n\n### **Node.jsweb**\n\n### \n\n\n\n\nhttp://domain/start \nhttp://domain/upload  \nGoogle\n\nNode.js\n\n### \n\n\n\nWebHTTP\nURLrequest handler\n\nPOST\nURL\n\nPHPApache HTTPmod_php5\nHTTPWebPHP\n\nNode.jsNode.jsHTTPWebWeb\n\nNode.js\n\n--HTTP\n\n### \n\n#### HTTP\n\nNode.jsNode.js\nNode.jsHTTP\n\n\n\nmain fileNode.js\n\nHTTP\n\nindex.jsserver.js\n\nserver.js\n\n~~~ JavaScript\nvar http = require(\"http\");\n\nhttp.createServer(function(request, response) {\n  response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n  response.write(\"Hello World\");\n  response.end();\n}).listen(8888);\n~~~\nHTTPNode.js\n\n~~~ JavaScript\nnode server.js\n~~~\nhttp://localhost:8888/ Hello World\n\nHTTP\n\n#### HTTP\n\nHTTP\n\nrequireNode.js http  http \n\nhttp createServer  listen HTTP\n\n http.createServer \n\n8888\n~~~ JavaScript\nvar http = require(\"http\");\n\nvar server = http.createServer();\nserver.listen(8888);\n~~~\n8888\n\nPHP createServer() \n\n createServer() JavaScript\n\n#### \n\n\n\n~~~ JavaScript\nfunction say(word) {\n  console.log(word);\n}\n\nfunction execute(someFunction, value) {\n  someFunction(value);\n}\n\nexecute(say, \"Hello\");\n~~~\n say execute say  say \n\n say execute  someFunction execute someFunction()  say \n\n say  execute  someFunction \n\n\n\n~~~ JavaScript\nfunction execute(someFunction, value) {\n  someFunction(value);\n}\n\n\nexecute(function(word){ console.log(word) }, \"Hello\");\n~~~\n execute  execute \n\n  \n\nJavaScriptJavaScript\n\n#### HTTP\n\nHTTP\n\n~~~ JavaScript\nvar http = require(\"http\");\n\nhttp.createServer(function(request, response) {\n  response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n  response.write(\"Hello World\");\n  response.end();\n}).listen(8888);\n~~~\n createServer \n\n\n\n~~~ JavaScript\nvar http = require(\"http\");\n\nfunction onRequest(request, response) {\n  response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n  response.write(\"Hello World\");\n  response.end();\n}\n\nhttp.createServer(onRequest).listen(8888);\n~~~\n\n\n#### \n\nNode.js\n\nFelix Geisendrfer[Understanding node.js](http://debuggable.com/posts/understanding-node-js:4bd98440-45e4-4a9a-8ef7-0f7ecbdd56cb)\n\nNode.jsNode.jsWeb based application\n\n http.createServer HTTP\n\n\n\nPHPApachePHP\n\nNode.js8888\n\nNode.js/JavaScript\n\n\n\n\n\n    \n\nFelix\n\nHTTP\n\n~~~ JavaScript\nvar http = require(\"http\");\n\nfunction onRequest(request, response) {\n  console.log(\"Request received.\");\n  response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n  response.write(\"Hello World\");\n  response.end();\n}\n\nhttp.createServer(onRequest).listen(8888);\n\nconsole.log(\"Server has started.\");\n~~~\n\n>  onRequest  console.log HTTP\n\nnode server.jsServer has started.http://localhost:8888/ Request received.\n\nJavaScript\n\n> Request received. http://localhost:8888/  http://localhost:8888/favicon.ico )\n\n#### \n\n onRequest() \n\n onRequest()  request  response \n\nHTTP\n\n response.writeHead() HTTP200HTTPcontent-type response.write() HTTPHello World\"\n\n response.end() \n\n request \n\n\n\nOK server.js HTTP index.js  server.js HTTP\n\nserver.jsNode.js index.js \n\n\n\n~~~ JavaScript\nvar http = require(\"http\");\n\n...\n\nhttp.createServer(...);\n~~~\nNode.jshttp\n\n http \n\n\n\n~~~ JavaScript\nvar foo = require(\"http\");\n\n...\n\nfoo.createServer(...);\n~~~\nNode.js\n\n server.js \n\n  \n\nHTTP\n\n start \n\n~~~ JavaScript\nvar http = require(\"http\");\n\nfunction start() {\n  function onRequest(request, response) {\n    console.log(\"Request received.\");\n    response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n    response.write(\"Hello World\");\n    response.end();\n  }\n\n  http.createServer(onRequest).listen(8888);\n  console.log(\"Server has started.\");\n}\n\nexports.start = start;\n~~~\n index.js HTTP server.js \n\n index.js \n\n~~~ JavaScript\nvar server = require(\"./server\");\n\nserver.start();\n~~~\nserver\n\n\n\n~~~ JavaScript\nnode index.js\n~~~\n\n\nHTTPURL\n\n onRequest() \n\nHTTP****\n\n#### \n\nURLGETPOST\n\nHTTPURLGET/POSTHTTP\n\nrequestonRequest()Node.JS**url****querystring**\n\n~~~ JavaScript\n                               url.parse(string).query\n                                           |\n           url.parse(string).pathname      |\n                       |                   |\n                       |                   |\n                     ------ -------------------\nhttp://localhost:8888/start?foo=bar&hello=world\n                                ---       -----\n                                 |          |\n                                 |          |\n              querystring(string)[\"foo\"]    |\n                                            |\n                         querystring(string)[\"hello\"]\n~~~\n\nquerystringPOST\n\nonRequest()URL\n\n~~~ JavaScript\nvar http = require(\"http\");\nvar url = require(\"url\");\n\nfunction start() {\n  function onRequest(request, response) {\n    var pathname = url.parse(request.url).pathname;\n    console.log(\"Request for \" + pathname + \" received.\");\n    response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n    response.write(\"Hello World\");\n    response.end();\n  }\n\n  http.createServer(onRequest).listen(8888);\n  console.log(\"Server has started.\");\n}\n\nexports.start = start;\n~~~\nURL--URL\n\n/start/upload\n\nrouter.js\n\n~~~ JavaScript\nfunction route(pathname) {\n  console.log(\"About to route a request for \" + pathname);\n}\n\nexports.route = route;\n~~~\n\n\n[Martin Fowlers](http://martinfowler.com/articles/injection.html)\n\nstart()\n\n~~~ JavaScript\nvar http = require(\"http\");\nvar url = require(\"url\");\n\nfunction start(route) {\n  function onRequest(request, response) {\n    var pathname = url.parse(request.url).pathname;\n    console.log(\"Request for \" + pathname + \" received.\");\n\n    route(pathname);\n\n    response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n    response.write(\"Hello World\");\n    response.end();\n  }\n\n  http.createServer(onRequest).listen(8888);\n  console.log(\"Server has started.\");\n}\n\nexports.start = start;\n~~~\nindex.js\n~~~ JavaScript\nvar server = require(\"./server\");\nvar router = require(\"./router\");\n\nserver.start(router.route);\n~~~\n\n\nnode index.jsURLHTTP\n\n~~~ JavaScript\nbash$ node index.js\nRequest for /foo received.\nAbout to route a request for /foo\n~~~\n/favicon.ico\n\n#### \n\n\n\nindexrouterroute\n\n\n\n    \n\n\n\n\n\nSteve Yegge[](http://steve-yegge.blogspot.jp/2006/03/execution-in-kingdom-of-nouns.html)\n\n#### \n\nHTTP\n\nURL/start/upload\n\n\n\n\n\n -- requestHandlers\n\n~~~ JavaScript\nfunction start() {\n  console.log(\"Request handler 'start' was called.\");\n}\n\nfunction upload() {\n  console.log(\"Request handler 'upload' was called.\");\n}\n\nexports.start = start;\nexports.upload = upload;\n~~~\n\n\nrequestHandlers\n\n\n\n2URLif request == x then call handler y\n\nURL**associative array** \n\nJavaScript -- JavaScript\n\nhttp://msdn.microsoft.com/en-us/magazine/cc163419.aspx \n\n> C++C#JavaScriptJavaScript/ -- JavaScript\n\nJavaScript/\n\nroute()\n\nindex.js\n\n~~~ JavaScript\nvar server = require(\"./server\");\nvar router = require(\"./router\");\nvar requestHandlers = require(\"./requestHandlers\");\n\nvar handle = {}\nhandle[\"/\"] = requestHandlers.start;\nhandle[\"/start\"] = requestHandlers.start;\nhandle[\"/upload\"] = requestHandlers.upload;\n\nserver.start(router.route, handle);\n~~~\nhandle\n\nURL\"/\"requestHandlers.start/start/start\n\nserver.js\n\n~~~ JavaScript\nvar http = require(\"http\");\nvar url = require(\"url\");\n\nfunction start(route, handle) {\n  function onRequest(request, response) {\n    var pathname = url.parse(request.url).pathname;\n    console.log(\"Request for \" + pathname + \" received.\");\n\n    route(handle, pathname);\n\n    response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n    response.write(\"Hello World\");\n    response.end();\n  }\n\n  http.createServer(onRequest).listen(8888);\n  console.log(\"Server has started.\");\n}\n\nexports.start = start;\n~~~\nstart()handlehandleroute()\n\nroute.jsroute()\n\n~~~ JavaScript\nfunction route(handle, pathname) {\n  console.log(\"About to route a request for \" + pathname);\n  if (typeof handle[pathname] === 'function') {\n    handle[pathname]();\n  } else {\n    console.log(\"No request handler found for \" + pathname);\n  }\n}\n\nexports.route = route;\n~~~\nhandle[pathname]();\n\nhttp://localhost:8888/start\n\n~~~ JavaScript\nServer has started.\nRequest for /start received.\nAbout to route a request for /start\nRequest handler 'start' was called.\n~~~\nhttp://localhost:8888/start\n\n~~~ JavaScript\nRequest for / received.\nAbout to route a request for /\nRequest handler 'start' was called.\n~~~\n\n#### \n\nHello World\n\nHello Worldserver.jsonRequest\n\nonRequest\n\n#### \n\nPHPRuby \n\nonRequestreturn()\n\n\n\nrequestHandler.js\n\n~~~ JavaScript\nfunction start() {\n  console.log(\"Request handler 'start' was called.\");\n  return \"Hello Start\";\n}\n\nfunction upload() {\n  console.log(\"Request handler 'upload' was called.\");\n  return \"Hello Upload\";\n}\n\nexports.start = start;\nexports.upload = upload;\n~~~\nrouter.js\n\n~~~ JavaScript\nfunction route(handle, pathname) {\n  console.log(\"About to route a request for \" + pathname);\n  if (typeof handle[pathname] === 'function') {\n    return handle[pathname]();\n  } else {\n    console.log(\"No request handler found for \" + pathname);\n    return \"404 Not found\";\n  }\n}\n\nexports.route = route;\n~~~\n\n\nserver.js\n\n~~~ JavaScript\nvar http = require(\"http\");\nvar url = require(\"url\");\n\nfunction start(route, handle) {\n  function onRequest(request, response) {\n    var pathname = url.parse(request.url).pathname;\n    console.log(\"Request for \" + pathname + \" received.\");\n\n    response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n    var content = route(handle, pathname)\n    response.write(content);\n    response.end();\n  }\n\n  http.createServer(onRequest).listen(8888);\n  console.log(\"Server has started.\");\n}\n\nexports.start = start;\n~~~\nhttp://localhost:8888/start, Hello Starthttp://localhost:8888/upload Hello Upload,http://localhost:8888/foo 404 Not found\n\n ****\n\n\n\n#### \n\n\n\n\n\nstart10Hello StartJavaScriptsleep()Hack\n\nrequestHandlers.js\n\n~~~ JavaScript\nfunction start() {\n  console.log(\"Request handler 'start' was called.\");\n\n  function sleep(milliSeconds) {\n    var startTime = new Date().getTime();\n    while (new Date().getTime() < startTime + milliSeconds);\n  }\n\n  sleep(10000);\n  return \"Hello Start\";\n}\n\nfunction upload() {\n  console.log(\"Request handler 'upload' was called.\");\n  return \"Hello Upload\";\n}\n\nexports.start = start;\nexports.upload = upload;\n~~~\nstart()Node.js10Hello Startupload()\n\n> 10\n\n\n\n http://localhost:8888/start \n\nhttp://localhost:8888/upload \n\n/start/upload\n\n /start URL10/upload URL10sleep()\n\nstart()****\n\nNodenode\n\n**Node.js**  Node.jsevent loop  \n\n10\n\nNode.jsprobablyExpensiveFunction()Node.jscallbackFunction()\n\nMixu[node.js](http://blog.mixu.net/2011/02/01/understanding-the-node-js-event-loop/)\n\n****\n\n\n\nstart\n\n~~~ JavaScript\nvar exec = require(\"child_process\").exec;\n\nfunction start() {\n  console.log(\"Request handler 'start' was called.\");\n  var content = \"empty\";\n\n  exec(\"ls -lah\", function (error, stdout, stderr) {\n    content = stdout;\n  });\n\n  return content;\n}\n\nfunction upload() {\n  console.log(\"Request handler 'upload' was called.\");\n  return \"Hello Upload\";\n}\n\nexports.start = start;\nexports.upload = upload;\n~~~\nNode.js**child_process****exec()**\n\nexec()Node.jsshellls -lah,/startURL\n\n contentemptyls -lahcontentcontent\n\nhttp://localhost:8888/start \n\nwebempty\n\nexec()shell\n\n> ls -lahfind /\n\n\n\n\n\nexec()\n\nexec()\n\n~~~ JavaScript\nfunction (error, stdout, stderr) {\n  content = stdout;\n}\n~~~\nexec()Node.js return content contentemptyexec()exec()\n\nls -lah  \n\n find /1ls -lahfind //start URLHTTP  exec()Node.jsexec()find /\n\n\n\n\n\n#### \n\n  \n\nNode.js ****\n\n ->  -> HTTP\n\n**** responseonRequest() \n\n\n\nserver.js\n\n~~~ JavaScript\nvar http = require(\"http\");\nvar url = require(\"url\");\n\nfunction start(route, handle) {\n  function onRequest(request, response) {\n    var pathname = url.parse(request.url).pathname;\n    console.log(\"Request for \" + pathname + \" received.\");\n\n    route(handle, pathname, response);\n  }\n\n  http.createServer(onRequest).listen(8888);\n  console.log(\"Server has started.\");\n}\n\nexports.start = start;\n~~~\nroute()responseroute()onRequest()responseroute()\n\nrouter.js:\n\n~~~ JavaScript\nfunction route(handle, pathname, response) {\n  console.log(\"About to route a request for \" + pathname);\n  if (typeof handle[pathname] === 'function') {\n    handle[pathname](response);\n  } else {\n    console.log(\"No request handler found for \" + pathname);\n    response.writeHead(404, {\"Content-Type\": \"text/plain\"});\n    response.write(\"404 Not found\");\n    response.end();\n  }\n}\n\nexports.route = route;\n~~~\nresponse\n\n404\n\nrequestHandler.js\n\n~~~ JavaScript\nvar exec = require(\"child_process\").exec;\n\nfunction start(response) {\n  console.log(\"Request handler 'start' was called.\");\n\n  exec(\"ls -lah\", function (error, stdout, stderr) {\n    response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n    response.write(stdout);\n    response.end();\n  });\n}\n\nfunction upload(response) {\n  console.log(\"Request handler 'upload' was called.\");\n  response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n  response.write(\"Hello Upload\");\n  response.end();\n}\n\nexports.start = start;\nexports.upload = upload;\n~~~\nresponse\n\nstartexec()uploadHello Worldresponse\n\nnode index.js\n\n/start/uploadrequestHandlers.js\n\n~~~ JavaScript\nvar exec = require(\"child_process\").exec;\n\nfunction start(response) {\n  console.log(\"Request handler 'start' was called.\");\n\n  exec(\"find /\",\n    { timeout: 10000, maxBuffer: 20000*1024 },\n    function (error, stdout, stderr) {\n      response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n      response.write(stdout);\n      response.end();\n    });\n}\n\nfunction upload(response) {\n  console.log(\"Request handler 'upload' was called.\");\n  response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n  response.write(\"Hello Upload\");\n  response.end();\n}\n\nexports.start = start;\nexports.upload = upload;\n~~~\nhttp://localhost:8888/start 10http://localhost:8888/upload /start\n\n#### \n\n\n\n \n\nJavaScript\n\n POSTNode.js\n\nNode.jsPOST\nNode.jsmultipart POST\n\n#### POST\n\ntextareaPOST\n\n/startrequestHandlers.js\n\n~~~ JavaScript\nfunction start(response) {\n  console.log(\"Request handler 'start' was called.\");\n\n  var body = '<html>'+\n    '<head>'+\n    '<meta http-equiv=\"Content-Type\" content=\"text/html; '+\n    'charset=UTF-8\" />'+\n    '</head>'+\n    '<body>'+\n    '<form action=\"/upload\" method=\"post\">'+\n    '<textarea name=\"text\" rows=\"20\" cols=\"60\"></textarea>'+\n    '<input type=\"submit\" value=\"Submit text\" />'+\n    '</form>'+\n    '</body>'+\n    '</html>';\n\n    response.writeHead(200, {\"Content-Type\": \"text/html\"});\n    response.write(body);\n    response.end();\n}\n\nfunction upload(response) {\n  console.log(\"Request handler 'upload' was called.\");\n  response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n  response.write(\"Hello Upload\");\n  response.end();\n}\n\nexports.start = start;\nexports.upload = upload;\n~~~\nWebby Awardshttp://localhost:8888/start \n\nMVCJavaScriptNode.js\n\n /uploadPOST\n\nPOST\n\nPOST  \n\nNode.jsPOST**data****end**\n\nNode.js request**listener** requestHTTPonRequest\n\n\n\n~~~ JavaScript\nrequest.addListener(\"data\", function(chunk) {\n  // called when a new chunk of data was received\n});\n\nrequest.addListener(\"end\", function() {\n  // called when all chunks of data have been received\n});\n~~~\n request  response request \n\nHTTPPOST\n\n dataenddataPOSTend\n\nserver.js\n\n~~~ JavaScript\nvar http = require(\"http\");\nvar url = require(\"url\");\n\nfunction start(route, handle) {\n  function onRequest(request, response) {\n    var postData = \"\";\n    var pathname = url.parse(request.url).pathname;\n    console.log(\"Request for \" + pathname + \" received.\");\n\n    request.setEncoding(\"utf8\");\n\n    request.addListener(\"data\", function(postDataChunk) {\n      postData += postDataChunk;\n      console.log(\"Received POST data chunk '\"+\n      postDataChunk + \"'.\");\n    });\n\n    request.addListener(\"end\", function() {\n      route(handle, pathname, response, postData);\n    });\n\n  }\n\n  http.createServer(onRequest).listen(8888);\n  console.log(\"Server has started.\");\n}\n\nexports.start = start;\n~~~\n UTF-8datapostData end****POST\n\n\n\ndata\n\n/uploadpostDatarouter.js\n\n~~~ JavaScript\nfunction route(handle, pathname, response, postData) {\n  console.log(\"About to route a request for \" + pathname);\n  if (typeof handle[pathname] === 'function') {\n    handle[pathname](response, postData);\n  } else {\n    console.log(\"No request handler found for \" + pathname);\n    response.writeHead(404, {\"Content-Type\": \"text/plain\"});\n    response.write(\"404 Not found\");\n    response.end();\n  }\n}\n\nexports.route = route;\n~~~\nrequestHandlers.jsupload\n\n~~~ JavaScript\nfunction start(response, postData) {\n  console.log(\"Request handler 'start' was called.\");\n\n  var body = '<html>'+\n    '<head>'+\n    '<meta http-equiv=\"Content-Type\" content=\"text/html; '+\n    'charset=UTF-8\" />'+\n    '</head>'+\n    '<body>'+\n    '<form action=\"/upload\" method=\"post\">'+\n    '<textarea name=\"text\" rows=\"20\" cols=\"60\"></textarea>'+\n    '<input type=\"submit\" value=\"Submit text\" />'+\n    '</form>'+\n    '</body>'+\n    '</html>';\n\n    response.writeHead(200, {\"Content-Type\": \"text/html\"});\n    response.write(body);\n    response.end();\n}\n\nfunction upload(response, postData) {\n  console.log(\"Request handler 'upload' was called.\");\n  response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n  response.write(\"You've sent: \" + postData);\n  response.end();\n}\n\nexports.start = start;\nexports.upload = upload;\n~~~\nPOST\n\n POSTtext\n\nquerystring\n\n~~~ JavaScript\nvar querystring = require(\"querystring\");\n\nfunction start(response, postData) {\n  console.log(\"Request handler 'start' was called.\");\n\n  var body = '<html>'+\n    '<head>'+\n    '<meta http-equiv=\"Content-Type\" content=\"text/html; '+\n    'charset=UTF-8\" />'+\n    '</head>'+\n    '<body>'+\n    '<form action=\"/upload\" method=\"post\">'+\n    '<textarea name=\"text\" rows=\"20\" cols=\"60\"></textarea>'+\n    '<input type=\"submit\" value=\"Submit text\" />'+\n    '</form>'+\n    '</body>'+\n    '</html>';\n\n    response.writeHead(200, {\"Content-Type\": \"text/html\"});\n    response.write(body);\n    response.end();\n}\n\nfunction upload(response, postData) {\n  console.log(\"Request handler 'upload' was called.\");\n  response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n  response.write(\"You've sent the text: \"+\n  querystring.parse(postData).text);\n  response.end();\n}\n\nexports.start = start;\nexports.upload = upload;\n~~~\nPOST\n\n#### \n\n\n\n90IPO Node.js\n\nFelix Geisendrfer**node-formidable** POST  \n\nNode.jsNPMNode.js\n\n~~~ JavaScript\nnpm install formidable\n~~~\n\n\n~~~ JavaScript\nnpm info build Success: formidable@1.0.9\nnpm ok\n~~~\n\n\nformidablerequire\n\n~~~ JavaScript\nvar formidable = require(\"formidable\");\n~~~\nHTTP POSTNode.jsIncomingFormrequest\n\nnode-formidable\n\n~~~ JavaScript\nvar formidable = require('formidable'),\n    http = require('http'),\n    util = require('util');\n\nhttp.createServer(function(req, res) {\n  if (req.url == '/upload' && req.method.toLowerCase() == 'post') {\n    // parse a file upload\n    var form = new formidable.IncomingForm();\n    form.parse(req, function(err, fields, files) {\n      res.writeHead(200, {'content-type': 'text/plain'});\n      res.write('received upload:\\n\\n');\n      res.end(util.inspect({fields: fields, files: files}));\n    });\n    return;\n  }\n\n  // show a file upload form\n  res.writeHead(200, {'content-type': 'text/html'});\n  res.end(\n    '<form action=\"/upload\" enctype=\"multipart/form-data\" '+\n    'method=\"post\">'+\n    '<input type=\"text\" name=\"title\"><br>'+\n    '<input type=\"file\" name=\"upload\" multiple=\"multiple\"><br>'+\n    '<input type=\"submit\" value=\"Upload\">'+\n    '</form>'\n  );\n}).listen(8888);\n~~~\nnodeform.parsefiles\n\n~~~ JavaScript\nreceived upload:\n\n{ fields: { title: 'Hello World' },\n  files:\n   { upload:\n      { size: 1558,\n        path: '/tmp/1c747974a27a6292743669e91f29350b',\n        name: 'us-flag.png',\n        type: 'image/png',\n        lastModifiedDate: Tue, 21 Jun 2011 07:02:41 GMT,\n        _writeStream: [Object],\n        length: [Getter],\n        filename: [Getter],\n        mime: [Getter] } } }\n~~~\n/tmp\n\n \n\n**fs**\n\n/showURL/tmp/test.png\n\nrequestHandlers.js\n\n~~~ JavaScript\nvar querystring = require(\"querystring\"),\n    fs = require(\"fs\");\n\nfunction start(response, postData) {\n  console.log(\"Request handler 'start' was called.\");\n\n  var body = '<html>'+\n    '<head>'+\n    '<meta http-equiv=\"Content-Type\" '+\n    'content=\"text/html; charset=UTF-8\" />'+\n    '</head>'+\n    '<body>'+\n    '<form action=\"/upload\" method=\"post\">'+\n    '<textarea name=\"text\" rows=\"20\" cols=\"60\"></textarea>'+\n    '<input type=\"submit\" value=\"Submit text\" />'+\n    '</form>'+\n    '</body>'+\n    '</html>';\n\n    response.writeHead(200, {\"Content-Type\": \"text/html\"});\n    response.write(body);\n    response.end();\n}\n\nfunction upload(response, postData) {\n  console.log(\"Request handler 'upload' was called.\");\n  response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n  response.write(\"You've sent the text: \"+\n  querystring.parse(postData).text);\n  response.end();\n}\n\nfunction show(response, postData) {\n  console.log(\"Request handler 'show' was called.\");\n  fs.readFile(\"/tmp/test.png\", \"binary\", function(error, file) {\n    if(error) {\n      response.writeHead(500, {\"Content-Type\": \"text/plain\"});\n      response.write(error + \"\\n\");\n      response.end();\n    } else {\n      response.writeHead(200, {\"Content-Type\": \"image/png\"});\n      response.write(file, \"binary\");\n      response.end();\n    }\n  });\n}\n\nexports.start = start;\nexports.upload = upload;\nexports.show = show;\n~~~\nindex.js\n\n~~~ JavaScript\nvar server = require(\"./server\");\nvar router = require(\"./router\");\nvar requestHandlers = require(\"./requestHandlers\");\n\nvar handle = {}\nhandle[\"/\"] = requestHandlers.start;\nhandle[\"/start\"] = requestHandlers.start;\nhandle[\"/upload\"] = requestHandlers.upload;\nhandle[\"/show\"] = requestHandlers.show;\n\nserver.start(router.route, handle);\n~~~\nhttp://localhost:8888/show/tmp/test.png\n\n\n\n- /start\n- node-formidableupload/tmp/test.png\n- /uploadURLHTML\n\nHTMLmultipart/form-dataUpload file requestHandler.js\n\n~~~ JavaScript\nvar querystring = require(\"querystring\"),\n    fs = require(\"fs\");\n\nfunction start(response, postData) {\n  console.log(\"Request handler 'start' was called.\");\n\n  var body = '<html>'+\n    '<head>'+\n    '<meta http-equiv=\"Content-Type\" '+\n    'content=\"text/html; charset=UTF-8\" />'+\n    '</head>'+\n    '<body>'+\n    '<form action=\"/upload\" enctype=\"multipart/form-data\" '+\n    'method=\"post\">'+\n    '<input type=\"file\" name=\"upload\">'+\n    '<input type=\"submit\" value=\"Upload file\" />'+\n    '</form>'+\n    '</body>'+\n    '</html>';\n\n    response.writeHead(200, {\"Content-Type\": \"text/html\"});\n    response.write(body);\n    response.end();\n}\n\nfunction upload(response, postData) {\n  console.log(\"Request handler 'upload' was called.\");\n  response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n  response.write(\"You've sent the text: \"+\n  querystring.parse(postData).text);\n  response.end();\n}\n\nfunction show(response, postData) {\n  console.log(\"Request handler 'show' was called.\");\n  fs.readFile(\"/tmp/test.png\", \"binary\", function(error, file) {\n    if(error) {\n      response.writeHead(500, {\"Content-Type\": \"text/plain\"});\n      response.write(error + \"\\n\");\n      response.end();\n    } else {\n      response.writeHead(200, {\"Content-Type\": \"image/png\"});\n      response.write(file, \"binary\");\n      response.end();\n    }\n  });\n}\n\nexports.start = start;\nexports.upload = upload;\nexports.show = show;\n~~~\n uploadrequestnode-formidableform.parse\n\nresponsepostDatarequest \n\npostData   requestform.parseNode.js\n\nserver.js  postDatarequest.setEncoding node-formidablerequest\n\n~~~ JavaScript\nvar http = require(\"http\");\nvar url = require(\"url\");\n\nfunction start(route, handle) {\n  function onRequest(request, response) {\n    var pathname = url.parse(request.url).pathname;\n    console.log(\"Request for \" + pathname + \" received.\");\n    route(handle, pathname, response, request);\n  }\n\n  http.createServer(onRequest).listen(8888);\n  console.log(\"Server has started.\");\n}\n\nexports.start = start;\n~~~\n router.js  postDatarequest\n\n~~~ JavaScript\nfunction route(handle, pathname, response, request) {\n  console.log(\"About to route a request for \" + pathname);\n  if (typeof handle[pathname] === 'function') {\n    handle[pathname](response, request);\n  } else {\n    console.log(\"No request handler found for \" + pathname);\n    response.writeHead(404, {\"Content-Type\": \"text/html\"});\n    response.write(\"404 Not found\");\n    response.end();\n  }\n}\n\nexports.route = route;\n~~~\nrequestuploadnode-formidable/tmp/tmp/test.png PNG\n\n**fs.renameSync(path1,path2)**  \n\nrequestHandlers.js\n\n~~~ JavaScript\nvar querystring = require(\"querystring\"),\n    fs = require(\"fs\"),\n    formidable = require(\"formidable\");\n\nfunction start(response) {\n  console.log(\"Request handler 'start' was called.\");\n\n  var body = '<html>'+\n    '<head>'+\n    '<meta http-equiv=\"Content-Type\" content=\"text/html; '+\n    'charset=UTF-8\" />'+\n    '</head>'+\n    '<body>'+\n    '<form action=\"/upload\" enctype=\"multipart/form-data\" '+\n    'method=\"post\">'+\n    '<input type=\"file\" name=\"upload\" multiple=\"multiple\">'+\n    '<input type=\"submit\" value=\"Upload file\" />'+\n    '</form>'+\n    '</body>'+\n    '</html>';\n\n    response.writeHead(200, {\"Content-Type\": \"text/html\"});\n    response.write(body);\n    response.end();\n}\n\nfunction upload(response, request) {\n  console.log(\"Request handler 'upload' was called.\");\n\n  var form = new formidable.IncomingForm();\n  console.log(\"about to parse\");\n  form.parse(request, function(error, fields, files) {\n    console.log(\"parsing done\");\n    fs.renameSync(files.upload.path, \"/tmp/test.png\");\n    response.writeHead(200, {\"Content-Type\": \"text/html\"});\n    response.write(\"received image:<br/>\");\n    response.write(\"<img src='/show' />\");\n    response.end();\n  });\n}\n\nfunction show(response) {\n  console.log(\"Request handler 'show' was called.\");\n  fs.readFile(\"/tmp/test.png\", \"binary\", function(error, file) {\n    if(error) {\n      response.writeHead(500, {\"Content-Type\": \"text/plain\"});\n      response.write(error + \"\\n\");\n      response.end();\n    } else {\n      response.writeHead(200, {\"Content-Type\": \"image/png\"});\n      response.write(file, \"binary\");\n      response.end();\n    }\n  });\n}\n\nexports.start = start;\nexports.upload = upload;\nexports.show = show;\n~~~\n\n\n### \n\nNode.jsweb JavaScript\n\n Node.jsGET\n\n  \n","source":"_posts/2016-12-03-nodejs-learning-getting-started.md","raw":"---\nlayout: post\ntitle:  nodejs\ncategory: read\ntags:\n  - read\n  - nodejs\nkeywords: nodejs\nbanner: http://obxk8w81b.bkt.clouddn.com/Daubigny%20s%20Garden%202.jpg\nthumbnail: http://obxk8w81b.bkt.clouddn.com/Daubigny%20s%20Garden%202.jpg\n---\n\n> [Node](http://www.nodebeginner.org/index-zh-cn.html)\n\n## Node\n\n Manuel Kiessling\n goddyzhao & GrayZhang & MondayChen\n\n\nNode.jsJavaScriptHello World\n\n\n### JavaScript\n\nJavaScriptJavaScriptJavaScriptJavaScript \n\nNode.jsJavaScript\n\n<!--more-->\n\nJavaScriptNode.jsGoogleV8GoogleChromeJavaScriptJavaScript\n\nNode.js\n\nNode.js\n\nNode.js,Node.js[](https://github.com/joyent/node/wiki/Installation)\n\n#### Hello World\n\nNode.jsHello World\n\nhelloworld.jsSTDOUTHello World\n\n~~~ JavaScript\nconsole.log(\"Hello World\");\n~~~\nNode.js\n~~~ JavaScript\nnode helloworld.js\n~~~\nHello World \n\n\n\n### **Node.jsweb**\n\n### \n\n\n\n\nhttp://domain/start \nhttp://domain/upload  \nGoogle\n\nNode.js\n\n### \n\n\n\nWebHTTP\nURLrequest handler\n\nPOST\nURL\n\nPHPApache HTTPmod_php5\nHTTPWebPHP\n\nNode.jsNode.jsHTTPWebWeb\n\nNode.js\n\n--HTTP\n\n### \n\n#### HTTP\n\nNode.jsNode.js\nNode.jsHTTP\n\n\n\nmain fileNode.js\n\nHTTP\n\nindex.jsserver.js\n\nserver.js\n\n~~~ JavaScript\nvar http = require(\"http\");\n\nhttp.createServer(function(request, response) {\n  response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n  response.write(\"Hello World\");\n  response.end();\n}).listen(8888);\n~~~\nHTTPNode.js\n\n~~~ JavaScript\nnode server.js\n~~~\nhttp://localhost:8888/ Hello World\n\nHTTP\n\n#### HTTP\n\nHTTP\n\nrequireNode.js http  http \n\nhttp createServer  listen HTTP\n\n http.createServer \n\n8888\n~~~ JavaScript\nvar http = require(\"http\");\n\nvar server = http.createServer();\nserver.listen(8888);\n~~~\n8888\n\nPHP createServer() \n\n createServer() JavaScript\n\n#### \n\n\n\n~~~ JavaScript\nfunction say(word) {\n  console.log(word);\n}\n\nfunction execute(someFunction, value) {\n  someFunction(value);\n}\n\nexecute(say, \"Hello\");\n~~~\n say execute say  say \n\n say execute  someFunction execute someFunction()  say \n\n say  execute  someFunction \n\n\n\n~~~ JavaScript\nfunction execute(someFunction, value) {\n  someFunction(value);\n}\n\n\nexecute(function(word){ console.log(word) }, \"Hello\");\n~~~\n execute  execute \n\n  \n\nJavaScriptJavaScript\n\n#### HTTP\n\nHTTP\n\n~~~ JavaScript\nvar http = require(\"http\");\n\nhttp.createServer(function(request, response) {\n  response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n  response.write(\"Hello World\");\n  response.end();\n}).listen(8888);\n~~~\n createServer \n\n\n\n~~~ JavaScript\nvar http = require(\"http\");\n\nfunction onRequest(request, response) {\n  response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n  response.write(\"Hello World\");\n  response.end();\n}\n\nhttp.createServer(onRequest).listen(8888);\n~~~\n\n\n#### \n\nNode.js\n\nFelix Geisendrfer[Understanding node.js](http://debuggable.com/posts/understanding-node-js:4bd98440-45e4-4a9a-8ef7-0f7ecbdd56cb)\n\nNode.jsNode.jsWeb based application\n\n http.createServer HTTP\n\n\n\nPHPApachePHP\n\nNode.js8888\n\nNode.js/JavaScript\n\n\n\n\n\n    \n\nFelix\n\nHTTP\n\n~~~ JavaScript\nvar http = require(\"http\");\n\nfunction onRequest(request, response) {\n  console.log(\"Request received.\");\n  response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n  response.write(\"Hello World\");\n  response.end();\n}\n\nhttp.createServer(onRequest).listen(8888);\n\nconsole.log(\"Server has started.\");\n~~~\n\n>  onRequest  console.log HTTP\n\nnode server.jsServer has started.http://localhost:8888/ Request received.\n\nJavaScript\n\n> Request received. http://localhost:8888/  http://localhost:8888/favicon.ico )\n\n#### \n\n onRequest() \n\n onRequest()  request  response \n\nHTTP\n\n response.writeHead() HTTP200HTTPcontent-type response.write() HTTPHello World\"\n\n response.end() \n\n request \n\n\n\nOK server.js HTTP index.js  server.js HTTP\n\nserver.jsNode.js index.js \n\n\n\n~~~ JavaScript\nvar http = require(\"http\");\n\n...\n\nhttp.createServer(...);\n~~~\nNode.jshttp\n\n http \n\n\n\n~~~ JavaScript\nvar foo = require(\"http\");\n\n...\n\nfoo.createServer(...);\n~~~\nNode.js\n\n server.js \n\n  \n\nHTTP\n\n start \n\n~~~ JavaScript\nvar http = require(\"http\");\n\nfunction start() {\n  function onRequest(request, response) {\n    console.log(\"Request received.\");\n    response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n    response.write(\"Hello World\");\n    response.end();\n  }\n\n  http.createServer(onRequest).listen(8888);\n  console.log(\"Server has started.\");\n}\n\nexports.start = start;\n~~~\n index.js HTTP server.js \n\n index.js \n\n~~~ JavaScript\nvar server = require(\"./server\");\n\nserver.start();\n~~~\nserver\n\n\n\n~~~ JavaScript\nnode index.js\n~~~\n\n\nHTTPURL\n\n onRequest() \n\nHTTP****\n\n#### \n\nURLGETPOST\n\nHTTPURLGET/POSTHTTP\n\nrequestonRequest()Node.JS**url****querystring**\n\n~~~ JavaScript\n                               url.parse(string).query\n                                           |\n           url.parse(string).pathname      |\n                       |                   |\n                       |                   |\n                     ------ -------------------\nhttp://localhost:8888/start?foo=bar&hello=world\n                                ---       -----\n                                 |          |\n                                 |          |\n              querystring(string)[\"foo\"]    |\n                                            |\n                         querystring(string)[\"hello\"]\n~~~\n\nquerystringPOST\n\nonRequest()URL\n\n~~~ JavaScript\nvar http = require(\"http\");\nvar url = require(\"url\");\n\nfunction start() {\n  function onRequest(request, response) {\n    var pathname = url.parse(request.url).pathname;\n    console.log(\"Request for \" + pathname + \" received.\");\n    response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n    response.write(\"Hello World\");\n    response.end();\n  }\n\n  http.createServer(onRequest).listen(8888);\n  console.log(\"Server has started.\");\n}\n\nexports.start = start;\n~~~\nURL--URL\n\n/start/upload\n\nrouter.js\n\n~~~ JavaScript\nfunction route(pathname) {\n  console.log(\"About to route a request for \" + pathname);\n}\n\nexports.route = route;\n~~~\n\n\n[Martin Fowlers](http://martinfowler.com/articles/injection.html)\n\nstart()\n\n~~~ JavaScript\nvar http = require(\"http\");\nvar url = require(\"url\");\n\nfunction start(route) {\n  function onRequest(request, response) {\n    var pathname = url.parse(request.url).pathname;\n    console.log(\"Request for \" + pathname + \" received.\");\n\n    route(pathname);\n\n    response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n    response.write(\"Hello World\");\n    response.end();\n  }\n\n  http.createServer(onRequest).listen(8888);\n  console.log(\"Server has started.\");\n}\n\nexports.start = start;\n~~~\nindex.js\n~~~ JavaScript\nvar server = require(\"./server\");\nvar router = require(\"./router\");\n\nserver.start(router.route);\n~~~\n\n\nnode index.jsURLHTTP\n\n~~~ JavaScript\nbash$ node index.js\nRequest for /foo received.\nAbout to route a request for /foo\n~~~\n/favicon.ico\n\n#### \n\n\n\nindexrouterroute\n\n\n\n    \n\n\n\n\n\nSteve Yegge[](http://steve-yegge.blogspot.jp/2006/03/execution-in-kingdom-of-nouns.html)\n\n#### \n\nHTTP\n\nURL/start/upload\n\n\n\n\n\n -- requestHandlers\n\n~~~ JavaScript\nfunction start() {\n  console.log(\"Request handler 'start' was called.\");\n}\n\nfunction upload() {\n  console.log(\"Request handler 'upload' was called.\");\n}\n\nexports.start = start;\nexports.upload = upload;\n~~~\n\n\nrequestHandlers\n\n\n\n2URLif request == x then call handler y\n\nURL**associative array** \n\nJavaScript -- JavaScript\n\nhttp://msdn.microsoft.com/en-us/magazine/cc163419.aspx \n\n> C++C#JavaScriptJavaScript/ -- JavaScript\n\nJavaScript/\n\nroute()\n\nindex.js\n\n~~~ JavaScript\nvar server = require(\"./server\");\nvar router = require(\"./router\");\nvar requestHandlers = require(\"./requestHandlers\");\n\nvar handle = {}\nhandle[\"/\"] = requestHandlers.start;\nhandle[\"/start\"] = requestHandlers.start;\nhandle[\"/upload\"] = requestHandlers.upload;\n\nserver.start(router.route, handle);\n~~~\nhandle\n\nURL\"/\"requestHandlers.start/start/start\n\nserver.js\n\n~~~ JavaScript\nvar http = require(\"http\");\nvar url = require(\"url\");\n\nfunction start(route, handle) {\n  function onRequest(request, response) {\n    var pathname = url.parse(request.url).pathname;\n    console.log(\"Request for \" + pathname + \" received.\");\n\n    route(handle, pathname);\n\n    response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n    response.write(\"Hello World\");\n    response.end();\n  }\n\n  http.createServer(onRequest).listen(8888);\n  console.log(\"Server has started.\");\n}\n\nexports.start = start;\n~~~\nstart()handlehandleroute()\n\nroute.jsroute()\n\n~~~ JavaScript\nfunction route(handle, pathname) {\n  console.log(\"About to route a request for \" + pathname);\n  if (typeof handle[pathname] === 'function') {\n    handle[pathname]();\n  } else {\n    console.log(\"No request handler found for \" + pathname);\n  }\n}\n\nexports.route = route;\n~~~\nhandle[pathname]();\n\nhttp://localhost:8888/start\n\n~~~ JavaScript\nServer has started.\nRequest for /start received.\nAbout to route a request for /start\nRequest handler 'start' was called.\n~~~\nhttp://localhost:8888/start\n\n~~~ JavaScript\nRequest for / received.\nAbout to route a request for /\nRequest handler 'start' was called.\n~~~\n\n#### \n\nHello World\n\nHello Worldserver.jsonRequest\n\nonRequest\n\n#### \n\nPHPRuby \n\nonRequestreturn()\n\n\n\nrequestHandler.js\n\n~~~ JavaScript\nfunction start() {\n  console.log(\"Request handler 'start' was called.\");\n  return \"Hello Start\";\n}\n\nfunction upload() {\n  console.log(\"Request handler 'upload' was called.\");\n  return \"Hello Upload\";\n}\n\nexports.start = start;\nexports.upload = upload;\n~~~\nrouter.js\n\n~~~ JavaScript\nfunction route(handle, pathname) {\n  console.log(\"About to route a request for \" + pathname);\n  if (typeof handle[pathname] === 'function') {\n    return handle[pathname]();\n  } else {\n    console.log(\"No request handler found for \" + pathname);\n    return \"404 Not found\";\n  }\n}\n\nexports.route = route;\n~~~\n\n\nserver.js\n\n~~~ JavaScript\nvar http = require(\"http\");\nvar url = require(\"url\");\n\nfunction start(route, handle) {\n  function onRequest(request, response) {\n    var pathname = url.parse(request.url).pathname;\n    console.log(\"Request for \" + pathname + \" received.\");\n\n    response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n    var content = route(handle, pathname)\n    response.write(content);\n    response.end();\n  }\n\n  http.createServer(onRequest).listen(8888);\n  console.log(\"Server has started.\");\n}\n\nexports.start = start;\n~~~\nhttp://localhost:8888/start, Hello Starthttp://localhost:8888/upload Hello Upload,http://localhost:8888/foo 404 Not found\n\n ****\n\n\n\n#### \n\n\n\n\n\nstart10Hello StartJavaScriptsleep()Hack\n\nrequestHandlers.js\n\n~~~ JavaScript\nfunction start() {\n  console.log(\"Request handler 'start' was called.\");\n\n  function sleep(milliSeconds) {\n    var startTime = new Date().getTime();\n    while (new Date().getTime() < startTime + milliSeconds);\n  }\n\n  sleep(10000);\n  return \"Hello Start\";\n}\n\nfunction upload() {\n  console.log(\"Request handler 'upload' was called.\");\n  return \"Hello Upload\";\n}\n\nexports.start = start;\nexports.upload = upload;\n~~~\nstart()Node.js10Hello Startupload()\n\n> 10\n\n\n\n http://localhost:8888/start \n\nhttp://localhost:8888/upload \n\n/start/upload\n\n /start URL10/upload URL10sleep()\n\nstart()****\n\nNodenode\n\n**Node.js**  Node.jsevent loop  \n\n10\n\nNode.jsprobablyExpensiveFunction()Node.jscallbackFunction()\n\nMixu[node.js](http://blog.mixu.net/2011/02/01/understanding-the-node-js-event-loop/)\n\n****\n\n\n\nstart\n\n~~~ JavaScript\nvar exec = require(\"child_process\").exec;\n\nfunction start() {\n  console.log(\"Request handler 'start' was called.\");\n  var content = \"empty\";\n\n  exec(\"ls -lah\", function (error, stdout, stderr) {\n    content = stdout;\n  });\n\n  return content;\n}\n\nfunction upload() {\n  console.log(\"Request handler 'upload' was called.\");\n  return \"Hello Upload\";\n}\n\nexports.start = start;\nexports.upload = upload;\n~~~\nNode.js**child_process****exec()**\n\nexec()Node.jsshellls -lah,/startURL\n\n contentemptyls -lahcontentcontent\n\nhttp://localhost:8888/start \n\nwebempty\n\nexec()shell\n\n> ls -lahfind /\n\n\n\n\n\nexec()\n\nexec()\n\n~~~ JavaScript\nfunction (error, stdout, stderr) {\n  content = stdout;\n}\n~~~\nexec()Node.js return content contentemptyexec()exec()\n\nls -lah  \n\n find /1ls -lahfind //start URLHTTP  exec()Node.jsexec()find /\n\n\n\n\n\n#### \n\n  \n\nNode.js ****\n\n ->  -> HTTP\n\n**** responseonRequest() \n\n\n\nserver.js\n\n~~~ JavaScript\nvar http = require(\"http\");\nvar url = require(\"url\");\n\nfunction start(route, handle) {\n  function onRequest(request, response) {\n    var pathname = url.parse(request.url).pathname;\n    console.log(\"Request for \" + pathname + \" received.\");\n\n    route(handle, pathname, response);\n  }\n\n  http.createServer(onRequest).listen(8888);\n  console.log(\"Server has started.\");\n}\n\nexports.start = start;\n~~~\nroute()responseroute()onRequest()responseroute()\n\nrouter.js:\n\n~~~ JavaScript\nfunction route(handle, pathname, response) {\n  console.log(\"About to route a request for \" + pathname);\n  if (typeof handle[pathname] === 'function') {\n    handle[pathname](response);\n  } else {\n    console.log(\"No request handler found for \" + pathname);\n    response.writeHead(404, {\"Content-Type\": \"text/plain\"});\n    response.write(\"404 Not found\");\n    response.end();\n  }\n}\n\nexports.route = route;\n~~~\nresponse\n\n404\n\nrequestHandler.js\n\n~~~ JavaScript\nvar exec = require(\"child_process\").exec;\n\nfunction start(response) {\n  console.log(\"Request handler 'start' was called.\");\n\n  exec(\"ls -lah\", function (error, stdout, stderr) {\n    response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n    response.write(stdout);\n    response.end();\n  });\n}\n\nfunction upload(response) {\n  console.log(\"Request handler 'upload' was called.\");\n  response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n  response.write(\"Hello Upload\");\n  response.end();\n}\n\nexports.start = start;\nexports.upload = upload;\n~~~\nresponse\n\nstartexec()uploadHello Worldresponse\n\nnode index.js\n\n/start/uploadrequestHandlers.js\n\n~~~ JavaScript\nvar exec = require(\"child_process\").exec;\n\nfunction start(response) {\n  console.log(\"Request handler 'start' was called.\");\n\n  exec(\"find /\",\n    { timeout: 10000, maxBuffer: 20000*1024 },\n    function (error, stdout, stderr) {\n      response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n      response.write(stdout);\n      response.end();\n    });\n}\n\nfunction upload(response) {\n  console.log(\"Request handler 'upload' was called.\");\n  response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n  response.write(\"Hello Upload\");\n  response.end();\n}\n\nexports.start = start;\nexports.upload = upload;\n~~~\nhttp://localhost:8888/start 10http://localhost:8888/upload /start\n\n#### \n\n\n\n \n\nJavaScript\n\n POSTNode.js\n\nNode.jsPOST\nNode.jsmultipart POST\n\n#### POST\n\ntextareaPOST\n\n/startrequestHandlers.js\n\n~~~ JavaScript\nfunction start(response) {\n  console.log(\"Request handler 'start' was called.\");\n\n  var body = '<html>'+\n    '<head>'+\n    '<meta http-equiv=\"Content-Type\" content=\"text/html; '+\n    'charset=UTF-8\" />'+\n    '</head>'+\n    '<body>'+\n    '<form action=\"/upload\" method=\"post\">'+\n    '<textarea name=\"text\" rows=\"20\" cols=\"60\"></textarea>'+\n    '<input type=\"submit\" value=\"Submit text\" />'+\n    '</form>'+\n    '</body>'+\n    '</html>';\n\n    response.writeHead(200, {\"Content-Type\": \"text/html\"});\n    response.write(body);\n    response.end();\n}\n\nfunction upload(response) {\n  console.log(\"Request handler 'upload' was called.\");\n  response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n  response.write(\"Hello Upload\");\n  response.end();\n}\n\nexports.start = start;\nexports.upload = upload;\n~~~\nWebby Awardshttp://localhost:8888/start \n\nMVCJavaScriptNode.js\n\n /uploadPOST\n\nPOST\n\nPOST  \n\nNode.jsPOST**data****end**\n\nNode.js request**listener** requestHTTPonRequest\n\n\n\n~~~ JavaScript\nrequest.addListener(\"data\", function(chunk) {\n  // called when a new chunk of data was received\n});\n\nrequest.addListener(\"end\", function() {\n  // called when all chunks of data have been received\n});\n~~~\n request  response request \n\nHTTPPOST\n\n dataenddataPOSTend\n\nserver.js\n\n~~~ JavaScript\nvar http = require(\"http\");\nvar url = require(\"url\");\n\nfunction start(route, handle) {\n  function onRequest(request, response) {\n    var postData = \"\";\n    var pathname = url.parse(request.url).pathname;\n    console.log(\"Request for \" + pathname + \" received.\");\n\n    request.setEncoding(\"utf8\");\n\n    request.addListener(\"data\", function(postDataChunk) {\n      postData += postDataChunk;\n      console.log(\"Received POST data chunk '\"+\n      postDataChunk + \"'.\");\n    });\n\n    request.addListener(\"end\", function() {\n      route(handle, pathname, response, postData);\n    });\n\n  }\n\n  http.createServer(onRequest).listen(8888);\n  console.log(\"Server has started.\");\n}\n\nexports.start = start;\n~~~\n UTF-8datapostData end****POST\n\n\n\ndata\n\n/uploadpostDatarouter.js\n\n~~~ JavaScript\nfunction route(handle, pathname, response, postData) {\n  console.log(\"About to route a request for \" + pathname);\n  if (typeof handle[pathname] === 'function') {\n    handle[pathname](response, postData);\n  } else {\n    console.log(\"No request handler found for \" + pathname);\n    response.writeHead(404, {\"Content-Type\": \"text/plain\"});\n    response.write(\"404 Not found\");\n    response.end();\n  }\n}\n\nexports.route = route;\n~~~\nrequestHandlers.jsupload\n\n~~~ JavaScript\nfunction start(response, postData) {\n  console.log(\"Request handler 'start' was called.\");\n\n  var body = '<html>'+\n    '<head>'+\n    '<meta http-equiv=\"Content-Type\" content=\"text/html; '+\n    'charset=UTF-8\" />'+\n    '</head>'+\n    '<body>'+\n    '<form action=\"/upload\" method=\"post\">'+\n    '<textarea name=\"text\" rows=\"20\" cols=\"60\"></textarea>'+\n    '<input type=\"submit\" value=\"Submit text\" />'+\n    '</form>'+\n    '</body>'+\n    '</html>';\n\n    response.writeHead(200, {\"Content-Type\": \"text/html\"});\n    response.write(body);\n    response.end();\n}\n\nfunction upload(response, postData) {\n  console.log(\"Request handler 'upload' was called.\");\n  response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n  response.write(\"You've sent: \" + postData);\n  response.end();\n}\n\nexports.start = start;\nexports.upload = upload;\n~~~\nPOST\n\n POSTtext\n\nquerystring\n\n~~~ JavaScript\nvar querystring = require(\"querystring\");\n\nfunction start(response, postData) {\n  console.log(\"Request handler 'start' was called.\");\n\n  var body = '<html>'+\n    '<head>'+\n    '<meta http-equiv=\"Content-Type\" content=\"text/html; '+\n    'charset=UTF-8\" />'+\n    '</head>'+\n    '<body>'+\n    '<form action=\"/upload\" method=\"post\">'+\n    '<textarea name=\"text\" rows=\"20\" cols=\"60\"></textarea>'+\n    '<input type=\"submit\" value=\"Submit text\" />'+\n    '</form>'+\n    '</body>'+\n    '</html>';\n\n    response.writeHead(200, {\"Content-Type\": \"text/html\"});\n    response.write(body);\n    response.end();\n}\n\nfunction upload(response, postData) {\n  console.log(\"Request handler 'upload' was called.\");\n  response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n  response.write(\"You've sent the text: \"+\n  querystring.parse(postData).text);\n  response.end();\n}\n\nexports.start = start;\nexports.upload = upload;\n~~~\nPOST\n\n#### \n\n\n\n90IPO Node.js\n\nFelix Geisendrfer**node-formidable** POST  \n\nNode.jsNPMNode.js\n\n~~~ JavaScript\nnpm install formidable\n~~~\n\n\n~~~ JavaScript\nnpm info build Success: formidable@1.0.9\nnpm ok\n~~~\n\n\nformidablerequire\n\n~~~ JavaScript\nvar formidable = require(\"formidable\");\n~~~\nHTTP POSTNode.jsIncomingFormrequest\n\nnode-formidable\n\n~~~ JavaScript\nvar formidable = require('formidable'),\n    http = require('http'),\n    util = require('util');\n\nhttp.createServer(function(req, res) {\n  if (req.url == '/upload' && req.method.toLowerCase() == 'post') {\n    // parse a file upload\n    var form = new formidable.IncomingForm();\n    form.parse(req, function(err, fields, files) {\n      res.writeHead(200, {'content-type': 'text/plain'});\n      res.write('received upload:\\n\\n');\n      res.end(util.inspect({fields: fields, files: files}));\n    });\n    return;\n  }\n\n  // show a file upload form\n  res.writeHead(200, {'content-type': 'text/html'});\n  res.end(\n    '<form action=\"/upload\" enctype=\"multipart/form-data\" '+\n    'method=\"post\">'+\n    '<input type=\"text\" name=\"title\"><br>'+\n    '<input type=\"file\" name=\"upload\" multiple=\"multiple\"><br>'+\n    '<input type=\"submit\" value=\"Upload\">'+\n    '</form>'\n  );\n}).listen(8888);\n~~~\nnodeform.parsefiles\n\n~~~ JavaScript\nreceived upload:\n\n{ fields: { title: 'Hello World' },\n  files:\n   { upload:\n      { size: 1558,\n        path: '/tmp/1c747974a27a6292743669e91f29350b',\n        name: 'us-flag.png',\n        type: 'image/png',\n        lastModifiedDate: Tue, 21 Jun 2011 07:02:41 GMT,\n        _writeStream: [Object],\n        length: [Getter],\n        filename: [Getter],\n        mime: [Getter] } } }\n~~~\n/tmp\n\n \n\n**fs**\n\n/showURL/tmp/test.png\n\nrequestHandlers.js\n\n~~~ JavaScript\nvar querystring = require(\"querystring\"),\n    fs = require(\"fs\");\n\nfunction start(response, postData) {\n  console.log(\"Request handler 'start' was called.\");\n\n  var body = '<html>'+\n    '<head>'+\n    '<meta http-equiv=\"Content-Type\" '+\n    'content=\"text/html; charset=UTF-8\" />'+\n    '</head>'+\n    '<body>'+\n    '<form action=\"/upload\" method=\"post\">'+\n    '<textarea name=\"text\" rows=\"20\" cols=\"60\"></textarea>'+\n    '<input type=\"submit\" value=\"Submit text\" />'+\n    '</form>'+\n    '</body>'+\n    '</html>';\n\n    response.writeHead(200, {\"Content-Type\": \"text/html\"});\n    response.write(body);\n    response.end();\n}\n\nfunction upload(response, postData) {\n  console.log(\"Request handler 'upload' was called.\");\n  response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n  response.write(\"You've sent the text: \"+\n  querystring.parse(postData).text);\n  response.end();\n}\n\nfunction show(response, postData) {\n  console.log(\"Request handler 'show' was called.\");\n  fs.readFile(\"/tmp/test.png\", \"binary\", function(error, file) {\n    if(error) {\n      response.writeHead(500, {\"Content-Type\": \"text/plain\"});\n      response.write(error + \"\\n\");\n      response.end();\n    } else {\n      response.writeHead(200, {\"Content-Type\": \"image/png\"});\n      response.write(file, \"binary\");\n      response.end();\n    }\n  });\n}\n\nexports.start = start;\nexports.upload = upload;\nexports.show = show;\n~~~\nindex.js\n\n~~~ JavaScript\nvar server = require(\"./server\");\nvar router = require(\"./router\");\nvar requestHandlers = require(\"./requestHandlers\");\n\nvar handle = {}\nhandle[\"/\"] = requestHandlers.start;\nhandle[\"/start\"] = requestHandlers.start;\nhandle[\"/upload\"] = requestHandlers.upload;\nhandle[\"/show\"] = requestHandlers.show;\n\nserver.start(router.route, handle);\n~~~\nhttp://localhost:8888/show/tmp/test.png\n\n\n\n- /start\n- node-formidableupload/tmp/test.png\n- /uploadURLHTML\n\nHTMLmultipart/form-dataUpload file requestHandler.js\n\n~~~ JavaScript\nvar querystring = require(\"querystring\"),\n    fs = require(\"fs\");\n\nfunction start(response, postData) {\n  console.log(\"Request handler 'start' was called.\");\n\n  var body = '<html>'+\n    '<head>'+\n    '<meta http-equiv=\"Content-Type\" '+\n    'content=\"text/html; charset=UTF-8\" />'+\n    '</head>'+\n    '<body>'+\n    '<form action=\"/upload\" enctype=\"multipart/form-data\" '+\n    'method=\"post\">'+\n    '<input type=\"file\" name=\"upload\">'+\n    '<input type=\"submit\" value=\"Upload file\" />'+\n    '</form>'+\n    '</body>'+\n    '</html>';\n\n    response.writeHead(200, {\"Content-Type\": \"text/html\"});\n    response.write(body);\n    response.end();\n}\n\nfunction upload(response, postData) {\n  console.log(\"Request handler 'upload' was called.\");\n  response.writeHead(200, {\"Content-Type\": \"text/plain\"});\n  response.write(\"You've sent the text: \"+\n  querystring.parse(postData).text);\n  response.end();\n}\n\nfunction show(response, postData) {\n  console.log(\"Request handler 'show' was called.\");\n  fs.readFile(\"/tmp/test.png\", \"binary\", function(error, file) {\n    if(error) {\n      response.writeHead(500, {\"Content-Type\": \"text/plain\"});\n      response.write(error + \"\\n\");\n      response.end();\n    } else {\n      response.writeHead(200, {\"Content-Type\": \"image/png\"});\n      response.write(file, \"binary\");\n      response.end();\n    }\n  });\n}\n\nexports.start = start;\nexports.upload = upload;\nexports.show = show;\n~~~\n uploadrequestnode-formidableform.parse\n\nresponsepostDatarequest \n\npostData   requestform.parseNode.js\n\nserver.js  postDatarequest.setEncoding node-formidablerequest\n\n~~~ JavaScript\nvar http = require(\"http\");\nvar url = require(\"url\");\n\nfunction start(route, handle) {\n  function onRequest(request, response) {\n    var pathname = url.parse(request.url).pathname;\n    console.log(\"Request for \" + pathname + \" received.\");\n    route(handle, pathname, response, request);\n  }\n\n  http.createServer(onRequest).listen(8888);\n  console.log(\"Server has started.\");\n}\n\nexports.start = start;\n~~~\n router.js  postDatarequest\n\n~~~ JavaScript\nfunction route(handle, pathname, response, request) {\n  console.log(\"About to route a request for \" + pathname);\n  if (typeof handle[pathname] === 'function') {\n    handle[pathname](response, request);\n  } else {\n    console.log(\"No request handler found for \" + pathname);\n    response.writeHead(404, {\"Content-Type\": \"text/html\"});\n    response.write(\"404 Not found\");\n    response.end();\n  }\n}\n\nexports.route = route;\n~~~\nrequestuploadnode-formidable/tmp/tmp/test.png PNG\n\n**fs.renameSync(path1,path2)**  \n\nrequestHandlers.js\n\n~~~ JavaScript\nvar querystring = require(\"querystring\"),\n    fs = require(\"fs\"),\n    formidable = require(\"formidable\");\n\nfunction start(response) {\n  console.log(\"Request handler 'start' was called.\");\n\n  var body = '<html>'+\n    '<head>'+\n    '<meta http-equiv=\"Content-Type\" content=\"text/html; '+\n    'charset=UTF-8\" />'+\n    '</head>'+\n    '<body>'+\n    '<form action=\"/upload\" enctype=\"multipart/form-data\" '+\n    'method=\"post\">'+\n    '<input type=\"file\" name=\"upload\" multiple=\"multiple\">'+\n    '<input type=\"submit\" value=\"Upload file\" />'+\n    '</form>'+\n    '</body>'+\n    '</html>';\n\n    response.writeHead(200, {\"Content-Type\": \"text/html\"});\n    response.write(body);\n    response.end();\n}\n\nfunction upload(response, request) {\n  console.log(\"Request handler 'upload' was called.\");\n\n  var form = new formidable.IncomingForm();\n  console.log(\"about to parse\");\n  form.parse(request, function(error, fields, files) {\n    console.log(\"parsing done\");\n    fs.renameSync(files.upload.path, \"/tmp/test.png\");\n    response.writeHead(200, {\"Content-Type\": \"text/html\"});\n    response.write(\"received image:<br/>\");\n    response.write(\"<img src='/show' />\");\n    response.end();\n  });\n}\n\nfunction show(response) {\n  console.log(\"Request handler 'show' was called.\");\n  fs.readFile(\"/tmp/test.png\", \"binary\", function(error, file) {\n    if(error) {\n      response.writeHead(500, {\"Content-Type\": \"text/plain\"});\n      response.write(error + \"\\n\");\n      response.end();\n    } else {\n      response.writeHead(200, {\"Content-Type\": \"image/png\"});\n      response.write(file, \"binary\");\n      response.end();\n    }\n  });\n}\n\nexports.start = start;\nexports.upload = upload;\nexports.show = show;\n~~~\n\n\n### \n\nNode.jsweb JavaScript\n\n Node.jsGET\n\n  \n","slug":"nodejs-learning-getting-started","published":1,"date":"2016-12-02T16:00:00.000Z","updated":"2017-11-23T07:10:12.000Z","comments":1,"photos":[],"link":"","_id":"cjaw7ec6f0082d6ykjteo5mm7","content":"<blockquote>\n<p><a href=\"http://www.nodebeginner.org/index-zh-cn.html\" target=\"_blank\" rel=\"external\">Node</a></p>\n</blockquote>\n<h2 id=\"Node\"><a href=\"#Node\" class=\"headerlink\" title=\"Node\"></a>Node</h2><p> Manuel Kiessling<br> goddyzhao &amp; GrayZhang &amp; MondayChen</p>\n<p>Node.jsJavaScriptHello World</p>\n<h3 id=\"JavaScript\"><a href=\"#JavaScript\" class=\"headerlink\" title=\"JavaScript\"></a>JavaScript</h3><p>JavaScriptJavaScriptJavaScriptJavaScript </p>\n<p>Node.jsJavaScript</p>\n<a id=\"more\"></a>\n<p>JavaScriptNode.jsGoogleV8GoogleChromeJavaScriptJavaScript</p>\n<p>Node.js</p>\n<p>Node.js</p>\n<p>Node.js,Node.js<a href=\"https://github.com/joyent/node/wiki/Installation\" target=\"_blank\" rel=\"external\"></a></p>\n<h4 id=\"Hello-World\"><a href=\"#Hello-World\" class=\"headerlink\" title=\"Hello World\"></a>Hello World</h4><p>Node.jsHello World</p>\n<p>helloworld.jsSTDOUTHello World</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">console</span>.log(<span class=\"string\">\"Hello World\"</span>);</div></pre></td></tr></table></figure>\n<p>Node.js<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">node helloworld.js</div></pre></td></tr></table></figure></p>\n<p>Hello World </p>\n<p></p>\n<h3 id=\"Node-jsweb\"><a href=\"#Node-jsweb\" class=\"headerlink\" title=\"Node.jsweb\"></a><strong>Node.jsweb</strong></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p><br><a href=\"http://domain/start\" target=\"_blank\" rel=\"external\">http://domain/start</a> <br><a href=\"http://domain/upload\" target=\"_blank\" rel=\"external\">http://domain/upload</a>  <br>Google</p>\n<p>Node.js</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p>WebHTTP<br>URLrequest handler<br><br>POST<br>URL<br><br>PHPApache HTTPmod_php5<br>HTTPWebPHP</p>\n<p>Node.jsNode.jsHTTPWebWeb</p>\n<p>Node.js</p>\n<p>HTTP</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"HTTP\"><a href=\"#HTTP\" class=\"headerlink\" title=\"HTTP\"></a>HTTP</h4><p>Node.jsNode.js<br>Node.jsHTTP</p>\n<p></p>\n<p>main fileNode.js</p>\n<p>HTTP</p>\n<p>index.jsserver.js</p>\n<p>server.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">\"http\"</span>);</div><div class=\"line\"></div><div class=\"line\">http.createServer(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">request, response</span>) </span>&#123;</div><div class=\"line\">  response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">  response.write(<span class=\"string\">\"Hello World\"</span>);</div><div class=\"line\">  response.end();</div><div class=\"line\">&#125;).listen(<span class=\"number\">8888</span>);</div></pre></td></tr></table></figure>\n<p>HTTPNode.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">node server.js</div></pre></td></tr></table></figure>\n<p><a href=\"http://localhost:8888/\" target=\"_blank\" rel=\"external\">http://localhost:8888/</a> Hello World</p>\n<p>HTTP</p>\n<h4 id=\"HTTP\"><a href=\"#HTTP\" class=\"headerlink\" title=\"HTTP\"></a>HTTP</h4><p>HTTP</p>\n<p>requireNode.js http  http </p>\n<p>http createServer  listen HTTP</p>\n<p> http.createServer </p>\n<p>8888<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">\"http\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> server = http.createServer();</div><div class=\"line\">server.listen(<span class=\"number\">8888</span>);</div></pre></td></tr></table></figure></p>\n<p>8888</p>\n<p>PHP createServer() </p>\n<p> createServer() JavaScript</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">say</span>(<span class=\"params\">word</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(word);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">execute</span>(<span class=\"params\">someFunction, value</span>) </span>&#123;</div><div class=\"line\">  someFunction(value);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">execute(say, <span class=\"string\">\"Hello\"</span>);</div></pre></td></tr></table></figure>\n<p> say execute say  say </p>\n<p> say execute  someFunction execute someFunction()  say </p>\n<p> say  execute  someFunction </p>\n<p></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">execute</span>(<span class=\"params\">someFunction, value</span>) </span>&#123;</div><div class=\"line\">  someFunction(value);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">execute(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">word</span>)</span>&#123; <span class=\"built_in\">console</span>.log(word) &#125;, <span class=\"string\">\"Hello\"</span>);</div></pre></td></tr></table></figure>\n<p> execute  execute </p>\n<p>  </p>\n<p>JavaScriptJavaScript</p>\n<h4 id=\"HTTP\"><a href=\"#HTTP\" class=\"headerlink\" title=\"HTTP\"></a>HTTP</h4><p>HTTP</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">\"http\"</span>);</div><div class=\"line\"></div><div class=\"line\">http.createServer(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">request, response</span>) </span>&#123;</div><div class=\"line\">  response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">  response.write(<span class=\"string\">\"Hello World\"</span>);</div><div class=\"line\">  response.end();</div><div class=\"line\">&#125;).listen(<span class=\"number\">8888</span>);</div></pre></td></tr></table></figure>\n<p> createServer </p>\n<p></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">\"http\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">onRequest</span>(<span class=\"params\">request, response</span>) </span>&#123;</div><div class=\"line\">  response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">  response.write(<span class=\"string\">\"Hello World\"</span>);</div><div class=\"line\">  response.end();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">http.createServer(onRequest).listen(<span class=\"number\">8888</span>);</div></pre></td></tr></table></figure>\n<p></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>Node.js</p>\n<p>Felix Geisendrfer<a href=\"http://debuggable.com/posts/understanding-node-js:4bd98440-45e4-4a9a-8ef7-0f7ecbdd56cb\" target=\"_blank\" rel=\"external\">Understanding node.js</a></p>\n<p>Node.jsNode.jsWeb based application</p>\n<p> http.createServer HTTP</p>\n<p></p>\n<p>PHPApachePHP</p>\n<p>Node.js8888</p>\n<p>Node.js/JavaScript</p>\n<p></p>\n<p></p>\n<p>    </p>\n<p>Felix</p>\n<p>HTTP</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">\"http\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">onRequest</span>(<span class=\"params\">request, response</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request received.\"</span>);</div><div class=\"line\">  response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">  response.write(<span class=\"string\">\"Hello World\"</span>);</div><div class=\"line\">  response.end();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">http.createServer(onRequest).listen(<span class=\"number\">8888</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"built_in\">console</span>.log(<span class=\"string\">\"Server has started.\"</span>);</div></pre></td></tr></table></figure>\n<blockquote>\n<p> onRequest  console.log HTTP</p>\n</blockquote>\n<p>node server.jsServer has started.<a href=\"http://localhost:8888/\" target=\"_blank\" rel=\"external\">http://localhost:8888/</a> Request received.</p>\n<p>JavaScript</p>\n<blockquote>\n<p>Request received. <a href=\"http://localhost:8888/\" target=\"_blank\" rel=\"external\">http://localhost:8888/</a>  <a href=\"http://localhost:8888/favicon.ico\" target=\"_blank\" rel=\"external\">http://localhost:8888/favicon.ico</a> )</p>\n</blockquote>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p> onRequest() </p>\n<p> onRequest()  request  response </p>\n<p>HTTP</p>\n<p> response.writeHead() HTTP200HTTPcontent-type response.write() HTTPHello World</p>\n<p> response.end() </p>\n<p> request </p>\n<p></p>\n<p>OK server.js HTTP index.js  server.js HTTP</p>\n<p>server.jsNode.js index.js </p>\n<p></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">\"http\"</span>);</div><div class=\"line\"></div><div class=\"line\">...</div><div class=\"line\"></div><div class=\"line\">http.createServer(...);</div></pre></td></tr></table></figure>\n<p>Node.jshttp</p>\n<p> http </p>\n<p></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> foo = <span class=\"built_in\">require</span>(<span class=\"string\">\"http\"</span>);</div><div class=\"line\"></div><div class=\"line\">...</div><div class=\"line\"></div><div class=\"line\">foo.createServer(...);</div></pre></td></tr></table></figure>\n<p>Node.js</p>\n<p> server.js </p>\n<p>  </p>\n<p>HTTP</p>\n<p> start </p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">\"http\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">onRequest</span>(<span class=\"params\">request, response</span>) </span>&#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request received.\"</span>);</div><div class=\"line\">    response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">    response.write(<span class=\"string\">\"Hello World\"</span>);</div><div class=\"line\">    response.end();</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  http.createServer(onRequest).listen(<span class=\"number\">8888</span>);</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Server has started.\"</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div></pre></td></tr></table></figure>\n<p> index.js HTTP server.js </p>\n<p> index.js </p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> server = <span class=\"built_in\">require</span>(<span class=\"string\">\"./server\"</span>);</div><div class=\"line\"></div><div class=\"line\">server.start();</div></pre></td></tr></table></figure>\n<p>server</p>\n<p></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">node index.js</div></pre></td></tr></table></figure>\n<p></p>\n<p>HTTPURL</p>\n<p> onRequest() </p>\n<p>HTTP<strong></strong></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>URLGETPOST</p>\n<p>HTTPURLGET/POSTHTTP</p>\n<p>requestonRequest()Node.JS<strong>url</strong><strong>querystring</strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">                               url.parse(string).query</div><div class=\"line\">                                           |</div><div class=\"line\">           url.parse(string).pathname      |</div><div class=\"line\">                       |                   |</div><div class=\"line\">                       |                   |</div><div class=\"line\">                     ------ -------------------</div><div class=\"line\">http:<span class=\"comment\">//localhost:8888/start?foo=bar&amp;hello=world</span></div><div class=\"line\">                                ---       -----</div><div class=\"line\">                                 |          |</div><div class=\"line\">                                 |          |</div><div class=\"line\">              querystring(string)[<span class=\"string\">\"foo\"</span>]    |</div><div class=\"line\">                                            |</div><div class=\"line\">                         querystring(string)[<span class=\"string\">\"hello\"</span>]</div></pre></td></tr></table></figure>\n<p>querystringPOST</p>\n<p>onRequest()URL</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">\"http\"</span>);</div><div class=\"line\"><span class=\"keyword\">var</span> url = <span class=\"built_in\">require</span>(<span class=\"string\">\"url\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">onRequest</span>(<span class=\"params\">request, response</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> pathname = url.parse(request.url).pathname;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request for \"</span> + pathname + <span class=\"string\">\" received.\"</span>);</div><div class=\"line\">    response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">    response.write(<span class=\"string\">\"Hello World\"</span>);</div><div class=\"line\">    response.end();</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  http.createServer(onRequest).listen(<span class=\"number\">8888</span>);</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Server has started.\"</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div></pre></td></tr></table></figure>\n<p>URLURL</p>\n<p>/start/upload</p>\n<p>router.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">route</span>(<span class=\"params\">pathname</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"About to route a request for \"</span> + pathname);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.route = route;</div></pre></td></tr></table></figure>\n<p></p>\n<p><a href=\"http://martinfowler.com/articles/injection.html\" target=\"_blank\" rel=\"external\">Martin Fowlers</a></p>\n<p>start()</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">\"http\"</span>);</div><div class=\"line\"><span class=\"keyword\">var</span> url = <span class=\"built_in\">require</span>(<span class=\"string\">\"url\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\">route</span>) </span>&#123;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">onRequest</span>(<span class=\"params\">request, response</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> pathname = url.parse(request.url).pathname;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request for \"</span> + pathname + <span class=\"string\">\" received.\"</span>);</div><div class=\"line\"></div><div class=\"line\">    route(pathname);</div><div class=\"line\"></div><div class=\"line\">    response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">    response.write(<span class=\"string\">\"Hello World\"</span>);</div><div class=\"line\">    response.end();</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  http.createServer(onRequest).listen(<span class=\"number\">8888</span>);</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Server has started.\"</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div></pre></td></tr></table></figure>\n<p>index.js<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> server = <span class=\"built_in\">require</span>(<span class=\"string\">\"./server\"</span>);</div><div class=\"line\"><span class=\"keyword\">var</span> router = <span class=\"built_in\">require</span>(<span class=\"string\">\"./router\"</span>);</div><div class=\"line\"></div><div class=\"line\">server.start(router.route);</div></pre></td></tr></table></figure></p>\n<p></p>\n<p>node index.jsURLHTTP</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">bash$ node index.js</div><div class=\"line\">Request <span class=\"keyword\">for</span> /foo received.</div><div class=\"line\">About to route a request <span class=\"keyword\">for</span> /foo</div></pre></td></tr></table></figure>\n<p>/favicon.ico</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<p>indexrouterroute</p>\n<p></p>\n<pre><code>\n</code></pre><p></p>\n<p></p>\n<p>Steve Yegge<a href=\"http://steve-yegge.blogspot.jp/2006/03/execution-in-kingdom-of-nouns.html\" target=\"_blank\" rel=\"external\"></a></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>HTTP</p>\n<p>URL/start/upload</p>\n<p></p>\n<p></p>\n<p>  requestHandlers</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'start' was called.\"</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">upload</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'upload' was called.\"</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div><div class=\"line\">exports.upload = upload;</div></pre></td></tr></table></figure>\n<p></p>\n<p>requestHandlers</p>\n<p></p>\n<p>2URLif request == x then call handler y</p>\n<p>URL<strong>associative array</strong> </p>\n<p>JavaScript  JavaScript</p>\n<p><a href=\"http://msdn.microsoft.com/en-us/magazine/cc163419.aspx\" target=\"_blank\" rel=\"external\">http://msdn.microsoft.com/en-us/magazine/cc163419.aspx</a> </p>\n<blockquote>\n<p>C++C#JavaScriptJavaScript/  JavaScript</p>\n</blockquote>\n<p>JavaScript/</p>\n<p>route()</p>\n<p>index.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> server = <span class=\"built_in\">require</span>(<span class=\"string\">\"./server\"</span>);</div><div class=\"line\"><span class=\"keyword\">var</span> router = <span class=\"built_in\">require</span>(<span class=\"string\">\"./router\"</span>);</div><div class=\"line\"><span class=\"keyword\">var</span> requestHandlers = <span class=\"built_in\">require</span>(<span class=\"string\">\"./requestHandlers\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> handle = &#123;&#125;</div><div class=\"line\">handle[<span class=\"string\">\"/\"</span>] = requestHandlers.start;</div><div class=\"line\">handle[<span class=\"string\">\"/start\"</span>] = requestHandlers.start;</div><div class=\"line\">handle[<span class=\"string\">\"/upload\"</span>] = requestHandlers.upload;</div><div class=\"line\"></div><div class=\"line\">server.start(router.route, handle);</div></pre></td></tr></table></figure>\n<p>handle</p>\n<p>URL/requestHandlers.start/start/start</p>\n<p>server.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">\"http\"</span>);</div><div class=\"line\"><span class=\"keyword\">var</span> url = <span class=\"built_in\">require</span>(<span class=\"string\">\"url\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\">route, handle</span>) </span>&#123;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">onRequest</span>(<span class=\"params\">request, response</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> pathname = url.parse(request.url).pathname;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request for \"</span> + pathname + <span class=\"string\">\" received.\"</span>);</div><div class=\"line\"></div><div class=\"line\">    route(handle, pathname);</div><div class=\"line\"></div><div class=\"line\">    response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">    response.write(<span class=\"string\">\"Hello World\"</span>);</div><div class=\"line\">    response.end();</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  http.createServer(onRequest).listen(<span class=\"number\">8888</span>);</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Server has started.\"</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div></pre></td></tr></table></figure>\n<p>start()handlehandleroute()</p>\n<p>route.jsroute()</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">route</span>(<span class=\"params\">handle, pathname</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"About to route a request for \"</span> + pathname);</div><div class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> handle[pathname] === <span class=\"string\">'function'</span>) &#123;</div><div class=\"line\">    handle[pathname]();</div><div class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"No request handler found for \"</span> + pathname);</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.route = route;</div></pre></td></tr></table></figure>\n<p>handle<a href=\"\">pathname</a>;</p>\n<p><a href=\"http://localhost:8888/start\" target=\"_blank\" rel=\"external\">http://localhost:8888/start</a></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">Server has started.</div><div class=\"line\">Request <span class=\"keyword\">for</span> /start received.</div><div class=\"line\">About to route a request <span class=\"keyword\">for</span> /start</div><div class=\"line\">Request handler <span class=\"string\">'start'</span> was called.</div></pre></td></tr></table></figure>\n<p><a href=\"http://localhost:8888/start\" target=\"_blank\" rel=\"external\">http://localhost:8888/start</a></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">Request <span class=\"keyword\">for</span> / received.</div><div class=\"line\">About to route a request <span class=\"keyword\">for</span> /</div><div class=\"line\">Request handler <span class=\"string\">'start'</span> was called.</div></pre></td></tr></table></figure>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>Hello World</p>\n<p>Hello Worldserver.jsonRequest</p>\n<p>onRequest</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>PHPRuby </p>\n<p>onRequestreturn()</p>\n<p></p>\n<p>requestHandler.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'start' was called.\"</span>);</div><div class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">\"Hello Start\"</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">upload</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'upload' was called.\"</span>);</div><div class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">\"Hello Upload\"</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div><div class=\"line\">exports.upload = upload;</div></pre></td></tr></table></figure>\n<p>router.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">route</span>(<span class=\"params\">handle, pathname</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"About to route a request for \"</span> + pathname);</div><div class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> handle[pathname] === <span class=\"string\">'function'</span>) &#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> handle[pathname]();</div><div class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"No request handler found for \"</span> + pathname);</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">\"404 Not found\"</span>;</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.route = route;</div></pre></td></tr></table></figure>\n<p></p>\n<p>server.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">\"http\"</span>);</div><div class=\"line\"><span class=\"keyword\">var</span> url = <span class=\"built_in\">require</span>(<span class=\"string\">\"url\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\">route, handle</span>) </span>&#123;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">onRequest</span>(<span class=\"params\">request, response</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> pathname = url.parse(request.url).pathname;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request for \"</span> + pathname + <span class=\"string\">\" received.\"</span>);</div><div class=\"line\"></div><div class=\"line\">    response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">    <span class=\"keyword\">var</span> content = route(handle, pathname)</div><div class=\"line\">    response.write(content);</div><div class=\"line\">    response.end();</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  http.createServer(onRequest).listen(<span class=\"number\">8888</span>);</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Server has started.\"</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div></pre></td></tr></table></figure>\n<p><a href=\"http://localhost:8888/start\" target=\"_blank\" rel=\"external\">http://localhost:8888/start</a>, Hello Start<a href=\"http://localhost:8888/upload\" target=\"_blank\" rel=\"external\">http://localhost:8888/upload</a> Hello Upload,<a href=\"http://localhost:8888/foo\" target=\"_blank\" rel=\"external\">http://localhost:8888/foo</a> 404 Not found</p>\n<p> <strong></strong></p>\n<p></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<p></p>\n<p>start10Hello StartJavaScriptsleep()Hack</p>\n<p>requestHandlers.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'start' was called.\"</span>);</div><div class=\"line\"></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">sleep</span>(<span class=\"params\">milliSeconds</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> startTime = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().getTime();</div><div class=\"line\">    <span class=\"keyword\">while</span> (<span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().getTime() &lt; startTime + milliSeconds);</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  sleep(<span class=\"number\">10000</span>);</div><div class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">\"Hello Start\"</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">upload</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'upload' was called.\"</span>);</div><div class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">\"Hello Upload\"</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div><div class=\"line\">exports.upload = upload;</div></pre></td></tr></table></figure>\n<p>start()Node.js10Hello Startupload()</p>\n<blockquote>\n<p>10</p>\n</blockquote>\n<p></p>\n<p> <a href=\"http://localhost:8888/start\" target=\"_blank\" rel=\"external\">http://localhost:8888/start</a> </p>\n<p><a href=\"http://localhost:8888/upload\" target=\"_blank\" rel=\"external\">http://localhost:8888/upload</a> </p>\n<p>/start/upload</p>\n<p> /start URL10/upload URL10sleep()</p>\n<p>start()<strong></strong></p>\n<p>Nodenode</p>\n<p><strong>Node.js</strong>  Node.jsevent loop  </p>\n<p>10</p>\n<p>Node.jsprobablyExpensiveFunction()Node.jscallbackFunction()</p>\n<p>Mixu<a href=\"http://blog.mixu.net/2011/02/01/understanding-the-node-js-event-loop/\" target=\"_blank\" rel=\"external\">node.js</a></p>\n<p><strong></strong></p>\n<p></p>\n<p>start</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> exec = <span class=\"built_in\">require</span>(<span class=\"string\">\"child_process\"</span>).exec;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'start' was called.\"</span>);</div><div class=\"line\">  <span class=\"keyword\">var</span> content = <span class=\"string\">\"empty\"</span>;</div><div class=\"line\"></div><div class=\"line\">  exec(<span class=\"string\">\"ls -lah\"</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">error, stdout, stderr</span>) </span>&#123;</div><div class=\"line\">    content = stdout;</div><div class=\"line\">  &#125;);</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">return</span> content;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">upload</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'upload' was called.\"</span>);</div><div class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">\"Hello Upload\"</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div><div class=\"line\">exports.upload = upload;</div></pre></td></tr></table></figure>\n<p>Node.js<strong>child_process</strong><strong>exec()</strong></p>\n<p>exec()Node.jsshellls -lah,/startURL</p>\n<p> contentemptyls -lahcontentcontent</p>\n<p><a href=\"http://localhost:8888/start\" target=\"_blank\" rel=\"external\">http://localhost:8888/start</a> </p>\n<p>webempty</p>\n<p>exec()shell</p>\n<blockquote>\n<p>ls -lahfind /</p>\n</blockquote>\n<p></p>\n<p></p>\n<p>exec()</p>\n<p>exec()</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">error, stdout, stderr</span>) </span>&#123;</div><div class=\"line\">  content = stdout;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>exec()Node.js return content contentemptyexec()exec()</p>\n<p>ls -lah  </p>\n<p> find /1ls -lahfind //start URLHTTP  exec()Node.jsexec()find /</p>\n<p></p>\n<p></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>  </p>\n<p>Node.js <strong></strong></p>\n<p> -&gt;  -&gt; HTTP</p>\n<p><strong></strong> responseonRequest() </p>\n<p></p>\n<p>server.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">\"http\"</span>);</div><div class=\"line\"><span class=\"keyword\">var</span> url = <span class=\"built_in\">require</span>(<span class=\"string\">\"url\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\">route, handle</span>) </span>&#123;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">onRequest</span>(<span class=\"params\">request, response</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> pathname = url.parse(request.url).pathname;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request for \"</span> + pathname + <span class=\"string\">\" received.\"</span>);</div><div class=\"line\"></div><div class=\"line\">    route(handle, pathname, response);</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  http.createServer(onRequest).listen(<span class=\"number\">8888</span>);</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Server has started.\"</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div></pre></td></tr></table></figure>\n<p>route()responseroute()onRequest()responseroute()</p>\n<p>router.js:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">route</span>(<span class=\"params\">handle, pathname, response</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"About to route a request for \"</span> + pathname);</div><div class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> handle[pathname] === <span class=\"string\">'function'</span>) &#123;</div><div class=\"line\">    handle[pathname](response);</div><div class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"No request handler found for \"</span> + pathname);</div><div class=\"line\">    response.writeHead(<span class=\"number\">404</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">    response.write(<span class=\"string\">\"404 Not found\"</span>);</div><div class=\"line\">    response.end();</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.route = route;</div></pre></td></tr></table></figure>\n<p>response</p>\n<p>404</p>\n<p>requestHandler.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> exec = <span class=\"built_in\">require</span>(<span class=\"string\">\"child_process\"</span>).exec;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\">response</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'start' was called.\"</span>);</div><div class=\"line\"></div><div class=\"line\">  exec(<span class=\"string\">\"ls -lah\"</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">error, stdout, stderr</span>) </span>&#123;</div><div class=\"line\">    response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">    response.write(stdout);</div><div class=\"line\">    response.end();</div><div class=\"line\">  &#125;);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">upload</span>(<span class=\"params\">response</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'upload' was called.\"</span>);</div><div class=\"line\">  response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">  response.write(<span class=\"string\">\"Hello Upload\"</span>);</div><div class=\"line\">  response.end();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div><div class=\"line\">exports.upload = upload;</div></pre></td></tr></table></figure>\n<p>response</p>\n<p>startexec()uploadHello Worldresponse</p>\n<p>node index.js</p>\n<p>/start/uploadrequestHandlers.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> exec = <span class=\"built_in\">require</span>(<span class=\"string\">\"child_process\"</span>).exec;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\">response</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'start' was called.\"</span>);</div><div class=\"line\"></div><div class=\"line\">  exec(<span class=\"string\">\"find /\"</span>,</div><div class=\"line\">    &#123; <span class=\"attr\">timeout</span>: <span class=\"number\">10000</span>, <span class=\"attr\">maxBuffer</span>: <span class=\"number\">20000</span>*<span class=\"number\">1024</span> &#125;,</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">error, stdout, stderr</span>) </span>&#123;</div><div class=\"line\">      response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">      response.write(stdout);</div><div class=\"line\">      response.end();</div><div class=\"line\">    &#125;);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">upload</span>(<span class=\"params\">response</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'upload' was called.\"</span>);</div><div class=\"line\">  response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">  response.write(<span class=\"string\">\"Hello Upload\"</span>);</div><div class=\"line\">  response.end();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div><div class=\"line\">exports.upload = upload;</div></pre></td></tr></table></figure>\n<p><a href=\"http://localhost:8888/start\" target=\"_blank\" rel=\"external\">http://localhost:8888/start</a> 10<a href=\"http://localhost:8888/upload\" target=\"_blank\" rel=\"external\">http://localhost:8888/upload</a> /start</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<p> </p>\n<p>JavaScript</p>\n<p> POSTNode.js</p>\n<p>Node.jsPOST<br>Node.jsmultipart POST</p>\n<h4 id=\"POST\"><a href=\"#POST\" class=\"headerlink\" title=\"POST\"></a>POST</h4><p>textareaPOST</p>\n<p>/startrequestHandlers.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\">response</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'start' was called.\"</span>);</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">var</span> body = <span class=\"string\">'&lt;html&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;head&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;meta http-equiv=\"Content-Type\" content=\"text/html; '</span>+</div><div class=\"line\">    <span class=\"string\">'charset=UTF-8\" /&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/head&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;body&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;form action=\"/upload\" method=\"post\"&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;textarea name=\"text\" rows=\"20\" cols=\"60\"&gt;&lt;/textarea&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;input type=\"submit\" value=\"Submit text\" /&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/form&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/body&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/html&gt;'</span>;</div><div class=\"line\"></div><div class=\"line\">    response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/html\"</span>&#125;);</div><div class=\"line\">    response.write(body);</div><div class=\"line\">    response.end();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">upload</span>(<span class=\"params\">response</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'upload' was called.\"</span>);</div><div class=\"line\">  response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">  response.write(<span class=\"string\">\"Hello Upload\"</span>);</div><div class=\"line\">  response.end();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div><div class=\"line\">exports.upload = upload;</div></pre></td></tr></table></figure>\n<p>Webby Awards<a href=\"http://localhost:8888/start\" target=\"_blank\" rel=\"external\">http://localhost:8888/start</a> </p>\n<p>MVCJavaScriptNode.js</p>\n<p> /uploadPOST</p>\n<p>POST</p>\n<p>POST  </p>\n<p>Node.jsPOST<strong>data</strong><strong>end</strong></p>\n<p>Node.js request<strong>listener</strong> requestHTTPonRequest</p>\n<p></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">request.addListener(<span class=\"string\">\"data\"</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">chunk</span>) </span>&#123;</div><div class=\"line\">  <span class=\"comment\">// called when a new chunk of data was received</span></div><div class=\"line\">&#125;);</div><div class=\"line\"></div><div class=\"line\">request.addListener(<span class=\"string\">\"end\"</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">  <span class=\"comment\">// called when all chunks of data have been received</span></div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure>\n<p> request  response request </p>\n<p>HTTPPOST</p>\n<p> dataenddataPOSTend</p>\n<p>server.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">\"http\"</span>);</div><div class=\"line\"><span class=\"keyword\">var</span> url = <span class=\"built_in\">require</span>(<span class=\"string\">\"url\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\">route, handle</span>) </span>&#123;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">onRequest</span>(<span class=\"params\">request, response</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> postData = <span class=\"string\">\"\"</span>;</div><div class=\"line\">    <span class=\"keyword\">var</span> pathname = url.parse(request.url).pathname;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request for \"</span> + pathname + <span class=\"string\">\" received.\"</span>);</div><div class=\"line\"></div><div class=\"line\">    request.setEncoding(<span class=\"string\">\"utf8\"</span>);</div><div class=\"line\"></div><div class=\"line\">    request.addListener(<span class=\"string\">\"data\"</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">postDataChunk</span>) </span>&#123;</div><div class=\"line\">      postData += postDataChunk;</div><div class=\"line\">      <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Received POST data chunk '\"</span>+</div><div class=\"line\">      postDataChunk + <span class=\"string\">\"'.\"</span>);</div><div class=\"line\">    &#125;);</div><div class=\"line\"></div><div class=\"line\">    request.addListener(<span class=\"string\">\"end\"</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">      route(handle, pathname, response, postData);</div><div class=\"line\">    &#125;);</div><div class=\"line\"></div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  http.createServer(onRequest).listen(<span class=\"number\">8888</span>);</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Server has started.\"</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div></pre></td></tr></table></figure>\n<p> UTF-8datapostData end<strong></strong>POST</p>\n<p></p>\n<p>data</p>\n<p>/uploadpostDatarouter.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">route</span>(<span class=\"params\">handle, pathname, response, postData</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"About to route a request for \"</span> + pathname);</div><div class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> handle[pathname] === <span class=\"string\">'function'</span>) &#123;</div><div class=\"line\">    handle[pathname](response, postData);</div><div class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"No request handler found for \"</span> + pathname);</div><div class=\"line\">    response.writeHead(<span class=\"number\">404</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">    response.write(<span class=\"string\">\"404 Not found\"</span>);</div><div class=\"line\">    response.end();</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.route = route;</div></pre></td></tr></table></figure>\n<p>requestHandlers.jsupload</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\">response, postData</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'start' was called.\"</span>);</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">var</span> body = <span class=\"string\">'&lt;html&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;head&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;meta http-equiv=\"Content-Type\" content=\"text/html; '</span>+</div><div class=\"line\">    <span class=\"string\">'charset=UTF-8\" /&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/head&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;body&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;form action=\"/upload\" method=\"post\"&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;textarea name=\"text\" rows=\"20\" cols=\"60\"&gt;&lt;/textarea&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;input type=\"submit\" value=\"Submit text\" /&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/form&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/body&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/html&gt;'</span>;</div><div class=\"line\"></div><div class=\"line\">    response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/html\"</span>&#125;);</div><div class=\"line\">    response.write(body);</div><div class=\"line\">    response.end();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">upload</span>(<span class=\"params\">response, postData</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'upload' was called.\"</span>);</div><div class=\"line\">  response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">  response.write(<span class=\"string\">\"You've sent: \"</span> + postData);</div><div class=\"line\">  response.end();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div><div class=\"line\">exports.upload = upload;</div></pre></td></tr></table></figure>\n<p>POST</p>\n<p> POSTtext</p>\n<p>querystring</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> querystring = <span class=\"built_in\">require</span>(<span class=\"string\">\"querystring\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\">response, postData</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'start' was called.\"</span>);</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">var</span> body = <span class=\"string\">'&lt;html&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;head&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;meta http-equiv=\"Content-Type\" content=\"text/html; '</span>+</div><div class=\"line\">    <span class=\"string\">'charset=UTF-8\" /&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/head&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;body&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;form action=\"/upload\" method=\"post\"&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;textarea name=\"text\" rows=\"20\" cols=\"60\"&gt;&lt;/textarea&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;input type=\"submit\" value=\"Submit text\" /&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/form&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/body&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/html&gt;'</span>;</div><div class=\"line\"></div><div class=\"line\">    response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/html\"</span>&#125;);</div><div class=\"line\">    response.write(body);</div><div class=\"line\">    response.end();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">upload</span>(<span class=\"params\">response, postData</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'upload' was called.\"</span>);</div><div class=\"line\">  response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">  response.write(<span class=\"string\">\"You've sent the text: \"</span>+</div><div class=\"line\">  querystring.parse(postData).text);</div><div class=\"line\">  response.end();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div><div class=\"line\">exports.upload = upload;</div></pre></td></tr></table></figure>\n<p>POST</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<p>90IPO Node.js</p>\n<p>Felix Geisendrfer<strong>node-formidable</strong> POST  </p>\n<p>Node.jsNPMNode.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">npm install formidable</div></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">npm info build Success: formidable@<span class=\"number\">1.0</span><span class=\"number\">.9</span></div><div class=\"line\">npm ok</div></pre></td></tr></table></figure>\n<p></p>\n<p>formidablerequire</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> formidable = <span class=\"built_in\">require</span>(<span class=\"string\">\"formidable\"</span>);</div></pre></td></tr></table></figure>\n<p>HTTP POSTNode.jsIncomingFormrequest</p>\n<p>node-formidable</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> formidable = <span class=\"built_in\">require</span>(<span class=\"string\">'formidable'</span>),</div><div class=\"line\">    http = <span class=\"built_in\">require</span>(<span class=\"string\">'http'</span>),</div><div class=\"line\">    util = <span class=\"built_in\">require</span>(<span class=\"string\">'util'</span>);</div><div class=\"line\"></div><div class=\"line\">http.createServer(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">req, res</span>) </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">if</span> (req.url == <span class=\"string\">'/upload'</span> &amp;&amp; req.method.toLowerCase() == <span class=\"string\">'post'</span>) &#123;</div><div class=\"line\">    <span class=\"comment\">// parse a file upload</span></div><div class=\"line\">    <span class=\"keyword\">var</span> form = <span class=\"keyword\">new</span> formidable.IncomingForm();</div><div class=\"line\">    form.parse(req, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err, fields, files</span>) </span>&#123;</div><div class=\"line\">      res.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">'content-type'</span>: <span class=\"string\">'text/plain'</span>&#125;);</div><div class=\"line\">      res.write(<span class=\"string\">'received upload:\\n\\n'</span>);</div><div class=\"line\">      res.end(util.inspect(&#123;<span class=\"attr\">fields</span>: fields, <span class=\"attr\">files</span>: files&#125;));</div><div class=\"line\">    &#125;);</div><div class=\"line\">    <span class=\"keyword\">return</span>;</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\">// show a file upload form</span></div><div class=\"line\">  res.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">'content-type'</span>: <span class=\"string\">'text/html'</span>&#125;);</div><div class=\"line\">  res.end(</div><div class=\"line\">    <span class=\"string\">'&lt;form action=\"/upload\" enctype=\"multipart/form-data\" '</span>+</div><div class=\"line\">    <span class=\"string\">'method=\"post\"&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;input type=\"text\" name=\"title\"&gt;&lt;br&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;input type=\"file\" name=\"upload\" multiple=\"multiple\"&gt;&lt;br&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;input type=\"submit\" value=\"Upload\"&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/form&gt;'</span></div><div class=\"line\">  );</div><div class=\"line\">&#125;).listen(<span class=\"number\">8888</span>);</div></pre></td></tr></table></figure>\n<p>nodeform.parsefiles</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">received upload:</div><div class=\"line\"></div><div class=\"line\">&#123; <span class=\"attr\">fields</span>: &#123; <span class=\"attr\">title</span>: <span class=\"string\">'Hello World'</span> &#125;,</div><div class=\"line\">  <span class=\"attr\">files</span>:</div><div class=\"line\">   &#123; <span class=\"attr\">upload</span>:</div><div class=\"line\">      &#123; <span class=\"attr\">size</span>: <span class=\"number\">1558</span>,</div><div class=\"line\">        <span class=\"attr\">path</span>: <span class=\"string\">'/tmp/1c747974a27a6292743669e91f29350b'</span>,</div><div class=\"line\">        <span class=\"attr\">name</span>: <span class=\"string\">'us-flag.png'</span>,</div><div class=\"line\">        <span class=\"attr\">type</span>: <span class=\"string\">'image/png'</span>,</div><div class=\"line\">        <span class=\"attr\">lastModifiedDate</span>: Tue, <span class=\"number\">21</span> Jun <span class=\"number\">2011</span> <span class=\"number\">07</span>:<span class=\"number\">02</span>:<span class=\"number\">41</span> GMT,</div><div class=\"line\">        <span class=\"attr\">_writeStream</span>: [<span class=\"built_in\">Object</span>],</div><div class=\"line\">        <span class=\"attr\">length</span>: [Getter],</div><div class=\"line\">        <span class=\"attr\">filename</span>: [Getter],</div><div class=\"line\">        <span class=\"attr\">mime</span>: [Getter] &#125; &#125; &#125;</div></pre></td></tr></table></figure>\n<p>/tmp</p>\n<p> </p>\n<p><strong>fs</strong></p>\n<p>/showURL/tmp/test.png</p>\n<p>requestHandlers.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> querystring = <span class=\"built_in\">require</span>(<span class=\"string\">\"querystring\"</span>),</div><div class=\"line\">    fs = <span class=\"built_in\">require</span>(<span class=\"string\">\"fs\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\">response, postData</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'start' was called.\"</span>);</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">var</span> body = <span class=\"string\">'&lt;html&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;head&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;meta http-equiv=\"Content-Type\" '</span>+</div><div class=\"line\">    <span class=\"string\">'content=\"text/html; charset=UTF-8\" /&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/head&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;body&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;form action=\"/upload\" method=\"post\"&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;textarea name=\"text\" rows=\"20\" cols=\"60\"&gt;&lt;/textarea&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;input type=\"submit\" value=\"Submit text\" /&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/form&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/body&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/html&gt;'</span>;</div><div class=\"line\"></div><div class=\"line\">    response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/html\"</span>&#125;);</div><div class=\"line\">    response.write(body);</div><div class=\"line\">    response.end();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">upload</span>(<span class=\"params\">response, postData</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'upload' was called.\"</span>);</div><div class=\"line\">  response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">  response.write(<span class=\"string\">\"You've sent the text: \"</span>+</div><div class=\"line\">  querystring.parse(postData).text);</div><div class=\"line\">  response.end();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">show</span>(<span class=\"params\">response, postData</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'show' was called.\"</span>);</div><div class=\"line\">  fs.readFile(<span class=\"string\">\"/tmp/test.png\"</span>, <span class=\"string\">\"binary\"</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">error, file</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span>(error) &#123;</div><div class=\"line\">      response.writeHead(<span class=\"number\">500</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">      response.write(error + <span class=\"string\">\"\\n\"</span>);</div><div class=\"line\">      response.end();</div><div class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">      response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"image/png\"</span>&#125;);</div><div class=\"line\">      response.write(file, <span class=\"string\">\"binary\"</span>);</div><div class=\"line\">      response.end();</div><div class=\"line\">    &#125;</div><div class=\"line\">  &#125;);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div><div class=\"line\">exports.upload = upload;</div><div class=\"line\">exports.show = show;</div></pre></td></tr></table></figure>\n<p>index.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> server = <span class=\"built_in\">require</span>(<span class=\"string\">\"./server\"</span>);</div><div class=\"line\"><span class=\"keyword\">var</span> router = <span class=\"built_in\">require</span>(<span class=\"string\">\"./router\"</span>);</div><div class=\"line\"><span class=\"keyword\">var</span> requestHandlers = <span class=\"built_in\">require</span>(<span class=\"string\">\"./requestHandlers\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> handle = &#123;&#125;</div><div class=\"line\">handle[<span class=\"string\">\"/\"</span>] = requestHandlers.start;</div><div class=\"line\">handle[<span class=\"string\">\"/start\"</span>] = requestHandlers.start;</div><div class=\"line\">handle[<span class=\"string\">\"/upload\"</span>] = requestHandlers.upload;</div><div class=\"line\">handle[<span class=\"string\">\"/show\"</span>] = requestHandlers.show;</div><div class=\"line\"></div><div class=\"line\">server.start(router.route, handle);</div></pre></td></tr></table></figure>\n<p><a href=\"http://localhost:8888/show/tmp/test.png\" target=\"_blank\" rel=\"external\">http://localhost:8888/show/tmp/test.png</a></p>\n<p></p>\n<ul>\n<li>/start</li>\n<li>node-formidableupload/tmp/test.png</li>\n<li>/uploadURLHTML</li>\n</ul>\n<p>HTMLmultipart/form-dataUpload file requestHandler.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> querystring = <span class=\"built_in\">require</span>(<span class=\"string\">\"querystring\"</span>),</div><div class=\"line\">    fs = <span class=\"built_in\">require</span>(<span class=\"string\">\"fs\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\">response, postData</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'start' was called.\"</span>);</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">var</span> body = <span class=\"string\">'&lt;html&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;head&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;meta http-equiv=\"Content-Type\" '</span>+</div><div class=\"line\">    <span class=\"string\">'content=\"text/html; charset=UTF-8\" /&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/head&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;body&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;form action=\"/upload\" enctype=\"multipart/form-data\" '</span>+</div><div class=\"line\">    <span class=\"string\">'method=\"post\"&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;input type=\"file\" name=\"upload\"&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;input type=\"submit\" value=\"Upload file\" /&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/form&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/body&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/html&gt;'</span>;</div><div class=\"line\"></div><div class=\"line\">    response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/html\"</span>&#125;);</div><div class=\"line\">    response.write(body);</div><div class=\"line\">    response.end();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">upload</span>(<span class=\"params\">response, postData</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'upload' was called.\"</span>);</div><div class=\"line\">  response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">  response.write(<span class=\"string\">\"You've sent the text: \"</span>+</div><div class=\"line\">  querystring.parse(postData).text);</div><div class=\"line\">  response.end();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">show</span>(<span class=\"params\">response, postData</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'show' was called.\"</span>);</div><div class=\"line\">  fs.readFile(<span class=\"string\">\"/tmp/test.png\"</span>, <span class=\"string\">\"binary\"</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">error, file</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span>(error) &#123;</div><div class=\"line\">      response.writeHead(<span class=\"number\">500</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">      response.write(error + <span class=\"string\">\"\\n\"</span>);</div><div class=\"line\">      response.end();</div><div class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">      response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"image/png\"</span>&#125;);</div><div class=\"line\">      response.write(file, <span class=\"string\">\"binary\"</span>);</div><div class=\"line\">      response.end();</div><div class=\"line\">    &#125;</div><div class=\"line\">  &#125;);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div><div class=\"line\">exports.upload = upload;</div><div class=\"line\">exports.show = show;</div></pre></td></tr></table></figure>\n<p> uploadrequestnode-formidableform.parse</p>\n<p>responsepostDatarequest </p>\n<p>postData   requestform.parseNode.js</p>\n<p>server.js  postDatarequest.setEncoding node-formidablerequest</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">\"http\"</span>);</div><div class=\"line\"><span class=\"keyword\">var</span> url = <span class=\"built_in\">require</span>(<span class=\"string\">\"url\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\">route, handle</span>) </span>&#123;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">onRequest</span>(<span class=\"params\">request, response</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> pathname = url.parse(request.url).pathname;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request for \"</span> + pathname + <span class=\"string\">\" received.\"</span>);</div><div class=\"line\">    route(handle, pathname, response, request);</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  http.createServer(onRequest).listen(<span class=\"number\">8888</span>);</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Server has started.\"</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div></pre></td></tr></table></figure>\n<p> router.js  postDatarequest</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">route</span>(<span class=\"params\">handle, pathname, response, request</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"About to route a request for \"</span> + pathname);</div><div class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> handle[pathname] === <span class=\"string\">'function'</span>) &#123;</div><div class=\"line\">    handle[pathname](response, request);</div><div class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"No request handler found for \"</span> + pathname);</div><div class=\"line\">    response.writeHead(<span class=\"number\">404</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/html\"</span>&#125;);</div><div class=\"line\">    response.write(<span class=\"string\">\"404 Not found\"</span>);</div><div class=\"line\">    response.end();</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.route = route;</div></pre></td></tr></table></figure>\n<p>requestuploadnode-formidable/tmp/tmp/test.png PNG</p>\n<p><strong>fs.renameSync(path1,path2)</strong>  </p>\n<p>requestHandlers.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> querystring = <span class=\"built_in\">require</span>(<span class=\"string\">\"querystring\"</span>),</div><div class=\"line\">    fs = <span class=\"built_in\">require</span>(<span class=\"string\">\"fs\"</span>),</div><div class=\"line\">    formidable = <span class=\"built_in\">require</span>(<span class=\"string\">\"formidable\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\">response</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'start' was called.\"</span>);</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">var</span> body = <span class=\"string\">'&lt;html&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;head&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;meta http-equiv=\"Content-Type\" content=\"text/html; '</span>+</div><div class=\"line\">    <span class=\"string\">'charset=UTF-8\" /&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/head&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;body&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;form action=\"/upload\" enctype=\"multipart/form-data\" '</span>+</div><div class=\"line\">    <span class=\"string\">'method=\"post\"&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;input type=\"file\" name=\"upload\" multiple=\"multiple\"&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;input type=\"submit\" value=\"Upload file\" /&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/form&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/body&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/html&gt;'</span>;</div><div class=\"line\"></div><div class=\"line\">    response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/html\"</span>&#125;);</div><div class=\"line\">    response.write(body);</div><div class=\"line\">    response.end();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">upload</span>(<span class=\"params\">response, request</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'upload' was called.\"</span>);</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">var</span> form = <span class=\"keyword\">new</span> formidable.IncomingForm();</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"about to parse\"</span>);</div><div class=\"line\">  form.parse(request, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">error, fields, files</span>) </span>&#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"parsing done\"</span>);</div><div class=\"line\">    fs.renameSync(files.upload.path, <span class=\"string\">\"/tmp/test.png\"</span>);</div><div class=\"line\">    response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/html\"</span>&#125;);</div><div class=\"line\">    response.write(<span class=\"string\">\"received image:&lt;br/&gt;\"</span>);</div><div class=\"line\">    response.write(<span class=\"string\">\"&lt;img src='/show' /&gt;\"</span>);</div><div class=\"line\">    response.end();</div><div class=\"line\">  &#125;);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">show</span>(<span class=\"params\">response</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'show' was called.\"</span>);</div><div class=\"line\">  fs.readFile(<span class=\"string\">\"/tmp/test.png\"</span>, <span class=\"string\">\"binary\"</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">error, file</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span>(error) &#123;</div><div class=\"line\">      response.writeHead(<span class=\"number\">500</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">      response.write(error + <span class=\"string\">\"\\n\"</span>);</div><div class=\"line\">      response.end();</div><div class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">      response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"image/png\"</span>&#125;);</div><div class=\"line\">      response.write(file, <span class=\"string\">\"binary\"</span>);</div><div class=\"line\">      response.end();</div><div class=\"line\">    &#125;</div><div class=\"line\">  &#125;);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div><div class=\"line\">exports.upload = upload;</div><div class=\"line\">exports.show = show;</div></pre></td></tr></table></figure>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Node.jsweb JavaScript</p>\n<p> Node.jsGET</p>\n<p>  </p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\"></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"external\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\" target=\"_blank\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/12/03/nodejs-learning-getting-started/\">http://agehua.github.io/2016/12/03/nodejs-learning-getting-started/</a></p>\n","readingTime":{"text":"21 min read","minutes":20.355,"time":1221300,"words":4071},"excerpt":"<blockquote>\n<p><a href=\"http://www.nodebeginner.org/index-zh-cn.html\">Node</a></p>\n</blockquote>\n<h2 id=\"Node\"><a href=\"#Node\" class=\"headerlink\" title=\"Node\"></a>Node</h2><p> Manuel Kiessling<br> goddyzhao &amp; GrayZhang &amp; MondayChen</p>\n<p>Node.jsJavaScriptHello World</p>\n<h3 id=\"JavaScript\"><a href=\"#JavaScript\" class=\"headerlink\" title=\"JavaScript\"></a>JavaScript</h3><p>JavaScriptJavaScriptJavaScriptJavaScript </p>\n<p>Node.jsJavaScript</p>","more":"<p>JavaScriptNode.jsGoogleV8GoogleChromeJavaScriptJavaScript</p>\n<p>Node.js</p>\n<p>Node.js</p>\n<p>Node.js,Node.js<a href=\"https://github.com/joyent/node/wiki/Installation\"></a></p>\n<h4 id=\"Hello-World\"><a href=\"#Hello-World\" class=\"headerlink\" title=\"Hello World\"></a>Hello World</h4><p>Node.jsHello World</p>\n<p>helloworld.jsSTDOUTHello World</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">console</span>.log(<span class=\"string\">\"Hello World\"</span>);</div></pre></td></tr></table></figure>\n<p>Node.js<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">node helloworld.js</div></pre></td></tr></table></figure></p>\n<p>Hello World </p>\n<p></p>\n<h3 id=\"Node-jsweb\"><a href=\"#Node-jsweb\" class=\"headerlink\" title=\"Node.jsweb\"></a><strong>Node.jsweb</strong></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p><br><a href=\"http://domain/start\">http://domain/start</a> <br><a href=\"http://domain/upload\">http://domain/upload</a>  <br>Google</p>\n<p>Node.js</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p>WebHTTP<br>URLrequest handler<br><br>POST<br>URL<br><br>PHPApache HTTPmod_php5<br>HTTPWebPHP</p>\n<p>Node.jsNode.jsHTTPWebWeb</p>\n<p>Node.js</p>\n<p>HTTP</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"HTTP\"><a href=\"#HTTP\" class=\"headerlink\" title=\"HTTP\"></a>HTTP</h4><p>Node.jsNode.js<br>Node.jsHTTP</p>\n<p></p>\n<p>main fileNode.js</p>\n<p>HTTP</p>\n<p>index.jsserver.js</p>\n<p>server.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">\"http\"</span>);</div><div class=\"line\"></div><div class=\"line\">http.createServer(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">request, response</span>) </span>&#123;</div><div class=\"line\">  response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">  response.write(<span class=\"string\">\"Hello World\"</span>);</div><div class=\"line\">  response.end();</div><div class=\"line\">&#125;).listen(<span class=\"number\">8888</span>);</div></pre></td></tr></table></figure>\n<p>HTTPNode.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">node server.js</div></pre></td></tr></table></figure>\n<p><a href=\"http://localhost:8888/\">http://localhost:8888/</a> Hello World</p>\n<p>HTTP</p>\n<h4 id=\"HTTP\"><a href=\"#HTTP\" class=\"headerlink\" title=\"HTTP\"></a>HTTP</h4><p>HTTP</p>\n<p>requireNode.js http  http </p>\n<p>http createServer  listen HTTP</p>\n<p> http.createServer </p>\n<p>8888<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">\"http\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> server = http.createServer();</div><div class=\"line\">server.listen(<span class=\"number\">8888</span>);</div></pre></td></tr></table></figure></p>\n<p>8888</p>\n<p>PHP createServer() </p>\n<p> createServer() JavaScript</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">say</span>(<span class=\"params\">word</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(word);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">execute</span>(<span class=\"params\">someFunction, value</span>) </span>&#123;</div><div class=\"line\">  someFunction(value);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">execute(say, <span class=\"string\">\"Hello\"</span>);</div></pre></td></tr></table></figure>\n<p> say execute say  say </p>\n<p> say execute  someFunction execute someFunction()  say </p>\n<p> say  execute  someFunction </p>\n<p></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">execute</span>(<span class=\"params\">someFunction, value</span>) </span>&#123;</div><div class=\"line\">  someFunction(value);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">execute(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">word</span>)</span>&#123; <span class=\"built_in\">console</span>.log(word) &#125;, <span class=\"string\">\"Hello\"</span>);</div></pre></td></tr></table></figure>\n<p> execute  execute </p>\n<p>  </p>\n<p>JavaScriptJavaScript</p>\n<h4 id=\"HTTP\"><a href=\"#HTTP\" class=\"headerlink\" title=\"HTTP\"></a>HTTP</h4><p>HTTP</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">\"http\"</span>);</div><div class=\"line\"></div><div class=\"line\">http.createServer(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">request, response</span>) </span>&#123;</div><div class=\"line\">  response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">  response.write(<span class=\"string\">\"Hello World\"</span>);</div><div class=\"line\">  response.end();</div><div class=\"line\">&#125;).listen(<span class=\"number\">8888</span>);</div></pre></td></tr></table></figure>\n<p> createServer </p>\n<p></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">\"http\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">onRequest</span>(<span class=\"params\">request, response</span>) </span>&#123;</div><div class=\"line\">  response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">  response.write(<span class=\"string\">\"Hello World\"</span>);</div><div class=\"line\">  response.end();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">http.createServer(onRequest).listen(<span class=\"number\">8888</span>);</div></pre></td></tr></table></figure>\n<p></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>Node.js</p>\n<p>Felix Geisendrfer<a href=\"http://debuggable.com/posts/understanding-node-js:4bd98440-45e4-4a9a-8ef7-0f7ecbdd56cb\">Understanding node.js</a></p>\n<p>Node.jsNode.jsWeb based application</p>\n<p> http.createServer HTTP</p>\n<p></p>\n<p>PHPApachePHP</p>\n<p>Node.js8888</p>\n<p>Node.js/JavaScript</p>\n<p></p>\n<p></p>\n<p>    </p>\n<p>Felix</p>\n<p>HTTP</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">\"http\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">onRequest</span>(<span class=\"params\">request, response</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request received.\"</span>);</div><div class=\"line\">  response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">  response.write(<span class=\"string\">\"Hello World\"</span>);</div><div class=\"line\">  response.end();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">http.createServer(onRequest).listen(<span class=\"number\">8888</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"built_in\">console</span>.log(<span class=\"string\">\"Server has started.\"</span>);</div></pre></td></tr></table></figure>\n<blockquote>\n<p> onRequest  console.log HTTP</p>\n</blockquote>\n<p>node server.jsServer has started.<a href=\"http://localhost:8888/\">http://localhost:8888/</a> Request received.</p>\n<p>JavaScript</p>\n<blockquote>\n<p>Request received. <a href=\"http://localhost:8888/\">http://localhost:8888/</a>  <a href=\"http://localhost:8888/favicon.ico\">http://localhost:8888/favicon.ico</a> )</p>\n</blockquote>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p> onRequest() </p>\n<p> onRequest()  request  response </p>\n<p>HTTP</p>\n<p> response.writeHead() HTTP200HTTPcontent-type response.write() HTTPHello World</p>\n<p> response.end() </p>\n<p> request </p>\n<p></p>\n<p>OK server.js HTTP index.js  server.js HTTP</p>\n<p>server.jsNode.js index.js </p>\n<p></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">\"http\"</span>);</div><div class=\"line\"></div><div class=\"line\">...</div><div class=\"line\"></div><div class=\"line\">http.createServer(...);</div></pre></td></tr></table></figure>\n<p>Node.jshttp</p>\n<p> http </p>\n<p></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> foo = <span class=\"built_in\">require</span>(<span class=\"string\">\"http\"</span>);</div><div class=\"line\"></div><div class=\"line\">...</div><div class=\"line\"></div><div class=\"line\">foo.createServer(...);</div></pre></td></tr></table></figure>\n<p>Node.js</p>\n<p> server.js </p>\n<p>  </p>\n<p>HTTP</p>\n<p> start </p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">\"http\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">onRequest</span>(<span class=\"params\">request, response</span>) </span>&#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request received.\"</span>);</div><div class=\"line\">    response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">    response.write(<span class=\"string\">\"Hello World\"</span>);</div><div class=\"line\">    response.end();</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  http.createServer(onRequest).listen(<span class=\"number\">8888</span>);</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Server has started.\"</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div></pre></td></tr></table></figure>\n<p> index.js HTTP server.js </p>\n<p> index.js </p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> server = <span class=\"built_in\">require</span>(<span class=\"string\">\"./server\"</span>);</div><div class=\"line\"></div><div class=\"line\">server.start();</div></pre></td></tr></table></figure>\n<p>server</p>\n<p></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">node index.js</div></pre></td></tr></table></figure>\n<p></p>\n<p>HTTPURL</p>\n<p> onRequest() </p>\n<p>HTTP<strong></strong></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>URLGETPOST</p>\n<p>HTTPURLGET/POSTHTTP</p>\n<p>requestonRequest()Node.JS<strong>url</strong><strong>querystring</strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">                               url.parse(string).query</div><div class=\"line\">                                           |</div><div class=\"line\">           url.parse(string).pathname      |</div><div class=\"line\">                       |                   |</div><div class=\"line\">                       |                   |</div><div class=\"line\">                     ------ -------------------</div><div class=\"line\">http:<span class=\"comment\">//localhost:8888/start?foo=bar&amp;hello=world</span></div><div class=\"line\">                                ---       -----</div><div class=\"line\">                                 |          |</div><div class=\"line\">                                 |          |</div><div class=\"line\">              querystring(string)[<span class=\"string\">\"foo\"</span>]    |</div><div class=\"line\">                                            |</div><div class=\"line\">                         querystring(string)[<span class=\"string\">\"hello\"</span>]</div></pre></td></tr></table></figure>\n<p>querystringPOST</p>\n<p>onRequest()URL</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">\"http\"</span>);</div><div class=\"line\"><span class=\"keyword\">var</span> url = <span class=\"built_in\">require</span>(<span class=\"string\">\"url\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">onRequest</span>(<span class=\"params\">request, response</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> pathname = url.parse(request.url).pathname;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request for \"</span> + pathname + <span class=\"string\">\" received.\"</span>);</div><div class=\"line\">    response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">    response.write(<span class=\"string\">\"Hello World\"</span>);</div><div class=\"line\">    response.end();</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  http.createServer(onRequest).listen(<span class=\"number\">8888</span>);</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Server has started.\"</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div></pre></td></tr></table></figure>\n<p>URLURL</p>\n<p>/start/upload</p>\n<p>router.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">route</span>(<span class=\"params\">pathname</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"About to route a request for \"</span> + pathname);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.route = route;</div></pre></td></tr></table></figure>\n<p></p>\n<p><a href=\"http://martinfowler.com/articles/injection.html\">Martin Fowlers</a></p>\n<p>start()</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">\"http\"</span>);</div><div class=\"line\"><span class=\"keyword\">var</span> url = <span class=\"built_in\">require</span>(<span class=\"string\">\"url\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\">route</span>) </span>&#123;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">onRequest</span>(<span class=\"params\">request, response</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> pathname = url.parse(request.url).pathname;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request for \"</span> + pathname + <span class=\"string\">\" received.\"</span>);</div><div class=\"line\"></div><div class=\"line\">    route(pathname);</div><div class=\"line\"></div><div class=\"line\">    response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">    response.write(<span class=\"string\">\"Hello World\"</span>);</div><div class=\"line\">    response.end();</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  http.createServer(onRequest).listen(<span class=\"number\">8888</span>);</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Server has started.\"</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div></pre></td></tr></table></figure>\n<p>index.js<br><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> server = <span class=\"built_in\">require</span>(<span class=\"string\">\"./server\"</span>);</div><div class=\"line\"><span class=\"keyword\">var</span> router = <span class=\"built_in\">require</span>(<span class=\"string\">\"./router\"</span>);</div><div class=\"line\"></div><div class=\"line\">server.start(router.route);</div></pre></td></tr></table></figure></p>\n<p></p>\n<p>node index.jsURLHTTP</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">bash$ node index.js</div><div class=\"line\">Request <span class=\"keyword\">for</span> /foo received.</div><div class=\"line\">About to route a request <span class=\"keyword\">for</span> /foo</div></pre></td></tr></table></figure>\n<p>/favicon.ico</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<p>indexrouterroute</p>\n<p></p>\n<pre><code>\n</code></pre><p></p>\n<p></p>\n<p>Steve Yegge<a href=\"http://steve-yegge.blogspot.jp/2006/03/execution-in-kingdom-of-nouns.html\"></a></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>HTTP</p>\n<p>URL/start/upload</p>\n<p></p>\n<p></p>\n<p>  requestHandlers</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'start' was called.\"</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">upload</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'upload' was called.\"</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div><div class=\"line\">exports.upload = upload;</div></pre></td></tr></table></figure>\n<p></p>\n<p>requestHandlers</p>\n<p></p>\n<p>2URLif request == x then call handler y</p>\n<p>URL<strong>associative array</strong> </p>\n<p>JavaScript  JavaScript</p>\n<p><a href=\"http://msdn.microsoft.com/en-us/magazine/cc163419.aspx\">http://msdn.microsoft.com/en-us/magazine/cc163419.aspx</a> </p>\n<blockquote>\n<p>C++C#JavaScriptJavaScript/  JavaScript</p>\n</blockquote>\n<p>JavaScript/</p>\n<p>route()</p>\n<p>index.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> server = <span class=\"built_in\">require</span>(<span class=\"string\">\"./server\"</span>);</div><div class=\"line\"><span class=\"keyword\">var</span> router = <span class=\"built_in\">require</span>(<span class=\"string\">\"./router\"</span>);</div><div class=\"line\"><span class=\"keyword\">var</span> requestHandlers = <span class=\"built_in\">require</span>(<span class=\"string\">\"./requestHandlers\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> handle = &#123;&#125;</div><div class=\"line\">handle[<span class=\"string\">\"/\"</span>] = requestHandlers.start;</div><div class=\"line\">handle[<span class=\"string\">\"/start\"</span>] = requestHandlers.start;</div><div class=\"line\">handle[<span class=\"string\">\"/upload\"</span>] = requestHandlers.upload;</div><div class=\"line\"></div><div class=\"line\">server.start(router.route, handle);</div></pre></td></tr></table></figure>\n<p>handle</p>\n<p>URL/requestHandlers.start/start/start</p>\n<p>server.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">\"http\"</span>);</div><div class=\"line\"><span class=\"keyword\">var</span> url = <span class=\"built_in\">require</span>(<span class=\"string\">\"url\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\">route, handle</span>) </span>&#123;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">onRequest</span>(<span class=\"params\">request, response</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> pathname = url.parse(request.url).pathname;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request for \"</span> + pathname + <span class=\"string\">\" received.\"</span>);</div><div class=\"line\"></div><div class=\"line\">    route(handle, pathname);</div><div class=\"line\"></div><div class=\"line\">    response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">    response.write(<span class=\"string\">\"Hello World\"</span>);</div><div class=\"line\">    response.end();</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  http.createServer(onRequest).listen(<span class=\"number\">8888</span>);</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Server has started.\"</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div></pre></td></tr></table></figure>\n<p>start()handlehandleroute()</p>\n<p>route.jsroute()</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">route</span>(<span class=\"params\">handle, pathname</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"About to route a request for \"</span> + pathname);</div><div class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> handle[pathname] === <span class=\"string\">'function'</span>) &#123;</div><div class=\"line\">    handle[pathname]();</div><div class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"No request handler found for \"</span> + pathname);</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.route = route;</div></pre></td></tr></table></figure>\n<p>handle<a href=\"\">pathname</a>;</p>\n<p><a href=\"http://localhost:8888/start\">http://localhost:8888/start</a></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">Server has started.</div><div class=\"line\">Request <span class=\"keyword\">for</span> /start received.</div><div class=\"line\">About to route a request <span class=\"keyword\">for</span> /start</div><div class=\"line\">Request handler <span class=\"string\">'start'</span> was called.</div></pre></td></tr></table></figure>\n<p><a href=\"http://localhost:8888/start\">http://localhost:8888/start</a></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">Request <span class=\"keyword\">for</span> / received.</div><div class=\"line\">About to route a request <span class=\"keyword\">for</span> /</div><div class=\"line\">Request handler <span class=\"string\">'start'</span> was called.</div></pre></td></tr></table></figure>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>Hello World</p>\n<p>Hello Worldserver.jsonRequest</p>\n<p>onRequest</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>PHPRuby </p>\n<p>onRequestreturn()</p>\n<p></p>\n<p>requestHandler.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'start' was called.\"</span>);</div><div class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">\"Hello Start\"</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">upload</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'upload' was called.\"</span>);</div><div class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">\"Hello Upload\"</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div><div class=\"line\">exports.upload = upload;</div></pre></td></tr></table></figure>\n<p>router.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">route</span>(<span class=\"params\">handle, pathname</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"About to route a request for \"</span> + pathname);</div><div class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> handle[pathname] === <span class=\"string\">'function'</span>) &#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> handle[pathname]();</div><div class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"No request handler found for \"</span> + pathname);</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">\"404 Not found\"</span>;</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.route = route;</div></pre></td></tr></table></figure>\n<p></p>\n<p>server.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">\"http\"</span>);</div><div class=\"line\"><span class=\"keyword\">var</span> url = <span class=\"built_in\">require</span>(<span class=\"string\">\"url\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\">route, handle</span>) </span>&#123;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">onRequest</span>(<span class=\"params\">request, response</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> pathname = url.parse(request.url).pathname;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request for \"</span> + pathname + <span class=\"string\">\" received.\"</span>);</div><div class=\"line\"></div><div class=\"line\">    response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">    <span class=\"keyword\">var</span> content = route(handle, pathname)</div><div class=\"line\">    response.write(content);</div><div class=\"line\">    response.end();</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  http.createServer(onRequest).listen(<span class=\"number\">8888</span>);</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Server has started.\"</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div></pre></td></tr></table></figure>\n<p><a href=\"http://localhost:8888/start\">http://localhost:8888/start</a>, Hello Start<a href=\"http://localhost:8888/upload\">http://localhost:8888/upload</a> Hello Upload,<a href=\"http://localhost:8888/foo\">http://localhost:8888/foo</a> 404 Not found</p>\n<p> <strong></strong></p>\n<p></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<p></p>\n<p>start10Hello StartJavaScriptsleep()Hack</p>\n<p>requestHandlers.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'start' was called.\"</span>);</div><div class=\"line\"></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">sleep</span>(<span class=\"params\">milliSeconds</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> startTime = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().getTime();</div><div class=\"line\">    <span class=\"keyword\">while</span> (<span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().getTime() &lt; startTime + milliSeconds);</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  sleep(<span class=\"number\">10000</span>);</div><div class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">\"Hello Start\"</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">upload</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'upload' was called.\"</span>);</div><div class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">\"Hello Upload\"</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div><div class=\"line\">exports.upload = upload;</div></pre></td></tr></table></figure>\n<p>start()Node.js10Hello Startupload()</p>\n<blockquote>\n<p>10</p>\n</blockquote>\n<p></p>\n<p> <a href=\"http://localhost:8888/start\">http://localhost:8888/start</a> </p>\n<p><a href=\"http://localhost:8888/upload\">http://localhost:8888/upload</a> </p>\n<p>/start/upload</p>\n<p> /start URL10/upload URL10sleep()</p>\n<p>start()<strong></strong></p>\n<p>Nodenode</p>\n<p><strong>Node.js</strong>  Node.jsevent loop  </p>\n<p>10</p>\n<p>Node.jsprobablyExpensiveFunction()Node.jscallbackFunction()</p>\n<p>Mixu<a href=\"http://blog.mixu.net/2011/02/01/understanding-the-node-js-event-loop/\">node.js</a></p>\n<p><strong></strong></p>\n<p></p>\n<p>start</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> exec = <span class=\"built_in\">require</span>(<span class=\"string\">\"child_process\"</span>).exec;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'start' was called.\"</span>);</div><div class=\"line\">  <span class=\"keyword\">var</span> content = <span class=\"string\">\"empty\"</span>;</div><div class=\"line\"></div><div class=\"line\">  exec(<span class=\"string\">\"ls -lah\"</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">error, stdout, stderr</span>) </span>&#123;</div><div class=\"line\">    content = stdout;</div><div class=\"line\">  &#125;);</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">return</span> content;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">upload</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'upload' was called.\"</span>);</div><div class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">\"Hello Upload\"</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div><div class=\"line\">exports.upload = upload;</div></pre></td></tr></table></figure>\n<p>Node.js<strong>child_process</strong><strong>exec()</strong></p>\n<p>exec()Node.jsshellls -lah,/startURL</p>\n<p> contentemptyls -lahcontentcontent</p>\n<p><a href=\"http://localhost:8888/start\">http://localhost:8888/start</a> </p>\n<p>webempty</p>\n<p>exec()shell</p>\n<blockquote>\n<p>ls -lahfind /</p>\n</blockquote>\n<p></p>\n<p></p>\n<p>exec()</p>\n<p>exec()</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">error, stdout, stderr</span>) </span>&#123;</div><div class=\"line\">  content = stdout;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>exec()Node.js return content contentemptyexec()exec()</p>\n<p>ls -lah  </p>\n<p> find /1ls -lahfind //start URLHTTP  exec()Node.jsexec()find /</p>\n<p></p>\n<p></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>  </p>\n<p>Node.js <strong></strong></p>\n<p> -&gt;  -&gt; HTTP</p>\n<p><strong></strong> responseonRequest() </p>\n<p></p>\n<p>server.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">\"http\"</span>);</div><div class=\"line\"><span class=\"keyword\">var</span> url = <span class=\"built_in\">require</span>(<span class=\"string\">\"url\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\">route, handle</span>) </span>&#123;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">onRequest</span>(<span class=\"params\">request, response</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> pathname = url.parse(request.url).pathname;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request for \"</span> + pathname + <span class=\"string\">\" received.\"</span>);</div><div class=\"line\"></div><div class=\"line\">    route(handle, pathname, response);</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  http.createServer(onRequest).listen(<span class=\"number\">8888</span>);</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Server has started.\"</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div></pre></td></tr></table></figure>\n<p>route()responseroute()onRequest()responseroute()</p>\n<p>router.js:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">route</span>(<span class=\"params\">handle, pathname, response</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"About to route a request for \"</span> + pathname);</div><div class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> handle[pathname] === <span class=\"string\">'function'</span>) &#123;</div><div class=\"line\">    handle[pathname](response);</div><div class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"No request handler found for \"</span> + pathname);</div><div class=\"line\">    response.writeHead(<span class=\"number\">404</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">    response.write(<span class=\"string\">\"404 Not found\"</span>);</div><div class=\"line\">    response.end();</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.route = route;</div></pre></td></tr></table></figure>\n<p>response</p>\n<p>404</p>\n<p>requestHandler.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> exec = <span class=\"built_in\">require</span>(<span class=\"string\">\"child_process\"</span>).exec;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\">response</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'start' was called.\"</span>);</div><div class=\"line\"></div><div class=\"line\">  exec(<span class=\"string\">\"ls -lah\"</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">error, stdout, stderr</span>) </span>&#123;</div><div class=\"line\">    response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">    response.write(stdout);</div><div class=\"line\">    response.end();</div><div class=\"line\">  &#125;);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">upload</span>(<span class=\"params\">response</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'upload' was called.\"</span>);</div><div class=\"line\">  response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">  response.write(<span class=\"string\">\"Hello Upload\"</span>);</div><div class=\"line\">  response.end();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div><div class=\"line\">exports.upload = upload;</div></pre></td></tr></table></figure>\n<p>response</p>\n<p>startexec()uploadHello Worldresponse</p>\n<p>node index.js</p>\n<p>/start/uploadrequestHandlers.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> exec = <span class=\"built_in\">require</span>(<span class=\"string\">\"child_process\"</span>).exec;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\">response</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'start' was called.\"</span>);</div><div class=\"line\"></div><div class=\"line\">  exec(<span class=\"string\">\"find /\"</span>,</div><div class=\"line\">    &#123; <span class=\"attr\">timeout</span>: <span class=\"number\">10000</span>, <span class=\"attr\">maxBuffer</span>: <span class=\"number\">20000</span>*<span class=\"number\">1024</span> &#125;,</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">error, stdout, stderr</span>) </span>&#123;</div><div class=\"line\">      response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">      response.write(stdout);</div><div class=\"line\">      response.end();</div><div class=\"line\">    &#125;);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">upload</span>(<span class=\"params\">response</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'upload' was called.\"</span>);</div><div class=\"line\">  response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">  response.write(<span class=\"string\">\"Hello Upload\"</span>);</div><div class=\"line\">  response.end();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div><div class=\"line\">exports.upload = upload;</div></pre></td></tr></table></figure>\n<p><a href=\"http://localhost:8888/start\">http://localhost:8888/start</a> 10<a href=\"http://localhost:8888/upload\">http://localhost:8888/upload</a> /start</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<p> </p>\n<p>JavaScript</p>\n<p> POSTNode.js</p>\n<p>Node.jsPOST<br>Node.jsmultipart POST</p>\n<h4 id=\"POST\"><a href=\"#POST\" class=\"headerlink\" title=\"POST\"></a>POST</h4><p>textareaPOST</p>\n<p>/startrequestHandlers.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\">response</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'start' was called.\"</span>);</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">var</span> body = <span class=\"string\">'&lt;html&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;head&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;meta http-equiv=\"Content-Type\" content=\"text/html; '</span>+</div><div class=\"line\">    <span class=\"string\">'charset=UTF-8\" /&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/head&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;body&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;form action=\"/upload\" method=\"post\"&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;textarea name=\"text\" rows=\"20\" cols=\"60\"&gt;&lt;/textarea&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;input type=\"submit\" value=\"Submit text\" /&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/form&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/body&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/html&gt;'</span>;</div><div class=\"line\"></div><div class=\"line\">    response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/html\"</span>&#125;);</div><div class=\"line\">    response.write(body);</div><div class=\"line\">    response.end();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">upload</span>(<span class=\"params\">response</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'upload' was called.\"</span>);</div><div class=\"line\">  response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">  response.write(<span class=\"string\">\"Hello Upload\"</span>);</div><div class=\"line\">  response.end();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div><div class=\"line\">exports.upload = upload;</div></pre></td></tr></table></figure>\n<p>Webby Awards<a href=\"http://localhost:8888/start\">http://localhost:8888/start</a> </p>\n<p>MVCJavaScriptNode.js</p>\n<p> /uploadPOST</p>\n<p>POST</p>\n<p>POST  </p>\n<p>Node.jsPOST<strong>data</strong><strong>end</strong></p>\n<p>Node.js request<strong>listener</strong> requestHTTPonRequest</p>\n<p></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">request.addListener(<span class=\"string\">\"data\"</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">chunk</span>) </span>&#123;</div><div class=\"line\">  <span class=\"comment\">// called when a new chunk of data was received</span></div><div class=\"line\">&#125;);</div><div class=\"line\"></div><div class=\"line\">request.addListener(<span class=\"string\">\"end\"</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">  <span class=\"comment\">// called when all chunks of data have been received</span></div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure>\n<p> request  response request </p>\n<p>HTTPPOST</p>\n<p> dataenddataPOSTend</p>\n<p>server.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">\"http\"</span>);</div><div class=\"line\"><span class=\"keyword\">var</span> url = <span class=\"built_in\">require</span>(<span class=\"string\">\"url\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\">route, handle</span>) </span>&#123;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">onRequest</span>(<span class=\"params\">request, response</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> postData = <span class=\"string\">\"\"</span>;</div><div class=\"line\">    <span class=\"keyword\">var</span> pathname = url.parse(request.url).pathname;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request for \"</span> + pathname + <span class=\"string\">\" received.\"</span>);</div><div class=\"line\"></div><div class=\"line\">    request.setEncoding(<span class=\"string\">\"utf8\"</span>);</div><div class=\"line\"></div><div class=\"line\">    request.addListener(<span class=\"string\">\"data\"</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">postDataChunk</span>) </span>&#123;</div><div class=\"line\">      postData += postDataChunk;</div><div class=\"line\">      <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Received POST data chunk '\"</span>+</div><div class=\"line\">      postDataChunk + <span class=\"string\">\"'.\"</span>);</div><div class=\"line\">    &#125;);</div><div class=\"line\"></div><div class=\"line\">    request.addListener(<span class=\"string\">\"end\"</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">      route(handle, pathname, response, postData);</div><div class=\"line\">    &#125;);</div><div class=\"line\"></div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  http.createServer(onRequest).listen(<span class=\"number\">8888</span>);</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Server has started.\"</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div></pre></td></tr></table></figure>\n<p> UTF-8datapostData end<strong></strong>POST</p>\n<p></p>\n<p>data</p>\n<p>/uploadpostDatarouter.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">route</span>(<span class=\"params\">handle, pathname, response, postData</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"About to route a request for \"</span> + pathname);</div><div class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> handle[pathname] === <span class=\"string\">'function'</span>) &#123;</div><div class=\"line\">    handle[pathname](response, postData);</div><div class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"No request handler found for \"</span> + pathname);</div><div class=\"line\">    response.writeHead(<span class=\"number\">404</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">    response.write(<span class=\"string\">\"404 Not found\"</span>);</div><div class=\"line\">    response.end();</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.route = route;</div></pre></td></tr></table></figure>\n<p>requestHandlers.jsupload</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\">response, postData</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'start' was called.\"</span>);</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">var</span> body = <span class=\"string\">'&lt;html&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;head&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;meta http-equiv=\"Content-Type\" content=\"text/html; '</span>+</div><div class=\"line\">    <span class=\"string\">'charset=UTF-8\" /&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/head&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;body&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;form action=\"/upload\" method=\"post\"&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;textarea name=\"text\" rows=\"20\" cols=\"60\"&gt;&lt;/textarea&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;input type=\"submit\" value=\"Submit text\" /&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/form&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/body&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/html&gt;'</span>;</div><div class=\"line\"></div><div class=\"line\">    response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/html\"</span>&#125;);</div><div class=\"line\">    response.write(body);</div><div class=\"line\">    response.end();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">upload</span>(<span class=\"params\">response, postData</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'upload' was called.\"</span>);</div><div class=\"line\">  response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">  response.write(<span class=\"string\">\"You've sent: \"</span> + postData);</div><div class=\"line\">  response.end();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div><div class=\"line\">exports.upload = upload;</div></pre></td></tr></table></figure>\n<p>POST</p>\n<p> POSTtext</p>\n<p>querystring</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> querystring = <span class=\"built_in\">require</span>(<span class=\"string\">\"querystring\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\">response, postData</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'start' was called.\"</span>);</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">var</span> body = <span class=\"string\">'&lt;html&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;head&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;meta http-equiv=\"Content-Type\" content=\"text/html; '</span>+</div><div class=\"line\">    <span class=\"string\">'charset=UTF-8\" /&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/head&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;body&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;form action=\"/upload\" method=\"post\"&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;textarea name=\"text\" rows=\"20\" cols=\"60\"&gt;&lt;/textarea&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;input type=\"submit\" value=\"Submit text\" /&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/form&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/body&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/html&gt;'</span>;</div><div class=\"line\"></div><div class=\"line\">    response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/html\"</span>&#125;);</div><div class=\"line\">    response.write(body);</div><div class=\"line\">    response.end();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">upload</span>(<span class=\"params\">response, postData</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'upload' was called.\"</span>);</div><div class=\"line\">  response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">  response.write(<span class=\"string\">\"You've sent the text: \"</span>+</div><div class=\"line\">  querystring.parse(postData).text);</div><div class=\"line\">  response.end();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div><div class=\"line\">exports.upload = upload;</div></pre></td></tr></table></figure>\n<p>POST</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<p>90IPO Node.js</p>\n<p>Felix Geisendrfer<strong>node-formidable</strong> POST  </p>\n<p>Node.jsNPMNode.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">npm install formidable</div></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">npm info build Success: formidable@<span class=\"number\">1.0</span><span class=\"number\">.9</span></div><div class=\"line\">npm ok</div></pre></td></tr></table></figure>\n<p></p>\n<p>formidablerequire</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> formidable = <span class=\"built_in\">require</span>(<span class=\"string\">\"formidable\"</span>);</div></pre></td></tr></table></figure>\n<p>HTTP POSTNode.jsIncomingFormrequest</p>\n<p>node-formidable</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> formidable = <span class=\"built_in\">require</span>(<span class=\"string\">'formidable'</span>),</div><div class=\"line\">    http = <span class=\"built_in\">require</span>(<span class=\"string\">'http'</span>),</div><div class=\"line\">    util = <span class=\"built_in\">require</span>(<span class=\"string\">'util'</span>);</div><div class=\"line\"></div><div class=\"line\">http.createServer(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">req, res</span>) </span>&#123;</div><div class=\"line\">  <span class=\"keyword\">if</span> (req.url == <span class=\"string\">'/upload'</span> &amp;&amp; req.method.toLowerCase() == <span class=\"string\">'post'</span>) &#123;</div><div class=\"line\">    <span class=\"comment\">// parse a file upload</span></div><div class=\"line\">    <span class=\"keyword\">var</span> form = <span class=\"keyword\">new</span> formidable.IncomingForm();</div><div class=\"line\">    form.parse(req, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">err, fields, files</span>) </span>&#123;</div><div class=\"line\">      res.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">'content-type'</span>: <span class=\"string\">'text/plain'</span>&#125;);</div><div class=\"line\">      res.write(<span class=\"string\">'received upload:\\n\\n'</span>);</div><div class=\"line\">      res.end(util.inspect(&#123;<span class=\"attr\">fields</span>: fields, <span class=\"attr\">files</span>: files&#125;));</div><div class=\"line\">    &#125;);</div><div class=\"line\">    <span class=\"keyword\">return</span>;</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"comment\">// show a file upload form</span></div><div class=\"line\">  res.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">'content-type'</span>: <span class=\"string\">'text/html'</span>&#125;);</div><div class=\"line\">  res.end(</div><div class=\"line\">    <span class=\"string\">'&lt;form action=\"/upload\" enctype=\"multipart/form-data\" '</span>+</div><div class=\"line\">    <span class=\"string\">'method=\"post\"&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;input type=\"text\" name=\"title\"&gt;&lt;br&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;input type=\"file\" name=\"upload\" multiple=\"multiple\"&gt;&lt;br&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;input type=\"submit\" value=\"Upload\"&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/form&gt;'</span></div><div class=\"line\">  );</div><div class=\"line\">&#125;).listen(<span class=\"number\">8888</span>);</div></pre></td></tr></table></figure>\n<p>nodeform.parsefiles</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\">received upload:</div><div class=\"line\"></div><div class=\"line\">&#123; <span class=\"attr\">fields</span>: &#123; <span class=\"attr\">title</span>: <span class=\"string\">'Hello World'</span> &#125;,</div><div class=\"line\">  <span class=\"attr\">files</span>:</div><div class=\"line\">   &#123; <span class=\"attr\">upload</span>:</div><div class=\"line\">      &#123; <span class=\"attr\">size</span>: <span class=\"number\">1558</span>,</div><div class=\"line\">        <span class=\"attr\">path</span>: <span class=\"string\">'/tmp/1c747974a27a6292743669e91f29350b'</span>,</div><div class=\"line\">        <span class=\"attr\">name</span>: <span class=\"string\">'us-flag.png'</span>,</div><div class=\"line\">        <span class=\"attr\">type</span>: <span class=\"string\">'image/png'</span>,</div><div class=\"line\">        <span class=\"attr\">lastModifiedDate</span>: Tue, <span class=\"number\">21</span> Jun <span class=\"number\">2011</span> <span class=\"number\">07</span>:<span class=\"number\">02</span>:<span class=\"number\">41</span> GMT,</div><div class=\"line\">        <span class=\"attr\">_writeStream</span>: [<span class=\"built_in\">Object</span>],</div><div class=\"line\">        <span class=\"attr\">length</span>: [Getter],</div><div class=\"line\">        <span class=\"attr\">filename</span>: [Getter],</div><div class=\"line\">        <span class=\"attr\">mime</span>: [Getter] &#125; &#125; &#125;</div></pre></td></tr></table></figure>\n<p>/tmp</p>\n<p> </p>\n<p><strong>fs</strong></p>\n<p>/showURL/tmp/test.png</p>\n<p>requestHandlers.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> querystring = <span class=\"built_in\">require</span>(<span class=\"string\">\"querystring\"</span>),</div><div class=\"line\">    fs = <span class=\"built_in\">require</span>(<span class=\"string\">\"fs\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\">response, postData</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'start' was called.\"</span>);</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">var</span> body = <span class=\"string\">'&lt;html&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;head&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;meta http-equiv=\"Content-Type\" '</span>+</div><div class=\"line\">    <span class=\"string\">'content=\"text/html; charset=UTF-8\" /&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/head&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;body&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;form action=\"/upload\" method=\"post\"&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;textarea name=\"text\" rows=\"20\" cols=\"60\"&gt;&lt;/textarea&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;input type=\"submit\" value=\"Submit text\" /&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/form&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/body&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/html&gt;'</span>;</div><div class=\"line\"></div><div class=\"line\">    response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/html\"</span>&#125;);</div><div class=\"line\">    response.write(body);</div><div class=\"line\">    response.end();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">upload</span>(<span class=\"params\">response, postData</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'upload' was called.\"</span>);</div><div class=\"line\">  response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">  response.write(<span class=\"string\">\"You've sent the text: \"</span>+</div><div class=\"line\">  querystring.parse(postData).text);</div><div class=\"line\">  response.end();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">show</span>(<span class=\"params\">response, postData</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'show' was called.\"</span>);</div><div class=\"line\">  fs.readFile(<span class=\"string\">\"/tmp/test.png\"</span>, <span class=\"string\">\"binary\"</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">error, file</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span>(error) &#123;</div><div class=\"line\">      response.writeHead(<span class=\"number\">500</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">      response.write(error + <span class=\"string\">\"\\n\"</span>);</div><div class=\"line\">      response.end();</div><div class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">      response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"image/png\"</span>&#125;);</div><div class=\"line\">      response.write(file, <span class=\"string\">\"binary\"</span>);</div><div class=\"line\">      response.end();</div><div class=\"line\">    &#125;</div><div class=\"line\">  &#125;);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div><div class=\"line\">exports.upload = upload;</div><div class=\"line\">exports.show = show;</div></pre></td></tr></table></figure>\n<p>index.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> server = <span class=\"built_in\">require</span>(<span class=\"string\">\"./server\"</span>);</div><div class=\"line\"><span class=\"keyword\">var</span> router = <span class=\"built_in\">require</span>(<span class=\"string\">\"./router\"</span>);</div><div class=\"line\"><span class=\"keyword\">var</span> requestHandlers = <span class=\"built_in\">require</span>(<span class=\"string\">\"./requestHandlers\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> handle = &#123;&#125;</div><div class=\"line\">handle[<span class=\"string\">\"/\"</span>] = requestHandlers.start;</div><div class=\"line\">handle[<span class=\"string\">\"/start\"</span>] = requestHandlers.start;</div><div class=\"line\">handle[<span class=\"string\">\"/upload\"</span>] = requestHandlers.upload;</div><div class=\"line\">handle[<span class=\"string\">\"/show\"</span>] = requestHandlers.show;</div><div class=\"line\"></div><div class=\"line\">server.start(router.route, handle);</div></pre></td></tr></table></figure>\n<p><a href=\"http://localhost:8888/show/tmp/test.png\">http://localhost:8888/show/tmp/test.png</a></p>\n<p></p>\n<ul>\n<li>/start</li>\n<li>node-formidableupload/tmp/test.png</li>\n<li>/uploadURLHTML</li>\n</ul>\n<p>HTMLmultipart/form-dataUpload file requestHandler.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> querystring = <span class=\"built_in\">require</span>(<span class=\"string\">\"querystring\"</span>),</div><div class=\"line\">    fs = <span class=\"built_in\">require</span>(<span class=\"string\">\"fs\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\">response, postData</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'start' was called.\"</span>);</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">var</span> body = <span class=\"string\">'&lt;html&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;head&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;meta http-equiv=\"Content-Type\" '</span>+</div><div class=\"line\">    <span class=\"string\">'content=\"text/html; charset=UTF-8\" /&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/head&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;body&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;form action=\"/upload\" enctype=\"multipart/form-data\" '</span>+</div><div class=\"line\">    <span class=\"string\">'method=\"post\"&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;input type=\"file\" name=\"upload\"&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;input type=\"submit\" value=\"Upload file\" /&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/form&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/body&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/html&gt;'</span>;</div><div class=\"line\"></div><div class=\"line\">    response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/html\"</span>&#125;);</div><div class=\"line\">    response.write(body);</div><div class=\"line\">    response.end();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">upload</span>(<span class=\"params\">response, postData</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'upload' was called.\"</span>);</div><div class=\"line\">  response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">  response.write(<span class=\"string\">\"You've sent the text: \"</span>+</div><div class=\"line\">  querystring.parse(postData).text);</div><div class=\"line\">  response.end();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">show</span>(<span class=\"params\">response, postData</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'show' was called.\"</span>);</div><div class=\"line\">  fs.readFile(<span class=\"string\">\"/tmp/test.png\"</span>, <span class=\"string\">\"binary\"</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">error, file</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span>(error) &#123;</div><div class=\"line\">      response.writeHead(<span class=\"number\">500</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">      response.write(error + <span class=\"string\">\"\\n\"</span>);</div><div class=\"line\">      response.end();</div><div class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">      response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"image/png\"</span>&#125;);</div><div class=\"line\">      response.write(file, <span class=\"string\">\"binary\"</span>);</div><div class=\"line\">      response.end();</div><div class=\"line\">    &#125;</div><div class=\"line\">  &#125;);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div><div class=\"line\">exports.upload = upload;</div><div class=\"line\">exports.show = show;</div></pre></td></tr></table></figure>\n<p> uploadrequestnode-formidableform.parse</p>\n<p>responsepostDatarequest </p>\n<p>postData   requestform.parseNode.js</p>\n<p>server.js  postDatarequest.setEncoding node-formidablerequest</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">\"http\"</span>);</div><div class=\"line\"><span class=\"keyword\">var</span> url = <span class=\"built_in\">require</span>(<span class=\"string\">\"url\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\">route, handle</span>) </span>&#123;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">onRequest</span>(<span class=\"params\">request, response</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> pathname = url.parse(request.url).pathname;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request for \"</span> + pathname + <span class=\"string\">\" received.\"</span>);</div><div class=\"line\">    route(handle, pathname, response, request);</div><div class=\"line\">  &#125;</div><div class=\"line\"></div><div class=\"line\">  http.createServer(onRequest).listen(<span class=\"number\">8888</span>);</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Server has started.\"</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div></pre></td></tr></table></figure>\n<p> router.js  postDatarequest</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">route</span>(<span class=\"params\">handle, pathname, response, request</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"About to route a request for \"</span> + pathname);</div><div class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> handle[pathname] === <span class=\"string\">'function'</span>) &#123;</div><div class=\"line\">    handle[pathname](response, request);</div><div class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"No request handler found for \"</span> + pathname);</div><div class=\"line\">    response.writeHead(<span class=\"number\">404</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/html\"</span>&#125;);</div><div class=\"line\">    response.write(<span class=\"string\">\"404 Not found\"</span>);</div><div class=\"line\">    response.end();</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.route = route;</div></pre></td></tr></table></figure>\n<p>requestuploadnode-formidable/tmp/tmp/test.png PNG</p>\n<p><strong>fs.renameSync(path1,path2)</strong>  </p>\n<p>requestHandlers.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> querystring = <span class=\"built_in\">require</span>(<span class=\"string\">\"querystring\"</span>),</div><div class=\"line\">    fs = <span class=\"built_in\">require</span>(<span class=\"string\">\"fs\"</span>),</div><div class=\"line\">    formidable = <span class=\"built_in\">require</span>(<span class=\"string\">\"formidable\"</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\">response</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'start' was called.\"</span>);</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">var</span> body = <span class=\"string\">'&lt;html&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;head&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;meta http-equiv=\"Content-Type\" content=\"text/html; '</span>+</div><div class=\"line\">    <span class=\"string\">'charset=UTF-8\" /&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/head&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;body&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;form action=\"/upload\" enctype=\"multipart/form-data\" '</span>+</div><div class=\"line\">    <span class=\"string\">'method=\"post\"&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;input type=\"file\" name=\"upload\" multiple=\"multiple\"&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;input type=\"submit\" value=\"Upload file\" /&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/form&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/body&gt;'</span>+</div><div class=\"line\">    <span class=\"string\">'&lt;/html&gt;'</span>;</div><div class=\"line\"></div><div class=\"line\">    response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/html\"</span>&#125;);</div><div class=\"line\">    response.write(body);</div><div class=\"line\">    response.end();</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">upload</span>(<span class=\"params\">response, request</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'upload' was called.\"</span>);</div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">var</span> form = <span class=\"keyword\">new</span> formidable.IncomingForm();</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"about to parse\"</span>);</div><div class=\"line\">  form.parse(request, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">error, fields, files</span>) </span>&#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"parsing done\"</span>);</div><div class=\"line\">    fs.renameSync(files.upload.path, <span class=\"string\">\"/tmp/test.png\"</span>);</div><div class=\"line\">    response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/html\"</span>&#125;);</div><div class=\"line\">    response.write(<span class=\"string\">\"received image:&lt;br/&gt;\"</span>);</div><div class=\"line\">    response.write(<span class=\"string\">\"&lt;img src='/show' /&gt;\"</span>);</div><div class=\"line\">    response.end();</div><div class=\"line\">  &#125;);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">show</span>(<span class=\"params\">response</span>) </span>&#123;</div><div class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Request handler 'show' was called.\"</span>);</div><div class=\"line\">  fs.readFile(<span class=\"string\">\"/tmp/test.png\"</span>, <span class=\"string\">\"binary\"</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">error, file</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span>(error) &#123;</div><div class=\"line\">      response.writeHead(<span class=\"number\">500</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"text/plain\"</span>&#125;);</div><div class=\"line\">      response.write(error + <span class=\"string\">\"\\n\"</span>);</div><div class=\"line\">      response.end();</div><div class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">      response.writeHead(<span class=\"number\">200</span>, &#123;<span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"image/png\"</span>&#125;);</div><div class=\"line\">      response.write(file, <span class=\"string\">\"binary\"</span>);</div><div class=\"line\">      response.end();</div><div class=\"line\">    &#125;</div><div class=\"line\">  &#125;);</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">exports.start = start;</div><div class=\"line\">exports.upload = upload;</div><div class=\"line\">exports.show = show;</div></pre></td></tr></table></figure>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Node.jsweb JavaScript</p>\n<p> Node.jsGET</p>\n<p>  </p>\n<hr>\n<div style=\"width:690.45px\"><div style=\"display:inline-block;width:110px\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"><img style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/2.5/cn/88x31.png\" /></a></div><div style=\"display:inline-block;width:580px;\"><br>    <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/2.5/cn/\"> 2.5 </a><a href=\"https://agehua.github.io/\">Agehuas Blog</a></div></div>\n\n<p><a href=\"http://agehua.github.io/2016/12/03/nodejs-learning-getting-started/\">http://agehua.github.io/2016/12/03/nodejs-learning-getting-started/</a></p>"}],"PostAsset":[],"PostCategory":[{"post_id":"cjaw7ebvs0009d6yktahbspes","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ebw9000ed6yketuiptvq"},{"post_id":"cjaw7ebuy0002d6yk1k3u5h9m","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ebwj000id6yk9c6z1ng6"},{"post_id":"cjaw7ebvw000ad6yk14yre00n","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ebwo000ld6ykefx9bqlb"},{"post_id":"cjaw7ebw2000dd6yklg3an2hg","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ebwx000pd6yk1se3i86f"},{"post_id":"cjaw7ebv50004d6ykpui4ccos","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ebx0000rd6yk5ugnhrb6"},{"post_id":"cjaw7ebwb000fd6ykr7v031ya","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ebx8000td6ykvx3iasmr"},{"post_id":"cjaw7ebwl000jd6ykedf1baiw","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ebxb000wd6ykfrzm5efd"},{"post_id":"cjaw7ebvo0008d6yk6b8vzqxl","category_id":"cjaw7ebwd000gd6yktaurin3d","_id":"cjaw7ebxe000yd6ykxhuida6f"},{"post_id":"cjaw7ebwo000md6ykzt5r5bpr","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ebxh0012d6ykm2qtegzd"},{"post_id":"cjaw7ebwx000qd6ykm6a060j6","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ebxn0015d6ykgkb1t4mm"},{"post_id":"cjaw7ebx1000sd6ykxpy1fxsm","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ebxq0019d6ykj9hxnjf6"},{"post_id":"cjaw7ebx8000vd6yk88dz51lz","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ebxx001dd6ykvq6idawx"},{"post_id":"cjaw7ebxf000zd6ykcgubw7g7","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7eby6001hd6ykc114rqmh"},{"post_id":"cjaw7ebxo0017d6yk943ra445","category_id":"cjaw7ebxh0011d6ykvpmfiasa","_id":"cjaw7ebyd001kd6ykl0h1bmpc"},{"post_id":"cjaw7ebxc000xd6ykek6dssmh","category_id":"cjaw7ebxh0011d6ykvpmfiasa","_id":"cjaw7ebyk001nd6ykdf9tv46k"},{"post_id":"cjaw7ebxr001bd6yk8m389gx8","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ebyp001rd6yklbvfct46"},{"post_id":"cjaw7ebxy001fd6ykge65rgq0","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ebyv001ud6ykifnuh7ip"},{"post_id":"cjaw7ebxi0014d6ykplzczbw9","category_id":"cjaw7ebxh0011d6ykvpmfiasa","_id":"cjaw7ebz2001xd6ykv1viz1ff"},{"post_id":"cjaw7eby8001id6ykckgrycuh","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ebz80020d6ykwms704zj"},{"post_id":"cjaw7ebyd001ld6ykts3mjggy","category_id":"cjaw7ebxh0011d6ykvpmfiasa","_id":"cjaw7ebzb0024d6ykzl151sb0"},{"post_id":"cjaw7ebym001pd6ykdeokmvms","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ebzg0027d6ykvj7udaaq"},{"post_id":"cjaw7ebys001sd6ykew0aco4p","category_id":"cjaw7ebxh0011d6ykvpmfiasa","_id":"cjaw7ebzl002bd6yks7i0haca"},{"post_id":"cjaw7ebyx001vd6yk1k19obak","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ebzs002ed6yk1g9tmv8u"},{"post_id":"cjaw7ebz3001yd6ykf5kdyo3u","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ebzv002hd6ykth99swxq"},{"post_id":"cjaw7ebz80021d6ykyugil0ez","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ec00002ld6ykmod9feg7"},{"post_id":"cjaw7ebzc0025d6ykvhddwd65","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ec03002od6ykomhrnxx3"},{"post_id":"cjaw7ebzh0028d6ykai5f5jkl","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ec08002rd6ykeqs558x6"},{"post_id":"cjaw7ebzq002cd6ykpfj7p8na","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ec0e002td6ykxqgv09w7"},{"post_id":"cjaw7ebzt002fd6yknh6ho6jc","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ec0i002wd6ykvnx6alru"},{"post_id":"cjaw7ec00002md6ykaseqnr5g","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ec0l002zd6yk70faq4ws"},{"post_id":"cjaw7ec03002pd6ykce904fx8","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ec0o0033d6ykbfx98pcp"},{"post_id":"cjaw7ec08002sd6ykjtbf1egv","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ec0q0036d6ykysmnq88x"},{"post_id":"cjaw7ebzv002jd6yk8xvoyg3x","category_id":"cjaw7ec03002nd6ykv1w4bk0x","_id":"cjaw7ec0s0039d6ykkic9qa8f"},{"post_id":"cjaw7ec0e002ud6ykymgkb06s","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ec0x003dd6ykjehh5juz"},{"post_id":"cjaw7ec0i002xd6yke6k9n32i","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ec11003gd6yk2p8gdxlo"},{"post_id":"cjaw7ec0m0030d6yk4pl8drox","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ec14003jd6yk1iwtrrj0"},{"post_id":"cjaw7ec0o0034d6yknst949br","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ec16003md6ykmcfosz97"},{"post_id":"cjaw7ec0q0037d6ykxkej7qv3","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ec1f003qd6yklmope15c"},{"post_id":"cjaw7ec0t003bd6yk7054hrta","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ec1j003sd6ykjat2pmr7"},{"post_id":"cjaw7ec0x003ed6yksf73tcd7","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ec1l003vd6ykomfo0esg"},{"post_id":"cjaw7ec11003hd6yk3tz2q2a5","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ec1o003yd6ykp31dnxht"},{"post_id":"cjaw7ec14003ld6ykrwk00nbd","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ec1r0042d6ykpyf0wdny"},{"post_id":"cjaw7ec18003od6ykbkgy2aq7","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ec210045d6yks0stncrm"},{"post_id":"cjaw7ec1f003rd6ykwzl0gdfa","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ec240048d6ykhw9wsoz9"},{"post_id":"cjaw7ec1j003td6ykynv0l9r3","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ec27004bd6yk57cpkrrx"},{"post_id":"cjaw7ec1m003wd6ykyl2lev0o","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ec28004dd6ykbzcauefz"},{"post_id":"cjaw7ec1o003zd6ykp21mdh1s","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ec2a004gd6ykp6vjr7av"},{"post_id":"cjaw7ec1s0043d6ykty4o8w4q","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ec2b004id6yksmxcvl7a"},{"post_id":"cjaw7ec220046d6yklxnf7lh1","category_id":"cjaw7ebvd0006d6yklfnfvm1k","_id":"cjaw7ec2c004ld6ykl1vumnp9"},{"post_id":"cjaw7ec6f0082d6ykjteo5mm7","category_id":"cjaw7ebwd000gd6yktaurin3d","_id":"cjaw7ec6l0084d6ykkmo5v22u"}],"PostTag":[{"post_id":"cjaw7ebuy0002d6yk1k3u5h9m","tag_id":"cjaw7ebvm0007d6ykooqxf565","_id":"cjaw7ebwn000kd6yk7omku0su"},{"post_id":"cjaw7ebuy0002d6yk1k3u5h9m","tag_id":"cjaw7ebvy000cd6ykgqqr4pyh","_id":"cjaw7ebws000nd6ykefae7j43"},{"post_id":"cjaw7ebv50004d6ykpui4ccos","tag_id":"cjaw7ebwi000hd6yk4n9vlvdn","_id":"cjaw7ebxh0013d6ykp1d4s7i0"},{"post_id":"cjaw7ebv50004d6ykpui4ccos","tag_id":"cjaw7ebwv000od6yktjqime0y","_id":"cjaw7ebxn0016d6yk11n7ag8i"},{"post_id":"cjaw7ebv50004d6ykpui4ccos","tag_id":"cjaw7ebx8000ud6ykcn66l3xp","_id":"cjaw7ebxr001ad6ykwytapb9y"},{"post_id":"cjaw7ebvo0008d6yk6b8vzqxl","tag_id":"cjaw7ebxg0010d6yk7z74x9ku","_id":"cjaw7ebxy001ed6ykkw92bfbx"},{"post_id":"cjaw7ebvs0009d6yktahbspes","tag_id":"cjaw7ebvm0007d6ykooqxf565","_id":"cjaw7ebyc001jd6yk83wao0fc"},{"post_id":"cjaw7ebvs0009d6yktahbspes","tag_id":"cjaw7ebxq0018d6ykw61qjgld","_id":"cjaw7ebyi001md6ykyfgi5hic"},{"post_id":"cjaw7ebvw000ad6yk14yre00n","tag_id":"cjaw7ebvm0007d6ykooqxf565","_id":"cjaw7ebyo001qd6ykzynuva1a"},{"post_id":"cjaw7ebvw000ad6yk14yre00n","tag_id":"cjaw7eby6001gd6ykr49jcqsf","_id":"cjaw7ebyu001td6ykjav4ghmw"},{"post_id":"cjaw7ebyx001vd6yk1k19obak","tag_id":"cjaw7ebvm0007d6ykooqxf565","_id":"cjaw7ebz8001zd6ykxj1xo6lv"},{"post_id":"cjaw7ebyx001vd6yk1k19obak","tag_id":"cjaw7ebx8000ud6ykcn66l3xp","_id":"cjaw7ebzb0023d6ykhuhqibgh"},{"post_id":"cjaw7ebw2000dd6yklg3an2hg","tag_id":"cjaw7ebvm0007d6ykooqxf565","_id":"cjaw7ebzg0026d6yk7xc8x48m"},{"post_id":"cjaw7ebw2000dd6yklg3an2hg","tag_id":"cjaw7ebyk001od6ykmxxplukm","_id":"cjaw7ebzl002ad6yk49tsxtwp"},{"post_id":"cjaw7ebw2000dd6yklg3an2hg","tag_id":"cjaw7ebz0001wd6ykjpoylt26","_id":"cjaw7ebzs002dd6yk2swnswb6"},{"post_id":"cjaw7ebwb000fd6ykr7v031ya","tag_id":"cjaw7ebza0022d6ykr1s557ga","_id":"cjaw7ebzv002gd6ykrdb1r9rd"},{"post_id":"cjaw7ebwb000fd6ykr7v031ya","tag_id":"cjaw7ebvm0007d6ykooqxf565","_id":"cjaw7ec00002kd6ykisld7yi7"},{"post_id":"cjaw7ebwl000jd6ykedf1baiw","tag_id":"cjaw7ebvm0007d6ykooqxf565","_id":"cjaw7ec0l002yd6ykhkdoc1tz"},{"post_id":"cjaw7ebwl000jd6ykedf1baiw","tag_id":"cjaw7ebzl0029d6ykzeupa9fb","_id":"cjaw7ec0n0031d6yke45rht7d"},{"post_id":"cjaw7ebwl000jd6ykedf1baiw","tag_id":"cjaw7ebzv002id6ykt0goqj7i","_id":"cjaw7ec0p0035d6ykp3ijrr6v"},{"post_id":"cjaw7ebwl000jd6ykedf1baiw","tag_id":"cjaw7ec06002qd6yky6ot4wxj","_id":"cjaw7ec0s0038d6ykoos1qbsz"},{"post_id":"cjaw7ebwo000md6ykzt5r5bpr","tag_id":"cjaw7ebwi000hd6yk4n9vlvdn","_id":"cjaw7ec0w003cd6ykuclmwhzo"},{"post_id":"cjaw7ebwo000md6ykzt5r5bpr","tag_id":"cjaw7ec0h002vd6yk8pfu6rgl","_id":"cjaw7ec0z003fd6yk04okazs4"},{"post_id":"cjaw7ebwx000qd6ykm6a060j6","tag_id":"cjaw7ec0n0032d6ykqqyuhwyk","_id":"cjaw7ec14003kd6ykekv4o407"},{"post_id":"cjaw7ebwx000qd6ykm6a060j6","tag_id":"cjaw7ec0s003ad6yk0u69bn18","_id":"cjaw7ec17003nd6ykoi6ces7a"},{"post_id":"cjaw7ebx1000sd6ykxpy1fxsm","tag_id":"cjaw7ec0n0032d6ykqqyuhwyk","_id":"cjaw7ec1n003xd6ykjmsiqvo9"},{"post_id":"cjaw7ebx1000sd6ykxpy1fxsm","tag_id":"cjaw7ec1e003pd6yk3re6et9f","_id":"cjaw7ec1q0040d6yk1g075os5"},{"post_id":"cjaw7ec1j003td6ykynv0l9r3","tag_id":"cjaw7ebx8000ud6ykcn66l3xp","_id":"cjaw7ec1v0044d6ykxu3mm26t"},{"post_id":"cjaw7ec1j003td6ykynv0l9r3","tag_id":"cjaw7ebvm0007d6ykooqxf565","_id":"cjaw7ec230047d6ykj33f427d"},{"post_id":"cjaw7ebx8000vd6yk88dz51lz","tag_id":"cjaw7ec1l003ud6ykpuscx4e4","_id":"cjaw7ec26004ad6ykby3zfhm3"},{"post_id":"cjaw7ebxc000xd6ykek6dssmh","tag_id":"cjaw7ebvm0007d6ykooqxf565","_id":"cjaw7ec27004cd6yk9s7sd99c"},{"post_id":"cjaw7ebxc000xd6ykek6dssmh","tag_id":"cjaw7ec1r0041d6ykp80btfe0","_id":"cjaw7ec29004fd6ykub8nyinx"},{"post_id":"cjaw7ebxf000zd6ykcgubw7g7","tag_id":"cjaw7ebvm0007d6ykooqxf565","_id":"cjaw7ec2a004hd6yk6swm120t"},{"post_id":"cjaw7ebxf000zd6ykcgubw7g7","tag_id":"cjaw7ec240049d6ykmuy9wg0o","_id":"cjaw7ec2c004jd6ykor2ue5tk"},{"post_id":"cjaw7ebxi0014d6ykplzczbw9","tag_id":"cjaw7ebvm0007d6ykooqxf565","_id":"cjaw7ec2e004md6yk5u12fn9k"},{"post_id":"cjaw7ebxi0014d6ykplzczbw9","tag_id":"cjaw7ec28004ed6yke0ajq1pv","_id":"cjaw7ec2e004nd6yk6hag1kcm"},{"post_id":"cjaw7ebxo0017d6yk943ra445","tag_id":"cjaw7ec2c004kd6yk04osfafc","_id":"cjaw7ec2l004qd6ykuvh09qp3"},{"post_id":"cjaw7ebxo0017d6yk943ra445","tag_id":"cjaw7ec2f004od6ykml7j3phw","_id":"cjaw7ec2l004rd6ykrmrtsi3g"},{"post_id":"cjaw7ebxr001bd6yk8m389gx8","tag_id":"cjaw7ec2j004pd6ykyvd89lt8","_id":"cjaw7ec2o004vd6ykwufodu82"},{"post_id":"cjaw7ebxr001bd6yk8m389gx8","tag_id":"cjaw7ec2m004sd6ykuoa2evek","_id":"cjaw7ec2p004wd6yk7htiom4x"},{"post_id":"cjaw7ebxr001bd6yk8m389gx8","tag_id":"cjaw7ec2n004td6ykzhh8nml2","_id":"cjaw7ec2q004yd6yk1wpe799c"},{"post_id":"cjaw7ebxy001fd6ykge65rgq0","tag_id":"cjaw7ebvm0007d6ykooqxf565","_id":"cjaw7ec2q004zd6yk0cfrqc0j"},{"post_id":"cjaw7ebxy001fd6ykge65rgq0","tag_id":"cjaw7ec2o004ud6yk45thvwed","_id":"cjaw7ec2q0051d6ykmboz5cl1"},{"post_id":"cjaw7eby8001id6ykckgrycuh","tag_id":"cjaw7ebvm0007d6ykooqxf565","_id":"cjaw7ec2r0052d6ykpa281s5t"},{"post_id":"cjaw7eby8001id6ykckgrycuh","tag_id":"cjaw7ec2p004xd6yk4byzr49h","_id":"cjaw7ec2r0054d6ykztuljm44"},{"post_id":"cjaw7ebyd001ld6ykts3mjggy","tag_id":"cjaw7ec0n0032d6ykqqyuhwyk","_id":"cjaw7ec2u0056d6ykoux3vzmb"},{"post_id":"cjaw7ebyd001ld6ykts3mjggy","tag_id":"cjaw7ec2r0053d6ykb5l0vsbu","_id":"cjaw7ec2u0057d6yk2sphlf98"},{"post_id":"cjaw7ebym001pd6ykdeokmvms","tag_id":"cjaw7ec2s0055d6ykkwpx9aki","_id":"cjaw7ec2v0059d6ykkg5ws0jc"},{"post_id":"cjaw7ebys001sd6ykew0aco4p","tag_id":"cjaw7ebvm0007d6ykooqxf565","_id":"cjaw7ec2w005bd6yki594m7wt"},{"post_id":"cjaw7ebys001sd6ykew0aco4p","tag_id":"cjaw7ec2u0058d6ykv7odinp3","_id":"cjaw7ec2w005cd6yk0w13k58s"},{"post_id":"cjaw7ebz3001yd6ykf5kdyo3u","tag_id":"cjaw7ec2v005ad6ykhut2ws9b","_id":"cjaw7ec2x005ed6yko99jnen8"},{"post_id":"cjaw7ebz80021d6ykyugil0ez","tag_id":"cjaw7ec2s0055d6ykkwpx9aki","_id":"cjaw7ec2y005gd6yk8p964le8"},{"post_id":"cjaw7ebzc0025d6ykvhddwd65","tag_id":"cjaw7ebwi000hd6yk4n9vlvdn","_id":"cjaw7ec2z005id6ykhd4qfo2e"},{"post_id":"cjaw7ebzc0025d6ykvhddwd65","tag_id":"cjaw7ec2x005fd6yk8fs5m0w4","_id":"cjaw7ec2z005jd6ykod2nwye5"},{"post_id":"cjaw7ebzh0028d6ykai5f5jkl","tag_id":"cjaw7ec2v005ad6ykhut2ws9b","_id":"cjaw7ec31005md6ykbuz205wp"},{"post_id":"cjaw7ebzh0028d6ykai5f5jkl","tag_id":"cjaw7ec2z005kd6ykgpr71ucq","_id":"cjaw7ec31005nd6yk4zn86wy2"},{"post_id":"cjaw7ebzq002cd6ykpfj7p8na","tag_id":"cjaw7ec2v005ad6ykhut2ws9b","_id":"cjaw7ec33005qd6ykv3mbbdeq"},{"post_id":"cjaw7ebzq002cd6ykpfj7p8na","tag_id":"cjaw7ec31005od6ykqi0lvyor","_id":"cjaw7ec33005rd6ykgl8u3bmt"},{"post_id":"cjaw7ebzt002fd6yknh6ho6jc","tag_id":"cjaw7ebwi000hd6yk4n9vlvdn","_id":"cjaw7ec34005td6yktq1gmbww"},{"post_id":"cjaw7ebzt002fd6yknh6ho6jc","tag_id":"cjaw7ec2j004pd6ykyvd89lt8","_id":"cjaw7ec34005ud6ykb6vsusow"},{"post_id":"cjaw7ebzv002jd6yk8xvoyg3x","tag_id":"cjaw7ec33005sd6ykz5awl9cx","_id":"cjaw7ec35005wd6yko07aetmk"},{"post_id":"cjaw7ec00002md6ykaseqnr5g","tag_id":"cjaw7ebvm0007d6ykooqxf565","_id":"cjaw7ec36005yd6yke39d9y76"},{"post_id":"cjaw7ec00002md6ykaseqnr5g","tag_id":"cjaw7ec35005vd6ykfteuswyn","_id":"cjaw7ec36005zd6yk56rn11yz"},{"post_id":"cjaw7ec03002pd6ykce904fx8","tag_id":"cjaw7ec36005xd6yk5v7tcqym","_id":"cjaw7ec3a0063d6yks87r6t7c"},{"post_id":"cjaw7ec03002pd6ykce904fx8","tag_id":"cjaw7ec360060d6yktotro495","_id":"cjaw7ec3a0064d6ykso7g0iue"},{"post_id":"cjaw7ec03002pd6ykce904fx8","tag_id":"cjaw7ec370061d6ykekzgbhq5","_id":"cjaw7ec3c0066d6ykja0abqxb"},{"post_id":"cjaw7ec08002sd6ykjtbf1egv","tag_id":"cjaw7ebvm0007d6ykooqxf565","_id":"cjaw7ec3c0067d6ykkptvxs98"},{"post_id":"cjaw7ec08002sd6ykjtbf1egv","tag_id":"cjaw7ec390062d6ykjgx36214","_id":"cjaw7ec3d0069d6yk0qxz1m38"},{"post_id":"cjaw7ec0e002ud6ykymgkb06s","tag_id":"cjaw7ec3a0065d6yks7jdo7as","_id":"cjaw7ec3f006bd6ykzhidiv2g"},{"post_id":"cjaw7ec0e002ud6ykymgkb06s","tag_id":"cjaw7ec36005xd6yk5v7tcqym","_id":"cjaw7ec3f006cd6yklqoe0f4e"},{"post_id":"cjaw7ec0i002xd6yke6k9n32i","tag_id":"cjaw7ec3e006ad6yk62y41dlb","_id":"cjaw7ec3g006ed6yk74okyarz"},{"post_id":"cjaw7ec0m0030d6yk4pl8drox","tag_id":"cjaw7ec3f006dd6ykgp9r3emu","_id":"cjaw7ec3h006hd6ykw46q8vpb"},{"post_id":"cjaw7ec0m0030d6yk4pl8drox","tag_id":"cjaw7ec3g006fd6ykok77qxbv","_id":"cjaw7ec3h006id6ykq9yk30u3"},{"post_id":"cjaw7ec0o0034d6yknst949br","tag_id":"cjaw7ec3h006gd6ykt9t6r9rs","_id":"cjaw7ec3i006kd6ykxts8svo3"},{"post_id":"cjaw7ec0o0034d6yknst949br","tag_id":"cjaw7ebvm0007d6ykooqxf565","_id":"cjaw7ec3j006ld6ykdzd5b2cr"},{"post_id":"cjaw7ec0q0037d6ykxkej7qv3","tag_id":"cjaw7ec3i006jd6ykreabnd5a","_id":"cjaw7ec3z006pd6yke3i4fwue"},{"post_id":"cjaw7ec0q0037d6ykxkej7qv3","tag_id":"cjaw7ec3j006md6ykghigj8xh","_id":"cjaw7ec3z006qd6ykkqo8ffr7"},{"post_id":"cjaw7ec0q0037d6ykxkej7qv3","tag_id":"cjaw7ec3x006nd6ykf19b8gk1","_id":"cjaw7ec40006sd6yk2h0wiz8g"},{"post_id":"cjaw7ec0t003bd6yk7054hrta","tag_id":"cjaw7ec3z006od6ykk92k8oad","_id":"cjaw7ec41006vd6ykfe0ysmjt"},{"post_id":"cjaw7ec0t003bd6yk7054hrta","tag_id":"cjaw7ec3z006rd6ykaq5tzn1l","_id":"cjaw7ec42006wd6yk4u6euyez"},{"post_id":"cjaw7ec0t003bd6yk7054hrta","tag_id":"cjaw7ec40006td6yk8lngoewz","_id":"cjaw7ec42006yd6yksvh36rsr"},{"post_id":"cjaw7ec0x003ed6yksf73tcd7","tag_id":"cjaw7ec41006ud6yk963jl0nv","_id":"cjaw7ec430070d6ykoc4nneax"},{"post_id":"cjaw7ec0x003ed6yksf73tcd7","tag_id":"cjaw7ec42006xd6ykk76l5vn1","_id":"cjaw7ec430071d6ykcwue3kkp"},{"post_id":"cjaw7ec11003hd6yk3tz2q2a5","tag_id":"cjaw7ec43006zd6yk55h1qd94","_id":"cjaw7ec460074d6ykc8kmwxuu"},{"post_id":"cjaw7ec11003hd6yk3tz2q2a5","tag_id":"cjaw7ec40006td6yk8lngoewz","_id":"cjaw7ec460075d6yk1idcnswv"},{"post_id":"cjaw7ec14003ld6ykrwk00nbd","tag_id":"cjaw7ec440073d6ykmfqdcdj0","_id":"cjaw7ec480078d6yk0ik7xie3"},{"post_id":"cjaw7ec14003ld6ykrwk00nbd","tag_id":"cjaw7ec470076d6yk7esikqbi","_id":"cjaw7ec480079d6yku9vspq4v"},{"post_id":"cjaw7ec18003od6ykbkgy2aq7","tag_id":"cjaw7ec43006zd6yk55h1qd94","_id":"cjaw7ec49007cd6yk4qtxug2c"},{"post_id":"cjaw7ec18003od6ykbkgy2aq7","tag_id":"cjaw7ec40006td6yk8lngoewz","_id":"cjaw7ec4a007dd6yknnrwxexx"},{"post_id":"cjaw7ec1f003rd6ykwzl0gdfa","tag_id":"cjaw7ec49007bd6ykz6ff01q4","_id":"cjaw7ec4d007hd6ykkv82j8m4"},{"post_id":"cjaw7ec1f003rd6ykwzl0gdfa","tag_id":"cjaw7ec440073d6ykmfqdcdj0","_id":"cjaw7ec4e007id6yk9dmsj3l8"},{"post_id":"cjaw7ec1f003rd6ykwzl0gdfa","tag_id":"cjaw7ec40006td6yk8lngoewz","_id":"cjaw7ec4e007kd6ykd11oqq2q"},{"post_id":"cjaw7ec1m003wd6ykyl2lev0o","tag_id":"cjaw7ec4d007gd6yk8ku7v34l","_id":"cjaw7ec4g007md6ykjyrrxniq"},{"post_id":"cjaw7ec1m003wd6ykyl2lev0o","tag_id":"cjaw7ec4e007jd6ykhfprfa3e","_id":"cjaw7ec4g007nd6yk8w91peam"},{"post_id":"cjaw7ec1m003wd6ykyl2lev0o","tag_id":"cjaw7ebz0001wd6ykjpoylt26","_id":"cjaw7ec4h007pd6yka0my3hls"},{"post_id":"cjaw7ec1o003zd6ykp21mdh1s","tag_id":"cjaw7ec4d007gd6yk8ku7v34l","_id":"cjaw7ec4j007rd6ykwdzf46xk"},{"post_id":"cjaw7ec1o003zd6ykp21mdh1s","tag_id":"cjaw7ec4e007jd6ykhfprfa3e","_id":"cjaw7ec4j007sd6ykja8ji11f"},{"post_id":"cjaw7ec1o003zd6ykp21mdh1s","tag_id":"cjaw7ebz0001wd6ykjpoylt26","_id":"cjaw7ec4l007ud6ykt0dmu16l"},{"post_id":"cjaw7ec1s0043d6ykty4o8w4q","tag_id":"cjaw7ec4h007qd6ykbr0xdap7","_id":"cjaw7ec4n007xd6ykum2auvl8"},{"post_id":"cjaw7ec1s0043d6ykty4o8w4q","tag_id":"cjaw7ec4j007td6ykjluh5ug6","_id":"cjaw7ec4o007yd6ykwkhnyj75"},{"post_id":"cjaw7ec1s0043d6ykty4o8w4q","tag_id":"cjaw7ec4l007vd6yk7vcp08jz","_id":"cjaw7ec4o007zd6yk03rnxwk4"},{"post_id":"cjaw7ec220046d6yklxnf7lh1","tag_id":"cjaw7ec4l007vd6yk7vcp08jz","_id":"cjaw7ec4o0080d6ykov9qh6df"},{"post_id":"cjaw7ec220046d6yklxnf7lh1","tag_id":"cjaw7ebz0001wd6ykjpoylt26","_id":"cjaw7ec4p0081d6ykpv645ql6"},{"post_id":"cjaw7ec6f0082d6ykjteo5mm7","tag_id":"cjaw7ebxg0010d6yk7z74x9ku","_id":"cjaw7ec6m0085d6ykh60gjf79"},{"post_id":"cjaw7ec6f0082d6ykjteo5mm7","tag_id":"cjaw7ec6k0083d6yk7xgku2ve","_id":"cjaw7ec6n0086d6yk5wwa8o50"}],"Tag":[{"name":"ANDROID","_id":"cjaw7ebvm0007d6ykooqxf565"},{"name":"Open souces","_id":"cjaw7ebvy000cd6ykgqqr4pyh"},{"name":"Java","_id":"cjaw7ebwi000hd6yk4n9vlvdn"},{"name":"multi-thread","_id":"cjaw7ebwv000od6yktjqime0y"},{"name":"Interview Knowledge","_id":"cjaw7ebx8000ud6ykcn66l3xp"},{"name":"read","_id":"cjaw7ebxg0010d6yk7z74x9ku"},{"name":"google map","_id":"cjaw7ebxq0018d6ykw61qjgld"},{"name":"third-party signin","_id":"cjaw7eby6001gd6ykr49jcqsf"},{"name":"new features","_id":"cjaw7ebyk001od6ykmxxplukm"},{"name":"Basic Knowledge","_id":"cjaw7ebz0001wd6ykjpoylt26"},{"name":"reading","_id":"cjaw7ebza0022d6ykr1s557ga"},{"name":"GCM","_id":"cjaw7ebzl0029d6ykzeupa9fb"},{"name":"azure","_id":"cjaw7ebzv002id6ykt0goqj7i"},{"name":"notification","_id":"cjaw7ec06002qd6yky6ot4wxj"},{"name":"byte[]","_id":"cjaw7ec0h002vd6yk8pfu6rgl"},{"name":"JNI","_id":"cjaw7ec0n0032d6ykqqyuhwyk"},{"name":"AES","_id":"cjaw7ec0s003ad6yk0u69bn18"},{"name":"android source code","_id":"cjaw7ec1e003pd6yk3re6et9f"},{"name":"gson","_id":"cjaw7ec1l003ud6ykpuscx4e4"},{"name":"qiniu","_id":"cjaw7ec1r0041d6ykp80btfe0"},{"name":"webview","_id":"cjaw7ec240049d6ykmuy9wg0o"},{"name":"LocationListener","_id":"cjaw7ec28004ed6yke0ajq1pv"},{"name":"RxJava","_id":"cjaw7ec2c004kd6yk04osfafc"},{"name":"RxAndroid","_id":"cjaw7ec2f004od6ykml7j3phw"},{"name":"ThreadLocal","_id":"cjaw7ec2j004pd6ykyvd89lt8"},{"name":"HandlerThread","_id":"cjaw7ec2m004sd6ykuoa2evek"},{"name":"Looper","_id":"cjaw7ec2n004td6ykzhh8nml2"},{"name":"remove admob","_id":"cjaw7ec2o004ud6yk45thvwed"},{"name":"Singleton","_id":"cjaw7ec2p004xd6yk4byzr49h"},{"name":"publickey","_id":"cjaw7ec2r0053d6ykb5l0vsbu"},{"name":"gradle","_id":"cjaw7ec2s0055d6ykkwpx9aki"},{"name":"exitApplication","_id":"cjaw7ec2u0058d6ykv7odinp3"},{"name":"Hexo","_id":"cjaw7ec2v005ad6ykhut2ws9b"},{"name":"genericity","_id":"cjaw7ec2x005fd6yk8fs5m0w4"},{"name":"Hexo structure","_id":"cjaw7ec2z005kd6ykgpr71ucq"},{"name":"EJS","_id":"cjaw7ec31005od6ykqi0lvyor"},{"name":"IM Company","_id":"cjaw7ec33005sd6ykz5awl9cx"},{"name":"Patch Update","_id":"cjaw7ec35005vd6ykfteuswyn"},{"name":"linux","_id":"cjaw7ec36005xd6yk5v7tcqym"},{"name":"iterm","_id":"cjaw7ec360060d6yktotro495"},{"name":"scp","_id":"cjaw7ec370061d6ykekzgbhq5"},{"name":"multi-process","_id":"cjaw7ec390062d6ykjgx36214"},{"name":"svn server","_id":"cjaw7ec3a0065d6yks7jdo7as"},{"name":"HTTPS","_id":"cjaw7ec3e006ad6yk62y41dlb"},{"name":"Injection","_id":"cjaw7ec3f006dd6ykgp9r3emu"},{"name":"assertion","_id":"cjaw7ec3g006fd6ykok77qxbv"},{"name":"Annotation","_id":"cjaw7ec3h006gd6ykt9t6r9rs"},{"name":"Android Framework","_id":"cjaw7ec3i006jd6ykreabnd5a"},{"name":"EIT","_id":"cjaw7ec3j006md6ykghigj8xh"},{"name":"Object-oriented","_id":"cjaw7ec3x006nd6ykf19b8gk1"},{"name":"HOOK","_id":"cjaw7ec3z006od6ykk92k8oad"},{"name":"Android system service","_id":"cjaw7ec3z006rd6ykaq5tzn1l"},{"name":"Binder","_id":"cjaw7ec40006td6yk8lngoewz"},{"name":"TimerTask","_id":"cjaw7ec41006ud6yk963jl0nv"},{"name":"handler","_id":"cjaw7ec42006xd6ykk76l5vn1"},{"name":"AIDL","_id":"cjaw7ec43006zd6yk55h1qd94"},{"name":"AOSP","_id":"cjaw7ec440073d6ykmfqdcdj0"},{"name":"sdk compile","_id":"cjaw7ec470076d6yk7esikqbi"},{"name":"AMS","_id":"cjaw7ec49007bd6ykz6ff01q4"},{"name":"PBOC","_id":"cjaw7ec4d007gd6yk8ku7v34l"},{"name":"PBOC 2.0","_id":"cjaw7ec4e007jd6ykhfprfa3e"},{"name":"Alfred Workflow","_id":"cjaw7ec4h007qd6ykbr0xdap7"},{"name":"Electron","_id":"cjaw7ec4j007td6ykjluh5ug6"},{"name":"JavaScript","_id":"cjaw7ec4l007vd6yk7vcp08jz"},{"name":"nodejs","_id":"cjaw7ec6k0083d6yk7xgku2ve"}]}}