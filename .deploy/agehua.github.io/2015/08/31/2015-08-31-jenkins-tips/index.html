<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="马浩珍在 Github 上的个人博客">
    <meta name="keyword" content="null">
    <meta name="theme-color" content="#600090">
    <meta name="msapplication-navbutton-color" content="#600090">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="#600090">
    <link rel="shortcut icon" href="https://cdn4.iconfinder.com/data/icons/ionicons/512/icon-person-128.png">
    <link rel="alternate" type="application/atom+xml" title="Haojen" href="/atom.xml">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.css">
    <title>
        
        Jenkins tips｜Haojen&#39;s blog
        
    </title>

    <link rel="canonical" href="http://agehua.github.io/2015/08/31/2015-08-31-jenkins-tips/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/blog-style.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">
</head>

<style>

    header.intro-header {
        background-image: url('//o7bkkhiex.bkt.clouddn.com/lion-blur-bg.jpg')
    }
</style>
<!-- hack iOS CSS :active style -->
<body ontouchstart="" class="animated fadeIn">
<!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top " id="nav-top" data-ispost = "true" data-istags="false
" data-ishome = "false" >
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand animated pulse" href="/">
                <span class="brand-logo">
                    Haojen
                </span>
                's Blog
            </a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <!-- /.navbar-collapse -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
					
                    
                        
                    
					
					
                </ul>
            </div>
        </div>
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
//    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>

<!-- Main Content -->

<!--only post-->


<img class="wechat-title-img"
     src="">


<style>
    
    header.intro-header {
        background-image: url('')
    }

    
</style>

<header class="intro-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 text-center">
                <div class="post-heading">
                    <h1>Jenkins tips</h1>
                    
                    <span class="meta">
                         作者 Haojen Ma
                        <span>
                          日期 2015-08-31
                         </span>
                    </span>
                    <div class="tags text-center">
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="post-title-haojen">
        <span>
            Jenkins tips
        </span>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <!-- Post Container -->
            <div class="col-lg-8 col-lg-offset-1 col-sm-9 post-container">
                <h2 id="在windows上以service的方式安装jenkins-slave节点"><a href="#在windows上以service的方式安装jenkins-slave节点" class="headerlink" title="在windows上以service的方式安装jenkins slave节点"></a>在windows上以service的方式安装jenkins slave节点</h2><ol>
<li>在命令行运行，安装slave节点</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">java -jar slave.jar -jnlpUrl http://jenkins-server-ip:8080/jenkins/computer/&#123;&#123;node name&#125;&#125;/slave-agent.jnlp -secret 2d00ae81d59ff37df0fe9c33a5ed671afa2bc495715c0c161091a8e429973eb1</div></pre></td></tr></table></figure>
<ol>
<li><p>解决阻止自签名的问题<br>您的安全设置已阻止自签名的应用程序使用已过期的Java版本运行问题的解决</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">步骤：选择windows的开始--&gt;控制面板--&gt;在搜索栏中输入 java--&gt;点击查询出来的Java图标--&gt;安全--&gt;把 高(推荐的最低设置)--&gt;改成 中--&gt;确定--&gt;即可。</div></pre></td></tr></table></figure>
</li>
<li><p>以servcie的方式启动<br>在下面的页面上： <a href="http://jenkins-server-ip:8080/jenkins/computer/\{node" target="_blank" rel="external">http://jenkins-server-ip:8080/jenkins/computer/\{node</a> name}</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">操作步骤： 点击Launch--&gt;保留--&gt;把slave-agent.jnlp拷贝到C:\CI\jenkins-slave下--&gt;使用javaws.exe(java web start launcher)--&gt;继续--&gt;</div><div class="line">点击 我接受风险并希望运行此应用程序。--&gt;运行--&gt;File--&gt;Install as a service--&gt;确定--&gt;是--&gt;是</div></pre></td></tr></table></figure>
</li>
</ol>
<p>这样Jenkins节点以Windows Service的方式在运行了。</p>
<a id="more"></a>
<ol>
<li>程序不能在Administrator的账号下面运行：</li>
</ol>
<p>某些程序无法再admininstrator上运行，但是jenkins slave是以administrator启动的，只有通过修改jenkins service的登录账号解决。</p>
<p>步骤:<br>I too had a similar issue once. Try granting the Jenkins service “Logon as This account” right under services.msc and make sure the account you type there is the same as the one you use for running cmd.exe. </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">在window运行中输入services.msc--&gt;选择Jenkins--&gt;Log On--&gt;Logon as This account to This account : andrew/andrewpassword --&gt;OK</div></pre></td></tr></table></figure>
<p>重启Jenkins节点的服务,重新构建项目,就转换成了andrew用户来运行了.</p>
<p>参考： <a href="http://stackoverflow.com/questions/10952280/execute-windows-batch-command-from-jenkins-fails-but-runs-fine-in-cmd-exe" target="_blank" rel="external">Execute windows batch command from Jenkins fails but runs fine in cmd.exe</a></p>
<h2 id="multi-branch-branch-for-git"><a href="#multi-branch-branch-for-git" class="headerlink" title="multi-branch branch for git"></a>multi-branch branch for git</h2><p><a href="http://blog.travis-ci.com/announcing-pull-request-support/" target="_blank" rel="external">travis-ci</a></p>
<p><a href="https://github.com/mjdetullio/multi-branch-project-plugin" target="_blank" rel="external">jenkins multi-branch-build plugin</a></p>
<h2 id="jenkins检查github的pull-request"><a href="#jenkins检查github的pull-request" class="headerlink" title="jenkins检查github的pull request"></a>jenkins检查github的pull request</h2><p>下面插件可以实现当在github上提交了一个pull request，他可以自动完成一些工作，例如对pull request加评论，验证pull request，对pull reques跑test等等。<br>没有具体试验过，以后有机会，试用一下，然后加评论。</p>
<p><a href="https://wiki.jenkins-ci.org/display/JENKINS/GitHub+pull+request+builder+plugin" target="_blank" rel="external">GitHub pull request builder plugin</a></p>
<h2 id="jenkins分支同步"><a href="#jenkins分支同步" class="headerlink" title="jenkins分支同步"></a>jenkins分支同步</h2><p>我们的项目是在github上，一个比较大的问题就是同步经常出问题，一个同事使用了这两个插件解决了这个问题。</p>
<p><a href="https://wiki.jenkins-ci.org/display/JENKINS/CloudBees+Folders+Plugin" target="_blank" rel="external">CloudBees Folders Plugin</a></p>
<p><a href="https://wiki.jenkins-ci.org/display/JENKINS/CloudBees+GitHub+Branch+Source+Plugin" target="_blank" rel="external">CloudBees GitHub Branch Source Plugin</a></p>
<h2 id="jenkins配置使用github登录"><a href="#jenkins配置使用github登录" class="headerlink" title="jenkins配置使用github登录"></a>jenkins配置使用github登录</h2><p>安装<a href="https://wiki.jenkins-ci.org/display/JENKINS/Github+OAuth+Plugin" target="_blank" rel="external">Github OAuth Plugin</a>， 然后在manage jenkins的Configure Global Security中，可以将Access Control配置使用Github Authentication Plugin。</p>
<p>配置图如下：</p>
<img src="/images/blogimages/2015/jenkins-github-oauth.png" class="center">
<p>上图中的api配置路径，如果使用的是GitHub Enterprise，那么url的路径就要配置为<code>/api/v3</code>.</p>
<p>client id和client seceret是在github中生成的。</p>
<p>打开github，在edit profile的地方，选择applications -&gt; developer applications, 生成一个新的application。<br>很多都是自动生成的，比较重要的一个是authorization callback url，这个也需要天固定的格式：</p>
<p>例如<code>http://myserver.com:8080/securityRealm/finishLogin</code>，其中myserver.com和端口8080对应你的jenkins的域名和端口。</p>
<p>下图是一个例子</p>
<img src="/images/blogimages/2015/github-applications.png" class="center">
<p>在上图中，还可以给你的application加一个图标，如5所示。</p>
<h2 id="jenkins-tool配置"><a href="#jenkins-tool配置" class="headerlink" title="jenkins tool配置"></a>jenkins tool配置</h2><p>在jenkins中，使用到很多工具，例如git，maven，jdk，node。可以在manage jenkins -&gt; configure system中配置。</p>
<p>在配置中，如果选择了install automatically，那么jenkins就会在salve node上自动安装这个工具。这样如果在jenkins中使用docker node等这种方式的话，有可能每次都会去安装。</p>
<p>或者如果你的node已经安装了，jenkins也会去安装一次。</p>
<p>所以可以不选择install automatically， 然后配置一个XXX_HOME或者工具的path，那么jenkins就会自动去找个工具，而不是去安装。但是如果配置了工具的路径，这个配置是对所有node有效的。</p>
<p>如果对没有node需要单独配置的话，可以去manage node页面，在node的configure页面中配置tool location，这样这个配置项就就只对这个node生效。</p>
<p>当然还有一个jenkins plugin可以使用: <a href="https://wiki.jenkins-ci.org/display/JENKINS/Custom+Tools+Plugin" target="_blank" rel="external">Custom Tools Plugin</a>，它甚至可以对单独的一个job配置工具路径。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://wiki.jenkins-ci.org/display/JENKINS/Use+Jenkins" target="_blank" rel="external">jenkins main page</a></p>
<p><a href="https://wiki.jenkins-ci.org/display/JENKINS/Installing+Jenkins+on+Ubuntu" target="_blank" rel="external">installation jenkins on ubuntu</a></p>
<p><a href="https://wiki.jenkins-ci.org/display/JENKINS/Standard+Security+Setup" target="_blank" rel="external">enable jenkins user</a></p>
<p><a href="https://wiki.jenkins-ci.org/display/JENKINS/Installing+Jenkins+on+Red+Hat+distributions" target="_blank" rel="external">install jenkins on centos</a></p>
<p><a href="https://www.digitalocean.com/community/tutorials/how-to-install-git-on-a-centos-6-4-vps" target="_blank" rel="external">install the last git on centos</a></p>
<h2 id="issues"><a href="#issues" class="headerlink" title="issues"></a>issues</h2><p>issue 1:</p>
<p><a href="http://stackoverflow.com/questions/23104110/unknown-option-git-config-local-reported-by-jenkins" target="_blank" rel="external">unknown-option-git-config-local-reported-by-jenkins</a></p>
<p>issue 2:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">Failed to connect to repository : Command &quot;git -c core.askpass=true ls-remote -h https://github.com/liuhongjiang/gittest.git HEAD&quot; returned status code 128:</div><div class="line">stdout: </div><div class="line">stderr: fatal: Unable to find remote helper for &apos;https&apos;</div></pre></td></tr></table></figure>
<p><a href="http://stackoverflow.com/questions/8329485/git-clone-fatal-unable-to-find-remote-helper-for-https" target="_blank" rel="external">solution: git-clone-fatal-unable-to-find-remote-helper-for-https</a></p>

                <hr>
                

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2015/09/07/2015-09-07-Authentication-Anomaly-Detection-A-Case-Study-On-A-Virtual-Private-Network/" data-toggle="tooltip" data-placement="top"
                           title="Authentication Anomaly Detection: A Case Study On A Virtual Private Network">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2015/08/26/2015-08-26-install-kafka/" data-toggle="tooltip" data-placement="top"
                           title="Install kafka">Next Post &rarr;</a>
                    </li>
                    
                </ul>

                

                

            </div>

            <div class="hidden-xs col-sm-3 toc-col">
                <div class="toc-wrap">
                    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#在windows上以service的方式安装jenkins-slave节点"><span class="toc-text">在windows上以service的方式安装jenkins slave节点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#multi-branch-branch-for-git"><span class="toc-text">multi-branch branch for git</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jenkins检查github的pull-request"><span class="toc-text">jenkins检查github的pull request</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jenkins分支同步"><span class="toc-text">jenkins分支同步</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jenkins配置使用github登录"><span class="toc-text">jenkins配置使用github登录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jenkins-tool配置"><span class="toc-text">jenkins tool配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考"><span class="toc-text">参考</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#issues"><span class="toc-text">issues</span></a></li></ol>
                </div>
            </div>
        </div>

        <div class="row">
            <!-- Sidebar Container -->

            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5 class="text-center">
                        <a href="/tags/">FEATURED TAGS</a>
                    </h5>
                    <div class="tags">
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
            </div>
        </div>

    </div>
</article>






<!-- Footer -->
<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 text-center">
                <br>
                <ul class="list-inline text-center">
                
                
                
                    <li>
                        <a target="_blank" href="https://www.zhihu.com/people/agehua">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa  fa-stack-1x fa-inverse">知</i>
                            </span>
                        </a>
                    </li>
                

                
                    <li>
                        <a target="_blank" href="http://weibo.com/agehua">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                
                    <li>
                        <a target="_blank"  href="https://github.com/agehua">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; Haojen 2016
                    <br>
                    <span id="busuanzi_container_site_pv" style="font-size: 12px;">PV: <span id="busuanzi_value_site_pv"></span> Times</span>
                    <br>
                    Theme by <a href="https://haojen.github.io/">Haojen Ma</a>
                </p>

            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/js/blog.js"></script>

<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("http://agehua.github.io/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("//cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>

<!-- Google Analytics -->



<!-- Baidu Tongji -->


<!-- swiftype -->
<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','null','2.0.0');
</script>

<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<!--wechat title img-->
<img class="wechat-title-img" src="null">
</body>

</html>
